import{c as e,R as t,r as n,j as a,s as r,T as i,B as s,l as o,a as d,V as c,W as l,Y as u,Z as m,$ as h,d as f,a0 as p,X as g,a1 as _,a2 as v,q as x,P as y,a3 as b,a4 as w,a5 as N,a6 as j,f as k,a7 as S}from"./index-BXzydS18.js";import{b as D}from"./helpers-CsHcdtkA.js";import{C as M}from"./chevron-right-kLKoIcs_.js";import{C}from"./chevron-down-CAPlroP2.js";import{P as q,a as O,b as W}from"./popover-BN0THYKj.js";import{I,P as T,D as P,a as E,b as F,c as $,L}from"./dialog-Cw7zQPGk.js";import{T as Y}from"./textarea-dNp0q2Wr.js";import{t as z}from"./index-DupdSwiV.js";import{S as B}from"./react-select.esm-_svXSu8_.js";import{C as A}from"./calendar-CKdEI5-t.js";import{C as H}from"./check-DcsS7vCs.js";import{C as U}from"./credit-card-2ts15Pj6.js";import{T as R}from"./card-CajcfmFt.js";import{L as Z}from"./loader-circle-D752hqR5.js";import{S as K}from"./save-uXk9LFnM.js";
/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=e("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Q=e("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),G=e("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),X=e("message-square-plus",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M12 8v6",key:"1ib9pf"}],["path",{d:"M9 11h6",key:"1fldmi"}]]),J=e("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),ee=e("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);const te={},ne={};function ae(e,t){try{const n=(te[e]||=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format)(t).split("GMT")[1];return n in ne?ne[n]:ie(n,n.split(":"))}catch{if(e in ne)return ne[e];const t=e?.match(re);return t?ie(e,t.slice(1)):NaN}}const re=/([+-]\d\d):?(\d\d)?/;function ie(e,t){const n=+(t[0]||0),a=+(t[1]||0),r=+(t[2]||0)/60;return ne[e]=60*n+a>0?60*n+a+r:60*n-a-r}class se extends Date{constructor(...e){super(),e.length>1&&"string"==typeof e[e.length-1]&&(this.timeZone=e.pop()),this.internal=new Date,isNaN(ae(this.timeZone,this))?this.setTime(NaN):e.length?"number"==typeof e[0]&&(1===e.length||2===e.length&&"number"!=typeof e[1])?this.setTime(e[0]):"string"==typeof e[0]?this.setTime(+new Date(e[0])):e[0]instanceof Date?this.setTime(+e[0]):(this.setTime(+new Date(...e)),ce(this),de(this)):this.setTime(Date.now())}static tz(e,...t){return t.length?new se(...t,e):new se(Date.now(),e)}withTimeZone(e){return new se(+this,e)}getTimezoneOffset(){const e=-ae(this.timeZone,this);return e>0?Math.floor(e):Math.ceil(e)}setTime(e){return Date.prototype.setTime.apply(this,arguments),de(this),+this}[Symbol.for("constructDateFrom")](e){return new se(+new Date(e),this.timeZone)}}const oe=/^(get|set)(?!UTC)/;function de(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(60*-ae(e.timeZone,e)))}function ce(e){const t=ae(e.timeZone,e),n=t>0?Math.floor(t):Math.ceil(t),a=new Date(+e);a.setUTCHours(a.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),i=r- -new Date(+a).getTimezoneOffset(),s=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&s&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-n;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const d=new Date(+e);d.setUTCSeconds(0);const c=r>0?d.getSeconds():(d.getSeconds()-60)%60,l=Math.round(-60*ae(e.timeZone,e))%60;(l||c)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+l),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+l+c));const u=ae(e.timeZone,e),m=u>0?Math.floor(u):Math.ceil(u),h=-new Date(+e).getTimezoneOffset()-m-o;if(m!==n&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const t=ae(e.timeZone,e),n=m-(t>0?Math.floor(t):Math.ceil(t));n&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+n),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+n))}}Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!oe.test(e))return;const t=e.replace(oe,"$1UTC");se.prototype[t]&&(e.startsWith("get")?se.prototype[e]=function(){return this.internal[t]()}:(se.prototype[e]=function(){var e;return Date.prototype[t].apply(this.internal,arguments),e=this,Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),ce(e),+this},se.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),de(this),+this}))});class le extends se{static tz(e,...t){return t.length?new le(...t,e):new le(Date.now(),e)}toISOString(){const[e,t,n]=this.tzComponents(),a=`${e}${t}:${n}`;return this.internal.toISOString().slice(0,-1)+a}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[e,t,n,a]=this.internal.toUTCString().split(" ");return`${e?.slice(0,-1)} ${n} ${t} ${a}`}toTimeString(){const e=this.internal.toUTCString().split(" ")[4],[t,n,a]=this.tzComponents();return`${e} GMT${t}${n}${a} (${function(e,t,n="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:n}).format(t).split(/\s/g).slice(2).join(" ")}(this.timeZone,this)})`}toLocaleString(e,t){return Date.prototype.toLocaleString.call(this,e,{...t,timeZone:t?.timeZone||this.timeZone})}toLocaleDateString(e,t){return Date.prototype.toLocaleDateString.call(this,e,{...t,timeZone:t?.timeZone||this.timeZone})}toLocaleTimeString(e,t){return Date.prototype.toLocaleTimeString.call(this,e,{...t,timeZone:t?.timeZone||this.timeZone})}tzComponents(){const e=this.getTimezoneOffset();return[e>0?"-":"+",String(Math.floor(Math.abs(e)/60)).padStart(2,"0"),String(Math.abs(e)%60).padStart(2,"0")]}withTimeZone(e){return new le(+this,e)}[Symbol.for("constructDateFrom")](e){return new le(+new Date(e),this.timeZone)}}const ue=6048e5,me=Symbol.for("constructDateFrom");function he(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&me in e?e[me](t):e instanceof Date?new e.constructor(t):new Date(t)}function fe(e,t){return he(t||e,e)}function pe(e,t,n){const a=fe(e,n?.in);return isNaN(t)?he(e,NaN):t?(a.setDate(a.getDate()+t),a):a}function ge(e,t,n){const a=fe(e,n?.in);if(isNaN(t))return he(e,NaN);if(!t)return a;const r=a.getDate(),i=he(e,a.getTime());i.setMonth(a.getMonth()+t+1,0);return r>=i.getDate()?i:(a.setFullYear(i.getFullYear(),i.getMonth(),r),a)}let _e={};function ve(){return _e}function xe(e,t){const n=ve(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=fe(e,t?.in),i=r.getDay(),s=(i<a?7:0)+i-a;return r.setDate(r.getDate()-s),r.setHours(0,0,0,0),r}function ye(e,t){return xe(e,{...t,weekStartsOn:1})}function be(e,t){const n=fe(e,t?.in),a=n.getFullYear(),r=he(n,0);r.setFullYear(a+1,0,4),r.setHours(0,0,0,0);const i=ye(r),s=he(n,0);s.setFullYear(a,0,4),s.setHours(0,0,0,0);const o=ye(s);return n.getTime()>=i.getTime()?a+1:n.getTime()>=o.getTime()?a:a-1}function we(e){const t=fe(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Ne(e,...t){const n=he.bind(null,t.find(e=>"object"==typeof e));return t.map(n)}function je(e,t){const n=fe(e,t?.in);return n.setHours(0,0,0,0),n}function ke(e,t,n){const[a,r]=Ne(0,e,t),i=je(a),s=je(r),o=+i-we(i),d=+s-we(s);return Math.round((o-d)/864e5)}function Se(e){return e instanceof Date||"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function De(e,t){const{start:n,end:a}=function(e,t){const[n,a]=Ne(0,t.start,t.end);return{start:n,end:a}}(0,e);let r=+n>+a;const i=r?+n:+a,s=r?a:n;s.setHours(0,0,0,0),s.setDate(1);const o=[];for(;+s<=i;)o.push(he(n,s)),s.setMonth(s.getMonth()+1);return r?o.reverse():o}function Me(e,t){const n=fe(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Ce(e,t){const n=ve(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=fe(e,t?.in),i=r.getDay(),s=6+(i<a?-7:0)-(i-a);return r.setDate(r.getDate()+s),r.setHours(23,59,59,999),r}const qe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Oe(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const We={date:Oe({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Oe({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Oe({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Ie={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Te(e){return(t,n)=>{let a;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,r=n?.width?String(n.width):t;a=e.formattingValues[r]||e.formattingValues[t]}else{const t=e.defaultWidth,r=n?.width?String(n.width):e.defaultWidth;a=e.values[r]||e.values[t]}return a[e.argumentCallback?e.argumentCallback(t):t]}}function Pe(e){return(t,n={})=>{const a=n.width,r=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],i=t.match(r);if(!i)return null;const s=i[0],o=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,e=>e.test(s)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,e=>e.test(s));let c;c=e.valueCallback?e.valueCallback(d):d,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(s.length)}}}function Ee(e){return(t,n={})=>{const a=t.match(e.matchPattern);if(!a)return null;const r=a[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=n.valueCallback?n.valueCallback(s):s;return{value:s,rest:t.slice(r.length)}}}const Fe={code:"en-US",formatDistance:(e,t,n)=>{let a;const r=qe[e];return a="string"==typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a},formatLong:We,formatRelative:(e,t,n,a)=>Ie[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Te({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Te({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Te({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Te({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Te({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:Ee({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:Pe({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Pe({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:Pe({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Pe({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Pe({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function $e(e,t){const n=fe(e,t?.in),a=+ye(n)-+function(e,t){const n=be(e,t),a=he(e,0);return a.setFullYear(n,0,4),a.setHours(0,0,0,0),ye(a)}(n);return Math.round(a/ue)+1}function Le(e,t){const n=fe(e,t?.in),a=n.getFullYear(),r=ve(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=he(t?.in||e,0);s.setFullYear(a+1,0,i),s.setHours(0,0,0,0);const o=xe(s,t),d=he(t?.in||e,0);d.setFullYear(a,0,i),d.setHours(0,0,0,0);const c=xe(d,t);return+n>=+o?a+1:+n>=+c?a:a-1}function Ye(e,t){const n=fe(e,t?.in),a=+xe(n,t)-+function(e,t){const n=ve(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=Le(e,t),i=he(t?.in||e,0);return i.setFullYear(r,0,a),i.setHours(0,0,0,0),xe(i,t)}(n,t);return Math.round(a/ue)+1}function ze(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Be={y(e,t){const n=e.getFullYear(),a=n>0?n:1-n;return ze("yy"===t?a%100:a,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):ze(n+1,2)},d:(e,t)=>ze(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>ze(e.getHours()%12||12,t.length),H:(e,t)=>ze(e.getHours(),t.length),m:(e,t)=>ze(e.getMinutes(),t.length),s:(e,t)=>ze(e.getSeconds(),t.length),S(e,t){const n=t.length,a=e.getMilliseconds();return ze(Math.trunc(a*Math.pow(10,n-3)),t.length)}},Ae="midnight",He="noon",Ue="morning",Re="afternoon",Ze="evening",Ke="night",Ve={G:function(e,t,n){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});default:return n.era(a,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),a=t>0?t:1-t;return n.ordinalNumber(a,{unit:"year"})}return Be.y(e,t)},Y:function(e,t,n,a){const r=Le(e,a),i=r>0?r:1-r;if("YY"===t){return ze(i%100,2)}return"Yo"===t?n.ordinalNumber(i,{unit:"year"}):ze(i,t.length)},R:function(e,t){return ze(be(e),t.length)},u:function(e,t){return ze(e.getFullYear(),t.length)},Q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return ze(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return ze(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,n){const a=e.getMonth();switch(t){case"M":case"MM":return Be.M(e,t);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,n){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return ze(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,n,a){const r=Ye(e,a);return"wo"===t?n.ordinalNumber(r,{unit:"week"}):ze(r,t.length)},I:function(e,t,n){const a=$e(e);return"Io"===t?n.ordinalNumber(a,{unit:"week"}):ze(a,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):Be.d(e,t)},D:function(e,t,n){const a=function(e,t){const n=fe(e,t?.in);return ke(n,Me(n))+1}(e);return"Do"===t?n.ordinalNumber(a,{unit:"dayOfYear"}):ze(a,t.length)},E:function(e,t,n){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,n,a){const r=e.getDay(),i=(r-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return ze(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,a){const r=e.getDay(),i=(r-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return ze(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const a=e.getDay(),r=0===a?7:a;switch(t){case"i":return String(r);case"ii":return ze(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const a=e.getHours();let r;switch(r=12===a?He:0===a?Ae:a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const a=e.getHours();let r;switch(r=a>=17?Ze:a>=12?Re:a>=4?Ue:Ke,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return Be.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):Be.H(e,t)},K:function(e,t,n){const a=e.getHours()%12;return"Ko"===t?n.ordinalNumber(a,{unit:"hour"}):ze(a,t.length)},k:function(e,t,n){let a=e.getHours();return 0===a&&(a=24),"ko"===t?n.ordinalNumber(a,{unit:"hour"}):ze(a,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Be.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Be.s(e,t)},S:function(e,t){return Be.S(e,t)},X:function(e,t,n){const a=e.getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return Ge(a);case"XXXX":case"XX":return Xe(a);default:return Xe(a,":")}},x:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"x":return Ge(a);case"xxxx":case"xx":return Xe(a);default:return Xe(a,":")}},O:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Qe(a,":");default:return"GMT"+Xe(a,":")}},z:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Qe(a,":");default:return"GMT"+Xe(a,":")}},t:function(e,t,n){return ze(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return ze(+e,t.length)}};function Qe(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=Math.trunc(a/60),i=a%60;return 0===i?n+String(r):n+String(r)+t+ze(i,2)}function Ge(e,t){if(e%60==0){return(e>0?"-":"+")+ze(Math.abs(e)/60,2)}return Xe(e,t)}function Xe(e,t=""){const n=e>0?"-":"+",a=Math.abs(e);return n+ze(Math.trunc(a/60),2)+t+ze(a%60,2)}const Je=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},et=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},tt={p:et,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],a=n[1],r=n[2];if(!r)return Je(e,t);let i;switch(a){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"})}return i.replace("{{date}}",Je(a,t)).replace("{{time}}",et(r,t))}},nt=/^D+$/,at=/^Y+$/,rt=["D","DD","YY","YYYY"];const it=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,st=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ot=/^'([^]*?)'?$/,dt=/''/g,ct=/[a-zA-Z]/;function lt(e,t,n){const a=ve(),r=n?.locale??a.locale??Fe,i=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,o=fe(e,n?.in);if(!function(e){return!(!Se(e)&&"number"!=typeof e||isNaN(+fe(e)))}(o))throw new RangeError("Invalid time value");let d=t.match(st).map(e=>{const t=e[0];if("p"===t||"P"===t){return(0,tt[t])(e,r.formatLong)}return e}).join("").match(it).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:ut(e)};if(Ve[t])return{isToken:!0,value:e};if(t.match(ct))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});r.localize.preprocessor&&(d=r.localize.preprocessor(o,d));const c={firstWeekContainsDate:i,weekStartsOn:s,locale:r};return d.map(a=>{if(!a.isToken)return a.value;const i=a.value;(!n?.useAdditionalWeekYearTokens&&function(e){return at.test(e)}(i)||!n?.useAdditionalDayOfYearTokens&&function(e){return nt.test(e)}(i))&&function(e,t,n){const a=function(e,t,n){const a="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(rt.includes(e))throw new RangeError(a)}(i,t,String(e));return(0,Ve[i[0]])(o,i,r.localize,c)}).join("")}function ut(e){const t=e.match(ot);return t?t[1].replace(dt,"'"):e}function mt(e,t,n){const a=fe(e,n?.in),r=a.getFullYear(),i=a.getDate(),s=he(e,0);s.setFullYear(r,t,15),s.setHours(0,0,0,0);const o=function(e,t){const n=fe(e,t?.in),a=n.getFullYear(),r=n.getMonth(),i=he(n,0);return i.setFullYear(a,r+1,0),i.setHours(0,0,0,0),i.getDate()}(s);return a.setMonth(t,Math.min(i,o)),a}function ht(e,t){const n=t.startOfMonth(e),a=n.getDay();return 1===a?n:0===a?t.addDays(n,-6):t.addDays(n,-1*(a-1))}class ft{constructor(e,t){this.Date=Date,this.today=()=>this.overrides?.today?this.overrides.today():this.options.timeZone?le.tz(this.options.timeZone):new this.Date,this.newDate=(e,t,n)=>this.overrides?.newDate?this.overrides.newDate(e,t,n):this.options.timeZone?new le(e,t,n,this.options.timeZone):new Date(e,t,n),this.addDays=(e,t)=>this.overrides?.addDays?this.overrides.addDays(e,t):pe(e,t),this.addMonths=(e,t)=>this.overrides?.addMonths?this.overrides.addMonths(e,t):ge(e,t),this.addWeeks=(e,t)=>this.overrides?.addWeeks?this.overrides.addWeeks(e,t):function(e,t,n){return pe(e,7*t,n)}(e,t),this.addYears=(e,t)=>this.overrides?.addYears?this.overrides.addYears(e,t):function(e,t,n){return ge(e,12*t,n)}(e,t),this.differenceInCalendarDays=(e,t)=>this.overrides?.differenceInCalendarDays?this.overrides.differenceInCalendarDays(e,t):ke(e,t),this.differenceInCalendarMonths=(e,t)=>this.overrides?.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(e,t):function(e,t){const[n,a]=Ne(0,e,t);return 12*(n.getFullYear()-a.getFullYear())+(n.getMonth()-a.getMonth())}(e,t),this.eachMonthOfInterval=e=>this.overrides?.eachMonthOfInterval?this.overrides.eachMonthOfInterval(e):De(e),this.endOfBroadcastWeek=e=>this.overrides?.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(e):function(e,t){const n=ht(e,t),a=function(e,t){const n=t.startOfMonth(e),a=n.getDay()>0?n.getDay():7,r=t.addDays(e,1-a),i=t.addDays(r,34);return t.getMonth(e)===t.getMonth(i)?5:4}(e,t);return t.addDays(n,7*a-1)}(e,this),this.endOfISOWeek=e=>this.overrides?.endOfISOWeek?this.overrides.endOfISOWeek(e):function(e,t){return Ce(e,{...t,weekStartsOn:1})}(e),this.endOfMonth=e=>this.overrides?.endOfMonth?this.overrides.endOfMonth(e):function(e,t){const n=fe(e,t?.in),a=n.getMonth();return n.setFullYear(n.getFullYear(),a+1,0),n.setHours(23,59,59,999),n}(e),this.endOfWeek=(e,t)=>this.overrides?.endOfWeek?this.overrides.endOfWeek(e,t):Ce(e,this.options),this.endOfYear=e=>this.overrides?.endOfYear?this.overrides.endOfYear(e):function(e,t){const n=fe(e,t?.in),a=n.getFullYear();return n.setFullYear(a+1,0,0),n.setHours(23,59,59,999),n}(e),this.format=(e,t,n)=>{const a=this.overrides?.format?this.overrides.format(e,t,this.options):lt(e,t,this.options);return this.options.numerals&&"latn"!==this.options.numerals?this.replaceDigits(a):a},this.getISOWeek=e=>this.overrides?.getISOWeek?this.overrides.getISOWeek(e):$e(e),this.getMonth=(e,t)=>this.overrides?.getMonth?this.overrides.getMonth(e,this.options):function(e,t){return fe(e,t?.in).getMonth()}(e,this.options),this.getYear=(e,t)=>this.overrides?.getYear?this.overrides.getYear(e,this.options):function(e,t){return fe(e,t?.in).getFullYear()}(e,this.options),this.getWeek=(e,t)=>this.overrides?.getWeek?this.overrides.getWeek(e,this.options):Ye(e,this.options),this.isAfter=(e,t)=>this.overrides?.isAfter?this.overrides.isAfter(e,t):function(e,t){return+fe(e)>+fe(t)}(e,t),this.isBefore=(e,t)=>this.overrides?.isBefore?this.overrides.isBefore(e,t):function(e,t){return+fe(e)<+fe(t)}(e,t),this.isDate=e=>this.overrides?.isDate?this.overrides.isDate(e):Se(e),this.isSameDay=(e,t)=>this.overrides?.isSameDay?this.overrides.isSameDay(e,t):function(e,t){const[n,a]=Ne(0,e,t);return+je(n)===+je(a)}(e,t),this.isSameMonth=(e,t)=>this.overrides?.isSameMonth?this.overrides.isSameMonth(e,t):function(e,t){const[n,a]=Ne(0,e,t);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}(e,t),this.isSameYear=(e,t)=>this.overrides?.isSameYear?this.overrides.isSameYear(e,t):function(e,t){const[n,a]=Ne(0,e,t);return n.getFullYear()===a.getFullYear()}(e,t),this.max=e=>this.overrides?.max?this.overrides.max(e):function(e,t){let n,a=t?.in;return e.forEach(e=>{a||"object"!=typeof e||(a=he.bind(null,e));const t=fe(e,a);(!n||n<t||isNaN(+t))&&(n=t)}),he(a,n||NaN)}(e),this.min=e=>this.overrides?.min?this.overrides.min(e):function(e,t){let n,a=t?.in;return e.forEach(e=>{a||"object"!=typeof e||(a=he.bind(null,e));const t=fe(e,a);(!n||n>t||isNaN(+t))&&(n=t)}),he(a,n||NaN)}(e),this.setMonth=(e,t)=>this.overrides?.setMonth?this.overrides.setMonth(e,t):mt(e,t),this.setYear=(e,t)=>this.overrides?.setYear?this.overrides.setYear(e,t):function(e,t,n){const a=fe(e,n?.in);return isNaN(+a)?he(e,NaN):(a.setFullYear(t),a)}(e,t),this.startOfBroadcastWeek=(e,t)=>this.overrides?.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(e,this):ht(e,this),this.startOfDay=e=>this.overrides?.startOfDay?this.overrides.startOfDay(e):je(e),this.startOfISOWeek=e=>this.overrides?.startOfISOWeek?this.overrides.startOfISOWeek(e):ye(e),this.startOfMonth=e=>this.overrides?.startOfMonth?this.overrides.startOfMonth(e):function(e,t){const n=fe(e,t?.in);return n.setDate(1),n.setHours(0,0,0,0),n}(e),this.startOfWeek=(e,t)=>this.overrides?.startOfWeek?this.overrides.startOfWeek(e,this.options):xe(e,this.options),this.startOfYear=e=>this.overrides?.startOfYear?this.overrides.startOfYear(e):Me(e),this.options={locale:Fe,...e},this.overrides=t}getDigitMap(){const{numerals:e="latn"}=this.options,t=new Intl.NumberFormat("en-US",{numberingSystem:e}),n={};for(let a=0;a<10;a++)n[a.toString()]=t.format(a);return n}replaceDigits(e){const t=this.getDigitMap();return e.replace(/\d/g,e=>t[e]||e)}formatNumber(e){return this.replaceDigits(e.toString())}}const pt=new ft;class gt{constructor(e,t,n=pt){this.date=e,this.displayMonth=t,this.outside=Boolean(t&&!n.isSameMonth(e,t)),this.dateLib=n}isEqualTo(e){return this.dateLib.isSameDay(e.date,this.date)&&this.dateLib.isSameMonth(e.displayMonth,this.displayMonth)}}class _t{constructor(e,t){this.date=e,this.weeks=t}}class vt{constructor(e,t){this.days=t,this.weekNumber=e}}var xt,yt,bt,wt,Nt,jt,kt,St;(yt=xt||(xt={})).Root="root",yt.Chevron="chevron",yt.Day="day",yt.DayButton="day_button",yt.CaptionLabel="caption_label",yt.Dropdowns="dropdowns",yt.Dropdown="dropdown",yt.DropdownRoot="dropdown_root",yt.Footer="footer",yt.MonthGrid="month_grid",yt.MonthCaption="month_caption",yt.MonthsDropdown="months_dropdown",yt.Month="month",yt.Months="months",yt.Nav="nav",yt.NextMonthButton="button_next",yt.PreviousMonthButton="button_previous",yt.Week="week",yt.Weeks="weeks",yt.Weekday="weekday",yt.Weekdays="weekdays",yt.WeekNumber="week_number",yt.WeekNumberHeader="week_number_header",yt.YearsDropdown="years_dropdown",(wt=bt||(bt={})).disabled="disabled",wt.hidden="hidden",wt.outside="outside",wt.focused="focused",wt.today="today",(jt=Nt||(Nt={})).range_end="range_end",jt.range_middle="range_middle",jt.range_start="range_start",jt.selected="selected",(St=kt||(kt={})).weeks_before_enter="weeks_before_enter",St.weeks_before_exit="weeks_before_exit",St.weeks_after_enter="weeks_after_enter",St.weeks_after_exit="weeks_after_exit",St.caption_after_enter="caption_after_enter",St.caption_after_exit="caption_after_exit",St.caption_before_enter="caption_before_enter",St.caption_before_exit="caption_before_exit";const Dt=n.createContext(void 0);function Mt(){const e=n.useContext(Dt);if(void 0===e)throw new Error("useDayPicker() must be used within a custom component.");return e}const Ct=Object.freeze(Object.defineProperty({__proto__:null,Button:function(e){return t.createElement("button",{...e})},CaptionLabel:function(e){return t.createElement("span",{...e})},Chevron:function(e){const{size:n=24,orientation:a="left",className:r}=e;return t.createElement("svg",{className:r,width:n,height:n,viewBox:"0 0 24 24"},"up"===a&&t.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),"down"===a&&t.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),"left"===a&&t.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),"right"===a&&t.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))},Day:function(e){const{day:n,modifiers:a,...r}=e;return t.createElement("td",{...r})},DayButton:function(e){const{day:n,modifiers:a,...r}=e,i=t.useRef(null);return t.useEffect(()=>{a.focused&&i.current?.focus()},[a.focused]),t.createElement("button",{ref:i,...r})},Dropdown:function(e){const{options:n,className:a,components:r,classNames:i,...s}=e,o=[i[xt.Dropdown],a].join(" "),d=n?.find(({value:e})=>e===s.value);return t.createElement("span",{"data-disabled":s.disabled,className:i[xt.DropdownRoot]},t.createElement(r.Select,{className:o,...s},n?.map(({value:e,label:n,disabled:a})=>t.createElement(r.Option,{key:e,value:e,disabled:a},n))),t.createElement("span",{className:i[xt.CaptionLabel],"aria-hidden":!0},d?.label,t.createElement(r.Chevron,{orientation:"down",size:18,className:i[xt.Chevron]})))},DropdownNav:function(e){return t.createElement("div",{...e})},Footer:function(e){return t.createElement("div",{...e})},Month:function(e){const{calendarMonth:n,displayIndex:a,...r}=e;return t.createElement("div",{...r},e.children)},MonthCaption:function(e){const{calendarMonth:n,displayIndex:a,...r}=e;return t.createElement("div",{...r})},MonthGrid:function(e){return t.createElement("table",{...e})},Months:function(e){return t.createElement("div",{...e})},MonthsDropdown:function(e){const{components:n}=Mt();return t.createElement(n.Dropdown,{...e})},Nav:function(e){const{onPreviousClick:a,onNextClick:r,previousMonth:i,nextMonth:s,...o}=e,{components:d,classNames:c,labels:{labelPrevious:l,labelNext:u}}=Mt(),m=n.useCallback(e=>{s&&r?.(e)},[s,r]),h=n.useCallback(e=>{i&&a?.(e)},[i,a]);return t.createElement("nav",{...o},t.createElement(d.PreviousMonthButton,{type:"button",className:c[xt.PreviousMonthButton],tabIndex:i?void 0:-1,"aria-disabled":!i||void 0,"aria-label":l(i),onClick:h},t.createElement(d.Chevron,{disabled:!i||void 0,className:c[xt.Chevron],orientation:"left"})),t.createElement(d.NextMonthButton,{type:"button",className:c[xt.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":!s||void 0,"aria-label":u(s),onClick:m},t.createElement(d.Chevron,{disabled:!s||void 0,orientation:"right",className:c[xt.Chevron]})))},NextMonthButton:function(e){const{components:n}=Mt();return t.createElement(n.Button,{...e})},Option:function(e){return t.createElement("option",{...e})},PreviousMonthButton:function(e){const{components:n}=Mt();return t.createElement(n.Button,{...e})},Root:function(e){const{rootRef:n,...a}=e;return t.createElement("div",{...a,ref:n})},Select:function(e){return t.createElement("select",{...e})},Week:function(e){const{week:n,...a}=e;return t.createElement("tr",{...a})},WeekNumber:function(e){const{week:n,...a}=e;return t.createElement("th",{...a})},WeekNumberHeader:function(e){return t.createElement("th",{...e})},Weekday:function(e){return t.createElement("th",{...e})},Weekdays:function(e){return t.createElement("thead",{"aria-hidden":!0},t.createElement("tr",{...e}))},Weeks:function(e){return t.createElement("tbody",{...e})},YearsDropdown:function(e){const{components:n}=Mt();return t.createElement(n.Dropdown,{...e})}},Symbol.toStringTag,{value:"Module"}));function qt(e,t,n=!1,a=pt){let{from:r,to:i}=e;const{differenceInCalendarDays:s,isSameDay:o}=a;if(r&&i){s(i,r)<0&&([r,i]=[i,r]);return s(t,r)>=(n?1:0)&&s(i,t)>=(n?1:0)}return!n&&i?o(i,t):!(n||!r)&&o(r,t)}function Ot(e){return Boolean(e&&"object"==typeof e&&"before"in e&&"after"in e)}function Wt(e){return Boolean(e&&"object"==typeof e&&"from"in e)}function It(e){return Boolean(e&&"object"==typeof e&&"after"in e)}function Tt(e){return Boolean(e&&"object"==typeof e&&"before"in e)}function Pt(e){return Boolean(e&&"object"==typeof e&&"dayOfWeek"in e)}function Et(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Ft(e,t,n=pt){const a=Array.isArray(t)?t:[t],{isSameDay:r,differenceInCalendarDays:i,isAfter:s}=n;return a.some(t=>{if("boolean"==typeof t)return t;if(n.isDate(t))return r(e,t);if(Et(t,n))return t.includes(e);if(Wt(t))return qt(t,e,!1,n);if(Pt(t))return Array.isArray(t.dayOfWeek)?t.dayOfWeek.includes(e.getDay()):t.dayOfWeek===e.getDay();if(Ot(t)){const n=i(t.before,e)>0,a=i(t.after,e)<0;return s(t.before,t.after)?a&&n:n||a}return It(t)?i(e,t.after)>0:Tt(t)?i(t.before,e)>0:"function"==typeof t&&t(e)})}function $t(){const e={};for(const t in xt)e[xt[t]]=`rdp-${xt[t]}`;for(const t in bt)e[bt[t]]=`rdp-${bt[t]}`;for(const t in Nt)e[Nt[t]]=`rdp-${Nt[t]}`;for(const t in kt)e[kt[t]]=`rdp-${kt[t]}`;return e}function Lt(e,t,n){return(n??new ft(t)).format(e,"LLLL y")}const Yt=Lt;function zt(e,t=pt){return t.format(e,"yyyy")}const Bt=zt,At=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Lt,formatDay:function(e,t,n){return(n??new ft(t)).format(e,"d")},formatMonthCaption:Yt,formatMonthDropdown:function(e,t=pt){return t.format(e,"LLLL")},formatWeekNumber:function(e,t=pt){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)},formatWeekNumberHeader:function(){return""},formatWeekdayName:function(e,t,n){return(n??new ft(t)).format(e,"cccccc")},formatYearCaption:Bt,formatYearDropdown:zt},Symbol.toStringTag,{value:"Module"}));function Ht(e,t,n,a,r){const{startOfMonth:i,startOfYear:s,endOfYear:o,eachMonthOfInterval:d,getMonth:c}=r;return d({start:s(e),end:o(e)}).map(e=>{const s=a.formatMonthDropdown(e,r);return{value:c(e),label:s,disabled:t&&e<i(t)||n&&e>i(n)||!1}})}function Ut(e,t,n,a,r=!1){if(!e)return;if(!t)return;const{startOfYear:i,endOfYear:s,addYears:o,getYear:d,isBefore:c,isSameYear:l}=a,u=i(e),m=s(t),h=[];let f=u;for(;c(f,m)||l(f,m);)h.push(f),f=o(f,1);return r&&h.reverse(),h.map(e=>{const t=n.formatYearDropdown(e,a);return{value:d(e),label:t,disabled:!1}})}function Rt(e,t,n,a){let r=(a??new ft(n)).format(e,"PPPP");return t.today&&(r=`Today, ${r}`),t.selected&&(r=`${r}, selected`),r}const Zt=Rt;function Kt(e,t,n){return(n??new ft(t)).format(e,"LLLL y")}const Vt=Kt;const Qt=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:Vt,labelDay:Zt,labelDayButton:Rt,labelGrid:Kt,labelGridcell:function(e,t,n,a){let r=(a??new ft(n)).format(e,"PPPP");return t?.today&&(r=`Today, ${r}`),r},labelMonthDropdown:function(e){return"Choose the Month"},labelNav:function(){return""},labelNext:function(e){return"Go to the Next Month"},labelPrevious:function(e){return"Go to the Previous Month"},labelWeekNumber:function(e,t){return`Week ${e}`},labelWeekNumberHeader:function(e){return"Week Number"},labelWeekday:function(e,t,n){return(n??new ft(t)).format(e,"cccc")},labelYearDropdown:function(e){return"Choose the Year"}},Symbol.toStringTag,{value:"Module"})),Gt=e=>e instanceof HTMLElement?e:null,Xt=e=>[...e.querySelectorAll("[data-animated-month]")??[]],Jt=e=>Gt(e.querySelector("[data-animated-caption]")),en=e=>Gt(e.querySelector("[data-animated-weeks]"));function tn(e,t,{classNames:a,months:r,focused:i,dateLib:s}){const o=n.useRef(null),d=n.useRef(r),c=n.useRef(!1);n.useLayoutEffect(()=>{const n=d.current;if(d.current=r,!(t&&e.current&&e.current instanceof HTMLElement&&0!==r.length&&0!==n.length&&r.length===n.length))return;const l=s.isSameMonth(r[0].date,n[0].date),u=s.isAfter(r[0].date,n[0].date),m=u?a[kt.caption_after_enter]:a[kt.caption_before_enter],h=u?a[kt.weeks_after_enter]:a[kt.weeks_before_enter],f=o.current,p=e.current.cloneNode(!0);if(p instanceof HTMLElement){Xt(p).forEach(e=>{if(!(e instanceof HTMLElement))return;const t=Gt(e.querySelector("[data-animated-month]"));t&&e.contains(t)&&e.removeChild(t);const n=Jt(e);n&&n.classList.remove(m);const a=en(e);a&&a.classList.remove(h)}),o.current=p}else o.current=null;if(c.current||l||i)return;const g=f instanceof HTMLElement?Xt(f):[],_=Xt(e.current);if(_?.every(e=>e instanceof HTMLElement)&&g&&g.every(e=>e instanceof HTMLElement)){c.current=!0,e.current.style.isolation="isolate";const t=(v=e.current,Gt(v.querySelector("[data-animated-nav]")));t&&(t.style.zIndex="1"),_.forEach((n,r)=>{const i=g[r];if(!i)return;n.style.position="relative",n.style.overflow="hidden";const s=Jt(n);s&&s.classList.add(m);const o=en(n);o&&o.classList.add(h);const d=()=>{c.current=!1,e.current&&(e.current.style.isolation=""),t&&(t.style.zIndex=""),s&&s.classList.remove(m),o&&o.classList.remove(h),n.style.position="",n.style.overflow="",n.contains(i)&&n.removeChild(i)};i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",i.setAttribute("aria-hidden","true");const l=(e=>Gt(e.querySelector("[data-animated-weekdays]")))(i);l&&(l.style.opacity="0");const f=Jt(i);f&&(f.classList.add(u?a[kt.caption_before_exit]:a[kt.caption_after_exit]),f.addEventListener("animationend",d));const p=en(i);p&&p.classList.add(u?a[kt.weeks_before_exit]:a[kt.weeks_after_exit]),n.insertBefore(i,n.firstChild)})}var v})}function nn(e,t,n,a){const{month:r,defaultMonth:i,today:s=a.today(),numberOfMonths:o=1}=e;let d=r||i||s;const{differenceInCalendarMonths:c,addMonths:l,startOfMonth:u}=a;if(n&&c(n,d)<o-1){d=l(n,-1*(o-1))}return t&&c(d,t)<0&&(d=t),u(d)}function an(e,t){const[a,r]=n.useState(e);return[void 0===t?a:t,r]}function rn(e,t){const[a,r]=function(e,t){let{startMonth:n,endMonth:a}=e;const{startOfYear:r,startOfDay:i,startOfMonth:s,endOfMonth:o,addYears:d,endOfYear:c,newDate:l,today:u}=t,{fromYear:m,toYear:h,fromMonth:f,toMonth:p}=e;!n&&f&&(n=f),!n&&m&&(n=t.newDate(m,0,1)),!a&&p&&(a=p),!a&&h&&(a=l(h,11,31));const g="dropdown"===e.captionLayout||"dropdown-years"===e.captionLayout;return n?n=s(n):m?n=l(m,0,1):!n&&g&&(n=r(d(e.today??u(),-100))),a?a=o(a):h?a=l(h,11,31):!a&&g&&(a=c(e.today??u())),[n?i(n):n,a?i(a):a]}(e,t),{startOfMonth:i,endOfMonth:s}=t,o=nn(e,a,r,t),[d,c]=an(o,e.month?o:void 0);n.useEffect(()=>{const n=nn(e,a,r,t);c(n)},[e.timeZone]);const l=function(e,t,n,a){const{numberOfMonths:r=1}=n,i=[];for(let s=0;s<r;s++){const n=a.addMonths(e,s);if(t&&n>t)break;i.push(n)}return i}(d,r,e,t),u=function(e,t,n,a){const r=e[0],i=e[e.length-1],{ISOWeek:s,fixedWeeks:o,broadcastCalendar:d}=n??{},{addDays:c,differenceInCalendarDays:l,differenceInCalendarMonths:u,endOfBroadcastWeek:m,endOfISOWeek:h,endOfMonth:f,endOfWeek:p,isAfter:g,startOfBroadcastWeek:_,startOfISOWeek:v,startOfWeek:x}=a,y=d?_(r,a):s?v(r):x(r),b=l(d?m(i):s?h(f(i)):p(f(i)),y),w=u(i,r)+1,N=[];for(let k=0;k<=b;k++){const e=c(y,k);if(t&&g(e,t))break;N.push(e)}const j=(d?35:42)*w;if(o&&N.length<j){const e=j-N.length;for(let t=0;t<e;t++){const e=c(N[N.length-1],1);N.push(e)}}return N}(l,e.endMonth?s(e.endMonth):void 0,e,t),m=function(e,t,n,a){const{addDays:r,endOfBroadcastWeek:i,endOfISOWeek:s,endOfMonth:o,endOfWeek:d,getISOWeek:c,getWeek:l,startOfBroadcastWeek:u,startOfISOWeek:m,startOfWeek:h}=a,f=e.reduce((e,f)=>{const p=n.broadcastCalendar?u(f,a):n.ISOWeek?m(f):h(f),g=n.broadcastCalendar?i(f):n.ISOWeek?s(o(f)):d(o(f)),_=t.filter(e=>e>=p&&e<=g),v=n.broadcastCalendar?35:42;if(n.fixedWeeks&&_.length<v){const e=t.filter(e=>{const t=v-_.length;return e>g&&e<=r(g,t)});_.push(...e)}const x=_.reduce((e,t)=>{const r=n.ISOWeek?c(t):l(t),i=e.find(e=>e.weekNumber===r),s=new gt(t,f,a);return i?i.days.push(s):e.push(new vt(r,[s])),e},[]),y=new _t(f,x);return e.push(y),e},[]);return n.reverseMonths?f.reverse():f}(l,u,e,t),h=function(e){return e.reduce((e,t)=>e.concat(t.weeks.slice()),[].slice())}(m),f=function(e){const t=[];return e.reduce((e,n)=>{const a=n.weeks.reduce((e,t)=>e.concat(t.days.slice()),t.slice());return e.concat(a.slice())},t.slice())}(m),p=function(e,t,n,a){if(n.disableNavigation)return;const{pagedNavigation:r,numberOfMonths:i}=n,{startOfMonth:s,addMonths:o,differenceInCalendarMonths:d}=a,c=r?i??1:1,l=s(e);return t&&d(l,t)<=0?void 0:o(l,-c)}(d,a,e,t),g=function(e,t,n,a){if(n.disableNavigation)return;const{pagedNavigation:r,numberOfMonths:i=1}=n,{startOfMonth:s,addMonths:o,differenceInCalendarMonths:d}=a,c=r?i:1,l=s(e);return t&&d(t,e)<i?void 0:o(l,c)}(d,r,e,t),{disableNavigation:_,onMonthChange:v}=e,x=e=>{if(_)return;let t=i(e);a&&t<i(a)&&(t=i(a)),r&&t>i(r)&&(t=i(r)),c(t),v?.(t)};return{months:m,weeks:h,days:f,navStart:a,navEnd:r,previousMonth:p,nextMonth:g,goToMonth:x,goToDay:e=>{(e=>h.some(t=>t.days.some(t=>t.isEqualTo(e))))(e)||x(e.date)}}}var sn,on;function dn(e){return!e[bt.disabled]&&!e[bt.hidden]&&!e[bt.outside]}function cn(e,t,n,a,r,i,s,o=0){if(o>365)return;const d=function(e,t,n,a,r,i,s){const{ISOWeek:o,broadcastCalendar:d}=i,{addDays:c,addMonths:l,addWeeks:u,addYears:m,endOfBroadcastWeek:h,endOfISOWeek:f,endOfWeek:p,max:g,min:_,startOfBroadcastWeek:v,startOfISOWeek:x,startOfWeek:y}=s;let b={day:c,week:u,month:l,year:m,startOfWeek:e=>d?v(e,s):o?x(e):y(e),endOfWeek:e=>d?h(e):o?f(e):p(e)}[e](n,"after"===t?1:-1);return"before"===t&&a?b=g([a,b]):"after"===t&&r&&(b=_([r,b])),b}(e,t,n.date,a,r,i,s),c=Boolean(i.disabled&&Ft(d,i.disabled,s)),l=Boolean(i.hidden&&Ft(d,i.hidden,s)),u=new gt(d,d,s);return c||l?cn(e,t,u,a,r,i,s,o+1):u}function ln(e,t,a,r,i){const{autoFocus:s}=e,[o,d]=n.useState(),c=function(e,t,n,a){let r,i=-1;for(const s of e){const e=t(s);dn(e)&&(e[bt.focused]&&i<sn.FocusedModifier?(r=s,i=sn.FocusedModifier):a?.isEqualTo(s)&&i<sn.LastFocused?(r=s,i=sn.LastFocused):n(s.date)&&i<sn.Selected?(r=s,i=sn.Selected):e[bt.today]&&i<sn.Today&&(r=s,i=sn.Today))}return r||(r=e.find(e=>dn(t(e)))),r}(t.days,a,r||(()=>!1),o),[l,u]=n.useState(s?c:void 0);return{isFocusTarget:e=>Boolean(c?.isEqualTo(e)),setFocused:u,focused:l,blur:()=>{d(l),u(void 0)},moveFocus:(n,a)=>{if(!l)return;const r=cn(n,a,l,t.navStart,t.navEnd,e,i);r&&(t.goToDay(r),u(r))}}}function un(e,t,n=pt){return qt(e,t.from,!1,n)||qt(e,t.to,!1,n)||qt(t,e.from,!1,n)||qt(t,e.to,!1,n)}function mn(e,t,n=pt){const a=Array.isArray(t)?t:[t];if(a.filter(e=>"function"!=typeof e).some(t=>{if("boolean"==typeof t)return t;if(n.isDate(t))return qt(e,t,!1,n);if(Et(t,n))return t.some(t=>qt(e,t,!1,n));if(Wt(t))return!(!t.from||!t.to)&&un(e,{from:t.from,to:t.to},n);if(Pt(t))return function(e,t,n=pt){const a=Array.isArray(t)?t:[t];let r=e.from;const i=n.differenceInCalendarDays(e.to,e.from),s=Math.min(i,6);for(let o=0;o<=s;o++){if(a.includes(r.getDay()))return!0;r=n.addDays(r,1)}return!1}(e,t.dayOfWeek,n);if(Ot(t)){return n.isAfter(t.before,t.after)?un(e,{from:n.addDays(t.after,1),to:n.addDays(t.before,-1)},n):Ft(e.from,t,n)||Ft(e.to,t,n)}return!(!It(t)&&!Tt(t))&&(Ft(e.from,t,n)||Ft(e.to,t,n))}))return!0;const r=a.filter(e=>"function"==typeof e);if(r.length){let t=e.from;const a=n.differenceInCalendarDays(e.to,e.from);for(let e=0;e<=a;e++){if(r.some(e=>e(t)))return!0;t=n.addDays(t,1)}}return!1}function hn(e,t){const{disabled:n,excludeDisabled:a,selected:r,required:i,onSelect:s}=e,[o,d]=an(r,s?r:void 0),c=s?r:o;return{selected:c,select:(r,o,l)=>{const{min:u,max:m}=e,h=r?function(e,t,n=0,a=0,r=!1,i=pt){const{from:s,to:o}=t||{},{isSameDay:d,isAfter:c,isBefore:l}=i;let u;if(s||o){if(s&&!o)u=d(s,e)?0===n?{from:s,to:e}:r?{from:s,to:void 0}:void 0:l(e,s)?{from:e,to:s}:{from:s,to:e};else if(s&&o)if(d(s,e)&&d(o,e))u=r?{from:s,to:o}:void 0;else if(d(s,e))u={from:s,to:n>0?void 0:e};else if(d(o,e))u={from:e,to:n>0?void 0:e};else if(l(e,s))u={from:e,to:o};else if(c(e,s))u={from:s,to:e};else{if(!c(e,o))throw new Error("Invalid range");u={from:s,to:e}}}else u={from:e,to:n>0?void 0:e};if(u?.from&&u?.to){const t=i.differenceInCalendarDays(u.to,u.from);(a>0&&t>a||n>1&&t<n)&&(u={from:e,to:void 0})}return u}(r,c,u,m,i,t):void 0;return a&&n&&h?.from&&h.to&&mn({from:h.from,to:h.to},n,t)&&(h.from=r,h.to=void 0),s||d(h),s?.(h,r,o,l),h},isSelected:e=>c&&qt(c,e,!1,t)}}function fn(e,t){const n=function(e,t){const{selected:n,required:a,onSelect:r}=e,[i,s]=an(n,r?n:void 0),o=r?n:i,{isSameDay:d}=t;return{selected:o,select:(e,t,n)=>{let i=e;return!a&&o&&o&&d(e,o)&&(i=void 0),r||s(i),r?.(i,e,t,n),i},isSelected:e=>!!o&&d(o,e)}}(e,t),a=function(e,t){const{selected:n,required:a,onSelect:r}=e,[i,s]=an(n,r?n:void 0),o=r?n:i,{isSameDay:d}=t,c=e=>o?.some(t=>d(t,e))??!1,{min:l,max:u}=e;return{selected:o,select:(e,t,n)=>{let i=[...o??[]];if(c(e)){if(o?.length===l)return;if(a&&1===o?.length)return;i=o?.filter(t=>!d(t,e))}else i=o?.length===u?[e]:[...i,e];return r||s(i),r?.(i,e,t,n),i},isSelected:c}}(e,t),r=hn(e,t);switch(e.mode){case"single":return n;case"multiple":return a;case"range":return r;default:return}}function pn(e){let a=e;a.timeZone&&(a={...e},a.today&&(a.today=new le(a.today,a.timeZone)),a.month&&(a.month=new le(a.month,a.timeZone)),a.defaultMonth&&(a.defaultMonth=new le(a.defaultMonth,a.timeZone)),a.startMonth&&(a.startMonth=new le(a.startMonth,a.timeZone)),a.endMonth&&(a.endMonth=new le(a.endMonth,a.timeZone)),"single"===a.mode&&a.selected?a.selected=new le(a.selected,a.timeZone):"multiple"===a.mode&&a.selected?a.selected=a.selected?.map(e=>new le(e,a.timeZone)):"range"===a.mode&&a.selected&&(a.selected={from:a.selected.from?new le(a.selected.from,a.timeZone):void 0,to:a.selected.to?new le(a.selected.to,a.timeZone):void 0}));const{components:r,formatters:i,labels:s,dateLib:o,locale:d,classNames:c}=n.useMemo(()=>{const e={...Fe,...a.locale};return{dateLib:new ft({locale:e,weekStartsOn:a.broadcastCalendar?1:a.weekStartsOn,firstWeekContainsDate:a.firstWeekContainsDate,useAdditionalWeekYearTokens:a.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:a.useAdditionalDayOfYearTokens,timeZone:a.timeZone,numerals:a.numerals},a.dateLib),components:(n=a.components,{...Ct,...n}),formatters:(t=a.formatters,t?.formatMonthCaption&&!t.formatCaption&&(t.formatCaption=t.formatMonthCaption),t?.formatYearCaption&&!t.formatYearDropdown&&(t.formatYearDropdown=t.formatYearCaption),{...At,...t}),labels:{...Qt,...a.labels},locale:e,classNames:{...$t(),...a.classNames}};var t,n},[a.locale,a.broadcastCalendar,a.weekStartsOn,a.firstWeekContainsDate,a.useAdditionalWeekYearTokens,a.useAdditionalDayOfYearTokens,a.timeZone,a.numerals,a.dateLib,a.components,a.formatters,a.labels,a.classNames]),{captionLayout:l,mode:u,navLayout:m,numberOfMonths:h=1,onDayBlur:f,onDayClick:p,onDayFocus:g,onDayKeyDown:_,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:y,onPrevClick:b,showWeekNumber:w,styles:N}=a,{formatCaption:j,formatDay:k,formatMonthDropdown:S,formatWeekNumber:D,formatWeekNumberHeader:M,formatWeekdayName:C,formatYearDropdown:q}=i,O=rn(a,o),{days:W,months:I,navStart:T,navEnd:P,previousMonth:E,nextMonth:F,goToMonth:$}=O,L=function(e,t,n,a,r){const{disabled:i,hidden:s,modifiers:o,showOutsideDays:d,broadcastCalendar:c,today:l}=t,{isSameDay:u,isSameMonth:m,startOfMonth:h,isBefore:f,endOfMonth:p,isAfter:g}=r,_=n&&h(n),v=a&&p(a),x={[bt.focused]:[],[bt.outside]:[],[bt.disabled]:[],[bt.hidden]:[],[bt.today]:[]},y={};for(const b of e){const{date:e,displayMonth:t}=b,n=Boolean(t&&!m(e,t)),a=Boolean(_&&f(e,_)),h=Boolean(v&&g(e,v)),p=Boolean(i&&Ft(e,i,r)),w=Boolean(s&&Ft(e,s,r))||a||h||!c&&!d&&n||c&&!1===d&&n,N=u(e,l??r.today());n&&x.outside.push(b),p&&x.disabled.push(b),w&&x.hidden.push(b),N&&x.today.push(b),o&&Object.keys(o).forEach(t=>{const n=o?.[t];n&&Ft(e,n,r)&&(y[t]?y[t].push(b):y[t]=[b])})}return e=>{const t={[bt.focused]:!1,[bt.disabled]:!1,[bt.hidden]:!1,[bt.outside]:!1,[bt.today]:!1},n={};for(const a in x){const n=x[a];t[a]=n.some(t=>t===e)}for(const a in y)n[a]=y[a].some(t=>t===e);return{...t,...n}}}(W,a,T,P,o),{isSelected:Y,select:z,selected:B}=fn(a,o)??{},{blur:A,focused:H,isFocusTarget:U,moveFocus:R,setFocused:Z}=ln(a,O,L,Y??(()=>!1),o),{labelDayButton:K,labelGridcell:V,labelGrid:Q,labelMonthDropdown:G,labelNav:X,labelPrevious:J,labelNext:ee,labelWeekday:te,labelWeekNumber:ne,labelWeekNumberHeader:ae,labelYearDropdown:re}=s,ie=n.useMemo(()=>function(e,t){const n=e.today(),a=t?e.startOfISOWeek(n):e.startOfWeek(n),r=[];for(let i=0;i<7;i++){const t=e.addDays(a,i);r.push(t)}return r}(o,a.ISOWeek),[o,a.ISOWeek]),se=void 0!==u||void 0!==p,oe=n.useCallback(()=>{E&&($(E),b?.(E))},[E,$,b]),de=n.useCallback(()=>{F&&($(F),y?.(F))},[$,F,y]),ce=n.useCallback((e,t)=>n=>{n.preventDefault(),n.stopPropagation(),Z(e),z?.(e.date,t,n),p?.(e.date,t,n)},[z,p,Z]),ue=n.useCallback((e,t)=>n=>{Z(e),g?.(e.date,t,n)},[g,Z]),me=n.useCallback((e,t)=>n=>{A(),f?.(e.date,t,n)},[A,f]),he=n.useCallback((e,t)=>n=>{const r={ArrowLeft:[n.shiftKey?"month":"day","rtl"===a.dir?"after":"before"],ArrowRight:[n.shiftKey?"month":"day","rtl"===a.dir?"before":"after"],ArrowDown:[n.shiftKey?"year":"week","after"],ArrowUp:[n.shiftKey?"year":"week","before"],PageUp:[n.shiftKey?"year":"month","before"],PageDown:[n.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(r[n.key]){n.preventDefault(),n.stopPropagation();const[e,t]=r[n.key];R(e,t)}_?.(e.date,t,n)},[R,_,a.dir]),fe=n.useCallback((e,t)=>n=>{v?.(e.date,t,n)},[v]),pe=n.useCallback((e,t)=>n=>{x?.(e.date,t,n)},[x]),ge=n.useCallback(e=>t=>{const n=Number(t.target.value),a=o.setMonth(o.startOfMonth(e),n);$(a)},[o,$]),_e=n.useCallback(e=>t=>{const n=Number(t.target.value),a=o.setYear(o.startOfMonth(e),n);$(a)},[o,$]),{className:ve,style:xe}=n.useMemo(()=>({className:[c[xt.Root],a.className].filter(Boolean).join(" "),style:{...N?.[xt.Root],...a.style}}),[c,a.className,a.style,N]),ye=function(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([e,n])=>{e.startsWith("data-")&&(t[e]=n)}),t}(a),be=n.useRef(null);tn(be,Boolean(a.animate),{classNames:c,months:I,focused:H,dateLib:o});const we={dayPickerProps:a,selected:B,select:z,isSelected:Y,months:I,nextMonth:F,previousMonth:E,goToMonth:$,getModifiers:L,components:r,classNames:c,styles:N,labels:s,formatters:i};return t.createElement(Dt.Provider,{value:we},t.createElement(r.Root,{rootRef:a.animate?be:void 0,className:ve,style:xe,dir:a.dir,id:a.id,lang:a.lang,nonce:a.nonce,title:a.title,role:a.role,"aria-label":a["aria-label"],...ye},t.createElement(r.Months,{className:c[xt.Months],style:N?.[xt.Months]},!a.hideNavigation&&!m&&t.createElement(r.Nav,{"data-animated-nav":a.animate?"true":void 0,className:c[xt.Nav],style:N?.[xt.Nav],"aria-label":X(),onPreviousClick:oe,onNextClick:de,previousMonth:E,nextMonth:F}),I.map((e,n)=>t.createElement(r.Month,{"data-animated-month":a.animate?"true":void 0,className:c[xt.Month],style:N?.[xt.Month],key:n,displayIndex:n,calendarMonth:e},"around"===m&&!a.hideNavigation&&0===n&&t.createElement(r.PreviousMonthButton,{type:"button",className:c[xt.PreviousMonthButton],tabIndex:E?void 0:-1,"aria-disabled":!E||void 0,"aria-label":J(E),onClick:oe,"data-animated-button":a.animate?"true":void 0},t.createElement(r.Chevron,{disabled:!E||void 0,className:c[xt.Chevron],orientation:"rtl"===a.dir?"right":"left"})),t.createElement(r.MonthCaption,{"data-animated-caption":a.animate?"true":void 0,className:c[xt.MonthCaption],style:N?.[xt.MonthCaption],calendarMonth:e,displayIndex:n},l?.startsWith("dropdown")?t.createElement(r.DropdownNav,{className:c[xt.Dropdowns],style:N?.[xt.Dropdowns]},"dropdown"===l||"dropdown-months"===l?t.createElement(r.MonthsDropdown,{className:c[xt.MonthsDropdown],"aria-label":G(),classNames:c,components:r,disabled:Boolean(a.disableNavigation),onChange:ge(e.date),options:Ht(e.date,T,P,i,o),style:N?.[xt.Dropdown],value:o.getMonth(e.date)}):t.createElement("span",null,S(e.date,o)),"dropdown"===l||"dropdown-years"===l?t.createElement(r.YearsDropdown,{className:c[xt.YearsDropdown],"aria-label":re(o.options),classNames:c,components:r,disabled:Boolean(a.disableNavigation),onChange:_e(e.date),options:Ut(T,P,i,o,Boolean(a.reverseYears)),style:N?.[xt.Dropdown],value:o.getYear(e.date)}):t.createElement("span",null,q(e.date,o)),t.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},j(e.date,o.options,o))):t.createElement(r.CaptionLabel,{className:c[xt.CaptionLabel],role:"status","aria-live":"polite"},j(e.date,o.options,o))),"around"===m&&!a.hideNavigation&&n===h-1&&t.createElement(r.NextMonthButton,{type:"button",className:c[xt.NextMonthButton],tabIndex:F?void 0:-1,"aria-disabled":!F||void 0,"aria-label":ee(F),onClick:de,"data-animated-button":a.animate?"true":void 0},t.createElement(r.Chevron,{disabled:!F||void 0,className:c[xt.Chevron],orientation:"rtl"===a.dir?"left":"right"})),n===h-1&&"after"===m&&!a.hideNavigation&&t.createElement(r.Nav,{"data-animated-nav":a.animate?"true":void 0,className:c[xt.Nav],style:N?.[xt.Nav],"aria-label":X(),onPreviousClick:oe,onNextClick:de,previousMonth:E,nextMonth:F}),t.createElement(r.MonthGrid,{role:"grid","aria-multiselectable":"multiple"===u||"range"===u,"aria-label":Q(e.date,o.options,o)||void 0,className:c[xt.MonthGrid],style:N?.[xt.MonthGrid]},!a.hideWeekdays&&t.createElement(r.Weekdays,{"data-animated-weekdays":a.animate?"true":void 0,className:c[xt.Weekdays],style:N?.[xt.Weekdays]},w&&t.createElement(r.WeekNumberHeader,{"aria-label":ae(o.options),className:c[xt.WeekNumberHeader],style:N?.[xt.WeekNumberHeader],scope:"col"},M()),ie.map(e=>t.createElement(r.Weekday,{"aria-label":te(e,o.options,o),className:c[xt.Weekday],key:String(e),style:N?.[xt.Weekday],scope:"col"},C(e,o.options,o)))),t.createElement(r.Weeks,{"data-animated-weeks":a.animate?"true":void 0,className:c[xt.Weeks],style:N?.[xt.Weeks]},e.weeks.map(e=>t.createElement(r.Week,{className:c[xt.Week],key:e.weekNumber,style:N?.[xt.Week],week:e},w&&t.createElement(r.WeekNumber,{week:e,style:N?.[xt.WeekNumber],"aria-label":ne(e.weekNumber,{locale:d}),className:c[xt.WeekNumber],scope:"row",role:"rowheader"},D(e.weekNumber,o)),e.days.map(e=>{const{date:n}=e,i=L(e);if(i[bt.focused]=!i.hidden&&Boolean(H?.isEqualTo(e)),i[Nt.selected]=Y?.(n)||i.selected,Wt(B)){const{from:e,to:t}=B;i[Nt.range_start]=Boolean(e&&t&&o.isSameDay(n,e)),i[Nt.range_end]=Boolean(e&&t&&o.isSameDay(n,t)),i[Nt.range_middle]=qt(B,n,!0,o)}const s=function(e,t={},n={}){let a={...t?.[xt.Day]};return Object.entries(e).filter(([,e])=>!0===e).forEach(([e])=>{a={...a,...n?.[e]}}),a}(i,N,a.modifiersStyles),d=function(e,t,n={}){return Object.entries(e).filter(([,e])=>!0===e).reduce((e,[a])=>(n[a]?e.push(n[a]):t[bt[a]]?e.push(t[bt[a]]):t[Nt[a]]&&e.push(t[Nt[a]]),e),[t[xt.Day]])}(i,c,a.modifiersClassNames),l=se||i.hidden?void 0:V(n,i,o.options,o);return t.createElement(r.Day,{key:`${o.format(n,"yyyy-MM-dd")}_${o.format(e.displayMonth,"yyyy-MM")}`,day:e,modifiers:i,className:d.join(" "),style:s,role:"gridcell","aria-selected":i.selected||void 0,"aria-label":l,"data-day":o.format(n,"yyyy-MM-dd"),"data-month":e.outside?o.format(n,"yyyy-MM"):void 0,"data-selected":i.selected||void 0,"data-disabled":i.disabled||void 0,"data-hidden":i.hidden||void 0,"data-outside":e.outside||void 0,"data-focused":i.focused||void 0,"data-today":i.today||void 0},!i.hidden&&se?t.createElement(r.DayButton,{className:c[xt.DayButton],style:N?.[xt.DayButton],type:"button",day:e,modifiers:i,disabled:i.disabled||void 0,tabIndex:U(e)?0:-1,"aria-label":K(n,i,o.options,o),onClick:ce(e,i),onBlur:me(e,i),onFocus:ue(e,i),onKeyDown:he(e,i),onMouseEnter:fe(e,i),onMouseLeave:pe(e,i)},k(n,o.options,o)):!i.hidden&&k(e.date,o.options,o))})))))))),a.footer&&t.createElement(r.Footer,{className:c[xt.Footer],style:N?.[xt.Footer],role:"status","aria-live":"polite"},a.footer)))}(on=sn||(sn={}))[on.Today=0]="Today",on[on.Selected=1]="Selected",on[on.LastFocused=2]="LastFocused",on[on.FocusedModifier=3]="FocusedModifier";const gn={lessThanXSeconds:{one:"1 ",other:"{{count}} "},xSeconds:{one:"1",other:"{{count}}"},halfAMinute:"30",lessThanXMinutes:{one:"1 ",other:"{{count}} "},xMinutes:{one:"1",other:"{{count}}"},aboutXHours:{one:" 1",other:" {{count}}"},xHours:{one:"1",other:"{{count}}"},xDays:{one:"1",other:"{{count}}"},aboutXWeeks:{one:" 1",other:" {{count}}"},xWeeks:{one:"1",other:"{{count}}"},aboutXMonths:{one:" 1",other:" {{count}}"},xMonths:{one:"1",other:"{{count}}"},aboutXYears:{one:" 1",other:" {{count}}"},xYears:{one:"1",other:"{{count}}"},overXYears:{one:"1 ",other:"{{count}} "},almostXYears:{one:" 1",other:" {{count}}"}},_n={date:Oe({formats:{full:"y M d EEEE",long:"y M d",medium:"y.MM.dd",short:"y.MM.dd"},defaultWidth:"full"}),time:Oe({formats:{full:"a H mm ss zzzz",long:"a H:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:Oe({formats:{full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},defaultWidth:"full"})},vn={lastWeek:"'' eeee p",yesterday:"'' p",today:"'' p",tomorrow:"'' p",nextWeek:"'' eeee p",other:"P"},xn={code:"ko",formatDistance:(e,t,n)=>{let a;const r=gn[e];return a="string"==typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?a+" ":a+" ":a},formatLong:_n,formatRelative:(e,t,n,a)=>vn[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e);switch(String(t?.unit)){case"minute":case"second":return String(n);case"date":return n+"";default:return n+""}},era:Te({values:{narrow:["BC","AD"],abbreviated:["BC","AD"],wide:["",""]},defaultWidth:"wide"}),quarter:Te({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1","2","3","4"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Te({values:{narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1","2","3","4","5","6","7","8","9","10","11","12"],wide:["1","2","3","4","5","6","7","8","9","10","11","12"]},defaultWidth:"wide"}),day:Te({values:{narrow:["","","","","","",""],short:["","","","","","",""],abbreviated:["","","","","","",""],wide:["","","","","","",""]},defaultWidth:"wide"}),dayPeriod:Te({values:{narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},defaultWidth:"wide",formattingValues:{narrow:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},abbreviated:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""},wide:{am:"",pm:"",midnight:"",noon:"",morning:"",afternoon:"",evening:"",night:""}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:Ee({matchPattern:/^(\d+)(|)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:Pe({matchPatterns:{narrow:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(|)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^(bc|)/i,/^(ad|)/i]},defaultParseWidth:"any"}),quarter:Pe({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234]?/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:Pe({matchPatterns:{narrow:/^(1[012]|[123456789])/,abbreviated:/^(1[012]|[123456789])/i,wide:/^(1[012]|[123456789])/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^1?$/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},defaultParseWidth:"any"}),day:Pe({matchPatterns:{narrow:/^[]/,short:/^[]/,abbreviated:/^[]/,wide:/^[]/},defaultMatchWidth:"wide",parsePatterns:{any:[/^/,/^/,/^/,/^/,/^/,/^/,/^/]},defaultParseWidth:"any"}),dayPeriod:Pe({matchPatterns:{any:/^(am|pm|||||||)/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^(am|)/i,pm:/^(pm|)/i,midnight:/^/i,noon:/^/i,morning:/^/i,afternoon:/^/i,evening:/^/i,night:/^/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function yn({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:s="label",buttonVariant:o="ghost",formatters:d,components:c,...l}){const u=$t();return a.jsx(pn,{showOutsideDays:n,className:r("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:s,locale:xn,formatters:{formatMonthDropdown:e=>e.toLocaleString("ko-KR",{month:"short"}),...d},classNames:{root:r("w-fit",u.root),months:r("flex gap-4 flex-col md:flex-row relative",u.months),month:r("flex flex-col w-full gap-4",u.month),nav:r("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",u.nav),button_previous:r(i({variant:o}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_previous),button_next:r(i({variant:o}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",u.button_next),month_caption:r("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",u.month_caption),dropdowns:r("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",u.dropdowns),dropdown_root:r("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",u.dropdown_root),dropdown:r("absolute bg-popover inset-0 opacity-0",u.dropdown),caption_label:r("select-none font-medium","label"===s?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",u.caption_label),table:"w-full border-collapse",weekdays:r("flex",u.weekdays),weekday:r("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",u.weekday),week:r("flex w-full mt-2",u.week),week_number_header:r("select-none w-(--cell-size)",u.week_number_header),week_number:r("text-[0.8rem] select-none text-muted-foreground",u.week_number),day:r("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",u.day),range_start:r("rounded-l-md bg-accent",u.range_start),range_middle:r("rounded-none",u.range_middle),range_end:r("rounded-r-md bg-accent",u.range_end),today:r("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",u.today),outside:r("text-muted-foreground aria-selected:text-muted-foreground",u.outside),disabled:r("text-muted-foreground opacity-50",u.disabled),hidden:r("invisible",u.hidden),...t},components:{Root:({className:e,rootRef:t,...n})=>a.jsx("div",{"data-slot":"calendar",ref:t,className:r(e),...n}),Chevron:({className:e,orientation:t,...n})=>"left"===t?a.jsx(V,{className:r("size-4",e),...n}):"right"===t?a.jsx(M,{className:r("size-4",e),...n}):a.jsx(C,{className:r("size-4",e),...n}),DayButton:bn,WeekNumber:({children:e,...t})=>a.jsx("td",{...t,children:a.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:e})}),...c},...l})}function bn({className:e,day:t,modifiers:i,...o}){const d=$t(),c=n.useRef(null);return n.useEffect(()=>{i.focused&&c.current?.focus()},[i.focused]),a.jsx(s,{ref:c,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":i.selected&&!i.range_start&&!i.range_end&&!i.range_middle,"data-range-start":i.range_start,"data-range-end":i.range_end,"data-range-middle":i.range_middle,className:r("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",d.day,e),...o})}function wn({children:e,onDateSelect:t,disabled:r=!1,placeholder:i=" ",align:s="center",side:d="bottom"}){const[c,l]=n.useState(!1);return a.jsxs(q,{open:c,onOpenChange:l,children:[a.jsx(O,{asChild:!0,disabled:r,children:e}),a.jsx(W,{className:"w-auto p-0 border-gray-200 shadow-lg",align:s,side:d,sideOffset:8,children:a.jsxs("div",{className:"bg-white business-radius-card p-2",children:[a.jsx("div",{className:"mb-2 px-1",children:a.jsx("div",{className:"modal-label text-gray-600 text-center",children:i})}),a.jsx(yn,{mode:"single",selected:void 0,onSelect:e=>{o.debug(" Calendar onSelect  :",{date:e,isToday:e&&(new Date).toDateString()===e.toDateString(),dateValue:e?.getTime(),todayValue:(new Date).getTime()}),(e=>{o.debug(" DatePickerPopover handleDateSelect :",{date:e,isToday:e&&(new Date).toDateString()===e.toDateString(),dateString:e?.toDateString(),todayString:(new Date).toDateString()}),e?(o.debug("  , onDateSelect  "),t(e),l(!1),o.debug(" DatePickerPopover  ")):o.debug("  undefined")})(e)},locale:xn,initialFocus:!0,className:"compact-calendar",disabled:!1,fromDate:new Date("2020-01-01"),toDate:new Date("2030-12-31"),defaultMonth:new Date,modifiers:{today:new Date},modifiersClassNames:{today:"bg-blue-500 text-white font-semibold cursor-pointer hover:bg-blue-600 rounded-md"}})]})})]})}function Nn({children:e,onConfirm:t,disabled:r=!1,placeholder:i="  ",align:o="center",side:d="bottom",defaultDate:c,defaultAmount:l}){const[u,m]=n.useState(!1),[h,f]=n.useState(c),[p,g]=n.useState(l?.toString()||"");return a.jsxs(q,{open:u,onOpenChange:m,children:[a.jsx(O,{asChild:!0,disabled:r,children:e}),a.jsx(W,{className:"w-auto p-0 border-gray-200 shadow-lg",align:o,side:d,sideOffset:8,children:a.jsxs("div",{className:"bg-white business-radius-card p-3",children:[a.jsx("div",{className:"mb-2 px-1",children:a.jsx("div",{className:"modal-label text-gray-600 text-center",children:i})}),a.jsx(yn,{mode:"single",selected:h,onSelect:f,locale:xn,initialFocus:!0,className:"compact-calendar",disabled:!1,fromDate:new Date("2020-01-01"),toDate:new Date("2030-12-31"),defaultMonth:h||new Date,modifiers:{today:new Date},modifiersClassNames:{today:"bg-blue-500 text-white font-semibold cursor-pointer hover:bg-blue-600 rounded-md"}}),a.jsxs("div",{className:"mt-3 px-1",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:""}),a.jsx(I,{type:"text",value:p,onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,"");if(t){const e=parseInt(t,10);g(e.toLocaleString())}else g("")},placeholder:" ",className:"w-full"})]}),a.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[a.jsx(s,{variant:"outline",size:"sm",onClick:()=>m(!1),children:""}),a.jsx(s,{size:"sm",onClick:()=>{if(!h)return;const e=parseFloat(p.replace(/,/g,""));isNaN(e)||e<=0||(t(h,e),m(!1),f(c),g(l?.toString()||""))},disabled:!h||!p||parseFloat(p.replace(/,/g,""))<=0,className:"button-base button-action-primary",children:""})]})]})})]})}function jn({children:e,onConfirm:t,disabled:r=!1,placeholder:i="  ",align:o="center",side:d="bottom",defaultDate:c,defaultQuantity:l,maxQuantity:u,hideQuantityInput:m=!1,quantityInfoText:h="   "}){const[f,p]=n.useState(!1),[g,_]=n.useState(c),[v,x]=n.useState(l?.toString()||"");return a.jsxs(q,{open:f,onOpenChange:p,children:[a.jsx(O,{asChild:!0,disabled:r,children:e}),a.jsx(W,{className:"w-auto p-0 border-gray-200 shadow-lg",align:o,side:d,sideOffset:8,children:a.jsxs("div",{className:"bg-white business-radius-card p-3",children:[a.jsx("div",{className:"mb-2 px-1",children:a.jsx("div",{className:"modal-label text-gray-600 text-center",children:i})}),m&&a.jsx("div",{className:"mb-2 px-1",children:a.jsxs("div",{className:"text-[10px] text-gray-500 text-center leading-tight",children:[a.jsx("div",{children:" "}),a.jsx("div",{children:" "})]})}),a.jsx(yn,{mode:"single",selected:g,onSelect:_,locale:xn,initialFocus:!0,className:"compact-calendar",disabled:!1,fromDate:new Date("2020-01-01"),toDate:new Date("2030-12-31"),defaultMonth:g||new Date,modifiers:{today:new Date},modifiersClassNames:{today:"bg-blue-500 text-white font-semibold cursor-pointer hover:bg-blue-600 rounded-md"}}),!m&&a.jsxs("div",{className:"mt-3 px-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1 gap-2",children:[a.jsx("label",{className:"block text-xs font-medium text-gray-700",children:""}),void 0!==u&&a.jsx(s,{type:"button",variant:"outline",size:"sm",onClick:()=>{void 0!==u&&x(u.toString())},className:"h-6 px-2 text-[10px] border-gray-200 text-hansl-600",children:" "})]}),a.jsx(I,{type:"number",value:v,onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,"");x(t)},placeholder:" ",className:"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400",min:"0",max:u}),u&&a.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[": ",u.toLocaleString()]})]}),a.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[a.jsx(s,{variant:"outline",size:"sm",onClick:()=>p(!1),className:"button-base",children:""}),a.jsx(s,{size:"sm",onClick:()=>{if(!g)return;if(m)return t(g,void 0),p(!1),_(c),void x(l?.toString()||"");const e=parseFloat(v.replace(/,/g,""));isNaN(e)||e<0||u&&e>u||(t(g,e),p(!1),_(c),x(l?.toString()||""))},disabled:!g||!m&&(!v||parseFloat(v.replace(/,/g,""))<0||void 0!==u&&parseFloat(v.replace(/,/g,""))>u),className:"button-base button-action-primary",children:""})]})]})})]})}function kn({config:e,currentUserName:t,canPerformAction:a,purchaseId:r,onUpdate:i,onOptimisticUpdate:s}){const h=d(),f=n.useCallback(async(n,d,u,m)=>{if(!a)return o.warn("  ",{canPerformAction:a,currentUserName:t}),void z.error(("statement_received"===e.field?"":"")+"   .");const f="number"==typeof n?n:Number(n);if(Number.isNaN(f))return o.error("  ID",{itemId:n,numericId:f}),void z.error("   ID .");if(u){const t=`: ${u.item_name||"-"}\n: ${u.specification||"-"}\n: ${u.quantity?.toLocaleString()||0}\n: ${u.unit_price_value?.toLocaleString()||0}\n: ${u.amount_value?.toLocaleString()||0}\n: ${u.remark||"-"}\n\n${e.confirmMessage.confirm}`;if(!window.confirm(t))return}try{let n;"statement_received"===e.field?n={is_statement_received:!0,statement_received_date:d.toISOString(),statement_received_by_name:t}:"actual_received"===e.field&&(n={actual_received_date:d.toISOString(),is_received:!0,received_quantity:void 0!==m?m:void 0!==u?.received_quantity?u.received_quantity:null}),o.debug("  :",n);const{data:a,error:p}=await h.from("purchase_request_items").update(n).eq("id",f).select();if(o.debug(" DB  :",{data:a,error:p}),p)throw o.error(" DB  ",p),p;if(o.info(" DB  ",a),r)if("actual_received"===e.field){c(r,f,d.toISOString(),m)||o.warn("[useConfirmDateAction]     ",{purchaseId:r,itemId:f})}else if("statement_received"===e.field){l(r,f,d.toISOString(),t||void 0)||o.warn("[useConfirmDateAction]      ",{purchaseId:r,itemId:f})}s&&s({itemId:f,selectedDate:d,action:"confirm",receivedQuantity:void 0!==m?m:u?.received_quantity,itemInfo:u}),i&&i(),z.success(e.successMessage.confirm)}catch(p){o.error("   ",p),z.error(("statement_received"===e.field?"":"")+"     .")}},[e,t,a,r,i,s,h]),p=n.useCallback(async(n,d)=>{if(!a)return o.warn("   ",{canPerformAction:a,currentUserName:t}),void z.error(("statement_received"===e.field?"":"")+"   .");const c="number"==typeof n?n:Number(n);if(Number.isNaN(c))z.error("   ID .");else{if(d){const t=`: ${d.item_name||"-"}\n: ${d.specification||"-"}\n: ${d.quantity?.toLocaleString()||0}\n: ${d.unit_price_value?.toLocaleString()||0}\n: ${d.amount_value?.toLocaleString()||0}\n: ${d.remark||"-"}\n\n${e.confirmMessage.cancel}`;if(!window.confirm(t))return}try{let t;o.debug(` ${e.field}   `,{itemId:n,itemName:d?.item_name}),"statement_received"===e.field?t={is_statement_received:!1,statement_received_date:null,statement_received_by_name:null}:"actual_received"===e.field&&(t={actual_received_date:null,is_received:!1}),o.debug("   :",t);const{data:a,error:l}=await h.from("purchase_request_items").update(t).eq("id",c).select();if(o.debug("  DB  :",{data:a,error:l}),l)throw o.error(" DB  ",l),l;if(o.info(` ${e.field}   `,a),r)if("actual_received"===e.field){u(r,c)||o.warn("[useConfirmDateAction]     ",{purchaseId:r,itemId:c})}else if("statement_received"===e.field){m(r,c)||o.warn("[useConfirmDateAction]      ",{purchaseId:r,itemId:c})}s&&s({itemId:c,action:"cancel",itemInfo:d}),i&&i(),z.success(e.successMessage.cancel)}catch(l){o.error(` ${e.field}   `,l),z.error(("statement_received"===e.field?"":"")+"     .")}}},[e,a,r,i,s,h]),g=n.useCallback(t=>"statement_received"===e.field?t.is_statement_received:"actual_received"===e.field&&t.is_received,[e.field]),_=n.useCallback(t=>"statement_received"===e.field?t.statement_received_date:"actual_received"===e.field?t.actual_received_date:null,[e.field]),v=n.useCallback(t=>"statement_received"===e.field?t.statement_received_by_name:(e.field,null),[e.field]);return{config:e,handleConfirm:f,handleCancel:p,isCompleted:g,getCompletedDate:_,getCompletedByName:v}}const Sn=[{id:"statement_progress",label:"",description:"  ",defaultVisible:!0},{id:"purchase_order_number",label:"",description:" ",defaultVisible:!0},{id:"payment_category",label:"",description:"  (, ,  )",defaultVisible:!0},{id:"requester_name",label:"",description:"  ",defaultVisible:!0},{id:"request_date",label:"",description:"  ",defaultVisible:!0},{id:"utk_status",label:"UTK",description:"UTK  ",defaultVisible:!0},{id:"vendor_name",label:"",description:"",defaultVisible:!0},{id:"contact_name",label:"",description:" ",defaultVisible:!0},{id:"delivery_request_date",label:"",description:"  ",defaultVisible:!0},{id:"revised_delivery_date",label:"",description:"  ",defaultVisible:!0},{id:"item_name",label:"",description:" ",defaultVisible:!0},{id:"specification",label:"",description:"  ",defaultVisible:!0},{id:"quantity",label:"",description:" ",defaultVisible:!0},{id:"unit_price",label:"",description:" ",defaultVisible:!0},{id:"amount",label:"",description:" ",defaultVisible:!0},{id:"remark",label:"",description:"  ",defaultVisible:!0},{id:"link",label:"",description:" ",defaultVisible:!0},{id:"project_vendor",label:"PJ",description:" ",defaultVisible:!0},{id:"project_item",label:"PJ ITEM",description:" ",defaultVisible:!0},{id:"sales_order_number",label:"",description:" ",defaultVisible:!0},{id:"purchase_progress",label:"",description:" ",defaultVisible:!0},{id:"receipt_progress",label:"",description:" ",defaultVisible:!0}],Dn=Sn.reduce((e,t)=>(e[t.id]=t.defaultVisible,e),{});Sn.reduce((e,t)=>(e[t.id]=t,e),{});const Mn=["purchase_order_number","vendor_name","item_name","specification"],Cn=["statement_progress","utk_status","unit_price","amount"],qn=["app_admin","ceo","final_approver","purchase_manager","lead buyer","accounting"],On=[{title:" ",columns:["statement_progress","purchase_order_number","payment_category","requester_name","request_date","utk_status"]},{title:" ",columns:["vendor_name","contact_name","delivery_request_date","revised_delivery_date"]},{title:" ",columns:["item_name","specification","quantity","unit_price","amount","remark","link"]},{title:" ",columns:["project_vendor","project_item","sales_order_number"]},{title:" ",columns:["purchase_progress","receipt_progress"]}];const Wn=n.memo(function({purchaseId:e,isOpen:t,onClose:r,embedded:i=!1,currentUserRoles:u=[],activeTab:m,onRefresh:M,onOptimisticUpdate:C,onDelete:V}){const{allPurchases:te,lastFetch:ne}=h(),[ae,re]=n.useState(!1),[ie,se]=n.useState(null),[oe,de]=n.useState(!1),[ce,le]=n.useState(null),[ue,me]=n.useState([]),[he,fe]=n.useState([]),[pe,ge]=n.useState([]),[_e,ve]=n.useState(""),[xe,ye]=n.useState([]),[be,we]=n.useState(null),[Ne,je]=n.useState([]),[ke,Se]=n.useState(""),[De,Me]=n.useState(!1),[Ce,qe]=n.useState(""),[Oe,We]=n.useState(""),[Ie,Te]=n.useState(!1),[Pe,Ee]=n.useState(!1);n.useEffect(()=>{De&&ie&&(qe(`[]  ${ie.purchase_order_number}  .`),We(""))},[De,ie]);const Fe=n.useRef(!0);n.useEffect(()=>{if(!t||!e)return;const n=f(()=>{if(Fe.current)return void(Fe.current=!1);const t=p(e);t&&se(t)});return()=>n()},[t,e]);const $e=n.useMemo(()=>{if(ie?.items&&ie.items.length>0)return ie.items;if(ie?.purchase_request_items&&ie.purchase_request_items.length>0)return ie.purchase_request_items;if(e&&te){const t=te.find(t=>t.id===e);if(t)return t.items&&t.items.length>0?t.items:t.purchase_request_items||[]}return[]},[ie,e,te,ne]);n.useMemo(()=>{if(xe.length>0){const e=xe.length>1?12*(xe.length-1):0,t=24,n=xe.reduce((e,t)=>e+t,0)+e+t;return Math.max(n,720)}const e=[120,200,70,90,100,150,80];"purchase"===m&&e.push(120),"receipt"!==m&&"done"!==m||e.push(120),"receipt"===m&&e.push(140),"done"===m&&e.push(100,80,110),oe&&e.push(110);const t=e.length>1?12*(e.length-1):0,n=e.reduce((e,t)=>e+t,0)+t+48;return Math.max(n,720)},[xe,m,oe]);const Le=n.useRef(null),Ye=d();n.useEffect(()=>{t&&(async()=>{try{const e="https://qvhbigvdfyvhoegkhvef.supabase.co";if(!e||e.includes("placeholder"))return void o.warn("Supabase     - PurchaseDetailModal");const{data:{user:t}}=await Ye.auth.getUser();if(t){let{data:e}=await Ye.from("employees").select("*").eq("id",t.id).maybeSingle();if(!e&&t.email){const{data:n}=await Ye.from("employees").select("*").eq("email",t.email).maybeSingle();e=n}if(e?.name&&ve(e.name),e?.purchase_role){let t=[];t=Array.isArray(e.purchase_role)?e.purchase_role.map(e=>String(e).trim()):String(e.purchase_role).split(",").map(e=>e.trim()).filter(e=>e.length>0),ge(t)}}}catch(e){}})()},[t]),n.useEffect(()=>{t&&(async()=>{try{const{data:e,error:t}=await Ye.from("vendors").select("*").order("vendor_name",{ascending:!0});if(t)throw t;e&&je(e)}catch(e){o.error("   :",e)}})()},[t]);const ze=Array.isArray(u)&&u.length>0?u:pe,Be=ze.includes("final_approver")||ze.includes("app_admin")||ze.includes("ceo"),Ae=ze.includes("lead buyer"),He=Be||Ae,Ue=ze.some(e=>qn.includes(e)),Re="approved"===ie?.final_manager_status?Be:Be||ie?.requester_name===_e,Ze=ze.includes("app_admin")||ze.includes("lead buyer")||ze.includes("lead buyer"),Ke=ze.includes("app_admin")||ie?.requester_name===_e,Ve=ze.includes("final_approver")||ze.includes("app_admin")||ze.includes("ceo"),Qe=ie?.requester_name===_e,Ge=ze.includes("app_admin")||ze.includes("lead buyer")||ze.includes("accounting"),Xe=ze.includes("app_admin")||Qe,Je=n.useCallback(async()=>{if(e)try{const t=d(),{data:n,error:a}=await t.from("purchase_requests").select("\n          *,\n          vendors:vendor_id(id, vendor_name, is_active),\n          purchase_request_items(*),\n          contact:contact_id(id, contact_name, contact_email, contact_phone, position)\n        ").eq("id",e).single();if(a)throw a;let r=[];if(n&&n.vendor_id){const{data:e}=await t.from("vendor_contacts").select("id, contact_name, contact_email, contact_phone, position").eq("vendor_id",n.vendor_id).order("contact_name");if(e&&e.length>0){if(n.contact_id){const t=e.find(e=>e.id===n.contact_id),a=e.filter(e=>e.id!==n.contact_id);r=t?[t,...a]:e}else r=e;o.info("    :",{vendor_id:n.vendor_id,contact_id:n.contact_id,allContacts_count:e.length,vendorContacts:r})}}else n&&n.contact&&(r=[n.contact]);if(n){const e=(n.purchase_request_items||[]).sort((e,t)=>(e.line_number||999999)-(t.line_number||999999)),t={...n,items:e,vendor:n.vendors||null,vendor_contacts:r,contact_id:n.contact_id,contact_name:r[0]?.contact_name||n.contact?.contact_name||null};se(t),le(t),me(e),o.info(" refreshModalData DB  :",{vendor_contacts:t.vendor_contacts,vendorContacts_from_query:r,purchase_updated:!0,vendor_id:n.vendor_id,has_vendor_contacts:r&&r.length>0})}}catch(t){o.error("   ",t)}},[e]);n.useEffect(()=>{if(!e||!te||!ie)return;const t=te.find(t=>t.id===e);if(t){const e=t.items&&t.items.length>0?t.items:t.purchase_request_items||[],n={...ie,...t,id:String(t.id),items:e,purchase_request_items:e};se(n),le(n),me(e.length>0?e:[])}},[te,ne]),n.useEffect(()=>{if(!t||!e||!te)return;const n=te.find(t=>t.id===e);if(n){const e=n.items&&n.items.length>0?n.items:n.purchase_request_items||[],t={...n,id:String(n.id),is_po_generated:!1,items:e,purchase_request_items:e,vendor:{id:n.vendor_id,vendor_name:n.vendor_name||"  ",is_active:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()},vendor_contacts:[]};se(t),le(t),me(e.length>0?e:[])}},[t,e,te]);const[et,tt]=n.useState(!0),nt=e?Number(e):ie?Number(ie.id):NaN,at=n.useCallback(({itemId:e,selectedDate:t,action:n,receivedQuantity:a})=>{const r=String(e),i=(new Date).toISOString(),s=t?t.toISOString():void 0,o=e=>e?e.map(e=>String(e.id)!==r?e:"confirm"===n?{...e,is_received:!0,actual_received_date:s,received_at:i,received_quantity:void 0!==a?a:e.received_quantity}:{...e,is_received:!1,actual_received_date:void 0,received_at:void 0,received_quantity:void 0}):e;se(e=>{if(!e)return e;const t=o(e.items)||[],n=o(e.purchase_request_items)||[],a=t.length,r=t.filter(e=>e.is_received).length,s=a>0&&r===a;return{...e,items:t,purchase_request_items:n,is_received:s,received_at:s?e.received_at||i:void 0,updated_at:(new Date).toISOString()}}),le(e=>{if(!e)return e;const t=o(e.items)||[],n=o(e.purchase_request_items)||[];return{...e,items:t,purchase_request_items:n}}),me(e=>e&&0!==e.length?e.map(e=>e.id&&String(e.id)===r?"confirm"===n?{...e,is_received:!0,actual_received_date:s,received_at:i,received_quantity:void 0!==a?a:e.received_quantity}:{...e,is_received:!1,actual_received_date:void 0,received_at:void 0,received_quantity:void 0}:e):e),Number.isNaN(nt)||C?.(nt,e=>{const t=o(e.items)||e.items||[],n=o(e.purchase_request_items)||e.purchase_request_items||[],a=t.length||e.items?.length||0,r=t.filter(e=>e.is_received).length,s=a>0&&r===a;return{...e,items:t,purchase_request_items:n,is_received:s,received_at:s?e.received_at||i:void 0,updated_at:(new Date).toISOString()}})},[C,nt]),rt=n.useCallback(({itemId:e,selectedDate:t,action:n})=>{const a=String(e),r=t?t.toISOString():void 0;let i=!1,s=null;if(se(e=>{if(!e)return e;const t=(e.items||[]).map(e=>String(e.id)!==a?e:"confirm"===n?{...e,is_statement_received:!0,statement_received_date:r,statement_received_by_name:_e}:{...e,is_statement_received:!1,statement_received_date:null,statement_received_by_name:null});return i=t.length>0&&t.every(e=>e.is_statement_received),s=i?r||e.statement_received_at||(new Date).toISOString():null,{...e,items:t,is_statement_received:i,statement_received_at:s}}),le(e=>{if(!e)return e;const t=(e.items||[]).map(e=>String(e.id)!==a?e:"confirm"===n?{...e,is_statement_received:!0,statement_received_date:r,statement_received_by_name:_e}:{...e,is_statement_received:!1,statement_received_date:null,statement_received_by_name:null});return{...e,items:t,is_statement_received:i,statement_received_at:s}}),me(e=>e?e.map(e=>String(e.id)!==a?e:"confirm"===n?{...e,is_statement_received:!0,statement_received_date:r,statement_received_by_name:_e}:{...e,is_statement_received:!1,statement_received_date:null,statement_received_by_name:null}):e),Number.isNaN(nt)||C?.(nt,e=>{const t=(e.items||[]).map(e=>String(e.id)!==a?e:"confirm"===n?{...e,is_statement_received:!0,statement_received_date:r,statement_received_by_name:_e}:{...e,is_statement_received:!1,statement_received_date:null,statement_received_by_name:null}),i=t.length>0&&t.every(e=>e.is_statement_received);return{...e,items:t,is_statement_received:i}}),ie&&void 0!==i){d().from("purchase_requests").update({is_statement_received:i,statement_received_at:s}).eq("id",ie.id).then(({error:e})=>{e&&o.error("  purchase_requests  ",e)})}},[_e,C,nt,ie]),it=kn({config:{field:"statement_received",confirmMessage:{confirm:"  ?",cancel:"  ?"},successMessage:{confirm:"  .",cancel:"  ."},completedText:" ",waitingText:""},currentUserName:_e,canPerformAction:Ge,purchaseId:ie?.id,onUpdate:Je,onOptimisticUpdate:rt}),st=kn({config:{field:"actual_received",confirmMessage:{confirm:"   ?",cancel:"   ?"},successMessage:{confirm:"   .",cancel:"   ."},completedText:"",waitingText:""},currentUserName:_e,canPerformAction:Xe,purchaseId:ie?.id,onUpdate:Je,onOptimisticUpdate:at}),ot=ze.includes("middle_manager")||ze.includes("app_admin")||ze.includes("ceo"),dt=ze.includes("final_approver")||ze.includes("app_admin")||ze.includes("ceo"),ct="inline-flex items-center gap-1 business-radius-badge !h-auto !min-h-0 !px-2.5 !py-0.5 badge-text leading-tight",ut="inline-flex items-center gap-1 business-radius-badge px-2.5 py-0.5 badge-text leading-tight";n.useEffect(()=>{if(e&&t){const t=p(e);if(t){const e={...t,id:String(t.id),is_po_generated:!1,vendor:t.vendor||(t.vendor_id?{id:t.vendor_id,vendor_name:t.vendor_name||"  ",is_active:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}:null),vendor_contacts:t.vendor_contacts||[]};se(e),le(e),me(t.items||[])}else gt(e.toString());de(!1)}},[e,t]);const mt=n.useCallback(()=>{const e=ie?.items&&ie.items.length>0?ie.items:ie?.purchase_request_items&&ie.purchase_request_items.length>0?ie.purchase_request_items:[];if(0===e.length)return[];const t=[{key:"item_name",minWidth:80,maxWidth:500,baseWidth:80},{key:"specification",minWidth:80,maxWidth:200,baseWidth:150,isFixed:!1},{key:"quantity",minWidth:70,maxWidth:120,baseWidth:70},{key:"unit_price",minWidth:90,maxWidth:150,baseWidth:90},{key:"total_price",minWidth:100,maxWidth:180,baseWidth:100}];""===ie?.payment_category&&t.push({key:"tax_amount",minWidth:80,maxWidth:150,baseWidth:80}),t.push({key:"remarks",minWidth:150,maxWidth:150,baseWidth:150,isFixed:!0},{key:"status",minWidth:70,maxWidth:100,baseWidth:70}),"receipt"===m&&t.push({key:"actual_receipt_date",minWidth:100,maxWidth:160,baseWidth:100,isFixed:!1}),"done"===m&&""===ie?.payment_category&&t.push({key:"transaction_confirm",minWidth:85,maxWidth:120,baseWidth:85,isFixed:!1},{key:"accounting_date",minWidth:70,maxWidth:70,baseWidth:70,isFixed:!0},{key:"expenditure_info",minWidth:90,maxWidth:150,baseWidth:90,isFixed:!1});const n=t.map((t,n)=>{let a=4;const r=(()=>{const e="purchase"===m?"":"receipt"===m||"done"===m?"":"",t="receipt"===m||"done"===m?"/ ":"",n="pending"===m?["","",t,"","",""===ie?.payment_category?"":null,""].filter(e=>null!==e):["","",t,"","",""===ie?.payment_category?"":null,"",e].filter(e=>null!==e);if("receipt"===m)return[...n,""];if("done"===m){const e=[...n];return""===ie?.payment_category&&e.push(" "," ",""),e}return n})();if(r[n]&&(a=Math.max(a,r[n].length)),e.forEach(e=>{let n="";switch(t.key){case"item_name":n=e.item_name||"";break;case"specification":n=e.specification||"";break;case"quantity":if("receipt"===m||"done"===m){const t=e.quantity||0,a=e.received_quantity??0;n=t>=100||a>=100?`${t}`:`${t}/${a}`}else n=e.quantity?.toString()||"";break;case"unit_price":n=null!=e.unit_price_value?e.unit_price_value.toLocaleString():"";break;case"total_price":n=null!=e.amount_value?e.amount_value.toLocaleString():null!=e.quantity&&null!=e.unit_price_value?(Number(e.quantity)*Number(e.unit_price_value)).toLocaleString():"";break;case"tax_amount":n=null!=e.tax_amount_value?e.tax_amount_value.toLocaleString():"";break;case"remarks":n=e.remark||"";break;case"status":n=ht(e)||"";break;case"actual_receipt_date":n=e.actual_received_date?D(e.actual_received_date):"";break;case"transaction_confirm":n=e.is_statement_received?"":"";break;case"accounting_date":n=e.statement_received_date?D(e.statement_received_date):"";break;case"expenditure_info":n=e.expenditure_date&&null!==e.expenditure_amount&&void 0!==e.expenditure_amount?"2025. 11. 25.":""}const r=n.split("").reduce((e,t)=>e+(/[-]/.test(t)?1.5:1),0);a=Math.max(a,Math.ceil(r))}),t.isFixed)return t.baseWidth;let i=Math.max(t.minWidth,Math.min(t.maxWidth,7*a+20));return"expenditure_info"===t.key&&(i=110),i});return ye(n),n},[ie,m]),ht=e=>"purchase"===m?e.is_payment_completed?"":"":"receipt"===m?e.is_received?"":"":e.is_payment_completed?"":"",ft=()=>{if(xe.length>0){return xe.map(e=>`${e}px`).join(" ")}let e=["minmax(80px, 1fr)","200px","70px","90px","100px"];if(""===ie?.payment_category&&e.push("100px"),e.push("150px"),e.push("80px"),"receipt"===m)return[...e,"100px"].join(" ");if("done"===m){const t=[...e];return""===ie?.payment_category&&t.push("100px","80px","110px"),t.join(" ")}return e.join(" ")};n.useEffect(()=>{const e=ie?.items&&ie.items.length>0||ie?.purchase_request_items&&ie.purchase_request_items.length>0;ie&&e&&!oe&&requestAnimationFrame(()=>{mt()})},[ie,oe,m,mt]);const pt=e=>{e&&!oe&&(le(ie),me($e||[]),fe([]),mt()),de(e)},gt=async e=>{try{const t=p(e);if(t){const e={...t,id:String(t.id),is_po_generated:!1,vendor:t.vendor||(t.vendor_id?{id:t.vendor_id,vendor_name:t.vendor_name||"  ",is_active:!0,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}:null),vendor_contacts:t.vendor_contacts||[]};return se(e),le(e),void me(t.items||[])}re(!0);const n=d(),{data:a,error:r}=await n.from("purchase_requests").select("\n          *,\n          vendors:vendor_id(id, vendor_name, is_active),\n          purchase_request_items(*),\n          contact:contact_id(id, contact_name, contact_email, contact_phone, position)\n        ").eq("id",e).single();if(r)throw r;let i=[];if(a&&a.vendor_id){const{data:e}=await n.from("vendor_contacts").select("id, contact_name, contact_email, contact_phone, position").eq("vendor_id",a.vendor_id).order("contact_name");if(e&&e.length>0){if(a.contact_id){const t=e.find(e=>e.id===a.contact_id),n=e.filter(e=>e.id!==a.contact_id);i=t?[t,...n]:e}else i=e;o.info(" loadPurchaseDetail -    :",{vendor_id:a.vendor_id,contact_id:a.contact_id,allContacts_count:e.length,vendorContacts:i})}}else a&&a.contact&&(i=[a.contact]);if(a){const e=(a.purchase_request_items||[]).sort((e,t)=>(e.line_number||999999)-(t.line_number||999999)),t={...a,items:e,vendor:a.vendors||null,vendor_contacts:i,contact_id:a.contact_id,contact_name:i[0]?.contact_name||a.contact?.contact_name||null};se(t),le(t),me(e)}}catch(t){o.error("[PurchaseDetailModal]    :",t),z.error("    .")}finally{re(!1)}},_t=e=>new Intl.NumberFormat("ko-KR").format(e),vt=(e,t,n)=>{const a=[...ue];if("quantity"===t||"unit_price_value"===t){const r=(("quantity"===t?n:a[e].quantity)||0)*(("unit_price_value"===t?n:a[e].unit_price_value)||0),i=""===ie?.payment_category?Math.round(.1*r):0;a[e]={...a[e],[t]:n,amount_value:r,tax_amount_value:i}}else a[e]={...a[e],[t]:n};me(a)},xt=e=>{const t=ue[e];t.id&&fe([...he,t.id]);const n=ue.filter((t,n)=>n!==e).sort((e,t)=>(e.line_number||999999)-(t.line_number||999999));me(n)},yt=async(e,t)=>{if(!Ze)return o.warn("[handlePaymentToggle]  ",{canPurchase:Ze,currentUserRoles:u}),void z.error("   .");const n=String(e),a="number"==typeof e?e:Number(e);if(Number.isNaN(a))return o.error("[handlePaymentToggle]  ID",{itemId:e,numericId:a}),void z.error("   ID .");if(!ie)return;const r=ie.items&&ie.items.length>0?ie.items:[],i=ie.purchase_request_items&&ie.purchase_request_items.length>0?ie.purchase_request_items:[],s=(r.length>0?r:i).find(e=>String(e.id)===n);if(!s)return;const d=`: ${s.item_name}\n: ${s.specification||""}\n: ${s.quantity?.toLocaleString()||0}${s.unit||""}\n: ${s.unit_price_value?.toLocaleString()||0}\n: ${s.amount_value?.toLocaleString()||0}`,c=t?`   ?\n\n${d}`:`   ?\n\n${d}`;if(window.confirm(c))try{const{error:e}=await Ye.from("purchase_request_items").update({is_payment_completed:t,payment_completed_at:t?(new Date).toISOString():null}).eq("id",a);if(e)throw e;if(ie){(t?b(ie.id,a):N(ie.id,a))||o.warn("[PurchaseDetailModal]     ",{purchaseId:ie.id,itemId:a,isCompleted:t})}if(se(e=>{if(!e)return null;const a=e.items&&e.items.length>0?e.items:[],r=e.purchase_request_items&&e.purchase_request_items.length>0?e.purchase_request_items:[],i=(a.length>0?a:r).map(e=>String(e.id)===n?{...e,is_payment_completed:t,payment_completed_at:t?(new Date).toISOString():null}:e);return{...e,items:e.items?i:e.items,purchase_request_items:e.purchase_request_items?i:e.purchase_request_items}}),ie){const e=Number(ie.id);Number.isNaN(e)||C?.(e,e=>{const a=(e.items||[]).map(e=>String(e.id)===n?{...e,is_payment_completed:t}:e),r=a.length||e.items?.length||0,i=a.filter(e=>e.is_payment_completed).length,s=r>0&&i===r;return{...e,items:a,is_payment_completed:s,payment_completed_at:s?(new Date).toISOString():null,payment_completed_by_name:s&&_e||e.payment_completed_by_name}})}z.success(t?" .":" ."),await Je();const r=M?.(!0,{silent:!0});r instanceof Promise&&await r}catch(l){z.error("    .")}},bt=async(e,t,n)=>{if(!Ke)return void z.error("   .");const a=String(e),r="number"==typeof e?e:Number(e);if(Number.isNaN(r))return void z.error("   ID .");const i=ie?Number(ie.id):NaN;try{const{error:e}=await Ye.from("purchase_request_items").update({is_received:!0,received_at:(new Date).toISOString(),actual_received_date:t.toISOString(),received_quantity:void 0!==n?n:null}).eq("id",r);if(e)throw e;if(ie){c(ie.id,r,t.toISOString(),n)||o.warn("[PurchaseDetailModal]       ",{purchaseId:ie.id,itemId:r})}se(e=>{if(!e)return null;const r=e.items?.map(e=>String(e.id)===a?{...e,is_received:!0,received_at:(new Date).toISOString(),actual_received_date:t.toISOString(),received_quantity:void 0!==n?n:e.received_quantity}:e),i=e.purchase_request_items?.map(e=>String(e.id)===a?{...e,is_received:!0,received_at:(new Date).toISOString(),actual_received_date:t.toISOString(),received_quantity:void 0!==n?n:e.received_quantity}:e);return{...e,items:r,purchase_request_items:i,updated_at:(new Date).toISOString()}}),Number.isNaN(i)||C?.(i,e=>{const r=(e.items||[]).map(e=>String(e.id)===a?{...e,is_received:!0,actual_received_date:t.toISOString(),received_quantity:void 0!==n?n:e.received_quantity}:e),i=r.length||e.items?.length||0,s=r.filter(e=>e.is_received).length,o=i>0&&s===i;return{...e,items:r,is_received:o,received_at:o?(new Date).toISOString():e.received_at}});const s=ie?.items?.find(e=>String(e.id)===a);z.success(`"${s?.item_name}"   .`),await Je();const d=M?.(!0,{silent:!0});d instanceof Promise&&await d}catch(s){z.error("    .")}},wt=async e=>{if(!ie)return;const t="middle"===e?"1 ":" ",n=`: ${ie.purchase_order_number}\n\n${t} ?`;if(window.confirm(n))try{const t="middle"===e?{middle_manager_status:"approved"}:{final_manager_status:"approved"},{error:n}=await Ye.from("purchase_requests").update(t).eq("id",ie.id);if(n)throw n;if(se("middle"===e?e=>e?{...e,middle_manager_status:"approved"}:null:e=>e?{...e,final_manager_status:"approved"}:null),ie&&C){const t=Number(ie.id);Number.isNaN(t)||C(t,t=>"middle"===e?{...t,middle_manager_status:"approved"}:{...t,final_manager_status:"approved"})}z.success(("middle"===e?"":"")+"  ."),await Je();const a=M?.(!0,{silent:!0});a instanceof Promise&&await a}catch(a){z.error("    .")}},Nt=async(e,t,n)=>{if(!ie||!Ge)return void z.error("    .");const a=String(e),r="number"==typeof e?e:Number(e);if(Number.isNaN(r))return void o.error("  itemId",{itemId:e});const i=ie.items?.find(e=>String(e.id)===a);if(!i)return;const s=ie?Number(ie.id):NaN;try{Number.isNaN(s)||C?.(s,e=>{const r=(e.items||[]).map(e=>String(e.id)===a?{...e,expenditure_date:t.toISOString(),expenditure_amount:n}:e);return{...e,items:r}}),se(e=>{if(!e)return null;const r=(e.items||e.purchase_request_items||[]).map(e=>String(e.id)===a?{...e,expenditure_date:t.toISOString(),expenditure_amount:n}:e),i=r.reduce((e,t)=>e+(t.expenditure_amount||0),0);return{...e,items:r,purchase_request_items:r,total_expenditure_amount:i,updated_at:(new Date).toISOString()}});const{error:e}=await Ye.from("purchase_request_items").update({expenditure_date:t.toISOString(),expenditure_amount:n}).eq("id",r);if(e)throw o.error("  DB  ",{error:e,itemId:r}),e;const d=(ie.items||ie.purchase_request_items||[]).reduce((e,t)=>String(t.id)===a?e+n:e+(t.expenditure_amount||0),0);if(await Ye.from("purchase_requests").update({total_expenditure_amount:d}).eq("id",s),ie?.id){j(ie.id,r,t.toISOString(),n)||o.warn("[PurchaseDetailModal]      ",{purchaseId:ie.id,itemId:r})}z.success(`"${i.item_name}"    .`),await Je();const c=M?.(!0,{silent:!0});c instanceof Promise&&await c}catch(d){o.error("    ",d),z.error("     .")}},jt=a.jsx("div",{className:"space-y-1 sm:space-y-4",children:ae?a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-hansl-600"})}):ie?a.jsxs("div",{children:[a.jsx("div",{className:"bg-gray-50 rounded-lg p-2 sm:p-3 mb-1 sm:mb-2 border border-gray-100",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 items-center gap-3 sm:gap-0",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[(()=>{if(!ie)return null;if(ie.payment_category){const e=ie.payment_category.trim();return""===e?a.jsx("span",{className:"badge-stats bg-green-500 text-white",children:""}):""===e?a.jsx("span",{className:"badge-stats bg-blue-500 text-white",children:""}):""===e?a.jsx("span",{className:"badge-stats bg-gray-500 text-white",children:""}):a.jsx("span",{className:"badge-stats bg-blue-500 text-white",children:e})}return a.jsx("span",{className:"badge-stats bg-blue-500 text-white",children:""})})(),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"modal-label",children:":"}),a.jsx("span",{className:"modal-value",children:ie.requester_name})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(A,{className:"w-3 h-3 text-gray-500"}),a.jsxs("span",{className:"modal-subtitle",children:[": ",D(ie.request_date)]})]})]}),a.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-3 flex-wrap",children:[ot&&"pending"===ie.middle_manager_status&&a.jsx(s,{size:"sm",variant:"outline",onClick:()=>wt("middle"),className:`${ct} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`,children:"1  "}),"approved"===ie.middle_manager_status&&a.jsxs("div",{className:"button-approved badge-text shadow-sm",children:[a.jsx(H,{className:"w-3 h-3"}),"1 "]}),"rejected"===ie.middle_manager_status&&a.jsxs("div",{className:"button-rejected badge-text",children:[a.jsx(g,{className:"w-3 h-3"}),"1 "]}),"pending"===ie.middle_manager_status&&!ot&&a.jsx("div",{className:`${ut} border border-gray-300 text-gray-600 bg-white`,children:"1 "}),dt&&"approved"===ie.middle_manager_status&&"pending"===ie.final_manager_status&&a.jsxs(s,{size:"sm",variant:"outline",onClick:()=>wt("final"),className:`${ct} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`,children:[a.jsx(H,{className:"w-3 h-3"})," "]}),"approved"===ie.final_manager_status&&a.jsxs("div",{className:"button-approved badge-text",children:[a.jsx(H,{className:"w-3 h-3"})," "]}),"rejected"===ie.final_manager_status&&a.jsxs("div",{className:"button-rejected badge-text",children:[a.jsx(g,{className:"w-3 h-3"})," "]}),"approved"!==ie.middle_manager_status&&"pending"===ie.final_manager_status&&a.jsx("div",{className:`${ut} border border-gray-300 text-gray-600 bg-white`,children:" "})]}),a.jsx("div",{})]})}),a.jsxs("div",{className:"flex flex-col lg:flex-row gap-3 sm:gap-6",children:[a.jsxs("div",{className:"lg:w-80 lg:flex-shrink-0 space-y-1 sm:space-y-4 relative",children:[a.jsxs("div",{className:"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm",children:[a.jsx("div",{className:"mb-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"modal-section-title flex items-center",children:[a.jsx(_,{className:"w-4 h-4 mr-2 text-gray-600"}),ie?.purchase_order_number||"PO "]}),Ge&&Ue&&"done"===m&&a.jsxs("button",{onClick:async()=>{if(!ie)return;const e=!(ie.is_utk_checked||!1),t=e?`: ${ie.purchase_order_number}\n\nUTK  ?`:`: ${ie.purchase_order_number}\n\nUTK  ?`;if(window.confirm(t))try{const t=d(),{error:n}=await t.from("purchase_requests").update({is_utk_checked:e}).eq("id",ie.id);if(n)return o.error("UTK  DB  ",{error:n,purchaseId:ie.id}),void z.error("UTK     .");se(t=>t?{...t,is_utk_checked:e,updated_at:(new Date).toISOString()}:null),ie.id&&v(ie.id,t=>({...t,is_utk_checked:e})),z.success(e?"UTK  .":"UTK  ."),await Je();const a=M?.(!0,{silent:!0});a instanceof Promise&&await a}catch(n){o.error("UTK    ",n),z.error("UTK     .")}},className:"button-base text-xs px-2 py-1 flex items-center "+(ie?.is_utk_checked?"button-toggle-active bg-orange-500 hover:bg-orange-600 text-white":"button-toggle-inactive"),title:ie?.is_utk_checked?"UTK  ":"UTK ",children:[a.jsx(Q,{className:"w-3 h-3 mr-1"}),"UTK ",ie?.is_utk_checked?"":""]})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:flex sm:gap-8",children:[a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:" "}),oe?a.jsx(I,{value:ce?.request_type||"",onChange:e=>le(t=>t?{...t,request_type:e.target.value}:null),className:"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]",placeholder:""}):a.jsx("p",{className:"modal-value",children:ie.request_type||""})]}),a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:" "}),oe?a.jsx(I,{value:ce?.payment_category||"",onChange:e=>le(t=>t?{...t,payment_category:e.target.value}:null),className:"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]",placeholder:"//"}):a.jsx("p",{className:"modal-value",children:ie.payment_category||"-"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:flex sm:gap-8",children:[a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:" "}),oe?a.jsx(wn,{onDateSelect:e=>{le(t=>t?{...t,delivery_request_date:lt(e,"yyyy-MM-dd")}:null)},placeholder:"  ",align:"start",side:"bottom",children:a.jsxs(s,{variant:"outline",className:"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input",children:[a.jsx(A,{className:"mr-1 h-3 w-3"}),ce?.delivery_request_date?D(ce.delivery_request_date):" "]})}):a.jsx("p",{className:"modal-subtitle",children:D(ie.delivery_request_date)})]}),a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label text-orange-500",children:" "}),oe?a.jsx(wn,{onDateSelect:e=>{le(t=>t?{...t,revised_delivery_request_date:lt(e,"yyyy-MM-dd")}:null)},placeholder:"  ",align:"start",side:"bottom",children:a.jsxs(s,{variant:"outline",className:"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input",children:[a.jsx(A,{className:"mr-1 h-3 w-3"}),ce?.revised_delivery_request_date?D(ce.revised_delivery_request_date):" "]})}):a.jsx("p",{className:"modal-subtitle text-orange-700",children:ie.revised_delivery_request_date?D(ie.revised_delivery_request_date):""})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm",children:[a.jsxs("h3",{className:"modal-section-title mb-3 flex items-center",children:[a.jsx(x,{className:"w-4 h-4 mr-2 text-gray-600"})," "]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:flex sm:gap-8",children:[a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:""}),oe?a.jsx(B,{options:Ne.map(e=>({value:e.id.toString(),label:e.vendor_name})),value:ce?.vendor_id?{value:ce.vendor_id.toString(),label:ce.vendor_name||Ne.find(e=>e.id===ce.vendor_id)?.vendor_name||""}:null,onChange:e=>{if(o.info("ReactSelect onChange:",{option:e}),e){const t=Ne.find(t=>t.id.toString()===e.value);if(o.info("Selected vendor:",{selectedVendor:t}),t){d().from("vendor_contacts").select("id, contact_name, contact_email, contact_phone, position").eq("vendor_id",t.id).then(({data:e,error:n})=>{n&&o.error("    :",n),o.info("   -   :",{vendor_id:t.id,vendor_name:t.vendor_name,contactsData:e,contactsCount:e?.length||0}),le(n=>{const a=n?{...n,vendor_id:t.id,vendor_name:t.vendor_name,vendor:t,vendor_contacts:Array.isArray(e)?e:[],contact_id:void 0,contact_name:void 0}:null;return o.info("   - editedPurchase  :",{vendor_id:t.id,vendor_name:t.vendor_name,contactsData:e,updated_vendor_contacts:a?.vendor_contacts,updated_full:a}),a})})}}else le(e=>e?{...e,vendor_id:void 0,vendor_name:"",vendor:void 0,vendor_contacts:[],contact_id:void 0,contact_name:void 0}:null)},placeholder:" ",isClearable:!0,isSearchable:!0,menuPortalTarget:document.body,styles:{control:e=>({...e,minHeight:"20px",height:"20px",fontSize:"10px",borderRadius:"8px",borderColor:"#e5e7eb",borderWidth:"1px",backgroundColor:"#ffffff",boxShadow:"none",paddingLeft:"6px",paddingRight:"6px","&:hover":{borderColor:"#e5e7eb"},"&:focus-within":{borderColor:"#60a5fa",boxShadow:"none",outline:"none"}}),valueContainer:e=>({...e,height:"18px",padding:"0 2px",margin:"0"}),input:e=>({...e,margin:"0",padding:"0",fontSize:"10px"}),indicatorsContainer:e=>({...e,height:"18px",padding:"0"}),indicatorSeparator:()=>({display:"none"}),dropdownIndicator:e=>({...e,padding:"0 2px",svg:{width:"12px",height:"12px"}}),clearIndicator:e=>({...e,padding:"0 2px",svg:{width:"12px",height:"12px"}}),option:e=>({...e,fontSize:"10px",padding:"4px 8px"}),menuPortal:e=>({...e,zIndex:9999})},classNamePrefix:"vendor-select"}):a.jsx("p",{className:"modal-value",children:ie.vendor?.vendor_name||"-"})]}),a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:" "}),oe?ce?.vendor_id?a.jsx(B,{options:(()=>{const e=Array.isArray(ce.vendor_contacts)?ce.vendor_contacts:[],t=e.filter((e,t,n)=>n.findIndex(t=>t.id===e.id)===t),n=t.filter((e,t,n)=>n.findIndex(t=>t.contact_name===e.contact_name)===t),a=n.map(e=>({value:e.id.toString(),label:e.contact_name||""}))||[];return o.info("   :",{vendor_id:ce.vendor_id,vendor_contacts_raw:ce.vendor_contacts,vendor_contacts_count:e.length,unique_by_id_count:t.length,final_unique_count:n.length,options:a}),a})(),value:(()=>{const e=(Array.isArray(ce.vendor_contacts)?ce.vendor_contacts:[])[0];return e?.id?{value:e.id.toString(),label:e.contact_name||""}:null})(),onChange:e=>{if(o.info("   :",{option:e}),e){const t=Array.isArray(ce.vendor_contacts)?ce.vendor_contacts:[],n=t.find(t=>t.id.toString()===e.value);n&&le(e=>e?{...e,contact_id:n.id,contact_name:n.contact_name,vendor_contacts:[n,...t.filter(e=>e.id!==n.id)]}:null)}else le(e=>e?{...e,contact_id:void 0,contact_name:void 0,vendor_contacts:Array.isArray(ce.vendor_contacts)?ce.vendor_contacts:[]}:null)},placeholder:" ",isClearable:!0,isSearchable:!0,noOptionsMessage:()=>" ",menuPortalTarget:document.body,styles:{control:e=>({...e,minHeight:"20px",height:"20px",fontSize:"10px",borderRadius:"8px",borderColor:"#e5e7eb",borderWidth:"1px",backgroundColor:"#ffffff",boxShadow:"none",paddingLeft:"6px",paddingRight:"6px","&:hover":{borderColor:"#e5e7eb"},"&:focus-within":{borderColor:"#60a5fa",boxShadow:"none",outline:"none"}}),valueContainer:e=>({...e,height:"18px",padding:"0 2px",margin:"0"}),input:e=>({...e,margin:"0",padding:"0",fontSize:"10px"}),indicatorsContainer:e=>({...e,height:"18px",padding:"0"}),indicatorSeparator:()=>({display:"none"}),dropdownIndicator:e=>({...e,padding:"0 2px",svg:{width:"12px",height:"12px"}}),clearIndicator:e=>({...e,padding:"0 2px",svg:{width:"12px",height:"12px"}}),option:e=>({...e,fontSize:"10px",padding:"4px 8px"}),menuPortal:e=>({...e,zIndex:9999})},classNamePrefix:"contact-select"}):a.jsx(I,{value:"",disabled:!0,className:"mt-1 rounded-lg border-gray-200 w-full h-5 px-1.5 py-0.5 text-[10px]",placeholder:"  "}):a.jsx("p",{className:"modal-value",children:(()=>{const e=Array.isArray(ie.vendor_contacts)?ie.vendor_contacts:[],t=ie.contact_name||e[0]?.contact_name||"-";return o.info(" vendor_contacts display :",{purchase_id:ie?.id,vendor_id:ie?.vendor_id,contact_id:ie?.contact_id,vendor_contacts:ie.vendor_contacts,purchase_contact_name:ie.contact_name,contactName:t,purchase_full:ie}),t})()})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:flex sm:gap-8",children:[a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:"PJ"}),oe?a.jsx(I,{value:ce?.project_vendor||"",onChange:e=>le(t=>t?{...t,project_vendor:e.target.value}:null),className:"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]",placeholder:""}):a.jsx("p",{className:"modal-value",children:ie.project_vendor||"-"})]}),a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:"Item"}),oe?a.jsx(I,{value:ce?.project_item||"",onChange:e=>le(t=>t?{...t,project_item:e.target.value}:null),className:"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]",placeholder:""}):a.jsx("p",{className:"modal-subtitle",children:ie.project_item||"-"})]})]}),a.jsx("div",{className:"grid grid-cols-1 sm:flex sm:gap-8",children:a.jsxs("div",{className:"w-32",children:[a.jsx("span",{className:"modal-label",children:""}),oe?a.jsx(I,{value:ce?.sales_order_number||"",onChange:e=>le(t=>t?{...t,sales_order_number:e.target.value}:null),className:"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]",placeholder:""}):a.jsx("p",{className:"modal-subtitle",children:ie.sales_order_number||"-"})]})})]})]})]}),a.jsx("div",{className:"lg:w-fit lg:min-w-0 relative overflow-visible",children:a.jsxs("div",{className:"bg-white rounded-lg border border-gray-100 shadow-sm",children:[a.jsxs("div",{className:"p-2 sm:p-3 bg-gray-50 border-b border-gray-100 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0",children:[a.jsxs("h3",{className:"modal-section-title flex items-center",children:[a.jsx(y,{className:"w-4 h-4 mr-2 text-gray-600"})," ",a.jsxs("span",{className:"ml-2 badge-stats bg-gray-500 text-white",children:[$e?.length||0,""]})]}),!oe&&a.jsxs(a.Fragment,{children:["purchase"===m&&Ze&&a.jsxs(s,{size:"sm",onClick:async()=>{if(!ie||!Ze)return;const e=`: ${ie.purchase_order_number}\n\n  ?`;if(window.confirm(e)){ie&&Number(ie.id);try{const e=ie.purchase_request_items||[],t=e.filter(e=>!e.is_payment_completed);if(0===t.length)return void z.info("   .");o.info(`  : ${t.length}  ( ${e.length} )`);for(const a of t){const e={is_payment_completed:!0,payment_completed_at:(new Date).toISOString()},{error:t}=await Ye.from("purchase_request_items").update(e).eq("id",a.id);if(t)throw t;b(ie.id,a.id)||o.warn("[PurchaseDetailModal]       ",{purchaseId:ie.id,itemId:a.id})}z.success(`${t.length}   .`),await Je();const n=M?.(!0,{silent:!0});n instanceof Promise&&await n}catch(t){o.error("   ",t),z.error("    .")}}},className:"button-base bg-orange-500 hover:bg-orange-600 text-white",children:[a.jsx(U,{className:"w-3 h-3 mr-1"})," "]}),"receipt"===m&&Ke&&a.jsx(jn,{onConfirm:async(e,t)=>{if(!ie||!Ke)return;const n=`: ${ie.purchase_order_number}\n\n  ?`;if(!window.confirm(n))return;const a=ie?Number(ie.id):NaN;try{const n=ie.purchase_request_items||[],r=n.filter(e=>!e.is_received),i=()=>{Number.isNaN(a)||C?.(a,n=>{const a=(n.items||[]).map(n=>r.find(e=>String(e.id)===String(n.id))?{...n,is_received:!0,actual_received_date:n.actual_received_date||e.toISOString(),received_quantity:void 0!==t?t:n.quantity}:n),i=(n.purchase_request_items||[]).map(n=>r.find(e=>String(e.id)===String(n.id))?{...n,is_received:!0,actual_received_date:n.actual_received_date||e.toISOString(),received_quantity:void 0!==t?t:n.quantity}:n);return{...n,items:a,purchase_request_items:i,is_received:!0,received_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}})};if(0===r.length)return void z.info("   .");o.info(`  : ${r.length}  ( ${n.length} )`),i(),se(n=>{if(!n)return null;const a=n.items?.map(n=>r.find(e=>String(e.id)===String(n.id))?{...n,is_received:!0,received_at:(new Date).toISOString(),actual_received_date:e.toISOString(),received_quantity:void 0!==t?t:n.quantity}:n)||[],i=n.purchase_request_items?.map(n=>r.find(e=>String(e.id)===String(n.id))?{...n,is_received:!0,received_at:(new Date).toISOString(),actual_received_date:e.toISOString(),received_quantity:void 0!==t?t:n.quantity}:n)||[],s=a.length,o=a.filter(e=>e.is_received).length,d=s>0&&o===s;return{...n,items:a,purchase_request_items:i,is_received:d,received_at:d?(new Date).toISOString():n.received_at,updated_at:(new Date).toISOString()}});for(const a of r){const n={actual_received_date:e.toISOString(),is_received:!0,received_quantity:void 0!==t?t:a.quantity},{error:r}=await Ye.from("purchase_request_items").update(n).eq("id",a.id);if(r)throw r;const i=void 0!==t?t:a.quantity;c(ie.id,a.id,e.toISOString(),i)||o.warn("[PurchaseDetailModal]       ",{purchaseId:ie.id,itemId:a.id})}z.success(`${r.length}   .`),await Je();const s=M?.(!0,{silent:!0});s instanceof Promise&&await s}catch(r){o.error("   ",r),z.error("    .")}},placeholder:" ",align:"end",side:"bottom",hideQuantityInput:!0,quantityInfoText:"   ",children:a.jsxs(s,{size:"sm",className:"button-base button-action-primary",children:[a.jsx(ee,{className:"w-3 h-3 mr-1"})," "]})}),"done"===m&&Ge&&Ue&&""===ie.payment_category&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(wn,{onDateSelect:async e=>{if(!ie||!Ge)return;e.toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"});const t=`: ${ie.purchase_order_number}\n\n   ?`;if(!window.confirm(t))return;const n=e.toISOString();ie&&Number(ie.id);try{const e=ie.purchase_request_items||[],t=e.filter(e=>!e.is_statement_received);if(0===t.length)return void z.info("    .");o.info(`   : ${t.length}  ( ${e.length} )`);for(const r of t){const e={is_statement_received:!0,statement_received_date:n,statement_received_by_name:_e||null},{error:t}=await Ye.from("purchase_request_items").update(e).eq("id",r.id);if(t)throw t;l(ie.id,r.id,n,_e||void 0)||o.warn("[PurchaseDetailModal]        ",{purchaseId:ie.id,itemId:r.id})}z.success(`${t.length}    .`),await Je();const a=M?.(!0,{silent:!0});a instanceof Promise&&await a}catch(a){o.error("    ",a),z.error("     .")}},placeholder:"   ",align:"end",side:"bottom",children:a.jsxs(s,{size:"sm",className:"button-base button-action-primary",children:[a.jsx(_,{className:"w-3 h-3 mr-1"})," "]})}),""===ie.payment_category&&a.jsx(Nn,{onConfirm:async(e,t)=>{if(!ie||!Ge)return void z.error("    .");const n=`: ${ie.purchase_order_number}\n\n   ?\n: ${e.toLocaleDateString("ko-KR")}\n : ${t.toLocaleString()}\n\n* :        ,    .`;if(!window.confirm(n))return;const a=ie?Number(ie.id):NaN;try{Number.isNaN(a)||C?.(a,n=>{const a=(n.items||[]).map(t=>({...t,expenditure_date:e.toISOString(),expenditure_amount:null}));return{...n,items:a,total_expenditure_amount:t}});const n=ie.items||ie.purchase_request_items||[];if(0===n.length)return void z.error(" .");se(n=>{if(!n)return null;const a=(n.items||n.purchase_request_items||[]).map(t=>({...t,expenditure_date:e.toISOString(),expenditure_amount:null}));return{...n,items:a,purchase_request_items:a,total_expenditure_amount:t,updated_at:(new Date).toISOString()}});const{error:r}=await Ye.from("purchase_request_items").update({expenditure_date:e.toISOString(),expenditure_amount:null}).in("id",n.map(e=>e.id));if(r)throw o.error("    DB  ",{error:r}),r;const{error:i}=await Ye.from("purchase_requests").update({total_expenditure_amount:t}).eq("id",a);if(i)throw o.error("    DB  ",{error:i}),i;w(ie.id,e.toISOString(),t),z.success("   .")}catch(r){o.error("     ",r),z.error("      .")}},placeholder:"    ",align:"end",side:"bottom",children:a.jsxs(s,{size:"sm",className:"button-base button-action-primary",children:[a.jsx(G,{className:"w-3 h-3 mr-1"}),""]})})]})]})]}),a.jsx("div",{className:"block sm:hidden bg-gray-50 px-2 py-1 border-b border-gray-100",children:a.jsx("div",{className:"text-xs font-medium text-gray-600",children:"  ( )"})}),a.jsx("div",{className:"max-h-[50vh] sm:max-h-[40vh] overflow-auto",children:a.jsxs("div",{className:"w-fit",children:[a.jsx("div",{className:"bg-gray-50 px-2 sm:px-3 py-1 border-b border-gray-100 sticky top-0 z-10 w-fit",children:a.jsxs("div",{ref:Le,className:"hidden sm:grid gap-1 modal-label w-fit",style:{gridTemplateColumns:ft()},children:[a.jsx("div",{children:""}),a.jsx("div",{children:""}),a.jsx("div",{className:"text-center",children:"receipt"!==m&&"done"!==m||oe?"":a.jsxs("div",{className:"flex flex-col items-center leading-tight",children:[a.jsx("div",{className:"text-[9px]",children:"/"}),a.jsx("div",{className:"text-[10px]",children:""})]})}),a.jsx("div",{className:"text-right",children:""}),a.jsx("div",{className:"text-right",children:""}),""===ie.payment_category&&a.jsx("div",{className:"text-right",children:""}),a.jsx("div",{className:"text-center",children:""}),oe?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-center",children:""}),"receipt"===m&&a.jsx(a.Fragment,{children:a.jsx("div",{className:"text-center",children:""})}),"done"===m&&a.jsx(a.Fragment,{children:""===ie.payment_category&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-center",children:" "}),a.jsx("div",{className:"text-center",children:" "}),a.jsx("div",{className:"text-center",children:""})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-center",children:"purchase"===m?"":"receipt"===m||"done"===m?"":""}),"done"===m&&a.jsx(a.Fragment,{children:""===ie.payment_category&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-center",children:" "}),a.jsx("div",{className:"text-center",children:" "}),a.jsx("div",{className:"text-center",children:""})]})}),"receipt"===m&&a.jsx(a.Fragment,{children:a.jsx("div",{className:"text-center",children:""})})]})]})}),a.jsx("div",{className:"divide-y divide-gray-100 overflow-visible w-fit",children:(oe?ue:$e)?.map((e,t)=>a.jsxs("div",{className:"px-2 sm:px-3 py-1 border-b border-gray-50 hover:bg-gray-50/50 relative overflow-visible",children:[a.jsxs("div",{className:"hidden sm:grid items-center gap-1 overflow-visible w-fit",style:{gridTemplateColumns:ft()},children:[a.jsx("div",{className:"min-w-0 relative overflow-visible flex items-center",children:oe?a.jsx(I,{value:e.item_name,onChange:e=>vt(t,"item_name",e.target.value),onFocus:()=>we(`item_name_${t}`),onBlur:()=>we(null),className:"modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 "+(be===`item_name_${t}`?"!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal":"!h-5 !truncate"),placeholder:""}):a.jsx("div",{className:"modal-value",style:{whiteSpace:"normal",wordBreak:"break-all",overflowWrap:"break-word",hyphens:"none",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",lineHeight:"1.4",maxHeight:"2.8em",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},title:e.item_name||" ",children:e.item_name||" "})}),a.jsx("div",{className:"min-w-0 relative overflow-visible flex items-center",style:{width:"200px",maxWidth:"200px",minWidth:"200px"},children:oe?a.jsx(I,{value:e.specification,onChange:e=>vt(t,"specification",e.target.value),onFocus:()=>we(`specification_${t}`),onBlur:()=>we(null),className:"modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 "+(be===`specification_${t}`?"!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-1/2 !-translate-x-1/2 !-translate-y-1/2 !top-1/2 !whitespace-normal !w-[300px]":"!h-5 !truncate"),placeholder:""}):a.jsx("div",{className:"text-[11px] text-gray-600 font-medium",style:{whiteSpace:"normal",wordBreak:"break-all",overflowWrap:"break-word",hyphens:"none",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",lineHeight:"1.4",maxHeight:"2.8em",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},title:e.specification||"-",children:e.specification||"-"})}),a.jsx("div",{className:"text-center min-w-0 flex items-center justify-center",children:oe?"receipt"===m||"done"===m?a.jsxs("div",{className:"flex flex-col items-center gap-0.5 w-full",children:[a.jsx(I,{type:"number",value:e.quantity,onChange:e=>vt(t,"quantity",Number(e.target.value)),className:"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400",placeholder:"",max:"99999"}),a.jsxs("div",{className:"flex items-center gap-0.5 w-full",children:[a.jsx("span",{className:"text-[9px] text-gray-500",children:"/"}),a.jsx(I,{type:"number",value:e.received_quantity??"",onChange:e=>vt(t,"received_quantity",e.target.value?Number(e.target.value):null),className:"border-gray-200 rounded-lg text-center flex-1 !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400",placeholder:"",max:"99999"})]})]}):a.jsx(I,{type:"number",value:e.quantity,onChange:e=>vt(t,"quantity",Number(e.target.value)),className:"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400",placeholder:"",max:"99999"}):"receipt"===m||"done"===m?(()=>{const t=e.quantity||0,n=e.received_quantity??0,r=n>0;return t>=100||n>=100?a.jsxs("div",{className:"flex flex-col items-center leading-tight",children:[a.jsx("div",{className:"modal-subtitle "+(r?"text-gray-400":""),children:t}),a.jsxs("div",{className:"modal-subtitle "+(r?"":"text-gray-400"),children:["/",n]})]}):a.jsxs("span",{className:"modal-subtitle",children:[a.jsx("span",{className:r?"text-gray-400":"",children:t}),a.jsxs("span",{className:r?"":"text-gray-400",children:["/",n]})]})})():a.jsx("span",{className:"modal-subtitle",children:e.quantity||0})}),a.jsx("div",{className:"text-right min-w-0 flex items-center justify-end",children:oe?a.jsx(I,{type:"number",value:e.unit_price_value,onChange:e=>vt(t,"unit_price_value",Number(e.target.value)),className:"border-gray-200 rounded-lg text-right w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400",placeholder:"",max:"100000000000"}):a.jsx("span",{className:"modal-subtitle",children:"done"!==m||Ue?`${_t(e.unit_price_value)}`:"-"})}),a.jsx("div",{className:"text-right min-w-0 flex items-center justify-end",children:a.jsx("span",{className:oe?"modal-subtitle":"modal-value",children:"done"!==m||Ue?`${_t(e.amount_value||0)}`:"-"})}),""===ie?.payment_category&&a.jsx("div",{className:"text-right min-w-0 flex items-center justify-end",children:a.jsx("span",{className:oe?"modal-subtitle":"modal-value",children:"done"!==m||Ue?`${_t(e.tax_amount_value||0)}`:"-"})}),a.jsx("div",{className:"min-w-0 flex justify-center items-center text-center relative overflow-visible",style:{width:"150px",maxWidth:"150px",minWidth:"150px"},children:oe?a.jsx(I,{value:e.remark||"",disabled:Ae&&!Be,onChange:e=>vt(t,"remark",e.target.value),onFocus:()=>we(`remark_${t}`),onBlur:()=>we(null),className:"modal-label border-gray-200 rounded-lg text-center w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 "+(be===`remark_${t}`?"!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal !text-left":"!h-5 !truncate"),placeholder:""}):a.jsx("div",{className:"text-[11px] text-gray-600 font-medium",style:{width:"150px",maxWidth:"150px",minWidth:"150px",boxSizing:"border-box",whiteSpace:"normal",wordBreak:"break-all",overflowWrap:"break-word",hyphens:"none",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",lineHeight:"1.4",maxHeight:"2.8em",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},title:e.remark||"-",children:e.remark||"-"})}),"pending"!==m&&a.jsx("div",{className:"text-center flex justify-center items-center",children:oe?a.jsx(s,{size:"sm",variant:"ghost",onClick:()=>xt(t),className:"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6",children:a.jsx(R,{className:"w-3 h-3"})}):a.jsxs(a.Fragment,{children:["purchase"===m&&a.jsx("div",{className:"flex justify-center",children:Ze?a.jsx("button",{onClick:()=>yt(e.id,!e.is_payment_completed),className:""+(e.is_payment_completed?"button-toggle-active bg-orange-500 hover:bg-orange-600 text-white":"button-toggle-inactive"),children:e.is_payment_completed?"":""}):a.jsx("span",{className:""+(e.is_payment_completed?"button-toggle-active bg-orange-500 text-white":"button-waiting-inactive"),children:e.is_payment_completed?"":""})}),"receipt"===m&&a.jsx("div",{className:"flex justify-center",children:Ke?st.isCompleted(e)?a.jsx("button",{onClick:()=>{st.handleCancel(e.id,{item_name:e.item_name,specification:e.specification,quantity:e.quantity,unit_price_value:e.unit_price_value,amount_value:e.amount_value,remark:e.remark})},className:"button-action-primary",children:st.config.completedText}):a.jsx(jn,{onConfirm:(t,n)=>{bt(e.id,t,n)},placeholder:"  ",align:"center",side:"bottom",defaultQuantity:e.received_quantity??void 0,maxQuantity:e.quantity,children:a.jsx("button",{className:"button-toggle-inactive",children:st.config.waitingText})}):a.jsx("span",{className:""+(st.isCompleted(e)?"button-action-primary":"button-waiting-inactive"),children:st.isCompleted(e)?st.config.completedText:st.config.waitingText})}),"done"===m&&a.jsx("div",{className:"flex justify-center",children:a.jsx("span",{className:"button-base "+(st.isCompleted(e)?"bg-blue-500 hover:bg-blue-600 text-white":"border border-gray-300 text-gray-600 bg-white hover:bg-gray-50"),children:st.isCompleted(e)?"":""})}),"purchase"!==m&&"receipt"!==m&&"done"!==m&&a.jsx("div",{className:"flex justify-center",children:a.jsx("span",{className:"badge-text",children:"-"})})]})}),"receipt"===m&&a.jsx("div",{className:"text-center flex justify-center items-center pl-2",children:st.getCompletedDate(e)?a.jsx("div",{className:"modal-subtitle text-green-700",children:new Date(st.getCompletedDate(e)).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}):a.jsx("span",{className:"modal-subtitle text-gray-400",children:"-"})}),"done"===m&&""===ie.payment_category&&a.jsx("div",{className:"text-center flex justify-center items-center",children:Ge?it.isCompleted(e)?a.jsx("button",{onClick:()=>{it.handleCancel(e.id,{item_name:e.item_name,specification:e.specification,quantity:e.quantity,unit_price_value:e.unit_price_value,amount_value:e.amount_value,remark:e.remark})},className:"button-action-primary hover:bg-green-600",title:"   ",children:it.config.completedText}):a.jsx(wn,{onDateSelect:t=>{it.handleConfirm(e.id,t,{item_name:e.item_name,specification:e.specification,quantity:e.quantity,unit_price_value:e.unit_price_value,amount_value:e.amount_value,remark:e.remark})},placeholder:"  ",align:"center",side:"bottom",children:a.jsx("button",{className:"button-toggle-inactive",onClick:()=>{},children:it.config.waitingText})}):a.jsx("span",{className:""+(it.isCompleted(e)?"button-action-primary":"button-waiting-inactive"),children:it.isCompleted(e)?it.config.completedText:it.config.waitingText})}),"done"===m&&""===ie.payment_category&&a.jsx("div",{className:"text-center flex justify-center items-center",children:it.getCompletedDate(e)?a.jsx("div",{className:"modal-subtitle text-blue-700",children:new Date(it.getCompletedDate(e)).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}):a.jsx("span",{className:"modal-subtitle text-gray-400",children:"-"})}),"done"===m&&""===ie.payment_category&&a.jsx("div",{className:"text-center flex justify-center items-center",children:(()=>{const t=!!e.expenditure_date,n=null!==e.expenditure_amount&&void 0!==e.expenditure_amount;return Ge?t?a.jsxs("div",{className:"w-full px-1 leading-none",children:[a.jsx("div",{className:"text-blue-700 text-[9px] leading-[1.1] font-normal",children:(()=>{const t=new Date(e.expenditure_date);return`${t.getFullYear().toString().slice(-2)}.${(t.getMonth()+1).toString().padStart(2,"0")}.${t.getDate().toString().padStart(2,"0")}`})()}),a.jsx("div",{className:"text-gray-700 text-[9px] leading-[1.1] font-normal",children:Ue?n?`${Number(e.expenditure_amount).toLocaleString()}`:"":"-"})]}):a.jsx(Nn,{onConfirm:(t,n)=>Nt(e.id,t,n),placeholder:"   ",align:"center",side:"bottom",children:a.jsx("button",{className:"button-toggle-inactive",children:""})}):t?a.jsxs("div",{className:"w-full px-1 leading-none",children:[a.jsx("div",{className:"text-blue-700 text-[9px] leading-[1.1] font-normal",children:(()=>{const t=new Date(e.expenditure_date);return`${t.getFullYear().toString().slice(-2)}.${(t.getMonth()+1).toString().padStart(2,"0")}.${t.getDate().toString().padStart(2,"0")}`})()}),a.jsx("div",{className:"text-gray-700 text-[9px] leading-[1.1] font-normal",children:Ue?n?`${Number(e.expenditure_amount).toLocaleString()}`:"":"-"})]}):a.jsx("span",{className:"modal-subtitle text-gray-400",children:"-"})})()})]}),a.jsxs("div",{className:"block sm:hidden space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1 min-w-0 relative",children:[oe?a.jsx(I,{value:e.item_name,onChange:e=>vt(t,"item_name",e.target.value),onFocus:()=>we(`m_item_name_${t}`),onBlur:()=>we(null),className:"modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 "+(be===`m_item_name_${t}`?"!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal":"!h-5 !truncate"),placeholder:""}):a.jsx("div",{className:"modal-value font-medium",children:e.item_name||" "}),oe?a.jsx(I,{value:e.specification,onChange:e=>vt(t,"specification",e.target.value),onFocus:()=>we(`m_specification_${t}`),onBlur:()=>we(null),className:"modal-label border-gray-200 rounded-lg mt-1 w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 "+(be===`m_specification_${t}`?"!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal !w-full":"!h-5 !truncate"),placeholder:""}):a.jsx("div",{className:"modal-subtitle text-gray-500",children:e.specification||"-"})]}),a.jsx("div",{className:"ml-3 text-right flex-shrink-0",children:a.jsxs("div",{className:(oe?"modal-subtitle":"modal-value")+" font-semibold",children:["",_t(e.amount_value||0)]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-xs",children:":"}),oe?a.jsx(I,{type:"number",value:e.quantity,onChange:e=>vt(t,"quantity",Number(e.target.value)),className:"border-gray-200 rounded-lg mt-1 w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400",placeholder:""}):a.jsx("div",{className:"modal-subtitle",children:e.quantity||0})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-xs",children:":"}),oe?a.jsx(I,{type:"number",value:e.unit_price_value,onChange:e=>vt(t,"unit_price_value",Number(e.target.value)),className:"border-gray-200 rounded-lg mt-1 w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400",placeholder:""}):a.jsx("div",{className:"modal-subtitle",children:"done"!==m||Ue?`${_t(e.unit_price_value)}`:"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-xs",children:":"}),a.jsx("div",{className:"mt-1",children:oe?a.jsx(s,{size:"sm",variant:"ghost",onClick:()=>xt(t),className:"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6",children:a.jsx(R,{className:"w-3 h-3"})}):a.jsxs(a.Fragment,{children:["purchase"===m&&a.jsx(a.Fragment,{children:Ze?a.jsx("button",{onClick:()=>yt(e.id,!e.is_payment_completed),className:"text-xs px-2 py-1 rounded "+(e.is_payment_completed?"bg-orange-500 text-white hover:bg-orange-600":"bg-gray-100 text-gray-600"),children:e.is_payment_completed?"":""}):a.jsx("span",{className:"text-xs px-2 py-1 rounded "+(e.is_payment_completed?"bg-orange-500 text-white":"bg-gray-100 text-gray-400"),children:e.is_payment_completed?"":""})}),"receipt"===m&&a.jsx(a.Fragment,{children:Xe?st.isCompleted(e)?a.jsx("button",{onClick:()=>{st.handleCancel(e.id,{item_name:e.item_name,specification:e.specification,quantity:e.quantity,unit_price_value:e.unit_price_value,amount_value:e.amount_value,remark:e.remark})},className:"text-xs px-2 py-1 rounded button-action-primary",children:st.config.completedText}):a.jsx(wn,{onDateSelect:t=>{st.handleConfirm(e.id,t,{item_name:e.item_name,specification:e.specification,quantity:e.quantity,unit_price_value:e.unit_price_value,amount_value:e.amount_value,remark:e.remark})},placeholder:"   ",align:"center",side:"bottom",children:a.jsx("button",{className:"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600",children:st.config.waitingText})}):a.jsx("span",{className:"text-xs px-2 py-1 rounded "+(st.isCompleted(e)?"button-action-primary":"bg-gray-100 text-gray-400"),children:st.isCompleted(e)?st.config.completedText:st.config.waitingText})}),"done"===m&&a.jsx(a.Fragment,{children:a.jsx("span",{className:"button-base "+(st.isCompleted(e)?"bg-green-500 text-white":"border border-gray-300 text-gray-600 bg-white"),children:st.isCompleted(e)?"":""})}),"purchase"!==m&&"receipt"!==m&&"done"!==m&&a.jsx("span",{className:"text-xs text-gray-400",children:"-"})]})})]})]}),(e.remark||oe)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-xs",children:":"}),oe?a.jsx(I,{value:e.remark||"",onChange:e=>vt(t,"remark",e.target.value),className:"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400",placeholder:""}):a.jsx("div",{className:"modal-subtitle text-gray-500 mt-1",children:e.remark||"-"})]}),!oe&&"receipt"===m&&st.getCompletedDate(e)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-xs",children:":"}),a.jsxs("div",{className:"mt-1",children:[a.jsx("div",{className:"modal-subtitle text-green-700",children:new Date(st.getCompletedDate(e)).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}),a.jsx("div",{className:"text-[9px] text-gray-500",children:new Date(st.getCompletedDate(e)).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})})]})]}),!oe&&"done"===m&&""===ie.payment_category&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-500 text-xs",children:" :"}),a.jsx("div",{className:"flex items-center gap-2",children:Ge?it.isCompleted(e)?a.jsx("button",{onClick:()=>{it.handleCancel(e.id,{item_name:e.item_name,specification:e.specification,quantity:e.quantity,unit_price_value:e.unit_price_value,amount_value:e.amount_value,remark:e.remark})},className:"text-xs px-2 py-1 rounded button-action-primary hover:bg-green-600",title:"   ",children:it.config.completedText}):a.jsx(wn,{onDateSelect:t=>{it.handleConfirm(e.id,t,{item_name:e.item_name,specification:e.specification,quantity:e.quantity,unit_price_value:e.unit_price_value,amount_value:e.amount_value,remark:e.remark})},placeholder:"  ",align:"end",side:"bottom",children:a.jsx("button",{className:"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600",onClick:()=>{},children:it.config.waitingText})}):a.jsx("span",{className:"text-xs px-2 py-1 rounded "+(it.isCompleted(e)?"button-action-primary":"bg-gray-100 text-gray-400"),children:it.isCompleted(e)?it.config.completedText:it.config.waitingText})})]}),!oe&&"done"===m&&""===ie.payment_category&&it.getCompletedDate(e)&&a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500 text-xs",children:" :"}),a.jsx("div",{className:"mt-1",children:a.jsx("div",{className:"modal-subtitle text-blue-700",children:new Date(it.getCompletedDate(e)).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})})})]})]})]},t))})]})}),a.jsxs("div",{className:"bg-gray-50 px-2 sm:px-3 border-t border-gray-100",children:[a.jsxs("div",{className:"hidden sm:grid items-center gap-1 py-2 w-fit",style:{gridTemplateColumns:ft()},children:[a.jsx("div",{}),a.jsx("div",{}),a.jsx("div",{}),a.jsx("div",{className:"text-right flex items-center justify-end",children:a.jsx("span",{className:"text-[11px] text-gray-600 font-medium",children:""})}),a.jsx("div",{className:"text-right flex items-center justify-end",children:a.jsx("span",{className:"text-[12px] font-bold text-gray-900",children:"done"!==m||Ue?`${_t((oe?ue:$e)?.reduce((e,t)=>e+(t.amount_value||0),0)||0)}`:"-"})}),""===ie.payment_category&&a.jsx("div",{className:"text-right flex items-center justify-end",children:a.jsx("span",{className:"text-[12px] font-bold text-gray-900",children:"done"!==m||Ue?`${_t((oe?ue:$e)?.reduce((e,t)=>e+(t.tax_amount_value||0),0)||0)}`:"-"})}),a.jsx("div",{}),oe?a.jsx("div",{}):a.jsx("div",{className:"done"===m&&""===ie.payment_category?"text-right flex items-center justify-end":"",children:"done"===m&&""===ie.payment_category&&a.jsx("span",{className:"text-[11px] text-gray-600 font-medium",children:""})}),"receipt"===m&&a.jsx("div",{}),"done"===m&&a.jsx(a.Fragment,{children:""===ie.payment_category&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"text-right flex items-center justify-end",children:a.jsx("div",{className:"text-[12px] font-bold text-blue-700",children:Ue?`${_t(ie.total_expenditure_amount??((oe?ue:$e)?.reduce((e,t)=>e+(Number(t.expenditure_amount)||0),0)||0))}`:"-"})}),a.jsx("div",{}),a.jsx("div",{})]})})]}),""===ie.payment_category&&a.jsxs("div",{className:"hidden sm:grid items-center gap-1 py-2 w-fit border-t border-gray-300",style:{gridTemplateColumns:ft()},children:[a.jsx("div",{}),a.jsx("div",{}),a.jsx("div",{}),a.jsx("div",{}),a.jsx("div",{className:"text-right flex items-center justify-end",children:a.jsx("span",{className:"text-[11px] text-gray-600 font-medium",children:""})}),a.jsx("div",{className:"text-right flex items-center justify-end",children:a.jsx("span",{className:"text-[12px] font-bold text-blue-600",children:"done"!==m||Ue?`${_t((oe?ue:$e)?.reduce((e,t)=>e+(t.amount_value||0)+(t.tax_amount_value||0),0)||0)}`:"-"})}),a.jsx("div",{}),a.jsx("div",{}),"receipt"===m&&a.jsx("div",{}),"done"===m&&""===ie.payment_category&&a.jsxs(a.Fragment,{children:[a.jsx("div",{}),a.jsx("div",{}),a.jsx("div",{})]})]}),a.jsxs("div",{className:"block sm:hidden py-2 space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-[12px] text-gray-500",children:" "}),a.jsx("span",{className:"text-[13px] font-bold text-gray-900",children:"done"!==m||Ue?`${_t((oe?ue:$e)?.reduce((e,t)=>e+(t.amount_value||0),0)||0)}`:"-"})]}),""===ie.payment_category&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-[12px] text-gray-500",children:" "}),a.jsx("span",{className:"text-[13px] font-bold text-gray-900",children:"done"!==m||Ue?`${_t((oe?ue:$e)?.reduce((e,t)=>e+(t.tax_amount_value||0),0)||0)}`:"-"})]}),a.jsxs("div",{className:"flex justify-between items-center border-t pt-1",children:[a.jsx("span",{className:"text-[12px] text-gray-500",children:"+"}),a.jsx("span",{className:"text-[13px] font-bold text-blue-600",children:"done"!==m||Ue?`${_t((oe?ue:$e)?.reduce((e,t)=>e+(t.amount_value||0)+(t.tax_amount_value||0),0)||0)}`:"-"})]})]}),"done"===m&&""===ie.payment_category&&a.jsxs("div",{className:"flex justify-between items-center border-t pt-1",children:[a.jsx("span",{className:"text-[12px] text-gray-500",children:" "}),a.jsx("span",{className:"text-[13px] font-bold text-blue-700",children:Ue?`${_t(ie.total_expenditure_amount??((oe?ue:$e)?.reduce((e,t)=>e+(Number(t.expenditure_amount)||0),0)||0))}`:"-"})]})]})]}),oe&&a.jsx("div",{className:"p-2 sm:p-3 border-t border-gray-100",children:a.jsxs(s,{size:"sm",variant:"outline",onClick:()=>{const e={item_name:"",specification:"",quantity:1,unit_price_value:0,amount_value:0,remark:"",line_number:ue.reduce((e,t)=>{const n=t.line_number||0;return n>e?n:e},0)+1},t=[...ue,e].sort((e,t)=>(e.line_number||999999)-(t.line_number||999999));me(t)},className:"w-full rounded-lg border-dashed border-2 border-gray-300 hover:border-gray-400 py-2 badge-text",children:[a.jsx(T,{className:"w-4 h-4 mr-1"})," "]})})]})})]})]}):a.jsx("div",{className:"text-center py-12",children:ae?a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 border-t-transparent rounded-full animate-spin"}),a.jsx("span",{className:"modal-subtitle",children:" ..."})]}):a.jsxs("div",{className:"space-y-3",children:[a.jsx("span",{className:"modal-subtitle",children:"   ."}),!i&&a.jsx("div",{children:a.jsx(s,{size:"sm",variant:"outline",onClick:r,className:"button-base button-action-secondary",children:""})})]})})});return i?jt:a.jsx(P,{open:t,onOpenChange:r,children:a.jsxs(E,{className:"overflow-hidden bg-white rounded-lg shadow-sm border-0 w-full sm:w-auto max-w-[calc(100vw-48px)] sm:max-w-[calc(100vw-80px)] lg:max-w-[90vw] xl:max-w-[85vw] h-[95vh] sm:h-auto sm:max-h-[90vh] lg:max-h-[85vh] sm:rounded-lg flex flex-col",showCloseButton:!1,children:[a.jsx(F,{className:"sr-only",children:a.jsx($,{children:"  "})}),a.jsxs("div",{className:"relative px-3 sm:px-6 pt-0 sm:pt-3 lg:pt-4 pb-0 sm:pb-2 lg:pb-3 flex-shrink-0",children:[a.jsxs("div",{className:"absolute right-3 sm:right-6 top-3 sm:top-3 lg:top-4 flex items-center gap-2 z-10",children:[!Ve&&!oe&&a.jsxs(q,{open:De,onOpenChange:Me,children:[a.jsx(O,{asChild:!0,children:a.jsxs(s,{variant:"outline",size:"sm",className:"button-base button-action-secondary h-8 text-xs px-3 gap-1.5",title:" ",children:[a.jsx(X,{className:"w-3.5 h-3.5 text-gray-500"}),a.jsx("span",{children:" "})]})}),a.jsx(W,{className:"w-80 sm:w-96 p-4",align:"end",onOpenAutoFocus:e=>e.preventDefault(),children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium leading-none",children:" "}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"     ."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(L,{htmlFor:"subject",className:"text-xs",children:""}),a.jsx(I,{id:"subject",value:Ce,onChange:e=>qe(e.target.value),className:"h-8 text-xs",placeholder:" "})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(L,{htmlFor:"message",className:"text-xs",children:""}),a.jsx("div",{className:"relative",onWheel:e=>e.stopPropagation(),children:a.jsx(Y,{id:"message",value:Oe,onChange:e=>We(e.target.value),className:"min-h-[150px] text-xs font-mono overflow-auto",placeholder:"  ",style:{resize:"none"}})})]})]}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx(s,{variant:"outline",size:"sm",onClick:()=>Me(!1),className:"h-8 text-xs",children:""}),a.jsx(s,{size:"sm",onClick:async()=>{if(Ce.trim()&&Oe.trim()){Te(!0);try{const{data:{user:e}}=await Ye.auth.getUser();if(!e)return void z.error(" .");const{error:t}=await Ye.from("support_inquires").insert({user_id:e.id,user_email:e.email,user_name:_e,inquiry_type:"modify",subject:Ce,message:Oe,status:"open",purchase_request_id:ie?.id,purchase_order_number:ie?.purchase_order_number,requester_id:ie?.requester_id,purchase_info:JSON.stringify({vendor_name:ie?.vendor_name,total_amount:ie?.total_amount,item_count:ie?.purchase_request_items?.length||0})});if(t)throw t;z.success("  ."),Me(!1),qe(""),We("")}catch(e){o.error("   ",e),z.error("     .")}finally{Te(!1)}}else z.error("   .")},disabled:Ie,className:"h-8 text-xs bg-blue-600 hover:bg-blue-700",children:Ie?" ...":" "})]})]})})]}),a.jsx("button",{onClick:r,className:"button-base button-action-secondary w-8 h-8 rounded-full flex items-center justify-center",children:a.jsx(g,{className:"w-4 h-4 text-gray-500"})})]}),a.jsx("div",{className:"pr-8 sm:pr-16",children:a.jsxs("div",{className:"flex items-start gap-4 mb-0 sm:mb-3",children:[a.jsx("div",{className:"min-w-0 flex-1",children:a.jsx("h1",{className:"page-title mb-0 sm:mb-1",children:" "})}),a.jsxs("div",{className:"flex items-center gap-3",children:[!oe&&He&&a.jsxs(a.Fragment,{children:[a.jsxs(s,{size:"sm",variant:"outline",onClick:()=>pt(!0),className:"button-base button-action-secondary",children:[a.jsx(J,{className:"w-4 h-4 mr-2"}),""]}),Re&&V&&a.jsxs(s,{size:"sm",variant:"outline",onClick:()=>{ie&&V(ie)},className:"button-base button-action-danger",children:[a.jsx(R,{className:"w-4 h-4 mr-2"}),""]})]}),oe&&a.jsxs(a.Fragment,{children:[a.jsxs(s,{size:"sm",variant:"outline",onClick:()=>{pt(!1),le(ie),me(ie?.items||[]),fe([])},className:"button-base button-action-secondary",children:[a.jsx(g,{className:"w-4 h-4 mr-2"}),""]}),a.jsx(s,{size:"sm",onClick:async()=>{if(ie&&ce){Ee(!0),o.info("handleSave :",{purchaseId:ie.id,vendor_id:ce.vendor_id,vendor_name:ce.vendor_name,vendor:ce.vendor,editedPurchase:ce});try{const e=d(),t=ue.reduce((e,t)=>e+(t.amount_value||0),0);o.info("Update payload:",{purchase_order_number:ce.purchase_order_number||null,requester_name:ce.requester_name||null,vendor_id:ce.vendor_id||null,vendor_name:ce.vendor_name||null,delivery_request_date:ce.delivery_request_date||null,revised_delivery_request_date:ce.revised_delivery_request_date||null,payment_category:ce.payment_category||null,project_vendor:ce.project_vendor||null,project_item:ce.project_item||null,sales_order_number:ce.sales_order_number||null,total_amount:Number(t),updated_at:(new Date).toISOString()});let n=null;ce.contact_id?n=ce.contact_id:Array.isArray(ce.vendor_contacts)&&ce.vendor_contacts.length>0&&(n=ce.vendor_contacts[0].id||null);const{error:a}=await e.from("purchase_requests").update({purchase_order_number:ce.purchase_order_number||null,requester_name:ce.requester_name||null,vendor_id:ce.vendor_id||null,vendor_name:ce.vendor_name||null,contact_id:n,delivery_request_date:ce.delivery_request_date||null,revised_delivery_request_date:ce.revised_delivery_request_date||null,payment_category:ce.payment_category||null,project_vendor:ce.project_vendor||null,project_item:ce.project_item||null,sales_order_number:ce.sales_order_number||null,total_amount:Number(t),updated_at:(new Date).toISOString()}).eq("id",ie.id);if(a)throw o.error("Purchase update error:",a),a;let i=null;if(o.info("  :",{vendor_id:ce.vendor_id,vendor_contacts:ce.vendor_contacts,isArray:Array.isArray(ce.vendor_contacts)}),ce.vendor_id&&Array.isArray(ce.vendor_contacts)&&ce.vendor_contacts.length>0){const t=ce.vendor_contacts[0];if(o.info(" :",{contact:t}),t.id){i=t.id;const{error:n}=await e.from("vendor_contacts").update({contact_name:t.contact_name||"",contact_email:t.contact_email||"",contact_phone:t.contact_phone||"",position:t.position||""}).eq("id",t.id);n?o.error("  :",n):se(e=>{const n=e?{...e,vendor_contacts:[t],contact_id:t.id,contact_name:t.contact_name}:null;return o.info("    setPurchase:",{prev_vendor_contacts:e?.vendor_contacts,new_vendor_contacts:[t],updated_purchase:n}),n})}else if(t.contact_name){const{data:n,error:a}=await e.from("vendor_contacts").insert({vendor_id:ce.vendor_id,contact_name:t.contact_name,contact_email:t.contact_email||"",contact_phone:t.contact_phone||"",position:t.position||""}).select().single();if(a)o.error("  :",a);else if(n){i=n.id,ce.vendor_contacts=[n],o.info("  :",n),se(e=>{const t=e?{...e,vendor_contacts:[n],contact_id:n.id,contact_name:n.contact_name}:null;return o.info("     setPurchase:",{prev_vendor_contacts:e?.vendor_contacts,new_vendor_contacts:[n],newContact_full:n,updated_purchase:t}),t});const{error:t}=await e.from("purchase_requests").update({contact_id:n.id}).eq("id",ie.id);t&&o.error("purchase_requests contact_id  :",t)}}}if(he.length>0){const{error:t}=await e.from("purchase_request_items").delete().in("id",he);if(t)throw t}if(0===ue.length){o.info("     ",{purchaseId:ie.id,deletedItemIds:he});const{error:t}=await e.from("purchase_requests").delete().eq("id",ie.id);if(t)throw o.error("  ",t),t;const n=Number(ie.id);if(!Number.isNaN(n)){k(n)?o.info(" [handleSave]      ",{purchaseId:n}):o.warn("[handleSave]      ",{purchaseId:n})}z.success("    ."),pt(!1),fe([]),r();const a=M?.(!0,{silent:!1});return void(a instanceof Promise&&await a)}for(const r of ue){if(!r.item_name||!r.item_name.trim())throw new Error(" .");if(!r.quantity||r.quantity<=0)throw new Error(" 0  .");if(null!==r.unit_price_value&&void 0!==r.unit_price_value&&r.unit_price_value<0)throw new Error(" 0  .");if(null!==r.amount_value&&void 0!==r.amount_value&&r.amount_value<0)throw new Error(" 0  .");if(r.id){const{error:t}=await e.from("purchase_request_items").update({item_name:r.item_name.trim(),specification:r.specification||null,quantity:Number(r.quantity),received_quantity:null!==r.received_quantity&&void 0!==r.received_quantity?Number(r.received_quantity):null,unit_price_value:Number(r.unit_price_value),unit_price_currency:ie.currency||"KRW",amount_value:Number(r.amount_value),amount_currency:ie.currency||"KRW",remark:r.remark||null,updated_at:(new Date).toISOString()}).eq("id",r.id);if(t)throw o.error("   ",t),t}else{const t={purchase_request_id:ie.id,item_name:r.item_name.trim(),specification:r.specification||null,quantity:Number(r.quantity),received_quantity:null!==r.received_quantity&&void 0!==r.received_quantity?Number(r.received_quantity):null,unit_price_value:Number(r.unit_price_value),unit_price_currency:ie.currency||"KRW",amount_value:Number(r.amount_value),amount_currency:ie.currency||"KRW",remark:r.remark||null,line_number:r.line_number||ue.indexOf(r)+1,created_at:(new Date).toISOString()},{data:n,error:a}=await e.from("purchase_request_items").insert(t).select().single();if(a)throw o.error("   ",a),a;if(n){const e=ue.indexOf(r);-1!==e&&(ue[e]={...ue[e],...n},o.info("   ID :",{id:n.id,itemIndex:e}))}}}const s=ie?Number(ie.id):NaN,c=ce||ie;if(!Number.isNaN(s)&&he.length>0&&(o.info(" [ ]     ",{purchaseId:s,deletedItemIds:he,deletedCount:he.length}),he.forEach(e=>{S(s,e)?o.info(" [handleSave]       ",{purchaseId:s,itemId:e}):o.warn("[handleSave]       ",{purchaseId:s,itemId:e})})),!Number.isNaN(s)){const e=v(s,e=>{const t=ue.reduce((e,t)=>e+(t.amount_value||0),0);return o.info(" [ ]    ",{purchaseId:s,newTotalAmount:t,itemsCount:ue.length}),{...e,purchase_order_number:c?.purchase_order_number||e.purchase_order_number,requester_name:c?.requester_name||e.requester_name,vendor_id:c?.vendor_id||e.vendor_id,vendor_name:c?.vendor_name||e.vendor_name,vendor:c?.vendor||e.vendor,vendor_contacts:c?.vendor_contacts||e.vendor_contacts,delivery_request_date:c?.delivery_request_date||e.delivery_request_date,revised_delivery_request_date:c?.revised_delivery_request_date||e.revised_delivery_request_date,payment_category:c?.payment_category||e.payment_category,project_vendor:c?.project_vendor||e.project_vendor,project_item:c?.project_item||e.project_item,total_amount:t,updated_at:(new Date).toISOString()}});o.info(" [ ]    :",{memoryUpdated:e})}(()=>{!Number.isNaN(s)&&C&&C(s,e=>{const t=ue,n=t.reduce((e,t)=>e+(t.amount_value||0),0);return o.info(" [onOptimisticUpdate]  UI ",{originalItemsCount:e.items?.length||e.purchase_request_items?.length||0,finalItemsCount:t.length,deletedItemsCount:he.length}),{...e,purchase_order_number:c?.purchase_order_number||e.purchase_order_number,requester_name:c?.requester_name||e.requester_name,vendor_id:c?.vendor_id||e.vendor_id,vendor_name:c?.vendor_name||e.vendor_name,vendor:c?.vendor||e.vendor,vendor_contacts:c?.vendor_contacts||e.vendor_contacts,delivery_request_date:c?.delivery_request_date||e.delivery_request_date,revised_delivery_request_date:c?.revised_delivery_request_date||e.revised_delivery_request_date,payment_category:c?.payment_category||e.payment_category,project_vendor:c?.project_vendor||e.project_vendor,project_item:c?.project_item||e.project_item,total_amount:n,items:t,purchase_request_items:t,updated_at:(new Date).toISOString()}})})(),z.success("   ."),pt(!1),fe([]),await Je(),o.info(" refreshModalData   purchase:",{purchaseId:ie?.id});const l=M?.(!0,{silent:!0});l instanceof Promise&&await l}catch(e){o.error("   ",e);const t=e instanceof Error?e.message:"    ";z.error(` : ${t}`)}finally{Ee(!1)}}else z.error("  .")},disabled:Pe,className:"button-base button-action-primary",children:Pe?a.jsxs(a.Fragment,{children:[a.jsx(Z,{className:"w-4 h-4 mr-2 animate-spin"})," ..."]}):a.jsxs(a.Fragment,{children:[a.jsx(K,{className:"w-4 h-4 mr-2"}),""]})})]})]})]})})]}),a.jsx("div",{className:"overflow-y-auto flex-1 px-3 sm:px-6 pb-1 sm:pb-6 mt-0",children:jt})]})})});export{qn as A,Q as C,Dn as D,X as M,Wn as P,Mn as R,ee as T,On as a,Cn as b,G as c,yn as d,V as e,lt as f,J as g,wn as h,xn as k,kn as u};
//# sourceMappingURL=PurchaseDetailModal-J4u3SCkS.js.map
