{"version":3,"file":"PurchaseDetailModal-lCyZjfZ5.js","sources":["../../node_modules/lucide-react/dist/esm/icons/circle-check-big.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/grip-vertical.js","../../node_modules/lucide-react/dist/esm/icons/image.js","../../node_modules/lucide-react/dist/esm/icons/message-square-plus.js","../../node_modules/lucide-react/dist/esm/icons/pen.js","../../node_modules/lucide-react/dist/esm/icons/truck.js","../../node_modules/@dnd-kit/utilities/dist/utilities.esm.js","../../node_modules/@dnd-kit/accessibility/dist/accessibility.esm.js","../../node_modules/@dnd-kit/core/dist/core.esm.js","../../node_modules/@dnd-kit/sortable/dist/sortable.esm.js","../../src/components/ui/date-amount-picker-popover.tsx","../../src/components/ui/date-quantity-picker-popover.tsx","../../src/hooks/useConfirmDateAction.ts","../../src/constants/columnSettings.ts","../../src/types/transactionStatement.ts","../../src/services/transactionStatementService.ts","../../src/components/purchase/PurchaseDetailModal.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21.801 10A10 10 0 1 1 17 3.335\", key: \"yps3ct\" }],\n  [\"path\", { d: \"m9 11 3 3L22 4\", key: \"1pflzl\" }]\n];\nconst CircleCheckBig = createLucideIcon(\"circle-check-big\", __iconNode);\n\nexport { __iconNode, CircleCheckBig as default };\n//# sourceMappingURL=circle-check-big.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"9\", cy: \"12\", r: \"1\", key: \"1vctgf\" }],\n  [\"circle\", { cx: \"9\", cy: \"5\", r: \"1\", key: \"hp0tcf\" }],\n  [\"circle\", { cx: \"9\", cy: \"19\", r: \"1\", key: \"fkjjf6\" }],\n  [\"circle\", { cx: \"15\", cy: \"12\", r: \"1\", key: \"1tmaij\" }],\n  [\"circle\", { cx: \"15\", cy: \"5\", r: \"1\", key: \"19l28e\" }],\n  [\"circle\", { cx: \"15\", cy: \"19\", r: \"1\", key: \"f4zoj3\" }]\n];\nconst GripVertical = createLucideIcon(\"grip-vertical\", __iconNode);\n\nexport { __iconNode, GripVertical as default };\n//# sourceMappingURL=grip-vertical.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"3\", rx: \"2\", ry: \"2\", key: \"1m3agn\" }],\n  [\"circle\", { cx: \"9\", cy: \"9\", r: \"2\", key: \"af1f0g\" }],\n  [\"path\", { d: \"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\", key: \"1xmnt7\" }]\n];\nconst Image = createLucideIcon(\"image\", __iconNode);\n\nexport { __iconNode, Image as default };\n//# sourceMappingURL=image.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z\",\n      key: \"18887p\"\n    }\n  ],\n  [\"path\", { d: \"M12 8v6\", key: \"1ib9pf\" }],\n  [\"path\", { d: \"M9 11h6\", key: \"1fldmi\" }]\n];\nconst MessageSquarePlus = createLucideIcon(\"message-square-plus\", __iconNode);\n\nexport { __iconNode, MessageSquarePlus as default };\n//# sourceMappingURL=message-square-plus.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ]\n];\nconst Pen = createLucideIcon(\"pen\", __iconNode);\n\nexport { __iconNode, Pen as default };\n//# sourceMappingURL=pen.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2\", key: \"wrbu53\" }],\n  [\"path\", { d: \"M15 18H9\", key: \"1lyqi6\" }],\n  [\n    \"path\",\n    {\n      d: \"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14\",\n      key: \"lysw3i\"\n    }\n  ],\n  [\"circle\", { cx: \"17\", cy: \"18\", r: \"2\", key: \"332jqn\" }],\n  [\"circle\", { cx: \"7\", cy: \"18\", r: \"2\", key: \"19iecd\" }]\n];\nconst Truck = createLucideIcon(\"truck\", __iconNode);\n\nexport { __iconNode, Truck as default };\n//# sourceMappingURL=truck.js.map\n","import { useMemo, useLayoutEffect, useEffect, useRef, useCallback } from 'react';\n\nfunction useCombinedRefs() {\n  for (var _len = arguments.length, refs = new Array(_len), _key = 0; _key < _len; _key++) {\n    refs[_key] = arguments[_key];\n  }\n\n  return useMemo(() => node => {\n    refs.forEach(ref => ref(node));\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  refs);\n}\n\n// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nconst canUseDOM = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined';\n\nfunction isWindow(element) {\n  const elementString = Object.prototype.toString.call(element);\n  return elementString === '[object Window]' || // In Electron context the Window object serializes to [object global]\n  elementString === '[object global]';\n}\n\nfunction isNode(node) {\n  return 'nodeType' in node;\n}\n\nfunction getWindow(target) {\n  var _target$ownerDocument, _target$ownerDocument2;\n\n  if (!target) {\n    return window;\n  }\n\n  if (isWindow(target)) {\n    return target;\n  }\n\n  if (!isNode(target)) {\n    return window;\n  }\n\n  return (_target$ownerDocument = (_target$ownerDocument2 = target.ownerDocument) == null ? void 0 : _target$ownerDocument2.defaultView) != null ? _target$ownerDocument : window;\n}\n\nfunction isDocument(node) {\n  const {\n    Document\n  } = getWindow(node);\n  return node instanceof Document;\n}\n\nfunction isHTMLElement(node) {\n  if (isWindow(node)) {\n    return false;\n  }\n\n  return node instanceof getWindow(node).HTMLElement;\n}\n\nfunction isSVGElement(node) {\n  return node instanceof getWindow(node).SVGElement;\n}\n\nfunction getOwnerDocument(target) {\n  if (!target) {\n    return document;\n  }\n\n  if (isWindow(target)) {\n    return target.document;\n  }\n\n  if (!isNode(target)) {\n    return document;\n  }\n\n  if (isDocument(target)) {\n    return target;\n  }\n\n  if (isHTMLElement(target) || isSVGElement(target)) {\n    return target.ownerDocument;\n  }\n\n  return document;\n}\n\n/**\r\n * A hook that resolves to useEffect on the server and useLayoutEffect on the client\r\n * @param callback {function} Callback function that is invoked when the dependencies of the hook change\r\n */\n\nconst useIsomorphicLayoutEffect = canUseDOM ? useLayoutEffect : useEffect;\n\nfunction useEvent(handler) {\n  const handlerRef = useRef(handler);\n  useIsomorphicLayoutEffect(() => {\n    handlerRef.current = handler;\n  });\n  return useCallback(function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return handlerRef.current == null ? void 0 : handlerRef.current(...args);\n  }, []);\n}\n\nfunction useInterval() {\n  const intervalRef = useRef(null);\n  const set = useCallback((listener, duration) => {\n    intervalRef.current = setInterval(listener, duration);\n  }, []);\n  const clear = useCallback(() => {\n    if (intervalRef.current !== null) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n  }, []);\n  return [set, clear];\n}\n\nfunction useLatestValue(value, dependencies) {\n  if (dependencies === void 0) {\n    dependencies = [value];\n  }\n\n  const valueRef = useRef(value);\n  useIsomorphicLayoutEffect(() => {\n    if (valueRef.current !== value) {\n      valueRef.current = value;\n    }\n  }, dependencies);\n  return valueRef;\n}\n\nfunction useLazyMemo(callback, dependencies) {\n  const valueRef = useRef();\n  return useMemo(() => {\n    const newValue = callback(valueRef.current);\n    valueRef.current = newValue;\n    return newValue;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [...dependencies]);\n}\n\nfunction useNodeRef(onChange) {\n  const onChangeHandler = useEvent(onChange);\n  const node = useRef(null);\n  const setNodeRef = useCallback(element => {\n    if (element !== node.current) {\n      onChangeHandler == null ? void 0 : onChangeHandler(element, node.current);\n    }\n\n    node.current = element;\n  }, //eslint-disable-next-line\n  []);\n  return [node, setNodeRef];\n}\n\nfunction usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n  return ref.current;\n}\n\nlet ids = {};\nfunction useUniqueId(prefix, value) {\n  return useMemo(() => {\n    if (value) {\n      return value;\n    }\n\n    const id = ids[prefix] == null ? 0 : ids[prefix] + 1;\n    ids[prefix] = id;\n    return prefix + \"-\" + id;\n  }, [prefix, value]);\n}\n\nfunction createAdjustmentFn(modifier) {\n  return function (object) {\n    for (var _len = arguments.length, adjustments = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      adjustments[_key - 1] = arguments[_key];\n    }\n\n    return adjustments.reduce((accumulator, adjustment) => {\n      const entries = Object.entries(adjustment);\n\n      for (const [key, valueAdjustment] of entries) {\n        const value = accumulator[key];\n\n        if (value != null) {\n          accumulator[key] = value + modifier * valueAdjustment;\n        }\n      }\n\n      return accumulator;\n    }, { ...object\n    });\n  };\n}\n\nconst add = /*#__PURE__*/createAdjustmentFn(1);\nconst subtract = /*#__PURE__*/createAdjustmentFn(-1);\n\nfunction hasViewportRelativeCoordinates(event) {\n  return 'clientX' in event && 'clientY' in event;\n}\n\nfunction isKeyboardEvent(event) {\n  if (!event) {\n    return false;\n  }\n\n  const {\n    KeyboardEvent\n  } = getWindow(event.target);\n  return KeyboardEvent && event instanceof KeyboardEvent;\n}\n\nfunction isTouchEvent(event) {\n  if (!event) {\n    return false;\n  }\n\n  const {\n    TouchEvent\n  } = getWindow(event.target);\n  return TouchEvent && event instanceof TouchEvent;\n}\n\n/**\r\n * Returns the normalized x and y coordinates for mouse and touch events.\r\n */\n\nfunction getEventCoordinates(event) {\n  if (isTouchEvent(event)) {\n    if (event.touches && event.touches.length) {\n      const {\n        clientX: x,\n        clientY: y\n      } = event.touches[0];\n      return {\n        x,\n        y\n      };\n    } else if (event.changedTouches && event.changedTouches.length) {\n      const {\n        clientX: x,\n        clientY: y\n      } = event.changedTouches[0];\n      return {\n        x,\n        y\n      };\n    }\n  }\n\n  if (hasViewportRelativeCoordinates(event)) {\n    return {\n      x: event.clientX,\n      y: event.clientY\n    };\n  }\n\n  return null;\n}\n\nconst CSS = /*#__PURE__*/Object.freeze({\n  Translate: {\n    toString(transform) {\n      if (!transform) {\n        return;\n      }\n\n      const {\n        x,\n        y\n      } = transform;\n      return \"translate3d(\" + (x ? Math.round(x) : 0) + \"px, \" + (y ? Math.round(y) : 0) + \"px, 0)\";\n    }\n\n  },\n  Scale: {\n    toString(transform) {\n      if (!transform) {\n        return;\n      }\n\n      const {\n        scaleX,\n        scaleY\n      } = transform;\n      return \"scaleX(\" + scaleX + \") scaleY(\" + scaleY + \")\";\n    }\n\n  },\n  Transform: {\n    toString(transform) {\n      if (!transform) {\n        return;\n      }\n\n      return [CSS.Translate.toString(transform), CSS.Scale.toString(transform)].join(' ');\n    }\n\n  },\n  Transition: {\n    toString(_ref) {\n      let {\n        property,\n        duration,\n        easing\n      } = _ref;\n      return property + \" \" + duration + \"ms \" + easing;\n    }\n\n  }\n});\n\nconst SELECTOR = 'a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]';\nfunction findFirstFocusableNode(element) {\n  if (element.matches(SELECTOR)) {\n    return element;\n  }\n\n  return element.querySelector(SELECTOR);\n}\n\nexport { CSS, add, canUseDOM, findFirstFocusableNode, getEventCoordinates, getOwnerDocument, getWindow, hasViewportRelativeCoordinates, isDocument, isHTMLElement, isKeyboardEvent, isNode, isSVGElement, isTouchEvent, isWindow, subtract, useCombinedRefs, useEvent, useInterval, useIsomorphicLayoutEffect, useLatestValue, useLazyMemo, useNodeRef, usePrevious, useUniqueId };\n//# sourceMappingURL=utilities.esm.js.map\n","import React, { useState, useCallback } from 'react';\n\nconst hiddenStyles = {\n  display: 'none'\n};\nfunction HiddenText(_ref) {\n  let {\n    id,\n    value\n  } = _ref;\n  return React.createElement(\"div\", {\n    id: id,\n    style: hiddenStyles\n  }, value);\n}\n\nfunction LiveRegion(_ref) {\n  let {\n    id,\n    announcement,\n    ariaLiveType = \"assertive\"\n  } = _ref;\n  // Hide element visually but keep it readable by screen readers\n  const visuallyHidden = {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: 1,\n    height: 1,\n    margin: -1,\n    border: 0,\n    padding: 0,\n    overflow: 'hidden',\n    clip: 'rect(0 0 0 0)',\n    clipPath: 'inset(100%)',\n    whiteSpace: 'nowrap'\n  };\n  return React.createElement(\"div\", {\n    id: id,\n    style: visuallyHidden,\n    role: \"status\",\n    \"aria-live\": ariaLiveType,\n    \"aria-atomic\": true\n  }, announcement);\n}\n\nfunction useAnnouncement() {\n  const [announcement, setAnnouncement] = useState('');\n  const announce = useCallback(value => {\n    if (value != null) {\n      setAnnouncement(value);\n    }\n  }, []);\n  return {\n    announce,\n    announcement\n  };\n}\n\nexport { HiddenText, LiveRegion, useAnnouncement };\n//# sourceMappingURL=accessibility.esm.js.map\n","import React, { createContext, useContext, useEffect, useState, useCallback, useMemo, useRef, memo, useReducer, cloneElement, forwardRef } from 'react';\nimport { createPortal, unstable_batchedUpdates } from 'react-dom';\nimport { useUniqueId, getEventCoordinates, getWindow, isDocument, isHTMLElement, isSVGElement, canUseDOM, isWindow, isNode, getOwnerDocument, add, isKeyboardEvent, subtract, useLazyMemo, useInterval, usePrevious, useLatestValue, useEvent, useIsomorphicLayoutEffect, useNodeRef, findFirstFocusableNode, CSS } from '@dnd-kit/utilities';\nimport { useAnnouncement, HiddenText, LiveRegion } from '@dnd-kit/accessibility';\n\nconst DndMonitorContext = /*#__PURE__*/createContext(null);\n\nfunction useDndMonitor(listener) {\n  const registerListener = useContext(DndMonitorContext);\n  useEffect(() => {\n    if (!registerListener) {\n      throw new Error('useDndMonitor must be used within a children of <DndContext>');\n    }\n\n    const unsubscribe = registerListener(listener);\n    return unsubscribe;\n  }, [listener, registerListener]);\n}\n\nfunction useDndMonitorProvider() {\n  const [listeners] = useState(() => new Set());\n  const registerListener = useCallback(listener => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  }, [listeners]);\n  const dispatch = useCallback(_ref => {\n    let {\n      type,\n      event\n    } = _ref;\n    listeners.forEach(listener => {\n      var _listener$type;\n\n      return (_listener$type = listener[type]) == null ? void 0 : _listener$type.call(listener, event);\n    });\n  }, [listeners]);\n  return [dispatch, registerListener];\n}\n\nconst defaultScreenReaderInstructions = {\n  draggable: \"\\n    To pick up a draggable item, press the space bar.\\n    While dragging, use the arrow keys to move the item.\\n    Press space again to drop the item in its new position, or press escape to cancel.\\n  \"\n};\nconst defaultAnnouncements = {\n  onDragStart(_ref) {\n    let {\n      active\n    } = _ref;\n    return \"Picked up draggable item \" + active.id + \".\";\n  },\n\n  onDragOver(_ref2) {\n    let {\n      active,\n      over\n    } = _ref2;\n\n    if (over) {\n      return \"Draggable item \" + active.id + \" was moved over droppable area \" + over.id + \".\";\n    }\n\n    return \"Draggable item \" + active.id + \" is no longer over a droppable area.\";\n  },\n\n  onDragEnd(_ref3) {\n    let {\n      active,\n      over\n    } = _ref3;\n\n    if (over) {\n      return \"Draggable item \" + active.id + \" was dropped over droppable area \" + over.id;\n    }\n\n    return \"Draggable item \" + active.id + \" was dropped.\";\n  },\n\n  onDragCancel(_ref4) {\n    let {\n      active\n    } = _ref4;\n    return \"Dragging was cancelled. Draggable item \" + active.id + \" was dropped.\";\n  }\n\n};\n\nfunction Accessibility(_ref) {\n  let {\n    announcements = defaultAnnouncements,\n    container,\n    hiddenTextDescribedById,\n    screenReaderInstructions = defaultScreenReaderInstructions\n  } = _ref;\n  const {\n    announce,\n    announcement\n  } = useAnnouncement();\n  const liveRegionId = useUniqueId(\"DndLiveRegion\");\n  const [mounted, setMounted] = useState(false);\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n  useDndMonitor(useMemo(() => ({\n    onDragStart(_ref2) {\n      let {\n        active\n      } = _ref2;\n      announce(announcements.onDragStart({\n        active\n      }));\n    },\n\n    onDragMove(_ref3) {\n      let {\n        active,\n        over\n      } = _ref3;\n\n      if (announcements.onDragMove) {\n        announce(announcements.onDragMove({\n          active,\n          over\n        }));\n      }\n    },\n\n    onDragOver(_ref4) {\n      let {\n        active,\n        over\n      } = _ref4;\n      announce(announcements.onDragOver({\n        active,\n        over\n      }));\n    },\n\n    onDragEnd(_ref5) {\n      let {\n        active,\n        over\n      } = _ref5;\n      announce(announcements.onDragEnd({\n        active,\n        over\n      }));\n    },\n\n    onDragCancel(_ref6) {\n      let {\n        active,\n        over\n      } = _ref6;\n      announce(announcements.onDragCancel({\n        active,\n        over\n      }));\n    }\n\n  }), [announce, announcements]));\n\n  if (!mounted) {\n    return null;\n  }\n\n  const markup = React.createElement(React.Fragment, null, React.createElement(HiddenText, {\n    id: hiddenTextDescribedById,\n    value: screenReaderInstructions.draggable\n  }), React.createElement(LiveRegion, {\n    id: liveRegionId,\n    announcement: announcement\n  }));\n  return container ? createPortal(markup, container) : markup;\n}\n\nvar Action;\n\n(function (Action) {\n  Action[\"DragStart\"] = \"dragStart\";\n  Action[\"DragMove\"] = \"dragMove\";\n  Action[\"DragEnd\"] = \"dragEnd\";\n  Action[\"DragCancel\"] = \"dragCancel\";\n  Action[\"DragOver\"] = \"dragOver\";\n  Action[\"RegisterDroppable\"] = \"registerDroppable\";\n  Action[\"SetDroppableDisabled\"] = \"setDroppableDisabled\";\n  Action[\"UnregisterDroppable\"] = \"unregisterDroppable\";\n})(Action || (Action = {}));\n\nfunction noop() {}\n\nfunction useSensor(sensor, options) {\n  return useMemo(() => ({\n    sensor,\n    options: options != null ? options : {}\n  }), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [sensor, options]);\n}\n\nfunction useSensors() {\n  for (var _len = arguments.length, sensors = new Array(_len), _key = 0; _key < _len; _key++) {\n    sensors[_key] = arguments[_key];\n  }\n\n  return useMemo(() => [...sensors].filter(sensor => sensor != null), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [...sensors]);\n}\n\nconst defaultCoordinates = /*#__PURE__*/Object.freeze({\n  x: 0,\n  y: 0\n});\n\n/**\r\n * Returns the distance between two points\r\n */\nfunction distanceBetween(p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}\n\nfunction getRelativeTransformOrigin(event, rect) {\n  const eventCoordinates = getEventCoordinates(event);\n\n  if (!eventCoordinates) {\n    return '0 0';\n  }\n\n  const transformOrigin = {\n    x: (eventCoordinates.x - rect.left) / rect.width * 100,\n    y: (eventCoordinates.y - rect.top) / rect.height * 100\n  };\n  return transformOrigin.x + \"% \" + transformOrigin.y + \"%\";\n}\n\n/**\r\n * Sort collisions from smallest to greatest value\r\n */\nfunction sortCollisionsAsc(_ref, _ref2) {\n  let {\n    data: {\n      value: a\n    }\n  } = _ref;\n  let {\n    data: {\n      value: b\n    }\n  } = _ref2;\n  return a - b;\n}\n/**\r\n * Sort collisions from greatest to smallest value\r\n */\n\nfunction sortCollisionsDesc(_ref3, _ref4) {\n  let {\n    data: {\n      value: a\n    }\n  } = _ref3;\n  let {\n    data: {\n      value: b\n    }\n  } = _ref4;\n  return b - a;\n}\n/**\r\n * Returns the coordinates of the corners of a given rectangle:\r\n * [TopLeft {x, y}, TopRight {x, y}, BottomLeft {x, y}, BottomRight {x, y}]\r\n */\n\nfunction cornersOfRectangle(_ref5) {\n  let {\n    left,\n    top,\n    height,\n    width\n  } = _ref5;\n  return [{\n    x: left,\n    y: top\n  }, {\n    x: left + width,\n    y: top\n  }, {\n    x: left,\n    y: top + height\n  }, {\n    x: left + width,\n    y: top + height\n  }];\n}\nfunction getFirstCollision(collisions, property) {\n  if (!collisions || collisions.length === 0) {\n    return null;\n  }\n\n  const [firstCollision] = collisions;\n  return property ? firstCollision[property] : firstCollision;\n}\n\n/**\r\n * Returns the coordinates of the center of a given ClientRect\r\n */\n\nfunction centerOfRectangle(rect, left, top) {\n  if (left === void 0) {\n    left = rect.left;\n  }\n\n  if (top === void 0) {\n    top = rect.top;\n  }\n\n  return {\n    x: left + rect.width * 0.5,\n    y: top + rect.height * 0.5\n  };\n}\n/**\r\n * Returns the closest rectangles from an array of rectangles to the center of a given\r\n * rectangle.\r\n */\n\n\nconst closestCenter = _ref => {\n  let {\n    collisionRect,\n    droppableRects,\n    droppableContainers\n  } = _ref;\n  const centerRect = centerOfRectangle(collisionRect, collisionRect.left, collisionRect.top);\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect) {\n      const distBetween = distanceBetween(centerOfRectangle(rect), centerRect);\n      collisions.push({\n        id,\n        data: {\n          droppableContainer,\n          value: distBetween\n        }\n      });\n    }\n  }\n\n  return collisions.sort(sortCollisionsAsc);\n};\n\n/**\r\n * Returns the closest rectangles from an array of rectangles to the corners of\r\n * another rectangle.\r\n */\n\nconst closestCorners = _ref => {\n  let {\n    collisionRect,\n    droppableRects,\n    droppableContainers\n  } = _ref;\n  const corners = cornersOfRectangle(collisionRect);\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect) {\n      const rectCorners = cornersOfRectangle(rect);\n      const distances = corners.reduce((accumulator, corner, index) => {\n        return accumulator + distanceBetween(rectCorners[index], corner);\n      }, 0);\n      const effectiveDistance = Number((distances / 4).toFixed(4));\n      collisions.push({\n        id,\n        data: {\n          droppableContainer,\n          value: effectiveDistance\n        }\n      });\n    }\n  }\n\n  return collisions.sort(sortCollisionsAsc);\n};\n\n/**\r\n * Returns the intersecting rectangle area between two rectangles\r\n */\n\nfunction getIntersectionRatio(entry, target) {\n  const top = Math.max(target.top, entry.top);\n  const left = Math.max(target.left, entry.left);\n  const right = Math.min(target.left + target.width, entry.left + entry.width);\n  const bottom = Math.min(target.top + target.height, entry.top + entry.height);\n  const width = right - left;\n  const height = bottom - top;\n\n  if (left < right && top < bottom) {\n    const targetArea = target.width * target.height;\n    const entryArea = entry.width * entry.height;\n    const intersectionArea = width * height;\n    const intersectionRatio = intersectionArea / (targetArea + entryArea - intersectionArea);\n    return Number(intersectionRatio.toFixed(4));\n  } // Rectangles do not overlap, or overlap has an area of zero (edge/corner overlap)\n\n\n  return 0;\n}\n/**\r\n * Returns the rectangles that has the greatest intersection area with a given\r\n * rectangle in an array of rectangles.\r\n */\n\nconst rectIntersection = _ref => {\n  let {\n    collisionRect,\n    droppableRects,\n    droppableContainers\n  } = _ref;\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect) {\n      const intersectionRatio = getIntersectionRatio(rect, collisionRect);\n\n      if (intersectionRatio > 0) {\n        collisions.push({\n          id,\n          data: {\n            droppableContainer,\n            value: intersectionRatio\n          }\n        });\n      }\n    }\n  }\n\n  return collisions.sort(sortCollisionsDesc);\n};\n\n/**\r\n * Check if a given point is contained within a bounding rectangle\r\n */\n\nfunction isPointWithinRect(point, rect) {\n  const {\n    top,\n    left,\n    bottom,\n    right\n  } = rect;\n  return top <= point.y && point.y <= bottom && left <= point.x && point.x <= right;\n}\n/**\r\n * Returns the rectangles that the pointer is hovering over\r\n */\n\n\nconst pointerWithin = _ref => {\n  let {\n    droppableContainers,\n    droppableRects,\n    pointerCoordinates\n  } = _ref;\n\n  if (!pointerCoordinates) {\n    return [];\n  }\n\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect && isPointWithinRect(pointerCoordinates, rect)) {\n      /* There may be more than a single rectangle intersecting\r\n       * with the pointer coordinates. In order to sort the\r\n       * colliding rectangles, we measure the distance between\r\n       * the pointer and the corners of the intersecting rectangle\r\n       */\n      const corners = cornersOfRectangle(rect);\n      const distances = corners.reduce((accumulator, corner) => {\n        return accumulator + distanceBetween(pointerCoordinates, corner);\n      }, 0);\n      const effectiveDistance = Number((distances / 4).toFixed(4));\n      collisions.push({\n        id,\n        data: {\n          droppableContainer,\n          value: effectiveDistance\n        }\n      });\n    }\n  }\n\n  return collisions.sort(sortCollisionsAsc);\n};\n\nfunction adjustScale(transform, rect1, rect2) {\n  return { ...transform,\n    scaleX: rect1 && rect2 ? rect1.width / rect2.width : 1,\n    scaleY: rect1 && rect2 ? rect1.height / rect2.height : 1\n  };\n}\n\nfunction getRectDelta(rect1, rect2) {\n  return rect1 && rect2 ? {\n    x: rect1.left - rect2.left,\n    y: rect1.top - rect2.top\n  } : defaultCoordinates;\n}\n\nfunction createRectAdjustmentFn(modifier) {\n  return function adjustClientRect(rect) {\n    for (var _len = arguments.length, adjustments = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      adjustments[_key - 1] = arguments[_key];\n    }\n\n    return adjustments.reduce((acc, adjustment) => ({ ...acc,\n      top: acc.top + modifier * adjustment.y,\n      bottom: acc.bottom + modifier * adjustment.y,\n      left: acc.left + modifier * adjustment.x,\n      right: acc.right + modifier * adjustment.x\n    }), { ...rect\n    });\n  };\n}\nconst getAdjustedRect = /*#__PURE__*/createRectAdjustmentFn(1);\n\nfunction parseTransform(transform) {\n  if (transform.startsWith('matrix3d(')) {\n    const transformArray = transform.slice(9, -1).split(/, /);\n    return {\n      x: +transformArray[12],\n      y: +transformArray[13],\n      scaleX: +transformArray[0],\n      scaleY: +transformArray[5]\n    };\n  } else if (transform.startsWith('matrix(')) {\n    const transformArray = transform.slice(7, -1).split(/, /);\n    return {\n      x: +transformArray[4],\n      y: +transformArray[5],\n      scaleX: +transformArray[0],\n      scaleY: +transformArray[3]\n    };\n  }\n\n  return null;\n}\n\nfunction inverseTransform(rect, transform, transformOrigin) {\n  const parsedTransform = parseTransform(transform);\n\n  if (!parsedTransform) {\n    return rect;\n  }\n\n  const {\n    scaleX,\n    scaleY,\n    x: translateX,\n    y: translateY\n  } = parsedTransform;\n  const x = rect.left - translateX - (1 - scaleX) * parseFloat(transformOrigin);\n  const y = rect.top - translateY - (1 - scaleY) * parseFloat(transformOrigin.slice(transformOrigin.indexOf(' ') + 1));\n  const w = scaleX ? rect.width / scaleX : rect.width;\n  const h = scaleY ? rect.height / scaleY : rect.height;\n  return {\n    width: w,\n    height: h,\n    top: y,\n    right: x + w,\n    bottom: y + h,\n    left: x\n  };\n}\n\nconst defaultOptions = {\n  ignoreTransform: false\n};\n/**\r\n * Returns the bounding client rect of an element relative to the viewport.\r\n */\n\nfunction getClientRect(element, options) {\n  if (options === void 0) {\n    options = defaultOptions;\n  }\n\n  let rect = element.getBoundingClientRect();\n\n  if (options.ignoreTransform) {\n    const {\n      transform,\n      transformOrigin\n    } = getWindow(element).getComputedStyle(element);\n\n    if (transform) {\n      rect = inverseTransform(rect, transform, transformOrigin);\n    }\n  }\n\n  const {\n    top,\n    left,\n    width,\n    height,\n    bottom,\n    right\n  } = rect;\n  return {\n    top,\n    left,\n    width,\n    height,\n    bottom,\n    right\n  };\n}\n/**\r\n * Returns the bounding client rect of an element relative to the viewport.\r\n *\r\n * @remarks\r\n * The ClientRect returned by this method does not take into account transforms\r\n * applied to the element it measures.\r\n *\r\n */\n\nfunction getTransformAgnosticClientRect(element) {\n  return getClientRect(element, {\n    ignoreTransform: true\n  });\n}\n\nfunction getWindowClientRect(element) {\n  const width = element.innerWidth;\n  const height = element.innerHeight;\n  return {\n    top: 0,\n    left: 0,\n    right: width,\n    bottom: height,\n    width,\n    height\n  };\n}\n\nfunction isFixed(node, computedStyle) {\n  if (computedStyle === void 0) {\n    computedStyle = getWindow(node).getComputedStyle(node);\n  }\n\n  return computedStyle.position === 'fixed';\n}\n\nfunction isScrollable(element, computedStyle) {\n  if (computedStyle === void 0) {\n    computedStyle = getWindow(element).getComputedStyle(element);\n  }\n\n  const overflowRegex = /(auto|scroll|overlay)/;\n  const properties = ['overflow', 'overflowX', 'overflowY'];\n  return properties.some(property => {\n    const value = computedStyle[property];\n    return typeof value === 'string' ? overflowRegex.test(value) : false;\n  });\n}\n\nfunction getScrollableAncestors(element, limit) {\n  const scrollParents = [];\n\n  function findScrollableAncestors(node) {\n    if (limit != null && scrollParents.length >= limit) {\n      return scrollParents;\n    }\n\n    if (!node) {\n      return scrollParents;\n    }\n\n    if (isDocument(node) && node.scrollingElement != null && !scrollParents.includes(node.scrollingElement)) {\n      scrollParents.push(node.scrollingElement);\n      return scrollParents;\n    }\n\n    if (!isHTMLElement(node) || isSVGElement(node)) {\n      return scrollParents;\n    }\n\n    if (scrollParents.includes(node)) {\n      return scrollParents;\n    }\n\n    const computedStyle = getWindow(element).getComputedStyle(node);\n\n    if (node !== element) {\n      if (isScrollable(node, computedStyle)) {\n        scrollParents.push(node);\n      }\n    }\n\n    if (isFixed(node, computedStyle)) {\n      return scrollParents;\n    }\n\n    return findScrollableAncestors(node.parentNode);\n  }\n\n  if (!element) {\n    return scrollParents;\n  }\n\n  return findScrollableAncestors(element);\n}\nfunction getFirstScrollableAncestor(node) {\n  const [firstScrollableAncestor] = getScrollableAncestors(node, 1);\n  return firstScrollableAncestor != null ? firstScrollableAncestor : null;\n}\n\nfunction getScrollableElement(element) {\n  if (!canUseDOM || !element) {\n    return null;\n  }\n\n  if (isWindow(element)) {\n    return element;\n  }\n\n  if (!isNode(element)) {\n    return null;\n  }\n\n  if (isDocument(element) || element === getOwnerDocument(element).scrollingElement) {\n    return window;\n  }\n\n  if (isHTMLElement(element)) {\n    return element;\n  }\n\n  return null;\n}\n\nfunction getScrollXCoordinate(element) {\n  if (isWindow(element)) {\n    return element.scrollX;\n  }\n\n  return element.scrollLeft;\n}\nfunction getScrollYCoordinate(element) {\n  if (isWindow(element)) {\n    return element.scrollY;\n  }\n\n  return element.scrollTop;\n}\nfunction getScrollCoordinates(element) {\n  return {\n    x: getScrollXCoordinate(element),\n    y: getScrollYCoordinate(element)\n  };\n}\n\nvar Direction;\n\n(function (Direction) {\n  Direction[Direction[\"Forward\"] = 1] = \"Forward\";\n  Direction[Direction[\"Backward\"] = -1] = \"Backward\";\n})(Direction || (Direction = {}));\n\nfunction isDocumentScrollingElement(element) {\n  if (!canUseDOM || !element) {\n    return false;\n  }\n\n  return element === document.scrollingElement;\n}\n\nfunction getScrollPosition(scrollingContainer) {\n  const minScroll = {\n    x: 0,\n    y: 0\n  };\n  const dimensions = isDocumentScrollingElement(scrollingContainer) ? {\n    height: window.innerHeight,\n    width: window.innerWidth\n  } : {\n    height: scrollingContainer.clientHeight,\n    width: scrollingContainer.clientWidth\n  };\n  const maxScroll = {\n    x: scrollingContainer.scrollWidth - dimensions.width,\n    y: scrollingContainer.scrollHeight - dimensions.height\n  };\n  const isTop = scrollingContainer.scrollTop <= minScroll.y;\n  const isLeft = scrollingContainer.scrollLeft <= minScroll.x;\n  const isBottom = scrollingContainer.scrollTop >= maxScroll.y;\n  const isRight = scrollingContainer.scrollLeft >= maxScroll.x;\n  return {\n    isTop,\n    isLeft,\n    isBottom,\n    isRight,\n    maxScroll,\n    minScroll\n  };\n}\n\nconst defaultThreshold = {\n  x: 0.2,\n  y: 0.2\n};\nfunction getScrollDirectionAndSpeed(scrollContainer, scrollContainerRect, _ref, acceleration, thresholdPercentage) {\n  let {\n    top,\n    left,\n    right,\n    bottom\n  } = _ref;\n\n  if (acceleration === void 0) {\n    acceleration = 10;\n  }\n\n  if (thresholdPercentage === void 0) {\n    thresholdPercentage = defaultThreshold;\n  }\n\n  const {\n    isTop,\n    isBottom,\n    isLeft,\n    isRight\n  } = getScrollPosition(scrollContainer);\n  const direction = {\n    x: 0,\n    y: 0\n  };\n  const speed = {\n    x: 0,\n    y: 0\n  };\n  const threshold = {\n    height: scrollContainerRect.height * thresholdPercentage.y,\n    width: scrollContainerRect.width * thresholdPercentage.x\n  };\n\n  if (!isTop && top <= scrollContainerRect.top + threshold.height) {\n    // Scroll Up\n    direction.y = Direction.Backward;\n    speed.y = acceleration * Math.abs((scrollContainerRect.top + threshold.height - top) / threshold.height);\n  } else if (!isBottom && bottom >= scrollContainerRect.bottom - threshold.height) {\n    // Scroll Down\n    direction.y = Direction.Forward;\n    speed.y = acceleration * Math.abs((scrollContainerRect.bottom - threshold.height - bottom) / threshold.height);\n  }\n\n  if (!isRight && right >= scrollContainerRect.right - threshold.width) {\n    // Scroll Right\n    direction.x = Direction.Forward;\n    speed.x = acceleration * Math.abs((scrollContainerRect.right - threshold.width - right) / threshold.width);\n  } else if (!isLeft && left <= scrollContainerRect.left + threshold.width) {\n    // Scroll Left\n    direction.x = Direction.Backward;\n    speed.x = acceleration * Math.abs((scrollContainerRect.left + threshold.width - left) / threshold.width);\n  }\n\n  return {\n    direction,\n    speed\n  };\n}\n\nfunction getScrollElementRect(element) {\n  if (element === document.scrollingElement) {\n    const {\n      innerWidth,\n      innerHeight\n    } = window;\n    return {\n      top: 0,\n      left: 0,\n      right: innerWidth,\n      bottom: innerHeight,\n      width: innerWidth,\n      height: innerHeight\n    };\n  }\n\n  const {\n    top,\n    left,\n    right,\n    bottom\n  } = element.getBoundingClientRect();\n  return {\n    top,\n    left,\n    right,\n    bottom,\n    width: element.clientWidth,\n    height: element.clientHeight\n  };\n}\n\nfunction getScrollOffsets(scrollableAncestors) {\n  return scrollableAncestors.reduce((acc, node) => {\n    return add(acc, getScrollCoordinates(node));\n  }, defaultCoordinates);\n}\nfunction getScrollXOffset(scrollableAncestors) {\n  return scrollableAncestors.reduce((acc, node) => {\n    return acc + getScrollXCoordinate(node);\n  }, 0);\n}\nfunction getScrollYOffset(scrollableAncestors) {\n  return scrollableAncestors.reduce((acc, node) => {\n    return acc + getScrollYCoordinate(node);\n  }, 0);\n}\n\nfunction scrollIntoViewIfNeeded(element, measure) {\n  if (measure === void 0) {\n    measure = getClientRect;\n  }\n\n  if (!element) {\n    return;\n  }\n\n  const {\n    top,\n    left,\n    bottom,\n    right\n  } = measure(element);\n  const firstScrollableAncestor = getFirstScrollableAncestor(element);\n\n  if (!firstScrollableAncestor) {\n    return;\n  }\n\n  if (bottom <= 0 || right <= 0 || top >= window.innerHeight || left >= window.innerWidth) {\n    element.scrollIntoView({\n      block: 'center',\n      inline: 'center'\n    });\n  }\n}\n\nconst properties = [['x', ['left', 'right'], getScrollXOffset], ['y', ['top', 'bottom'], getScrollYOffset]];\nclass Rect {\n  constructor(rect, element) {\n    this.rect = void 0;\n    this.width = void 0;\n    this.height = void 0;\n    this.top = void 0;\n    this.bottom = void 0;\n    this.right = void 0;\n    this.left = void 0;\n    const scrollableAncestors = getScrollableAncestors(element);\n    const scrollOffsets = getScrollOffsets(scrollableAncestors);\n    this.rect = { ...rect\n    };\n    this.width = rect.width;\n    this.height = rect.height;\n\n    for (const [axis, keys, getScrollOffset] of properties) {\n      for (const key of keys) {\n        Object.defineProperty(this, key, {\n          get: () => {\n            const currentOffsets = getScrollOffset(scrollableAncestors);\n            const scrollOffsetsDeltla = scrollOffsets[axis] - currentOffsets;\n            return this.rect[key] + scrollOffsetsDeltla;\n          },\n          enumerable: true\n        });\n      }\n    }\n\n    Object.defineProperty(this, 'rect', {\n      enumerable: false\n    });\n  }\n\n}\n\nclass Listeners {\n  constructor(target) {\n    this.target = void 0;\n    this.listeners = [];\n\n    this.removeAll = () => {\n      this.listeners.forEach(listener => {\n        var _this$target;\n\n        return (_this$target = this.target) == null ? void 0 : _this$target.removeEventListener(...listener);\n      });\n    };\n\n    this.target = target;\n  }\n\n  add(eventName, handler, options) {\n    var _this$target2;\n\n    (_this$target2 = this.target) == null ? void 0 : _this$target2.addEventListener(eventName, handler, options);\n    this.listeners.push([eventName, handler, options]);\n  }\n\n}\n\nfunction getEventListenerTarget(target) {\n  // If the `event.target` element is removed from the document events will still be targeted\n  // at it, and hence won't always bubble up to the window or document anymore.\n  // If there is any risk of an element being removed while it is being dragged,\n  // the best practice is to attach the event listeners directly to the target.\n  // https://developer.mozilla.org/en-US/docs/Web/API/EventTarget\n  const {\n    EventTarget\n  } = getWindow(target);\n  return target instanceof EventTarget ? target : getOwnerDocument(target);\n}\n\nfunction hasExceededDistance(delta, measurement) {\n  const dx = Math.abs(delta.x);\n  const dy = Math.abs(delta.y);\n\n  if (typeof measurement === 'number') {\n    return Math.sqrt(dx ** 2 + dy ** 2) > measurement;\n  }\n\n  if ('x' in measurement && 'y' in measurement) {\n    return dx > measurement.x && dy > measurement.y;\n  }\n\n  if ('x' in measurement) {\n    return dx > measurement.x;\n  }\n\n  if ('y' in measurement) {\n    return dy > measurement.y;\n  }\n\n  return false;\n}\n\nvar EventName;\n\n(function (EventName) {\n  EventName[\"Click\"] = \"click\";\n  EventName[\"DragStart\"] = \"dragstart\";\n  EventName[\"Keydown\"] = \"keydown\";\n  EventName[\"ContextMenu\"] = \"contextmenu\";\n  EventName[\"Resize\"] = \"resize\";\n  EventName[\"SelectionChange\"] = \"selectionchange\";\n  EventName[\"VisibilityChange\"] = \"visibilitychange\";\n})(EventName || (EventName = {}));\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\nfunction stopPropagation(event) {\n  event.stopPropagation();\n}\n\nvar KeyboardCode;\n\n(function (KeyboardCode) {\n  KeyboardCode[\"Space\"] = \"Space\";\n  KeyboardCode[\"Down\"] = \"ArrowDown\";\n  KeyboardCode[\"Right\"] = \"ArrowRight\";\n  KeyboardCode[\"Left\"] = \"ArrowLeft\";\n  KeyboardCode[\"Up\"] = \"ArrowUp\";\n  KeyboardCode[\"Esc\"] = \"Escape\";\n  KeyboardCode[\"Enter\"] = \"Enter\";\n  KeyboardCode[\"Tab\"] = \"Tab\";\n})(KeyboardCode || (KeyboardCode = {}));\n\nconst defaultKeyboardCodes = {\n  start: [KeyboardCode.Space, KeyboardCode.Enter],\n  cancel: [KeyboardCode.Esc],\n  end: [KeyboardCode.Space, KeyboardCode.Enter, KeyboardCode.Tab]\n};\nconst defaultKeyboardCoordinateGetter = (event, _ref) => {\n  let {\n    currentCoordinates\n  } = _ref;\n\n  switch (event.code) {\n    case KeyboardCode.Right:\n      return { ...currentCoordinates,\n        x: currentCoordinates.x + 25\n      };\n\n    case KeyboardCode.Left:\n      return { ...currentCoordinates,\n        x: currentCoordinates.x - 25\n      };\n\n    case KeyboardCode.Down:\n      return { ...currentCoordinates,\n        y: currentCoordinates.y + 25\n      };\n\n    case KeyboardCode.Up:\n      return { ...currentCoordinates,\n        y: currentCoordinates.y - 25\n      };\n  }\n\n  return undefined;\n};\n\nclass KeyboardSensor {\n  constructor(props) {\n    this.props = void 0;\n    this.autoScrollEnabled = false;\n    this.referenceCoordinates = void 0;\n    this.listeners = void 0;\n    this.windowListeners = void 0;\n    this.props = props;\n    const {\n      event: {\n        target\n      }\n    } = props;\n    this.props = props;\n    this.listeners = new Listeners(getOwnerDocument(target));\n    this.windowListeners = new Listeners(getWindow(target));\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.attach();\n  }\n\n  attach() {\n    this.handleStart();\n    this.windowListeners.add(EventName.Resize, this.handleCancel);\n    this.windowListeners.add(EventName.VisibilityChange, this.handleCancel);\n    setTimeout(() => this.listeners.add(EventName.Keydown, this.handleKeyDown));\n  }\n\n  handleStart() {\n    const {\n      activeNode,\n      onStart\n    } = this.props;\n    const node = activeNode.node.current;\n\n    if (node) {\n      scrollIntoViewIfNeeded(node);\n    }\n\n    onStart(defaultCoordinates);\n  }\n\n  handleKeyDown(event) {\n    if (isKeyboardEvent(event)) {\n      const {\n        active,\n        context,\n        options\n      } = this.props;\n      const {\n        keyboardCodes = defaultKeyboardCodes,\n        coordinateGetter = defaultKeyboardCoordinateGetter,\n        scrollBehavior = 'smooth'\n      } = options;\n      const {\n        code\n      } = event;\n\n      if (keyboardCodes.end.includes(code)) {\n        this.handleEnd(event);\n        return;\n      }\n\n      if (keyboardCodes.cancel.includes(code)) {\n        this.handleCancel(event);\n        return;\n      }\n\n      const {\n        collisionRect\n      } = context.current;\n      const currentCoordinates = collisionRect ? {\n        x: collisionRect.left,\n        y: collisionRect.top\n      } : defaultCoordinates;\n\n      if (!this.referenceCoordinates) {\n        this.referenceCoordinates = currentCoordinates;\n      }\n\n      const newCoordinates = coordinateGetter(event, {\n        active,\n        context: context.current,\n        currentCoordinates\n      });\n\n      if (newCoordinates) {\n        const coordinatesDelta = subtract(newCoordinates, currentCoordinates);\n        const scrollDelta = {\n          x: 0,\n          y: 0\n        };\n        const {\n          scrollableAncestors\n        } = context.current;\n\n        for (const scrollContainer of scrollableAncestors) {\n          const direction = event.code;\n          const {\n            isTop,\n            isRight,\n            isLeft,\n            isBottom,\n            maxScroll,\n            minScroll\n          } = getScrollPosition(scrollContainer);\n          const scrollElementRect = getScrollElementRect(scrollContainer);\n          const clampedCoordinates = {\n            x: Math.min(direction === KeyboardCode.Right ? scrollElementRect.right - scrollElementRect.width / 2 : scrollElementRect.right, Math.max(direction === KeyboardCode.Right ? scrollElementRect.left : scrollElementRect.left + scrollElementRect.width / 2, newCoordinates.x)),\n            y: Math.min(direction === KeyboardCode.Down ? scrollElementRect.bottom - scrollElementRect.height / 2 : scrollElementRect.bottom, Math.max(direction === KeyboardCode.Down ? scrollElementRect.top : scrollElementRect.top + scrollElementRect.height / 2, newCoordinates.y))\n          };\n          const canScrollX = direction === KeyboardCode.Right && !isRight || direction === KeyboardCode.Left && !isLeft;\n          const canScrollY = direction === KeyboardCode.Down && !isBottom || direction === KeyboardCode.Up && !isTop;\n\n          if (canScrollX && clampedCoordinates.x !== newCoordinates.x) {\n            const newScrollCoordinates = scrollContainer.scrollLeft + coordinatesDelta.x;\n            const canScrollToNewCoordinates = direction === KeyboardCode.Right && newScrollCoordinates <= maxScroll.x || direction === KeyboardCode.Left && newScrollCoordinates >= minScroll.x;\n\n            if (canScrollToNewCoordinates && !coordinatesDelta.y) {\n              // We don't need to update coordinates, the scroll adjustment alone will trigger\n              // logic to auto-detect the new container we are over\n              scrollContainer.scrollTo({\n                left: newScrollCoordinates,\n                behavior: scrollBehavior\n              });\n              return;\n            }\n\n            if (canScrollToNewCoordinates) {\n              scrollDelta.x = scrollContainer.scrollLeft - newScrollCoordinates;\n            } else {\n              scrollDelta.x = direction === KeyboardCode.Right ? scrollContainer.scrollLeft - maxScroll.x : scrollContainer.scrollLeft - minScroll.x;\n            }\n\n            if (scrollDelta.x) {\n              scrollContainer.scrollBy({\n                left: -scrollDelta.x,\n                behavior: scrollBehavior\n              });\n            }\n\n            break;\n          } else if (canScrollY && clampedCoordinates.y !== newCoordinates.y) {\n            const newScrollCoordinates = scrollContainer.scrollTop + coordinatesDelta.y;\n            const canScrollToNewCoordinates = direction === KeyboardCode.Down && newScrollCoordinates <= maxScroll.y || direction === KeyboardCode.Up && newScrollCoordinates >= minScroll.y;\n\n            if (canScrollToNewCoordinates && !coordinatesDelta.x) {\n              // We don't need to update coordinates, the scroll adjustment alone will trigger\n              // logic to auto-detect the new container we are over\n              scrollContainer.scrollTo({\n                top: newScrollCoordinates,\n                behavior: scrollBehavior\n              });\n              return;\n            }\n\n            if (canScrollToNewCoordinates) {\n              scrollDelta.y = scrollContainer.scrollTop - newScrollCoordinates;\n            } else {\n              scrollDelta.y = direction === KeyboardCode.Down ? scrollContainer.scrollTop - maxScroll.y : scrollContainer.scrollTop - minScroll.y;\n            }\n\n            if (scrollDelta.y) {\n              scrollContainer.scrollBy({\n                top: -scrollDelta.y,\n                behavior: scrollBehavior\n              });\n            }\n\n            break;\n          }\n        }\n\n        this.handleMove(event, add(subtract(newCoordinates, this.referenceCoordinates), scrollDelta));\n      }\n    }\n  }\n\n  handleMove(event, coordinates) {\n    const {\n      onMove\n    } = this.props;\n    event.preventDefault();\n    onMove(coordinates);\n  }\n\n  handleEnd(event) {\n    const {\n      onEnd\n    } = this.props;\n    event.preventDefault();\n    this.detach();\n    onEnd();\n  }\n\n  handleCancel(event) {\n    const {\n      onCancel\n    } = this.props;\n    event.preventDefault();\n    this.detach();\n    onCancel();\n  }\n\n  detach() {\n    this.listeners.removeAll();\n    this.windowListeners.removeAll();\n  }\n\n}\nKeyboardSensor.activators = [{\n  eventName: 'onKeyDown',\n  handler: (event, _ref, _ref2) => {\n    let {\n      keyboardCodes = defaultKeyboardCodes,\n      onActivation\n    } = _ref;\n    let {\n      active\n    } = _ref2;\n    const {\n      code\n    } = event.nativeEvent;\n\n    if (keyboardCodes.start.includes(code)) {\n      const activator = active.activatorNode.current;\n\n      if (activator && event.target !== activator) {\n        return false;\n      }\n\n      event.preventDefault();\n      onActivation == null ? void 0 : onActivation({\n        event: event.nativeEvent\n      });\n      return true;\n    }\n\n    return false;\n  }\n}];\n\nfunction isDistanceConstraint(constraint) {\n  return Boolean(constraint && 'distance' in constraint);\n}\n\nfunction isDelayConstraint(constraint) {\n  return Boolean(constraint && 'delay' in constraint);\n}\n\nclass AbstractPointerSensor {\n  constructor(props, events, listenerTarget) {\n    var _getEventCoordinates;\n\n    if (listenerTarget === void 0) {\n      listenerTarget = getEventListenerTarget(props.event.target);\n    }\n\n    this.props = void 0;\n    this.events = void 0;\n    this.autoScrollEnabled = true;\n    this.document = void 0;\n    this.activated = false;\n    this.initialCoordinates = void 0;\n    this.timeoutId = null;\n    this.listeners = void 0;\n    this.documentListeners = void 0;\n    this.windowListeners = void 0;\n    this.props = props;\n    this.events = events;\n    const {\n      event\n    } = props;\n    const {\n      target\n    } = event;\n    this.props = props;\n    this.events = events;\n    this.document = getOwnerDocument(target);\n    this.documentListeners = new Listeners(this.document);\n    this.listeners = new Listeners(listenerTarget);\n    this.windowListeners = new Listeners(getWindow(target));\n    this.initialCoordinates = (_getEventCoordinates = getEventCoordinates(event)) != null ? _getEventCoordinates : defaultCoordinates;\n    this.handleStart = this.handleStart.bind(this);\n    this.handleMove = this.handleMove.bind(this);\n    this.handleEnd = this.handleEnd.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleKeydown = this.handleKeydown.bind(this);\n    this.removeTextSelection = this.removeTextSelection.bind(this);\n    this.attach();\n  }\n\n  attach() {\n    const {\n      events,\n      props: {\n        options: {\n          activationConstraint,\n          bypassActivationConstraint\n        }\n      }\n    } = this;\n    this.listeners.add(events.move.name, this.handleMove, {\n      passive: false\n    });\n    this.listeners.add(events.end.name, this.handleEnd);\n\n    if (events.cancel) {\n      this.listeners.add(events.cancel.name, this.handleCancel);\n    }\n\n    this.windowListeners.add(EventName.Resize, this.handleCancel);\n    this.windowListeners.add(EventName.DragStart, preventDefault);\n    this.windowListeners.add(EventName.VisibilityChange, this.handleCancel);\n    this.windowListeners.add(EventName.ContextMenu, preventDefault);\n    this.documentListeners.add(EventName.Keydown, this.handleKeydown);\n\n    if (activationConstraint) {\n      if (bypassActivationConstraint != null && bypassActivationConstraint({\n        event: this.props.event,\n        activeNode: this.props.activeNode,\n        options: this.props.options\n      })) {\n        return this.handleStart();\n      }\n\n      if (isDelayConstraint(activationConstraint)) {\n        this.timeoutId = setTimeout(this.handleStart, activationConstraint.delay);\n        this.handlePending(activationConstraint);\n        return;\n      }\n\n      if (isDistanceConstraint(activationConstraint)) {\n        this.handlePending(activationConstraint);\n        return;\n      }\n    }\n\n    this.handleStart();\n  }\n\n  detach() {\n    this.listeners.removeAll();\n    this.windowListeners.removeAll(); // Wait until the next event loop before removing document listeners\n    // This is necessary because we listen for `click` and `selection` events on the document\n\n    setTimeout(this.documentListeners.removeAll, 50);\n\n    if (this.timeoutId !== null) {\n      clearTimeout(this.timeoutId);\n      this.timeoutId = null;\n    }\n  }\n\n  handlePending(constraint, offset) {\n    const {\n      active,\n      onPending\n    } = this.props;\n    onPending(active, constraint, this.initialCoordinates, offset);\n  }\n\n  handleStart() {\n    const {\n      initialCoordinates\n    } = this;\n    const {\n      onStart\n    } = this.props;\n\n    if (initialCoordinates) {\n      this.activated = true; // Stop propagation of click events once activation constraints are met\n\n      this.documentListeners.add(EventName.Click, stopPropagation, {\n        capture: true\n      }); // Remove any text selection from the document\n\n      this.removeTextSelection(); // Prevent further text selection while dragging\n\n      this.documentListeners.add(EventName.SelectionChange, this.removeTextSelection);\n      onStart(initialCoordinates);\n    }\n  }\n\n  handleMove(event) {\n    var _getEventCoordinates2;\n\n    const {\n      activated,\n      initialCoordinates,\n      props\n    } = this;\n    const {\n      onMove,\n      options: {\n        activationConstraint\n      }\n    } = props;\n\n    if (!initialCoordinates) {\n      return;\n    }\n\n    const coordinates = (_getEventCoordinates2 = getEventCoordinates(event)) != null ? _getEventCoordinates2 : defaultCoordinates;\n    const delta = subtract(initialCoordinates, coordinates); // Constraint validation\n\n    if (!activated && activationConstraint) {\n      if (isDistanceConstraint(activationConstraint)) {\n        if (activationConstraint.tolerance != null && hasExceededDistance(delta, activationConstraint.tolerance)) {\n          return this.handleCancel();\n        }\n\n        if (hasExceededDistance(delta, activationConstraint.distance)) {\n          return this.handleStart();\n        }\n      }\n\n      if (isDelayConstraint(activationConstraint)) {\n        if (hasExceededDistance(delta, activationConstraint.tolerance)) {\n          return this.handleCancel();\n        }\n      }\n\n      this.handlePending(activationConstraint, delta);\n      return;\n    }\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n\n    onMove(coordinates);\n  }\n\n  handleEnd() {\n    const {\n      onAbort,\n      onEnd\n    } = this.props;\n    this.detach();\n\n    if (!this.activated) {\n      onAbort(this.props.active);\n    }\n\n    onEnd();\n  }\n\n  handleCancel() {\n    const {\n      onAbort,\n      onCancel\n    } = this.props;\n    this.detach();\n\n    if (!this.activated) {\n      onAbort(this.props.active);\n    }\n\n    onCancel();\n  }\n\n  handleKeydown(event) {\n    if (event.code === KeyboardCode.Esc) {\n      this.handleCancel();\n    }\n  }\n\n  removeTextSelection() {\n    var _this$document$getSel;\n\n    (_this$document$getSel = this.document.getSelection()) == null ? void 0 : _this$document$getSel.removeAllRanges();\n  }\n\n}\n\nconst events = {\n  cancel: {\n    name: 'pointercancel'\n  },\n  move: {\n    name: 'pointermove'\n  },\n  end: {\n    name: 'pointerup'\n  }\n};\nclass PointerSensor extends AbstractPointerSensor {\n  constructor(props) {\n    const {\n      event\n    } = props; // Pointer events stop firing if the target is unmounted while dragging\n    // Therefore we attach listeners to the owner document instead\n\n    const listenerTarget = getOwnerDocument(event.target);\n    super(props, events, listenerTarget);\n  }\n\n}\nPointerSensor.activators = [{\n  eventName: 'onPointerDown',\n  handler: (_ref, _ref2) => {\n    let {\n      nativeEvent: event\n    } = _ref;\n    let {\n      onActivation\n    } = _ref2;\n\n    if (!event.isPrimary || event.button !== 0) {\n      return false;\n    }\n\n    onActivation == null ? void 0 : onActivation({\n      event\n    });\n    return true;\n  }\n}];\n\nconst events$1 = {\n  move: {\n    name: 'mousemove'\n  },\n  end: {\n    name: 'mouseup'\n  }\n};\nvar MouseButton;\n\n(function (MouseButton) {\n  MouseButton[MouseButton[\"RightClick\"] = 2] = \"RightClick\";\n})(MouseButton || (MouseButton = {}));\n\nclass MouseSensor extends AbstractPointerSensor {\n  constructor(props) {\n    super(props, events$1, getOwnerDocument(props.event.target));\n  }\n\n}\nMouseSensor.activators = [{\n  eventName: 'onMouseDown',\n  handler: (_ref, _ref2) => {\n    let {\n      nativeEvent: event\n    } = _ref;\n    let {\n      onActivation\n    } = _ref2;\n\n    if (event.button === MouseButton.RightClick) {\n      return false;\n    }\n\n    onActivation == null ? void 0 : onActivation({\n      event\n    });\n    return true;\n  }\n}];\n\nconst events$2 = {\n  cancel: {\n    name: 'touchcancel'\n  },\n  move: {\n    name: 'touchmove'\n  },\n  end: {\n    name: 'touchend'\n  }\n};\nclass TouchSensor extends AbstractPointerSensor {\n  constructor(props) {\n    super(props, events$2);\n  }\n\n  static setup() {\n    // Adding a non-capture and non-passive `touchmove` listener in order\n    // to force `event.preventDefault()` calls to work in dynamically added\n    // touchmove event handlers. This is required for iOS Safari.\n    window.addEventListener(events$2.move.name, noop, {\n      capture: false,\n      passive: false\n    });\n    return function teardown() {\n      window.removeEventListener(events$2.move.name, noop);\n    }; // We create a new handler because the teardown function of another sensor\n    // could remove our event listener if we use a referentially equal listener.\n\n    function noop() {}\n  }\n\n}\nTouchSensor.activators = [{\n  eventName: 'onTouchStart',\n  handler: (_ref, _ref2) => {\n    let {\n      nativeEvent: event\n    } = _ref;\n    let {\n      onActivation\n    } = _ref2;\n    const {\n      touches\n    } = event;\n\n    if (touches.length > 1) {\n      return false;\n    }\n\n    onActivation == null ? void 0 : onActivation({\n      event\n    });\n    return true;\n  }\n}];\n\nvar AutoScrollActivator;\n\n(function (AutoScrollActivator) {\n  AutoScrollActivator[AutoScrollActivator[\"Pointer\"] = 0] = \"Pointer\";\n  AutoScrollActivator[AutoScrollActivator[\"DraggableRect\"] = 1] = \"DraggableRect\";\n})(AutoScrollActivator || (AutoScrollActivator = {}));\n\nvar TraversalOrder;\n\n(function (TraversalOrder) {\n  TraversalOrder[TraversalOrder[\"TreeOrder\"] = 0] = \"TreeOrder\";\n  TraversalOrder[TraversalOrder[\"ReversedTreeOrder\"] = 1] = \"ReversedTreeOrder\";\n})(TraversalOrder || (TraversalOrder = {}));\n\nfunction useAutoScroller(_ref) {\n  let {\n    acceleration,\n    activator = AutoScrollActivator.Pointer,\n    canScroll,\n    draggingRect,\n    enabled,\n    interval = 5,\n    order = TraversalOrder.TreeOrder,\n    pointerCoordinates,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    delta,\n    threshold\n  } = _ref;\n  const scrollIntent = useScrollIntent({\n    delta,\n    disabled: !enabled\n  });\n  const [setAutoScrollInterval, clearAutoScrollInterval] = useInterval();\n  const scrollSpeed = useRef({\n    x: 0,\n    y: 0\n  });\n  const scrollDirection = useRef({\n    x: 0,\n    y: 0\n  });\n  const rect = useMemo(() => {\n    switch (activator) {\n      case AutoScrollActivator.Pointer:\n        return pointerCoordinates ? {\n          top: pointerCoordinates.y,\n          bottom: pointerCoordinates.y,\n          left: pointerCoordinates.x,\n          right: pointerCoordinates.x\n        } : null;\n\n      case AutoScrollActivator.DraggableRect:\n        return draggingRect;\n    }\n  }, [activator, draggingRect, pointerCoordinates]);\n  const scrollContainerRef = useRef(null);\n  const autoScroll = useCallback(() => {\n    const scrollContainer = scrollContainerRef.current;\n\n    if (!scrollContainer) {\n      return;\n    }\n\n    const scrollLeft = scrollSpeed.current.x * scrollDirection.current.x;\n    const scrollTop = scrollSpeed.current.y * scrollDirection.current.y;\n    scrollContainer.scrollBy(scrollLeft, scrollTop);\n  }, []);\n  const sortedScrollableAncestors = useMemo(() => order === TraversalOrder.TreeOrder ? [...scrollableAncestors].reverse() : scrollableAncestors, [order, scrollableAncestors]);\n  useEffect(() => {\n    if (!enabled || !scrollableAncestors.length || !rect) {\n      clearAutoScrollInterval();\n      return;\n    }\n\n    for (const scrollContainer of sortedScrollableAncestors) {\n      if ((canScroll == null ? void 0 : canScroll(scrollContainer)) === false) {\n        continue;\n      }\n\n      const index = scrollableAncestors.indexOf(scrollContainer);\n      const scrollContainerRect = scrollableAncestorRects[index];\n\n      if (!scrollContainerRect) {\n        continue;\n      }\n\n      const {\n        direction,\n        speed\n      } = getScrollDirectionAndSpeed(scrollContainer, scrollContainerRect, rect, acceleration, threshold);\n\n      for (const axis of ['x', 'y']) {\n        if (!scrollIntent[axis][direction[axis]]) {\n          speed[axis] = 0;\n          direction[axis] = 0;\n        }\n      }\n\n      if (speed.x > 0 || speed.y > 0) {\n        clearAutoScrollInterval();\n        scrollContainerRef.current = scrollContainer;\n        setAutoScrollInterval(autoScroll, interval);\n        scrollSpeed.current = speed;\n        scrollDirection.current = direction;\n        return;\n      }\n    }\n\n    scrollSpeed.current = {\n      x: 0,\n      y: 0\n    };\n    scrollDirection.current = {\n      x: 0,\n      y: 0\n    };\n    clearAutoScrollInterval();\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [acceleration, autoScroll, canScroll, clearAutoScrollInterval, enabled, interval, // eslint-disable-next-line react-hooks/exhaustive-deps\n  JSON.stringify(rect), // eslint-disable-next-line react-hooks/exhaustive-deps\n  JSON.stringify(scrollIntent), setAutoScrollInterval, scrollableAncestors, sortedScrollableAncestors, scrollableAncestorRects, // eslint-disable-next-line react-hooks/exhaustive-deps\n  JSON.stringify(threshold)]);\n}\nconst defaultScrollIntent = {\n  x: {\n    [Direction.Backward]: false,\n    [Direction.Forward]: false\n  },\n  y: {\n    [Direction.Backward]: false,\n    [Direction.Forward]: false\n  }\n};\n\nfunction useScrollIntent(_ref2) {\n  let {\n    delta,\n    disabled\n  } = _ref2;\n  const previousDelta = usePrevious(delta);\n  return useLazyMemo(previousIntent => {\n    if (disabled || !previousDelta || !previousIntent) {\n      // Reset scroll intent tracking when auto-scrolling is disabled\n      return defaultScrollIntent;\n    }\n\n    const direction = {\n      x: Math.sign(delta.x - previousDelta.x),\n      y: Math.sign(delta.y - previousDelta.y)\n    }; // Keep track of the user intent to scroll in each direction for both axis\n\n    return {\n      x: {\n        [Direction.Backward]: previousIntent.x[Direction.Backward] || direction.x === -1,\n        [Direction.Forward]: previousIntent.x[Direction.Forward] || direction.x === 1\n      },\n      y: {\n        [Direction.Backward]: previousIntent.y[Direction.Backward] || direction.y === -1,\n        [Direction.Forward]: previousIntent.y[Direction.Forward] || direction.y === 1\n      }\n    };\n  }, [disabled, delta, previousDelta]);\n}\n\nfunction useCachedNode(draggableNodes, id) {\n  const draggableNode = id != null ? draggableNodes.get(id) : undefined;\n  const node = draggableNode ? draggableNode.node.current : null;\n  return useLazyMemo(cachedNode => {\n    var _ref;\n\n    if (id == null) {\n      return null;\n    } // In some cases, the draggable node can unmount while dragging\n    // This is the case for virtualized lists. In those situations,\n    // we fall back to the last known value for that node.\n\n\n    return (_ref = node != null ? node : cachedNode) != null ? _ref : null;\n  }, [node, id]);\n}\n\nfunction useCombineActivators(sensors, getSyntheticHandler) {\n  return useMemo(() => sensors.reduce((accumulator, sensor) => {\n    const {\n      sensor: Sensor\n    } = sensor;\n    const sensorActivators = Sensor.activators.map(activator => ({\n      eventName: activator.eventName,\n      handler: getSyntheticHandler(activator.handler, sensor)\n    }));\n    return [...accumulator, ...sensorActivators];\n  }, []), [sensors, getSyntheticHandler]);\n}\n\nvar MeasuringStrategy;\n\n(function (MeasuringStrategy) {\n  MeasuringStrategy[MeasuringStrategy[\"Always\"] = 0] = \"Always\";\n  MeasuringStrategy[MeasuringStrategy[\"BeforeDragging\"] = 1] = \"BeforeDragging\";\n  MeasuringStrategy[MeasuringStrategy[\"WhileDragging\"] = 2] = \"WhileDragging\";\n})(MeasuringStrategy || (MeasuringStrategy = {}));\n\nvar MeasuringFrequency;\n\n(function (MeasuringFrequency) {\n  MeasuringFrequency[\"Optimized\"] = \"optimized\";\n})(MeasuringFrequency || (MeasuringFrequency = {}));\n\nconst defaultValue = /*#__PURE__*/new Map();\nfunction useDroppableMeasuring(containers, _ref) {\n  let {\n    dragging,\n    dependencies,\n    config\n  } = _ref;\n  const [queue, setQueue] = useState(null);\n  const {\n    frequency,\n    measure,\n    strategy\n  } = config;\n  const containersRef = useRef(containers);\n  const disabled = isDisabled();\n  const disabledRef = useLatestValue(disabled);\n  const measureDroppableContainers = useCallback(function (ids) {\n    if (ids === void 0) {\n      ids = [];\n    }\n\n    if (disabledRef.current) {\n      return;\n    }\n\n    setQueue(value => {\n      if (value === null) {\n        return ids;\n      }\n\n      return value.concat(ids.filter(id => !value.includes(id)));\n    });\n  }, [disabledRef]);\n  const timeoutId = useRef(null);\n  const droppableRects = useLazyMemo(previousValue => {\n    if (disabled && !dragging) {\n      return defaultValue;\n    }\n\n    if (!previousValue || previousValue === defaultValue || containersRef.current !== containers || queue != null) {\n      const map = new Map();\n\n      for (let container of containers) {\n        if (!container) {\n          continue;\n        }\n\n        if (queue && queue.length > 0 && !queue.includes(container.id) && container.rect.current) {\n          // This container does not need to be re-measured\n          map.set(container.id, container.rect.current);\n          continue;\n        }\n\n        const node = container.node.current;\n        const rect = node ? new Rect(measure(node), node) : null;\n        container.rect.current = rect;\n\n        if (rect) {\n          map.set(container.id, rect);\n        }\n      }\n\n      return map;\n    }\n\n    return previousValue;\n  }, [containers, queue, dragging, disabled, measure]);\n  useEffect(() => {\n    containersRef.current = containers;\n  }, [containers]);\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n\n    measureDroppableContainers();\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [dragging, disabled]);\n  useEffect(() => {\n    if (queue && queue.length > 0) {\n      setQueue(null);\n    }\n  }, //eslint-disable-next-line react-hooks/exhaustive-deps\n  [JSON.stringify(queue)]);\n  useEffect(() => {\n    if (disabled || typeof frequency !== 'number' || timeoutId.current !== null) {\n      return;\n    }\n\n    timeoutId.current = setTimeout(() => {\n      measureDroppableContainers();\n      timeoutId.current = null;\n    }, frequency);\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [frequency, disabled, measureDroppableContainers, ...dependencies]);\n  return {\n    droppableRects,\n    measureDroppableContainers,\n    measuringScheduled: queue != null\n  };\n\n  function isDisabled() {\n    switch (strategy) {\n      case MeasuringStrategy.Always:\n        return false;\n\n      case MeasuringStrategy.BeforeDragging:\n        return dragging;\n\n      default:\n        return !dragging;\n    }\n  }\n}\n\nfunction useInitialValue(value, computeFn) {\n  return useLazyMemo(previousValue => {\n    if (!value) {\n      return null;\n    }\n\n    if (previousValue) {\n      return previousValue;\n    }\n\n    return typeof computeFn === 'function' ? computeFn(value) : value;\n  }, [computeFn, value]);\n}\n\nfunction useInitialRect(node, measure) {\n  return useInitialValue(node, measure);\n}\n\n/**\r\n * Returns a new MutationObserver instance.\r\n * If `MutationObserver` is undefined in the execution environment, returns `undefined`.\r\n */\n\nfunction useMutationObserver(_ref) {\n  let {\n    callback,\n    disabled\n  } = _ref;\n  const handleMutations = useEvent(callback);\n  const mutationObserver = useMemo(() => {\n    if (disabled || typeof window === 'undefined' || typeof window.MutationObserver === 'undefined') {\n      return undefined;\n    }\n\n    const {\n      MutationObserver\n    } = window;\n    return new MutationObserver(handleMutations);\n  }, [handleMutations, disabled]);\n  useEffect(() => {\n    return () => mutationObserver == null ? void 0 : mutationObserver.disconnect();\n  }, [mutationObserver]);\n  return mutationObserver;\n}\n\n/**\r\n * Returns a new ResizeObserver instance bound to the `onResize` callback.\r\n * If `ResizeObserver` is undefined in the execution environment, returns `undefined`.\r\n */\n\nfunction useResizeObserver(_ref) {\n  let {\n    callback,\n    disabled\n  } = _ref;\n  const handleResize = useEvent(callback);\n  const resizeObserver = useMemo(() => {\n    if (disabled || typeof window === 'undefined' || typeof window.ResizeObserver === 'undefined') {\n      return undefined;\n    }\n\n    const {\n      ResizeObserver\n    } = window;\n    return new ResizeObserver(handleResize);\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [disabled]);\n  useEffect(() => {\n    return () => resizeObserver == null ? void 0 : resizeObserver.disconnect();\n  }, [resizeObserver]);\n  return resizeObserver;\n}\n\nfunction defaultMeasure(element) {\n  return new Rect(getClientRect(element), element);\n}\n\nfunction useRect(element, measure, fallbackRect) {\n  if (measure === void 0) {\n    measure = defaultMeasure;\n  }\n\n  const [rect, setRect] = useState(null);\n\n  function measureRect() {\n    setRect(currentRect => {\n      if (!element) {\n        return null;\n      }\n\n      if (element.isConnected === false) {\n        var _ref;\n\n        // Fall back to last rect we measured if the element is\n        // no longer connected to the DOM.\n        return (_ref = currentRect != null ? currentRect : fallbackRect) != null ? _ref : null;\n      }\n\n      const newRect = measure(element);\n\n      if (JSON.stringify(currentRect) === JSON.stringify(newRect)) {\n        return currentRect;\n      }\n\n      return newRect;\n    });\n  }\n\n  const mutationObserver = useMutationObserver({\n    callback(records) {\n      if (!element) {\n        return;\n      }\n\n      for (const record of records) {\n        const {\n          type,\n          target\n        } = record;\n\n        if (type === 'childList' && target instanceof HTMLElement && target.contains(element)) {\n          measureRect();\n          break;\n        }\n      }\n    }\n\n  });\n  const resizeObserver = useResizeObserver({\n    callback: measureRect\n  });\n  useIsomorphicLayoutEffect(() => {\n    measureRect();\n\n    if (element) {\n      resizeObserver == null ? void 0 : resizeObserver.observe(element);\n      mutationObserver == null ? void 0 : mutationObserver.observe(document.body, {\n        childList: true,\n        subtree: true\n      });\n    } else {\n      resizeObserver == null ? void 0 : resizeObserver.disconnect();\n      mutationObserver == null ? void 0 : mutationObserver.disconnect();\n    }\n  }, [element]);\n  return rect;\n}\n\nfunction useRectDelta(rect) {\n  const initialRect = useInitialValue(rect);\n  return getRectDelta(rect, initialRect);\n}\n\nconst defaultValue$1 = [];\nfunction useScrollableAncestors(node) {\n  const previousNode = useRef(node);\n  const ancestors = useLazyMemo(previousValue => {\n    if (!node) {\n      return defaultValue$1;\n    }\n\n    if (previousValue && previousValue !== defaultValue$1 && node && previousNode.current && node.parentNode === previousNode.current.parentNode) {\n      return previousValue;\n    }\n\n    return getScrollableAncestors(node);\n  }, [node]);\n  useEffect(() => {\n    previousNode.current = node;\n  }, [node]);\n  return ancestors;\n}\n\nfunction useScrollOffsets(elements) {\n  const [scrollCoordinates, setScrollCoordinates] = useState(null);\n  const prevElements = useRef(elements); // To-do: Throttle the handleScroll callback\n\n  const handleScroll = useCallback(event => {\n    const scrollingElement = getScrollableElement(event.target);\n\n    if (!scrollingElement) {\n      return;\n    }\n\n    setScrollCoordinates(scrollCoordinates => {\n      if (!scrollCoordinates) {\n        return null;\n      }\n\n      scrollCoordinates.set(scrollingElement, getScrollCoordinates(scrollingElement));\n      return new Map(scrollCoordinates);\n    });\n  }, []);\n  useEffect(() => {\n    const previousElements = prevElements.current;\n\n    if (elements !== previousElements) {\n      cleanup(previousElements);\n      const entries = elements.map(element => {\n        const scrollableElement = getScrollableElement(element);\n\n        if (scrollableElement) {\n          scrollableElement.addEventListener('scroll', handleScroll, {\n            passive: true\n          });\n          return [scrollableElement, getScrollCoordinates(scrollableElement)];\n        }\n\n        return null;\n      }).filter(entry => entry != null);\n      setScrollCoordinates(entries.length ? new Map(entries) : null);\n      prevElements.current = elements;\n    }\n\n    return () => {\n      cleanup(elements);\n      cleanup(previousElements);\n    };\n\n    function cleanup(elements) {\n      elements.forEach(element => {\n        const scrollableElement = getScrollableElement(element);\n        scrollableElement == null ? void 0 : scrollableElement.removeEventListener('scroll', handleScroll);\n      });\n    }\n  }, [handleScroll, elements]);\n  return useMemo(() => {\n    if (elements.length) {\n      return scrollCoordinates ? Array.from(scrollCoordinates.values()).reduce((acc, coordinates) => add(acc, coordinates), defaultCoordinates) : getScrollOffsets(elements);\n    }\n\n    return defaultCoordinates;\n  }, [elements, scrollCoordinates]);\n}\n\nfunction useScrollOffsetsDelta(scrollOffsets, dependencies) {\n  if (dependencies === void 0) {\n    dependencies = [];\n  }\n\n  const initialScrollOffsets = useRef(null);\n  useEffect(() => {\n    initialScrollOffsets.current = null;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  dependencies);\n  useEffect(() => {\n    const hasScrollOffsets = scrollOffsets !== defaultCoordinates;\n\n    if (hasScrollOffsets && !initialScrollOffsets.current) {\n      initialScrollOffsets.current = scrollOffsets;\n    }\n\n    if (!hasScrollOffsets && initialScrollOffsets.current) {\n      initialScrollOffsets.current = null;\n    }\n  }, [scrollOffsets]);\n  return initialScrollOffsets.current ? subtract(scrollOffsets, initialScrollOffsets.current) : defaultCoordinates;\n}\n\nfunction useSensorSetup(sensors) {\n  useEffect(() => {\n    if (!canUseDOM) {\n      return;\n    }\n\n    const teardownFns = sensors.map(_ref => {\n      let {\n        sensor\n      } = _ref;\n      return sensor.setup == null ? void 0 : sensor.setup();\n    });\n    return () => {\n      for (const teardown of teardownFns) {\n        teardown == null ? void 0 : teardown();\n      }\n    };\n  }, // TO-DO: Sensors length could theoretically change which would not be a valid dependency\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  sensors.map(_ref2 => {\n    let {\n      sensor\n    } = _ref2;\n    return sensor;\n  }));\n}\n\nfunction useSyntheticListeners(listeners, id) {\n  return useMemo(() => {\n    return listeners.reduce((acc, _ref) => {\n      let {\n        eventName,\n        handler\n      } = _ref;\n\n      acc[eventName] = event => {\n        handler(event, id);\n      };\n\n      return acc;\n    }, {});\n  }, [listeners, id]);\n}\n\nfunction useWindowRect(element) {\n  return useMemo(() => element ? getWindowClientRect(element) : null, [element]);\n}\n\nconst defaultValue$2 = [];\nfunction useRects(elements, measure) {\n  if (measure === void 0) {\n    measure = getClientRect;\n  }\n\n  const [firstElement] = elements;\n  const windowRect = useWindowRect(firstElement ? getWindow(firstElement) : null);\n  const [rects, setRects] = useState(defaultValue$2);\n\n  function measureRects() {\n    setRects(() => {\n      if (!elements.length) {\n        return defaultValue$2;\n      }\n\n      return elements.map(element => isDocumentScrollingElement(element) ? windowRect : new Rect(measure(element), element));\n    });\n  }\n\n  const resizeObserver = useResizeObserver({\n    callback: measureRects\n  });\n  useIsomorphicLayoutEffect(() => {\n    resizeObserver == null ? void 0 : resizeObserver.disconnect();\n    measureRects();\n    elements.forEach(element => resizeObserver == null ? void 0 : resizeObserver.observe(element));\n  }, [elements]);\n  return rects;\n}\n\nfunction getMeasurableNode(node) {\n  if (!node) {\n    return null;\n  }\n\n  if (node.children.length > 1) {\n    return node;\n  }\n\n  const firstChild = node.children[0];\n  return isHTMLElement(firstChild) ? firstChild : node;\n}\n\nfunction useDragOverlayMeasuring(_ref) {\n  let {\n    measure\n  } = _ref;\n  const [rect, setRect] = useState(null);\n  const handleResize = useCallback(entries => {\n    for (const {\n      target\n    } of entries) {\n      if (isHTMLElement(target)) {\n        setRect(rect => {\n          const newRect = measure(target);\n          return rect ? { ...rect,\n            width: newRect.width,\n            height: newRect.height\n          } : newRect;\n        });\n        break;\n      }\n    }\n  }, [measure]);\n  const resizeObserver = useResizeObserver({\n    callback: handleResize\n  });\n  const handleNodeChange = useCallback(element => {\n    const node = getMeasurableNode(element);\n    resizeObserver == null ? void 0 : resizeObserver.disconnect();\n\n    if (node) {\n      resizeObserver == null ? void 0 : resizeObserver.observe(node);\n    }\n\n    setRect(node ? measure(node) : null);\n  }, [measure, resizeObserver]);\n  const [nodeRef, setRef] = useNodeRef(handleNodeChange);\n  return useMemo(() => ({\n    nodeRef,\n    rect,\n    setRef\n  }), [rect, nodeRef, setRef]);\n}\n\nconst defaultSensors = [{\n  sensor: PointerSensor,\n  options: {}\n}, {\n  sensor: KeyboardSensor,\n  options: {}\n}];\nconst defaultData = {\n  current: {}\n};\nconst defaultMeasuringConfiguration = {\n  draggable: {\n    measure: getTransformAgnosticClientRect\n  },\n  droppable: {\n    measure: getTransformAgnosticClientRect,\n    strategy: MeasuringStrategy.WhileDragging,\n    frequency: MeasuringFrequency.Optimized\n  },\n  dragOverlay: {\n    measure: getClientRect\n  }\n};\n\nclass DroppableContainersMap extends Map {\n  get(id) {\n    var _super$get;\n\n    return id != null ? (_super$get = super.get(id)) != null ? _super$get : undefined : undefined;\n  }\n\n  toArray() {\n    return Array.from(this.values());\n  }\n\n  getEnabled() {\n    return this.toArray().filter(_ref => {\n      let {\n        disabled\n      } = _ref;\n      return !disabled;\n    });\n  }\n\n  getNodeFor(id) {\n    var _this$get$node$curren, _this$get;\n\n    return (_this$get$node$curren = (_this$get = this.get(id)) == null ? void 0 : _this$get.node.current) != null ? _this$get$node$curren : undefined;\n  }\n\n}\n\nconst defaultPublicContext = {\n  activatorEvent: null,\n  active: null,\n  activeNode: null,\n  activeNodeRect: null,\n  collisions: null,\n  containerNodeRect: null,\n  draggableNodes: /*#__PURE__*/new Map(),\n  droppableRects: /*#__PURE__*/new Map(),\n  droppableContainers: /*#__PURE__*/new DroppableContainersMap(),\n  over: null,\n  dragOverlay: {\n    nodeRef: {\n      current: null\n    },\n    rect: null,\n    setRef: noop\n  },\n  scrollableAncestors: [],\n  scrollableAncestorRects: [],\n  measuringConfiguration: defaultMeasuringConfiguration,\n  measureDroppableContainers: noop,\n  windowRect: null,\n  measuringScheduled: false\n};\nconst defaultInternalContext = {\n  activatorEvent: null,\n  activators: [],\n  active: null,\n  activeNodeRect: null,\n  ariaDescribedById: {\n    draggable: ''\n  },\n  dispatch: noop,\n  draggableNodes: /*#__PURE__*/new Map(),\n  over: null,\n  measureDroppableContainers: noop\n};\nconst InternalContext = /*#__PURE__*/createContext(defaultInternalContext);\nconst PublicContext = /*#__PURE__*/createContext(defaultPublicContext);\n\nfunction getInitialState() {\n  return {\n    draggable: {\n      active: null,\n      initialCoordinates: {\n        x: 0,\n        y: 0\n      },\n      nodes: new Map(),\n      translate: {\n        x: 0,\n        y: 0\n      }\n    },\n    droppable: {\n      containers: new DroppableContainersMap()\n    }\n  };\n}\nfunction reducer(state, action) {\n  switch (action.type) {\n    case Action.DragStart:\n      return { ...state,\n        draggable: { ...state.draggable,\n          initialCoordinates: action.initialCoordinates,\n          active: action.active\n        }\n      };\n\n    case Action.DragMove:\n      if (state.draggable.active == null) {\n        return state;\n      }\n\n      return { ...state,\n        draggable: { ...state.draggable,\n          translate: {\n            x: action.coordinates.x - state.draggable.initialCoordinates.x,\n            y: action.coordinates.y - state.draggable.initialCoordinates.y\n          }\n        }\n      };\n\n    case Action.DragEnd:\n    case Action.DragCancel:\n      return { ...state,\n        draggable: { ...state.draggable,\n          active: null,\n          initialCoordinates: {\n            x: 0,\n            y: 0\n          },\n          translate: {\n            x: 0,\n            y: 0\n          }\n        }\n      };\n\n    case Action.RegisterDroppable:\n      {\n        const {\n          element\n        } = action;\n        const {\n          id\n        } = element;\n        const containers = new DroppableContainersMap(state.droppable.containers);\n        containers.set(id, element);\n        return { ...state,\n          droppable: { ...state.droppable,\n            containers\n          }\n        };\n      }\n\n    case Action.SetDroppableDisabled:\n      {\n        const {\n          id,\n          key,\n          disabled\n        } = action;\n        const element = state.droppable.containers.get(id);\n\n        if (!element || key !== element.key) {\n          return state;\n        }\n\n        const containers = new DroppableContainersMap(state.droppable.containers);\n        containers.set(id, { ...element,\n          disabled\n        });\n        return { ...state,\n          droppable: { ...state.droppable,\n            containers\n          }\n        };\n      }\n\n    case Action.UnregisterDroppable:\n      {\n        const {\n          id,\n          key\n        } = action;\n        const element = state.droppable.containers.get(id);\n\n        if (!element || key !== element.key) {\n          return state;\n        }\n\n        const containers = new DroppableContainersMap(state.droppable.containers);\n        containers.delete(id);\n        return { ...state,\n          droppable: { ...state.droppable,\n            containers\n          }\n        };\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n}\n\nfunction RestoreFocus(_ref) {\n  let {\n    disabled\n  } = _ref;\n  const {\n    active,\n    activatorEvent,\n    draggableNodes\n  } = useContext(InternalContext);\n  const previousActivatorEvent = usePrevious(activatorEvent);\n  const previousActiveId = usePrevious(active == null ? void 0 : active.id); // Restore keyboard focus on the activator node\n\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n\n    if (!activatorEvent && previousActivatorEvent && previousActiveId != null) {\n      if (!isKeyboardEvent(previousActivatorEvent)) {\n        return;\n      }\n\n      if (document.activeElement === previousActivatorEvent.target) {\n        // No need to restore focus\n        return;\n      }\n\n      const draggableNode = draggableNodes.get(previousActiveId);\n\n      if (!draggableNode) {\n        return;\n      }\n\n      const {\n        activatorNode,\n        node\n      } = draggableNode;\n\n      if (!activatorNode.current && !node.current) {\n        return;\n      }\n\n      requestAnimationFrame(() => {\n        for (const element of [activatorNode.current, node.current]) {\n          if (!element) {\n            continue;\n          }\n\n          const focusableNode = findFirstFocusableNode(element);\n\n          if (focusableNode) {\n            focusableNode.focus();\n            break;\n          }\n        }\n      });\n    }\n  }, [activatorEvent, disabled, draggableNodes, previousActiveId, previousActivatorEvent]);\n  return null;\n}\n\nfunction applyModifiers(modifiers, _ref) {\n  let {\n    transform,\n    ...args\n  } = _ref;\n  return modifiers != null && modifiers.length ? modifiers.reduce((accumulator, modifier) => {\n    return modifier({\n      transform: accumulator,\n      ...args\n    });\n  }, transform) : transform;\n}\n\nfunction useMeasuringConfiguration(config) {\n  return useMemo(() => ({\n    draggable: { ...defaultMeasuringConfiguration.draggable,\n      ...(config == null ? void 0 : config.draggable)\n    },\n    droppable: { ...defaultMeasuringConfiguration.droppable,\n      ...(config == null ? void 0 : config.droppable)\n    },\n    dragOverlay: { ...defaultMeasuringConfiguration.dragOverlay,\n      ...(config == null ? void 0 : config.dragOverlay)\n    }\n  }), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [config == null ? void 0 : config.draggable, config == null ? void 0 : config.droppable, config == null ? void 0 : config.dragOverlay]);\n}\n\nfunction useLayoutShiftScrollCompensation(_ref) {\n  let {\n    activeNode,\n    measure,\n    initialRect,\n    config = true\n  } = _ref;\n  const initialized = useRef(false);\n  const {\n    x,\n    y\n  } = typeof config === 'boolean' ? {\n    x: config,\n    y: config\n  } : config;\n  useIsomorphicLayoutEffect(() => {\n    const disabled = !x && !y;\n\n    if (disabled || !activeNode) {\n      initialized.current = false;\n      return;\n    }\n\n    if (initialized.current || !initialRect) {\n      // Return early if layout shift scroll compensation was already attempted\n      // or if there is no initialRect to compare to.\n      return;\n    } // Get the most up to date node ref for the active draggable\n\n\n    const node = activeNode == null ? void 0 : activeNode.node.current;\n\n    if (!node || node.isConnected === false) {\n      // Return early if there is no attached node ref or if the node is\n      // disconnected from the document.\n      return;\n    }\n\n    const rect = measure(node);\n    const rectDelta = getRectDelta(rect, initialRect);\n\n    if (!x) {\n      rectDelta.x = 0;\n    }\n\n    if (!y) {\n      rectDelta.y = 0;\n    } // Only perform layout shift scroll compensation once\n\n\n    initialized.current = true;\n\n    if (Math.abs(rectDelta.x) > 0 || Math.abs(rectDelta.y) > 0) {\n      const firstScrollableAncestor = getFirstScrollableAncestor(node);\n\n      if (firstScrollableAncestor) {\n        firstScrollableAncestor.scrollBy({\n          top: rectDelta.y,\n          left: rectDelta.x\n        });\n      }\n    }\n  }, [activeNode, x, y, initialRect, measure]);\n}\n\nconst ActiveDraggableContext = /*#__PURE__*/createContext({ ...defaultCoordinates,\n  scaleX: 1,\n  scaleY: 1\n});\nvar Status;\n\n(function (Status) {\n  Status[Status[\"Uninitialized\"] = 0] = \"Uninitialized\";\n  Status[Status[\"Initializing\"] = 1] = \"Initializing\";\n  Status[Status[\"Initialized\"] = 2] = \"Initialized\";\n})(Status || (Status = {}));\n\nconst DndContext = /*#__PURE__*/memo(function DndContext(_ref) {\n  var _sensorContext$curren, _dragOverlay$nodeRef$, _dragOverlay$rect, _over$rect;\n\n  let {\n    id,\n    accessibility,\n    autoScroll = true,\n    children,\n    sensors = defaultSensors,\n    collisionDetection = rectIntersection,\n    measuring,\n    modifiers,\n    ...props\n  } = _ref;\n  const store = useReducer(reducer, undefined, getInitialState);\n  const [state, dispatch] = store;\n  const [dispatchMonitorEvent, registerMonitorListener] = useDndMonitorProvider();\n  const [status, setStatus] = useState(Status.Uninitialized);\n  const isInitialized = status === Status.Initialized;\n  const {\n    draggable: {\n      active: activeId,\n      nodes: draggableNodes,\n      translate\n    },\n    droppable: {\n      containers: droppableContainers\n    }\n  } = state;\n  const node = activeId != null ? draggableNodes.get(activeId) : null;\n  const activeRects = useRef({\n    initial: null,\n    translated: null\n  });\n  const active = useMemo(() => {\n    var _node$data;\n\n    return activeId != null ? {\n      id: activeId,\n      // It's possible for the active node to unmount while dragging\n      data: (_node$data = node == null ? void 0 : node.data) != null ? _node$data : defaultData,\n      rect: activeRects\n    } : null;\n  }, [activeId, node]);\n  const activeRef = useRef(null);\n  const [activeSensor, setActiveSensor] = useState(null);\n  const [activatorEvent, setActivatorEvent] = useState(null);\n  const latestProps = useLatestValue(props, Object.values(props));\n  const draggableDescribedById = useUniqueId(\"DndDescribedBy\", id);\n  const enabledDroppableContainers = useMemo(() => droppableContainers.getEnabled(), [droppableContainers]);\n  const measuringConfiguration = useMeasuringConfiguration(measuring);\n  const {\n    droppableRects,\n    measureDroppableContainers,\n    measuringScheduled\n  } = useDroppableMeasuring(enabledDroppableContainers, {\n    dragging: isInitialized,\n    dependencies: [translate.x, translate.y],\n    config: measuringConfiguration.droppable\n  });\n  const activeNode = useCachedNode(draggableNodes, activeId);\n  const activationCoordinates = useMemo(() => activatorEvent ? getEventCoordinates(activatorEvent) : null, [activatorEvent]);\n  const autoScrollOptions = getAutoScrollerOptions();\n  const initialActiveNodeRect = useInitialRect(activeNode, measuringConfiguration.draggable.measure);\n  useLayoutShiftScrollCompensation({\n    activeNode: activeId != null ? draggableNodes.get(activeId) : null,\n    config: autoScrollOptions.layoutShiftCompensation,\n    initialRect: initialActiveNodeRect,\n    measure: measuringConfiguration.draggable.measure\n  });\n  const activeNodeRect = useRect(activeNode, measuringConfiguration.draggable.measure, initialActiveNodeRect);\n  const containerNodeRect = useRect(activeNode ? activeNode.parentElement : null);\n  const sensorContext = useRef({\n    activatorEvent: null,\n    active: null,\n    activeNode,\n    collisionRect: null,\n    collisions: null,\n    droppableRects,\n    draggableNodes,\n    draggingNode: null,\n    draggingNodeRect: null,\n    droppableContainers,\n    over: null,\n    scrollableAncestors: [],\n    scrollAdjustedTranslate: null\n  });\n  const overNode = droppableContainers.getNodeFor((_sensorContext$curren = sensorContext.current.over) == null ? void 0 : _sensorContext$curren.id);\n  const dragOverlay = useDragOverlayMeasuring({\n    measure: measuringConfiguration.dragOverlay.measure\n  }); // Use the rect of the drag overlay if it is mounted\n\n  const draggingNode = (_dragOverlay$nodeRef$ = dragOverlay.nodeRef.current) != null ? _dragOverlay$nodeRef$ : activeNode;\n  const draggingNodeRect = isInitialized ? (_dragOverlay$rect = dragOverlay.rect) != null ? _dragOverlay$rect : activeNodeRect : null;\n  const usesDragOverlay = Boolean(dragOverlay.nodeRef.current && dragOverlay.rect); // The delta between the previous and new position of the draggable node\n  // is only relevant when there is no drag overlay\n\n  const nodeRectDelta = useRectDelta(usesDragOverlay ? null : activeNodeRect); // Get the window rect of the dragging node\n\n  const windowRect = useWindowRect(draggingNode ? getWindow(draggingNode) : null); // Get scrollable ancestors of the dragging node\n\n  const scrollableAncestors = useScrollableAncestors(isInitialized ? overNode != null ? overNode : activeNode : null);\n  const scrollableAncestorRects = useRects(scrollableAncestors); // Apply modifiers\n\n  const modifiedTranslate = applyModifiers(modifiers, {\n    transform: {\n      x: translate.x - nodeRectDelta.x,\n      y: translate.y - nodeRectDelta.y,\n      scaleX: 1,\n      scaleY: 1\n    },\n    activatorEvent,\n    active,\n    activeNodeRect,\n    containerNodeRect,\n    draggingNodeRect,\n    over: sensorContext.current.over,\n    overlayNodeRect: dragOverlay.rect,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    windowRect\n  });\n  const pointerCoordinates = activationCoordinates ? add(activationCoordinates, translate) : null;\n  const scrollOffsets = useScrollOffsets(scrollableAncestors); // Represents the scroll delta since dragging was initiated\n\n  const scrollAdjustment = useScrollOffsetsDelta(scrollOffsets); // Represents the scroll delta since the last time the active node rect was measured\n\n  const activeNodeScrollDelta = useScrollOffsetsDelta(scrollOffsets, [activeNodeRect]);\n  const scrollAdjustedTranslate = add(modifiedTranslate, scrollAdjustment);\n  const collisionRect = draggingNodeRect ? getAdjustedRect(draggingNodeRect, modifiedTranslate) : null;\n  const collisions = active && collisionRect ? collisionDetection({\n    active,\n    collisionRect,\n    droppableRects,\n    droppableContainers: enabledDroppableContainers,\n    pointerCoordinates\n  }) : null;\n  const overId = getFirstCollision(collisions, 'id');\n  const [over, setOver] = useState(null); // When there is no drag overlay used, we need to account for the\n  // window scroll delta\n\n  const appliedTranslate = usesDragOverlay ? modifiedTranslate : add(modifiedTranslate, activeNodeScrollDelta);\n  const transform = adjustScale(appliedTranslate, (_over$rect = over == null ? void 0 : over.rect) != null ? _over$rect : null, activeNodeRect);\n  const activeSensorRef = useRef(null);\n  const instantiateSensor = useCallback((event, _ref2) => {\n    let {\n      sensor: Sensor,\n      options\n    } = _ref2;\n\n    if (activeRef.current == null) {\n      return;\n    }\n\n    const activeNode = draggableNodes.get(activeRef.current);\n\n    if (!activeNode) {\n      return;\n    }\n\n    const activatorEvent = event.nativeEvent;\n    const sensorInstance = new Sensor({\n      active: activeRef.current,\n      activeNode,\n      event: activatorEvent,\n      options,\n      // Sensors need to be instantiated with refs for arguments that change over time\n      // otherwise they are frozen in time with the stale arguments\n      context: sensorContext,\n\n      onAbort(id) {\n        const draggableNode = draggableNodes.get(id);\n\n        if (!draggableNode) {\n          return;\n        }\n\n        const {\n          onDragAbort\n        } = latestProps.current;\n        const event = {\n          id\n        };\n        onDragAbort == null ? void 0 : onDragAbort(event);\n        dispatchMonitorEvent({\n          type: 'onDragAbort',\n          event\n        });\n      },\n\n      onPending(id, constraint, initialCoordinates, offset) {\n        const draggableNode = draggableNodes.get(id);\n\n        if (!draggableNode) {\n          return;\n        }\n\n        const {\n          onDragPending\n        } = latestProps.current;\n        const event = {\n          id,\n          constraint,\n          initialCoordinates,\n          offset\n        };\n        onDragPending == null ? void 0 : onDragPending(event);\n        dispatchMonitorEvent({\n          type: 'onDragPending',\n          event\n        });\n      },\n\n      onStart(initialCoordinates) {\n        const id = activeRef.current;\n\n        if (id == null) {\n          return;\n        }\n\n        const draggableNode = draggableNodes.get(id);\n\n        if (!draggableNode) {\n          return;\n        }\n\n        const {\n          onDragStart\n        } = latestProps.current;\n        const event = {\n          activatorEvent,\n          active: {\n            id,\n            data: draggableNode.data,\n            rect: activeRects\n          }\n        };\n        unstable_batchedUpdates(() => {\n          onDragStart == null ? void 0 : onDragStart(event);\n          setStatus(Status.Initializing);\n          dispatch({\n            type: Action.DragStart,\n            initialCoordinates,\n            active: id\n          });\n          dispatchMonitorEvent({\n            type: 'onDragStart',\n            event\n          });\n          setActiveSensor(activeSensorRef.current);\n          setActivatorEvent(activatorEvent);\n        });\n      },\n\n      onMove(coordinates) {\n        dispatch({\n          type: Action.DragMove,\n          coordinates\n        });\n      },\n\n      onEnd: createHandler(Action.DragEnd),\n      onCancel: createHandler(Action.DragCancel)\n    });\n    activeSensorRef.current = sensorInstance;\n\n    function createHandler(type) {\n      return async function handler() {\n        const {\n          active,\n          collisions,\n          over,\n          scrollAdjustedTranslate\n        } = sensorContext.current;\n        let event = null;\n\n        if (active && scrollAdjustedTranslate) {\n          const {\n            cancelDrop\n          } = latestProps.current;\n          event = {\n            activatorEvent,\n            active: active,\n            collisions,\n            delta: scrollAdjustedTranslate,\n            over\n          };\n\n          if (type === Action.DragEnd && typeof cancelDrop === 'function') {\n            const shouldCancel = await Promise.resolve(cancelDrop(event));\n\n            if (shouldCancel) {\n              type = Action.DragCancel;\n            }\n          }\n        }\n\n        activeRef.current = null;\n        unstable_batchedUpdates(() => {\n          dispatch({\n            type\n          });\n          setStatus(Status.Uninitialized);\n          setOver(null);\n          setActiveSensor(null);\n          setActivatorEvent(null);\n          activeSensorRef.current = null;\n          const eventName = type === Action.DragEnd ? 'onDragEnd' : 'onDragCancel';\n\n          if (event) {\n            const handler = latestProps.current[eventName];\n            handler == null ? void 0 : handler(event);\n            dispatchMonitorEvent({\n              type: eventName,\n              event\n            });\n          }\n        });\n      };\n    }\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [draggableNodes]);\n  const bindActivatorToSensorInstantiator = useCallback((handler, sensor) => {\n    return (event, active) => {\n      const nativeEvent = event.nativeEvent;\n      const activeDraggableNode = draggableNodes.get(active);\n\n      if ( // Another sensor is already instantiating\n      activeRef.current !== null || // No active draggable\n      !activeDraggableNode || // Event has already been captured\n      nativeEvent.dndKit || nativeEvent.defaultPrevented) {\n        return;\n      }\n\n      const activationContext = {\n        active: activeDraggableNode\n      };\n      const shouldActivate = handler(event, sensor.options, activationContext);\n\n      if (shouldActivate === true) {\n        nativeEvent.dndKit = {\n          capturedBy: sensor.sensor\n        };\n        activeRef.current = active;\n        instantiateSensor(event, sensor);\n      }\n    };\n  }, [draggableNodes, instantiateSensor]);\n  const activators = useCombineActivators(sensors, bindActivatorToSensorInstantiator);\n  useSensorSetup(sensors);\n  useIsomorphicLayoutEffect(() => {\n    if (activeNodeRect && status === Status.Initializing) {\n      setStatus(Status.Initialized);\n    }\n  }, [activeNodeRect, status]);\n  useEffect(() => {\n    const {\n      onDragMove\n    } = latestProps.current;\n    const {\n      active,\n      activatorEvent,\n      collisions,\n      over\n    } = sensorContext.current;\n\n    if (!active || !activatorEvent) {\n      return;\n    }\n\n    const event = {\n      active,\n      activatorEvent,\n      collisions,\n      delta: {\n        x: scrollAdjustedTranslate.x,\n        y: scrollAdjustedTranslate.y\n      },\n      over\n    };\n    unstable_batchedUpdates(() => {\n      onDragMove == null ? void 0 : onDragMove(event);\n      dispatchMonitorEvent({\n        type: 'onDragMove',\n        event\n      });\n    });\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [scrollAdjustedTranslate.x, scrollAdjustedTranslate.y]);\n  useEffect(() => {\n    const {\n      active,\n      activatorEvent,\n      collisions,\n      droppableContainers,\n      scrollAdjustedTranslate\n    } = sensorContext.current;\n\n    if (!active || activeRef.current == null || !activatorEvent || !scrollAdjustedTranslate) {\n      return;\n    }\n\n    const {\n      onDragOver\n    } = latestProps.current;\n    const overContainer = droppableContainers.get(overId);\n    const over = overContainer && overContainer.rect.current ? {\n      id: overContainer.id,\n      rect: overContainer.rect.current,\n      data: overContainer.data,\n      disabled: overContainer.disabled\n    } : null;\n    const event = {\n      active,\n      activatorEvent,\n      collisions,\n      delta: {\n        x: scrollAdjustedTranslate.x,\n        y: scrollAdjustedTranslate.y\n      },\n      over\n    };\n    unstable_batchedUpdates(() => {\n      setOver(over);\n      onDragOver == null ? void 0 : onDragOver(event);\n      dispatchMonitorEvent({\n        type: 'onDragOver',\n        event\n      });\n    });\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [overId]);\n  useIsomorphicLayoutEffect(() => {\n    sensorContext.current = {\n      activatorEvent,\n      active,\n      activeNode,\n      collisionRect,\n      collisions,\n      droppableRects,\n      draggableNodes,\n      draggingNode,\n      draggingNodeRect,\n      droppableContainers,\n      over,\n      scrollableAncestors,\n      scrollAdjustedTranslate\n    };\n    activeRects.current = {\n      initial: draggingNodeRect,\n      translated: collisionRect\n    };\n  }, [active, activeNode, collisions, collisionRect, draggableNodes, draggingNode, draggingNodeRect, droppableRects, droppableContainers, over, scrollableAncestors, scrollAdjustedTranslate]);\n  useAutoScroller({ ...autoScrollOptions,\n    delta: translate,\n    draggingRect: collisionRect,\n    pointerCoordinates,\n    scrollableAncestors,\n    scrollableAncestorRects\n  });\n  const publicContext = useMemo(() => {\n    const context = {\n      active,\n      activeNode,\n      activeNodeRect,\n      activatorEvent,\n      collisions,\n      containerNodeRect,\n      dragOverlay,\n      draggableNodes,\n      droppableContainers,\n      droppableRects,\n      over,\n      measureDroppableContainers,\n      scrollableAncestors,\n      scrollableAncestorRects,\n      measuringConfiguration,\n      measuringScheduled,\n      windowRect\n    };\n    return context;\n  }, [active, activeNode, activeNodeRect, activatorEvent, collisions, containerNodeRect, dragOverlay, draggableNodes, droppableContainers, droppableRects, over, measureDroppableContainers, scrollableAncestors, scrollableAncestorRects, measuringConfiguration, measuringScheduled, windowRect]);\n  const internalContext = useMemo(() => {\n    const context = {\n      activatorEvent,\n      activators,\n      active,\n      activeNodeRect,\n      ariaDescribedById: {\n        draggable: draggableDescribedById\n      },\n      dispatch,\n      draggableNodes,\n      over,\n      measureDroppableContainers\n    };\n    return context;\n  }, [activatorEvent, activators, active, activeNodeRect, dispatch, draggableDescribedById, draggableNodes, over, measureDroppableContainers]);\n  return React.createElement(DndMonitorContext.Provider, {\n    value: registerMonitorListener\n  }, React.createElement(InternalContext.Provider, {\n    value: internalContext\n  }, React.createElement(PublicContext.Provider, {\n    value: publicContext\n  }, React.createElement(ActiveDraggableContext.Provider, {\n    value: transform\n  }, children)), React.createElement(RestoreFocus, {\n    disabled: (accessibility == null ? void 0 : accessibility.restoreFocus) === false\n  })), React.createElement(Accessibility, { ...accessibility,\n    hiddenTextDescribedById: draggableDescribedById\n  }));\n\n  function getAutoScrollerOptions() {\n    const activeSensorDisablesAutoscroll = (activeSensor == null ? void 0 : activeSensor.autoScrollEnabled) === false;\n    const autoScrollGloballyDisabled = typeof autoScroll === 'object' ? autoScroll.enabled === false : autoScroll === false;\n    const enabled = isInitialized && !activeSensorDisablesAutoscroll && !autoScrollGloballyDisabled;\n\n    if (typeof autoScroll === 'object') {\n      return { ...autoScroll,\n        enabled\n      };\n    }\n\n    return {\n      enabled\n    };\n  }\n});\n\nconst NullContext = /*#__PURE__*/createContext(null);\nconst defaultRole = 'button';\nconst ID_PREFIX = 'Draggable';\nfunction useDraggable(_ref) {\n  let {\n    id,\n    data,\n    disabled = false,\n    attributes\n  } = _ref;\n  const key = useUniqueId(ID_PREFIX);\n  const {\n    activators,\n    activatorEvent,\n    active,\n    activeNodeRect,\n    ariaDescribedById,\n    draggableNodes,\n    over\n  } = useContext(InternalContext);\n  const {\n    role = defaultRole,\n    roleDescription = 'draggable',\n    tabIndex = 0\n  } = attributes != null ? attributes : {};\n  const isDragging = (active == null ? void 0 : active.id) === id;\n  const transform = useContext(isDragging ? ActiveDraggableContext : NullContext);\n  const [node, setNodeRef] = useNodeRef();\n  const [activatorNode, setActivatorNodeRef] = useNodeRef();\n  const listeners = useSyntheticListeners(activators, id);\n  const dataRef = useLatestValue(data);\n  useIsomorphicLayoutEffect(() => {\n    draggableNodes.set(id, {\n      id,\n      key,\n      node,\n      activatorNode,\n      data: dataRef\n    });\n    return () => {\n      const node = draggableNodes.get(id);\n\n      if (node && node.key === key) {\n        draggableNodes.delete(id);\n      }\n    };\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [draggableNodes, id]);\n  const memoizedAttributes = useMemo(() => ({\n    role,\n    tabIndex,\n    'aria-disabled': disabled,\n    'aria-pressed': isDragging && role === defaultRole ? true : undefined,\n    'aria-roledescription': roleDescription,\n    'aria-describedby': ariaDescribedById.draggable\n  }), [disabled, role, tabIndex, isDragging, roleDescription, ariaDescribedById.draggable]);\n  return {\n    active,\n    activatorEvent,\n    activeNodeRect,\n    attributes: memoizedAttributes,\n    isDragging,\n    listeners: disabled ? undefined : listeners,\n    node,\n    over,\n    setNodeRef,\n    setActivatorNodeRef,\n    transform\n  };\n}\n\nfunction useDndContext() {\n  return useContext(PublicContext);\n}\n\nconst ID_PREFIX$1 = 'Droppable';\nconst defaultResizeObserverConfig = {\n  timeout: 25\n};\nfunction useDroppable(_ref) {\n  let {\n    data,\n    disabled = false,\n    id,\n    resizeObserverConfig\n  } = _ref;\n  const key = useUniqueId(ID_PREFIX$1);\n  const {\n    active,\n    dispatch,\n    over,\n    measureDroppableContainers\n  } = useContext(InternalContext);\n  const previous = useRef({\n    disabled\n  });\n  const resizeObserverConnected = useRef(false);\n  const rect = useRef(null);\n  const callbackId = useRef(null);\n  const {\n    disabled: resizeObserverDisabled,\n    updateMeasurementsFor,\n    timeout: resizeObserverTimeout\n  } = { ...defaultResizeObserverConfig,\n    ...resizeObserverConfig\n  };\n  const ids = useLatestValue(updateMeasurementsFor != null ? updateMeasurementsFor : id);\n  const handleResize = useCallback(() => {\n    if (!resizeObserverConnected.current) {\n      // ResizeObserver invokes the `handleResize` callback as soon as `observe` is called,\n      // assuming the element is rendered and displayed.\n      resizeObserverConnected.current = true;\n      return;\n    }\n\n    if (callbackId.current != null) {\n      clearTimeout(callbackId.current);\n    }\n\n    callbackId.current = setTimeout(() => {\n      measureDroppableContainers(Array.isArray(ids.current) ? ids.current : [ids.current]);\n      callbackId.current = null;\n    }, resizeObserverTimeout);\n  }, //eslint-disable-next-line react-hooks/exhaustive-deps\n  [resizeObserverTimeout]);\n  const resizeObserver = useResizeObserver({\n    callback: handleResize,\n    disabled: resizeObserverDisabled || !active\n  });\n  const handleNodeChange = useCallback((newElement, previousElement) => {\n    if (!resizeObserver) {\n      return;\n    }\n\n    if (previousElement) {\n      resizeObserver.unobserve(previousElement);\n      resizeObserverConnected.current = false;\n    }\n\n    if (newElement) {\n      resizeObserver.observe(newElement);\n    }\n  }, [resizeObserver]);\n  const [nodeRef, setNodeRef] = useNodeRef(handleNodeChange);\n  const dataRef = useLatestValue(data);\n  useEffect(() => {\n    if (!resizeObserver || !nodeRef.current) {\n      return;\n    }\n\n    resizeObserver.disconnect();\n    resizeObserverConnected.current = false;\n    resizeObserver.observe(nodeRef.current);\n  }, [nodeRef, resizeObserver]);\n  useEffect(() => {\n    dispatch({\n      type: Action.RegisterDroppable,\n      element: {\n        id,\n        key,\n        disabled,\n        node: nodeRef,\n        rect,\n        data: dataRef\n      }\n    });\n    return () => dispatch({\n      type: Action.UnregisterDroppable,\n      key,\n      id\n    });\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [id]);\n  useEffect(() => {\n    if (disabled !== previous.current.disabled) {\n      dispatch({\n        type: Action.SetDroppableDisabled,\n        id,\n        key,\n        disabled\n      });\n      previous.current.disabled = disabled;\n    }\n  }, [id, key, disabled, dispatch]);\n  return {\n    active,\n    rect,\n    isOver: (over == null ? void 0 : over.id) === id,\n    node: nodeRef,\n    over,\n    setNodeRef\n  };\n}\n\nfunction AnimationManager(_ref) {\n  let {\n    animation,\n    children\n  } = _ref;\n  const [clonedChildren, setClonedChildren] = useState(null);\n  const [element, setElement] = useState(null);\n  const previousChildren = usePrevious(children);\n\n  if (!children && !clonedChildren && previousChildren) {\n    setClonedChildren(previousChildren);\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    if (!element) {\n      return;\n    }\n\n    const key = clonedChildren == null ? void 0 : clonedChildren.key;\n    const id = clonedChildren == null ? void 0 : clonedChildren.props.id;\n\n    if (key == null || id == null) {\n      setClonedChildren(null);\n      return;\n    }\n\n    Promise.resolve(animation(id, element)).then(() => {\n      setClonedChildren(null);\n    });\n  }, [animation, clonedChildren, element]);\n  return React.createElement(React.Fragment, null, children, clonedChildren ? cloneElement(clonedChildren, {\n    ref: setElement\n  }) : null);\n}\n\nconst defaultTransform = {\n  x: 0,\n  y: 0,\n  scaleX: 1,\n  scaleY: 1\n};\nfunction NullifiedContextProvider(_ref) {\n  let {\n    children\n  } = _ref;\n  return React.createElement(InternalContext.Provider, {\n    value: defaultInternalContext\n  }, React.createElement(ActiveDraggableContext.Provider, {\n    value: defaultTransform\n  }, children));\n}\n\nconst baseStyles = {\n  position: 'fixed',\n  touchAction: 'none'\n};\n\nconst defaultTransition = activatorEvent => {\n  const isKeyboardActivator = isKeyboardEvent(activatorEvent);\n  return isKeyboardActivator ? 'transform 250ms ease' : undefined;\n};\n\nconst PositionedOverlay = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    as,\n    activatorEvent,\n    adjustScale,\n    children,\n    className,\n    rect,\n    style,\n    transform,\n    transition = defaultTransition\n  } = _ref;\n\n  if (!rect) {\n    return null;\n  }\n\n  const scaleAdjustedTransform = adjustScale ? transform : { ...transform,\n    scaleX: 1,\n    scaleY: 1\n  };\n  const styles = { ...baseStyles,\n    width: rect.width,\n    height: rect.height,\n    top: rect.top,\n    left: rect.left,\n    transform: CSS.Transform.toString(scaleAdjustedTransform),\n    transformOrigin: adjustScale && activatorEvent ? getRelativeTransformOrigin(activatorEvent, rect) : undefined,\n    transition: typeof transition === 'function' ? transition(activatorEvent) : transition,\n    ...style\n  };\n  return React.createElement(as, {\n    className,\n    style: styles,\n    ref\n  }, children);\n});\n\nconst defaultDropAnimationSideEffects = options => _ref => {\n  let {\n    active,\n    dragOverlay\n  } = _ref;\n  const originalStyles = {};\n  const {\n    styles,\n    className\n  } = options;\n\n  if (styles != null && styles.active) {\n    for (const [key, value] of Object.entries(styles.active)) {\n      if (value === undefined) {\n        continue;\n      }\n\n      originalStyles[key] = active.node.style.getPropertyValue(key);\n      active.node.style.setProperty(key, value);\n    }\n  }\n\n  if (styles != null && styles.dragOverlay) {\n    for (const [key, value] of Object.entries(styles.dragOverlay)) {\n      if (value === undefined) {\n        continue;\n      }\n\n      dragOverlay.node.style.setProperty(key, value);\n    }\n  }\n\n  if (className != null && className.active) {\n    active.node.classList.add(className.active);\n  }\n\n  if (className != null && className.dragOverlay) {\n    dragOverlay.node.classList.add(className.dragOverlay);\n  }\n\n  return function cleanup() {\n    for (const [key, value] of Object.entries(originalStyles)) {\n      active.node.style.setProperty(key, value);\n    }\n\n    if (className != null && className.active) {\n      active.node.classList.remove(className.active);\n    }\n  };\n};\n\nconst defaultKeyframeResolver = _ref2 => {\n  let {\n    transform: {\n      initial,\n      final\n    }\n  } = _ref2;\n  return [{\n    transform: CSS.Transform.toString(initial)\n  }, {\n    transform: CSS.Transform.toString(final)\n  }];\n};\n\nconst defaultDropAnimationConfiguration = {\n  duration: 250,\n  easing: 'ease',\n  keyframes: defaultKeyframeResolver,\n  sideEffects: /*#__PURE__*/defaultDropAnimationSideEffects({\n    styles: {\n      active: {\n        opacity: '0'\n      }\n    }\n  })\n};\nfunction useDropAnimation(_ref3) {\n  let {\n    config,\n    draggableNodes,\n    droppableContainers,\n    measuringConfiguration\n  } = _ref3;\n  return useEvent((id, node) => {\n    if (config === null) {\n      return;\n    }\n\n    const activeDraggable = draggableNodes.get(id);\n\n    if (!activeDraggable) {\n      return;\n    }\n\n    const activeNode = activeDraggable.node.current;\n\n    if (!activeNode) {\n      return;\n    }\n\n    const measurableNode = getMeasurableNode(node);\n\n    if (!measurableNode) {\n      return;\n    }\n\n    const {\n      transform\n    } = getWindow(node).getComputedStyle(node);\n    const parsedTransform = parseTransform(transform);\n\n    if (!parsedTransform) {\n      return;\n    }\n\n    const animation = typeof config === 'function' ? config : createDefaultDropAnimation(config);\n    scrollIntoViewIfNeeded(activeNode, measuringConfiguration.draggable.measure);\n    return animation({\n      active: {\n        id,\n        data: activeDraggable.data,\n        node: activeNode,\n        rect: measuringConfiguration.draggable.measure(activeNode)\n      },\n      draggableNodes,\n      dragOverlay: {\n        node,\n        rect: measuringConfiguration.dragOverlay.measure(measurableNode)\n      },\n      droppableContainers,\n      measuringConfiguration,\n      transform: parsedTransform\n    });\n  });\n}\n\nfunction createDefaultDropAnimation(options) {\n  const {\n    duration,\n    easing,\n    sideEffects,\n    keyframes\n  } = { ...defaultDropAnimationConfiguration,\n    ...options\n  };\n  return _ref4 => {\n    let {\n      active,\n      dragOverlay,\n      transform,\n      ...rest\n    } = _ref4;\n\n    if (!duration) {\n      // Do not animate if animation duration is zero.\n      return;\n    }\n\n    const delta = {\n      x: dragOverlay.rect.left - active.rect.left,\n      y: dragOverlay.rect.top - active.rect.top\n    };\n    const scale = {\n      scaleX: transform.scaleX !== 1 ? active.rect.width * transform.scaleX / dragOverlay.rect.width : 1,\n      scaleY: transform.scaleY !== 1 ? active.rect.height * transform.scaleY / dragOverlay.rect.height : 1\n    };\n    const finalTransform = {\n      x: transform.x - delta.x,\n      y: transform.y - delta.y,\n      ...scale\n    };\n    const animationKeyframes = keyframes({ ...rest,\n      active,\n      dragOverlay,\n      transform: {\n        initial: transform,\n        final: finalTransform\n      }\n    });\n    const [firstKeyframe] = animationKeyframes;\n    const lastKeyframe = animationKeyframes[animationKeyframes.length - 1];\n\n    if (JSON.stringify(firstKeyframe) === JSON.stringify(lastKeyframe)) {\n      // The start and end keyframes are the same, infer that there is no animation needed.\n      return;\n    }\n\n    const cleanup = sideEffects == null ? void 0 : sideEffects({\n      active,\n      dragOverlay,\n      ...rest\n    });\n    const animation = dragOverlay.node.animate(animationKeyframes, {\n      duration,\n      easing,\n      fill: 'forwards'\n    });\n    return new Promise(resolve => {\n      animation.onfinish = () => {\n        cleanup == null ? void 0 : cleanup();\n        resolve();\n      };\n    });\n  };\n}\n\nlet key = 0;\nfunction useKey(id) {\n  return useMemo(() => {\n    if (id == null) {\n      return;\n    }\n\n    key++;\n    return key;\n  }, [id]);\n}\n\nconst DragOverlay = /*#__PURE__*/React.memo(_ref => {\n  let {\n    adjustScale = false,\n    children,\n    dropAnimation: dropAnimationConfig,\n    style,\n    transition,\n    modifiers,\n    wrapperElement = 'div',\n    className,\n    zIndex = 999\n  } = _ref;\n  const {\n    activatorEvent,\n    active,\n    activeNodeRect,\n    containerNodeRect,\n    draggableNodes,\n    droppableContainers,\n    dragOverlay,\n    over,\n    measuringConfiguration,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    windowRect\n  } = useDndContext();\n  const transform = useContext(ActiveDraggableContext);\n  const key = useKey(active == null ? void 0 : active.id);\n  const modifiedTransform = applyModifiers(modifiers, {\n    activatorEvent,\n    active,\n    activeNodeRect,\n    containerNodeRect,\n    draggingNodeRect: dragOverlay.rect,\n    over,\n    overlayNodeRect: dragOverlay.rect,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    transform,\n    windowRect\n  });\n  const initialRect = useInitialValue(activeNodeRect);\n  const dropAnimation = useDropAnimation({\n    config: dropAnimationConfig,\n    draggableNodes,\n    droppableContainers,\n    measuringConfiguration\n  }); // We need to wait for the active node to be measured before connecting the drag overlay ref\n  // otherwise collisions can be computed against a mispositioned drag overlay\n\n  const ref = initialRect ? dragOverlay.setRef : undefined;\n  return React.createElement(NullifiedContextProvider, null, React.createElement(AnimationManager, {\n    animation: dropAnimation\n  }, active && key ? React.createElement(PositionedOverlay, {\n    key: key,\n    id: active.id,\n    ref: ref,\n    as: wrapperElement,\n    activatorEvent: activatorEvent,\n    adjustScale: adjustScale,\n    className: className,\n    transition: transition,\n    rect: initialRect,\n    style: {\n      zIndex,\n      ...style\n    },\n    transform: modifiedTransform\n  }, children) : null));\n});\n\nexport { AutoScrollActivator, DndContext, DragOverlay, KeyboardCode, KeyboardSensor, MeasuringFrequency, MeasuringStrategy, MouseSensor, PointerSensor, TouchSensor, TraversalOrder, applyModifiers, closestCenter, closestCorners, defaultAnnouncements, defaultCoordinates, defaultDropAnimationConfiguration as defaultDropAnimation, defaultDropAnimationSideEffects, defaultKeyboardCoordinateGetter, defaultScreenReaderInstructions, getClientRect, getFirstCollision, getScrollableAncestors, pointerWithin, rectIntersection, useDndContext, useDndMonitor, useDraggable, useDroppable, useSensor, useSensors };\n//# sourceMappingURL=core.esm.js.map\n","import React, { useMemo, useRef, useEffect, useState, useContext } from 'react';\nimport { useDndContext, getClientRect, useDroppable, useDraggable, closestCorners, getFirstCollision, getScrollableAncestors, KeyboardCode } from '@dnd-kit/core';\nimport { useUniqueId, useIsomorphicLayoutEffect, CSS, useCombinedRefs, isKeyboardEvent, subtract } from '@dnd-kit/utilities';\n\n/**\r\n * Move an array item to a different position. Returns a new array with the item moved to the new position.\r\n */\nfunction arrayMove(array, from, to) {\n  const newArray = array.slice();\n  newArray.splice(to < 0 ? newArray.length + to : to, 0, newArray.splice(from, 1)[0]);\n  return newArray;\n}\n\n/**\r\n * Swap an array item to a different position. Returns a new array with the item swapped to the new position.\r\n */\nfunction arraySwap(array, from, to) {\n  const newArray = array.slice();\n  newArray[from] = array[to];\n  newArray[to] = array[from];\n  return newArray;\n}\n\nfunction getSortedRects(items, rects) {\n  return items.reduce((accumulator, id, index) => {\n    const rect = rects.get(id);\n\n    if (rect) {\n      accumulator[index] = rect;\n    }\n\n    return accumulator;\n  }, Array(items.length));\n}\n\nfunction isValidIndex(index) {\n  return index !== null && index >= 0;\n}\n\nfunction itemsEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction normalizeDisabled(disabled) {\n  if (typeof disabled === 'boolean') {\n    return {\n      draggable: disabled,\n      droppable: disabled\n    };\n  }\n\n  return disabled;\n}\n\n// To-do: We should be calculating scale transformation\nconst defaultScale = {\n  scaleX: 1,\n  scaleY: 1\n};\nconst horizontalListSortingStrategy = _ref => {\n  var _rects$activeIndex;\n\n  let {\n    rects,\n    activeNodeRect: fallbackActiveRect,\n    activeIndex,\n    overIndex,\n    index\n  } = _ref;\n  const activeNodeRect = (_rects$activeIndex = rects[activeIndex]) != null ? _rects$activeIndex : fallbackActiveRect;\n\n  if (!activeNodeRect) {\n    return null;\n  }\n\n  const itemGap = getItemGap(rects, index, activeIndex);\n\n  if (index === activeIndex) {\n    const newIndexRect = rects[overIndex];\n\n    if (!newIndexRect) {\n      return null;\n    }\n\n    return {\n      x: activeIndex < overIndex ? newIndexRect.left + newIndexRect.width - (activeNodeRect.left + activeNodeRect.width) : newIndexRect.left - activeNodeRect.left,\n      y: 0,\n      ...defaultScale\n    };\n  }\n\n  if (index > activeIndex && index <= overIndex) {\n    return {\n      x: -activeNodeRect.width - itemGap,\n      y: 0,\n      ...defaultScale\n    };\n  }\n\n  if (index < activeIndex && index >= overIndex) {\n    return {\n      x: activeNodeRect.width + itemGap,\n      y: 0,\n      ...defaultScale\n    };\n  }\n\n  return {\n    x: 0,\n    y: 0,\n    ...defaultScale\n  };\n};\n\nfunction getItemGap(rects, index, activeIndex) {\n  const currentRect = rects[index];\n  const previousRect = rects[index - 1];\n  const nextRect = rects[index + 1];\n\n  if (!currentRect || !previousRect && !nextRect) {\n    return 0;\n  }\n\n  if (activeIndex < index) {\n    return previousRect ? currentRect.left - (previousRect.left + previousRect.width) : nextRect.left - (currentRect.left + currentRect.width);\n  }\n\n  return nextRect ? nextRect.left - (currentRect.left + currentRect.width) : currentRect.left - (previousRect.left + previousRect.width);\n}\n\nconst rectSortingStrategy = _ref => {\n  let {\n    rects,\n    activeIndex,\n    overIndex,\n    index\n  } = _ref;\n  const newRects = arrayMove(rects, overIndex, activeIndex);\n  const oldRect = rects[index];\n  const newRect = newRects[index];\n\n  if (!newRect || !oldRect) {\n    return null;\n  }\n\n  return {\n    x: newRect.left - oldRect.left,\n    y: newRect.top - oldRect.top,\n    scaleX: newRect.width / oldRect.width,\n    scaleY: newRect.height / oldRect.height\n  };\n};\n\nconst rectSwappingStrategy = _ref => {\n  let {\n    activeIndex,\n    index,\n    rects,\n    overIndex\n  } = _ref;\n  let oldRect;\n  let newRect;\n\n  if (index === activeIndex) {\n    oldRect = rects[index];\n    newRect = rects[overIndex];\n  }\n\n  if (index === overIndex) {\n    oldRect = rects[index];\n    newRect = rects[activeIndex];\n  }\n\n  if (!newRect || !oldRect) {\n    return null;\n  }\n\n  return {\n    x: newRect.left - oldRect.left,\n    y: newRect.top - oldRect.top,\n    scaleX: newRect.width / oldRect.width,\n    scaleY: newRect.height / oldRect.height\n  };\n};\n\n// To-do: We should be calculating scale transformation\nconst defaultScale$1 = {\n  scaleX: 1,\n  scaleY: 1\n};\nconst verticalListSortingStrategy = _ref => {\n  var _rects$activeIndex;\n\n  let {\n    activeIndex,\n    activeNodeRect: fallbackActiveRect,\n    index,\n    rects,\n    overIndex\n  } = _ref;\n  const activeNodeRect = (_rects$activeIndex = rects[activeIndex]) != null ? _rects$activeIndex : fallbackActiveRect;\n\n  if (!activeNodeRect) {\n    return null;\n  }\n\n  if (index === activeIndex) {\n    const overIndexRect = rects[overIndex];\n\n    if (!overIndexRect) {\n      return null;\n    }\n\n    return {\n      x: 0,\n      y: activeIndex < overIndex ? overIndexRect.top + overIndexRect.height - (activeNodeRect.top + activeNodeRect.height) : overIndexRect.top - activeNodeRect.top,\n      ...defaultScale$1\n    };\n  }\n\n  const itemGap = getItemGap$1(rects, index, activeIndex);\n\n  if (index > activeIndex && index <= overIndex) {\n    return {\n      x: 0,\n      y: -activeNodeRect.height - itemGap,\n      ...defaultScale$1\n    };\n  }\n\n  if (index < activeIndex && index >= overIndex) {\n    return {\n      x: 0,\n      y: activeNodeRect.height + itemGap,\n      ...defaultScale$1\n    };\n  }\n\n  return {\n    x: 0,\n    y: 0,\n    ...defaultScale$1\n  };\n};\n\nfunction getItemGap$1(clientRects, index, activeIndex) {\n  const currentRect = clientRects[index];\n  const previousRect = clientRects[index - 1];\n  const nextRect = clientRects[index + 1];\n\n  if (!currentRect) {\n    return 0;\n  }\n\n  if (activeIndex < index) {\n    return previousRect ? currentRect.top - (previousRect.top + previousRect.height) : nextRect ? nextRect.top - (currentRect.top + currentRect.height) : 0;\n  }\n\n  return nextRect ? nextRect.top - (currentRect.top + currentRect.height) : previousRect ? currentRect.top - (previousRect.top + previousRect.height) : 0;\n}\n\nconst ID_PREFIX = 'Sortable';\nconst Context = /*#__PURE__*/React.createContext({\n  activeIndex: -1,\n  containerId: ID_PREFIX,\n  disableTransforms: false,\n  items: [],\n  overIndex: -1,\n  useDragOverlay: false,\n  sortedRects: [],\n  strategy: rectSortingStrategy,\n  disabled: {\n    draggable: false,\n    droppable: false\n  }\n});\nfunction SortableContext(_ref) {\n  let {\n    children,\n    id,\n    items: userDefinedItems,\n    strategy = rectSortingStrategy,\n    disabled: disabledProp = false\n  } = _ref;\n  const {\n    active,\n    dragOverlay,\n    droppableRects,\n    over,\n    measureDroppableContainers\n  } = useDndContext();\n  const containerId = useUniqueId(ID_PREFIX, id);\n  const useDragOverlay = Boolean(dragOverlay.rect !== null);\n  const items = useMemo(() => userDefinedItems.map(item => typeof item === 'object' && 'id' in item ? item.id : item), [userDefinedItems]);\n  const isDragging = active != null;\n  const activeIndex = active ? items.indexOf(active.id) : -1;\n  const overIndex = over ? items.indexOf(over.id) : -1;\n  const previousItemsRef = useRef(items);\n  const itemsHaveChanged = !itemsEqual(items, previousItemsRef.current);\n  const disableTransforms = overIndex !== -1 && activeIndex === -1 || itemsHaveChanged;\n  const disabled = normalizeDisabled(disabledProp);\n  useIsomorphicLayoutEffect(() => {\n    if (itemsHaveChanged && isDragging) {\n      measureDroppableContainers(items);\n    }\n  }, [itemsHaveChanged, items, isDragging, measureDroppableContainers]);\n  useEffect(() => {\n    previousItemsRef.current = items;\n  }, [items]);\n  const contextValue = useMemo(() => ({\n    activeIndex,\n    containerId,\n    disabled,\n    disableTransforms,\n    items,\n    overIndex,\n    useDragOverlay,\n    sortedRects: getSortedRects(items, droppableRects),\n    strategy\n  }), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [activeIndex, containerId, disabled.draggable, disabled.droppable, disableTransforms, items, overIndex, droppableRects, useDragOverlay, strategy]);\n  return React.createElement(Context.Provider, {\n    value: contextValue\n  }, children);\n}\n\nconst defaultNewIndexGetter = _ref => {\n  let {\n    id,\n    items,\n    activeIndex,\n    overIndex\n  } = _ref;\n  return arrayMove(items, activeIndex, overIndex).indexOf(id);\n};\nconst defaultAnimateLayoutChanges = _ref2 => {\n  let {\n    containerId,\n    isSorting,\n    wasDragging,\n    index,\n    items,\n    newIndex,\n    previousItems,\n    previousContainerId,\n    transition\n  } = _ref2;\n\n  if (!transition || !wasDragging) {\n    return false;\n  }\n\n  if (previousItems !== items && index === newIndex) {\n    return false;\n  }\n\n  if (isSorting) {\n    return true;\n  }\n\n  return newIndex !== index && containerId === previousContainerId;\n};\nconst defaultTransition = {\n  duration: 200,\n  easing: 'ease'\n};\nconst transitionProperty = 'transform';\nconst disabledTransition = /*#__PURE__*/CSS.Transition.toString({\n  property: transitionProperty,\n  duration: 0,\n  easing: 'linear'\n});\nconst defaultAttributes = {\n  roleDescription: 'sortable'\n};\n\n/*\r\n * When the index of an item changes while sorting,\r\n * we need to temporarily disable the transforms\r\n */\n\nfunction useDerivedTransform(_ref) {\n  let {\n    disabled,\n    index,\n    node,\n    rect\n  } = _ref;\n  const [derivedTransform, setDerivedtransform] = useState(null);\n  const previousIndex = useRef(index);\n  useIsomorphicLayoutEffect(() => {\n    if (!disabled && index !== previousIndex.current && node.current) {\n      const initial = rect.current;\n\n      if (initial) {\n        const current = getClientRect(node.current, {\n          ignoreTransform: true\n        });\n        const delta = {\n          x: initial.left - current.left,\n          y: initial.top - current.top,\n          scaleX: initial.width / current.width,\n          scaleY: initial.height / current.height\n        };\n\n        if (delta.x || delta.y) {\n          setDerivedtransform(delta);\n        }\n      }\n    }\n\n    if (index !== previousIndex.current) {\n      previousIndex.current = index;\n    }\n  }, [disabled, index, node, rect]);\n  useEffect(() => {\n    if (derivedTransform) {\n      setDerivedtransform(null);\n    }\n  }, [derivedTransform]);\n  return derivedTransform;\n}\n\nfunction useSortable(_ref) {\n  let {\n    animateLayoutChanges = defaultAnimateLayoutChanges,\n    attributes: userDefinedAttributes,\n    disabled: localDisabled,\n    data: customData,\n    getNewIndex = defaultNewIndexGetter,\n    id,\n    strategy: localStrategy,\n    resizeObserverConfig,\n    transition = defaultTransition\n  } = _ref;\n  const {\n    items,\n    containerId,\n    activeIndex,\n    disabled: globalDisabled,\n    disableTransforms,\n    sortedRects,\n    overIndex,\n    useDragOverlay,\n    strategy: globalStrategy\n  } = useContext(Context);\n  const disabled = normalizeLocalDisabled(localDisabled, globalDisabled);\n  const index = items.indexOf(id);\n  const data = useMemo(() => ({\n    sortable: {\n      containerId,\n      index,\n      items\n    },\n    ...customData\n  }), [containerId, customData, index, items]);\n  const itemsAfterCurrentSortable = useMemo(() => items.slice(items.indexOf(id)), [items, id]);\n  const {\n    rect,\n    node,\n    isOver,\n    setNodeRef: setDroppableNodeRef\n  } = useDroppable({\n    id,\n    data,\n    disabled: disabled.droppable,\n    resizeObserverConfig: {\n      updateMeasurementsFor: itemsAfterCurrentSortable,\n      ...resizeObserverConfig\n    }\n  });\n  const {\n    active,\n    activatorEvent,\n    activeNodeRect,\n    attributes,\n    setNodeRef: setDraggableNodeRef,\n    listeners,\n    isDragging,\n    over,\n    setActivatorNodeRef,\n    transform\n  } = useDraggable({\n    id,\n    data,\n    attributes: { ...defaultAttributes,\n      ...userDefinedAttributes\n    },\n    disabled: disabled.draggable\n  });\n  const setNodeRef = useCombinedRefs(setDroppableNodeRef, setDraggableNodeRef);\n  const isSorting = Boolean(active);\n  const displaceItem = isSorting && !disableTransforms && isValidIndex(activeIndex) && isValidIndex(overIndex);\n  const shouldDisplaceDragSource = !useDragOverlay && isDragging;\n  const dragSourceDisplacement = shouldDisplaceDragSource && displaceItem ? transform : null;\n  const strategy = localStrategy != null ? localStrategy : globalStrategy;\n  const finalTransform = displaceItem ? dragSourceDisplacement != null ? dragSourceDisplacement : strategy({\n    rects: sortedRects,\n    activeNodeRect,\n    activeIndex,\n    overIndex,\n    index\n  }) : null;\n  const newIndex = isValidIndex(activeIndex) && isValidIndex(overIndex) ? getNewIndex({\n    id,\n    items,\n    activeIndex,\n    overIndex\n  }) : index;\n  const activeId = active == null ? void 0 : active.id;\n  const previous = useRef({\n    activeId,\n    items,\n    newIndex,\n    containerId\n  });\n  const itemsHaveChanged = items !== previous.current.items;\n  const shouldAnimateLayoutChanges = animateLayoutChanges({\n    active,\n    containerId,\n    isDragging,\n    isSorting,\n    id,\n    index,\n    items,\n    newIndex: previous.current.newIndex,\n    previousItems: previous.current.items,\n    previousContainerId: previous.current.containerId,\n    transition,\n    wasDragging: previous.current.activeId != null\n  });\n  const derivedTransform = useDerivedTransform({\n    disabled: !shouldAnimateLayoutChanges,\n    index,\n    node,\n    rect\n  });\n  useEffect(() => {\n    if (isSorting && previous.current.newIndex !== newIndex) {\n      previous.current.newIndex = newIndex;\n    }\n\n    if (containerId !== previous.current.containerId) {\n      previous.current.containerId = containerId;\n    }\n\n    if (items !== previous.current.items) {\n      previous.current.items = items;\n    }\n  }, [isSorting, newIndex, containerId, items]);\n  useEffect(() => {\n    if (activeId === previous.current.activeId) {\n      return;\n    }\n\n    if (activeId != null && previous.current.activeId == null) {\n      previous.current.activeId = activeId;\n      return;\n    }\n\n    const timeoutId = setTimeout(() => {\n      previous.current.activeId = activeId;\n    }, 50);\n    return () => clearTimeout(timeoutId);\n  }, [activeId]);\n  return {\n    active,\n    activeIndex,\n    attributes,\n    data,\n    rect,\n    index,\n    newIndex,\n    items,\n    isOver,\n    isSorting,\n    isDragging,\n    listeners,\n    node,\n    overIndex,\n    over,\n    setNodeRef,\n    setActivatorNodeRef,\n    setDroppableNodeRef,\n    setDraggableNodeRef,\n    transform: derivedTransform != null ? derivedTransform : finalTransform,\n    transition: getTransition()\n  };\n\n  function getTransition() {\n    if ( // Temporarily disable transitions for a single frame to set up derived transforms\n    derivedTransform || // Or to prevent items jumping to back to their \"new\" position when items change\n    itemsHaveChanged && previous.current.newIndex === index) {\n      return disabledTransition;\n    }\n\n    if (shouldDisplaceDragSource && !isKeyboardEvent(activatorEvent) || !transition) {\n      return undefined;\n    }\n\n    if (isSorting || shouldAnimateLayoutChanges) {\n      return CSS.Transition.toString({ ...transition,\n        property: transitionProperty\n      });\n    }\n\n    return undefined;\n  }\n}\n\nfunction normalizeLocalDisabled(localDisabled, globalDisabled) {\n  var _localDisabled$dragga, _localDisabled$droppa;\n\n  if (typeof localDisabled === 'boolean') {\n    return {\n      draggable: localDisabled,\n      // Backwards compatibility\n      droppable: false\n    };\n  }\n\n  return {\n    draggable: (_localDisabled$dragga = localDisabled == null ? void 0 : localDisabled.draggable) != null ? _localDisabled$dragga : globalDisabled.draggable,\n    droppable: (_localDisabled$droppa = localDisabled == null ? void 0 : localDisabled.droppable) != null ? _localDisabled$droppa : globalDisabled.droppable\n  };\n}\n\nfunction hasSortableData(entry) {\n  if (!entry) {\n    return false;\n  }\n\n  const data = entry.data.current;\n\n  if (data && 'sortable' in data && typeof data.sortable === 'object' && 'containerId' in data.sortable && 'items' in data.sortable && 'index' in data.sortable) {\n    return true;\n  }\n\n  return false;\n}\n\nconst directions = [KeyboardCode.Down, KeyboardCode.Right, KeyboardCode.Up, KeyboardCode.Left];\nconst sortableKeyboardCoordinates = (event, _ref) => {\n  let {\n    context: {\n      active,\n      collisionRect,\n      droppableRects,\n      droppableContainers,\n      over,\n      scrollableAncestors\n    }\n  } = _ref;\n\n  if (directions.includes(event.code)) {\n    event.preventDefault();\n\n    if (!active || !collisionRect) {\n      return;\n    }\n\n    const filteredContainers = [];\n    droppableContainers.getEnabled().forEach(entry => {\n      if (!entry || entry != null && entry.disabled) {\n        return;\n      }\n\n      const rect = droppableRects.get(entry.id);\n\n      if (!rect) {\n        return;\n      }\n\n      switch (event.code) {\n        case KeyboardCode.Down:\n          if (collisionRect.top < rect.top) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n\n        case KeyboardCode.Up:\n          if (collisionRect.top > rect.top) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n\n        case KeyboardCode.Left:\n          if (collisionRect.left > rect.left) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n\n        case KeyboardCode.Right:\n          if (collisionRect.left < rect.left) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n      }\n    });\n    const collisions = closestCorners({\n      active,\n      collisionRect: collisionRect,\n      droppableRects,\n      droppableContainers: filteredContainers,\n      pointerCoordinates: null\n    });\n    let closestId = getFirstCollision(collisions, 'id');\n\n    if (closestId === (over == null ? void 0 : over.id) && collisions.length > 1) {\n      closestId = collisions[1].id;\n    }\n\n    if (closestId != null) {\n      const activeDroppable = droppableContainers.get(active.id);\n      const newDroppable = droppableContainers.get(closestId);\n      const newRect = newDroppable ? droppableRects.get(newDroppable.id) : null;\n      const newNode = newDroppable == null ? void 0 : newDroppable.node.current;\n\n      if (newNode && newRect && activeDroppable && newDroppable) {\n        const newScrollAncestors = getScrollableAncestors(newNode);\n        const hasDifferentScrollAncestors = newScrollAncestors.some((element, index) => scrollableAncestors[index] !== element);\n        const hasSameContainer = isSameContainer(activeDroppable, newDroppable);\n        const isAfterActive = isAfter(activeDroppable, newDroppable);\n        const offset = hasDifferentScrollAncestors || !hasSameContainer ? {\n          x: 0,\n          y: 0\n        } : {\n          x: isAfterActive ? collisionRect.width - newRect.width : 0,\n          y: isAfterActive ? collisionRect.height - newRect.height : 0\n        };\n        const rectCoordinates = {\n          x: newRect.left,\n          y: newRect.top\n        };\n        const newCoordinates = offset.x && offset.y ? rectCoordinates : subtract(rectCoordinates, offset);\n        return newCoordinates;\n      }\n    }\n  }\n\n  return undefined;\n};\n\nfunction isSameContainer(a, b) {\n  if (!hasSortableData(a) || !hasSortableData(b)) {\n    return false;\n  }\n\n  return a.data.current.sortable.containerId === b.data.current.sortable.containerId;\n}\n\nfunction isAfter(a, b) {\n  if (!hasSortableData(a) || !hasSortableData(b)) {\n    return false;\n  }\n\n  if (!isSameContainer(a, b)) {\n    return false;\n  }\n\n  return a.data.current.sortable.index < b.data.current.sortable.index;\n}\n\nexport { SortableContext, arrayMove, arraySwap, defaultAnimateLayoutChanges, defaultNewIndexGetter, hasSortableData, horizontalListSortingStrategy, rectSortingStrategy, rectSwappingStrategy, sortableKeyboardCoordinates, useSortable, verticalListSortingStrategy };\n//# sourceMappingURL=sortable.esm.js.map\n","import { useState } from 'react'\nimport { Calendar } from '@/components/ui/calendar'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport { Calendar as CalendarIcon } from 'lucide-react'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\nimport { cn } from '@/lib/utils'\nimport { logger } from '@/lib/logger'\n\ninterface DateAmountPickerPopoverProps {\n  children: React.ReactNode\n  onConfirm: (date: Date, amount: number) => void\n  disabled?: boolean\n  placeholder?: string\n  align?: \"center\" | \"start\" | \"end\"\n  side?: \"top\" | \"right\" | \"bottom\" | \"left\"\n  defaultDate?: Date\n  defaultAmount?: number\n}\n\nexport function DateAmountPickerPopover({\n  children,\n  onConfirm,\n  disabled = false,\n  placeholder = \"  \",\n  align = \"center\",\n  side = \"bottom\",\n  defaultDate,\n  defaultAmount\n}: DateAmountPickerPopoverProps) {\n  const [open, setOpen] = useState(false)\n  const [selectedDate, setSelectedDate] = useState<Date | undefined>(defaultDate)\n  const [amount, setAmount] = useState<string>(defaultAmount?.toString() || '')\n\n  const handleConfirm = () => {\n    if (!selectedDate) {\n      return\n    }\n    \n    const amountNum = parseFloat(amount.replace(/,/g, ''))\n    if (isNaN(amountNum) || amountNum <= 0) {\n      return\n    }\n\n    onConfirm(selectedDate, amountNum)\n    setOpen(false)\n    // Reset after close\n    setSelectedDate(defaultDate)\n    setAmount(defaultAmount?.toString() || '')\n  }\n\n  const handleAmountChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value.replace(/[^0-9]/g, '')\n    if (value) {\n      const numValue = parseInt(value, 10)\n      setAmount(numValue.toLocaleString())\n    } else {\n      setAmount('')\n    }\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild disabled={disabled}>\n        {children}\n      </PopoverTrigger>\n      <PopoverContent \n        className=\"w-auto p-0 border-gray-200 shadow-lg\" \n        align={align}\n        side={side}\n        sideOffset={8}\n      >\n        <div className=\"bg-white business-radius-card p-3\">\n          <div className=\"mb-2 px-1\">\n            <div className=\"modal-label text-gray-600 text-center\">\n              {placeholder}\n            </div>\n          </div>\n          <Calendar\n            mode=\"single\"\n            selected={selectedDate}\n            onSelect={setSelectedDate}\n            locale={ko}\n            initialFocus\n            className=\"compact-calendar\"\n            disabled={false}\n            fromDate={new Date('2020-01-01')}\n            toDate={new Date('2030-12-31')}\n            defaultMonth={selectedDate || new Date()}\n            modifiers={{\n              today: new Date()\n            }}\n            modifiersClassNames={{\n              today: \"bg-blue-500 text-white font-semibold cursor-pointer hover:bg-blue-600 rounded-md\"\n            }}\n          />\n          <div className=\"mt-3 px-1\">\n            <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n              \n            </label>\n            <Input\n              type=\"text\"\n              value={amount}\n              onChange={handleAmountChange}\n              placeholder=\" \"\n              className=\"w-full\"\n            />\n          </div>\n          <div className=\"mt-3 flex justify-end gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setOpen(false)}\n            >\n              \n            </Button>\n            <Button\n              size=\"sm\"\n              onClick={handleConfirm}\n              disabled={!selectedDate || !amount || parseFloat(amount.replace(/,/g, '')) <= 0}\n              className=\"button-base button-action-primary\"\n            >\n              \n            </Button>\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\n","import { useState } from 'react'\nimport { Calendar } from '@/components/ui/calendar'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport { Calendar as CalendarIcon } from 'lucide-react'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\nimport { cn } from '@/lib/utils'\nimport { logger } from '@/lib/logger'\n\ninterface DateQuantityPickerPopoverProps {\n  children: React.ReactNode\n  onConfirm: (date: Date, quantity?: number) => void\n  disabled?: boolean\n  placeholder?: string\n  align?: \"center\" | \"start\" | \"end\"\n  side?: \"top\" | \"right\" | \"bottom\" | \"left\"\n  defaultDate?: Date\n  defaultQuantity?: number\n  maxQuantity?: number\n  hideQuantityInput?: boolean\n  quantityInfoText?: string\n}\n\nexport function DateQuantityPickerPopover({\n  children,\n  onConfirm,\n  disabled = false,\n  placeholder = \"  \",\n  align = \"center\",\n  side = \"bottom\",\n  defaultDate,\n  defaultQuantity,\n  maxQuantity,\n  hideQuantityInput = false,\n  quantityInfoText = \"   \"\n}: DateQuantityPickerPopoverProps) {\n  const [open, setOpen] = useState(false)\n  const [selectedDate, setSelectedDate] = useState<Date | undefined>(defaultDate)\n  const [quantity, setQuantity] = useState<string>(defaultQuantity?.toString() || '')\n\n  const handleFillRequestedQuantity = () => {\n    if (maxQuantity !== undefined) {\n      setQuantity(maxQuantity.toString())\n    }\n  }\n\n  const handleConfirm = () => {\n    if (!selectedDate) {\n      return\n    }\n    \n    if (hideQuantityInput) {\n      //     ( ), quantity undefined \n      onConfirm(selectedDate, undefined)\n      setOpen(false)\n      // Reset after close\n      setSelectedDate(defaultDate)\n      setQuantity(defaultQuantity?.toString() || '')\n      return\n    }\n    \n    const quantityNum = parseFloat(quantity.replace(/,/g, ''))\n    if (isNaN(quantityNum) || quantityNum < 0) {\n      return\n    }\n\n    if (maxQuantity && quantityNum > maxQuantity) {\n      return\n    }\n\n    onConfirm(selectedDate, quantityNum)\n    setOpen(false)\n    // Reset after close\n    setSelectedDate(defaultDate)\n    setQuantity(defaultQuantity?.toString() || '')\n  }\n\n  const handleQuantityChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value.replace(/[^0-9]/g, '')\n    setQuantity(value)\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild disabled={disabled}>\n        {children}\n      </PopoverTrigger>\n      <PopoverContent \n        className=\"w-auto p-0 border-gray-200 shadow-lg\" \n        align={align}\n        side={side}\n        sideOffset={8}\n      >\n        <div className=\"bg-white business-radius-card p-3\">\n          <div className=\"mb-2 px-1\">\n            <div className=\"modal-label text-gray-600 text-center\">\n              {placeholder}\n            </div>\n          </div>\n          {hideQuantityInput && (\n            <div className=\"mb-2 px-1\">\n              <div className=\"text-[10px] text-gray-500 text-center leading-tight\">\n                <div> </div>\n                <div> </div>\n              </div>\n            </div>\n          )}\n          <Calendar\n            mode=\"single\"\n            selected={selectedDate}\n            onSelect={setSelectedDate}\n            locale={ko}\n            initialFocus\n            className=\"compact-calendar\"\n            disabled={false}\n            fromDate={new Date('2020-01-01')}\n            toDate={new Date('2030-12-31')}\n            defaultMonth={selectedDate || new Date()}\n            modifiers={{\n              today: new Date()\n            }}\n            modifiersClassNames={{\n              today: \"bg-blue-500 text-white font-semibold cursor-pointer hover:bg-blue-600 rounded-md\"\n            }}\n          />\n          {!hideQuantityInput && (\n            <div className=\"mt-3 px-1\">\n              <div className=\"flex items-center justify-between mb-1 gap-2\">\n                <label className=\"block text-xs font-medium text-gray-700\">\n                  {quantityInfoText?.includes('') ? '' : ''}\n                </label>\n                {maxQuantity !== undefined && (\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleFillRequestedQuantity}\n                    className=\"h-6 px-2 text-[10px] border-gray-200 text-hansl-600\"\n                  >\n                    {quantityInfoText?.includes('') ? '  ' : ' '}\n                  </Button>\n                )}\n              </div>\n              <Input\n                type=\"number\"\n                value={quantity}\n                onChange={handleQuantityChange}\n                placeholder=\" \"\n                className=\"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                min=\"0\"\n                max={maxQuantity}\n              />\n              {maxQuantity && (\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  {quantityInfoText?.includes('') ? quantityInfoText : `: ${maxQuantity.toLocaleString()}`}\n                </p>\n              )}\n            </div>\n          )}\n          <div className=\"mt-3 flex justify-end gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setOpen(false)}\n              className=\"button-base\"\n            >\n              \n            </Button>\n            <Button\n              size=\"sm\"\n              onClick={handleConfirm}\n              disabled={!selectedDate || (!hideQuantityInput && (!quantity || parseFloat(quantity.replace(/,/g, '')) < 0 || (maxQuantity !== undefined && parseFloat(quantity.replace(/,/g, '')) > maxQuantity)))}\n              className=\"button-base button-action-primary\"\n            >\n              \n            </Button>\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\n","import { useCallback } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { toast } from 'sonner'\nimport { logger } from '@/lib/logger'\nimport { markItemAsReceived, markItemAsReceiptCanceled, markItemAsStatementReceived, markItemAsStatementCanceled } from '@/stores/purchaseMemoryStore'\nimport { dateToISOString } from '@/utils/helpers'\n\nexport interface ConfirmDateActionConfig {\n  field: 'statement_received' | 'actual_received'\n  confirmMessage: {\n    confirm: string\n    cancel: string\n  }\n  successMessage: {\n    confirm: string\n    cancel: string\n  }\n  completedText: string\n  waitingText: string\n}\n\nexport interface UseConfirmDateActionProps {\n  config: ConfirmDateActionConfig\n  currentUserName: string | null\n  canPerformAction: boolean\n  purchaseId?: number | string  //     purchase ID\n  onUpdate?: () => void\n  onBeforeUpdate?: () => void  //      (Realtime    )\n  onOptimisticUpdate?: (params: {\n    itemId: number\n    selectedDate?: Date\n    action: 'confirm' | 'cancel'\n    receivedQuantity?: number\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n      received_quantity?: number\n    }\n  }) => void\n}\n\nexport function useConfirmDateAction({\n  config,\n  currentUserName,\n  canPerformAction,\n  purchaseId,\n  onUpdate,\n  onBeforeUpdate,\n  onOptimisticUpdate\n}: UseConfirmDateActionProps) {\n  const supabase = createClient()\n\n  const handleConfirm = useCallback(async (\n    itemId: number | string,\n    selectedDate: Date,\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n      received_quantity?: number\n    },\n    receivedQuantity?: number\n  ) => {\n    \n    if (!canPerformAction) {\n      logger.warn(`  `, { canPerformAction, currentUserName })\n      toast.error(`${config.field === 'statement_received' ? '' : ''}   .`)\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      logger.error('  ID', { itemId, numericId })\n      toast.error('   ID .')\n      return\n    }\n\n    //   \n    if (itemInfo) {\n      const confirmMessage = `: ${itemInfo.item_name || '-'}\n: ${itemInfo.specification || '-'}\n: ${itemInfo.quantity?.toLocaleString() || 0}\n: ${itemInfo.unit_price_value?.toLocaleString() || 0}\n: ${itemInfo.amount_value?.toLocaleString() || 0}\n: ${itemInfo.remark || '-'}\n\n${config.confirmMessage.confirm}`\n      \n      if (!window.confirm(confirmMessage)) {\n        return\n      }\n    }\n\n    //       (Realtime    )\n    onBeforeUpdate?.()\n\n    try {\n      let updateData: any\n\n      if (config.field === 'statement_received') {\n        updateData = {\n          is_statement_received: true,\n          statement_received_date: dateToISOString(selectedDate),\n          statement_received_by_name: currentUserName\n        }\n      } else if (config.field === 'actual_received') {\n        //   : receipt_history  \n        const requestedQuantity = itemInfo?.quantity || 0\n        const currentReceivedQuantity = itemInfo?.received_quantity || 0\n        const newReceivedQuantity = receivedQuantity !== undefined ? receivedQuantity : requestedQuantity\n        const totalReceivedQuantity = currentReceivedQuantity + newReceivedQuantity\n        \n        //      \n        const { data: existingItem } = await supabase\n          .from('purchase_request_items')\n          .select('receipt_history')\n          .eq('id', numericId)\n          .single()\n        \n        const existingHistory = (existingItem?.receipt_history as any[]) || []\n        const nextSeq = existingHistory.length + 1\n        \n        //    \n        const newHistoryItem = {\n          seq: nextSeq,\n          qty: newReceivedQuantity,\n          date: dateToISOString(selectedDate),\n          by: currentUserName || ''\n        }\n        \n        const updatedHistory = [...existingHistory, newHistoryItem]\n        \n        //    :   >=  \n        const isFullyReceived = totalReceivedQuantity >= requestedQuantity\n        \n        updateData = {\n          actual_received_date: dateToISOString(selectedDate),\n          is_received: isFullyReceived,\n          received_quantity: totalReceivedQuantity,\n          delivery_status: totalReceivedQuantity === 0 ? 'pending' : (isFullyReceived ? 'received' : 'partial'),\n          receipt_history: updatedHistory\n        }\n        \n        logger.debug('   :', {\n          requestedQuantity,\n          currentReceivedQuantity,\n          newReceivedQuantity,\n          totalReceivedQuantity,\n          isFullyReceived,\n          historyCount: updatedHistory.length\n        })\n      }\n\n      logger.debug('  :', updateData)\n\n      const { data, error } = await supabase\n        .from('purchase_request_items')\n        .update(updateData)\n        .eq('id', numericId)\n        .select()\n\n      logger.debug(' DB  :', { data, error })\n\n      if (error) {\n        logger.error(' DB  ', error)\n        throw error\n      }\n\n      logger.info(' DB  ', data)\n\n      //     \n      if (purchaseId) {\n        if (config.field === 'actual_received') {\n          const memoryUpdated = markItemAsReceived(purchaseId, numericId, dateToISOString(selectedDate), receivedQuantity)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]     ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        } else if (config.field === 'statement_received') {\n          const memoryUpdated = markItemAsStatementReceived(purchaseId, numericId, dateToISOString(selectedDate), currentUserName || undefined)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]      ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        }\n      }\n\n      if (onOptimisticUpdate) {\n        onOptimisticUpdate({\n          itemId: numericId,\n          selectedDate,\n          action: 'confirm',\n          receivedQuantity: receivedQuantity !== undefined ? receivedQuantity : itemInfo?.received_quantity,\n          itemInfo\n        })\n      }\n\n      //    onUpdate \n      if (onUpdate) {\n        onUpdate()\n      }\n      \n      toast.success(config.successMessage.confirm)\n    } catch (error) {\n      logger.error('   ', error)\n      toast.error(`${config.field === 'statement_received' ? '' : ''}     .`)\n    }\n  }, [config, currentUserName, canPerformAction, purchaseId, onUpdate, onBeforeUpdate, onOptimisticUpdate, supabase])\n\n  const handleCancel = useCallback(async (\n    itemId: number | string,\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n    }\n  ) => {\n    if (!canPerformAction) {\n      logger.warn(`   `, { canPerformAction, currentUserName })\n      toast.error(`${config.field === 'statement_received' ? '' : ''}   .`)\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('   ID .')\n      return\n    }\n\n    //   \n    if (itemInfo) {\n      const confirmMessage = `: ${itemInfo.item_name || '-'}\n: ${itemInfo.specification || '-'}\n: ${itemInfo.quantity?.toLocaleString() || 0}\n: ${itemInfo.unit_price_value?.toLocaleString() || 0}\n: ${itemInfo.amount_value?.toLocaleString() || 0}\n: ${itemInfo.remark || '-'}\n\n${config.confirmMessage.cancel}`\n      \n      if (!window.confirm(confirmMessage)) {\n        return\n      }\n    }\n\n    //       (Realtime    )\n    onBeforeUpdate?.()\n\n    try {\n      logger.debug(` ${config.field}   `, { \n        itemId, \n        itemName: itemInfo?.item_name \n      })\n\n      let updateData: any\n\n      if (config.field === 'statement_received') {\n        updateData = {\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      } else if (config.field === 'actual_received') {\n        //   : receipt_history  \n        updateData = {\n          actual_received_date: null,\n          is_received: false,\n          received_quantity: 0,\n          delivery_status: 'pending',\n          receipt_history: []\n        }\n      }\n\n      logger.debug('   :', updateData)\n\n      const { data, error } = await supabase\n        .from('purchase_request_items')\n        .update(updateData)\n        .eq('id', numericId)\n        .select()\n\n      logger.debug('  DB  :', { data, error })\n\n      if (error) {\n        logger.error(' DB  ', error)\n        throw error\n      }\n\n      logger.info(` ${config.field}   `, data)\n\n      //     \n      if (purchaseId) {\n        if (config.field === 'actual_received') {\n          const memoryUpdated = markItemAsReceiptCanceled(purchaseId, numericId)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]     ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        } else if (config.field === 'statement_received') {\n          const memoryUpdated = markItemAsStatementCanceled(purchaseId, numericId)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]      ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        }\n      }\n\n      if (onOptimisticUpdate) {\n        onOptimisticUpdate({\n          itemId: numericId,\n          action: 'cancel',\n          itemInfo\n        })\n      }\n\n      //    onUpdate \n      if (onUpdate) {\n        onUpdate()\n      }\n      \n      toast.success(config.successMessage.cancel)\n    } catch (error) {\n      logger.error(` ${config.field}   `, error)\n      toast.error(`${config.field === 'statement_received' ? '' : ''}     .`)\n    }\n  }, [config, canPerformAction, purchaseId, onUpdate, onBeforeUpdate, onOptimisticUpdate, supabase])\n\n  const isCompleted = useCallback((item: any) => {\n    if (config.field === 'statement_received') {\n      return item.is_statement_received\n    } else if (config.field === 'actual_received') {\n      return item.is_received // actual_received_date  is_received  \n    }\n    return false\n  }, [config.field])\n\n  //     ( )\n  const isPartiallyReceived = useCallback((item: any) => {\n    if (config.field === 'actual_received') {\n      const receivedQty = item.received_quantity || 0\n      const requestedQty = item.quantity || 0\n      return receivedQty > 0 && receivedQty < requestedQty\n    }\n    return false\n  }, [config.field])\n\n  //   \n  const getRemainingQuantity = useCallback((item: any) => {\n    const receivedQty = item.received_quantity || 0\n    const requestedQty = item.quantity || 0\n    return Math.max(0, requestedQty - receivedQty)\n  }, [])\n\n  const getCompletedDate = useCallback((item: any) => {\n    if (config.field === 'statement_received') {\n      return item.statement_received_date\n    } else if (config.field === 'actual_received') {\n      return item.actual_received_date\n    }\n    return null\n  }, [config.field])\n\n  const getCompletedByName = useCallback((item: any) => {\n    if (config.field === 'statement_received') {\n      return item.statement_received_by_name\n    } else if (config.field === 'actual_received') {\n      //     \n      return null\n    }\n    return null\n  }, [config.field])\n\n  return {\n    config,\n    handleConfirm,\n    handleCancel,\n    isCompleted,\n    isPartiallyReceived,\n    getRemainingQuantity,\n    getCompletedDate,\n    getCompletedByName\n  }\n}","import { ColumnInfo, DoneTabColumnId, ColumnVisibility } from '@/types/columnSettings';\n\n/**\n *     \n * 22     \n */\n\n//     ( )\nexport const DONE_TAB_COLUMNS: ColumnInfo[] = [\n  {\n    id: 'statement_progress',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'purchase_order_number',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'payment_category',\n    label: '',\n    description: '  (, ,  )',\n    defaultVisible: true,\n  },\n  {\n    id: 'requester_name',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'request_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'utk_status',\n    label: 'UTK',\n    description: 'UTK  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'vendor_name',\n    label: '',\n    description: '',\n    defaultVisible: true,\n  },\n  {\n    id: 'contact_name',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'delivery_request_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'revised_delivery_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'item_name',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'specification',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'quantity',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'unit_price',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'amount',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'remark',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'link',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'project_vendor',\n    label: 'PJ',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'project_item',\n    label: 'PJ ITEM',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'sales_order_number',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'purchase_progress',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'receipt_progress',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n];\n\n//     (  )\nexport const DEFAULT_COLUMN_VISIBILITY: ColumnVisibility = DONE_TAB_COLUMNS.reduce(\n  (acc, column) => {\n    acc[column.id] = column.defaultVisible;\n    return acc;\n  },\n  {} as ColumnVisibility\n);\n\n//  ID    \nexport const COLUMN_INFO_MAP: Record<DoneTabColumnId, ColumnInfo> = DONE_TAB_COLUMNS.reduce(\n  (acc, column) => {\n    acc[column.id] = column;\n    return acc;\n  },\n  {} as Record<DoneTabColumnId, ColumnInfo>\n);\n\n//   (   )\nexport const REQUIRED_COLUMNS: DoneTabColumnId[] = [\n  'purchase_order_number',\n  'vendor_name',\n  'item_name',\n  'specification',\n];\n\n//    (     )\nexport const RESTRICTED_COLUMNS: DoneTabColumnId[] = [\n  'statement_progress',  // \n  'utk_status',         // UTK\n  'unit_price',         // \n  'amount',            // ( )\n];\n\n//   \nexport const AUTHORIZED_ROLES = [\n  'app_admin',\n  'ceo',\n  'final_approver',\n  'purchase_manager',\n  'lead buyer',\n  'accounting',\n];\n\n// UTK (/)  - PurchaseDetailModal \nexport const UTK_AUTHORIZED_ROLES = [\n  'app_admin',\n  'lead buyer',\n  'accounting',\n];\n\n//   ( UI )\nexport const COLUMN_GROUPS = [\n  {\n    title: ' ',\n    columns: [\n      'statement_progress',\n      'purchase_order_number',\n      'payment_category',\n      'requester_name',\n      'request_date',\n      'utk_status',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'vendor_name',\n      'contact_name',\n      'delivery_request_date',\n      'revised_delivery_date',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'item_name',\n      'specification',\n      'quantity',\n      'unit_price',\n      'amount',\n      'remark',\n      'link',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'project_vendor',\n      'project_item',\n      'sales_order_number',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'purchase_progress',\n      'receipt_progress',\n    ] as DoneTabColumnId[],\n  },\n] as const;","/**\n *     \n */\n\n//  \nexport type TransactionStatementStatus = \n  | 'pending'     // ,  \n  | 'processing'  // OCR  \n  | 'extracted'   //  ,  \n  | 'confirmed'   // \n  | 'rejected';   // \n\n//  \nexport type MatchConfidence = 'low' | 'med' | 'high';\n\n//  \nexport type MatchMethod = 'po_number' | 'item_similarity' | 'manual';\n\n//   \nexport interface TransactionStatement {\n  id: string;\n  image_url: string;\n  file_name?: string;\n  uploaded_at: string;\n  uploaded_by?: string;\n  uploaded_by_name?: string;\n  status: TransactionStatementStatus;\n  confirmed_at?: string;\n  confirmed_by?: string;\n  confirmed_by_name?: string;\n  statement_date?: string;\n  vendor_name?: string;\n  total_amount?: number;\n  tax_amount?: number;\n  grand_total?: number;\n  extracted_data?: ExtractedData;\n  extraction_error?: string;\n  created_at: string;\n  updated_at: string;\n  //        ID ( )\n  matched_purchase_id?: number | null;\n  //        (  )\n  matched_purchases?: Array<{\n    purchase_id: number;\n    purchase_order_number: string;\n    sales_order_number?: string;\n  }>;\n}\n\n//   \nexport interface TransactionStatementItem {\n  id: string;\n  statement_id: string;\n  line_number?: number;\n  extracted_item_name?: string;\n  extracted_specification?: string;\n  extracted_quantity?: number;\n  extracted_unit_price?: number;\n  extracted_amount?: number;\n  extracted_tax_amount?: number;\n  extracted_po_number?: string;\n  extracted_remark?: string;\n  \n  //  \n  matched_purchase_id?: number;\n  matched_item_id?: number;\n  match_confidence?: MatchConfidence;\n  match_method?: MatchMethod;\n  \n  //  \n  is_additional_item: boolean;\n  parent_item_id?: string;\n  \n  //  \n  is_confirmed: boolean;\n  confirmed_unit_price?: number;\n  confirmed_amount?: number;\n  confirmed_quantity?: number;\n  \n  created_at: string;\n  updated_at: string;\n}\n\n// OCR   \nexport interface OCRCorrection {\n  id: string;\n  statement_id?: string;\n  statement_item_id?: string;\n  original_text: string;\n  corrected_text: string;\n  field_type: OCRFieldType;\n  corrected_by?: string;\n  corrected_by_name?: string;\n  created_at: string;\n}\n\nexport type OCRFieldType = \n  | 'po_number' \n  | 'item_name' \n  | 'quantity' \n  | 'unit_price' \n  | 'amount' \n  | 'date' \n  | 'vendor_name' \n  | 'remark';\n\n// OCR/LLM   \nexport interface ExtractedItem {\n  line_number: number;\n  item_name: string;\n  specification?: string;\n  quantity: number;\n  unit_price: number;\n  amount: number;\n  tax_amount?: number;\n  po_number?: string;\n  remark?: string;\n  confidence: MatchConfidence;\n}\n\nexport interface ExtractedData {\n  statement_date?: string;\n  vendor_name?: string;\n  total_amount?: number;\n  tax_amount?: number;\n  grand_total?: number;\n  items: ExtractedItem[];\n  raw_vision_text?: string;\n}\n\n//    \nexport interface MatchCandidate {\n  purchase_id: number;\n  purchase_order_number: string;\n  sales_order_number?: string;\n  item_id: number;\n  item_name: string;\n  specification?: string;\n  quantity: number;\n  unit_price?: number;\n  vendor_name?: string;\n  score: number; //   (0-100)\n  match_reasons: string[]; //  \n}\n\n//   ( )\nexport interface TransactionStatementWithItems extends TransactionStatement {\n  items: TransactionStatementItemWithMatch[];\n}\n\n//  +  \nexport interface TransactionStatementItemWithMatch extends TransactionStatementItem {\n  match_candidates?: MatchCandidate[];\n  matched_purchase?: {\n    id: number;\n    purchase_order_number: string;\n    sales_order_number?: string;\n    vendor_name?: string;\n  };\n  matched_item?: {\n    id: number;\n    item_name: string;\n    specification?: string;\n    quantity: number;\n    unit_price_value?: number;\n  };\n}\n\n//   \nexport interface UploadStatementRequest {\n  file: File;\n}\n\n//   \nexport interface UploadStatementResponse {\n  statementId: string;\n  imageUrl: string;\n}\n\n// OCR   \nexport interface ExtractStatementRequest {\n  statementId: string;\n  imageUrl: string;\n}\n\n//   \nexport interface ConfirmStatementRequest {\n  statementId: string;\n  items: ConfirmItemRequest[];\n}\n\nexport interface ConfirmItemRequest {\n  itemId: string;\n  matched_purchase_id?: number;\n  matched_item_id?: number;\n  confirmed_quantity?: number;\n  confirmed_unit_price?: number;\n  confirmed_amount?: number;\n  is_additional_item?: boolean;\n  parent_item_id?: string;\n}\n\n//    \nexport interface SaveCorrectionRequest {\n  statement_id?: string;\n  statement_item_id?: string;\n  original_text: string;\n  corrected_text: string;\n  field_type: OCRFieldType;\n}\n\n// / \n// : F + YYYYMMDD + _ + 3  (: F20251008_001, F20251008_002)\nexport const PO_NUMBER_PATTERN = /^F\\d{8}_\\d{3}$/;\n// : HS + YYMMDD + - + 2  (: HS251201-01, HS251201-11)\nexport const SO_NUMBER_PATTERN = /^HS\\d{6}-\\d{2}$/;\n\n// OCR     \nexport function normalizeOrderNumber(input: string): string {\n  if (!input) return input;\n  \n  const normalized = input.toUpperCase().replace(/\\s+/g, '');\n  \n  //  : F20251008_1  F20251008_01  F20251008_001\n  const poMatch = normalized.match(/^(F\\d{8})_(\\d{1,3})$/);\n  if (poMatch) {\n    const [, prefix, num] = poMatch;\n    return `${prefix}_${num.padStart(3, '0')}`;\n  }\n  \n  //  : HS251201-1  HS251201-01\n  const soMatch = normalized.match(/^(HS\\d{6})-(\\d{1,2})$/);\n  if (soMatch) {\n    const [, prefix, num] = soMatch;\n    return `${prefix}-${num.padStart(2, '0')}`;\n  }\n  \n  return normalized;\n}\n\n//   \nexport function isValidPoNumber(value: string): boolean {\n  return PO_NUMBER_PATTERN.test(value.toUpperCase());\n}\n\nexport function isValidSoNumber(value: string): boolean {\n  return SO_NUMBER_PATTERN.test(value.toUpperCase());\n}\n\nexport function isValidOrderNumber(value: string): boolean {\n  return isValidPoNumber(value) || isValidSoNumber(value);\n}\n\n//   \nexport function extractDateFromOrderNumber(orderNumber: string): string | null {\n  const match = orderNumber.match(/\\d{8}/);\n  if (!match) return null;\n  \n  const dateStr = match[0];\n  const year = dateStr.substring(0, 4);\n  const month = dateStr.substring(4, 6);\n  const day = dateStr.substring(6, 8);\n  \n  return `${year}-${month}-${day}`;\n}\n\n","/**\n *    \n * -  \n * - OCR/LLM  (Edge Function )\n * -  \n * -   \n * -   \n */\n\nimport { createClient } from \"@/lib/supabase/client\";\nimport type {\n  TransactionStatement,\n  TransactionStatementItem,\n  TransactionStatementWithItems,\n  TransactionStatementItemWithMatch,\n  MatchCandidate,\n  OCRCorrection,\n  ConfirmStatementRequest,\n  SaveCorrectionRequest\n} from \"@/types/transactionStatement\";\nimport { normalizeOrderNumber } from \"@/types/transactionStatement\";\n\nclass TransactionStatementService {\n  private supabase;\n\n  constructor() {\n    this.supabase = createClient();\n  }\n\n  /**\n   *   \n   */\n  async uploadStatement(\n    file: File,\n    uploaderName: string\n  ): Promise<{ success: boolean; data?: { statementId: string; imageUrl: string }; error?: string }> {\n    try {\n      //   \n      const ext = file.name.split('.').pop()?.toLowerCase() || 'png';\n      const uuid = crypto.randomUUID();\n      const fileName = `${uuid}.${ext}`;\n      const storagePath = `Transaction Statement/${fileName}`;\n\n      // Storage \n      const { data: uploadData, error: uploadError } = await this.supabase\n        .storage\n        .from('receipt-images')\n        .upload(storagePath, file, {\n          contentType: file.type,\n          upsert: false\n        });\n\n      if (uploadError) throw uploadError;\n\n      // Public URL \n      const { data: urlData } = this.supabase\n        .storage\n        .from('receipt-images')\n        .getPublicUrl(storagePath);\n\n      const imageUrl = urlData.publicUrl;\n\n      //   \n      const { data: { user } } = await this.supabase.auth.getUser();\n\n      // DB  \n      console.log('[Upload] DB   :', { imageUrl, fileName: file.name, userId: user?.id });\n      \n      const { data: statement, error: dbError } = await this.supabase\n        .from('transaction_statements')\n        .insert({\n          image_url: imageUrl,\n          file_name: file.name,\n          uploaded_by: user?.id,\n          uploaded_by_name: uploaderName,\n          status: 'pending'\n        })\n        .select()\n        .single();\n\n      if (dbError) {\n        console.error('[Upload] DB insert :', dbError);\n        throw new Error(`DB  : ${dbError.message} (code: ${dbError.code})`);\n      }\n      \n      console.log('[Upload] DB   :', { statementId: statement.id });\n\n      return {\n        success: true,\n        data: {\n          statementId: statement.id,\n          imageUrl\n        }\n      };\n    } catch (error) {\n      console.error('Upload statement error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '   .'\n      };\n    }\n  }\n\n  /**\n   * OCR/LLM   (Edge Function )\n   */\n  async extractStatementData(\n    statementId: string,\n    imageUrl: string\n  ): Promise<{ success: boolean; data?: TransactionStatementWithItems; error?: string }> {\n    try {\n      console.log('[Service] Calling Edge Function with:', { statementId, imageUrl });\n      \n      // OCR    processing \n      await this.supabase\n        .from('transaction_statements')\n        .update({ status: 'processing' })\n        .eq('id', statementId);\n      \n      // Edge Function \n      const { data, error } = await this.supabase.functions.invoke('ocr-transaction-statement', {\n        body: {\n          statementId,\n          imageUrl\n        }\n      });\n\n      console.log('[Service] Edge Function response:', { data, error });\n\n      if (error) throw error;\n\n      if (!data.success) {\n        throw new Error(data.error || 'OCR  ');\n      }\n\n      //   \n      console.log('[Service]   :', { \n        vendor_name: data.vendor_name, \n        vendor_match_source: data.vendor_match_source \n      });\n\n      //   \n      const result = await this.getStatementWithItems(statementId);\n      return result;\n    } catch (error) {\n      console.error('[Service] Extract statement error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'OCR    .'\n      };\n    }\n  }\n\n  /**\n   *   \n   */\n  async getStatements(filters?: {\n    status?: string;\n    dateFrom?: string;\n    dateTo?: string;\n    search?: string;\n    limit?: number;\n    offset?: number;\n  }): Promise<{ success: boolean; data?: TransactionStatement[]; count?: number; error?: string }> {\n    try {\n      // items  purchase_id  \n      let query = this.supabase\n        .from('transaction_statements')\n        .select(`\n          *,\n          items:transaction_statement_items(matched_purchase_id)\n        `, { count: 'exact' })\n        .order('uploaded_at', { ascending: false });\n\n      if (filters?.status && filters.status !== 'all') {\n        query = query.eq('status', filters.status);\n      }\n\n      if (filters?.dateFrom) {\n        query = query.gte('uploaded_at', filters.dateFrom);\n      }\n\n      if (filters?.dateTo) {\n        query = query.lte('uploaded_at', filters.dateTo + 'T23:59:59');\n      }\n\n      if (filters?.search) {\n        query = query.or(`vendor_name.ilike.%${filters.search}%,file_name.ilike.%${filters.search}%`);\n      }\n\n      if (filters?.limit) {\n        query = query.limit(filters.limit);\n      }\n\n      if (filters?.offset) {\n        query = query.range(filters.offset, filters.offset + (filters.limit || 20) - 1);\n      }\n\n      const { data, count, error } = await query;\n\n      if (error) throw error;\n\n      //  purchase_id \n      const allPurchaseIds = new Set<number>();\n      (data || []).forEach((statement: any) => {\n        statement.items?.forEach((item: any) => {\n          if (item.matched_purchase_id) {\n            allPurchaseIds.add(item.matched_purchase_id);\n          }\n        });\n      });\n\n      //    (, )\n      const purchaseInfoMap = new Map<number, { purchase_order_number: string; sales_order_number?: string }>();\n      if (allPurchaseIds.size > 0) {\n        const { data: purchases } = await this.supabase\n          .from('purchase_requests')\n          .select('id, purchase_order_number, sales_order_number')\n          .in('id', Array.from(allPurchaseIds));\n        \n        purchases?.forEach((p: any) => {\n          purchaseInfoMap.set(p.id, {\n            purchase_order_number: p.purchase_order_number,\n            sales_order_number: p.sales_order_number\n          });\n        });\n      }\n\n      //      \n      const statementsWithPurchases = (data || []).map((statement: any) => {\n        const purchaseIds = new Set<number>();\n        statement.items?.forEach((item: any) => {\n          if (item.matched_purchase_id) {\n            purchaseIds.add(item.matched_purchase_id);\n          }\n        });\n\n        const matchedPurchases = Array.from(purchaseIds).map(purchaseId => {\n          const info = purchaseInfoMap.get(purchaseId);\n          return {\n            purchase_id: purchaseId,\n            purchase_order_number: info?.purchase_order_number || '',\n            sales_order_number: info?.sales_order_number\n          };\n        });\n\n        const { items, ...rest } = statement;\n        return {\n          ...rest,\n          matched_purchase_id: matchedPurchases[0]?.purchase_id || null, //  \n          matched_purchases: matchedPurchases\n        };\n      });\n\n      return { success: true, data: statementsWithPurchases, count: count || 0 };\n    } catch (error) {\n      console.error('Get statements error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '   .'\n      };\n    }\n  }\n\n  /**\n   *    ( )\n   */\n  async getStatementWithItems(\n    statementId: string\n  ): Promise<{ success: boolean; data?: TransactionStatementWithItems; error?: string }> {\n    try {\n      //  \n      const { data: statement, error: stmtError } = await this.supabase\n        .from('transaction_statements')\n        .select('*')\n        .eq('id', statementId)\n        .single();\n\n      if (stmtError) throw stmtError;\n\n      //  \n      const { data: items, error: itemsError } = await this.supabase\n        .from('transaction_statement_items')\n        .select('*')\n        .eq('statement_id', statementId)\n        .order('line_number', { ascending: true });\n\n      if (itemsError) throw itemsError;\n\n      //     (  )\n      const statementVendorName = statement.vendor_name || '';\n      const itemsWithMatch: TransactionStatementItemWithMatch[] = await Promise.all(\n        (items || []).map(async (item: TransactionStatementItem) => {\n          const matchCandidates = await this.findMatchCandidates(item, statementVendorName);\n          \n          //  / \n          let matchedPurchase = undefined;\n          let matchedItem = undefined;\n          \n          if (item.matched_purchase_id) {\n            const { data: purchase } = await this.supabase\n              .from('purchase_requests')\n              .select('id, purchase_order_number, sales_order_number, vendor:vendors(vendor_name)')\n              .eq('id', item.matched_purchase_id)\n              .single();\n            \n            if (purchase) {\n              matchedPurchase = {\n                id: purchase.id,\n                purchase_order_number: purchase.purchase_order_number || '',\n                sales_order_number: purchase.sales_order_number,\n                vendor_name: purchase.vendor?.vendor_name\n              };\n            }\n          }\n\n          if (item.matched_item_id) {\n            const { data: purchaseItem } = await this.supabase\n              .from('purchase_request_items')\n              .select('id, item_name, specification, quantity, unit_price_value')\n              .eq('id', item.matched_item_id)\n              .single();\n            \n            if (purchaseItem) {\n              matchedItem = {\n                id: purchaseItem.id,\n                item_name: purchaseItem.item_name,\n                specification: purchaseItem.specification,\n                quantity: purchaseItem.quantity,\n                unit_price_value: purchaseItem.unit_price_value\n              };\n            }\n          }\n\n          return {\n            ...item,\n            match_candidates: matchCandidates,\n            matched_purchase: matchedPurchase,\n            matched_item: matchedItem\n          };\n        })\n      );\n\n      return {\n        success: true,\n        data: {\n          ...statement,\n          items: itemsWithMatch\n        }\n      };\n    } catch (error) {\n      console.error('Get statement with items error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '   .'\n      };\n    }\n  }\n\n  /**\n   *    \n   * -   :  +  +   \n   * -   +   \n   * -  /   ( )\n   */\n  async findMatchCandidates(item: TransactionStatementItem, statementVendorName?: string): Promise<MatchCandidate[]> {\n    const candidateMap = new Map<string, MatchCandidate>(); //  \n\n    try {\n      const rawNumber = item.extracted_po_number || '';\n      const normalizedNumber = rawNumber ? normalizeOrderNumber(rawNumber) : '';\n      \n      //     (F20251212  HS251212 -   )\n      const partialPOMatch = rawNumber.toUpperCase().match(/^(F)(\\d{8})$/);\n      const partialSOMatch = rawNumber.toUpperCase().match(/^(HS)(\\d{6})$/);\n      const isPartialNumber = !!(partialPOMatch || partialSOMatch);\n      const datePrefix = partialPOMatch ? `F${partialPOMatch[2]}` : (partialSOMatch ? `HS${partialSOMatch[2]}` : '');\n\n      // 1. PO/SO   \n      if (normalizedNumber) {\n        const { data: byNumber } = await this.supabase\n          .from('purchase_requests')\n          .select(`\n            id, \n            purchase_order_number, \n            sales_order_number,\n            vendor:vendors(vendor_name),\n            items:purchase_request_items(id, item_name, specification, quantity, unit_price_value)\n          `)\n          .or(`purchase_order_number.eq.${normalizedNumber},sales_order_number.eq.${normalizedNumber}`)\n          .limit(10);\n\n        if (byNumber) {\n          for (const purchase of byNumber) {\n            //    (     )\n            const sysVendorName = purchase.vendor?.vendor_name || '';\n            const vendorSimilarity = statementVendorName \n              ? this.calculateVendorSimilarity(statementVendorName, sysVendorName)\n              : 100; //    \n            \n            //   70%   (   )\n            if (vendorSimilarity < 50) {\n              console.log(`   : \"${statementVendorName}\" vs \"${sysVendorName}\" (${vendorSimilarity}%)`);\n              continue;\n            }\n\n            for (const purchaseItem of purchase.items || []) {\n              const key = `${purchase.id}-${purchaseItem.id}`;\n              const matchReasons = ['/ '];\n              let score = 50; //    \n              \n              //   \n              if (vendorSimilarity >= 90) {\n                score += 10;\n                matchReasons.push(' ');\n              } else if (vendorSimilarity >= 70) {\n                score += 5;\n                matchReasons.push(' ');\n              }\n              \n              //  OR    \n              if (item.extracted_item_name) {\n                const itemMatch = this.calculateItemMatchScore(\n                  item.extracted_item_name, \n                  purchaseItem.item_name, \n                  purchaseItem.specification\n                );\n                score += itemMatch.score * 0.3; //  +30\n                if (itemMatch.score >= 80) {\n                  matchReasons.push(itemMatch.matchedField === 'specification' ? ' ' : ' ');\n                }\n              }\n              \n              //  :  ,    \n              if (item.extracted_quantity && purchaseItem.quantity) {\n                if (item.extracted_quantity === purchaseItem.quantity) {\n                  score += 15;\n                  matchReasons.push(`  (${item.extracted_quantity})`);\n                } else if (item.extracted_quantity <= purchaseItem.quantity) {\n                  score += 5;\n                  matchReasons.push(` (:${purchaseItem.quantity}, :${item.extracted_quantity})`);\n                }\n              }\n              \n              candidateMap.set(key, {\n                purchase_id: purchase.id,\n                purchase_order_number: purchase.purchase_order_number || '',\n                sales_order_number: purchase.sales_order_number,\n                item_id: purchaseItem.id,\n                item_name: purchaseItem.item_name,\n                specification: purchaseItem.specification,\n                quantity: purchaseItem.quantity,\n                unit_price: purchaseItem.unit_price_value,\n                vendor_name: sysVendorName,\n                score,\n                match_reasons: matchReasons\n              });\n            }\n          }\n        }\n      }\n\n      // 1.5.    (F20251212  HS251212 -      )\n      if (isPartialNumber && datePrefix && candidateMap.size === 0) {\n        console.log(`   : \"${datePrefix}%\" (   )`);\n        \n        const { data: byDatePrefix } = await this.supabase\n          .from('purchase_requests')\n          .select(`\n            id, \n            purchase_order_number, \n            sales_order_number,\n            vendor:vendors(vendor_name),\n            items:purchase_request_items(id, item_name, specification, quantity, unit_price_value)\n          `)\n          .or(`purchase_order_number.ilike.${datePrefix}%,sales_order_number.ilike.${datePrefix}%`)\n          .limit(20);\n\n        if (byDatePrefix) {\n          for (const purchase of byDatePrefix) {\n            const sysVendorName = purchase.vendor?.vendor_name || '';\n            const vendorSimilarity = statementVendorName \n              ? this.calculateVendorSimilarity(statementVendorName, sysVendorName)\n              : 100;\n            \n            //   70%  \n            if (vendorSimilarity < 50) {\n              continue;\n            }\n\n            for (const purchaseItem of purchase.items || []) {\n              const key = `${purchase.id}-${purchaseItem.id}`;\n              if (candidateMap.has(key)) continue;\n\n              const matchReasons = [`  (${datePrefix})`];\n              let score = 30; //    \n              \n              //   \n              if (vendorSimilarity >= 90) {\n                score += 20;\n                matchReasons.push(' ');\n              } else if (vendorSimilarity >= 70) {\n                score += 10;\n                matchReasons.push(' ');\n              }\n              \n              //  OR    \n              if (item.extracted_item_name) {\n                const itemMatch = this.calculateItemMatchScore(\n                  item.extracted_item_name, \n                  purchaseItem.item_name, \n                  purchaseItem.specification\n                );\n                score += itemMatch.score * 0.4; //  +40\n                if (itemMatch.score >= 80) {\n                  matchReasons.push(itemMatch.matchedField === 'specification' ? ' ' : ' ');\n                } else if (itemMatch.score >= 50) {\n                  matchReasons.push(itemMatch.matchedField === 'specification' ? ' ' : ' ');\n                }\n              }\n              \n              //  :  ,    \n              if (item.extracted_quantity && purchaseItem.quantity) {\n                if (item.extracted_quantity === purchaseItem.quantity) {\n                  score += 15;\n                  matchReasons.push(`  (${item.extracted_quantity})`);\n                } else if (item.extracted_quantity <= purchaseItem.quantity) {\n                  score += 5;\n                  matchReasons.push(` (:${purchaseItem.quantity}, :${item.extracted_quantity})`);\n                }\n              }\n              \n              candidateMap.set(key, {\n                purchase_id: purchase.id,\n                purchase_order_number: purchase.purchase_order_number || '',\n                sales_order_number: purchase.sales_order_number,\n                item_id: purchaseItem.id,\n                item_name: purchaseItem.item_name,\n                specification: purchaseItem.specification,\n                quantity: purchaseItem.quantity,\n                unit_price: purchaseItem.unit_price_value,\n                vendor_name: sysVendorName,\n                score,\n                match_reasons: matchReasons\n              });\n            }\n          }\n        }\n      }\n\n      // 2. +   (  ) - item_name AND specification  \n      if (item.extracted_item_name) {\n        const itemName = item.extracted_item_name.trim();\n        \n        //    (  )\n        const searchTermCandidates = [\n          itemName,                                              // \n          itemName.substring(0, Math.min(itemName.length, 12)),  // 12\n          itemName.substring(0, Math.min(itemName.length, 8)),   // 8\n          itemName.split(/\\[|]|\\s|_|-/)[0]                        //   ( )\n        ].filter(t => t && t.length >= 3);\n        \n        //  \n        const uniqueSearchTerms = [...new Set(searchTermCandidates)];\n        console.log(`   : ${uniqueSearchTerms.join(', ')}`);\n        \n        //     (  )\n        for (const searchTerm of uniqueSearchTerms) {\n          const { data: byNameOrSpec } = await this.supabase\n            .from('purchase_request_items')\n            .select(`\n              id, \n              item_name, \n              specification, \n              quantity, \n              unit_price_value,\n              purchase:purchase_requests!inner(\n                id, \n                purchase_order_number, \n                sales_order_number,\n                vendor:vendors(vendor_name)\n              )\n            `)\n            .or(`item_name.ilike.%${searchTerm}%,specification.ilike.%${searchTerm}%`)\n            .limit(50);\n          \n          if (byNameOrSpec && byNameOrSpec.length > 0) {\n            console.log(`  \"${searchTerm}\" ${byNameOrSpec.length}  `);\n            \n            for (const purchaseItem of byNameOrSpec) {\n              const key = `${purchaseItem.purchase?.id}-${purchaseItem.id}`;\n              \n              //      \n              if (candidateMap.has(key)) continue;\n              \n              //    -    \n              const sysVendorName = purchaseItem.purchase?.vendor?.vendor_name || '';\n              const vendorSimilarity = statementVendorName \n                ? this.calculateVendorSimilarity(statementVendorName, sysVendorName)\n                : 100; //    \n              \n              console.log(`  : OCR=\"${statementVendorName}\" vs =\"${sysVendorName}\"  =${vendorSimilarity}%`);\n              \n              //   50%   (  -   )\n              if (vendorSimilarity < 50) {\n                console.log(`   ${vendorSimilarity}% < 50% `);\n                continue;\n              }\n              \n              const matchReasons: string[] = [];\n              let score = 0;\n              \n              //    ( )\n              if (vendorSimilarity >= 90) {\n                score += 20;\n                matchReasons.push(' ');\n              } else if (vendorSimilarity >= 70) {\n                score += 10;\n                matchReasons.push(' ');\n              }\n              \n              //  OR    -   \n              const itemMatch = this.calculateItemMatchScore(\n                item.extracted_item_name, \n                purchaseItem.item_name, \n                purchaseItem.specification\n              );\n              if (itemMatch.score >= 30) { // 30%    ( )\n                score += itemMatch.score * 0.7; //  70 ( )\n                if (itemMatch.score >= 80) {\n                  matchReasons.push(itemMatch.matchedField === 'specification' ? ' ' : ' ');\n                } else if (itemMatch.score >= 50) {\n                  matchReasons.push(itemMatch.matchedField === 'specification' ? ' ' : ' ');\n                } else {\n                  matchReasons.push(' ');\n                }\n              }\n              \n              //  :  ,     (  )\n              if (item.extracted_quantity && purchaseItem.quantity) {\n                if (item.extracted_quantity === purchaseItem.quantity) {\n                  score += 15; //   \n                  matchReasons.push(`  (${item.extracted_quantity})`);\n                } else if (item.extracted_quantity <= purchaseItem.quantity) {\n                  //      -    \n                  score += 5;\n                  matchReasons.push(` (:${purchaseItem.quantity}, :${item.extracted_quantity})`);\n                }\n                //     0 ( )\n              }\n              \n              //    + OCR   \n              const sysPO = purchaseItem.purchase?.purchase_order_number || '';\n              const sysSO = purchaseItem.purchase?.sales_order_number || '';\n              if (normalizedNumber && sysPO !== normalizedNumber && sysSO !== normalizedNumber) {\n                matchReasons.push(` OCR  : ${normalizedNumber}  ${sysPO || sysSO}`);\n              }\n              \n              console.log(`  : score=${score}, =\"${purchaseItem.item_name}\", =\"${purchaseItem.specification}\", =\"${purchaseItem.purchase?.purchase_order_number}\"`);\n              \n              //  15    (   -   )\n              if (score >= 15) {\n                console.log(`  ! score=${score}`);\n                candidateMap.set(key, {\n                  purchase_id: purchaseItem.purchase?.id,\n                  purchase_order_number: sysPO,\n                  sales_order_number: sysSO,\n                  item_id: purchaseItem.id,\n                  item_name: purchaseItem.item_name,\n                  specification: purchaseItem.specification,\n                  quantity: purchaseItem.quantity,\n                  unit_price: purchaseItem.unit_price_value,\n                  vendor_name: purchaseItem.purchase?.vendor?.vendor_name,\n                  score,\n                  match_reasons: matchReasons\n                });\n              }\n            }\n            \n            //       \n            if (candidateMap.size >= 5) break;\n          }\n        }\n      }\n\n      // 3.   60%         (fallback)\n      // :   ,   (40 )  \n      const hasHighQualityCandidate = Array.from(candidateMap.values()).some(c => c.score >= 40);\n      const needsFallback = candidateMap.size === 0 || !hasHighQualityCandidate;\n      \n      if (needsFallback && statementVendorName) {\n        console.log(`    -  \"${statementVendorName}\"     ( : ${candidateMap.size}, : ${Math.max(...Array.from(candidateMap.values()).map(c => c.score), 0)})`);\n        \n        //  vendor_id \n        const { data: vendors } = await this.supabase\n          .from('vendors')\n          .select('id, vendor_name')\n          .limit(100);\n\n        if (vendors) {\n          //    \n          const matchedVendors = vendors.filter((v: { id: number; vendor_name: string }) => \n            this.calculateVendorSimilarity(statementVendorName, v.vendor_name) >= 70\n          );\n\n          if (matchedVendors.length > 0) {\n            const vendorIds = matchedVendors.map((v: { id: number; vendor_name: string }) => v.id);\n            \n            //    3  \n            const threeMonthsAgo = new Date();\n            threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);\n\n            const { data: recentPurchases } = await this.supabase\n              .from('purchase_requests')\n              .select(`\n                id, \n                purchase_order_number, \n                sales_order_number,\n                vendor:vendors(vendor_name),\n                items:purchase_request_items(id, item_name, specification, quantity, unit_price_value)\n              `)\n              .in('vendor_id', vendorIds)\n              .gte('created_at', threeMonthsAgo.toISOString())\n              .order('created_at', { ascending: false })\n              .limit(30);\n\n            if (recentPurchases) {\n              for (const purchase of recentPurchases) {\n                const sysVendorName = purchase.vendor?.vendor_name || '';\n                \n                for (const purchaseItem of purchase.items || []) {\n                  const key = `${purchase.id}-${purchaseItem.id}`;\n                  if (candidateMap.has(key)) continue;\n\n                  const matchReasons: string[] = [' '];\n                  let score = 20; //   \n                  \n                  //  OR  \n                  if (item.extracted_item_name) {\n                    const itemMatch = this.calculateItemMatchScore(\n                      item.extracted_item_name, \n                      purchaseItem.item_name, \n                      purchaseItem.specification\n                    );\n                    if (itemMatch.score >= 30) {\n                      score += itemMatch.score * 0.5;\n                      if (itemMatch.score >= 80) {\n                        matchReasons.push(itemMatch.matchedField === 'specification' ? ' ' : ' ');\n                      } else if (itemMatch.score >= 50) {\n                        matchReasons.push(itemMatch.matchedField === 'specification' ? ' ' : ' ');\n                      }\n                    }\n                  }\n                  \n                  //  :  ,    \n                  if (item.extracted_quantity && purchaseItem.quantity) {\n                    if (item.extracted_quantity === purchaseItem.quantity) {\n                      score += 15;\n                      matchReasons.push(`  (${item.extracted_quantity})`);\n                    } else if (item.extracted_quantity <= purchaseItem.quantity) {\n                      score += 5;\n                      matchReasons.push(` (:${purchaseItem.quantity}, :${item.extracted_quantity})`);\n                    }\n                  }\n                  \n                  // OCR   \n                  const sysPO = purchase.purchase_order_number || '';\n                  const sysSO = purchase.sales_order_number || '';\n                  if (normalizedNumber) {\n                    matchReasons.push(` OCR  : ${normalizedNumber}  ${sysPO || sysSO}`);\n                  }\n                  \n                  //  15    ( )\n                  if (score >= 15) {\n                    candidateMap.set(key, {\n                      purchase_id: purchase.id,\n                      purchase_order_number: sysPO,\n                      sales_order_number: sysSO,\n                      item_id: purchaseItem.id,\n                      item_name: purchaseItem.item_name,\n                      specification: purchaseItem.specification,\n                      quantity: purchaseItem.quantity,\n                      unit_price: purchaseItem.unit_price_value,\n                      vendor_name: sysVendorName,\n                      score,\n                      match_reasons: matchReasons\n                    });\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      //  \n      const candidates = Array.from(candidateMap.values());\n      candidates.sort((a, b) => b.score - a.score);\n\n      console.log(` findMatchCandidates : OCR=\"${item.extracted_item_name}\"  ${candidates.length}  `);\n      if (candidates.length > 0) {\n        console.log(`    : \"${candidates[0].item_name}\" (${candidates[0].purchase_order_number}) score=${candidates[0].score}`);\n      }\n\n      return candidates.slice(0, 15); //  15 \n    } catch (error) {\n      console.error('Find match candidates error:', error);\n      return [];\n    }\n  }\n  \n  /**\n   *    (0-100)\n   */\n  private calculateNameSimilarity(name1: string, name2: string): number {\n    const s1 = name1.toLowerCase().replace(/\\s+/g, '');\n    const s2 = name2.toLowerCase().replace(/\\s+/g, '');\n    \n    if (!s1 || !s2) return 0;\n    if (s1 === s2) return 100;\n    \n    //  \n    if (s1.includes(s2) || s2.includes(s1)) {\n      return 80;\n    }\n    \n    // Levenshtein distance  \n    const maxLen = Math.max(s1.length, s2.length);\n    const distance = this.levenshteinDistance(s1, s2);\n    const similarity = ((maxLen - distance) / maxLen) * 100;\n    \n    return Math.round(similarity);\n  }\n\n  /**\n   *     ( OR )\n   * OCR   item_name  specification \n   *     \n   */\n  private calculateItemMatchScore(\n    ocrItemName: string,\n    systemItemName: string,\n    systemSpecification?: string\n  ): { score: number; matchedField: 'item_name' | 'specification' | 'none' } {\n    if (!ocrItemName) {\n      return { score: 0, matchedField: 'none' };\n    }\n\n    //  \n    const itemNameScore = systemItemName \n      ? this.calculateNameSimilarity(ocrItemName, systemItemName) \n      : 0;\n    \n    //  \n    const specScore = systemSpecification \n      ? this.calculateNameSimilarity(ocrItemName, systemSpecification) \n      : 0;\n\n    //     \n    if (itemNameScore >= specScore) {\n      return { \n        score: itemNameScore, \n        matchedField: itemNameScore > 0 ? 'item_name' : 'none' \n      };\n    } else {\n      return { \n        score: specScore, \n        matchedField: specScore > 0 ? 'specification' : 'none' \n      };\n    }\n  }\n\n  /**\n   *    (0-100)\n   * - (), ,     \n   * - ,  \n   * -     \n   */\n  private calculateVendorSimilarity(vendor1: string, vendor2: string): number {\n    if (!vendor1 || !vendor2) return 0;\n    \n    // :  / \n    const normalize = (name: string) => {\n      return name\n        .toLowerCase()\n        .replace(/\\(\\)|||\\)||co\\.|co,|ltd\\.|ltd|inc\\.|inc|corp\\.|corp|company|/gi, '')\n        .replace(/[^a-z0-9-]/g, '') // ,  \n        .trim();\n    };\n\n    const n1 = normalize(vendor1);\n    const n2 = normalize(vendor2);\n\n    if (!n1 || !n2) return 0;\n    if (n1 === n2) return 100;\n\n    //  \n    if (n1.includes(n2) || n2.includes(n1)) {\n      return 90;\n    }\n\n    //     \n    const translitMap: Record<string, string[]> = {\n      'yg': ['', 'yg'],\n      '': ['yg', ''],\n      'tech': ['', '', 'tech'],\n      '': ['tech', '', ''],\n      '': ['tech', '', ''],\n      'high': ['', 'high'],\n      '': ['high', ''],\n      'korea': ['', '', 'korea'],\n      '': ['korea', '', ''],\n      'electric': ['', '', 'electric'],\n      '': ['electric', '', ''],\n      'steel': ['', '', 'steel'],\n      '': ['steel', '', ''],\n      'metal': ['', '', 'metal'],\n      '': ['metal', '', ''],\n      'system': ['', 'system'],\n      '': ['system', ''],\n      'soft': ['', 'soft'],\n      '': ['soft', ''],\n      'net': ['', 'net'],\n      '': ['net', ''],\n      'global': ['', 'global'],\n      '': ['global', ''],\n      'trade': ['', '', 'trade'],\n      '': ['trade', '', ''],\n      'international': ['', 'international'],\n      '': ['international', ''],\n    };\n\n    //    \n    let n1Replaced = n1;\n    let n2Replaced = n2;\n    \n    for (const [key, values] of Object.entries(translitMap)) {\n      if (n1.includes(key)) {\n        for (const val of values) {\n          n1Replaced = n1Replaced.replace(key, val);\n          if (n1Replaced === n2 || n2.includes(n1Replaced) || n1Replaced.includes(n2)) {\n            return 85;\n          }\n        }\n        n1Replaced = n1; // \n      }\n      if (n2.includes(key)) {\n        for (const val of values) {\n          n2Replaced = n2Replaced.replace(key, val);\n          if (n1 === n2Replaced || n1.includes(n2Replaced) || n2Replaced.includes(n1)) {\n            return 85;\n          }\n        }\n        n2Replaced = n2; // \n      }\n    }\n\n    // Levenshtein   \n    const maxLen = Math.max(n1.length, n2.length);\n    const distance = this.levenshteinDistance(n1, n2);\n    const similarity = ((maxLen - distance) / maxLen) * 100;\n\n    return Math.round(similarity);\n  }\n\n  /**\n   *     (70%    )\n   */\n  isVendorMatch(vendor1: string, vendor2: string, threshold: number = 70): boolean {\n    return this.calculateVendorSimilarity(vendor1, vendor2) >= threshold;\n  }\n  \n  /**\n   * Levenshtein  \n   */\n  private levenshteinDistance(s1: string, s2: string): number {\n    const m = s1.length;\n    const n = s2.length;\n    const dp: number[][] = Array(m + 1).fill(null).map(() => Array(n + 1).fill(0));\n    \n    for (let i = 0; i <= m; i++) dp[i][0] = i;\n    for (let j = 0; j <= n; j++) dp[0][j] = j;\n    \n    for (let i = 1; i <= m; i++) {\n      for (let j = 1; j <= n; j++) {\n        if (s1[i - 1] === s2[j - 1]) {\n          dp[i][j] = dp[i - 1][j - 1];\n        } else {\n          dp[i][j] = Math.min(dp[i - 1][j - 1], dp[i - 1][j], dp[i][j - 1]) + 1;\n        }\n      }\n    }\n    \n    return dp[m][n];\n  }\n\n  /**\n   *    - /   \n   */\n  private calculateSimilarityScore(\n    extractedItem: TransactionStatementItem,\n    purchaseItem: any\n  ): number {\n    let score = 0;\n\n    //   ( 40) - item_name specification      \n    if (extractedItem.extracted_item_name) {\n      const itemMatch = this.calculateItemMatchScore(\n        extractedItem.extracted_item_name,\n        purchaseItem.item_name || '',\n        purchaseItem.specification || ''\n      );\n      score += itemMatch.score * 0.4; //  40\n    }\n\n    // OCR     ( 20)\n    if (extractedItem.extracted_specification) {\n      const specMatch = this.calculateItemMatchScore(\n        extractedItem.extracted_specification,\n        purchaseItem.item_name || '',\n        purchaseItem.specification || ''\n      );\n      score += specMatch.score * 0.2; //  20\n    }\n\n    //   ( 20)\n    if (extractedItem.extracted_quantity && purchaseItem.quantity) {\n      const diff = Math.abs(extractedItem.extracted_quantity - purchaseItem.quantity);\n      if (diff === 0) {\n        score += 20;\n      } else if (diff <= purchaseItem.quantity * 0.1) {\n        score += 15;\n      } else if (diff <= purchaseItem.quantity * 0.2) {\n        score += 10;\n      }\n    }\n\n    //   ( 20)\n    if (extractedItem.extracted_unit_price && purchaseItem.unit_price_value) {\n      const diff = Math.abs(extractedItem.extracted_unit_price - purchaseItem.unit_price_value);\n      if (diff === 0) {\n        score += 20;\n      } else if (diff <= purchaseItem.unit_price_value * 0.05) {\n        score += 15;\n      } else if (diff <= purchaseItem.unit_price_value * 0.1) {\n        score += 10;\n      }\n    }\n\n    return score;\n  }\n\n  /**\n   *    - /   \n   */\n  private getMatchReasons(\n    extractedItem: TransactionStatementItem,\n    purchaseItem: any,\n    score: number\n  ): string[] {\n    const reasons: string[] = [];\n\n    //    (item_name specification  )\n    if (extractedItem.extracted_item_name) {\n      const itemMatch = this.calculateItemMatchScore(\n        extractedItem.extracted_item_name,\n        purchaseItem.item_name || '',\n        purchaseItem.specification || ''\n      );\n      \n      if (itemMatch.score >= 90) {\n        reasons.push(itemMatch.matchedField === 'specification' ? '  ' : '  ');\n      } else if (itemMatch.score >= 70) {\n        reasons.push(itemMatch.matchedField === 'specification' ? '  ' : '  ');\n      } else if (itemMatch.score >= 50) {\n        reasons.push(itemMatch.matchedField === 'specification' ? '  ' : '  ');\n      }\n    }\n\n    //   \n    if (extractedItem.extracted_quantity && purchaseItem.quantity) {\n      if (extractedItem.extracted_quantity === purchaseItem.quantity) {\n        reasons.push(`  (${extractedItem.extracted_quantity})`);\n      } else if (extractedItem.extracted_quantity <= purchaseItem.quantity) {\n        reasons.push(` (:${purchaseItem.quantity}, :${extractedItem.extracted_quantity})`);\n      }\n    }\n\n    if (extractedItem.extracted_unit_price === purchaseItem.unit_price_value) {\n      reasons.push(' ');\n    }\n\n    if (score >= 70) {\n      reasons.push(' ');\n    } else if (score >= 50) {\n      reasons.push(' ');\n    }\n\n    return reasons;\n  }\n\n  /**\n   *   \n   */\n  async updateItemMatch(\n    itemId: string,\n    matchedPurchaseId: number | null,\n    matchedItemId: number | null,\n    matchMethod: 'po_number' | 'item_similarity' | 'manual' = 'manual'\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const { error } = await this.supabase\n        .from('transaction_statement_items')\n        .update({\n          matched_purchase_id: matchedPurchaseId,\n          matched_item_id: matchedItemId,\n          match_method: matchMethod\n        })\n        .eq('id', itemId);\n\n      if (error) throw error;\n\n      return { success: true };\n    } catch (error) {\n      console.error('Update item match error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '    .'\n      };\n    }\n  }\n\n  /**\n   *  \n   */\n  async confirmStatement(\n    request: ConfirmStatementRequest,\n    confirmerName: string\n  ): Promise<{ success: boolean; error?: string }> {\n    try {\n      const { data: { user } } = await this.supabase.auth.getUser();\n\n      // 1.   \n      for (const item of request.items) {\n        //    \n        const { error: itemError } = await this.supabase\n          .from('transaction_statement_items')\n          .update({\n            is_confirmed: true,\n            matched_purchase_id: item.matched_purchase_id,\n            matched_item_id: item.matched_item_id,\n            confirmed_quantity: item.confirmed_quantity,\n            confirmed_unit_price: item.confirmed_unit_price,\n            confirmed_amount: item.confirmed_amount,\n            is_additional_item: item.is_additional_item || false,\n            parent_item_id: item.parent_item_id\n          })\n          .eq('id', item.itemId);\n\n        if (itemError) throw itemError;\n\n        // 2.   / \n        if (item.matched_item_id && item.confirmed_unit_price !== undefined) {\n          const { error: purchaseError } = await this.supabase\n            .from('purchase_request_items')\n            .update({\n              unit_price_value: item.confirmed_unit_price,\n              amount_value: item.confirmed_amount\n            })\n            .eq('id', item.matched_item_id);\n\n          if (purchaseError) {\n            console.warn('Failed to update purchase item:', purchaseError);\n          }\n        }\n\n        // 3.    (  )\n        if (item.is_additional_item && item.matched_purchase_id && !item.matched_item_id) {\n          const statementItem = await this.getStatementItem(item.itemId);\n          if (statementItem) {\n            const { error: insertError } = await this.supabase\n              .from('purchase_request_items')\n              .insert({\n                purchase_request_id: item.matched_purchase_id,\n                item_name: statementItem.extracted_item_name || ' ',\n                specification: statementItem.extracted_specification,\n                quantity: item.confirmed_quantity || statementItem.extracted_quantity || 1,\n                unit_price_value: item.confirmed_unit_price || statementItem.extracted_unit_price,\n                amount_value: item.confirmed_amount || statementItem.extracted_amount,\n                remark: ' '\n              });\n\n            if (insertError) {\n              console.warn('Failed to insert additional item:', insertError);\n            }\n          }\n        }\n      }\n\n      // 4.   confirmed \n      const { error: stmtError } = await this.supabase\n        .from('transaction_statements')\n        .update({\n          status: 'confirmed',\n          confirmed_at: new Date().toISOString(),\n          confirmed_by: user?.id,\n          confirmed_by_name: confirmerName\n        })\n        .eq('id', request.statementId);\n\n      if (stmtError) throw stmtError;\n\n      return { success: true };\n    } catch (error) {\n      console.error('Confirm statement error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '   .'\n      };\n    }\n  }\n\n  /**\n   *   \n   */\n  private async getStatementItem(itemId: string): Promise<TransactionStatementItem | null> {\n    const { data } = await this.supabase\n      .from('transaction_statement_items')\n      .select('*')\n      .eq('id', itemId)\n      .single();\n    \n    return data;\n  }\n\n  /**\n   *  \n   */\n  async rejectStatement(statementId: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      const { error } = await this.supabase\n        .from('transaction_statements')\n        .update({ status: 'rejected' })\n        .eq('id', statementId);\n\n      if (error) throw error;\n\n      return { success: true };\n    } catch (error) {\n      console.error('Reject statement error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '    .'\n      };\n    }\n  }\n\n  /**\n   *  \n   */\n  async deleteStatement(statementId: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      //  URL \n      const { data: statement } = await this.supabase\n        .from('transaction_statements')\n        .select('image_url')\n        .eq('id', statementId)\n        .single();\n\n      // DB  (cascade   )\n      const { error } = await this.supabase\n        .from('transaction_statements')\n        .delete()\n        .eq('id', statementId);\n\n      if (error) throw error;\n\n      // Storage   \n      if (statement?.image_url) {\n        try {\n          const path = statement.image_url.split('/receipt-images/')[1];\n          if (path) {\n            await this.supabase.storage.from('receipt-images').remove([path]);\n          }\n        } catch (e) {\n          console.warn('Failed to delete storage file:', e);\n        }\n      }\n\n      return { success: true };\n    } catch (error) {\n      console.error('Delete statement error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '   .'\n      };\n    }\n  }\n\n  /**\n   *   -        \n   * Case 1:      \n   * \n   * :\n   * 1. OCR  /   ( )\n   * 2.     \n   * 3.       \n   */\n  async findBestMatchingPurchaseOrderSet(\n    extractedItems: TransactionStatementItem[],\n    extractedPONumber?: string,\n    statementVendorName?: string\n  ): Promise<{\n    success: boolean;\n    data?: {\n      bestMatch: {\n        purchase_id: number;\n        purchase_order_number: string;\n        sales_order_number?: string;\n        vendor_name?: string;\n        matchScore: number;        // 0-100   \n        matchedItemCount: number;  //   \n        totalItemCount: number;    //   \n        confidence: 'high' | 'medium' | 'low';\n        itemMatches: Array<{\n          ocrItemId: string;\n          systemItemId: number;\n          systemItemName: string;\n          similarity: number;\n        }>;\n      } | null;\n      candidates: Array<{\n        purchase_id: number;\n        purchase_order_number: string;\n        sales_order_number?: string;\n        vendor_name?: string;\n        matchScore: number;\n        matchedItemCount: number;\n      }>;\n    };\n    error?: string;\n  }> {\n    try {\n      const normalizedNumber = extractedPONumber \n        ? normalizeOrderNumber(extractedPONumber) \n        : '';\n\n      const purchaseScores: Array<{\n        purchase_id: number;\n        purchase_order_number: string;\n        sales_order_number?: string;\n        vendor_name?: string;\n        matchScore: number;\n        matchedItemCount: number;\n        totalItemCount: number;\n        items: any[];\n        itemMatches: Array<{\n          ocrItemId: string;\n          systemItemId: number;\n          systemItemName: string;\n          similarity: number;\n        }>;\n      }> = [];\n\n      // 1. OCR     ( )\n      if (normalizedNumber) {\n        const { data: byNumber } = await this.supabase\n          .from('purchase_requests')\n          .select(`\n            id, \n            purchase_order_number, \n            sales_order_number,\n            vendor:vendors(vendor_name),\n            items:purchase_request_items(id, item_name, specification, quantity, unit_price_value)\n          `)\n          .or(`purchase_order_number.eq.${normalizedNumber},sales_order_number.eq.${normalizedNumber}`)\n          .limit(5);\n\n        if (byNumber && byNumber.length > 0) {\n          for (const purchase of byNumber) {\n            //   \n            const sysVendorName = purchase.vendor?.vendor_name || '';\n            const vendorSimilarity = statementVendorName \n              ? this.calculateVendorSimilarity(statementVendorName, sysVendorName)\n              : 100;\n            \n            //   70%   (   )\n            if (vendorSimilarity < 50) {\n              console.log(`   -   : \"${statementVendorName}\" vs \"${sysVendorName}\" (${vendorSimilarity}%)`);\n              continue;\n            }\n            \n            const setScore = this.calculateSetMatchScore(extractedItems, purchase.items || []);\n            purchaseScores.push({\n              purchase_id: purchase.id,\n              purchase_order_number: purchase.purchase_order_number || '',\n              sales_order_number: purchase.sales_order_number,\n              vendor_name: sysVendorName,\n              matchScore: setScore.score,\n              matchedItemCount: setScore.matchedCount,\n              totalItemCount: extractedItems.length,\n              items: purchase.items || [],\n              itemMatches: setScore.itemMatches\n            });\n          }\n        }\n      }\n\n      // 2.       \n      const bestByNumber = purchaseScores.length > 0 \n        ? purchaseScores.reduce((a, b) => a.matchScore > b.matchScore ? a : b)\n        : null;\n\n      // 3.    80%    ( )\n      if (bestByNumber && bestByNumber.matchScore >= 80) {\n        return {\n          success: true,\n          data: {\n            bestMatch: {\n              ...bestByNumber,\n              confidence: 'high'\n            },\n            candidates: purchaseScores.map(p => ({\n              purchase_id: p.purchase_id,\n              purchase_order_number: p.purchase_order_number,\n              sales_order_number: p.sales_order_number,\n              vendor_name: p.vendor_name,\n              matchScore: p.matchScore,\n              matchedItemCount: p.matchedItemCount\n            }))\n          }\n        };\n      }\n\n      // 4.          \n      //  3       \n      const threeMonthsAgo = new Date();\n      threeMonthsAgo.setMonth(threeMonthsAgo.getMonth() - 3);\n\n      const { data: recentPurchases } = await this.supabase\n        .from('purchase_requests')\n        .select(`\n          id, \n          purchase_order_number, \n          sales_order_number,\n          vendor:vendors(vendor_name),\n          items:purchase_request_items(id, item_name, specification, quantity, unit_price_value)\n        `)\n        .gte('created_at', threeMonthsAgo.toISOString())\n        .order('created_at', { ascending: false })\n        .limit(100);\n\n      if (recentPurchases) {\n        for (const purchase of recentPurchases) {\n          //     \n          if (purchaseScores.some(p => p.purchase_id === purchase.id)) continue;\n\n          //    -    \n          const sysVendorName = purchase.vendor?.vendor_name || '';\n          const vendorSimilarity = statementVendorName \n            ? this.calculateVendorSimilarity(statementVendorName, sysVendorName)\n            : 100;\n          \n          //   70%   (   )\n          if (vendorSimilarity < 50) {\n            continue;\n          }\n\n          const setScore = this.calculateSetMatchScore(extractedItems, purchase.items || []);\n          \n          // 30   \n          if (setScore.score >= 30) {\n            purchaseScores.push({\n              purchase_id: purchase.id,\n              purchase_order_number: purchase.purchase_order_number || '',\n              sales_order_number: purchase.sales_order_number,\n              vendor_name: sysVendorName,\n              matchScore: setScore.score,\n              matchedItemCount: setScore.matchedCount,\n              totalItemCount: extractedItems.length,\n              items: purchase.items || [],\n              itemMatches: setScore.itemMatches\n            });\n          }\n        }\n      }\n\n      // 5.  \n      purchaseScores.sort((a, b) => b.matchScore - a.matchScore);\n\n      const bestMatch = purchaseScores.length > 0 ? purchaseScores[0] : null;\n\n      return {\n        success: true,\n        data: {\n          bestMatch: bestMatch ? {\n            ...bestMatch,\n            confidence: bestMatch.matchScore >= 80 ? 'high' \n              : bestMatch.matchScore >= 50 ? 'medium' \n              : 'low'\n          } : null,\n          candidates: purchaseScores.slice(0, 10).map(p => ({\n            purchase_id: p.purchase_id,\n            purchase_order_number: p.purchase_order_number,\n            sales_order_number: p.sales_order_number,\n            vendor_name: p.vendor_name,\n            matchScore: p.matchScore,\n            matchedItemCount: p.matchedItemCount\n          }))\n        }\n      };\n    } catch (error) {\n      console.error('Find best matching PO set error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '    .'\n      };\n    }\n  }\n\n  /**\n   *    \n   *      1:1   \n   */\n  private calculateSetMatchScore(\n    ocrItems: TransactionStatementItem[],\n    systemItems: any[]\n  ): { \n    score: number; \n    matchedCount: number;\n    itemMatches: Array<{\n      ocrItemId: string;\n      systemItemId: number;\n      systemItemName: string;\n      similarity: number;\n    }>;\n  } {\n    if (ocrItems.length === 0 || systemItems.length === 0) {\n      return { score: 0, matchedCount: 0, itemMatches: [] };\n    }\n\n    const itemMatches: Array<{\n      ocrItemId: string;\n      systemItemId: number;\n      systemItemName: string;\n      similarity: number;\n    }> = [];\n\n    //  OCR       \n    const usedSystemItems = new Set<number>();\n    let totalSimilarity = 0;\n\n    for (const ocrItem of ocrItems) {\n      let bestMatch: { id: number; name: string; similarity: number } | null = null;\n\n      for (const sysItem of systemItems) {\n        //     \n        if (usedSystemItems.has(sysItem.id)) continue;\n\n        //  OR   (  )\n        const itemMatch = this.calculateItemMatchScore(\n          ocrItem.extracted_item_name || '',\n          sysItem.item_name || '',\n          sysItem.specification || ''\n        );\n\n        //  :  ,    \n        let quantityBonus = 0;\n        if (ocrItem.extracted_quantity && sysItem.quantity) {\n          if (ocrItem.extracted_quantity === sysItem.quantity) {\n            quantityBonus = 15; //   \n          } else if (ocrItem.extracted_quantity <= sysItem.quantity) {\n            quantityBonus = 5; //       \n          }\n        }\n        const totalScore = itemMatch.score + quantityBonus;\n\n        if (!bestMatch || totalScore > bestMatch.similarity) {\n          bestMatch = {\n            id: sysItem.id,\n            name: sysItem.item_name,\n            similarity: totalScore\n          };\n        }\n      }\n\n      //  40   \n      if (bestMatch && bestMatch.similarity >= 40) {\n        usedSystemItems.add(bestMatch.id);\n        totalSimilarity += bestMatch.similarity;\n        itemMatches.push({\n          ocrItemId: ocrItem.id,\n          systemItemId: bestMatch.id,\n          systemItemName: bestMatch.name,\n          similarity: bestMatch.similarity\n        });\n      }\n    }\n\n    //    \n    // -    (50%)\n    // -   (50%)\n    const matchRatio = itemMatches.length / ocrItems.length;\n    const avgSimilarity = itemMatches.length > 0 \n      ? totalSimilarity / itemMatches.length \n      : 0;\n    \n    const score = Math.round((matchRatio * 50) + (avgSimilarity * 0.5));\n\n    return {\n      score: Math.min(100, score),\n      matchedCount: itemMatches.length,\n      itemMatches\n    };\n  }\n\n  /**\n   * OCR   \n   */\n  async saveCorrection(request: SaveCorrectionRequest): Promise<{ success: boolean; error?: string }> {\n    try {\n      const { data: { user } } = await this.supabase.auth.getUser();\n      \n      //   \n      const { error } = await this.supabase\n        .from('ocr_corrections')\n        .insert({\n          statement_id: request.statement_id,\n          statement_item_id: request.statement_item_id,\n          original_text: request.original_text,\n          corrected_text: request.corrected_text,\n          field_type: request.field_type,\n          corrected_by: user?.id\n        });\n\n      if (error) throw error;\n\n      return { success: true };\n    } catch (error) {\n      console.error('Save correction error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '     .'\n      };\n    }\n  }\n\n  /**\n   *      \n   */\n  async getStatementsByPurchaseId(purchaseId: number): Promise<{\n    success: boolean;\n    data?: TransactionStatement[];\n    error?: string;\n  }> {\n    try {\n      //       \n      const { data: items } = await this.supabase\n        .from('transaction_statement_items')\n        .select('statement_id')\n        .eq('matched_purchase_id', purchaseId);\n\n      if (!items || items.length === 0) {\n        return { success: true, data: [] };\n      }\n\n      const statementIds = [...new Set(items.map((i: { statement_id: string }) => i.statement_id))];\n\n      const { data: statements, error } = await this.supabase\n        .from('transaction_statements')\n        .select('*')\n        .in('id', statementIds)\n        .order('uploaded_at', { ascending: false });\n\n      if (error) throw error;\n\n      return { success: true, data: statements || [] };\n    } catch (error) {\n      console.error('Get statements by purchase error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : '   .'\n      };\n    }\n  }\n}\n\nexport const transactionStatementService = new TransactionStatementService();\nexport default transactionStatementService;\n\n","import { useEffect, useState, useRef, useCallback, useMemo, memo, type CSSProperties } from 'react'\nimport { DndContext, closestCenter, PointerSensor, useSensor, useSensors, type DragEndEvent } from '@dnd-kit/core'\nimport { SortableContext, verticalListSortingStrategy, useSortable, arrayMove } from '@dnd-kit/sortable'\nimport { CSS } from '@dnd-kit/utilities'\nimport { createClient } from '@/lib/supabase/client'\nimport { PurchaseRequestWithDetails, Purchase, Vendor } from '@/types/purchase'\nimport { findPurchaseInMemory, markItemAsPaymentCompleted, markPurchaseAsPaymentCompleted, markItemAsReceived, markPurchaseAsReceived, markItemAsPaymentCanceled, markItemAsStatementReceived, markItemAsStatementCanceled, usePurchaseMemory, updatePurchaseInMemory, removeItemFromMemory, markItemAsExpenditureSet, markBulkExpenditureSet, removePurchaseFromMemory, addCacheListener } from '@/stores/purchaseMemoryStore'\nimport { formatDate, dateToISOString } from '@/utils/helpers'\nimport { DatePickerPopover } from '@/components/ui/date-picker-popover'\nimport { DateAmountPickerPopover } from '@/components/ui/date-amount-picker-popover'\nimport { DateQuantityPickerPopover } from '@/components/ui/date-quantity-picker-popover'\nimport { \n  Calendar, \n  User, \n  Building2, \n  Package, \n  CreditCard,\n  X,\n  FileText,\n  DollarSign,\n  Edit2,\n  Trash2,\n  Save,\n  Plus,\n  CheckCircle,\n  XCircle,\n  Check,\n  Truck,\n  MessageSquarePlus,\n  Loader2,\n  GripVertical,\n  Image as ImageIcon,\n  FileCheck\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\nimport { Label } from '@/components/ui/label'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { toast } from 'sonner'\nimport { logger } from '@/lib/logger'\nimport { useConfirmDateAction } from '@/hooks/useConfirmDateAction'\nimport { format as formatDateInput } from 'date-fns'\nimport { AUTHORIZED_ROLES } from '@/constants/columnSettings'\nimport ReactSelect from 'react-select'\nimport transactionStatementService from '@/services/transactionStatementService'\nimport type { TransactionStatement } from '@/types/transactionStatement'\n\ninterface PurchaseDetailModalProps {\n  purchaseId: number | null\n  isOpen: boolean\n  onClose: () => void\n  embedded?: boolean  // Dialog   \n  currentUserRoles?: string[]\n  activeTab?: string\n  onRefresh?: (forceRefresh?: boolean, options?: { silent?: boolean }) => void | Promise<void>\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void\n  onDelete?: (purchase: PurchaseRequestWithDetails) => void\n}\n\ntype SortableRenderProps = {\n  setNodeRef: (element: HTMLElement | null) => void\n  style: CSSProperties\n  attributes: any\n  listeners: any\n  isDragging: boolean\n}\n\ntype SortableRowProps = {\n  id: string\n  children: (props: SortableRenderProps) => React.ReactNode\n}\n\n//  SortableRow        (  )\nconst SortableRow = ({ id, children }: SortableRowProps) => {\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id })\n  const style: CSSProperties = {\n    transform: CSS.Transform.toString(transform),\n    transition\n  }\n  return <>{children({ setNodeRef, attributes, listeners, isDragging, style })}</>\n}\n\nfunction PurchaseDetailModal({ \n  purchaseId, \n  isOpen, \n  onClose, \n  embedded = false,\n  currentUserRoles = [],\n  activeTab,\n  onRefresh,\n  onOptimisticUpdate,\n  onDelete\n}: PurchaseDetailModalProps) {\n  const { allPurchases, lastFetch } = usePurchaseMemory(); //     \n  \n  const [loading, setLoading] = useState(false)\n  const [purchase, setPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [isEditing, setIsEditing] = useState(false)\n  const [editedPurchase, setEditedPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [editedItems, setEditedItems] = useState<any[]>([])\n  const [deletedItemIds, setDeletedItemIds] = useState<number[]>([])\n  const [userRoles, setUserRoles] = useState<string[]>([])\n  const [currentUserName, setCurrentUserName] = useState<string>('')\n  const [columnWidths, setColumnWidths] = useState<number[]>([])\n  const [focusedInput, setFocusedInput] = useState<string | null>(null)\n  const [vendors, setVendors] = useState<Vendor[]>([])\n  const [vendorSearchTerm, setVendorSearchTerm] = useState('')\n  \n  //   \n  const [isModifyRequestOpen, setIsModifyRequestOpen] = useState(false)\n  const [modifySubject, setModifySubject] = useState('')\n  const [modifyMessage, setModifyMessage] = useState('')\n  const [isSendingModify, setIsSendingModify] = useState(false)\n  \n  //   \n  const [isSaving, setIsSaving] = useState(false)\n\n  //   \n  const [linkedStatements, setLinkedStatements] = useState<TransactionStatement[]>([])\n  const [isStatementViewerOpen, setIsStatementViewerOpen] = useState(false)\n  const [selectedStatementImage, setSelectedStatementImage] = useState<string>('')\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, { activationConstraint: { distance: 4 } })\n  )\n\n  const makeStableKey = useCallback((item: any, idx: number) => {\n    // stableKey    \n    if (item?.stableKey) return item.stableKey\n    \n    // id  id   key \n    if (item?.id != null) return `sk-item-${item.id}`\n    \n    // tempId  tempId   key \n    if (item?.tempId) return `sk-tmp-${item.tempId}`\n    \n    // line_number idx   key  ( line_number idx   key)\n    if (item?.line_number != null) return `sk-line-${item.line_number}-${idx}`\n    \n    //  idx  (  )\n    return `sk-idx-${idx}`\n  }, [])\n\n  const normalizeItems = useCallback((items: any[] = []) => {\n    return items.map((item, idx) => {\n      const withTemp = {\n        ...item,\n        tempId: item?.tempId ?? `tmp-${item?.id ?? item?.line_number ?? idx}-${idx}`\n      }\n      return {\n        ...withTemp,\n        stableKey: makeStableKey(withTemp, idx)\n      }\n    })\n  }, [makeStableKey])\n\n  const getSortableId = useCallback((item: any, index: number) => {\n    // stableKey    \n    if (item?.stableKey) return item.stableKey\n    \n    // id  id   key \n    if (item?.id != null) return `item-${item.id}`\n    \n    // tempId  tempId   key \n    if (item?.tempId) return `tmp-${item.tempId}`\n    \n    // line_number index   key  ( line_number index   key)\n    if (item?.line_number != null) return `line-${item.line_number}-${index}`\n    \n    //  index \n    return `temp-${index}`\n  }, [])\n\n  const handleDragEnd = useCallback((event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over || active.id === over.id) return\n\n    setEditedItems(prev => {\n      const oldIndex = prev.findIndex((item, index) => getSortableId(item, index) === active.id)\n      const newIndex = prev.findIndex((item, index) => getSortableId(item, index) === over.id)\n      if (oldIndex === -1 || newIndex === -1) return prev\n\n      const reordered = arrayMove(prev, oldIndex, newIndex).map((item, idx) => ({\n        ...item,\n        line_number: idx + 1,\n        stableKey: item.stableKey ?? makeStableKey(item, idx)\n      }))\n      return reordered\n    })\n  }, [getSortableId, makeStableKey])\n\n  //   \n  useEffect(() => {\n    if (isModifyRequestOpen && purchase) {\n      setModifySubject(`[]  ${purchase.purchase_order_number}  .`)\n      setModifyMessage('') //    \n    }\n  }, [isModifyRequestOpen, purchase])\n\n  //  \n  const handleSendModifyRequest = async () => {\n    if (!modifySubject.trim() || !modifyMessage.trim()) {\n      toast.error('   .')\n      return\n    }\n\n    setIsSendingModify(true)\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      \n      if (!user) {\n        toast.error(' .')\n        return\n      }\n\n      const { data: createdInquiry, error } = await supabase\n        .from('support_inquires')\n        .insert({\n          user_id: user.id,\n          user_email: user.email,\n          user_name: currentUserName,\n          inquiry_type: 'modify',\n          subject: modifySubject,\n          message: modifyMessage,\n          status: 'open',\n          purchase_request_id: purchase?.id,\n          purchase_order_number: purchase?.purchase_order_number,\n          requester_id: purchase?.requester_id,\n          purchase_info: JSON.stringify({\n            vendor_name: purchase?.vendor_name,\n            total_amount: purchase?.total_amount,\n            item_count: purchase?.purchase_request_items?.length || 0\n          })\n        })\n        .select('id')\n        .single()\n\n      if (error) throw error\n\n      //       (  / )\n      const inquiryId = createdInquiry?.id\n      if (inquiryId) {\n        const { error: msgError } = await supabase\n          .from('support_inquiry_messages')\n          .insert({\n            inquiry_id: inquiryId,\n            sender_role: 'user',\n            sender_email: user.email,\n            message: modifyMessage,\n            attachments: []\n          })\n        if (msgError) throw msgError\n      }\n\n      toast.success('  .')\n      setIsModifyRequestOpen(false)\n      setModifySubject('')\n      setModifyMessage('')\n    } catch (error) {\n      logger.error('   ', error)\n      toast.error('     .')\n    } finally {\n      setIsSendingModify(false)\n    }\n  }\n\n  //    useEffect \n\n  //  isEditing  ref  (    )\n  const isEditingRef = useRef(isEditing)\n  useEffect(() => {\n    isEditingRef.current = isEditing\n  }, [isEditing])\n  \n  //  isSaving  ref  (  refresh    )\n  const isSavingRef = useRef(isSaving)\n  useEffect(() => {\n    isSavingRef.current = isSaving\n  }, [isSaving])\n  \n  //   (Realtime/   )  \n  const lastSaveAtRef = useRef<number>(0)\n  //     /( 1    ) \n  const lastAddItemAtRef = useRef<number>(0)\n\n  //  Realtime   -         \n  const realtimeFirstMount = useRef(true)\n  const isUpdatingRef = useRef(false)  //     (  )\n  useEffect(() => {\n    if (!isOpen || !purchaseId) return\n\n    const handleCacheUpdate = () => {\n      if (realtimeFirstMount.current) {\n        realtimeFirstMount.current = false\n        return\n      }\n      //        (  )\n      if (isEditingRef.current) {\n        return\n      }\n      //          ( 0   )\n      if (isSavingRef.current) {\n        return\n      }\n      if (lastSaveAtRef.current && Date.now() - lastSaveAtRef.current < 30000) {\n        logger.debug('[PurchaseDetailModal]  (30s) - Realtime   ')\n        return\n      }\n      //      (  )\n      if (isUpdatingRef.current) {\n        logger.debug('[PurchaseDetailModal]    - Realtime  ')\n        return\n      }\n      //       \n      const updatedPurchase = findPurchaseInMemory(purchaseId)\n      if (updatedPurchase) {\n        //   :   items   items \n        const cacheItems = updatedPurchase.items || updatedPurchase.purchase_request_items || []\n        \n        setPurchase(prev => {\n          //  items \n          const currentItems = prev?.items || prev?.purchase_request_items || []\n          \n          //  items   items   items \n          const preservedItems = (cacheItems.length === 0 && currentItems.length > 0) \n            ? currentItems \n            : cacheItems\n          \n          //  items     \n          if (cacheItems.length === 0 && currentItems.length === 0 && prev) {\n            logger.debug('[PurchaseDetailModal] / items   -  ')\n            return prev\n          }\n          \n          return {\n            ...updatedPurchase,\n            id: String(updatedPurchase.id),\n            is_po_generated: false,\n            items: preservedItems,\n            purchase_request_items: preservedItems\n          } as PurchaseRequestWithDetails\n        })\n      }\n    }\n\n    const unsubscribe = addCacheListener(handleCacheUpdate)\n    return () => unsubscribe()\n  }, [isOpen, purchaseId])\n\n  //   items  ( purchase state  )\n  const currentItems = useMemo(() => {\n    // purchase state   (   )\n    if (purchase?.items && purchase.items.length > 0) {\n      return normalizeItems(purchase.items);\n    }\n    if (purchase?.purchase_request_items && purchase.purchase_request_items.length > 0) {\n      return normalizeItems(purchase.purchase_request_items);\n    }\n    \n    // purchase state    \n    if (purchaseId && allPurchases) {\n      const memoryPurchase = allPurchases.find(p => p.id === purchaseId);\n      if (memoryPurchase) {\n        const memoryItems = (memoryPurchase.items && memoryPurchase.items.length > 0)\n          ? memoryPurchase.items\n          : (memoryPurchase.purchase_request_items || []);\n        return normalizeItems(memoryItems);\n      }\n    }\n    \n    return [];\n  }, [purchase, purchaseId, allPurchases, lastFetch, normalizeItems]); // purchase       \n\n  //   :      ,   line_number \n  const displayItems = useMemo(() => {\n    if (isEditing) return editedItems || []\n    const base = currentItems || []\n    return [...base].sort((a, b) => {\n      const la = a?.line_number ?? 999999\n      const lb = b?.line_number ?? 999999\n      if (la !== lb) return la - lb\n      // tie-breakers to keep stable order\n      const ca = a?.created_at ? new Date(a.created_at).getTime() : 0\n      const cb = b?.created_at ? new Date(b.created_at).getTime() : 0\n      if (ca !== cb) return ca - cb\n      const ia = a?.id ?? 0\n      const ib = b?.id ?? 0\n      if (ia !== ib) return ia - ib\n      const ta = a?.tempId ?? ''\n      const tb = b?.tempId ?? ''\n      if (ta < tb) return -1\n      if (ta > tb) return 1\n      return 0\n    })\n  }, [isEditing, editedItems, currentItems])\n\n  //  SortableContext items     (  )\n  const sortableIds = useMemo(() => {\n    return (editedItems || []).map((item, idx) => getSortableId(item, idx))\n  }, [editedItems, getSortableId])\n\n  const tableMinWidth = useMemo(() => {\n    if (columnWidths.length > 0) {\n      const columnGap = columnWidths.length > 1 ? (columnWidths.length - 1) * 12 : 0\n      const padding = 24\n      const total = columnWidths.reduce((sum, width) => sum + width, 0) + columnGap + padding\n      return Math.max(total, 720)\n    }\n\n    const baseColumns: number[] = [120, 200, 70, 90, 100, 150, 80] // , , , , , , \n\n    if (activeTab === 'purchase') {\n      baseColumns.push(120)\n    }\n\n    if (activeTab === 'receipt' || activeTab === 'done') {\n      baseColumns.push(120)\n    }\n\n    if (activeTab === 'receipt') {\n      baseColumns.push(140)\n    }\n\n    if (activeTab === 'done') {\n      baseColumns.push(100, 80, 110) // (100), (80), (110)\n    }\n\n    if (isEditing) {\n      baseColumns.push(110)\n    }\n\n    const columnGap = baseColumns.length > 1 ? (baseColumns.length - 1) * 12 : 0\n    const total = baseColumns.reduce((sum, width) => sum + width, 0) + columnGap + 48\n    return Math.max(total, 720)\n  }, [columnWidths, activeTab, isEditing])\n  const headerRowRef = useRef<HTMLDivElement>(null)\n  const supabase = createClient()\n  \n  //      \n  useEffect(() => {\n    const loadUserRoles = async () => {\n      try {\n        // Supabase   \n        const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n        const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n        \n        if (!supabaseUrl || !supabaseAnonKey || supabaseUrl.includes('placeholder')) {\n          logger.warn('Supabase     - PurchaseDetailModal');\n          return;\n        }\n\n        const { data: { user } } = await supabase.auth.getUser()\n        if (user) {\n          //  ID \n          let { data: employeeData } = await supabase\n            .from('employees')\n            .select('*')\n            .eq('id', user.id)\n            .maybeSingle()\n          \n          // ID    \n          if (!employeeData && user.email) {\n            const { data: employeeByEmail } = await supabase\n              .from('employees')\n              .select('*')\n              .eq('email', user.email)\n              .maybeSingle()\n            \n            employeeData = employeeByEmail\n          }\n          \n          //   \n          if (employeeData?.name) {\n            setCurrentUserName(employeeData.name)\n          }\n          \n          if (employeeData?.purchase_role) {\n            let roles: string[] = []\n            if (Array.isArray(employeeData.purchase_role)) {\n              roles = employeeData.purchase_role.map((r: any) => String(r).trim())\n            } else {\n              const roleString = String(employeeData.purchase_role)\n              roles = roleString\n                .split(',')\n                .map((r: string) => r.trim())\n                .filter((r: string) => r.length > 0)\n            }\n            setUserRoles(roles)\n          }\n        }\n      } catch (error) {\n        logger.error('   :', error)\n      }\n    }\n    \n    if (isOpen) {\n      loadUserRoles()\n    }\n  }, [isOpen])\n\n  //   \n  useEffect(() => {\n    const loadVendors = async () => {\n      try {\n        const { data: vendorsData, error } = await supabase\n          .from('vendors')\n          .select('*')\n          .order('vendor_name', { ascending: true })\n        \n        if (error) throw error\n        if (vendorsData) {\n          setVendors(vendorsData)\n        }\n      } catch (error) {\n        logger.error('   :', error)\n      }\n    }\n    \n    if (isOpen) {\n      loadVendors()\n    }\n  }, [isOpen])\n  \n  // currentUserRoles   userRoles \n  const effectiveRoles = Array.isArray(currentUserRoles) && currentUserRoles.length > 0 \n    ? currentUserRoles \n    : userRoles\n  \n  //  \n  //    (   )\n  const canEditAll = effectiveRoles.includes('final_approver') || \n                     effectiveRoles.includes('app_admin') || \n                     effectiveRoles.includes('ceo')\n  \n  // lead buyer    (/  )\n  const canEditLimited = effectiveRoles.includes('lead buyer')\n  \n  //    (      )\n  const canEdit = canEditAll || canEditLimited\n  \n  //     \n  const canViewFinancialInfo = effectiveRoles.some(role => AUTHORIZED_ROLES.includes(role))\n  \n  const showStatementColumns = purchase?.payment_category === '' && (\n    activeTab === 'done' || (activeTab === 'receipt' && effectiveRoles.includes('lead buyer'))\n  )\n  const showExpenditureColumn = purchase?.payment_category === '' && activeTab === 'done'\n  \n  //  :     (,   , lead buyer  )\n  const isApproved = purchase?.final_manager_status === 'approved';\n  const canDelete = isApproved \n    ? canEditAll  //      (lead buyer )\n    : (canEditAll || (purchase?.requester_name === currentUserName))  //  lead buyer \n  \n  //   : app_admin + lead buyer (  )\n  const canPurchase = effectiveRoles.includes('app_admin') || \n                     effectiveRoles.includes('lead buyer') || \n                     effectiveRoles.includes('lead buyer')\n  \n  //    \n  // 1.      \n  // 2.      \n  const canReceiveItems = effectiveRoles.includes('app_admin') || \n                         (purchase?.requester_name === currentUserName)\n  // 2.        \n  const isAdmin = effectiveRoles.includes('final_approver') || \n                  effectiveRoles.includes('app_admin') || \n                  effectiveRoles.includes('ceo')\n  const isRequester = purchase?.requester_name === currentUserName\n  \n  //   & UTK  : app_admin lead buyer, accounting \n  const canReceiptCheck = effectiveRoles.includes('app_admin') || \n                         effectiveRoles.includes('lead buyer') ||\n                         effectiveRoles.includes('accounting')\n  \n  //   : app_admin    \n  const canProcessReceipt = effectiveRoles.includes('app_admin') || isRequester\n  \n  //      (  )\n  const refreshModalData = useCallback(async () => {\n    if (!purchaseId) return\n    //  /  DB  edited state  \n    if (isEditingRef.current || isSavingRef.current) {\n      logger.debug('[refreshModalData] /  - DB  ', {\n        isEditing: isEditingRef.current,\n        isSaving: isSavingRef.current\n      })\n      return\n    }\n    \n    try {\n      //  DB    vendor_contacts   \n      //   vendor_contacts    \n      const supabase = createClient()\n      //     \n      //  purchase_requests  \n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          vendors:vendor_id(id, vendor_name, is_active),\n          purchase_request_items(*),\n          contact:contact_id(id, contact_name, contact_email, contact_phone, position)\n        `)\n        .eq('id', purchaseId)\n        .single()\n      \n      if (error) throw error\n      \n      // vendor_id      ,      \n      let vendorContacts = []\n      if (data && data.vendor_id) {\n        const { data: allContacts } = await supabase\n          .from('vendor_contacts')\n          .select('id, contact_name, contact_email, contact_phone, position')\n          .eq('vendor_id', data.vendor_id)\n          .order('contact_name')\n        \n        if (allContacts && allContacts.length > 0) {\n          // contact_id     \n          if (data.contact_id) {\n            const currentContact = allContacts.find((c: any) => c.id === data.contact_id)\n            const otherContacts = allContacts.filter((c: any) => c.id !== data.contact_id)\n            vendorContacts = currentContact ? [currentContact, ...otherContacts] : allContacts\n          } else {\n            vendorContacts = allContacts\n          }\n          logger.info('    :', {\n            vendor_id: data.vendor_id,\n            contact_id: data.contact_id,\n            allContacts_count: allContacts.length,\n            vendorContacts\n          })\n        }\n      } else if (data && data.contact) {\n        // vendor_id   contact  \n        vendorContacts = [data.contact]\n      }\n\n      if (data) {\n        //   \n        const sortedItems = normalizeItems((data.purchase_request_items || []).sort((a: any, b: any) => {\n          const lineA = a.line_number || 999999;\n          const lineB = b.line_number || 999999;\n          return lineA - lineB;\n        }));\n\n        //  DB     \n        const itemsData = sortedItems.map(item => ({\n          id: item.id,\n          item_name: item.item_name,\n          amount_value: item.amount_value,\n          unit_price_value: item.unit_price_value,\n          quantity: item.quantity\n        }))\n        logger.info(' [refreshModalData] DB   :', { itemsData })\n        \n        //  0     ( null  )\n        itemsData.forEach(item => {\n          if (item.amount_value === 0 && item.unit_price_value != null && item.unit_price_value !== 0) {\n            logger.warn(' [refreshModalData]  0   :', {\n              itemId: item.id,\n              item_name: item.item_name,\n              amount_value: item.amount_value,\n              unit_price_value: item.unit_price_value,\n              quantity: item.quantity,\n              calculated_amount: (item.quantity || 0) * (item.unit_price_value || 0)\n            })\n          }\n        })\n\n        const purchaseData = {\n          ...data,\n          items: sortedItems,\n          vendor: data.vendors || null,\n          vendor_contacts: vendorContacts,\n          contact_id: data.contact_id,  // contact_id \n          contact_name: vendorContacts[0]?.contact_name || data.contact?.contact_name || null  // contact_name \n        } as PurchaseRequestWithDetails\n\n        setPurchase({\n          ...purchaseData,\n          items: sortedItems\n        })\n        setEditedPurchase(purchaseData)\n        setEditedItems(sortedItems)\n        logger.info(' refreshModalData DB  :', { \n          vendor_contacts: purchaseData.vendor_contacts,\n          vendorContacts_from_query: vendorContacts,\n          purchase_updated: true,\n          vendor_id: data.vendor_id,\n          has_vendor_contacts: vendorContacts && vendorContacts.length > 0\n        })\n        logger.debug('refreshModalData - DB  :', {\n          vendor_id: data.vendor_id,\n          vendor_contacts: vendorContacts,\n          purchaseData_full: purchaseData,\n          : vendorContacts?.[0]?.contact_name || ''\n        })\n      }\n    } catch (error) {\n      logger.error('   ', error)\n    }\n  }, [purchaseId])\n\n  //    Realtime    \n  const refreshModalDataWithLock = useCallback(async () => {\n    isUpdatingRef.current = true\n    try {\n      await refreshModalData()\n    } finally {\n      //      (Realtime     )\n      setTimeout(() => {\n        isUpdatingRef.current = false\n      }, 3000)\n    }\n  }, [refreshModalData])\n\n  // UTK    ( : / )\n  const handleToggleUtkCheck = useCallback(async () => {\n    if (!purchase) return\n    if (!canReceiptCheck || !canViewFinancialInfo) return\n\n    const isCurrentlyChecked = purchase.is_utk_checked || false\n    const newStatus = !isCurrentlyChecked\n\n    const confirmMessage = newStatus\n      ? `: ${purchase.purchase_order_number}\\n\\nUTK  ?`\n      : `: ${purchase.purchase_order_number}\\n\\nUTK  ?`\n\n    if (!window.confirm(confirmMessage)) return\n\n    try {\n      const supabase = createClient()\n      const { error } = await supabase\n        .from('purchase_requests')\n        .update({ is_utk_checked: newStatus })\n        .eq('id', purchase.id)\n\n      if (error) {\n        logger.error('UTK  DB  ', { error, purchaseId: purchase.id })\n        toast.error('UTK     .')\n        return\n      }\n\n      //     (   React  )\n      setPurchase(prev => prev ? {\n        ...prev,\n        is_utk_checked: newStatus,\n        updated_at: new Date().toISOString() //    \n      } : null)\n\n      //   \n      if (purchase.id) {\n        updatePurchaseInMemory(purchase.id, (prev) => ({\n          ...prev,\n          is_utk_checked: newStatus\n        }))\n      }\n\n      toast.success(newStatus ? 'UTK  .' : 'UTK  .')\n\n      await refreshModalDataWithLock()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      logger.error('UTK    ', error)\n      toast.error('UTK     .')\n    }\n  }, [purchase, canReceiptCheck, canViewFinancialInfo, onRefresh, refreshModalDataWithLock])\n\n  //          \n  useEffect(() => {\n    if (!purchaseId || !allPurchases || !purchase) return;\n    //          \n    if (isEditing || isSaving) return;\n\n    const memoryPurchase = allPurchases.find(p => p.id === purchaseId);\n    if (memoryPurchase) {\n      //   purchase state  (   )\n      const normalizedItems = normalizeItems((memoryPurchase.items && memoryPurchase.items.length > 0) \n        ? memoryPurchase.items \n        : (memoryPurchase.purchase_request_items || []));\n      \n      const updatedPurchase = {\n        ...purchase,\n        ...memoryPurchase,\n        id: String(memoryPurchase.id),\n        items: normalizedItems,\n        purchase_request_items: normalizedItems\n      } as PurchaseRequestWithDetails;\n\n      setPurchase(updatedPurchase);\n      setEditedPurchase(updatedPurchase);\n      setEditedItems(normalizedItems.length > 0 ? normalizedItems : []);\n    }\n  }, [allPurchases, lastFetch, isEditing, isSaving]); // isEditing, isSaving  \n\n  //         \n  useEffect(() => {\n    if (!isOpen || !purchaseId || !allPurchases) return;\n    //          \n    if (isEditing || isSaving) return;\n\n    const memoryPurchase = allPurchases.find(p => p.id === purchaseId);\n    if (memoryPurchase) {\n      const normalizedItems = normalizeItems((memoryPurchase.items && memoryPurchase.items.length > 0) \n        ? memoryPurchase.items \n        : (memoryPurchase.purchase_request_items || []));\n      \n      const updatedPurchase = {\n        ...memoryPurchase,\n        id: String(memoryPurchase.id),\n        is_po_generated: false,\n        items: normalizedItems,\n        purchase_request_items: normalizedItems,\n        vendor: {\n          id: memoryPurchase.vendor_id,\n          vendor_name: memoryPurchase.vendor_name || '  ',\n          is_active: true,\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString()\n        } as Vendor,\n        vendor_contacts: []\n      } as PurchaseRequestWithDetails;\n\n      setPurchase(updatedPurchase);\n      setEditedPurchase(updatedPurchase);\n      setEditedItems(normalizedItems.length > 0 ? normalizedItems : []);\n    }\n  }, [isOpen, purchaseId, allPurchases, isEditing, isSaving]); // isEditing, isSaving  \n  \n  //       \n  const [isInitialLoad, setIsInitialLoad] = useState(true)\n  \n  //   \n  const purchaseIdNumber = purchaseId ? Number(purchaseId) : (purchase ? Number(purchase.id) : NaN)\n\n  const handleActualReceiptOptimisticUpdate = useCallback(({ itemId, selectedDate, action, receivedQuantity }: {\n    itemId: number\n    selectedDate?: Date\n    action: 'confirm' | 'cancel'\n    receivedQuantity?: number\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n      received_quantity?: number\n    }\n  }) => {\n    const itemIdStr = String(itemId)\n    const nowIso = new Date().toISOString()\n    const selectedDateIso = selectedDate ? dateToISOString(selectedDate) : undefined\n\n    const updateItems = (items?: any[]) => {\n      if (!items) return items\n      return items.map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_received: true,\n            actual_received_date: selectedDateIso,\n            received_at: nowIso,\n            received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.received_quantity\n          }\n        }\n\n        return {\n          ...item,\n          is_received: false,\n          actual_received_date: undefined,\n          received_at: undefined,\n          received_quantity: undefined\n        }\n      })\n    }\n\n    setPurchase(prev => {\n      if (!prev) return prev\n      const updatedItems = updateItems(prev.items) || []\n      const updatedRequestItems = updateItems(prev.purchase_request_items) || []\n      const total = updatedItems.length\n      const completed = updatedItems.filter(item => item.is_received).length\n      const allReceived = total > 0 && completed === total\n\n      return {\n        ...prev,\n        items: updatedItems,\n        purchase_request_items: updatedRequestItems,\n        is_received: allReceived,\n        received_at: allReceived ? (prev.received_at || nowIso) : undefined,\n        updated_at: new Date().toISOString()\n      }\n    })\n\n    setEditedPurchase(prev => {\n      if (!prev) return prev\n      const updatedItems = updateItems(prev.items) || []\n      const updatedRequestItems = updateItems(prev.purchase_request_items) || []\n      return {\n        ...prev,\n        items: updatedItems,\n        purchase_request_items: updatedRequestItems\n      }\n    })\n\n    setEditedItems(prevItems => {\n      if (!prevItems || prevItems.length === 0) return prevItems\n      return prevItems.map(item => {\n        if (!item.id || String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_received: true,\n            actual_received_date: selectedDateIso,\n            received_at: nowIso,\n            received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.received_quantity\n          }\n        }\n\n        return {\n          ...item,\n          is_received: false,\n          actual_received_date: undefined,\n          received_at: undefined,\n          received_quantity: undefined\n        }\n      })\n    })\n\n    if (!Number.isNaN(purchaseIdNumber)) {\n      onOptimisticUpdate?.(purchaseIdNumber, prevPurchase => {\n        const updatedItems = updateItems(prevPurchase.items) || prevPurchase.items || []\n        const updatedRequestItems = updateItems(prevPurchase.purchase_request_items) || prevPurchase.purchase_request_items || []\n        const total = updatedItems.length || prevPurchase.items?.length || 0\n        const completed = updatedItems.filter(item => item.is_received).length\n        const allReceived = total > 0 && completed === total\n\n        return {\n          ...prevPurchase,\n          items: updatedItems,\n          purchase_request_items: updatedRequestItems,\n          is_received: allReceived,\n          received_at: allReceived ? (prevPurchase.received_at || nowIso) : undefined,\n          updated_at: new Date().toISOString()\n        }\n      })\n    }\n  }, [onOptimisticUpdate, purchaseIdNumber])\n\n  const handleStatementReceivedOptimisticUpdate = useCallback(({ itemId, selectedDate, action }: {\n    itemId: number\n    selectedDate?: Date\n    action: 'confirm' | 'cancel'\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n    }\n  }) => {\n    const itemIdStr = String(itemId)\n    const selectedDateIso = selectedDate ? dateToISOString(selectedDate) : undefined\n\n    let nextAllCompleted = false\n    let nextStatementAt: string | null = null\n\n    setPurchase(prev => {\n      if (!prev) return prev\n\n      const updatedItems = (prev.items || []).map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_statement_received: true,\n            statement_received_date: selectedDateIso,\n            statement_received_by_name: currentUserName\n          }\n        }\n\n        return {\n          ...item,\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      })\n\n      nextAllCompleted = updatedItems.length > 0 && updatedItems.every(item => item.is_statement_received)\n      nextStatementAt = nextAllCompleted\n        ? (selectedDateIso || prev.statement_received_at || new Date().toISOString())\n        : null\n\n      return {\n        ...prev,\n        items: updatedItems,\n        is_statement_received: nextAllCompleted,\n        statement_received_at: nextStatementAt\n      }\n    })\n\n    setEditedPurchase(prev => {\n      if (!prev) return prev\n\n      const updatedItems = (prev.items || []).map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_statement_received: true,\n            statement_received_date: selectedDateIso,\n            statement_received_by_name: currentUserName\n          }\n        }\n\n        return {\n          ...item,\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      })\n\n      return {\n        ...prev,\n        items: updatedItems,\n        is_statement_received: nextAllCompleted,\n        statement_received_at: nextStatementAt\n      }\n    })\n\n    setEditedItems(prevItems => {\n      if (!prevItems) return prevItems\n      return prevItems.map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_statement_received: true,\n            statement_received_date: selectedDateIso,\n            statement_received_by_name: currentUserName\n          }\n        }\n\n        return {\n          ...item,\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      })\n    })\n\n    if (!Number.isNaN(purchaseIdNumber)) {\n      onOptimisticUpdate?.(purchaseIdNumber, prevPurchase => {\n        const updatedItems = (prevPurchase.items || []).map(item => {\n          if (String(item.id) !== itemIdStr) return item\n\n          if (action === 'confirm') {\n            return {\n              ...item,\n              is_statement_received: true,\n              statement_received_date: selectedDateIso,\n              statement_received_by_name: currentUserName\n            }\n          }\n\n          return {\n            ...item,\n            is_statement_received: false,\n            statement_received_date: null,\n            statement_received_by_name: null\n          }\n        })\n\n        const allCompleted = updatedItems.length > 0 && updatedItems.every(item => item.is_statement_received)\n\n        return {\n          ...prevPurchase,\n          items: updatedItems,\n          is_statement_received: allCompleted\n        }\n      })\n    }\n\n    // purchase_requests   \n    if (purchase && nextAllCompleted !== undefined) {\n      const supabase = createClient()\n      supabase\n        .from('purchase_requests')\n        .update({\n          is_statement_received: nextAllCompleted,\n          statement_received_at: nextStatementAt\n        })\n        .eq('id', purchase.id)\n        .then(({ error }: { error: any }) => {\n          if (error) {\n            logger.error('  purchase_requests  ', error)\n          }\n        })\n    }\n  }, [currentUserName, onOptimisticUpdate, purchaseIdNumber, purchase])\n\n  //     Realtime    \n  const handleBeforeUpdate = useCallback(() => {\n    isUpdatingRef.current = true\n    logger.debug('[PurchaseDetailModal]   - Realtime   ')\n  }, [])\n\n  const statementReceivedAction = useConfirmDateAction({\n    config: {\n      field: 'statement_received',\n      confirmMessage: {\n        confirm: '  ?',\n        cancel: '  ?'\n      },\n      successMessage: {\n        confirm: '  .',\n        cancel: '  .'\n      },\n      completedText: ' ',\n      waitingText: ''\n    },\n    currentUserName,\n    canPerformAction: canReceiptCheck,\n    purchaseId: purchase?.id,\n    onBeforeUpdate: handleBeforeUpdate,\n    onUpdate: refreshModalDataWithLock,\n    onOptimisticUpdate: handleStatementReceivedOptimisticUpdate\n  })\n\n  const actualReceivedAction = useConfirmDateAction({\n    config: {\n      field: 'actual_received',\n      confirmMessage: {\n        confirm: '   ?',\n        cancel: '   ?'\n      },\n      successMessage: {\n        confirm: '   .',\n        cancel: '   .'\n      },\n      completedText: '',\n      waitingText: ''\n    },\n    currentUserName,\n    canPerformAction: canProcessReceipt,\n    purchaseId: purchase?.id,\n    onBeforeUpdate: handleBeforeUpdate,\n    onUpdate: refreshModalDataWithLock,\n    onOptimisticUpdate: handleActualReceiptOptimisticUpdate\n  })\n  \n  //   \n  \n  \n  //   \n const canApproveMiddle = effectiveRoles.includes('middle_manager') || \n                          effectiveRoles.includes('app_admin') || \n                          effectiveRoles.includes('ceo')\n \n const canApproveFinal = effectiveRoles.includes('final_approver') || \n                         effectiveRoles.includes('app_admin') || \n                         effectiveRoles.includes('ceo')\n \n const approvalPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2 py-0.5 badge-text leading-tight'\n const approvalButtonClass = 'inline-flex items-center gap-1 business-radius-badge !h-auto !min-h-0 !px-2.5 !py-0.5 badge-text leading-tight'\n const approvalWaitingPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2.5 py-0.5 badge-text leading-tight'\n \n \n  useEffect(() => {\n    if (purchaseId && isOpen) {\n      //       \n      const memoryPurchase = findPurchaseInMemory(purchaseId)\n      if (memoryPurchase) {\n        //     (loading  )\n        const purchaseData = {\n          ...memoryPurchase,\n          id: String(memoryPurchase.id), // PurchaseRequest id string\n          is_po_generated: false, // Purchase   PurchaseRequest \n          vendor: (memoryPurchase as any).vendor || (memoryPurchase.vendor_id ? {\n            id: memoryPurchase.vendor_id,\n            vendor_name: memoryPurchase.vendor_name || '  ',\n            is_active: true,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString()\n          } as Vendor : null),\n          vendor_contacts: (memoryPurchase as any).vendor_contacts || []\n        } as PurchaseRequestWithDetails\n        \n        setPurchase(purchaseData)\n        setEditedPurchase(purchaseData)\n        setEditedItems(memoryPurchase.items || [])\n      } else {\n        //     \n        loadPurchaseDetail(purchaseId.toString())\n      }\n      setIsEditing(false) //      \n      \n      //   \n      loadLinkedStatements(purchaseId)\n    }\n  }, [purchaseId, isOpen])\n\n  //   \n  const loadLinkedStatements = async (purchaseId: number) => {\n    try {\n      const result = await transactionStatementService.getStatementsByPurchaseId(purchaseId)\n      if (result.success && result.data) {\n        setLinkedStatements(result.data)\n      }\n    } catch (e) {\n      //    (   )\n      setLinkedStatements([])\n    }\n  }\n\n  //   \n  const handleViewStatementImage = (imageUrl: string) => {\n    setSelectedStatementImage(imageUrl)\n    setIsStatementViewerOpen(true)\n  }\n\n  //    (  )\n  const calculateOptimalColumnWidths = useCallback(() => {\n    // items purchase_request_items   \n    const items = (purchase?.items && purchase.items.length > 0) \n      ? purchase.items \n      : (purchase?.purchase_request_items && purchase.purchase_request_items.length > 0)\n      ? purchase.purchase_request_items\n      : []\n    \n    if (items.length === 0) return []\n\n    const columnConfigs = [\n      { key: 'line_number', minWidth: 32, maxWidth: 32, baseWidth: 32, isFixed: true }, //  \n      { key: 'item_name', minWidth: 80, maxWidth: 500, baseWidth: 80 },\n      { key: 'specification', minWidth: 80, maxWidth: 200, baseWidth: 150, isFixed: false }, //   (80px~200px)\n      { key: 'quantity', minWidth: 70, maxWidth: 120, baseWidth: 70 }, // 100/0   maxWidth \n      { key: 'unit_price', minWidth: 90, maxWidth: 150, baseWidth: 90 },\n      { key: 'total_price', minWidth: 100, maxWidth: 180, baseWidth: 100 },\n    ]\n    \n    //     \n    if (purchase?.payment_category === '') {\n      columnConfigs.push({ key: 'tax_amount', minWidth: 80, maxWidth: 150, baseWidth: 80 })\n    }\n    \n    //    ( ,  )\n    columnConfigs.push({ key: 'link', minWidth: 60, maxWidth: 80, baseWidth: 60, isFixed: true })\n    \n    columnConfigs.push(\n      { key: 'remarks', minWidth: 150, maxWidth: 150, baseWidth: 150, isFixed: true } //   150px\n    )\n    \n    // pending      \n    if (activeTab !== 'pending') {\n      columnConfigs.push(\n        { key: 'status', minWidth: 70, maxWidth: 100, baseWidth: 70 } //    \n      )\n    }\n\n      //   ()\n      if (activeTab === 'receipt') {\n        columnConfigs.push(\n          { key: 'actual_receipt_date', minWidth: 100, maxWidth: 160, baseWidth: 100, isFixed: false }\n        )\n        if (showStatementColumns) {\n          columnConfigs.push(\n            { key: 'transaction_confirm', minWidth: 85, maxWidth: 120, baseWidth: 85, isFixed: false },\n            { key: 'accounting_date', minWidth: 70, maxWidth: 70, baseWidth: 70, isFixed: true }\n          )\n        }\n      }\n      if (activeTab === 'done' && purchase?.payment_category === '') {\n        columnConfigs.push(\n          { key: 'transaction_confirm', minWidth: 85, maxWidth: 120, baseWidth: 85, isFixed: false }, //     \n          { key: 'accounting_date', minWidth: 70, maxWidth: 70, baseWidth: 70, isFixed: true }, //     \n          { key: 'expenditure_info', minWidth: 90, maxWidth: 150, baseWidth: 90, isFixed: false } //    \n        )\n      }\n\n    const calculatedWidths = columnConfigs.map((config, index) => {\n      let maxLength = 4 //  4\n\n      //     ()\n      const getHeaders = () => {\n        const statusHeader = activeTab === 'purchase'\n          ? ''\n          : (activeTab === 'receipt' || activeTab === 'done')\n          ? ''\n          : ''\n\n        //    \n        // receipt, done  '/ '    \n        const quantityHeader = (activeTab === 'receipt' || activeTab === 'done') \n          ? '/ ' \n          : ''\n        const baseHeaders = activeTab === 'pending' \n          ? ['#', '', '', quantityHeader, '', '', purchase?.payment_category === '' ? '' : null, ''].filter(h => h !== null)\n          : ['#', '', '', quantityHeader, '', '', purchase?.payment_category === '' ? '' : null, '', statusHeader].filter(h => h !== null)\n        if (activeTab === 'receipt') {\n          const receiptHeaders = [...baseHeaders, '']\n          if (showStatementColumns) {\n            receiptHeaders.push(' ', ' ')\n          }\n          return receiptHeaders\n        } else if (activeTab === 'done') {\n          const doneHeaders = [...baseHeaders]\n          if (showStatementColumns) {\n            doneHeaders.push(' ', ' ')\n            if (showExpenditureColumn) {\n              doneHeaders.push('')\n            }\n          }\n          return doneHeaders\n        }\n        return baseHeaders\n      }\n      \n      const headers = getHeaders()\n      if (headers[index]) {\n        maxLength = Math.max(maxLength, headers[index].length)\n      }\n\n      //     \n      items.forEach(item => {\n        let cellValue = ''\n        switch (config.key) {\n          case 'line_number':\n            cellValue = item.line_number?.toString() || ''\n            break\n          case 'item_name':\n            cellValue = item.item_name || ''\n            break\n          case 'specification':\n            cellValue = item.specification || ''\n            break\n          case 'quantity':\n            // receipt, done  /  \n            if (activeTab === 'receipt' || activeTab === 'done') {\n              const quantity = item.quantity || 0\n              const receivedQuantity = item.received_quantity ?? 0\n              // 100  2      \n              //       (   /  )\n              cellValue = quantity >= 100 || receivedQuantity >= 100 \n                ? `${quantity}` // 2     \n                : `${quantity}/${receivedQuantity}` // 1   \n            } else {\n              cellValue = item.quantity?.toString() || ''\n            }\n            break\n          case 'unit_price':\n            cellValue = item.unit_price_value != null ? item.unit_price_value.toLocaleString() : ''\n            break\n          case 'total_price':\n            if (item.amount_value != null) {\n              cellValue = item.amount_value.toLocaleString()\n            } else if (item.quantity != null && item.unit_price_value != null) {\n              cellValue = (Number(item.quantity) * Number(item.unit_price_value)).toLocaleString()\n            } else {\n              cellValue = ''\n            }\n            break\n          case 'tax_amount':\n            cellValue = item.tax_amount_value != null ? item.tax_amount_value.toLocaleString() : ''\n            break\n          case 'remarks':\n            cellValue = item.remark || ''\n            break\n          case 'status':\n            cellValue = getStatusDisplay(item) || ''\n            break\n          case 'actual_receipt_date':\n            cellValue = item.actual_received_date ? formatDate(item.actual_received_date) : ''\n            break\n          case 'transaction_confirm':\n            cellValue = item.is_statement_received ? '' : ''\n            break\n          case 'accounting_date':\n            cellValue = item.statement_received_date ? formatDate(item.statement_received_date) : ''\n            break\n          case 'expenditure_info':\n            //    2   \n            if (item.expenditure_date && item.expenditure_amount !== null && item.expenditure_amount !== undefined) {\n              //   : \"2025. 11. 25.\" ( 14)\n              cellValue = '2025. 11. 25.' //    \n            } else {\n              cellValue = '' //  \n            }\n            break\n        }\n        \n        // /     ( 1.5 )\n        const adjustedLength = cellValue.split('').reduce((acc, char) => {\n          return acc + (/[-]/.test(char) ? 1.5 : 1)\n        }, 0)\n        \n        maxLength = Math.max(maxLength, Math.ceil(adjustedLength))\n      })\n\n      //     \n      if (config.isFixed) {\n        return config.baseWidth\n      }\n      \n      //    (  7px +  20px)\n      let calculatedWidth = Math.max(\n        config.minWidth,\n        Math.min(config.maxWidth, maxLength * 7 + 20)\n      )\n      \n      //      2   \n      if (config.key === 'expenditure_info') {\n        //   \"2025. 11. 25.\"  \n        // 2     \n        calculatedWidth = 110 //   \n      }\n\n      return calculatedWidth\n    })\n\n    setColumnWidths(calculatedWidths)\n    return calculatedWidths\n  }, [purchase, activeTab, showStatementColumns, showExpenditureColumn])\n\n  //     \n  const getStatusDisplay = (item: any) => {\n    if (activeTab === 'purchase') {\n      return item.is_payment_completed ? '' : ''\n    } else if (activeTab === 'receipt') {\n      return item.is_received ? '' : ''\n    }\n    return item.is_payment_completed ? '' : ''\n  }\n\n  //  gridTemplateColumns \n  const getGridTemplateColumns = () => {\n    //      (,    )\n    if (columnWidths.length > 0) {\n      const widths = columnWidths.map(width => `${width}px`)\n      \n      //      ( )\n      //      \n      \n      return widths.join(' ')\n    }\n    \n    //  (  )\n    // [, , , , , ]\n    const baseColumns = ['32px', 'minmax(80px, 1fr)', '200px', '70px', '90px', '100px']\n    \n    //     \n    if (purchase?.payment_category === '') {\n      baseColumns.push('100px') // \n    }\n    \n    //   \n    baseColumns.push('60px')\n    \n    //   \n    baseColumns.push('150px')\n    \n    // pending    /  \n    if (activeTab !== 'pending') {\n      if (isEditing) {\n        baseColumns.push('80px') // \n      } else {\n        baseColumns.push('80px') // \n      }\n    }\n    \n    //   \n    if (activeTab === 'receipt') {\n      const receiptColumns = [...baseColumns, '100px'] // \n      if (showStatementColumns) {\n        receiptColumns.push('100px', '80px') //  ,  \n      }\n      return receiptColumns.join(' ')\n    } else if (activeTab === 'done') {\n      const doneColumns = [...baseColumns]\n      if (showStatementColumns) {\n        doneColumns.push('100px', '80px') //  ,  \n        if (showExpenditureColumn) {\n          doneColumns.push('110px') // \n        }\n      }\n      return doneColumns.join(' ')\n    }\n    \n    return baseColumns.join(' ')\n  }\n\n  //  measureColumnWidths  ( )\n  const measureColumnWidths = () => {\n    calculateOptimalColumnWidths()\n  }\n\n  // View     (  )\n  //      \n  useEffect(() => {\n    // items purchase_request_items   \n    const hasItems = (purchase?.items && purchase.items.length > 0) || \n                     (purchase?.purchase_request_items && purchase.purchase_request_items.length > 0)\n    \n    if (purchase && hasItems && !isEditing) {\n      // requestAnimationFrame       \n      requestAnimationFrame(() => {\n        calculateOptimalColumnWidths()\n      })\n    }\n  }, [purchase, isEditing, activeTab, calculateOptimalColumnWidths])\n\n  // Edit     \n  const handleEditToggle = (editing: boolean) => {\n    if (editing && !isEditing) {\n      // Edit       (line_number  )\n      setEditedPurchase(purchase)\n      const sortedItems = [...(currentItems || [])].sort((a, b) => {\n        const la = a?.line_number ?? 999999\n        const lb = b?.line_number ?? 999999\n        return la - lb\n      })\n      setEditedItems(sortedItems)\n      setDeletedItemIds([])\n      // Edit      \n      calculateOptimalColumnWidths()\n    }\n    setIsEditing(editing)\n  }\n\n  const loadPurchaseDetail = async (id: string) => {\n    try {\n      //     (    )\n      const memoryPurchase = findPurchaseInMemory(id)\n      if (memoryPurchase) {\n        //   PurchaseRequestWithDetails  \n        const purchaseData = {\n          ...memoryPurchase,\n          id: String(memoryPurchase.id), // PurchaseRequest id string\n          is_po_generated: false, // Purchase   PurchaseRequest \n          vendor: (memoryPurchase as any).vendor || (memoryPurchase.vendor_id ? {\n            id: memoryPurchase.vendor_id,\n            vendor_name: memoryPurchase.vendor_name || '  ',\n            is_active: true,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString()\n          } as Vendor : null),\n          vendor_contacts: (memoryPurchase as any).vendor_contacts || []\n        } as PurchaseRequestWithDetails\n        \n        setPurchase({\n          ...purchaseData,\n          items: normalizeItems(memoryPurchase.items || purchaseData.items || [])\n        })\n        setEditedPurchase(purchaseData)\n        setEditedItems(normalizeItems(memoryPurchase.items || []))\n        return\n      }\n      \n      //        DB  (fallback)\n      setLoading(true)\n      const supabase = createClient()\n      \n      //  purchase_requests  \n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          vendors:vendor_id(id, vendor_name, is_active),\n          purchase_request_items(*),\n          contact:contact_id(id, contact_name, contact_email, contact_phone, position)\n        `)\n        .eq('id', id)\n        .single()\n\n      if (error) throw error\n      \n      // vendor_id      ,      \n      let vendorContacts = []\n      if (data && data.vendor_id) {\n        const { data: allContacts } = await supabase\n          .from('vendor_contacts')\n          .select('id, contact_name, contact_email, contact_phone, position')\n          .eq('vendor_id', data.vendor_id)\n          .order('contact_name')\n        \n        if (allContacts && allContacts.length > 0) {\n          // contact_id     \n          if (data.contact_id) {\n            const currentContact = allContacts.find((c: any) => c.id === data.contact_id)\n            const otherContacts = allContacts.filter((c: any) => c.id !== data.contact_id)\n            vendorContacts = currentContact ? [currentContact, ...otherContacts] : allContacts\n          } else {\n            vendorContacts = allContacts\n          }\n          logger.info(' loadPurchaseDetail -    :', {\n            vendor_id: data.vendor_id,\n            contact_id: data.contact_id,\n            allContacts_count: allContacts.length,\n            vendorContacts\n          })\n        }\n      } else if (data && data.contact) {\n        // vendor_id   contact  \n        vendorContacts = [data.contact]\n      }\n\n      if (data) {\n        //   \n        const sortedItems = normalizeItems((data.purchase_request_items || []).sort((a: any, b: any) => {\n          const lineA = a.line_number || 999999;\n          const lineB = b.line_number || 999999;\n          return lineA - lineB;\n        }));\n\n        const purchaseData = {\n          ...data,\n          items: sortedItems,\n          vendor: data.vendors || null,\n          vendor_contacts: vendorContacts,\n          contact_id: data.contact_id,  // contact_id \n          contact_name: vendorContacts[0]?.contact_name || data.contact?.contact_name || null  // contact_name \n        } as PurchaseRequestWithDetails\n        setPurchase({\n          ...purchaseData,\n          items: sortedItems\n        })\n        setEditedPurchase(purchaseData)\n        setEditedItems(sortedItems)\n      }\n    } catch (error) {\n      logger.error('[PurchaseDetailModal]    :', error)\n      toast.error('    .')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getStatusBadge = () => {\n    if (!purchase) return null\n    \n    // payment_category  \n    if (purchase.payment_category) {\n      const category = purchase.payment_category.trim()\n      \n      if (category === '') {\n        return <span className=\"badge-stats bg-green-500 text-white\"></span>\n      } else if (category === '') {\n        return <span className=\"badge-stats bg-blue-500 text-white\"></span>\n      } else if (category === '') {\n        return <span className=\"badge-stats bg-gray-500 text-white\"></span>\n      } else {\n        // payment_category      \n        return <span className=\"badge-stats bg-blue-500 text-white\">{category}</span>\n      }\n    }\n    \n    // payment_category  \n    return <span className=\"badge-stats bg-blue-500 text-white\"></span>\n  }\n\n\n  //      (NaN )\n  const safeNumber = (value: any, defaultValue: number = 0): number => {\n    if (value === null || value === undefined) return defaultValue\n\n    // ( )  \n    if (typeof value === 'string') {\n      const trimmed = value.trim()\n      if (trimmed === '') return defaultValue\n      const normalized = trimmed.replace(/,/g, '')\n      const num = Number(normalized)\n      return Number.isNaN(num) ? defaultValue : num\n    }\n\n    const num = Number(value)\n    return Number.isNaN(num) ? defaultValue : num\n  };\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('ko-KR').format(amount)\n  }\n\n  type CurrencyCode = 'KRW' | 'USD'\n\n  const normalizeCurrency = (currency: any): CurrencyCode => {\n    return currency === 'USD' ? 'USD' : 'KRW'\n  }\n\n  const getCurrencySymbol = (currency: any) => {\n    const c = normalizeCurrency(currency)\n    return c === 'USD' ? '$' : ''\n  }\n\n  const getPurchaseDisplayCurrency = (): CurrencyCode => {\n    return normalizeCurrency(isEditing ? editedPurchase?.currency : purchase?.currency)\n  }\n\n  const getItemDisplayCurrency = (item: any): CurrencyCode => {\n    return normalizeCurrency(\n      item?.unit_price_currency ??\n        item?.amount_currency ??\n        item?.tax_amount_currency ??\n        getPurchaseDisplayCurrency()\n    )\n  }\n\n  const formatMoney = (amount: number, currency: any) => {\n    return `${getCurrencySymbol(currency)}${formatCurrency(amount)}`\n  }\n\n  //   \n  const withTimeout = <T,>(promise: PromiseLike<T>, timeoutMs: number): Promise<T> => {\n    return Promise.race([\n      Promise.resolve(promise),\n      new Promise<T>((_, reject) =>\n        setTimeout(() => reject(new Error(` ${timeoutMs}ms   .`)), timeoutMs)\n      ),\n    ])\n  }\n\n  const handleSave = async () => {\n    if (!purchase || !editedPurchase) {\n      toast.error('  .')\n      return\n    }\n    \n    //     \n    lastSaveAtRef.current = Date.now()\n    // state   ref   (useEffect   )\n    isSavingRef.current = true\n    setIsSaving(true)\n    logger.debug('[handleSave]  ')\n    \n    try {\n      const supabase = createClient()\n      const STEP_TIMEOUT_MS = 20000\n      logger.debug('[handleSave] Step 1:     ')\n      \n      //    \n      const totalAmount = editedItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n      \n      // contact_id :  1. editedPurchase.contact_id 2. vendor_contacts[0].id 3. null\n      let contactId = null\n      if ((editedPurchase as any).contact_id) {\n        contactId = (editedPurchase as any).contact_id\n      } else if (Array.isArray(editedPurchase.vendor_contacts) && editedPurchase.vendor_contacts.length > 0) {\n        contactId = editedPurchase.vendor_contacts[0].id || null\n      }\n      \n      const updateResult = await withTimeout(\n        supabase\n          .from('purchase_requests')\n          .update({\n            purchase_order_number: editedPurchase.purchase_order_number || null,\n            requester_name: editedPurchase.requester_name || null,\n            vendor_id: editedPurchase.vendor_id || null,\n            vendor_name: editedPurchase.vendor_name || null,\n            contact_id: contactId, // contact_id \n            delivery_request_date: editedPurchase.delivery_request_date || null,\n            revised_delivery_request_date: editedPurchase.revised_delivery_request_date || null,\n            payment_category: editedPurchase.payment_category || null,\n            project_vendor: editedPurchase.project_vendor || null,\n            project_item: editedPurchase.project_item || null,\n            sales_order_number: editedPurchase.sales_order_number || null,\n            total_amount: Number(totalAmount),\n            updated_at: new Date().toISOString()\n          })\n          .eq('id', purchase.id),\n        STEP_TIMEOUT_MS\n      ) as any\n      const updateError = updateResult?.error\n\n      if (updateError) {\n        logger.error('Purchase update error:', updateError)\n        throw updateError\n      }\n      logger.debug('[handleSave] Step 1 ')\n\n      //      contact_id \n      logger.debug('[handleSave] Step 2:    ')\n      let finalContactId = null\n      \n      try {\n        if (editedPurchase.vendor_id && Array.isArray(editedPurchase.vendor_contacts) && editedPurchase.vendor_contacts.length > 0) {\n          const contact = editedPurchase.vendor_contacts[0]\n          \n          //    ,  \n          if (contact.id) {\n            finalContactId = contact.id\n            const { error: contactUpdateError } = await supabase\n              .from('vendor_contacts')\n              .update({\n                contact_name: contact.contact_name || '',\n                contact_email: contact.contact_email || '',\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              })\n              .eq('id', contact.id)\n            \n            if (contactUpdateError) {\n              logger.error('  :', contactUpdateError)\n            } else {\n              //  UI  \n              setPurchase(prev => {\n                const updated = prev ? {\n                  ...prev,\n                  vendor_contacts: [contact],\n                  contact_id: contact.id,\n                  contact_name: contact.contact_name\n                } : null\n                return updated\n              })\n            }\n          } else if (contact.contact_name) {\n            //   \n            const { data: newContact, error: contactInsertError } = await supabase\n              .from('vendor_contacts')\n              .insert({\n                vendor_id: editedPurchase.vendor_id,\n                contact_name: contact.contact_name,\n                contact_email: contact.contact_email || '',\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              })\n              .select()\n              .single()\n            \n            if (contactInsertError) {\n              logger.error('  :', contactInsertError)\n            } else if (newContact) {\n              finalContactId = newContact.id\n              //    editedPurchase \n              editedPurchase.vendor_contacts = [newContact]\n              \n              //  UI  \n              setPurchase(prev => {\n                const updated = prev ? {\n                  ...prev,\n                  vendor_contacts: [newContact],\n                  contact_id: newContact.id,\n                  contact_name: newContact.contact_name\n                } : null\n                return updated\n              })\n              \n              // purchase_requests  contact_id \n              const { error: purchaseUpdateError } = await supabase\n                .from('purchase_requests')\n                .update({\n                  contact_id: newContact.id\n                })\n                .eq('id', purchase.id)\n              \n              if (purchaseUpdateError) {\n                logger.error('purchase_requests contact_id  :', purchaseUpdateError)\n              }\n            }\n          }\n        }\n      } catch (contactError) {\n        //       \n        logger.warn(' [handleSave]     ( )', { error: contactError })\n      }\n      logger.debug('[handleSave] Step 2 ')\n\n      //   \n      logger.debug('[handleSave] Step 3:    ')\n      if (deletedItemIds.length > 0) {\n        const deleteResult = await withTimeout(\n          supabase\n            .from('purchase_request_items')\n            .delete()\n            .in('id', deletedItemIds),\n          STEP_TIMEOUT_MS\n        ) as any\n        const deleteError = deleteResult?.error\n\n        if (deleteError) {\n          logger.error('  :', deleteError)\n          throw deleteError\n        }\n      }\n      logger.debug('[handleSave] Step 3 ')\n\n      //      \n      if (editedItems.length === 0) {\n        logger.info('     ', {\n          purchaseId: purchase.id,\n          deletedItemIds: deletedItemIds\n        })\n\n        //  \n        const { error: requestDeleteError } = await supabase\n          .from('purchase_requests')\n          .delete()\n          .eq('id', purchase.id)\n\n        if (requestDeleteError) {\n          logger.error('  ', requestDeleteError)\n          throw requestDeleteError\n        }\n\n        //   \n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          const memoryUpdated = removePurchaseFromMemory(purchaseIdNumber)\n          if (!memoryUpdated) {\n            logger.warn('[handleSave]      ', { \n              purchaseId: purchaseIdNumber\n            })\n          } else {\n            logger.info(' [handleSave]      ', { \n              purchaseId: purchaseIdNumber\n            })\n          }\n        }\n\n        toast.success('    .')\n        handleEditToggle(false)\n        setDeletedItemIds([])\n        onClose() //  \n        \n        //  \n        const refreshResult = onRefresh?.(true, { silent: false })\n        if (refreshResult instanceof Promise) {\n          await refreshResult\n        }\n        \n        return //   \n      }\n\n      //     \n      logger.debug(`[handleSave] Step 4:   ,  ${editedItems.length}`)\n      \n      //  DB statement timeout/      (Promise.all )\n      for (let index = 0; index < editedItems.length; index++) {\n        const item = editedItems[index]\n        const itemTimeoutMs = 60000\n        //   \n        if (!item.item_name || !item.item_name.trim()) {\n          throw new Error(' .');\n        }\n        //   0 1  \n        if (!item.quantity || item.quantity <= 0) {\n          item.quantity = 1;\n        }\n        const normalizedUnitPriceValue = safeNumber(item.unit_price_value, 0)\n        const normalizedAmountValue = safeNumber(item.amount_value, 0)\n        if (normalizedUnitPriceValue < 0) {\n          throw new Error(' 0  .');\n        }\n        if (normalizedAmountValue < 0) {\n          throw new Error(' 0  .');\n        }\n        \n        // item.id        \n        const numericItemId = item.id ? Number(item.id) : null;\n        const isExistingItem = numericItemId && !Number.isNaN(numericItemId) && numericItemId > 0;\n        \n        //   \n        // :   ,   0  (DB NULL )\n        const unitPriceValue = safeNumber(item.unit_price_value, 0)\n        const finalAmountValue = safeNumber(item.amount_value, 0)\n        \n        if (isExistingItem) {\n          //   \n          const updateItemResult = await withTimeout(\n            supabase\n              .from('purchase_request_items')\n              .update({\n                item_name: item.item_name.trim(),\n                specification: item.specification || null,\n                quantity: safeNumber(item.quantity, 1),\n                received_quantity: item.received_quantity != null ? safeNumber(item.received_quantity) : null,\n                unit_price_value: unitPriceValue,\n                unit_price_currency: purchase.currency || 'KRW',\n                amount_value: finalAmountValue,\n                amount_currency: purchase.currency || 'KRW',\n                remark: item.remark || null,\n                link: item.link && String(item.link).trim() ? String(item.link).trim() : null,\n                updated_at: new Date().toISOString()\n              })\n              .eq('id', numericItemId),\n            itemTimeoutMs\n          ) as any\n          const error = updateItemResult?.error\n\n          if (error) {\n            logger.error('   ', error);\n            throw error;\n          }\n          logger.debug(`[handleSave]  ${index + 1}  `)\n        } else {\n          //   \n          const insertData = {\n            purchase_request_id: purchase.id,\n            item_name: item.item_name.trim(),\n            specification: item.specification || null,\n            quantity: safeNumber(item.quantity, 1),\n            received_quantity: item.received_quantity != null ? safeNumber(item.received_quantity) : null,\n            unit_price_value: unitPriceValue,\n            unit_price_currency: purchase.currency || 'KRW',\n            amount_value: finalAmountValue,\n            amount_currency: purchase.currency || 'KRW',\n            remark: item.remark || null,\n            link: item.link && String(item.link).trim() ? String(item.link).trim() : null,\n            line_number: item.line_number || editedItems.indexOf(item) + 1,\n            created_at: new Date().toISOString()\n          };\n          \n          //  insert (select/single)  (/ )\n          const insertItemResult = await withTimeout(\n            supabase\n              .from('purchase_request_items')\n              .insert(insertData),\n            itemTimeoutMs\n          ) as any\n          const error = insertItemResult?.error\n\n          if (error) {\n            logger.error('   ', error);\n            throw error;\n          }\n          logger.debug(`[handleSave]  ${index + 1}  `)\n        }\n      }\n      logger.debug('[handleSave] Step 4 :   ')\n\n      //        (  )\n      const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n      const sourceData = editedPurchase || purchase\n      \n      // 1.        \n      try {\n        if (!Number.isNaN(purchaseIdNumber) && deletedItemIds.length > 0) {\n          deletedItemIds.forEach(itemId => {\n            try {\n              const memoryUpdated = removeItemFromMemory(purchaseIdNumber, itemId)\n              if (!memoryUpdated) {\n                logger.warn('[handleSave]       ', { \n                  purchaseId: purchaseIdNumber, \n                  itemId: itemId \n                })\n              }\n            } catch (itemError) {\n              logger.warn(' [handleSave]         ()', { error: itemError })\n            }\n          })\n        }\n      } catch (memoryError) {\n        logger.warn(' [handleSave]       ( )', { error: memoryError })\n      }\n      \n      // 2.       ( )\n      try {\n        if (!Number.isNaN(purchaseIdNumber)) {\n          const memoryUpdated = updatePurchaseInMemory(purchaseIdNumber, (prev) => {\n            const totalAmount = editedItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n            \n            return {\n              ...prev,\n              //    \n              purchase_order_number: sourceData?.purchase_order_number || prev.purchase_order_number,\n              requester_name: sourceData?.requester_name || prev.requester_name,\n              vendor_id: sourceData?.vendor_id || prev.vendor_id,\n              vendor_name: sourceData?.vendor_name || prev.vendor_name,\n              vendor: sourceData?.vendor || (prev as any).vendor,\n              vendor_contacts: sourceData?.vendor_contacts || (prev as any).vendor_contacts,\n              delivery_request_date: sourceData?.delivery_request_date || prev.delivery_request_date,\n              revised_delivery_request_date: sourceData?.revised_delivery_request_date || prev.revised_delivery_request_date,\n              payment_category: sourceData?.payment_category || prev.payment_category,\n              project_vendor: sourceData?.project_vendor || prev.project_vendor,\n              project_item: sourceData?.project_item || prev.project_item,\n              total_amount: totalAmount,\n              //       (   )\n              items: editedItems,\n              purchase_request_items: editedItems,\n              updated_at: new Date().toISOString()\n            } as Purchase\n          })\n        }\n      } catch (memoryError) {\n        logger.warn(' [handleSave]      ( )', { error: memoryError })\n      }\n      \n      // 3. applyOptimisticUpdate     (  )\n      try {\n        const applyOptimisticUpdate = () => {\n          if (!Number.isNaN(purchaseIdNumber) && onOptimisticUpdate) {\n            onOptimisticUpdate(purchaseIdNumber, prev => {\n              const finalItems = editedItems //    \n              const totalAmount = finalItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n              \n              return {\n                ...prev,\n                //    \n                purchase_order_number: sourceData?.purchase_order_number || prev.purchase_order_number,\n                requester_name: sourceData?.requester_name || prev.requester_name,\n                vendor_id: sourceData?.vendor_id || prev.vendor_id,\n                vendor_name: sourceData?.vendor_name || prev.vendor_name,\n                vendor: sourceData?.vendor || (prev as any).vendor,\n                vendor_contacts: sourceData?.vendor_contacts || (prev as any).vendor_contacts,\n                delivery_request_date: sourceData?.delivery_request_date || prev.delivery_request_date,\n                revised_delivery_request_date: sourceData?.revised_delivery_request_date || prev.revised_delivery_request_date,\n                payment_category: sourceData?.payment_category || prev.payment_category,\n                project_vendor: sourceData?.project_vendor || prev.project_vendor,\n                project_item: sourceData?.project_item || prev.project_item,\n                total_amount: totalAmount,\n                //    -   \n                items: finalItems,\n                purchase_request_items: finalItems,\n                updated_at: new Date().toISOString()\n              } as Purchase\n            })\n          }\n        }\n        \n        // 4.  UI   (  )\n        logger.debug('[handleSave] Step 5 - UI  ')\n        applyOptimisticUpdate()\n        logger.debug('[handleSave] Step 5  -  !')\n      } catch (optimisticError) {\n        logger.warn(' [handleSave] OptimisticUpdate   ( )', { error: optimisticError })\n      }\n\n      logger.debug('[handleSave] Step 5 : UI ')\n      toast.success('   .')\n      handleEditToggle(false)\n      setDeletedItemIds([])\n      \n      logger.debug('[handleSave]  !  ')\n      \n      //     (OptimisticUpdate  UI  )\n      setIsSaving(false)\n      \n      //     (await )\n      refreshModalDataWithLock().catch(err => {\n        // refresh      ,     \n        logger.warn(' [handleSave]   ', { error: err })\n        const msg = err instanceof Error ? err.message : String(err)\n        toast.error(`   : ${msg}`, { duration: 5000 })\n      })\n      \n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        refreshResult.catch(err => {\n          logger.warn(' [handleSave]  onRefresh  ()', { error: err })\n        })\n      }\n    } catch (error) {\n      logger.error('[handleSave]  :', error)\n      const errorMessage = error instanceof Error ? error.message : '    '\n      toast.error(` : ${errorMessage}`, { duration: 5000 })\n    } finally {\n      logger.debug('[handleSave] finally   -  ')\n      isSavingRef.current = false\n      setIsSaving(false)\n    }\n  }\n\n  const handleItemChange = (index: number, field: string, value: any) => {\n    const newItems = [...editedItems]\n    \n    if (field === 'quantity' || field === 'unit_price_value') {\n      //          \n      if ((newItems[index] as any)?.is_amount_manual) {\n        newItems[index] = {\n          ...newItems[index],\n          [field]: value\n        }\n        setEditedItems(newItems)\n        return\n      }\n      //         \n      const quantity = field === 'quantity' ? value : newItems[index].quantity\n      const unitPrice = field === 'unit_price_value' ? value : newItems[index].unit_price_value\n      \n      //  null 0     (    )\n      const hasValidUnitPrice = unitPrice != null && unitPrice !== undefined && unitPrice !== '' && unitPrice !== 0\n      const hasValidQuantity = quantity != null && quantity !== undefined && quantity !== 0\n      \n      if (hasValidUnitPrice && hasValidQuantity) {\n        //        \n        const amount = (quantity || 0) * (unitPrice || 0)\n        \n        //    (10%)  \n        const taxAmount = purchase?.payment_category === '' ? Math.round(amount * 0.1) : 0\n        \n        newItems[index] = {\n          ...newItems[index],\n          [field]: value,\n          amount_value: amount,\n          tax_amount_value: taxAmount\n        }\n      } else {\n        //       / \n        newItems[index] = {\n          ...newItems[index],\n          [field]: value\n          // amount_value   \n        }\n      }\n    } else if (field === 'amount_value') {\n      //    \n      //   0  \n      let amount = 0\n      if (value !== '' && value != null && value !== undefined) {\n        const numValue = Number(value)\n        if (!Number.isNaN(numValue)) {\n          amount = numValue  // 0  \n        }\n      }\n      \n      //    (10%)  \n      const taxAmount = purchase?.payment_category === '' ? Math.round(amount * 0.1) : 0\n      \n      newItems[index] = {\n        ...newItems[index],\n        //      ( /   )\n        is_amount_manual: true,\n        amount_value: amount,\n        tax_amount_value: taxAmount\n      }\n    } else {\n      //   \n      newItems[index] = {\n        ...newItems[index],\n        [field]: value\n      }\n    }\n    \n    setEditedItems(newItems)\n  }\n\n  const handleAddItem = (e?: React.MouseEvent) => {\n    //   form  submit   \n    e?.preventDefault?.()\n    e?.stopPropagation?.()\n\n    if (!isEditing) return\n\n    //          (/-  )\n    const now = Date.now()\n    if (now - lastAddItemAtRef.current < 350) {\n      logger.warn('[PurchaseDetailModal] handleAddItem   ', {\n        deltaMs: now - lastAddItemAtRef.current,\n      })\n      return\n    }\n    lastAddItemAtRef.current = now\n\n    setEditedItems(prev => {\n      const base = prev || []\n\n      //    \n      const maxLineNumber = base.reduce((max, item) => {\n        const lineNum = item.line_number || 0\n        return lineNum > max ? lineNum : max\n      }, 0)\n\n      const newItem = {\n        item_name: '',\n        specification: '',\n        quantity: 1,\n        unit_price_value: 0,\n        amount_value: 0,\n        remark: '',\n        line_number: maxLineNumber + 1,\n        tempId: `tmp-new-${now}-${Math.random()}`\n      }\n\n      //       \n      return [...base, newItem]\n        .sort((a, b) => {\n          const lineA = a.line_number || 999999\n          const lineB = b.line_number || 999999\n          return lineA - lineB\n        })\n        .map((item, idx) => ({\n          ...item,\n          line_number: idx + 1,\n          stableKey: item.stableKey ?? makeStableKey(item, idx)\n        }))\n    })\n  }\n\n  const handleRemoveItem = (index: number) => {\n    const item = editedItems[index]\n    if (item.id) {\n      setDeletedItemIds([...deletedItemIds, item.id])\n    }\n    const newItems = editedItems\n      .filter((_, i) => i !== index)\n      .sort((a, b) => {\n        const lineA = a.line_number || 999999;\n        const lineB = b.line_number || 999999;\n        return lineA - lineB;\n      })\n      .map((it, idx) => ({\n        ...it,\n        line_number: idx + 1,\n        stableKey: it.stableKey ?? makeStableKey(it, idx)\n      }))\n    setEditedItems(newItems)\n  }\n\n  //   \n  const handlePaymentToggle = async (itemId: number | string, isCompleted: boolean) => {\n    \n    if (!canPurchase) {\n      logger.warn('[handlePaymentToggle]  ', { canPurchase, currentUserRoles })\n      toast.error('   .')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n\n    if (Number.isNaN(numericId)) {\n      logger.error('[handlePaymentToggle]  ID', { itemId, numericId })\n      toast.error('   ID .')\n      return\n    }\n\n    //     -   \n    \n    // items purchase_request_items    - length    \n    if (!purchase) return\n    \n    const purchaseItems = (purchase.items && purchase.items.length > 0) ? purchase.items : []\n    const requestItems = (purchase.purchase_request_items && purchase.purchase_request_items.length > 0) ? purchase.purchase_request_items : []\n    const items = purchaseItems.length > 0 ? purchaseItems : requestItems\n    \n    \n    const targetItem = items.find(item => String(item.id) === itemIdStr)\n    \n    \n    if (!targetItem) {\n      return\n    }\n\n    const itemInfo = `: ${targetItem.item_name}\n: ${targetItem.specification || ''}\n: ${targetItem.quantity?.toLocaleString() || 0}${targetItem.unit || ''}\n: ${targetItem.unit_price_value?.toLocaleString() || 0}\n: ${targetItem.amount_value?.toLocaleString() || 0}`\n\n    const confirmMessage = isCompleted \n      ? `   ?\\n\\n${itemInfo}` \n      : `   ?\\n\\n${itemInfo}`\n    \n    const confirm = window.confirm(confirmMessage)\n    \n    if (!confirm) {\n      return\n    }\n\n    try {\n      \n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_payment_completed: isCompleted,\n          payment_completed_at: isCompleted ? new Date().toISOString() : null\n        })\n        .eq('id', numericId)\n\n      if (error) {\n        throw error\n      }\n      \n\n      //      (/  )\n      if (purchase) {\n        \n        const memoryUpdated = isCompleted \n          ? markItemAsPaymentCompleted(purchase.id, numericId)\n          : markItemAsPaymentCanceled(purchase.id, numericId);\n          \n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]     ', { \n            purchaseId: purchase.id, \n            itemId: numericId,\n            isCompleted\n          });\n        }\n      }\n\n      //     (UI  )\n      setPurchase(prev => {\n        if (!prev) {\n          return null\n        }\n        \n        // items purchase_request_items     - length    \n        const prevItems = (prev.items && prev.items.length > 0) ? prev.items : []\n        const prevRequestItems = (prev.purchase_request_items && prev.purchase_request_items.length > 0) ? prev.purchase_request_items : []\n        const currentItems = prevItems.length > 0 ? prevItems : prevRequestItems\n        const updatedItems = currentItems.map(item => \n          String(item.id) === itemIdStr \n            ? { ...item, is_payment_completed: isCompleted, payment_completed_at: isCompleted ? new Date().toISOString() : null }\n            : item\n        )\n        \n        \n        //    \n        const result = {\n          ...prev,\n          items: prev.items ? updatedItems : prev.items,\n          purchase_request_items: prev.purchase_request_items ? updatedItems : prev.purchase_request_items\n        }\n        \n        return result\n      })\n\n      if (purchase) {\n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate?.(purchaseIdNumber, prev => {\n            const updatedItems = (prev.items || []).map(item =>\n              String(item.id) === itemIdStr\n                ? { ...item, is_payment_completed: isCompleted }\n                : item\n            )\n            const total = updatedItems.length || prev.items?.length || 0\n            const completed = updatedItems.filter(item => item.is_payment_completed).length\n            const allCompleted = total > 0 && completed === total\n            return {\n              ...prev,\n              items: updatedItems,\n              is_payment_completed: allCompleted,\n              payment_completed_at: allCompleted ? new Date().toISOString() : null,\n              payment_completed_by_name: allCompleted ? (currentUserName || prev.payment_completed_by_name) : prev.payment_completed_by_name\n            }\n          })\n        }\n      }\n      \n      toast.success(isCompleted ? ' .' : ' .')\n\n      //         \n      await refreshModalDataWithLock()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n  //     (  + ) -   \n  const handleItemReceiptToggle = async (itemId: number | string, selectedDate: Date, receivedQuantity?: number) => {\n    //    - Realtime   \n    isUpdatingRef.current = true\n    \n    if (!canReceiveItems) {\n      toast.error('   .')\n      isUpdatingRef.current = false\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('   ID .')\n      return\n    }\n\n    //    \n    const currentItem = purchase?.items?.find(item => String(item.id) === itemIdStr) \n      || purchase?.purchase_request_items?.find(item => String(item.id) === itemIdStr)\n    \n    const requestedQty = currentItem?.quantity || 0\n    const currentReceivedQty = currentItem?.received_quantity || 0\n    const newReceivedQty = receivedQuantity !== undefined ? receivedQuantity : requestedQty\n    const totalReceivedQty = currentReceivedQty + newReceivedQty\n    const isFullyReceived = totalReceivedQty >= requestedQty\n    const deliveryStatus: 'pending' | 'partial' | 'received' = totalReceivedQty === 0 ? 'pending' : (isFullyReceived ? 'received' : 'partial')\n\n    //    \n    const existingHistory = (currentItem?.receipt_history as any[]) || []\n    const nextSeq = existingHistory.length + 1\n    const newHistoryItem = {\n      seq: nextSeq,\n      qty: newReceivedQty,\n      date: dateToISOString(selectedDate),\n      by: currentUserName || ''\n    }\n    const updatedHistory = [...existingHistory, newHistoryItem]\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  is_received: isFullyReceived,\n                  delivery_status: deliveryStatus,\n                  actual_received_date: dateToISOString(selectedDate),\n                  received_quantity: totalReceivedQty,\n                  receipt_history: updatedHistory\n                }\n              : item\n          )\n          const total = updatedItems.length || prev.items?.length || 0\n          const completed = updatedItems.filter(item => item.is_received).length\n          const allReceived = total > 0 && completed === total\n\n          return {\n            ...prev,\n            items: updatedItems,\n            is_received: allReceived,\n            received_at: allReceived ? new Date().toISOString() : prev.received_at\n          }\n        })\n      }\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: isFullyReceived,\n          delivery_status: deliveryStatus,\n          received_at: new Date().toISOString(),\n          actual_received_date: dateToISOString(selectedDate),\n          received_quantity: totalReceivedQty,\n          receipt_history: updatedHistory\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      //      (  )\n      if (purchase) {\n        const memoryUpdated = markItemAsReceived(purchase.id, numericId, dateToISOString(selectedDate), totalReceivedQty);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]       ', { \n            purchaseId: purchase.id, \n            itemId: numericId \n          });\n        }\n      }\n\n      //     (  )\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          String(item.id) === itemIdStr \n            ? { \n                ...item, \n                is_received: isFullyReceived, \n                delivery_status: deliveryStatus,\n                received_at: new Date().toISOString(),\n                actual_received_date: dateToISOString(selectedDate),\n                received_quantity: totalReceivedQty,\n                receipt_history: updatedHistory\n              }\n            : item\n        )\n        const updatedRequestItems = prev.purchase_request_items?.map(item => \n          String(item.id) === itemIdStr \n            ? { \n                ...item, \n                is_received: isFullyReceived, \n                delivery_status: deliveryStatus,\n                received_at: new Date().toISOString(),\n                actual_received_date: dateToISOString(selectedDate),\n                received_quantity: totalReceivedQty,\n                receipt_history: updatedHistory\n              }\n            : item\n        )\n        return { \n          ...prev, \n          items: updatedItems,\n          purchase_request_items: updatedRequestItems,\n          updated_at: new Date().toISOString()\n        }\n      })\n\n      applyOptimisticUpdate()\n      \n      const targetItem = purchase?.items?.find(item => String(item.id) === itemIdStr)\n      toast.success(`\"${targetItem?.item_name}\"   .`)\n\n      await refreshModalDataWithLock()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n  //   \n  const handleReceiptCancel = async (itemId: number | string) => {\n    //    - Realtime   \n    isUpdatingRef.current = true\n    \n    if (!canProcessReceipt) {\n      toast.error('   .')\n      isUpdatingRef.current = false\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('   ID .')\n      return\n    }\n\n    const targetItem = purchase?.items?.find(item => String(item.id) === itemIdStr)\n    if (!targetItem) return\n\n    const confirm = window.confirm(`\"${targetItem.item_name}\"   ?`)\n    if (!confirm) return\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  is_received: false,\n                  actual_received_date: undefined\n                }\n              : item\n          )\n          const total = updatedItems.length || prev.items?.length || 0\n          const completed = updatedItems.filter(item => item.is_received).length\n          const allReceived = total > 0 && completed === total\n\n          return {\n            ...prev,\n            items: updatedItems,\n            is_received: allReceived,\n            received_at: allReceived ? prev.received_at : null\n          }\n        })\n      }\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: false,\n          received_at: null,\n          actual_received_date: null,\n          actual_received_by_name: null\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      //    \n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          String(item.id) === itemIdStr \n            ? { ...item, is_received: false, received_at: null, actual_received_date: undefined, actual_received_by_name: undefined }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n      \n      applyOptimisticUpdate()\n\n      toast.success(' .')\n\n      await refreshModalDataWithLock()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n\n  //  \n  const handleApprove = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const approvalType = type === 'middle' ? '1 ' : ' '\n    const confirmMessage = `: ${purchase.purchase_order_number}\\n\\n${approvalType} ?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n    \n    try {\n      const updateData = type === 'middle' \n        ? { \n            middle_manager_status: 'approved'\n          }\n        : { \n            final_manager_status: 'approved'\n          }\n\n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n\n      //     (UI  )\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'approved' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'approved' } : null)\n      }\n\n      //      ( notifyCacheListeners  ->    )\n      updatePurchaseInMemory(String(purchase.id), (prev) => ({\n        ...prev,\n        ...(type === 'middle' \n          ? { middle_manager_status: 'approved' as any }\n          : { final_manager_status: 'approved' as any }\n        )\n      }))\n\n      // Optimistic Update    (/  )\n      if (purchase && onOptimisticUpdate) {\n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate(purchaseIdNumber, prev => {\n            if (type === 'middle') {\n              return {\n                ...prev,\n                middle_manager_status: 'approved' as any\n              }\n            } else {\n              return {\n                ...prev,\n                final_manager_status: 'approved' as any\n              }\n            }\n          })\n        }\n      }\n      \n      toast.success(`${type === 'middle' ? '' : ''}  .`)\n\n      //      \n      await refreshModalDataWithLock()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n  \n  //    (   )\n  const handleCompleteAllPayment = async () => {\n    \n    if (!purchase || !canPurchase) {\n      return\n    }\n    \n    const confirmMessage = `: ${purchase.purchase_order_number}\\n\\n  ?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) {\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const allItems = prev.purchase_request_items || [];\n          const pendingItems = allItems.filter(item => !item.is_payment_completed);\n          \n          const updatedItems = allItems.map(item => \n            !item.is_payment_completed \n              ? { ...item, is_payment_completed: true, payment_completed_at: new Date().toISOString() }\n              : item\n          );\n          \n          return {\n            ...prev,\n            purchase_request_items: updatedItems,\n            items: prev.items ? updatedItems : prev.items,\n            is_payment_completed: updatedItems.every(item => item.is_payment_completed)\n          }\n        })\n      }\n    }\n    \n    try {\n      //     (   )\n      const allItems = purchase.purchase_request_items || [];\n      const pendingItems = allItems.filter(item => !item.is_payment_completed);\n      \n      if (pendingItems.length === 0) {\n        toast.info('   .');\n        return;\n      }\n\n      logger.info(`  : ${pendingItems.length}  ( ${allItems.length} )`);\n      \n      for (const item of pendingItems) {\n        //   DB  (   )\n        const updateData = {\n          is_payment_completed: true,\n          payment_completed_at: new Date().toISOString()\n        };\n\n        const { error } = await supabase\n          .from('purchase_request_items')\n          .update(updateData)\n          .eq('id', item.id);\n\n        if (error) throw error;\n\n        //       (  )\n        const memoryUpdated = markItemAsPaymentCompleted(purchase.id, item.id);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]       ', { \n            purchaseId: purchase.id, \n            itemId: item.id \n          });\n        }\n      }\n\n      toast.success(`${pendingItems.length}   .`);\n\n      //   (  )\n      await refreshModalDataWithLock();\n      const refreshResult = onRefresh?.(true, { silent: true });\n      if (refreshResult instanceof Promise) {\n        await refreshResult;\n      }\n    } catch (error) {\n      logger.error('   ', error);\n      toast.error('    .')\n    }\n  }\n\n  //     \n  const handleItemExpenditure = async (itemId: number | string, date: Date, amount: number) => {\n    if (!purchase || !canReceiptCheck) {\n      toast.error('    .')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      logger.error('  itemId', { itemId })\n      return\n    }\n\n    const targetItem = purchase.items?.find(item => String(item.id) === itemIdStr)\n    if (!targetItem) return\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  expenditure_date: dateToISOString(date),\n                  expenditure_amount: amount\n                }\n              : item\n          )\n          return { ...prev, items: updatedItems }\n        })\n      }\n    }\n\n    try {\n      applyOptimisticUpdate()\n\n      //     (items purchase_request_items  ) -    \n      setPurchase(prev => {\n        if (!prev) return null\n        const currentItems = prev.items || prev.purchase_request_items || []\n        const updatedItems = currentItems.map(item => \n          String(item.id) === itemIdStr\n            ? {\n                ...item,\n                expenditure_date: dateToISOString(date),\n                expenditure_amount: amount\n              }\n            : item\n        )\n        const totalExpenditure = updatedItems.reduce((sum, item) => sum + (item.expenditure_amount || 0), 0)\n        //    React   \n        return { \n          ...prev, \n          items: updatedItems,\n          purchase_request_items: updatedItems,\n          total_expenditure_amount: totalExpenditure,\n          updated_at: new Date().toISOString() //    \n        }\n      })\n\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          expenditure_date: dateToISOString(date),\n          expenditure_amount: amount\n        })\n        .eq('id', numericId)\n\n      if (error) {\n        logger.error('  DB  ', { error, itemId: numericId })\n        throw error\n      }\n\n      // purchase_requests total_expenditure_amount \n      const allItemsForTotal = purchase.items || purchase.purchase_request_items || []\n      const totalExpenditure = allItemsForTotal.reduce((sum, item) => {\n        if (String(item.id) === itemIdStr) {\n          return sum + amount\n        }\n        return sum + (item.expenditure_amount || 0)\n      }, 0)\n\n      await supabase\n        .from('purchase_requests')\n        .update({ total_expenditure_amount: totalExpenditure })\n        .eq('id', purchaseIdNumber)\n\n      //      ( UI ) - DB   \n      if (purchase?.id) {\n        const memoryUpdated = markItemAsExpenditureSet(purchase.id, numericId, dateToISOString(date), amount)\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]      ', { \n            purchaseId: purchase.id, \n            itemId: numericId \n          })\n        }\n      }\n\n      toast.success(`\"${targetItem.item_name}\"    .`)\n\n      await refreshModalDataWithLock()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      logger.error('    ', error)\n      toast.error('     .')\n    }\n  }\n\n  //     \n  const handleBulkExpenditure = async (date: Date, amount: number) => {\n    if (!purchase || !canReceiptCheck) {\n      toast.error('    .')\n      return\n    }\n\n    const confirmMessage = `: ${purchase.purchase_order_number}\\n\\n   ?\\n: ${date.toLocaleDateString('ko-KR')}\\n : ${amount.toLocaleString()}\\n\\n* :        ,    .`\n    \n    if (!window.confirm(confirmMessage)) {\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item => ({\n            ...item,\n            expenditure_date: dateToISOString(date),\n            expenditure_amount: null\n          }))\n          return { \n            ...prev, \n            items: updatedItems,\n            total_expenditure_amount: amount\n          }\n        })\n      }\n    }\n\n    try {\n      applyOptimisticUpdate()\n\n      const allItems = purchase.items || purchase.purchase_request_items || []\n      \n      if (allItems.length === 0) {\n        toast.error(' .')\n        return\n      }\n\n      //    \n      setPurchase(prev => {\n        if (!prev) return null\n        const allItems = prev.items || prev.purchase_request_items || []\n        const updatedItems = allItems.map(item => ({\n            ...item,\n            expenditure_date: dateToISOString(date),\n            expenditure_amount: null\n        }))\n        \n        return { \n          ...prev, \n          items: updatedItems,\n          purchase_request_items: updatedItems,\n          total_expenditure_amount: amount,\n          updated_at: new Date().toISOString()\n        }\n      })\n\n      // DB  -   ( null)\n      const { error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .update({\n          expenditure_date: dateToISOString(date),\n          expenditure_amount: null\n        })\n        .in('id', allItems.map(item => item.id))\n\n      if (itemsError) {\n        logger.error('    DB  ', { error: itemsError })\n        throw itemsError\n      }\n\n      // DB  -  \n      const { error: requestError } = await supabase\n        .from('purchase_requests')\n        .update({ total_expenditure_amount: amount })\n        .eq('id', purchaseIdNumber)\n\n      if (requestError) {\n        logger.error('    DB  ', { error: requestError })\n        throw requestError\n      }\n\n      //      ( UI )\n      markBulkExpenditureSet(purchase.id, dateToISOString(date), amount)\n\n      toast.success('   .')\n    } catch (error) {\n      logger.error('     ', error)\n      toast.error('      .')\n    }\n  }\n\n  //     (   )\n  const handleCompleteAllStatement = async (selectedDate: Date) => {\n    if (!purchase || !canReceiptCheck) {\n      return\n    }\n\n    const formattedDate = selectedDate.toLocaleDateString('ko-KR', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit'\n    })\n\n    const confirmMessage = `: ${purchase.purchase_order_number}\n\n   ?`\n    \n    if (!window.confirm(confirmMessage)) {\n      return\n    }\n\n    const selectedDateIso = dateToISOString(selectedDate)\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const allItems = prev.purchase_request_items || [];\n          const pendingItems = allItems.filter(item => !item.is_statement_received);\n          \n          const updatedItems = allItems.map(item => \n            !item.is_statement_received \n              ? { \n                  ...item, \n                  is_statement_received: true, \n                  statement_received_date: selectedDateIso,\n                  statement_received_by_name: currentUserName || null\n                }\n              : item\n          );\n          \n          return {\n            ...prev,\n            purchase_request_items: updatedItems,\n            items: prev.items ? updatedItems : prev.items,\n            is_statement_received: updatedItems.every(item => item.is_statement_received),\n            statement_received_at: selectedDateIso\n          }\n        })\n      }\n    }\n\n    try {\n      //     (    )\n      const allItems = purchase.purchase_request_items || [];\n      const pendingItems = allItems.filter(item => !item.is_statement_received);\n      \n      if (pendingItems.length === 0) {\n        toast.info('    .');\n        return;\n      }\n\n      logger.info(`   : ${pendingItems.length}  ( ${allItems.length} )`);\n      \n      for (const item of pendingItems) {\n        //   DB  (   )\n        const updateData = {\n          is_statement_received: true,\n          statement_received_date: selectedDateIso,\n          statement_received_by_name: currentUserName || null\n        };\n\n        const { error } = await supabase\n          .from('purchase_request_items')\n          .update(updateData)\n          .eq('id', item.id);\n\n        if (error) throw error;\n\n        //       (  )\n        const memoryUpdated = markItemAsStatementReceived(purchase.id, item.id, selectedDateIso, currentUserName || undefined);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]        ', { \n            purchaseId: purchase.id, \n            itemId: item.id \n          });\n        }\n      }\n\n      toast.success(`${pendingItems.length}    .`);\n\n      //   (  )\n      await refreshModalDataWithLock();\n      const refreshResult = onRefresh?.(true, { silent: true });\n      if (refreshResult instanceof Promise) {\n        await refreshResult;\n      }\n    } catch (error) {\n      logger.error('    ', error)\n      toast.error('     .')\n    }\n  }\n\n  //    (  + )\n  const handleCompleteAllReceipt = async (selectedDate: Date, receivedQuantity?: number) => {\n    if (!purchase || !canReceiveItems) {\n      return\n    }\n\n    //   \n    const confirmMessage = `: ${purchase.purchase_order_number}\n\n  ?`\n    \n    if (!window.confirm(confirmMessage)) {\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    try {\n      //     (   )\n      const allItems = purchase.purchase_request_items || [];\n      const pendingItems = allItems.filter(item => !item.is_received);\n      \n      const applyOptimisticUpdate = () => {\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate?.(purchaseIdNumber, prev => {\n            const updatedItems = (prev.items || []).map(item => {\n              const pendingItem = pendingItems.find((p: any) => String(p.id) === String(item.id))\n              if (pendingItem) {\n                //   , receivedQuantity  (quantity)  \n                return {\n                  ...item,\n                  is_received: true,\n                  actual_received_date: item.actual_received_date || dateToISOString(selectedDate),\n                  received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n                }\n              }\n              return item\n            })\n            const updatedRequestItems = (prev.purchase_request_items || []).map(item => {\n              const pendingItem = pendingItems.find((p: any) => String(p.id) === String(item.id))\n              if (pendingItem) {\n                //   , receivedQuantity  (quantity)  \n                return {\n                  ...item,\n                  is_received: true,\n                  actual_received_date: item.actual_received_date || dateToISOString(selectedDate),\n                  received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n                }\n              }\n              return item\n            })\n\n            return {\n              ...prev,\n              items: updatedItems,\n              purchase_request_items: updatedRequestItems,\n              is_received: true,\n              received_at: new Date().toISOString(),\n              updated_at: new Date().toISOString()\n            }\n          })\n        }\n      }\n      \n      if (pendingItems.length === 0) {\n        toast.info('   .');\n        return;\n      }\n\n      logger.info(`  : ${pendingItems.length}  ( ${allItems.length} )`);\n      \n      // Optimistic Update  \n      applyOptimisticUpdate()\n      \n      //    \n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => {\n          const pendingItem = pendingItems.find(p => String(p.id) === String(item.id))\n          if (pendingItem) {\n            // receivedQuantity  (quantity)  \n            return {\n              ...item,\n              is_received: true,\n              received_at: new Date().toISOString(),\n              actual_received_date: dateToISOString(selectedDate),\n              received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n            }\n          }\n          return item\n        }) || []\n        const updatedRequestItems = prev.purchase_request_items?.map(item => {\n          const pendingItem = pendingItems.find(p => String(p.id) === String(item.id))\n          if (pendingItem) {\n            // receivedQuantity  (quantity)  \n            return {\n              ...item,\n              is_received: true,\n              received_at: new Date().toISOString(),\n              actual_received_date: dateToISOString(selectedDate),\n              received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n            }\n          }\n          return item\n        }) || []\n        const total = updatedItems.length\n        const completed = updatedItems.filter(item => item.is_received).length\n        const allReceived = total > 0 && completed === total\n        \n        return {\n          ...prev,\n          items: updatedItems,\n          purchase_request_items: updatedRequestItems,\n          is_received: allReceived,\n          received_at: allReceived ? new Date().toISOString() : prev.received_at,\n          updated_at: new Date().toISOString()\n        }\n      })\n      \n      for (const item of pendingItems) {\n        //   DB  (   )\n        // receivedQuantity  (quantity)  \n        const updateData = {\n          actual_received_date: dateToISOString(selectedDate),\n          is_received: true,\n          received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity //     \n        };\n\n        const { error } = await supabase\n          .from('purchase_request_items')\n          .update(updateData)\n          .eq('id', item.id);\n\n        if (error) throw error;\n\n        //       (  )\n        // receivedQuantity  (quantity)  \n        const itemReceivedQuantity = receivedQuantity !== undefined ? receivedQuantity : item.quantity\n        const memoryUpdated = markItemAsReceived(purchase.id, item.id, dateToISOString(selectedDate), itemReceivedQuantity);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]       ', { \n            purchaseId: purchase.id, \n            itemId: item.id \n          });\n        }\n      }\n\n      toast.success(`${pendingItems.length}   .`);\n\n      //   (  )\n      await refreshModalDataWithLock();\n      const refreshResult = onRefresh?.(true, { silent: true });\n      if (refreshResult instanceof Promise) {\n        await refreshResult;\n      }\n    } catch (error) {\n      logger.error('   ', error)\n      toast.error('    .')\n    }\n  }\n  \n\n  //  \n  const handleReject = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const reason = window.prompt('  :')\n    if (!reason) return\n    \n    try {\n      const updateData = type === 'middle'\n        ? {\n            middle_manager_status: 'rejected'\n          }\n        : {\n            final_manager_status: 'rejected'\n          }\n      \n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n      \n      //     (UI  )\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'rejected' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'rejected' } : null)\n      }\n      \n      toast.success(`${type === 'middle' ? '' : ''}  .`)\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n  const renderItemRow = (item: any, index: number, dragProps?: SortableRenderProps, rowKey?: string) => {\n    const stableKey = rowKey || item?.stableKey || getSortableId(item, index)\n    const rowClass = `px-2 sm:px-3 py-1 border-b border-gray-50 hover:bg-gray-50/50 relative overflow-visible w-fit ${isEditing ? 'pl-7 sm:pl-8' : ''} ${dragProps?.isDragging ? 'shadow-lg ring-2 ring-blue-200 bg-white' : ''}`\n    const rowProps: any = {\n      className: rowClass,\n      key: stableKey\n    }\n    if (dragProps?.setNodeRef) rowProps.ref = dragProps.setNodeRef\n    if (dragProps?.style) rowProps.style = dragProps.style\n\n    return (\n      <div {...rowProps}>\n        {isEditing && dragProps && (\n          <button\n            className=\"absolute left-1 top-2 sm:top-3 text-gray-400 hover:text-gray-600 p-1 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200\"\n            {...dragProps.attributes}\n            {...dragProps.listeners}\n            aria-label=\"   \"\n          >\n            <GripVertical className=\"w-3.5 h-3.5\" />\n          </button>\n        )}\n        {/* Desktop Layout */}\n        <div className={`hidden sm:grid items-center gap-1 overflow-visible w-fit`} style={{\n          gridTemplateColumns: getGridTemplateColumns()\n        }}>\n          {/*  */}\n          <div className=\"flex justify-center items-center text-[11px] text-gray-500 font-medium -ml-2 sm:-ml-3\">\n            {item.line_number || index + 1}\n          </div>\n          {/*  */}\n          <div className=\"min-w-0 relative overflow-visible flex items-center\">\n            {isEditing ? (\n              <Input\n                value={item.item_name}\n                onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                onFocus={() => setFocusedInput(`item_name_${index}`)}\n                onBlur={() => setFocusedInput(null)}\n                className={`modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                  focusedInput === `item_name_${index}` \n                    ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal' \n                    : '!h-5 !truncate'\n                }`}\n                placeholder=\"\"\n              />\n            ) : (\n              <div \n                className=\"modal-value\" \n                style={{\n                  whiteSpace: 'normal',\n                  wordBreak: 'break-all',\n                  overflowWrap: 'break-word',\n                  hyphens: 'none',\n                  WebkitHyphens: 'none',\n                  MozHyphens: 'none',\n                  msHyphens: 'none',\n                  lineHeight: '1.4',\n                  maxHeight: '2.8em',\n                  overflow: 'hidden',\n                  display: '-webkit-box',\n                  WebkitLineClamp: 2,\n                  WebkitBoxOrient: 'vertical'\n                }}\n                title={item.item_name || ' '}\n              >\n                {item.item_name || ' '}\n              </div>\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"min-w-0 relative overflow-visible flex items-center w-full\">\n            {isEditing ? (\n              <Input\n                value={item.specification}\n                onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                onFocus={() => setFocusedInput(`specification_${index}`)}\n                onBlur={() => setFocusedInput(null)}\n                className={`modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                  focusedInput === `specification_${index}` \n                    ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal' \n                    : '!h-5 !truncate'\n                }`}\n                placeholder=\"\"\n              />\n            ) : (\n              <div \n                className=\"text-[11px] text-gray-600 font-medium\" \n                style={{\n                  whiteSpace: 'normal',\n                  wordBreak: 'break-all',\n                  overflowWrap: 'break-word',\n                  hyphens: 'none',\n                  WebkitHyphens: 'none',\n                  MozHyphens: 'none',\n                  msHyphens: 'none',\n                  lineHeight: '1.4',\n                  maxHeight: '2.8em',\n                  overflow: 'hidden',\n                  display: '-webkit-box',\n                  WebkitLineClamp: 2,\n                  WebkitBoxOrient: 'vertical'\n                }}\n                title={item.specification || '-'}\n              >\n                {item.specification || '-'}\n              </div>\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"text-center min-w-0 flex items-center justify-center\">\n            {isEditing ? (\n              (activeTab === 'receipt' || activeTab === 'done') ? (\n                <div className=\"flex flex-col items-center gap-0.5 w-full\">\n                  <Input\n                    type=\"number\"\n                    value={item.quantity}\n                    onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                    className=\"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                    placeholder=\"\"\n                    max=\"99999\"\n                    disabled={canEditLimited && !canEditAll}\n                  />\n                  <div className=\"flex items-center gap-0.5 w-full\">\n                    <span className=\"text-[9px] text-gray-500\">/</span>\n                    <Input\n                      type=\"number\"\n                      value={item.received_quantity ?? ''}\n                      onChange={(e) => handleItemChange(index, 'received_quantity', e.target.value ? Number(e.target.value) : null)}\n                      className=\"border-gray-200 rounded-lg text-center flex-1 !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                      placeholder=\"\"\n                      max=\"99999\"\n                      disabled={canEditLimited && !canEditAll}\n                    />\n                  </div>\n                </div>\n              ) : (\n                <Input\n                  type=\"number\"\n                  value={item.quantity}\n                  onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                  className=\"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                  placeholder=\"\"\n                  max=\"99999\"\n                  disabled={canEditLimited && !canEditAll}\n                />\n              )\n            ) : (\n              (activeTab === 'receipt' || activeTab === 'done') ? (\n                (() => {\n                  const quantity = item.quantity || 0\n                  const receivedQuantity = item.received_quantity ?? 0\n                  const shouldWrap = quantity >= 100 || receivedQuantity >= 100\n                  const hasReceived = receivedQuantity > 0\n                  \n                  if (shouldWrap) {\n                    return (\n                      <div className=\"flex flex-col items-center leading-tight\">\n                        <div className={`modal-subtitle ${hasReceived ? 'text-gray-400' : ''}`}>{quantity}</div>\n                        <div className={`modal-subtitle ${hasReceived ? '' : 'text-gray-400'}`}>/{receivedQuantity}</div>\n                      </div>\n                    )\n                  } else {\n                    return (\n                      <span className=\"modal-subtitle\">\n                        <span className={hasReceived ? 'text-gray-400' : ''}>{quantity}</span>\n                        <span className={hasReceived ? '' : 'text-gray-400'}>/{receivedQuantity}</span>\n                      </span>\n                    )\n                  }\n                })()\n              ) : (\n                <span className=\"modal-subtitle\">{item.quantity || 0}</span>\n              )\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"text-right min-w-0 flex items-center justify-end\">\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={item.unit_price_value ?? 0}\n                onChange={(e) => handleItemChange(index, 'unit_price_value', Number(e.target.value))}\n                onWheel={(e) => e.currentTarget.blur()}\n                className=\"border-gray-200 rounded-lg text-right w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                placeholder=\"\"\n                max=\"100000000000\"\n              />\n            ) : (\n              <span className=\"modal-subtitle\">\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : formatMoney(item.unit_price_value ?? 0, getItemDisplayCurrency(item))}\n              </span>\n            )}\n          </div>\n          \n          {/*  (  ) */}\n          <div className=\"text-right min-w-0 flex items-center justify-end\">\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={item.amount_value || 0}\n                onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                onWheel={(e) => e.currentTarget.blur()}\n                className=\"border-gray-200 rounded-lg w-full !h-6 !px-1.5 !py-0.5 !text-[10px] font-normal text-gray-600 focus:border-blue-400 text-right\"\n                placeholder=\"\"\n              />\n            ) : (\n              <span className=\"modal-value\">\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : formatMoney(item.amount_value || 0, getItemDisplayCurrency(item))}\n              </span>\n            )}\n          </div>\n          \n          {/*  -       */}\n          {purchase?.payment_category === '' && (\n            <div className=\"text-right min-w-0 flex items-center justify-end\">\n              <span className={isEditing ? \"modal-subtitle\" : \"modal-value\"}>\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : formatMoney(item.tax_amount_value || 0, getItemDisplayCurrency(item))}\n              </span>\n            </div>\n          )}\n          \n          {/*  */}\n          <div className=\"text-center min-w-0 flex items-center justify-center\">\n            {isEditing ? (\n              <Input\n                value={item.link || ''}\n                onChange={(e) => handleItemChange(index, 'link', e.target.value)}\n                className=\"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                placeholder=\"(URL)\"\n              />\n            ) : (\n              item.link ? (\n                <a\n                  href={item.link}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"text-blue-600 hover:text-blue-800 underline text-[11px]\"\n                  onClick={(e) => e.stopPropagation()}\n                >\n                  \n                </a>\n              ) : (\n                <span className=\"text-gray-400 text-[11px]\">-</span>\n              )\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"min-w-0 flex justify-center items-center text-center relative overflow-visible\" style={{ width: '150px', maxWidth: '150px', minWidth: '150px' }}>\n            {isEditing ? (\n              <Input\n                value={item.remark || ''}\n                disabled={canEditLimited && !canEditAll}\n                onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                onFocus={() => setFocusedInput(`remark_${index}`)}\n                onBlur={() => setFocusedInput(null)}\n                className={`modal-label border-gray-200 rounded-lg text-center w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                  focusedInput === `remark_${index}` \n                    ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal !text-left' \n                    : '!h-5 !truncate'\n                }`}\n                placeholder=\"\"\n              />\n            ) : (\n              <div \n                className=\"text-[11px] text-gray-600 font-medium\"\n                style={{\n                  width: '150px',\n                  maxWidth: '150px',\n                  minWidth: '150px',\n                  boxSizing: 'border-box',\n                  whiteSpace: 'normal',\n                  wordBreak: 'break-all',\n                  overflowWrap: 'break-word',\n                  hyphens: 'none',\n                  WebkitHyphens: 'none',\n                  MozHyphens: 'none',\n                  msHyphens: 'none',\n                  lineHeight: '1.4',\n                  maxHeight: '2.8em',\n                  overflow: 'hidden',\n                  display: '-webkit-box',\n                  WebkitLineClamp: 2,\n                  WebkitBoxOrient: 'vertical'\n                }}\n                title={item.remark || '-'}\n              >\n                {item.remark || '-'}\n              </div>\n            )}\n          </div>\n          \n          {/* / -   */}\n          {activeTab !== 'pending' && (\n            <div className=\"text-center flex justify-center items-center\">\n              {isEditing ? (\n                <Button\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => handleRemoveItem(index)}\n                  className=\"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6\"\n                  disabled={canEditLimited && !canEditAll}\n                >\n                  <Trash2 className=\"w-3 h-3\" />\n                </Button>\n              ) : (\n                <>\n                  {activeTab === 'purchase' && (\n                  <div className=\"flex flex-col items-center gap-1\">\n                    {/*   */}\n                    <div className=\"flex justify-center\">\n                      {canPurchase ? (\n                        <button\n                          onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                          className={`${\n                            item.is_payment_completed\n                              ? 'button-toggle-active bg-orange-500 hover:bg-orange-600 text-white'\n                              : 'button-toggle-inactive'\n                          }`}\n                        >\n                          {item.is_payment_completed ? '' : ''}\n                        </button>\n                      ) : (\n                        <span className={`${\n                          item.is_payment_completed \n                            ? 'button-toggle-active bg-orange-500 text-white' \n                            : 'button-waiting-inactive'\n                        }`}>\n                          {item.is_payment_completed ? '' : ''}\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                )}\n                \n                {activeTab === 'receipt' && (\n                  <div className=\"flex justify-center\">\n                    {canReceiveItems ? (\n                      actualReceivedAction.isCompleted(item) ? (\n                        //   - \n                        <button\n                          onClick={() => {\n                            actualReceivedAction.handleCancel(item.id, {\n                              item_name: item.item_name,\n                              specification: item.specification,\n                              quantity: item.quantity,\n                              unit_price_value: item.unit_price_value,\n                              amount_value: item.amount_value,\n                              remark: item.remark\n                            })\n                          }}\n                          className=\"button-action-primary\"\n                        >\n                          {actualReceivedAction.config.completedText}\n                        </button>\n                      ) : actualReceivedAction.isPartiallyReceived(item) ? (\n                        //   -  (  )\n                        <DateQuantityPickerPopover\n                          onConfirm={(date, quantity) => {\n                            handleItemReceiptToggle(item.id, date, quantity)\n                          }}\n                          placeholder=\"  \"\n                          align=\"center\"\n                          side=\"bottom\"\n                          maxQuantity={actualReceivedAction.getRemainingQuantity(item)}\n                          quantityInfoText={`: ${actualReceivedAction.getRemainingQuantity(item)}`}\n                        >\n                          <button className=\"button-base bg-blue-300 hover:bg-blue-400 text-white\">\n                            \n                          </button>\n                        </DateQuantityPickerPopover>\n                      ) : (\n                        //   - \n                        <DateQuantityPickerPopover\n                          onConfirm={(date, quantity) => {\n                            handleItemReceiptToggle(item.id, date, quantity)\n                          }}\n                          placeholder=\"  \"\n                          align=\"center\"\n                          side=\"bottom\"\n                          defaultQuantity={item.received_quantity ?? undefined}\n                          maxQuantity={item.quantity}\n                        >\n                          <button className=\"button-toggle-inactive\">\n                            {actualReceivedAction.config.waitingText}\n                          </button>\n                        </DateQuantityPickerPopover>\n                      )\n                    ) : (\n                      <span className={`${\n                        actualReceivedAction.isCompleted(item)\n                          ? 'button-action-primary' \n                          : actualReceivedAction.isPartiallyReceived(item)\n                          ? 'button-base bg-blue-300 text-white'\n                          : 'button-waiting-inactive'\n                      }`}>\n                        {actualReceivedAction.isCompleted(item) \n                          ? actualReceivedAction.config.completedText \n                          : actualReceivedAction.isPartiallyReceived(item)\n                          ? ''\n                          : actualReceivedAction.config.waitingText}\n                      </span>\n                    )}\n                  </div>\n                )}\n                \n                {activeTab === 'done' && (\n                  <div className=\"flex justify-center\">\n                    {canReceiveItems ? (\n                      actualReceivedAction.isCompleted(item) ? (\n                        //   -  \n                        <button\n                          onClick={() => {\n                            actualReceivedAction.handleCancel(item.id, {\n                              item_name: item.item_name,\n                              specification: item.specification,\n                              quantity: item.quantity,\n                              unit_price_value: item.unit_price_value,\n                              amount_value: item.amount_value,\n                              remark: item.remark\n                            })\n                          }}\n                          className=\"button-base bg-blue-500 hover:bg-blue-600 text-white\"\n                        >\n                          {actualReceivedAction.config.completedText}\n                        </button>\n                      ) : actualReceivedAction.isPartiallyReceived(item) ? (\n                        //   -   \n                        <DateQuantityPickerPopover\n                          onConfirm={(date, quantity) => {\n                            handleItemReceiptToggle(item.id, date, quantity)\n                          }}\n                          placeholder=\"  \"\n                          align=\"center\"\n                          side=\"bottom\"\n                          maxQuantity={actualReceivedAction.getRemainingQuantity(item)}\n                          quantityInfoText={`: ${actualReceivedAction.getRemainingQuantity(item)}`}\n                        >\n                          <button className=\"button-base bg-blue-300 hover:bg-blue-400 text-white\">\n                            \n                          </button>\n                        </DateQuantityPickerPopover>\n                      ) : (\n                        //  \n                        <DatePickerPopover\n                          onDateSelect={(date) => {\n                            actualReceivedAction.handleConfirm(item.id, date, {\n                              item_name: item.item_name,\n                              specification: item.specification,\n                              quantity: item.quantity,\n                              unit_price_value: item.unit_price_value,\n                              amount_value: item.amount_value,\n                              remark: item.remark\n                            })\n                          }}\n                          placeholder=\"   \"\n                          align=\"center\"\n                          side=\"bottom\"\n                        >\n                          <button className=\"button-base border border-gray-300 text-gray-600 bg-white hover:bg-gray-50\">\n                            {actualReceivedAction.config.waitingText}\n                          </button>\n                        </DatePickerPopover>\n                      )\n                    ) : (\n                      <span className={`button-base ${\n                        actualReceivedAction.isCompleted(item)\n                          ? 'bg-blue-500 hover:bg-blue-600 text-white' \n                          : actualReceivedAction.isPartiallyReceived(item)\n                          ? 'bg-blue-300 text-white'\n                          : 'border border-gray-300 text-gray-600 bg-white hover:bg-gray-50'\n                      }`}>\n                        {actualReceivedAction.isCompleted(item) \n                          ? '' \n                          : actualReceivedAction.isPartiallyReceived(item)\n                          ? ''\n                          : ''}\n                      </span>\n                    )}\n                  </div>\n                )}\n                \n                {activeTab !== 'purchase' && activeTab !== 'receipt' && activeTab !== 'done' && (\n                  <div className=\"flex justify-center\">\n                    <span className=\"badge-text\">-</span>\n                  </div>\n                )}\n              </>\n            )}\n            </div>\n          )}\n          \n          {/*    -    (  ) */}\n          {activeTab === 'receipt' && (\n            <div className=\"text-center flex justify-center items-center pl-2\">\n              {actualReceivedAction.getCompletedDate(item) ? (\n                <div className=\"modal-subtitle text-green-700\">\n                  {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                    year: 'numeric',\n                    month: '2-digit',\n                    day: '2-digit'\n                  })}\n                </div>\n              ) : (\n                <span className=\"modal-subtitle text-gray-400\">-</span>\n              )}\n            </div>\n          )}\n\n          {/*   -  +  / */}\n          {showStatementColumns && (\n            <div className=\"text-center flex justify-center items-center\">\n              {canReceiptCheck ? (\n                statementReceivedAction.isCompleted(item) ? (\n                  <button\n                    onClick={() => {\n                      statementReceivedAction.handleCancel(item.id, {\n                        item_name: item.item_name,\n                        specification: item.specification,\n                        quantity: item.quantity,\n                        unit_price_value: item.unit_price_value,\n                        amount_value: item.amount_value,\n                        remark: item.remark\n                      })\n                    }}\n                    className=\"button-action-primary hover:bg-green-600\"\n                    title=\"   \"\n                  >\n                    {statementReceivedAction.config.completedText}\n                  </button>\n                ) : (\n                  <DatePickerPopover\n                    onDateSelect={(date) => {\n                      statementReceivedAction.handleConfirm(item.id, date, {\n                        item_name: item.item_name,\n                        specification: item.specification,\n                        quantity: item.quantity,\n                        unit_price_value: item.unit_price_value,\n                        amount_value: item.amount_value,\n                        remark: item.remark\n                      })\n                    }}\n                    placeholder=\"  \"\n                    align=\"center\"\n                    side=\"bottom\"\n                  >\n                    <button \n                      className=\"button-toggle-inactive\"\n                      onClick={() => {}}\n                    >\n                      {statementReceivedAction.config.waitingText}\n                    </button>\n                  </DatePickerPopover>\n                )\n              ) : (\n                <span className={`${\n                  statementReceivedAction.isCompleted(item)\n                    ? 'button-action-primary' \n                    : 'button-waiting-inactive'\n                }`}>\n                  {statementReceivedAction.isCompleted(item) ? statementReceivedAction.config.completedText : statementReceivedAction.config.waitingText}\n                </span>\n              )}\n            </div>\n          )}\n\n          {/*   -  +  / */}\n          {showStatementColumns && (\n            <div className=\"text-center flex justify-center items-center\">\n              {statementReceivedAction.getCompletedDate(item) ? (\n                <div className=\"modal-subtitle text-blue-700\">\n                  {new Date(statementReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                    year: 'numeric',\n                    month: '2-digit',\n                    day: '2-digit'\n                  })}\n                </div>\n              ) : (\n                <span className=\"modal-subtitle text-gray-400\">-</span>\n              )}\n            </div>\n          )}\n\n          {/*  -      */}\n          {showExpenditureColumn && (\n            <div className=\"text-center flex justify-center items-center\">\n              {(() => {\n                const hasExpenditure = !!item.expenditure_date\n                const hasExpenditureAmount = item.expenditure_amount !== null && item.expenditure_amount !== undefined\n                \n                if (canReceiptCheck) {\n                  return hasExpenditure ? (\n                    <div className=\"w-full px-1 leading-none\">\n                      <div className=\"text-blue-700 text-[9px] leading-[1.1] font-normal\">\n                        {(() => {\n                          const date = new Date(item.expenditure_date)\n                          const year = date.getFullYear().toString().slice(-2)\n                          const month = (date.getMonth() + 1).toString().padStart(2, '0')\n                          const day = date.getDate().toString().padStart(2, '0')\n                          return `${year}.${month}.${day}`\n                        })()}\n                      </div>\n                      <div className=\"text-gray-700 text-[9px] leading-[1.1] font-normal\">\n                        {!canViewFinancialInfo \n                          ? '-' \n                          : (hasExpenditureAmount ? `${Number(item.expenditure_amount).toLocaleString()}` : '')}\n                      </div>\n                    </div>\n                  ) : (\n                    <DateAmountPickerPopover\n                      onConfirm={(date, amount) => handleItemExpenditure(item.id, date, amount)}\n                      placeholder=\"   \"\n                      align=\"center\"\n                      side=\"bottom\"\n                    >\n                      <button className=\"button-toggle-inactive\">\n                        \n                      </button>\n                    </DateAmountPickerPopover>\n                  )\n                } else {\n                  return hasExpenditure ? (\n                    <div className=\"w-full px-1 leading-none\">\n                      <div className=\"text-blue-700 text-[9px] leading-[1.1] font-normal\">\n                        {(() => {\n                          const date = new Date(item.expenditure_date)\n                          const year = date.getFullYear().toString().slice(-2)\n                          const month = (date.getMonth() + 1).toString().padStart(2, '0')\n                          const day = date.getDate().toString().padStart(2, '0')\n                          return `${year}.${month}.${day}`\n                        })()}\n                      </div>\n                      <div className=\"text-gray-700 text-[9px] leading-[1.1] font-normal\">\n                        {!canViewFinancialInfo \n                          ? '-' \n                          : (hasExpenditureAmount ? `${Number(item.expenditure_amount).toLocaleString()}` : '')}\n                      </div>\n                    </div>\n                  ) : (\n                    <span className=\"modal-subtitle text-gray-400\">-</span>\n                  )\n                }\n              })()}\n            </div>\n          )}\n\n        </div>\n        \n        {/* Mobile Layout */}\n        <div className=\"block sm:hidden space-y-2\">\n          <div className=\"flex justify-between items-start\">\n            <div className=\"flex-1 min-w-0 relative\">\n              {isEditing ? (\n                <Input\n                  value={item.item_name}\n                  onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                  onFocus={() => setFocusedInput(`m_item_name_${index}`)}\n                  onBlur={() => setFocusedInput(null)}\n                  className={`modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                    focusedInput === `m_item_name_${index}` \n                      ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal' \n                      : '!h-5 !truncate'\n                  }`}\n                  placeholder=\"\"\n                />\n              ) : (\n                <div className=\"modal-value font-medium\">{item.item_name || ' '}</div>\n              )}\n              {isEditing ? (\n                <Input\n                  value={item.specification}\n                  onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                  onFocus={() => setFocusedInput(`m_specification_${index}`)}\n                  onBlur={() => setFocusedInput(null)}\n                  className={`modal-label border-gray-200 rounded-lg mt-1 w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                    focusedInput === `m_specification_${index}` \n                      ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal !w-full' \n                      : '!h-5 !truncate'\n                  }`}\n                  placeholder=\"\"\n                />\n              ) : (\n                <div className=\"modal-subtitle text-gray-500\">{item.specification || '-'}</div>\n              )}\n            </div>\n            <div className=\"ml-3 text-right flex-shrink-0\">\n              {isEditing ? (\n                <Input\n                  type=\"number\"\n                  value={item.amount_value || 0}\n                  onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                  onWheel={(e) => e.currentTarget.blur()}\n                  className=\"border-gray-200 rounded-lg w-24 !h-6 !px-1.5 !py-0.5 !text-[10px] font-normal text-gray-600 focus:border-blue-400 text-right\"\n                  placeholder=\"\"\n                />\n              ) : (\n                <div className=\"modal-value font-semibold\">{formatMoney(item.amount_value || 0, getItemDisplayCurrency(item))}</div>\n              )}\n              <div className=\"text-[10px] text-gray-500 mt-0.5\">\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : `${formatMoney(item.unit_price_value || 0, getItemDisplayCurrency(item))}`} / \n              </div>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-2\">\n            <div>\n              <span className=\"text-gray-500 text-xs\"></span>\n              {isEditing ? (\n                (activeTab === 'receipt' || activeTab === 'done') ? (\n                  <div className=\"grid grid-cols-2 gap-1 mt-1\">\n                    <Input\n                      type=\"number\"\n                      value={item.quantity}\n                      onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                      className=\"border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                      placeholder=\"\"\n                      max=\"99999\"\n                    />\n                    <Input\n                      type=\"number\"\n                      value={item.received_quantity ?? ''}\n                      onChange={(e) => handleItemChange(index, 'received_quantity', e.target.value ? Number(e.target.value) : null)}\n                      className=\"border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                      placeholder=\"\"\n                      max=\"99999\"\n                    />\n                  </div>\n                ) : (\n                  <Input\n                    type=\"number\"\n                    value={item.quantity}\n                    onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                    className=\"border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400 mt-1\"\n                    placeholder=\"\"\n                    max=\"99999\"\n                  />\n                )\n              ) : (\n                <div className=\"modal-subtitle mt-1\">\n                  {activeTab === 'receipt' || activeTab === 'done' ? (\n                    <>\n                      <span className=\"text-gray-500\">{item.quantity || 0}</span>\n                      <span className=\"text-gray-400\">/{item.received_quantity ?? 0}</span>\n                    </>\n                  ) : (\n                    item.quantity || 0\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <span className=\"text-gray-500 text-xs\"></span>\n              <div className=\"mt-1\">\n                {isEditing ? (\n                  <Input\n                    value={item.link || ''}\n                    onChange={(e) => handleItemChange(index, 'link', e.target.value)}\n                    className=\"border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                    placeholder=\"(URL)\"\n                  />\n                ) : (\n                  item.link ? (\n                    <a\n                      href={item.link}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      className=\"text-blue-600 hover:text-blue-800 underline text-[11px] break-all\"\n                      onClick={(e) => e.stopPropagation()}\n                    >\n                      {item.link}\n                    </a>\n                  ) : (\n                    <span className=\"text-gray-400 text-[11px]\">-</span>\n                  )\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* / */}\n          <div className=\"grid grid-cols-2 gap-2 items-center\">\n            <div>\n              <span className=\"text-gray-500 text-xs\"></span>\n              <div className=\"mt-1\">\n                {activeTab === 'pending' ? (\n                  <span className=\"text-xs text-gray-400\">-</span>\n                ) : (\n                  <>\n                    {activeTab === 'purchase' && (\n                      <div className=\"flex items-center gap-2\">\n                        {canPurchase ? (\n                          <button\n                            onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                            className={`text-xs px-2 py-1 rounded ${\n                              item.is_payment_completed\n                                ? 'button-action-primary'\n                                : 'bg-gray-100 text-gray-600'\n                            }`}\n                          >\n                            {item.is_payment_completed ? '' : ''}\n                          </button>\n                        ) : (\n                          <span className={`text-xs px-2 py-1 rounded ${\n                            item.is_payment_completed \n                              ? 'button-action-primary' \n                              : 'bg-gray-100 text-gray-400'\n                          }`}>\n                            {item.is_payment_completed ? '' : ''}\n                          </span>\n                        )}\n                      </div>\n                    )}\n\n                    {activeTab === 'receipt' && (\n                      <div className=\"flex items-center gap-2\">\n                        {canReceiveItems ? (\n                          actualReceivedAction.isCompleted(item) ? (\n                            <button\n                              onClick={() => {\n                                actualReceivedAction.handleCancel(item.id, {\n                                  item_name: item.item_name,\n                                  specification: item.specification,\n                                  quantity: item.quantity,\n                                  unit_price_value: item.unit_price_value,\n                                  amount_value: item.amount_value,\n                                  remark: item.remark\n                                })\n                              }}\n                              className=\"text-xs px-2 py-1 rounded button-action-primary\"\n                            >\n                              {actualReceivedAction.config.completedText}\n                            </button>\n                          ) : (\n                            <DatePickerPopover\n                              onDateSelect={(date) => {\n                                actualReceivedAction.handleConfirm(item.id, date, {\n                                  item_name: item.item_name,\n                                  specification: item.specification,\n                                  quantity: item.quantity,\n                                  unit_price_value: item.unit_price_value,\n                                  amount_value: item.amount_value,\n                                  remark: item.remark\n                                })\n                              }}\n                              placeholder=\"   \"\n                              align=\"center\"\n                              side=\"bottom\"\n                            >\n                              <button className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\">\n                                {actualReceivedAction.config.waitingText}\n                              </button>\n                            </DatePickerPopover>\n                          )\n                        ) : (\n                          <span className={`text-xs px-2 py-1 rounded ${\n                            actualReceivedAction.isCompleted(item)\n                              ? 'button-action-primary' \n                              : 'bg-gray-100 text-gray-400'\n                          }`}>\n                            {actualReceivedAction.isCompleted(item) ? actualReceivedAction.config.completedText : actualReceivedAction.config.waitingText}\n                          </span>\n                        )}\n                      </div>\n                    )}\n                    \n                    {activeTab === 'done' && (\n                      <>\n                        <span className={`button-base ${\n                          actualReceivedAction.isCompleted(item)\n                            ? 'bg-green-500 text-white' \n                            : 'border border-gray-300 text-gray-600 bg-white'\n                        }`}>\n                          {actualReceivedAction.isCompleted(item) ? '' : ''}\n                        </span>\n                      </>\n                    )}\n                    \n                    {activeTab !== 'purchase' && activeTab !== 'receipt' && activeTab !== 'done' && (\n                      <span className=\"text-xs text-gray-400\">-</span>\n                    )}\n                  </>\n                )}\n              </div>\n            </div>\n\n            {(item.remark || isEditing) && (\n              <div>\n                <span className=\"text-gray-500 text-xs\">:</span>\n                {isEditing ? (\n                  <Input\n                    value={item.remark || ''}\n                    onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                    className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                    placeholder=\"\"\n                  />\n                ) : (\n                  <div className=\"modal-subtitle text-gray-500 mt-1\">{item.remark || '-'}</div>\n                )}\n              </div>\n            )}\n          </div>\n\n          {!isEditing && activeTab === 'receipt' && actualReceivedAction.getCompletedDate(item) && (\n            <div>\n              <span className=\"text-gray-500 text-xs\">:</span>\n              <div className=\"mt-1\">\n                <div className=\"modal-subtitle text-green-700\">\n                  {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                    year: 'numeric',\n                    month: '2-digit',\n                    day: '2-digit'\n                  })}\n                </div>\n                <div className=\"text-[9px] text-gray-500\">\n                  {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleTimeString('ko-KR', {\n                    hour: '2-digit',\n                    minute: '2-digit'\n                  })}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {!isEditing && showStatementColumns && (\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-gray-500 text-xs\"> :</span>\n              <div className=\"flex items-center gap-2\">\n                {canReceiptCheck ? (\n                  statementReceivedAction.isCompleted(item) ? (\n                    <button\n                      onClick={() => {\n                        statementReceivedAction.handleCancel(item.id, {\n                          item_name: item.item_name,\n                          specification: item.specification,\n                          quantity: item.quantity,\n                          unit_price_value: item.unit_price_value,\n                          amount_value: item.amount_value,\n                          remark: item.remark\n                        })\n                      }}\n                      className=\"text-xs px-2 py-1 rounded button-action-primary\"\n                    >\n                      {statementReceivedAction.config.completedText}\n                    </button>\n                  ) : (\n                    <DatePickerPopover\n                      onDateSelect={(date) => {\n                        statementReceivedAction.handleConfirm(item.id, date, {\n                          item_name: item.item_name,\n                          specification: item.specification,\n                          quantity: item.quantity,\n                          unit_price_value: item.unit_price_value,\n                          amount_value: item.amount_value,\n                          remark: item.remark\n                        })\n                      }}\n                      placeholder=\"  \"\n                      align=\"center\"\n                      side=\"bottom\"\n                    >\n                      <button className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\">\n                        {statementReceivedAction.config.waitingText}\n                      </button>\n                    </DatePickerPopover>\n                  )\n                ) : (\n                  <span className={`text-xs px-2 py-1 rounded ${\n                    statementReceivedAction.isCompleted(item)\n                      ? 'button-action-primary' \n                      : 'bg-gray-100 text-gray-400'\n                  }`}>\n                    {statementReceivedAction.isCompleted(item) ? statementReceivedAction.config.completedText : statementReceivedAction.config.waitingText}\n                  </span>\n                )}\n              </div>\n            </div>\n          )}\n\n          {!isEditing && showStatementColumns && statementReceivedAction.getCompletedDate(item) && (\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-gray-500 text-xs\"> :</span>\n              <span className=\"modal-subtitle text-blue-700\">\n                {new Date(statementReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                  year: 'numeric',\n                  month: '2-digit',\n                  day: '2-digit'\n                })}\n              </span>\n            </div>\n          )}\n\n          {!isEditing && showExpenditureColumn && (\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-gray-500 text-xs\">:</span>\n              <div className=\"text-right\">\n                {item.expenditure_date ? (\n                  <>\n                    <div className=\"text-blue-700 text-[11px]\">\n                      {(() => {\n                        const date = new Date(item.expenditure_date)\n                        const year = date.getFullYear().toString().slice(-2)\n                        const month = (date.getMonth() + 1).toString().padStart(2, '0')\n                        const day = date.getDate().toString().padStart(2, '0')\n                        return `${year}.${month}.${day}`\n                      })()}\n                    </div>\n                    <div className=\"text-gray-700 text-[11px]\">\n                      {!canViewFinancialInfo \n                        ? '-' \n                        : (item.expenditure_amount !== null && item.expenditure_amount !== undefined\n                          ? `${Number(item.expenditure_amount).toLocaleString()}`\n                          : '')}\n                    </div>\n                  </>\n                ) : (\n                  <span className=\"text-gray-400 text-[11px]\">-</span>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  const content = (\n    <div className=\"space-y-1 sm:space-y-4\">\n      {loading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-hansl-600\"></div>\n        </div>\n      ) : purchase ? (\n        <div>\n          {/* Compact Info Header */}\n          <div className=\"bg-gray-50 rounded-lg p-2 sm:p-3 mb-1 sm:mb-2 border border-gray-100\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 items-center gap-3 sm:gap-0\">\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4\">\n                <div className=\"flex items-center gap-3\">\n                  {getStatusBadge()}\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"modal-label\">:</span>\n                    <span className=\"modal-value\">{purchase.requester_name}</span>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-3 h-3 text-gray-500\" />\n                  <span className=\"modal-subtitle\">: {formatDate(purchase.request_date)}</span>\n                </div>\n              </div>\n              \n              {/*     */}\n              <div className=\"flex items-center justify-center gap-2 sm:gap-3 flex-wrap\">\n                {/* 1   */}\n                {(() => {\n                  const shouldShow = canApproveMiddle && purchase.middle_manager_status === 'pending';\n                  return shouldShow;\n                })() && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('middle')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    1  \n                  </Button>\n                )}\n                {purchase.middle_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text shadow-sm\">\n                    <Check className=\"w-3 h-3\" />\n                    1 \n                  </div>\n                )}\n                {purchase.middle_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                    1 \n                  </div>\n                )}\n                {purchase.middle_manager_status === 'pending' && !canApproveMiddle && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                    1 \n                  </div>\n                )}\n\n                {/*    */}\n                {(() => {\n                  const shouldShow = canApproveFinal && purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'pending';\n                  return shouldShow;\n                })() && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('final')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    <Check className=\"w-3 h-3\" />\n                     \n                  </Button>\n                )}\n                {purchase.final_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text\">\n                    <Check className=\"w-3 h-3\" />\n                     \n                  </div>\n                )}\n                {purchase.final_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                     \n                  </div>\n                )}\n                {purchase.middle_manager_status !== 'approved' && purchase.final_manager_status === 'pending' && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                     \n                  </div>\n                )}\n              </div>\n              \n              {/*    */}\n              <div></div>\n            </div>\n          </div>\n\n          {/* Main 2-Column Layout */}\n          <div className=\"flex flex-col lg:flex-row gap-3 sm:gap-6\">\n            {/* Left Column - Basic Info (Fixed Width) */}\n            <div className=\"lg:w-80 lg:flex-shrink-0 space-y-1 sm:space-y-4 relative\">\n              \n              {/*   */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <div className=\"mb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"modal-section-title flex items-center\">\n                      <FileText className=\"w-4 h-4 mr-2 text-gray-600\" />\n                      {purchase?.purchase_order_number || 'PO '}\n                    </h3>\n                    {canReceiptCheck && canViewFinancialInfo && (activeTab === 'done' || activeTab === 'receipt') && (\n                      <button\n                        onClick={handleToggleUtkCheck}\n                        className={`button-base text-xs px-2 py-1 flex items-center ${\n                          purchase?.is_utk_checked\n                            ? 'button-toggle-active bg-orange-500 hover:bg-orange-600 text-white'\n                            : 'button-toggle-inactive'\n                        }`}\n                        title={purchase?.is_utk_checked ? 'UTK  ' : 'UTK '}\n                      >\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        UTK {purchase?.is_utk_checked ? '' : ''}\n                      </button>\n                    )}\n                  </div>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.request_type || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, request_type: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.request_type || ''}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.payment_category || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, payment_category: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"//\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.payment_category || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        <DatePickerPopover\n                          onDateSelect={(date) => {\n                            setEditedPurchase(prev => prev ? {\n                              ...prev,\n                              delivery_request_date: formatDateInput(date, 'yyyy-MM-dd')\n                            } : null)\n                          }}\n                          placeholder=\"  \"\n                          align=\"start\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            variant=\"outline\"\n                            className=\"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input\"\n                            disabled={canEditLimited && !canEditAll}\n                          >\n                            <Calendar className=\"mr-1 h-3 w-3\" />\n                            {editedPurchase?.delivery_request_date ? \n                              formatDate(editedPurchase.delivery_request_date) : \n                              ' '\n                            }\n                          </Button>\n                        </DatePickerPopover>\n                      ) : (\n                        <p className=\"modal-subtitle\">{formatDate(purchase.delivery_request_date)}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label text-orange-500\"> </span>\n                      {isEditing ? (\n                        <DatePickerPopover\n                          onDateSelect={(date) => {\n                            setEditedPurchase(prev => prev ? {\n                              ...prev,\n                              revised_delivery_request_date: formatDateInput(date, 'yyyy-MM-dd')\n                            } : null)\n                          }}\n                          placeholder=\"  \"\n                          align=\"start\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            variant=\"outline\"\n                            className=\"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input\"\n                            disabled={canEditLimited && !canEditAll}\n                          >\n                            <Calendar className=\"mr-1 h-3 w-3\" />\n                            {editedPurchase?.revised_delivery_request_date ? \n                              formatDate(editedPurchase.revised_delivery_request_date) : \n                              ' '\n                            }\n                          </Button>\n                        </DatePickerPopover>\n                      ) : (\n                        <p className=\"modal-subtitle text-orange-700\">\n                          {purchase.revised_delivery_request_date ? formatDate(purchase.revised_delivery_request_date) : ''}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/*   */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <h3 className=\"modal-section-title mb-3 flex items-center\">\n                  <Building2 className=\"w-4 h-4 mr-2 text-gray-600\" />\n                   \n                </h3>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"></span>\n                      {isEditing ? (\n                        <ReactSelect\n                          options={vendors.map(v => ({ \n                            value: v.id.toString(), \n                            label: v.vendor_name \n                          }))}\n                          value={editedPurchase?.vendor_id ? {\n                            value: editedPurchase.vendor_id.toString(),\n                            label: editedPurchase.vendor_name || vendors.find(v => v.id === editedPurchase.vendor_id)?.vendor_name || ''\n                          } : null}\n                          isDisabled={canEditLimited && !canEditAll}\n                          onChange={(option) => {\n                            logger.info('ReactSelect onChange:', { option })\n                            if (option) {\n                              const selectedVendor = vendors.find(v => v.id.toString() === option.value)\n                              logger.info('Selected vendor:', { selectedVendor })\n                              if (selectedVendor) {\n                                //    \n                                const supabase = createClient()\n                                supabase\n                                  .from('vendor_contacts')\n                                  .select('id, contact_name, contact_email, contact_phone, position')\n                                  .eq('vendor_id', selectedVendor.id)\n                                  .then(({ data: contactsData, error }: { data: any, error: any }) => {\n                                    if (error) {\n                                      logger.error('   :', error)\n                                    }\n                                    \n                                    logger.info('   -   :', { \n                                      vendor_id: selectedVendor.id,\n                                      vendor_name: selectedVendor.vendor_name,\n                                      contactsData,\n                                      contactsCount: contactsData?.length || 0\n                                    })\n                                    logger.debug('  -  :', contactsData)\n                                    \n                                    setEditedPurchase(prev => {\n                                      const updated = prev ? { \n                                        ...prev, \n                                        vendor_id: selectedVendor.id,\n                                        vendor_name: selectedVendor.vendor_name,\n                                        vendor: selectedVendor,\n                                        vendor_contacts: Array.isArray(contactsData) ? contactsData : [],\n                                        contact_id: undefined,  //     \n                                        contact_name: undefined  //      \n                                      } : null\n                                      logger.info('   - editedPurchase  :', { \n                                        vendor_id: selectedVendor.id,\n                                        vendor_name: selectedVendor.vendor_name,\n                                        contactsData,\n                                        updated_vendor_contacts: updated?.vendor_contacts,\n                                        updated_full: updated\n                                      })\n                                      logger.debug('  - editedPurchase :', { updated })\n                                      return updated\n                                    })\n                                  })\n                              }\n                            } else {\n                              setEditedPurchase(prev => prev ? { \n                                ...prev, \n                                vendor_id: undefined,\n                                vendor_name: '',\n                                vendor: undefined,\n                                vendor_contacts: [],\n                                contact_id: undefined,  //     \n                                contact_name: undefined  //      \n                              } : null)\n                            }\n                          }}\n                          placeholder=\" \"\n                          isClearable\n                          isSearchable\n                          menuPortalTarget={document.body}\n                          styles={{\n                            control: (base) => ({\n                              ...base,\n                              minHeight: '20px',\n                              height: '20px',\n                              fontSize: '10px',\n                              borderRadius: '8px', // rounded-lg  \n                              borderColor: '#e5e7eb', // border-gray-200  \n                              borderWidth: '1px',\n                              backgroundColor: '#ffffff',\n                              boxShadow: 'none',\n                              paddingLeft: '6px', // px-1.5\n                              paddingRight: '6px', // px-1.5\n                              '&:hover': {\n                                borderColor: '#e5e7eb', // hover    \n                              },\n                              '&:focus-within': {\n                                borderColor: '#60a5fa', // focus:border-blue-400\n                                boxShadow: 'none',\n                                outline: 'none',\n                              },\n                            }),\n                            valueContainer: (base) => ({\n                              ...base,\n                              height: '18px', // Input   \n                              padding: '0 2px', //   \n                              margin: '0',\n                            }),\n                            input: (base) => ({\n                              ...base,\n                              margin: '0',\n                              padding: '0',\n                              fontSize: '10px',\n                            }),\n                            indicatorsContainer: (base) => ({\n                              ...base,\n                              height: '18px',\n                              padding: '0',\n                            }),\n                            indicatorSeparator: () => ({\n                              display: 'none',\n                            }),\n                            dropdownIndicator: (base) => ({\n                              ...base,\n                              padding: '0 2px',\n                              svg: {\n                                width: '12px',\n                                height: '12px',\n                              },\n                            }),\n                            clearIndicator: (base) => ({\n                              ...base,\n                              padding: '0 2px',\n                              svg: {\n                                width: '12px',\n                                height: '12px',\n                              },\n                            }),\n                            option: (base) => ({\n                              ...base,\n                              fontSize: '10px',\n                              padding: '4px 8px',\n                            }),\n                            menuPortal: (base) => ({\n                              ...base,\n                              zIndex: 9999,\n                            }),\n                          }}\n                          classNamePrefix=\"vendor-select\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.vendor?.vendor_name || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        editedPurchase?.vendor_id ? (\n                          <ReactSelect\n                            isDisabled={canEditLimited && !canEditAll}\n                            options={(() => {\n                              const contacts = Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                              //  : id    ( ID  )\n                              const uniqueContacts = contacts.filter((contact, index, arr) => \n                                arr.findIndex(c => c.id === contact.id) === index\n                              )\n                              //  contact_name    (   ID  )\n                              const finalUniqueContacts = uniqueContacts.filter((contact, index, arr) => \n                                arr.findIndex(c => c.contact_name === contact.contact_name) === index\n                              )\n                              const options = finalUniqueContacts.map(c => ({\n                                value: c.id.toString(),\n                                label: c.contact_name || ''\n                              })) || []\n                              logger.info('   :', {\n                                vendor_id: editedPurchase.vendor_id,\n                                vendor_contacts_raw: editedPurchase.vendor_contacts,\n                                vendor_contacts_count: contacts.length,\n                                unique_by_id_count: uniqueContacts.length,\n                                final_unique_count: finalUniqueContacts.length,\n                                options\n                              })\n                              logger.debug('  :', { options })\n                              return options\n                            })()}\n                            value={(() => {\n                              const contacts = Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                              const firstContact = contacts[0]\n                              return firstContact?.id ? {\n                                value: firstContact.id.toString(),\n                                label: firstContact.contact_name || ''\n                              } : null\n                            })()}\n                            onChange={(option) => {\n                              logger.info('   :', { option })\n                              if (option) {\n                                const contacts = Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                                const selectedContact = contacts.find(c => c.id.toString() === option.value)\n                                if (selectedContact) {\n                                  setEditedPurchase(prev => prev ? {\n                                    ...prev,\n                                    contact_id: selectedContact.id,\n                                    contact_name: selectedContact.contact_name,\n                                    vendor_contacts: [selectedContact, ...contacts.filter(c => c.id !== selectedContact.id)]\n                                  } : null)\n                                }\n                              } else {\n                                setEditedPurchase(prev => prev ? {\n                                  ...prev,\n                                  contact_id: undefined,\n                                  contact_name: undefined,\n                                  vendor_contacts: Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                                } : null)\n                              }\n                            }}\n                            placeholder=\" \"\n                            isClearable\n                            isSearchable\n                            noOptionsMessage={() => \" \"}\n                            menuPortalTarget={document.body}\n                            styles={{\n                              control: (base) => ({\n                                ...base,\n                                minHeight: '20px',\n                                height: '20px',\n                                fontSize: '10px',\n                                borderRadius: '8px', // rounded-lg  \n                                borderColor: '#e5e7eb', // border-gray-200  \n                                borderWidth: '1px',\n                                backgroundColor: '#ffffff',\n                                boxShadow: 'none',\n                                paddingLeft: '6px', // px-1.5\n                                paddingRight: '6px', // px-1.5\n                                '&:hover': {\n                                  borderColor: '#e5e7eb', // hover    \n                                },\n                                '&:focus-within': {\n                                  borderColor: '#60a5fa', // focus:border-blue-400\n                                  boxShadow: 'none',\n                                  outline: 'none',\n                                },\n                              }),\n                              valueContainer: (base) => ({\n                                ...base,\n                                height: '18px', // Input   \n                                padding: '0 2px', //   \n                                margin: '0',\n                              }),\n                              input: (base) => ({\n                                ...base,\n                                margin: '0',\n                                padding: '0',\n                                fontSize: '10px',\n                              }),\n                              indicatorsContainer: (base) => ({\n                                ...base,\n                                height: '18px',\n                                padding: '0',\n                              }),\n                              indicatorSeparator: () => ({\n                                display: 'none',\n                              }),\n                              dropdownIndicator: (base) => ({\n                                ...base,\n                                padding: '0 2px',\n                                svg: {\n                                  width: '12px',\n                                  height: '12px',\n                                },\n                              }),\n                              clearIndicator: (base) => ({\n                                ...base,\n                                padding: '0 2px',\n                                svg: {\n                                  width: '12px',\n                                  height: '12px',\n                                },\n                              }),\n                              option: (base) => ({\n                                ...base,\n                                fontSize: '10px',\n                                padding: '4px 8px',\n                              }),\n                              menuPortal: (base) => ({\n                                ...base,\n                                zIndex: 9999,\n                              }),\n                            }}\n                            classNamePrefix=\"contact-select\"\n                          />\n                        ) : (\n                          <Input\n                            value=\"\"\n                            disabled\n                            className=\"mt-1 rounded-lg border-gray-200 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                            placeholder=\"  \"\n                          />\n                        )\n                      ) : (\n                        <p className=\"modal-value\">{(() => {\n                          // : 1. contact_name , 2. vendor_contacts    , 3. '-'\n                          const contacts = Array.isArray(purchase.vendor_contacts) ? purchase.vendor_contacts : []\n                          const contactName = (purchase as any).contact_name ||\n                                            contacts[0]?.contact_name || \n                                            '-'\n                          logger.info(' vendor_contacts display :', { \n                            purchase_id: purchase?.id,\n                            vendor_id: purchase?.vendor_id,\n                            contact_id: purchase?.contact_id,\n                            vendor_contacts: purchase.vendor_contacts,\n                            purchase_contact_name: purchase.contact_name,\n                            contactName,\n                            purchase_full: purchase\n                          })\n                          logger.debug('vendor_contacts display :', { \n                            purchase_id: purchase?.id,\n                            vendor_id: purchase?.vendor_id,\n                            contact_id: purchase?.contact_id,\n                            vendor_contacts: purchase.vendor_contacts,\n                            purchase_contact_name: purchase.contact_name,\n                            contactName\n                          })\n                          return contactName\n                        })()}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">PJ</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_vendor || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_vendor: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.project_vendor || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">Item</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_item || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_item: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p\n                          className=\"modal-subtitle break-all whitespace-pre-wrap\"\n                          style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-all' }}\n                        >\n                          {purchase.project_item || '-'}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"></span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.sales_order_number || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, sales_order_number: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle\">{purchase.sales_order_number || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/*   */}\n              {linkedStatements.length > 0 && (\n                <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm mt-3\">\n                  <div className=\"mb-2\">\n                    <h3 className=\"modal-section-title flex items-center\">\n                      <FileCheck className=\"w-4 h-4 mr-2 text-gray-600\" />\n                       \n                      <span className=\"ml-2 badge-stats bg-green-500 text-white text-[10px]\">\n                        {linkedStatements.length}\n                      </span>\n                    </h3>\n                  </div>\n                  <div className=\"space-y-2\">\n                    {linkedStatements.map((stmt) => (\n                      <div\n                        key={stmt.id}\n                        className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors\"\n                        onClick={() => handleViewStatementImage(stmt.image_url)}\n                      >\n                        <div className=\"flex items-center gap-2 min-w-0\">\n                          <ImageIcon className=\"w-4 h-4 text-gray-400 flex-shrink-0\" />\n                          <div className=\"min-w-0\">\n                            <p className=\"text-xs font-medium text-gray-900 truncate\">\n                              {stmt.vendor_name || stmt.file_name || ''}\n                            </p>\n                            <p className=\"text-[10px] text-gray-500\">\n                              {stmt.statement_date \n                                ? formatDate(stmt.statement_date)\n                                : formatDate(stmt.uploaded_at)\n                              }\n                              {stmt.grand_total && (\n                                <span className=\"ml-2 text-gray-700\">\n                                  {stmt.grand_total.toLocaleString()}\n                                </span>\n                              )}\n                            </p>\n                          </div>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          className=\"h-6 w-6 p-0 flex-shrink-0\"\n                          title=\" \"\n                        >\n                          <ImageIcon className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n            </div>\n\n            {/* Right Column - Items List (Fit Width) */}\n            <div className=\"lg:w-fit lg:min-w-0 relative overflow-visible\">\n              \n              <div className=\"bg-white rounded-lg border border-gray-100 shadow-sm\">\n                <div className=\"p-2 sm:p-3 bg-gray-50 border-b border-gray-100 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0\">\n                  <h3 className=\"modal-section-title flex items-center\">\n                    <Package className=\"w-4 h-4 mr-2 text-gray-600\" />\n                     \n                    <span className=\"ml-2 badge-stats bg-gray-500 text-white\">\n                      {currentItems?.length || 0}\n                    </span>\n                    {isEditing ? (\n                      <ReactSelect\n                        isDisabled={canEditLimited && !canEditAll}\n                        options={[\n                          { value: 'KRW', label: 'KRW' },\n                          { value: 'USD', label: 'USD' },\n                          { value: 'EUR', label: 'EUR' },\n                          { value: 'JPY', label: 'JPY' },\n                          { value: 'CNY', label: 'CNY' },\n                        ]}\n                        value={editedPurchase?.currency ? {\n                          value: editedPurchase.currency,\n                          label: editedPurchase.currency\n                        } : { value: 'KRW', label: 'KRW' }}\n                        onChange={(option) => {\n                          if (option) {\n                            setEditedPurchase(prev => prev ? { ...prev, currency: option.value as 'KRW' | 'USD' } : null)\n                          }\n                        }}\n                        menuPortalTarget={document.body}\n                        styles={{\n                          control: (base) => ({\n                            ...base,\n                            minHeight: '20px',\n                            height: '20px',\n                            width: '75px',\n                            fontSize: '10px',\n                            borderRadius: '8px',\n                            borderColor: '#e5e7eb',\n                            marginLeft: '8px',\n                          }),\n                          valueContainer: (base) => ({\n                            ...base,\n                            padding: '0 6px',\n                            height: '20px',\n                          }),\n                          singleValue: (base) => ({\n                            ...base,\n                            margin: 0,\n                            position: 'absolute',\n                            top: '50%',\n                            transform: 'translateY(-50%)',\n                          }),\n                          input: (base) => ({\n                            ...base,\n                            margin: 0,\n                            padding: 0,\n                          }),\n                          indicatorsContainer: (base) => ({\n                            ...base,\n                            height: '20px',\n                          }),\n                          indicatorSeparator: () => ({ display: 'none' }),\n                          dropdownIndicator: (base) => ({\n                            ...base,\n                            padding: '0 4px',\n                          }),\n                          option: (base) => ({\n                            ...base,\n                            fontSize: '10px',\n                            padding: '4px 8px',\n                          }),\n                          menuPortal: (base) => ({\n                            ...base,\n                            zIndex: 9999,\n                          }),\n                        }}\n                      />\n                    ) : (\n                      <span className=\"ml-2 badge-stats bg-blue-500 text-white\">\n                        {purchase.currency || 'KRW'}\n                      </span>\n                    )}\n                  </h3>\n                  {!isEditing && (\n                    <>\n                      {activeTab === 'purchase' && canPurchase && (\n                        <Button\n                          size=\"sm\"\n                          onClick={handleCompleteAllPayment}\n                          className=\"button-base bg-orange-500 hover:bg-orange-600 text-white\"\n                        >\n                          <CreditCard className=\"w-3 h-3 mr-1\" />\n                           \n                        </Button>\n                      )}\n                      {activeTab === 'receipt' && canReceiveItems && (\n                        <DateQuantityPickerPopover\n                          onConfirm={handleCompleteAllReceipt}\n                          placeholder=\" \"\n                          align=\"end\"\n                          side=\"bottom\"\n                          hideQuantityInput={true}\n                          quantityInfoText=\"   \"\n                        >\n                          <Button\n                            size=\"sm\"\n                            className=\"button-base button-action-primary\"\n                          >\n                            <Truck className=\"w-3 h-3 mr-1\" />\n                             \n                          </Button>\n                        </DateQuantityPickerPopover>\n                      )}\n                      {showStatementColumns && canReceiptCheck && canViewFinancialInfo && (\n                        <div className=\"flex items-center gap-2\">\n                          <DatePickerPopover\n                            onDateSelect={handleCompleteAllStatement}\n                            placeholder=\"   \"\n                            align=\"end\"\n                            side=\"bottom\"\n                          >\n                            <Button\n                              size=\"sm\"\n                              className=\"button-base button-action-primary\"\n                            >\n                              <FileText className=\"w-3 h-3 mr-1\" />\n                               \n                            </Button>\n                          </DatePickerPopover>\n                          {activeTab === 'done' && purchase.payment_category === '' && (\n                            <DateAmountPickerPopover\n                              onConfirm={handleBulkExpenditure}\n                              placeholder=\"    \"\n                              align=\"end\"\n                              side=\"bottom\"\n                            >\n                              <Button\n                                size=\"sm\"\n                                className=\"button-base button-action-primary\"\n                              >\n                                <DollarSign className=\"w-3 h-3 mr-1\" />\n                                \n                              </Button>\n                            </DateAmountPickerPopover>\n                          )}\n                        </div>\n                      )}\n                    </>\n                  )}\n                </div>\n                \n                {/* Mobile Table Header */}\n                <div className=\"block sm:hidden bg-gray-50 px-2 py-1 border-b border-gray-100\">\n                  <div className=\"text-xs font-medium text-gray-600\">  ( )</div>\n                </div>\n                \n                {/* Items List with Header Inside Scrollable Container */}\n                <div className=\"max-h-[50vh] sm:max-h-[40vh] overflow-auto\">\n                  <div className=\"w-fit\">\n                    {/* Items Table Header - Sticky inside scroll container */}\n                    <div className={`bg-gray-50 px-2 sm:px-3 py-1 border-b border-gray-100 sticky top-0 z-10 w-fit ${isEditing ? 'pl-7 sm:pl-8' : ''}`}>\n                      <div \n                        ref={headerRowRef}\n                         className=\"hidden sm:grid gap-1 modal-label w-fit\"\n                        style={{\n                          gridTemplateColumns: getGridTemplateColumns()\n                        }}\n                      >\n                        <div className=\"text-center -ml-2 sm:-ml-3\">#</div>\n                        <div></div>\n                        <div></div>\n                        <div className=\"text-center\">\n                          {(activeTab === 'receipt' || activeTab === 'done') && !isEditing ? (\n                            <div className=\"flex flex-col items-center leading-tight\">\n                              <div className=\"text-[9px]\">/</div>\n                              <div className=\"text-[10px]\"></div>\n                            </div>\n                          ) : (\n                            ''\n                          )}\n                        </div>\n                        <div className=\"text-right\"></div>\n                        <div className=\"text-right\"></div>\n                        {purchase.payment_category === '' && (\n                          <div className=\"text-right\"></div>\n                        )}\n                        <div className=\"text-center\"></div>\n                        <div className=\"text-center\"></div>\n                        {activeTab !== 'pending' && (\n                          isEditing ? (\n                            <>\n                              <div className=\"text-center\"></div>\n                              {activeTab === 'receipt' && (\n                                <>\n                                  <div className=\"text-center\"></div>\n                                </>\n                              )}\n                              {showStatementColumns && (\n                                <>\n                                  <div className=\"text-center\"> </div>\n                                  <div className=\"text-center\"> </div>\n                                  {showExpenditureColumn && <div className=\"text-center\"></div>}\n                                </>\n                              )}\n                            </>\n                          ) : (\n                            <>\n                              <div className=\"text-center\">\n                                {activeTab === 'purchase'\n                                  ? ''\n                                  : (activeTab === 'receipt' || activeTab === 'done')\n                                  ? ''\n                                  : ''}\n                              </div>\n                              {activeTab === 'receipt' && (\n                                <>\n                                  <div className=\"text-center\"></div>\n                                </>\n                              )}\n                              {showStatementColumns && (\n                                <>\n                                  <div className=\"text-center\"> </div>\n                                  <div className=\"text-center\"> </div>\n                                  {showExpenditureColumn && <div className=\"text-center\"></div>}\n                                </>\n                              )}\n                            </>\n                          )\n                        )}\n                      </div>\n                    </div>\n                    {isEditing && (\n                      <DndContext sensors={sensors} collisionDetection={closestCenter} onDragEnd={handleDragEnd}>\n                        <SortableContext\n                          items={sortableIds}\n                          strategy={verticalListSortingStrategy}\n                        >\n                          {(editedItems || []).map((item, index) => (\n                            <SortableRow key={getSortableId(item, index)} id={getSortableId(item, index)}>\n                              {(dragProps) => renderItemRow(item, index, dragProps, getSortableId(item, index))}\n                            </SortableRow>\n                          ))}\n                        </SortableContext>\n                      </DndContext>\n                    )}\n                    {!isEditing && (\n                    <div className=\"divide-y divide-gray-100 overflow-visible w-fit\">\n                      {(displayItems)?.map((item, index) => (\n                        renderItemRow(item, index, undefined, getSortableId(item, index))\n                      ))}\n                    </div>\n                    )}\n                </div>\n              </div>\n                \n                {/*  */}\n                <div className=\"bg-gray-50 px-2 sm:px-3 border-t border-gray-100\">\n                  <div className=\"hidden sm:grid items-center gap-1 py-2 w-fit\" style={{\n                    gridTemplateColumns: getGridTemplateColumns()\n                  }}>\n                    {/*  */}\n                    <div className=\"-ml-2 sm:-ml-3\"></div>\n                    {/*  */}\n                    <div></div>\n                    {/*  */}\n                    <div></div>\n                    {/*  */}\n                    <div></div>\n                    {/*   -   */}\n                    <div className=\"text-right flex items-center justify-end\">\n                      <span className=\"text-[11px] text-gray-600 font-medium\"></span>\n                    </div>\n                    {/*   -    */}\n                    <div className=\"text-right flex items-center justify-end\">\n                      <span className=\"text-[12px] font-bold text-gray-900\">\n                        {activeTab === 'done' && !canViewFinancialInfo \n                          ? '-' \n                          : `${(isEditing ? editedPurchase?.currency : purchase.currency) === 'USD' ? '$' : ''}${formatCurrency(\n                              (displayItems)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0\n                            )}`}\n                      </span>\n                    </div>\n                    {/*   ( ) */}\n                    {purchase.payment_category === '' && (\n                      <div className=\"text-right flex items-center justify-end\">\n                        {/*   -    */}\n                        <span className=\"text-[12px] font-bold text-gray-900\">\n                          {activeTab === 'done' && !canViewFinancialInfo \n                            ? '-' \n                            : `${(isEditing ? editedPurchase?.currency : purchase.currency) === 'USD' ? '$' : ''}${formatCurrency(\n                                (displayItems)?.reduce((sum, item) => sum + (item.tax_amount_value || 0), 0) || 0\n                              )}`}\n                        </span>\n                      </div>\n                    )}\n                    {/*  */}\n                    <div></div>\n                    {/*  */}\n                    <div></div>\n                    {/*    - pending  ,      */}\n                    {activeTab !== 'pending' && (\n                      isEditing ? (\n                        <div></div>\n                      ) : (\n                        <div className={activeTab === 'done' && purchase.payment_category === '' ? \"text-right flex items-center justify-end\" : \"\"}>\n                          {activeTab === 'done' && purchase.payment_category === '' && (\n                            <span className=\"text-[11px] text-gray-600 font-medium\"></span>\n                          )}\n                        </div>\n                      )\n                    )}\n                    {activeTab === 'receipt' && <div></div>}\n                    {activeTab === 'done' && (\n                      <>\n                        {/*   -      */}\n                        {purchase.payment_category === '' && (\n                          <>\n                            <div className=\"text-right flex items-center justify-end\">\n                              <div className=\"text-[12px] font-bold text-blue-700\">\n                                {!canViewFinancialInfo \n                                  ? '-' \n                                  : `${formatCurrency(\n                                      purchase.total_expenditure_amount ?? \n                                      ((isEditing ? editedItems : currentItems)?.reduce((sum: number, item: any) => {\n                                        return sum + (Number(item.expenditure_amount) || 0)\n                                      }, 0) || 0)\n                                    )}`}\n                              </div>\n                            </div>\n                            {/*    */}\n                            <div></div>\n                            {/*   */}\n                            <div></div>\n                          </>\n                        )}\n                      </>\n                    )}\n                  </div>\n\n                  {/* +  ( ) */}\n                  {purchase.payment_category === '' && (\n                    <div className=\"hidden sm:grid items-center gap-1 py-2 w-fit border-t border-gray-300\" style={{\n                      gridTemplateColumns: getGridTemplateColumns()\n                    }}>\n                      {/*  */}\n                      <div className=\"-ml-2 sm:-ml-3\"></div>\n                      {/*   */}\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                      {/*   -  */}\n                      <div></div>\n                      {/*   -   */}\n                      <div className=\"text-right flex items-center justify-end\">\n                        <span className=\"text-[11px] text-gray-600 font-medium\"></span>\n                      </div>\n                      {/*   - +  */}\n                      <div className=\"text-right flex items-center justify-end\">\n                        <span className=\"text-[12px] font-bold text-blue-600\">\n                          {activeTab === 'done' && !canViewFinancialInfo \n                            ? '-' \n                            : formatMoney(\n                                (isEditing ? editedItems : currentItems)?.reduce((sum, item) => {\n                                  const amount = item.amount_value || 0\n                                  const tax = item.tax_amount_value || 0\n                                  return sum + amount + tax\n                                }, 0) || 0\n                              , getPurchaseDisplayCurrency())}\n                        </span>\n                      </div>\n                      {/*   -  */}\n                      <div></div>\n                      {/*    */}\n                      <div></div>\n                      {isEditing ? <div></div> : <div></div>}\n                      {activeTab === 'receipt' && <div></div>}\n                      {activeTab === 'done' && purchase.payment_category === '' && (\n                        <>\n                          {/*   */}\n                          <div></div>\n                          {/*    */}\n                          <div></div>\n                          {/*   */}\n                          <div></div>\n                        </>\n                      )}\n                    </div>\n                  )}\n                  \n                  {/* Mobile  */}\n                  <div className=\"block sm:hidden py-2 space-y-1\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-[12px] text-gray-500\"> </span>\n                      <span className=\"text-[13px] font-bold text-gray-900\">\n                        {activeTab === 'done' && !canViewFinancialInfo \n                          ? '-' \n                          : formatMoney(\n                              (isEditing ? editedItems : currentItems)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0,\n                              getPurchaseDisplayCurrency()\n                            )}\n                      </span>\n                    </div>\n                    {/*  ( ) */}\n                    {purchase.payment_category === '' && (\n                      <>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-[12px] text-gray-500\"> </span>\n                          <span className=\"text-[13px] font-bold text-gray-900\">\n                            {activeTab === 'done' && !canViewFinancialInfo \n                              ? '-' \n                              : formatMoney(\n                                  (isEditing ? editedItems : currentItems)?.reduce((sum, item) => sum + (item.tax_amount_value || 0), 0) || 0,\n                                  getPurchaseDisplayCurrency()\n                                )}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between items-center border-t pt-1\">\n                          <span className=\"text-[12px] text-gray-500\">+</span>\n                          <span className=\"text-[13px] font-bold text-blue-600\">\n                            {activeTab === 'done' && !canViewFinancialInfo \n                              ? '-' \n                              : formatMoney(\n                                  (isEditing ? editedItems : currentItems)?.reduce((sum, item) => {\n                                    const amount = item.amount_value || 0\n                                    const tax = item.tax_amount_value || 0\n                                    return sum + amount + tax\n                                  }, 0) || 0,\n                                  getPurchaseDisplayCurrency()\n                                )}\n                          </span>\n                        </div>\n                      </>\n                    )}\n                    {/* Mobile   -    */}\n                    {activeTab === 'done' && purchase.payment_category === '' && (\n                      <div className=\"flex justify-between items-center border-t pt-1\">\n                        <span className=\"text-[12px] text-gray-500\"> </span>\n                        <span className=\"text-[13px] font-bold text-blue-700\">\n                          {!canViewFinancialInfo \n                            ? '-' \n                            : `${formatCurrency(\n                                purchase.total_expenditure_amount ??\n                                ((isEditing ? editedItems : currentItems)?.reduce((sum: number, item: any) => {\n                                  return sum + (Number(item.expenditure_amount) || 0)\n                                }, 0) || 0)\n                              )}`}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                \n                {/*    */}\n                {isEditing && (\n                  <div className=\"p-2 sm:p-3 border-t border-gray-100\">\n                    <Button\n                      type=\"button\"\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={handleAddItem}\n                      className=\"w-full rounded-lg border-dashed border-2 border-gray-300 hover:border-gray-400 py-2 badge-text\"\n                    >\n                      <Plus className=\"w-4 h-4 mr-1\" />\n                       \n                    </Button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"text-center py-12\">\n          {loading ? (\n            <div className=\"flex items-center justify-center gap-2\">\n              <div className=\"w-5 h-5 border-2 border-gray-300 border-t-transparent rounded-full animate-spin\" />\n              <span className=\"modal-subtitle\"> ...</span>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              <span className=\"modal-subtitle\">\n                   .\n              </span>\n              {!embedded && (\n                <div>\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={onClose}\n                    className=\"button-base button-action-secondary\"\n                  >\n                    \n                  </Button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n\n  // embedded true Dialog   \n  if (embedded) {\n    return content\n  }\n\n  // embedded false Dialog  \n  return (\n    <>\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent \n        className=\"overflow-hidden bg-white rounded-lg shadow-sm border-0 w-full sm:w-auto max-w-[calc(100vw-48px)] sm:max-w-[calc(100vw-80px)] lg:max-w-[90vw] xl:max-w-[85vw] h-[95vh] sm:h-auto sm:max-h-[90vh] lg:max-h-[85vh] sm:rounded-lg flex flex-col\" \n        showCloseButton={false}\n      >\n        <DialogHeader className=\"sr-only\">\n          <DialogTitle>  </DialogTitle>\n        </DialogHeader>\n        {/* Apple-style Header */}\n        <div className=\"relative px-3 sm:px-6 pt-0 sm:pt-3 lg:pt-4 pb-0 sm:pb-2 lg:pb-3 flex-shrink-0\">\n          <div className=\"absolute right-3 sm:right-6 top-3 sm:top-3 lg:top-4 flex items-center gap-2 z-10\">\n            {/*   (app_admin, final_approver, ceo, lead_buyer) */}\n            {!isEditing && canEdit && (\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => handleEditToggle(true)}\n                className=\"button-base button-action-secondary h-8 text-xs px-3\"\n              >\n                <Edit2 className=\"w-3.5 h-3.5 mr-1.5\" />\n                \n              </Button>\n            )}\n            \n            {/*   */}\n            {!isEditing && canDelete && onDelete && (\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => {\n                  if (purchase) {\n                    //      (    )\n                    onDelete(purchase);\n                    //             \n                  }\n                }}\n                className=\"button-base button-action-danger h-8 text-xs px-3\"\n              >\n                <Trash2 className=\"w-3.5 h-3.5 mr-1.5\" />\n                \n              </Button>\n            )}\n            \n            {/*   ( ,    lead_buyer) */}\n            {!isAdmin && !isEditing && (\n              <Popover open={isModifyRequestOpen} onOpenChange={setIsModifyRequestOpen}>\n                <PopoverTrigger asChild>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    className=\"button-base button-action-secondary h-8 text-xs px-3 gap-1.5\"\n                    title=\" \"\n                  >\n                    <MessageSquarePlus className=\"w-3.5 h-3.5 text-gray-500\" />\n                    <span> </span>\n                  </Button>\n                </PopoverTrigger>\n                <PopoverContent \n                  className=\"w-80 sm:w-96 p-4\" \n                  align=\"end\"\n                  onOpenAutoFocus={(e) => e.preventDefault()}\n                >\n                  <div className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                      <h4 className=\"font-medium leading-none\"> </h4>\n                      <p className=\"text-xs text-muted-foreground\">\n                             .\n                      </p>\n                    </div>\n                    <div className=\"space-y-3\">\n                      <div className=\"space-y-1\">\n                        <Label htmlFor=\"subject\" className=\"text-xs\"></Label>\n                        <Input\n                          id=\"subject\"\n                          value={modifySubject}\n                          onChange={(e) => setModifySubject(e.target.value)}\n                          className=\"h-8 text-xs\"\n                          placeholder=\" \"\n                        />\n                      </div>\n                      <div className=\"space-y-1\">\n                        <Label htmlFor=\"message\" className=\"text-xs\"></Label>\n                        <div className=\"relative\" onWheel={(e) => e.stopPropagation()}>\n                          <Textarea\n                            id=\"message\"\n                            value={modifyMessage}\n                            onChange={(e) => setModifyMessage(e.target.value)}\n                            className=\"min-h-[150px] text-xs font-mono overflow-auto\"\n                            placeholder=\"  \"\n                            style={{ resize: 'none' }}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex justify-end gap-2\">\n                      <Button \n                        variant=\"outline\" \n                        size=\"sm\" \n                        onClick={() => setIsModifyRequestOpen(false)}\n                        className=\"h-8 text-xs\"\n                      >\n                        \n                      </Button>\n                      <Button \n                        size=\"sm\" \n                        onClick={handleSendModifyRequest}\n                        disabled={isSendingModify}\n                        className=\"h-8 text-xs bg-blue-600 hover:bg-blue-700\"\n                      >\n                        {isSendingModify ? ' ...' : ' '}\n                      </Button>\n                    </div>\n                  </div>\n                </PopoverContent>\n              </Popover>\n            )}\n            \n            <button\n              onClick={onClose}\n              className=\"button-base button-action-secondary w-8 h-8 rounded-full flex items-center justify-center\"\n            >\n              <X className=\"w-4 h-4 text-gray-500\" />\n            </button>\n          </div>\n          \n          <div className=\"pr-8 sm:pr-16\">\n            <div className=\"flex items-start gap-4 mb-0 sm:mb-3\">\n              <div className=\"min-w-0 flex-1\">\n                <h1 className=\"page-title mb-0 sm:mb-1\">\n                   \n                </h1>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                {isEditing && (\n                  <>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => {\n                        handleEditToggle(false)\n                        setEditedPurchase(purchase)\n                        setEditedItems(purchase?.items || [])\n                        setDeletedItemIds([])\n                      }}\n                      className=\"button-base button-action-secondary\"\n                    >\n                      <X className=\"w-4 h-4 mr-2\" />\n                      \n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      onClick={handleSave}\n                      disabled={isSaving}\n                      className=\"button-base button-action-primary\"\n                    >\n                      {isSaving ? (\n                        <>\n                          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                           ...\n                        </>\n                      ) : (\n                        <>\n                          <Save className=\"w-4 h-4 mr-2\" />\n                          \n                        </>\n                      )}\n                    </Button>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Apple-style Content */}\n        <div className=\"overflow-y-auto flex-1 px-3 sm:px-6 pb-1 sm:pb-6 mt-0\">\n          {content}\n        </div>\n      </DialogContent>\n      \n    </Dialog>\n\n    {/*    */}\n    <Dialog open={isStatementViewerOpen} onOpenChange={setIsStatementViewerOpen}>\n      <DialogContent className=\"max-w-[90vw] max-h-[90vh] p-0 bg-black/90 border-none\">\n        <div className=\"absolute top-4 right-4 z-50\">\n          <Button\n            size=\"sm\"\n            variant=\"ghost\"\n            onClick={() => setIsStatementViewerOpen(false)}\n            className=\"text-white hover:bg-white/20\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n        <div className=\"flex items-center justify-center w-full h-[80vh] overflow-auto p-4\">\n          {selectedStatementImage && (\n            <img\n              src={selectedStatementImage}\n              alt=\"\"\n              className=\"max-w-full max-h-full object-contain\"\n            />\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n    </>\n  )\n}\n\nexport default memo(PurchaseDetailModal)"],"names":["CircleCheckBig","createLucideIcon","d","key","DollarSign","x1","x2","y1","y2","GripVertical","cx","cy","r","Image","width","height","x","y","rx","ry","MessageSquarePlus","Pen","Truck","canUseDOM","window","document","createElement","isWindow","element","elementString","Object","prototype","toString","call","isNode","node","getWindow","target","_target$ownerDocument","_target$ownerDocument2","ownerDocument","defaultView","isDocument","Document","isHTMLElement","HTMLElement","isSVGElement","SVGElement","getOwnerDocument","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","useEvent","handler","handlerRef","useRef","current","useCallback","_len","arguments","length","args","Array","_key","useLatestValue","value","dependencies","valueRef","useLazyMemo","callback","useMemo","newValue","useNodeRef","onChange","onChangeHandler","setNodeRef","usePrevious","ref","ids","useUniqueId","prefix","id","createAdjustmentFn","modifier","object","adjustments","reduce","accumulator","adjustment","entries","valueAdjustment","add","subtract","isKeyboardEvent","event","KeyboardEvent","getEventCoordinates","TouchEvent","isTouchEvent","touches","clientX","clientY","changedTouches","hasViewportRelativeCoordinates","CSS","freeze","Translate","transform","Math","round","Scale","scaleX","scaleY","Transform","join","Transition","_ref","property","duration","easing","SELECTOR","findFirstFocusableNode","matches","querySelector","hiddenStyles","display","HiddenText","React","style","LiveRegion","announcement","ariaLiveType","position","top","left","margin","border","padding","overflow","clip","clipPath","whiteSpace","role","DndMonitorContext","createContext","defaultScreenReaderInstructions","draggable","defaultAnnouncements","onDragStart","active","onDragOver","_ref2","over","onDragEnd","_ref3","onDragCancel","_ref4","Accessibility","announcements","container","hiddenTextDescribedById","screenReaderInstructions","announce","setAnnouncement","useState","useAnnouncement","liveRegionId","mounted","setMounted","listener","registerListener","useContext","Error","useDndMonitor","onDragMove","_ref5","_ref6","markup","Fragment","createPortal","Action","noop","defaultCoordinates","distanceBetween","p1","p2","sqrt","pow","sortCollisionsAsc","data","a","b","sortCollisionsDesc","centerOfRectangle","rect","closestCenter","collisionRect","droppableRects","droppableContainers","centerRect","collisions","droppableContainer","get","distBetween","push","sort","getIntersectionRatio","entry","max","right","min","bottom","targetArea","entryArea","intersectionArea","Number","toFixed","rectIntersection","intersectionRatio","getRectDelta","rect1","rect2","createRectAdjustmentFn","acc","getAdjustedRect","defaultOptions","ignoreTransform","getClientRect","options","getBoundingClientRect","transformOrigin","getComputedStyle","parsedTransform","startsWith","transformArray","slice","split","parseTransform","translateX","translateY","parseFloat","indexOf","w","h","inverseTransform","getTransformAgnosticClientRect","getScrollableAncestors","limit","scrollParents","findScrollableAncestors","scrollingElement","includes","computedStyle","overflowRegex","some","test","isScrollable","isFixed","parentNode","getFirstScrollableAncestor","firstScrollableAncestor","getScrollableElement","getScrollXCoordinate","scrollX","scrollLeft","getScrollYCoordinate","scrollY","scrollTop","getScrollCoordinates","Direction","isDocumentScrollingElement","getScrollPosition","scrollingContainer","minScroll","dimensions","innerHeight","innerWidth","clientHeight","clientWidth","maxScroll","scrollWidth","scrollHeight","isTop","isLeft","isBottom","isRight","defaultThreshold","getScrollDirectionAndSpeed","scrollContainer","scrollContainerRect","acceleration","thresholdPercentage","direction","speed","threshold","Backward","abs","Forward","getScrollElementRect","getScrollOffsets","scrollableAncestors","properties","Rect","constructor","this","scrollOffsets","axis","keys","getScrollOffset","defineProperty","currentOffsets","scrollOffsetsDeltla","enumerable","Listeners","listeners","removeAll","forEach","_this$target","removeEventListener","eventName","_this$target2","addEventListener","hasExceededDistance","delta","measurement","dx","dy","EventName","KeyboardCode","preventDefault","stopPropagation","defaultKeyboardCodes","start","Space","Enter","cancel","Esc","end","Tab","defaultKeyboardCoordinateGetter","currentCoordinates","code","Right","Left","Down","Up","KeyboardSensor","props","autoScrollEnabled","referenceCoordinates","windowListeners","handleKeyDown","bind","handleCancel","attach","handleStart","Resize","VisibilityChange","setTimeout","Keydown","activeNode","onStart","measure","scrollIntoView","block","inline","scrollIntoViewIfNeeded","context","keyboardCodes","coordinateGetter","scrollBehavior","handleEnd","newCoordinates","coordinatesDelta","scrollDelta","scrollElementRect","clampedCoordinates","canScrollX","canScrollY","newScrollCoordinates","canScrollToNewCoordinates","scrollTo","behavior","scrollBy","handleMove","coordinates","onMove","onEnd","detach","onCancel","isDistanceConstraint","constraint","Boolean","isDelayConstraint","activators","onActivation","nativeEvent","activator","activatorNode","AbstractPointerSensor","events","listenerTarget","_getEventCoordinates","EventTarget","getEventListenerTarget","activated","initialCoordinates","timeoutId","documentListeners","handleKeydown","removeTextSelection","activationConstraint","bypassActivationConstraint","move","name","passive","DragStart","ContextMenu","delay","handlePending","clearTimeout","offset","onPending","Click","capture","SelectionChange","_getEventCoordinates2","tolerance","distance","cancelable","onAbort","_this$document$getSel","getSelection","removeAllRanges","PointerSensor","super","isPrimary","button","events$1","MouseButton","RightClick","events$2","AutoScrollActivator","TraversalOrder","useAutoScroller","Pointer","canScroll","draggingRect","enabled","interval","order","TreeOrder","pointerCoordinates","scrollableAncestorRects","scrollIntent","disabled","previousDelta","previousIntent","defaultScrollIntent","sign","useScrollIntent","setAutoScrollInterval","clearAutoScrollInterval","intervalRef","setInterval","clearInterval","useInterval","scrollSpeed","scrollDirection","DraggableRect","scrollContainerRef","autoScroll","sortedScrollableAncestors","reverse","index","JSON","stringify","setup","MeasuringStrategy","MeasuringFrequency","defaultValue","Map","useInitialValue","computeFn","previousValue","useResizeObserver","handleResize","resizeObserver","ResizeObserver","disconnect","defaultMeasure","useRect","fallbackRect","setRect","measureRect","currentRect","isConnected","newRect","mutationObserver","handleMutations","MutationObserver","useMutationObserver","records","record","type","contains","observe","body","childList","subtree","defaultValue$1","useScrollOffsetsDelta","initialScrollOffsets","hasScrollOffsets","useWindowRect","getWindowClientRect","defaultValue$2","useDragOverlayMeasuring","handleNodeChange","children","firstChild","getMeasurableNode","nodeRef","setRef","defaultSensors","sensor","defaultData","defaultMeasuringConfiguration","droppable","strategy","WhileDragging","frequency","Optimized","dragOverlay","DroppableContainersMap","_super$get","toArray","from","values","getEnabled","filter","getNodeFor","_this$get$node$curren","_this$get","defaultPublicContext","activatorEvent","activeNodeRect","containerNodeRect","draggableNodes","measuringConfiguration","measureDroppableContainers","windowRect","measuringScheduled","defaultInternalContext","ariaDescribedById","dispatch","InternalContext","PublicContext","getInitialState","nodes","translate","containers","reducer","state","action","DragMove","DragEnd","DragCancel","RegisterDroppable","set","SetDroppableDisabled","UnregisterDroppable","delete","RestoreFocus","previousActivatorEvent","previousActiveId","activeElement","draggableNode","requestAnimationFrame","focusableNode","focus","ActiveDraggableContext","Status","DndContext","memo","_sensorContext$curren","_dragOverlay$nodeRef$","_dragOverlay$rect","_over$rect","accessibility","sensors","collisionDetection","measuring","modifiers","store","useReducer","dispatchMonitorEvent","registerMonitorListener","Set","_listener$type","useDndMonitorProvider","status","setStatus","Uninitialized","isInitialized","Initialized","activeId","activeRects","initial","translated","_node$data","activeRef","activeSensor","setActiveSensor","setActivatorEvent","latestProps","draggableDescribedById","enabledDroppableContainers","config","dragging","queue","setQueue","containersRef","Always","BeforeDragging","isDisabled","disabledRef","concat","map","useDroppableMeasuring","cachedNode","useCachedNode","activationCoordinates","autoScrollOptions","activeSensorDisablesAutoscroll","autoScrollGloballyDisabled","getAutoScrollerOptions","initialActiveNodeRect","useInitialRect","initialRect","initialized","rectDelta","useLayoutShiftScrollCompensation","layoutShiftCompensation","parentElement","sensorContext","draggingNode","draggingNodeRect","scrollAdjustedTranslate","overNode","usesDragOverlay","nodeRectDelta","previousNode","ancestors","useScrollableAncestors","elements","firstElement","rects","setRects","measureRects","useRects","modifiedTranslate","applyModifiers","overlayNodeRect","scrollCoordinates","setScrollCoordinates","prevElements","handleScroll","previousElements","cleanup","scrollableElement","useScrollOffsets","scrollAdjustment","activeNodeScrollDelta","overId","firstCollision","getFirstCollision","setOver","adjustScale","activeSensorRef","instantiateSensor","Sensor","sensorInstance","onDragAbort","onDragPending","unstable_batchedUpdates","Initializing","createHandler","async","cancelDrop","Promise","resolve","getSyntheticHandler","useCombineActivators","activeDraggableNode","dndKit","defaultPrevented","activationContext","capturedBy","teardownFns","teardown","useSensorSetup","overContainer","publicContext","internalContext","Provider","restoreFocus","NullContext","defaultRole","useDraggable","attributes","roleDescription","tabIndex","isDragging","setActivatorNodeRef","useSyntheticListeners","dataRef","defaultResizeObserverConfig","timeout","arrayMove","array","to","newArray","splice","getSortedRects","items","isValidIndex","rectSortingStrategy","activeIndex","overIndex","newRects","oldRect","defaultScale$1","verticalListSortingStrategy","_rects$activeIndex","fallbackActiveRect","overIndexRect","itemGap","clientRects","previousRect","nextRect","getItemGap$1","ID_PREFIX","Context","containerId","disableTransforms","useDragOverlay","sortedRects","SortableContext","userDefinedItems","disabledProp","item","previousItemsRef","itemsHaveChanged","i","itemsEqual","normalizeDisabled","contextValue","defaultNewIndexGetter","defaultAnimateLayoutChanges","isSorting","wasDragging","newIndex","previousItems","previousContainerId","transition","defaultTransition","transitionProperty","disabledTransition","defaultAttributes","useSortable","animateLayoutChanges","userDefinedAttributes","localDisabled","customData","getNewIndex","localStrategy","resizeObserverConfig","globalDisabled","globalStrategy","_localDisabled$dragga","_localDisabled$droppa","normalizeLocalDisabled","sortable","itemsAfterCurrentSortable","isOver","setDroppableNodeRef","previous","resizeObserverConnected","callbackId","resizeObserverDisabled","updateMeasurementsFor","resizeObserverTimeout","isArray","newElement","previousElement","unobserve","useDroppable","setDraggableNodeRef","refs","useCombinedRefs","displaceItem","shouldDisplaceDragSource","dragSourceDisplacement","finalTransform","shouldAnimateLayoutChanges","derivedTransform","setDerivedtransform","previousIndex","useDerivedTransform","getTransition","DateAmountPickerPopover","onConfirm","placeholder","align","side","defaultDate","defaultAmount","open","setOpen","selectedDate","setSelectedDate","amount","setAmount","jsxs","Popover","onOpenChange","jsx","PopoverTrigger","asChild","PopoverContent","className","sideOffset","Calendar","mode","selected","onSelect","locale","ko","initialFocus","fromDate","Date","toDate","defaultMonth","today","modifiersClassNames","Input","e","replace","numValue","parseInt","toLocaleString","Button","variant","size","onClick","amountNum","isNaN","DateQuantityPickerPopover","defaultQuantity","maxQuantity","hideQuantityInput","quantityInfoText","quantity","setQuantity","quantityNum","useConfirmDateAction","currentUserName","canPerformAction","purchaseId","onUpdate","onBeforeUpdate","onOptimisticUpdate","supabase","createClient","handleConfirm","itemId","itemInfo","receivedQuantity","logger","warn","toast","error","field","numericId","confirmMessage","item_name","specification","unit_price_value","amount_value","remark","confirm","updateData","is_statement_received","statement_received_date","dateToISOString","statement_received_by_name","requestedQuantity","currentReceivedQuantity","received_quantity","newReceivedQuantity","totalReceivedQuantity","existingItem","select","eq","single","existingHistory","receipt_history","newHistoryItem","seq","qty","date","by","updatedHistory","isFullyReceived","actual_received_date","is_received","delivery_status","debug","historyCount","update","info","markItemAsReceived","markItemAsStatementReceived","success","successMessage","itemName","markItemAsReceiptCanceled","markItemAsStatementCanceled","isCompleted","isPartiallyReceived","receivedQty","requestedQty","getRemainingQuantity","getCompletedDate","getCompletedByName","DONE_TAB_COLUMNS","label","description","defaultVisible","DEFAULT_COLUMN_VISIBILITY","column","REQUIRED_COLUMNS","RESTRICTED_COLUMNS","AUTHORIZED_ROLES","UTK_AUTHORIZED_ROLES","COLUMN_GROUPS","title","columns","normalizeOrderNumber","input","normalized","toUpperCase","poMatch","match","num","padStart","soMatch","transactionStatementService","uploadStatement","file","uploaderName","ext","pop","toLowerCase","uuid","crypto","randomUUID","storagePath","uploadData","uploadError","storage","upload","contentType","upsert","urlData","getPublicUrl","imageUrl","publicUrl","user","auth","getUser","statement","dbError","insert","image_url","file_name","uploaded_by","uploaded_by_name","message","statementId","extractStatementData","functions","invoke","getStatementWithItems","getStatements","filters","query","count","ascending","dateFrom","gte","dateTo","lte","search","or","range","allPurchaseIds","matched_purchase_id","purchaseInfoMap","purchases","in","p","purchase_order_number","sales_order_number","purchaseIds","matchedPurchases","purchase_id","rest","matched_purchases","stmtError","itemsError","statementVendorName","vendor_name","itemsWithMatch","all","matchCandidates","findMatchCandidates","matchedPurchase","matchedItem","purchase","vendor","matched_item_id","purchaseItem","match_candidates","matched_purchase","matched_item","candidateMap","rawNumber","extracted_po_number","normalizedNumber","partialPOMatch","partialSOMatch","isPartialNumber","datePrefix","byNumber","sysVendorName","vendorSimilarity","calculateVendorSimilarity","matchReasons","score","extracted_item_name","itemMatch","calculateItemMatchScore","matchedField","extracted_quantity","item_id","unit_price","match_reasons","byDatePrefix","has","trim","searchTermCandidates","substring","t","uniqueSearchTerms","searchTerm","byNameOrSpec","sysPO","sysSO","hasHighQualityCandidate","c","vendors","matchedVendors","v","vendorIds","threeMonthsAgo","setMonth","getMonth","recentPurchases","toISOString","candidates","calculateNameSimilarity","name1","name2","s1","s2","maxLen","similarity","levenshteinDistance","ocrItemName","systemItemName","systemSpecification","itemNameScore","specScore","vendor1","vendor2","normalize","n1","n2","translitMap","yg","tech","high","korea","electric","steel","metal","system","soft","net","global","trade","international","n1Replaced","n2Replaced","val","isVendorMatch","m","n","dp","fill","j","calculateSimilarityScore","extractedItem","extracted_specification","diff","extracted_unit_price","getMatchReasons","reasons","updateItemMatch","matchedPurchaseId","matchedItemId","matchMethod","match_method","confirmStatement","request","confirmerName","itemError","is_confirmed","confirmed_quantity","confirmed_unit_price","confirmed_amount","is_additional_item","parent_item_id","purchaseError","statementItem","getStatementItem","insertError","purchase_request_id","extracted_amount","confirmed_at","confirmed_by","confirmed_by_name","rejectStatement","deleteStatement","path","remove","findBestMatchingPurchaseOrderSet","extractedItems","extractedPONumber","purchaseScores","setScore","calculateSetMatchScore","matchScore","matchedItemCount","matchedCount","totalItemCount","itemMatches","bestByNumber","bestMatch","confidence","ocrItems","systemItems","usedSystemItems","totalSimilarity","ocrItem","sysItem","quantityBonus","totalScore","ocrItemId","systemItemId","matchRatio","avgSimilarity","saveCorrection","statement_id","statement_item_id","original_text","corrected_text","field_type","corrected_by","getStatementsByPurchaseId","statementIds","statements","SortableRow","PurchaseDetailModal$1","isOpen","onClose","embedded","currentUserRoles","activeTab","onRefresh","onDelete","allPurchases","lastFetch","usePurchaseMemory","loading","setLoading","setPurchase","isEditing","setIsEditing","editedPurchase","setEditedPurchase","editedItems","setEditedItems","deletedItemIds","setDeletedItemIds","userRoles","setUserRoles","setCurrentUserName","columnWidths","setColumnWidths","focusedInput","setFocusedInput","setVendors","vendorSearchTerm","setVendorSearchTerm","isModifyRequestOpen","setIsModifyRequestOpen","modifySubject","setModifySubject","modifyMessage","setModifyMessage","isSendingModify","setIsSendingModify","isSaving","setIsSaving","linkedStatements","setLinkedStatements","isStatementViewerOpen","setIsStatementViewerOpen","selectedStatementImage","setSelectedStatementImage","useSensors","makeStableKey","idx","stableKey","tempId","line_number","normalizeItems","withTemp","getSortableId","handleDragEnd","prev","oldIndex","findIndex","isEditingRef","isSavingRef","lastSaveAtRef","lastAddItemAtRef","realtimeFirstMount","isUpdatingRef","unsubscribe","addCacheListener","now","updatedPurchase","findPurchaseInMemory","cacheItems","purchase_request_items","currentItems","preservedItems","String","is_po_generated","memoryPurchase","find","memoryItems","displayItems","la","lb","ca","created_at","getTime","cb","ia","ib","ta","tb","sortableIds","columnGap","total","sum","baseColumns","headerRowRef","supabaseUrl","employeeData","maybeSingle","email","employeeByEmail","purchase_role","roles","loadUserRoles","vendorsData","loadVendors","effectiveRoles","canEditAll","canEditLimited","canEdit","canViewFinancialInfo","showStatementColumns","payment_category","showExpenditureColumn","canDelete","final_manager_status","requester_name","canPurchase","canReceiveItems","isAdmin","isRequester","canReceiptCheck","canProcessReceipt","refreshModalData","vendorContacts","vendor_id","allContacts","contact_id","currentContact","otherContacts","allContacts_count","contact","sortedItems","itemsData","calculated_amount","purchaseData","vendor_contacts","contact_name","vendorContacts_from_query","purchase_updated","has_vendor_contacts","purchaseData_full","refreshModalDataWithLock","handleToggleUtkCheck","newStatus","is_utk_checked","updated_at","updatePurchaseInMemory","refreshResult","silent","normalizedItems","is_active","isInitialLoad","setIsInitialLoad","purchaseIdNumber","NaN","handleActualReceiptOptimisticUpdate","itemIdStr","nowIso","selectedDateIso","updateItems","received_at","updatedItems","updatedRequestItems","completed","allReceived","prevItems","prevPurchase","handleStatementReceivedOptimisticUpdate","nextAllCompleted","nextStatementAt","every","statement_received_at","allCompleted","then","handleBeforeUpdate","statementReceivedAction","completedText","waitingText","actualReceivedAction","canApproveMiddle","canApproveFinal","approvalButtonClass","approvalWaitingPillClass","loadPurchaseDetail","loadLinkedStatements","result","calculateOptimalColumnWidths","columnConfigs","minWidth","maxWidth","baseWidth","calculatedWidths","maxLength","headers","statusHeader","quantityHeader","baseHeaders","receiptHeaders","doneHeaders","getHeaders","cellValue","tax_amount_value","getStatusDisplay","formatDate","expenditure_date","expenditure_amount","adjustedLength","char","ceil","calculatedWidth","is_payment_completed","getGridTemplateColumns","receiptColumns","doneColumns","hasItems","handleEditToggle","editing","safeNumber","trimmed","formatCurrency","Intl","NumberFormat","format","normalizeCurrency","currency","getPurchaseDisplayCurrency","getItemDisplayCurrency","unit_price_currency","amount_currency","tax_amount_currency","formatMoney","getCurrencySymbol","withTimeout","promise","timeoutMs","race","_","reject","handleItemChange","newItems","is_amount_manual","unitPrice","taxAmount","handlePaymentToggle","purchaseItems","requestItems","targetItem","unit","payment_completed_at","markItemAsPaymentCompleted","markItemAsPaymentCanceled","prevRequestItems","payment_completed_by_name","handleItemReceiptToggle","currentItem","newReceivedQty","totalReceivedQty","deliveryStatus","handleApprove","approvalType","middle_manager_status","handleItemExpenditure","totalExpenditure","total_expenditure_amount","markItemAsExpenditureSet","renderItemRow","dragProps","rowKey","rowProps","gridTemplateColumns","onFocus","onBlur","wordBreak","overflowWrap","hyphens","WebkitHyphens","MozHyphens","msHyphens","lineHeight","maxHeight","WebkitLineClamp","WebkitBoxOrient","hasReceived","onWheel","currentTarget","blur","link","href","rel","boxSizing","it","handleRemoveItem","Trash2","DatePickerPopover","onDateSelect","toLocaleDateString","year","month","day","hasExpenditure","hasExpenditureAmount","getFullYear","getDate","toLocaleTimeString","hour","minute","content","category","getStatusBadge","request_date","Check","X","FileText","CheckCircle","request_type","delivery_request_date","formatDateInput","revised_delivery_request_date","Building2","ReactSelect","option","selectedVendor","contactsData","contactsCount","updated","updated_vendor_contacts","updated_full","isClearable","isSearchable","menuPortalTarget","styles","control","base","minHeight","fontSize","borderRadius","borderColor","borderWidth","backgroundColor","boxShadow","paddingLeft","paddingRight","outline","valueContainer","indicatorsContainer","indicatorSeparator","dropdownIndicator","svg","clearIndicator","menuPortal","zIndex","classNamePrefix","contacts","uniqueContacts","arr","finalUniqueContacts","vendor_contacts_raw","vendor_contacts_count","unique_by_id_count","final_unique_count","firstContact","selectedContact","noOptionsMessage","contactName","purchase_contact_name","purchase_full","project_vendor","project_item","FileCheck","stmt","handleViewStatementImage","ImageIcon","statement_date","uploaded_at","grand_total","Package","marginLeft","singleValue","allItems","pendingItems","CreditCard","applyOptimisticUpdate","itemReceivedQuantity","requestError","markBulkExpenditureSet","deltaMs","newItem","lineNum","random","Plus","Dialog","DialogContent","showCloseButton","DialogHeader","DialogTitle","Edit2","onOpenAutoFocus","Label","htmlFor","Textarea","resize","createdInquiry","user_id","user_email","user_name","inquiry_type","subject","requester_id","purchase_info","total_amount","item_count","inquiryId","msgError","inquiry_id","sender_role","sender_email","attachments","STEP_TIMEOUT_MS","totalAmount","contactId","updateResult","updateError","finalContactId","contactUpdateError","contact_email","contact_phone","newContact","contactInsertError","purchaseUpdateError","contactError","deleteResult","deleteError","requestDeleteError","removePurchaseFromMemory","itemTimeoutMs","normalizedUnitPriceValue","normalizedAmountValue","numericItemId","isExistingItem","unitPriceValue","finalAmountValue","updateItemResult","insertData","insertItemResult","sourceData","removeItemFromMemory","memoryError","finalItems","optimisticError","catch","err","msg","errorMessage","Loader2","Save","src","alt"],"mappings":"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AagB,KAAMhB,GAAac,MAAOd,GAAaiB,GAAIjB,GAAae,KIvoBlF,MAAMilB,GAAiC,CAC5C,CACEv1B,GAAI,qBACJw1B,MAAO,QACPC,YAAa,eACbC,gBAAgB,GAElB,CACE11B,GAAI,wBACJw1B,MAAO,OACPC,YAAa,UACbC,gBAAgB,GAElB,CACE11B,GAAI,mBACJw1B,MAAO,OACPC,YAAa,2BACbC,gBAAgB,GAElB,CACE11B,GAAI,iBACJw1B,MAAO,MACPC,YAAa,cACbC,gBAAgB,GAElB,CACE11B,GAAI,eACJw1B,MAAO,MACPC,YAAa,WACbC,gBAAgB,GAElB,CACE11B,GAAI,aACJw1B,MAAO,MACPC,YAAa,YACbC,gBAAgB,GAElB,CACE11B,GAAI,cACJw1B,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACE11B,GAAI,eACJw1B,MAAO,MACPC,YAAa,UACbC,gBAAgB,GAElB,CACE11B,GAAI,wBACJw1B,MAAO,QACPC,YAAa,WACbC,gBAAgB,GAElB,CACE11B,GAAI,wBACJw1B,MAAO,QACPC,YAAa,YACbC,gBAAgB,GAElB,CACE11B,GAAI,YACJw1B,MAAO,KACPC,YAAa,SACbC,gBAAgB,GAElB,CACE11B,GAAI,gBACJw1B,MAAO,KACPC,YAAa,WACbC,gBAAgB,GAElB,CACE11B,GAAI,WACJw1B,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACE11B,GAAI,aACJw1B,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACE11B,GAAI,SACJw1B,MAAO,KACPC,YAAa,OACbC,gBAAgB,GAElB,CACE11B,GAAI,SACJw1B,MAAO,KACPC,YAAa,WACbC,gBAAgB,GAElB,CACE11B,GAAI,OACJw1B,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACE11B,GAAI,iBACJw1B,MAAO,OACPC,YAAa,UACbC,gBAAgB,GAElB,CACE11B,GAAI,eACJw1B,MAAO,UACPC,YAAa,WACbC,gBAAgB,GAElB,CACE11B,GAAI,qBACJw1B,MAAO,OACPC,YAAa,QACbC,gBAAgB,GAEl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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10]}