{"version":3,"mappings":";;;;;;;GASA,MAaMA,GAAWC,EAAiB,WAbf,CACjB,CAAC,OAAQ,CAAEC,EAAG,aAAcC,IAAK,WACjC,CAAC,OAAQ,CAAED,EAAG,aAAcC,IAAK,WACjC,CAAC,OAAQ,CAAED,EAAG,YAAaC,IAAK,WAChC,CAAC,OAAQ,CAAED,EAAG,aAAcC,IAAK,WACjC,CAAC,OAAQ,CAAED,EAAG,aAAcC,IAAK,WACjC,CAAC,OAAQ,CAAED,EAAG,YAAaC,IAAK,WAChC,CAAC,OAAQ,CAAED,EAAG,YAAaC,IAAK,WAChC,CAAC,OAAQ,CAAED,EAAG,YAAaC,IAAK,WAChC,CAAC,OAAQ,CAAED,EAAG,WAAYC,IAAK,WAC/B,CAAC,OAAQ,CAAED,EAAG,2CAA4CC,IAAK,WAC/D,CAAC,OAAQ,CAAEC,EAAG,IAAKC,EAAG,IAAKC,MAAO,KAAMC,OAAQ,KAAMC,GAAI,IAAKL,IAAK,aCOhEM,GAASR,EAAiB,UAlBb,CACjB,CACE,OACA,CACEC,EAAG,iGACHC,IAAK,WAGT,CAAC,OAAQ,CAAED,EAAG,uCAAwCC,IAAK,WAC3D,CACE,OACA,CACED,EAAG,+FACHC,IAAK,WAGT,CAAC,OAAQ,CAAED,EAAG,aAAcC,IAAK,aCN7BO,GAAWT,EAAiB,WAVf,CACjB,CACE,OACA,CACEC,EAAG,0UACHC,IAAK,WAGT,CAAC,SAAU,CAAEQ,GAAI,KAAMC,GAAI,KAAMC,EAAG,IAAKV,IAAK,aCG1CW,GAAkBb,EAAiB,mBAXtB,CACjB,CAAC,OAAQ,CAAEc,GAAI,IAAKC,GAAI,IAAKC,GAAI,KAAMC,GAAI,KAAMf,IAAK,WACtD,CAAC,OAAQ,CAAEY,GAAI,IAAKC,GAAI,IAAKC,GAAI,KAAMC,GAAI,IAAKf,IAAK,WACrD,CAAC,OAAQ,CAAEY,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMf,IAAK,WACxD,CAAC,OAAQ,CAAEY,GAAI,KAAMC,GAAI,KAAMC,GAAI,IAAKC,GAAI,IAAKf,IAAK,WACtD,CAAC,OAAQ,CAAEY,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMf,IAAK,WACxD,CAAC,OAAQ,CAAEY,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,GAAI,IAAKf,IAAK,WACvD,CAAC,OAAQ,CAAEY,GAAI,IAAKC,GAAI,IAAKC,GAAI,KAAMC,GAAI,KAAMf,IAAK,WACtD,CAAC,OAAQ,CAAEY,GAAI,KAAMC,GAAI,KAAMC,GAAI,IAAKC,GAAI,IAAKf,IAAK,WACtD,CAAC,OAAQ,CAAEY,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMf,IAAK,aCb7CgB,GAAmB,CAAC,OCUpBC,GAAc,CACzBC,EACAC,EACAC,KAEA,IAAKF,IAAcE,QAAoB,GAEvC,MAAMC,EAAYC,MAAMC,QAAQH,EAAYI,eACxCJ,EAAYI,cAAcC,IAAKf,GAAcA,EAAEgB,QACV,iBAA9BN,EAAYI,cACnBJ,EAAYI,cAAcG,MAAM,KAAKF,IAAKf,GAAcA,EAAEgB,QAC1D,GAEJ,OAAQP,GACN,IAAK,UAEH,OAAOD,EAAUU,OAAOC,IAEtB,GAAuC,aAAnCA,EAASC,uBACyB,aAAlCD,EAASE,qBACX,OAAO,EAIT,GAAuC,aAAnCF,EAASC,uBACyB,aAAlCD,EAASE,qBACX,OAAO,EAIT,GAAIV,EAAUW,SAAS,uBAEa,UAA9BH,EAASI,iBACX,OAAO,EAIX,GAAIZ,EAAUW,SAAS,yBAEa,OAA9BH,EAASI,iBACX,OAAO,EAKX,GAAIZ,EAAUW,SAAS,cACnBX,EAAUW,SAAS,OAErB,OADAE,EAAOC,MAAM,gDAAiD,CAAEC,sBAAuBP,EAASO,yBACzF,EAIT,GAAIf,EAAUW,SAAS,kBAAmB,CAIxC,MAHwB,CAAC,UAAW,KAAM,GAAI,UAAM,GAAWA,SAC7DH,EAASC,sBAGb,CAGA,OAAOD,EAASQ,iBAAmBjB,GAAakB,OAIpD,IAAK,WAAY,CAGf,MAAMC,EAAiBlB,EAAUmB,KAAMC,GACrC,CAAC,YAAa,MAAO,aAAc,eAAgB,uBAAwB,qBAAsB,mBAAoB,MAAMT,SAASS,IAGtI,OAAOvB,EAAUU,OAAOC,IACtB,MAAMa,EAA0C,UAA9Bb,EAASI,iBACrBU,GAAWd,EAASe,qBAC1B,IAAKF,IAAcC,EAAS,OAAO,EAEnC,MAAME,GAAahB,EAASiB,eAAiB,IAAId,SAAS,OACpDe,GAAWlB,EAASiB,eAAiB,IAAId,SAAS,QAAUH,EAASiB,eAA4C,KAA3BjB,EAASiB,cAC/FE,EAAkD,aAAlCnB,EAASE,qBAG/B,SAFwBc,GAAcE,GAAWC,OAK7CT,GAKGV,EAASQ,iBAAmBjB,GAAakB,OAEpD,CAEA,IAAK,UAAW,CAGd,MAAMW,EAAY5B,EAAUW,SAAS,MAC/BO,EAAiBlB,EAAUmB,KAAMC,GACrC,CAAC,YAAa,MAAO,aAAc,eAAgB,uBAAwB,qBAAsB,oBAAoBT,SAASS,IAGhI,OAAOvB,EAAUU,OAAOC,IACtB,GAAIA,EAASqB,YAAa,OAAO,EAGjC,GAAID,GAAaV,EAAgB,CAC/B,MAAMM,GAAahB,EAASiB,eAAiB,IAAId,SAAS,OACpDgB,EAAkD,aAAlCnB,EAASE,qBAC/B,OAAOc,GAAaG,CACtB,CAGA,MAAMH,GAAahB,EAASiB,eAAiB,IAAId,SAAS,OACpDgB,EAAkD,aAAlCnB,EAASE,qBACzBoB,EAActB,EAASQ,iBAAmBjB,GAAakB,KAE7D,OAAQO,GAAaG,IAAkBG,GAE3C,CAGA,QAEE,OAAOjC,IAiMPkC,GAAgB,CAACvB,EAAoBwB,KAEzC,GAAc,yBAAVA,EAAkC,CAEpC,OAAiB,IADHxB,EAASe,qBACC,KAAO,IACjC,CACA,GAAc,gBAAVS,EAAyB,CAG3B,OAAiB,IADHxB,EAASqB,YACC,KAAO,IACjC,CACA,GAAc,0BAAVG,EAAmC,CAErC,OAAiB,IADHxB,EAASyB,sBACC,KAAO,IACjC,CACA,GAAc,mBAAVD,EAA4B,CAE9B,OAAiB,IADHxB,EAAS0B,eACC,KAAO,IACjC,CAGA,MAAMC,EAAOH,EAAM1B,MAAM,KACzB,IAAI8B,EAAa5B,EAEjB,UAAW7B,KAAOwD,EAAM,CACtB,GAAIC,QAAuC,OAAO,KAClDA,EAAQA,EAAMzD,EAChB,CAEA,OAAOyD,GAMIC,GAAqB,CAChCC,EACAvC,KAEO,CACLwC,QAAS3C,GAAY0C,EAAc,UAAWvC,GAAayC,OAC3DhC,SAAUZ,GAAY0C,EAAc,WAAYvC,GAAayC,OAC7DC,QAAS7C,GAAY0C,EAAc,UAAWvC,GAAayC,OAC3DE,KAAM9C,GAAY0C,EAAc,OAAQvC,GAAayC,SAiB5CG,GAAkB,CAC7B9C,EACA+C,EACA7C,KAEA,IAAI8C,EAAWhD,EAgCf,OA7BI+C,EAAQ9C,MACV+C,EAAWjD,GAAYiD,EAAUD,EAAQ9C,IAAKC,IAI5C6C,EAAQE,eACVD,EAnQ4B,EAC9BhD,EACAiD,EACA/C,KAEA,IAAKF,IAAciD,GAAiC,OAAjBA,EAAuB,OAAOjD,EAGjE,MAKMqB,GALYjB,MAAMC,QAAQH,GAAaI,eACzCJ,EAAYI,cAAcC,IAAKf,GAAcA,EAAEgB,QACT,iBAA/BN,GAAaI,cACpBJ,EAAYI,cAAcG,MAAM,KAAKF,IAAKf,GAAcA,EAAEgB,QAC1D,IAC6Bc,KAAMC,GACrC,CAAC,aAAc,MAAO,eAAgB,uBAAwB,sBAAsBT,SAASS,IAG/F,OAAOvB,EAAUU,OAAOC,IACtB,MAAMuC,EAAgBvC,EAASQ,gBAAkB,GAGjD,QAAIrB,GAAiBgB,SAASoC,KAAmB7B,IAI1C6B,IAAkBD,KA0OdE,CAAiBH,EAAUD,EAAQE,aAAc/C,IAI1D6C,EAAQK,aACVJ,EA/J8B,EAChChD,EACAoD,KAEA,IAAKA,GAAoC,KAAtBA,EAAW5C,OAAe,OAAOR,EAEpD,MAAMqD,EAAOD,EAAWE,cAAc9C,OAEtC,OAAOR,EAAUU,OAAOC,GAEG,CACvBA,EAASO,sBACTP,EAASQ,eACTR,EAAS4C,YACT5C,EAAS6C,iBAEL7C,EAAS8C,wBAA0B,IAAIlD,IAAKmD,GAAc,CAC5DA,EAAKC,UACLD,EAAKE,YACLF,EAAKG,aACLH,EAAKI,MACLJ,EAAKK,cACLL,EAAKM,OACJC,QAImB3C,KAAKa,GAC3BA,GAAS+B,OAAO/B,GAAOmB,cAAcxC,SAASuC,MAmIrCc,CAAmBnB,EAAUD,EAAQK,aAI9CL,EAAQqB,kBACVpB,EA7OgC,EAClChD,EACAqE,IAEKA,GAA8B,IAAnBA,EAAQ1B,OAEjB3C,EAAUU,OAAOC,GACf0D,EAAQC,MAAM5D,IACnB,MAAMyB,MAAEA,EAAAoC,UAAOA,EAAAhC,MAAWA,EAAAiC,UAAOA,GAAc9D,EAIzC+D,EAAavC,GAAcvB,EADb6D,GAAarC,GAGjC,OAAQoC,GACN,IAAK,WACH,OAAOL,OAAOO,GAAYnB,cAAcxC,SAASoD,OAAO3B,GAAOe,eACjE,IAAK,SAEH,GAAqB,iBAAVf,GAAsBA,EAAMzB,SAAS,KAAM,CACpD,MAAO4D,EAAWC,GAAWpC,EAAM9B,MAAM,KACnCmE,EAAe,IAAIC,KAAKJ,GAAYK,cAAcrE,MAAM,KAAK,GACnE,OAAOmE,GAAgBF,GAAaE,GAAgBD,CACtD,CAEA,GAAqB,iBAAVpC,IAAuBA,EAAMwC,MAAM,kBAAoBxC,EAAMwC,MAAM,8BAA+B,CAC3G,GAAIxC,EAAMzB,SAAS,KAAM,CACvB,MAAOkE,EAAYC,GAAY1C,EAAM9B,MAAM,KACrCyE,EAAgB,IAAIL,KAAKJ,GAAYK,cAAcK,MAAM,EAAG,GAClE,OAAOD,GAAiBF,GAAcE,GAAiBD,CACzD,CAEE,OADsB,IAAIJ,KAAKJ,GAAYK,cAAcK,MAAM,EAAG,KACzC5C,CAE7B,CACA,OAAOkC,IAAelC,EACxB,IAAK,aACH,OAAOkC,IAAelC,EACxB,IAAK,cACH,OAAO2B,OAAOO,GAAYnB,cAAc8B,WAAWlB,OAAO3B,GAAOe,eACnE,IAAK,YACH,OAAOY,OAAOO,GAAYnB,cAAc+B,SAASnB,OAAO3B,GAAOe,eACjE,IAAK,eACH,OAAOgC,OAAOb,GAAca,OAAO/C,GACrC,IAAK,YACH,OAAO+C,OAAOb,GAAca,OAAO/C,GACrC,IAAK,QACH,OAAO,IAAIsC,KAAKJ,GAAc,IAAII,KAAKtC,GACzC,IAAK,SACH,OAAO,IAAIsC,KAAKJ,GAAc,IAAII,KAAKtC,GACzC,IAAK,WACH,OAAQkC,GAA6B,KAAfA,GAAoC,OAAfA,EAC7C,IAAK,eACH,OAAOA,GAA6B,KAAfA,GAAoC,OAAfA,EAC5C,IAAK,UAAW,CACd,MAAOc,EAAKC,GAAOjD,EAAM9B,MAAM,KAAKF,IAAI+E,QAClCG,EAAWH,OAAOb,GACxB,OAAOgB,GAAYF,GAAOE,GAAYD,CACxC,CACA,IAAK,KAEH,OADejD,EAAM9B,MAAM,KAAKF,IAAKmF,GAAcA,EAAElF,QACvCM,SAASoD,OAAOO,IAEhC,QACE,OAAO,MA5D8BzE,EAyOhC2F,CAAqB3C,EAAUD,EAAQqB,mBAIhDrB,EAAQ2B,WAAa3B,EAAQ4B,WAC/B3B,EArI6B,EAC/BhD,EACA0E,EACAC,IAEKD,GAAcC,EAEZ3E,EAAUU,OAAOC,IACtB,MAAMiF,EAAc,IAAIf,KAAKlE,EAASkF,cAEtC,QAAInB,GAAakB,EAAc,IAAIf,KAAKH,IACpCC,GAAWiB,EAAc,IAAIf,KAAKF,MANL3E,EAgItB8F,CAAkB9C,EAAUD,EAAQ2B,UAAW3B,EAAQ4B,UAIhE5B,EAAQgD,aACV/C,EAtHyB,EAC3BhD,EACA+F,IAEKA,EAEE,IAAI/F,GAAWgG,KAAK,CAACC,EAAGC,KAC7B,MAAMC,EAASjE,GAAc+D,EAAGF,EAAWjH,KACrCsH,EAASlE,GAAcgE,EAAGH,EAAWjH,KAE3C,GAAIqH,QAAyC,OAAO,EACpD,GAAIC,QAAyC,OAAO,EAEpD,IAAIC,EAAa,EAIjB,OAHIF,EAASC,IAAQC,EAAa,GAC9BF,EAASC,IAAQC,GAAa,GAEF,SAAzBN,EAAWO,WAAwBD,EAAaA,IAbjCrG,EAkHXuG,CAAcvD,EAAUD,EAAQgD,aAGtC/C,GClaF,SAASwD,KACd,MAAMC,EAAmBC,EAAoBjE,aACzC,IAAIiE,EAAoBjE,cACxB,GACEkE,GAAkBD,EAAoBjE,cAAgBiE,EAAoBE,WAGzE5G,EAAW6G,GAAgBC,WAAqBL,IAChDM,EAASC,GAAcF,WAASH,IAChCM,EAAOC,GAAYJ,WAAwBJ,EAAoBO,OAGhE/G,EAAcwG,EAAoBxG,YAGxCiH,YAAU,KACR,IAAIC,EAAeV,EAAoBjE,aACnC4E,EAAgBX,EAAoBY,UAGxC,MAAMC,EAAa,KAEjB,MAAMC,EAAed,EAAoBjE,eAAiB2E,EACpDK,EAAmBf,EAAoBY,YAAcD,GAEvDG,GAAgBC,GAAyC,IAArBzH,EAAU2C,UAU5C+D,EAAoBjE,cACtBoE,EAAa,IAAIH,EAAoBjE,eACrCuE,GAAW,GACXI,EAAeV,EAAoBjE,aACnC4E,EAAgBX,EAAoBY,WAMpCN,EAAWN,EAAoBE,WAEjCM,EAASR,EAAoBO,SAKjCM,IAIA,MAAMG,EAAWC,YAAYJ,EAAY,IAEzC,MAAO,IAAMK,cAAcF,IAC1B,CAAC1H,EAAU2C,SAGd,MAAMkF,EAAuBC,cAAa/E,GACnC2D,EAAoBjE,aAElBK,GACL4D,EAAoBjE,aACpBM,EACA7C,GAL4C,GAO7C,CAACA,IAGE6H,EAAYC,UAAQ,IACnBhI,GAAkC,IAArBA,EAAU2C,OASrBH,GAAmBxC,EAAWE,GAR5B,CACLwC,QAAS,EACT/B,SAAU,EACViC,QAAS,EACTC,KAAM,GAKT,CAAC7C,EAAWE,IAGT+H,EAAQD,UAAQ,KACb,CACLE,MAAOlI,EAAU2C,OACjBwF,OAAQzB,EAAoBuB,OAAOG,aAAe,EAClDC,YAAa3B,EAAoBuB,OAAOI,aAAe,EACvDf,UAAWZ,EAAoBY,YAEhC,CAACtH,IAEJ,MAAO,CAELyC,aAAczC,EACd6H,uBAGAd,UACAE,QAGAc,YACAE,QAGA/H,cAEJ,CClHO,MAAMoI,GAAiC,CAC5C,CACEC,GAAI,qBACJC,MAAO,QACPC,YAAa,eACbC,gBAAgB,GAElB,CACEH,GAAI,wBACJC,MAAO,OACPC,YAAa,UACbC,gBAAgB,GAElB,CACEH,GAAI,mBACJC,MAAO,OACPC,YAAa,2BACbC,gBAAgB,GAElB,CACEH,GAAI,iBACJC,MAAO,MACPC,YAAa,cACbC,gBAAgB,GAElB,CACEH,GAAI,eACJC,MAAO,MACPC,YAAa,WACbC,gBAAgB,GAElB,CACEH,GAAI,aACJC,MAAO,MACPC,YAAa,YACbC,gBAAgB,GAElB,CACEH,GAAI,cACJC,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACEH,GAAI,eACJC,MAAO,MACPC,YAAa,UACbC,gBAAgB,GAElB,CACEH,GAAI,wBACJC,MAAO,QACPC,YAAa,WACbC,gBAAgB,GAElB,CACEH,GAAI,wBACJC,MAAO,QACPC,YAAa,YACbC,gBAAgB,GAElB,CACEH,GAAI,YACJC,MAAO,KACPC,YAAa,SACbC,gBAAgB,GAElB,CACEH,GAAI,gBACJC,MAAO,KACPC,YAAa,WACbC,gBAAgB,GAElB,CACEH,GAAI,WACJC,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACEH,GAAI,aACJC,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACEH,GAAI,SACJC,MAAO,KACPC,YAAa,OACbC,gBAAgB,GAElB,CACEH,GAAI,SACJC,MAAO,KACPC,YAAa,WACbC,gBAAgB,GAElB,CACEH,GAAI,OACJC,MAAO,KACPC,YAAa,QACbC,gBAAgB,GAElB,CACEH,GAAI,iBACJC,MAAO,OACPC,YAAa,UACbC,gBAAgB,GAElB,CACEH,GAAI,eACJC,MAAO,UACPC,YAAa,WACbC,gBAAgB,GAElB,CACEH,GAAI,qBACJC,MAAO,OACPC,YAAa,QACbC,gBAAgB,GAElB,CACEH,GAAI,oBACJC,MAAO,OACPC,YAAa,SACbC,gBAAgB,GAElB,CACEH,GAAI,mBACJC,MAAO,OACPC,YAAa,SACbC,gBAAgB,IAKPC,GAA8CL,GAAiBM,OAC1E,CAACC,EAAKC,KACJD,EAAIC,EAAOP,IAAMO,EAAOJ,eACjBG,GAET,IAIkEP,GAAiBM,OACnF,CAACC,EAAKC,KACJD,EAAIC,EAAOP,IAAMO,EACVD,GAET,IAIK,MAAME,GAAsC,CACjD,wBACA,cACA,YACA,UAIWC,GAAgB,CAC3B,CACEC,MAAO,QACPC,QAAS,CACP,qBACA,wBACA,mBACA,iBACA,eACA,eAGJ,CACED,MAAO,QACPC,QAAS,CACP,cACA,eACA,wBACA,0BAGJ,CACED,MAAO,QACPC,QAAS,CACP,YACA,gBACA,WACA,aACA,SACA,SACA,SAGJ,CACED,MAAO,UACPC,QAAS,CACP,iBACA,eACA,uBAGJ,CACED,MAAO,QACPC,QAAS,CACP,oBACA,sBCtKAC,GAAgEC,OAAK,EACzEC,aAAY,EACZC,YAAY,GACZC,mBACAC,sBACAC,iBACA7C,aAAY,MAIZ,MAAO8C,EAAgBC,GAAqB7C,WAA2ByC,IAChEK,EAAQC,GAAa/C,YAAS,GAUrC,GAPAK,YAAU,KACJyC,GACFD,EAAkBJ,IAEnB,CAACK,EAAQL,KAGPF,EACH,OAAO,KAIT,MAAMS,EAAqBC,OAAOC,OAAOT,GAAkB7I,OAAOuJ,SAAStH,OACrEuH,EAAmBH,OAAOzH,KAAKiH,GAAkB5G,OACjDwH,EAAmBJ,OAAOC,OAAON,GAAgBhJ,OAAOuJ,SAAStH,OAiCvE,OACEyH,OAACC,EAAA,CAAaC,KAAMV,EAAQW,aAAcV,EACxCW,SAAA,CAAAC,MAACC,EAAA,CAAoBC,SAAO,EAC1BH,WAAAJ,KAACQ,GAAOC,QAAQ,UAAUC,KAAK,KAAKxB,UAAW,eAAeA,IAAayB,SAAUnE,EACnF4D,SAAA,GAAAC,IAACpL,GAAA,CAASiK,UAAU,iBACpBmB,MAAC,QAAKnB,UAAU,cACbkB,SAAA5D,EAAY,UAAY,UAAUkD,KAAsBI,mBAK9Dc,EAAA,CAAoB1B,UAAU,8BAA8B2B,MAAM,MAAMC,kBAAmB,KAC1FvB,EAAkBJ,GAClBM,GAAU,IAEVW,SAAA,GAAAJ,KAAC,OAAId,UAAU,4DAEfkB,SAAA,GAAAJ,KAACe,EAAA,CAAkB7B,UAAU,2CAC3BkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,0BACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,sBAAsBkB,SAAA,eACtCJ,KAAC,QAAKd,UAAU,mBAAmBkB,SAAA,KAC/BL,EAAiB,IAAED,EAAiB,UAG1CO,MAACG,EAAA,CACCC,QAAQ,QACRC,KAAK,KACLM,QAhCU,KAClB3B,IACAI,GAAU,IA+BFP,UAAU,aACVL,MAAM,YAENuB,SAAAC,MAACY,EAAA,CAAU/B,UAAU,uBAIxBgC,EAAA,IAGAtC,GAAczI,IAAI,CAACgL,EAAOC,MACzBpB,KAACqB,EAAMC,SAAN,CAEClB,SAAA,GAAAC,IAAC,OAAInB,UAAU,YACbkB,SAAAC,MAAC,OAAInB,UAAU,cACZkB,SAAAe,EAAMtC,UAKXwB,MAAC,OAAInB,UAAU,gCACZkB,WAAMtB,QAAQ3I,IAAKoL,IAClB,MAAMtC,EAAYK,EAAeiC,GAC3BC,EAAa7C,GAAiBjI,SAAS6K,GA4B7C,OACEvB,OAAC,OAECd,UAAW,yDACTsC,GAAcvC,EAAY,aAAe,mCAE3C+B,QAAS,KACDQ,GAAcvC,GApHb,CAACsC,IAEtB5C,GAAiBjI,SAAS6K,IAAajC,EAAeiC,IAI1DhC,EAAkBkC,IAAA,IACbA,EACHF,CAACA,IAAYE,EAAKF,OA6GAG,CAAmBH,IAIvBnB,SAAA,CAAAC,MAAC,OAAInB,UAAW,UACdsC,GAAcvC,EAAY,GAAK,+CAE9BmB,SAAAnB,EACCoB,MAACsB,EAAA,CAAIzC,UAAU,qCAEdlK,GAAA,CAAOkK,UAAU,kCAItBmB,IAAC,OAAInB,UAAU,iBACbkB,SAAAJ,OAAC,OAAId,UAAW,yBACbD,EAA8B,GAAlB,iBAEZmB,SAAA,CAnD6C,CACpDwB,mBAAoB,QACpB9K,sBAAuB,OACvBH,iBAAkB,OAClBI,eAAgB,MAChB0E,aAAc,MACdoG,WAAY,MACZ1I,YAAa,KACbC,aAAc,MACd0I,sBAAuB,QACvBC,sBAAuB,QACvBxI,UAAW,KACXI,cAAe,KACfqI,SAAU,KACVC,WAAY,KACZC,OAAQ,KACRC,OAAQ,KACRC,KAAM,KACNC,eAAgB,OAChBC,aAAc,UACdC,mBAAoB,OACpBC,kBAAmB,OACnBC,iBAAkB,QA6BElB,GACbC,GACCnB,MAAC,QAAKnB,UAAU,oBAAoBL,MAAM,QAAQuB,SAAA,aA1BnDmB,OAoCZH,EAAaxC,GAAcrG,OAAS,SAAM2I,EAAA,MA9ExBC,EAAMtC,cAkF5BqC,EAAA,UAGA,OAAIhC,UAAU,YACbkB,SAAAJ,OAAC,OAAId,UAAU,6BACbkB,SAAA,GAAAC,IAAC,OAAID,SAAA,4BACLC,IAAC,OAAID,SAAA,+BACLC,IAAC,OAAID,SAAA,uCAMRc,EAAA,MAGDlB,KAAC,OAAId,UAAU,yCACbkB,SAAA,CAAAJ,OAACQ,EAAA,CACCQ,QA5JU,KAClB5B,EAAoBE,GACpBG,GAAU,IA2JFP,UAAU,8DAEVkB,SAAA,GAAAC,IAACqC,EAAA,CAAMxD,UAAU,iBAAiB,QAGpCc,OAACQ,EAAA,CACCQ,QA7JW,KACnBzB,EAAkBJ,GAClBM,GAAU,IA4JFgB,QAAQ,UACRvB,UAAU,oFAEVkB,SAAA,GAAAC,IAACsC,EAAA,CAAEzD,UAAU,iBAAiB,mBAS1CH,GAAuB6D,YAAc,yBClQrC,MAYMC,GAAc7D,OAAK,EAAGzI,eAC1B,MAAMuM,EAASvM,EAASqB,YACpB,YACoC,aAAnCrB,EAASC,uBAA0E,aAAlCD,EAASE,qBAC3D,aACoC,aAAnCF,EAASC,uBAA0E,aAAlCD,EAASE,qBAC3D,WACA,WASEsM,KAAEA,EAAA7D,UAAMA,GAPC,CACb8D,UAAW,CAAED,KAAM,OAAQ7D,UAAW,iBACtC+D,WAAY,CAAEF,KAAM,OAAQ7D,UAAW,iBACvCgE,SAAU,CAAEH,KAAM,KAAM7D,UAAW,gBACnC5G,QAAS,CAAEyK,KAAM,OAAQ7D,UAAW,kBAGH4D,GACnC,aAAQ,QAAK5D,UAAW,eAAeA,IAAckB,SAAA2C,MAGvDF,GAAYD,YAAc,cAE1B,MAAMO,GAAqBnE,OAAK,EAAGzI,WAAUyK,cAC3C,MAAMoC,EAnCmB,CAAC7M,IAC1B,IAAKA,EAAS8C,wBAAqE,IAA3C9C,EAAS8C,uBAAuBd,OAAc,MAAO,CAAE8K,SAAU,EAAGvF,MAAO,EAAGwF,WAAY,GAElI,MAAMxF,EAAQvH,EAAS8C,uBAAuBd,OACxC8K,EAAW9M,EAAS8C,uBAAuB/C,OAAQgD,GACzB,OAA9BA,EAAKiK,2BAA+D,IAA9BjK,EAAKiK,sBAC3ChL,OAGF,MAAO,CAAE8K,WAAUvF,QAAOwF,WAFPxF,EAAQ,EAAI0F,KAAKC,MAAOJ,EAAWvF,EAAS,KAAO,IA4B9C4F,CAAmBnN,GACrCoN,EAAuC,QAA3BpN,EAASiB,eAA2BjB,EAASiB,eAAed,SAAS,OAEvF,OACEsJ,OAAC,OACCd,UAAW,2FAA0FyE,EAAY,4CAA8C,oBAC/J3C,QAAS,IAAMA,EAAQzK,GAGvB6J,SAAA,GAAAJ,KAAC,OAAId,UAAU,mCACbkB,SAAA,CAAAJ,OAAC,OACCI,SAAA,GAAAJ,KAAC,OAAId,UAAU,0BACZkB,SAAA,CAAAuD,EACCtD,MAAC,QAAKnB,UAAU,oCAAoCkB,SAAA,QAIpDC,MAAC,QAAKnB,UAAU,qCAAqCkB,SAAA,aAItD,QAAKlB,UAAU,2BACbkB,SAAA7J,EAASO,uBAAyB,WAGvCkJ,KAAC,OAAId,UAAU,gCACZkB,SAAA,CAAAwD,EAAgBrN,EAASkF,cAAc,YAG5C4E,MAACwC,IAAYtM,kBAIfyJ,KAAC,OAAId,UAAU,YACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,QAChCC,MAAC,QAAKnB,UAAU,aAAckB,WAASrJ,sBAEzCiJ,KAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,OAChCC,MAAC,QAAKnB,UAAU,aAAckB,WAASjH,iBAExC5C,EAAS8L,gBACRrC,OAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,SAChCC,MAAC,QAAKnB,UAAU,oCAAqCkB,WAASiC,oBAGjE9L,EAAS+L,cACRtC,OAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,YAChCC,MAAC,QAAKnB,UAAU,oCAAqCkB,WAASkC,kBAGjE/L,EAASgM,oBACRvC,OAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,SAChCC,MAAC,QAAKnB,UAAU,oCAAqCkB,WAASmC,wBAGjEhM,EAASgD,WACRyG,OAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,OAChCC,MAAC,QAAKnB,UAAU,oCAAqCkB,WAAS7G,iBAGlEyG,KAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,SAChCJ,KAAC,QAAKd,UAAU,8BACZkB,SAAA,EAAA7J,EAASsN,cAAgBtN,EAASuN,eAAeC,iBAAiB,IAAExN,EAASyN,oBAMrFhE,KAAC,OAAId,UAAU,YACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,+CACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,WAChCJ,KAAC,QAAKd,UAAU,gBACbkB,SAAA,CAAAgD,EAAgBC,SAAS,IAAED,EAAgBtF,MAAM,KAAGsF,EAAgBE,WAAW,aAGpFjD,IAAC,OAAInB,UAAU,+BACbkB,SAAAC,MAAC,OACCnB,UAAW,oCACsB,MAA/BkE,EAAgBE,WAAqB,eACrCF,EAAgBE,WAAa,EAAI,eAAiB,eAEpDW,MAAO,CAAEpP,MAAO,GAAGuO,EAAgBE,2BAMN,IAAlC/M,EAASe,sBACR0I,OAAC,OAAId,UAAU,kDACbkB,SAAA,CAAAC,MAAC,QAAKnB,UAAU,gBAAgBkB,SAAA,OAC/B7J,EAASe,qBACR+I,MAAC,QAAKnB,UAAU,sCAAsCkB,SAAA,OAEtDC,MAAC,QAAKnB,UAAU,qCAAqCkB,SAAA,gBAM1D,OAAIlB,UAAU,gBACbkB,SAAAJ,OAAC,OAAId,UAAU,4DACbkB,SAAA,GAAAC,IAACsB,EAAA,CAAIzC,UAAU,iBAAiB,sBAQ1CiE,GAAmBP,YAAc,qBC9IjC,MAGMsB,GAAqBlF,OAA8B,EACvDpJ,YACAuO,YACAC,aACAC,cACAC,oBACAC,oBACAC,kBACArF,mBACAsF,oBACAC,cACAC,oBACA7P,SAAS,IACT8P,sBAAqB,MAErB,MAAMC,EAAeC,SAAuB,OACrCC,EAAWC,GAAgBtI,WAAS,IACpCuI,EAAiBC,GAAsBxI,WAAS5H,IAGhDqQ,EAAeC,GAAoB1I,WAAS5H,IAG7CuQ,WAAEA,WAAYC,EAAAC,aAAUA,EAAAC,YAAcA,GAAgB5H,UAAQ,KAClE,MAAM6H,EAAY7P,EAAU2C,OACtBmN,EAAelC,KAAKmC,KAAKV,EA5Bf,IA8BVW,EAAQpC,KAAKqC,MAAMd,EA9BT,IA+BVe,EAAMtC,KAAKrI,IAAIyK,EAAQF,EA9Bb,EA8ByCD,GACnDM,EAAcvC,KAAKpI,IAAI,EAAGwK,EA/BhB,GAiChB,MAAO,CACLP,WAAYU,EACZT,SAAUQ,EACVP,aAAc3P,EAAUmF,MAAMgL,EAAaD,GAC3CN,YAtCc,GAsCDC,IAEd,CAAC7P,EAAWmP,EAAWE,IAGpBe,EAAetI,cAAauI,IAChC,MACMC,EAAoB1C,KAAKpI,IAAI,EAAG6K,EAAEE,cAAcpB,UADjC,IAErBC,EAAakB,IACZ,IA+DH,OA5DAnJ,YAAU,KACR,MAAMqJ,EAAyB,KAC7B,MAAMC,EAAeC,OAAOC,YAG5B,IAAIC,EAIFA,EAFEH,GAAgB,IAEC7C,KAAKrI,IAAI,IAAoB,GAAfkL,GACxBA,GAAgB,KAEN7C,KAAKrI,IAAI,IAAoB,GAAfkL,GACxBA,GAAgB,KAEN7C,KAAKrI,IAAI,IAAqB,IAAfkL,GAGf7C,KAAKrI,IAAI,KAAqB,GAAfkL,GAWpCjB,EAAiBoB,GACjBtB,EAAmBsB,IAGfC,EAAe,KACnB,GAAI5B,EAAa6B,QAAS,CACxB,MAAMC,EAAO9B,EAAa6B,QAAQE,wBAClC1B,EAAmB1B,KAAKrI,IAAIgK,EAAewB,EAAK7R,QAClD,GAII+R,EAAQC,WAAW,KACvBV,IACAK,KACC,KAGGM,EAAe,KACnBX,IACAK,KAKF,OAFAH,OAAOU,iBAAiB,SAAUD,GAE3B,KACLE,aAAaJ,GACbP,OAAOY,oBAAoB,SAAUH,KAEtC,CAAC5B,IAGF9E,MAAC,OAAInB,UAAW0F,EAAqB,2BAA6B,oBAEhExE,SAAAJ,OAAC,OACCmH,IAAKtC,EACL3F,UAAU,sBACV+E,MAAO,CACLnP,OAAQ,GAAGqQ,MACXiC,SAAU,OACVC,SAAU,YAEZC,SAAUtB,EAGV5F,SAAA,CAAAC,MAAC,OAAI4D,MAAO,CACVoD,SAAU,SACVE,IAAK,EACLC,OAAQ,GACRC,gBAAiB,QACjBC,aAAc,qBAEdtH,SAAAC,MAAC,SAAMnB,UAAW0F,EAAqB,kBAAkBT,QAAkB,wCACxE/D,SAAAsE,MAKLrE,MAAC,OAAI4D,MAAO,CAAEnP,OAAQ,GAAG0Q,MAAiB6B,SAAU,YAElDjH,SAAAC,MAAC,OACC4D,MAAO,CACL0D,UAAW,cA7IL,GA6ImBtC,OACzBgC,SAAU,WACVE,IAAK,EACLK,KAAM,EACNC,MAAO,GAGTzH,eAAC,SAAMlB,WAAc0F,EAAqB,kBAAkBT,QAAkB,yCAA5D,wBAChB/D,eAAC,SACEA,SAAAmF,EAAapP,IAAI,CAACI,EAAUuR,IAC3BzH,MAACsE,EAAA,CAECpO,WACAyK,QAASoD,EACTD,YACAE,cACAC,oBACAC,oBACAC,kBACAC,oBACAtF,oBATK5I,EAAS4H,aAkBJ,IAArBvI,EAAU2C,QACT8H,MAAC,OAAInB,UAAU,6BACbkB,WAAAC,IAAC,KAAEnB,UAAU,gBAAgBkB,SAAA,wBAQzC8D,GAAmBtB,YAAc,qBC7LjC,IAAImF,GAAY,eACXC,GAA0BC,IAA0BC,EAAmBH,GAAW,CACrFI,IAEEC,GAAiBD,IACjBE,GAAeC,IACjB,MAAMC,mBAAEA,KAAuBC,GAAqBF,EAC9CG,EAAcL,GAAeG,GACnC,OAAuBlI,MAAIqI,EAAsB,IAAKD,KAAgBD,EAAkBG,OAAO,KAEjGN,GAAYzF,YAAcmF,GAEDa,aACvB,CAACN,EAAOO,KACN,MAAMN,mBAAEA,KAAuBO,GAAiBR,EAC1CG,EAAcL,GAAeG,GACnC,OAAuBlI,MAAI0I,EAAyB,IAAKN,KAAgBK,EAAc3B,IAAK0B,MAG7EjG,YARA,qBASnB,IACIoG,GAAqBV,IACvB,MAAMC,mBAAEA,KAAuBU,GAAgBX,EACzCG,EAAcL,GAAeG,GACnC,OAAuBlI,MAAI6I,EAAwB,IAAKT,KAAgBQ,KAE1ED,GAAkBpG,YANA,oBAOlB,IACIuG,GAAqBP,aACvB,CAACN,EAAOO,KACN,MAAMN,mBAAEA,KAAuBa,GAAiBd,EAC1CG,EAAcL,GAAeG,GACnC,OAAuBlI,MAAIgJ,EAAyB,IAAKZ,KAAgBW,EAAcjC,IAAK0B,MAGhGM,GAAmBvG,YARA,qBASnB,IAAI0G,GAAe,sBACdC,GAA4BC,IAAgCxB,GAAyBsB,IACtFG,GAAYC,EAAgB,sBAC5BC,GAAqBf,aACvB,CAACN,EAAOO,KACN,MAAMN,mBAAEA,EAAAnI,SAAoBA,KAAawJ,GAAiBtB,EACpDG,EAAcL,GAAeG,GAC7BsB,EAAaC,SAAa,MAC1BC,EAAeC,EAAgBnB,EAAcgB,GAC7CI,EAAYH,SAAa,MAC/B,OAAuBzJ,MACrB6J,EACA,CACEC,YAAab,GACbc,UAAWC,GACXC,SAAU,eACVlK,WAA0BC,IAAIkJ,GAA4B,CAAEgB,MAAOhC,EAAoB0B,YAAW7J,SAA0BJ,OAC1HwK,EACA,CACErT,KAAM,iBACHsR,KACAmB,EACHzC,IAAK4C,EACLU,gBAAiBC,EAAqBd,EAAaa,gBAAkBE,IACnEA,EAAMC,iBACNX,EAAUvD,SAASmE,MAAM,CAAEC,eAAe,MAE5CC,qBAAuBJ,GAAUA,EAAMC,iBACvC9J,kBAAoB6J,GAAUA,EAAMC,iBACpCxK,SAAU,CACQC,MAAIoJ,GAAW,CAAErJ,aACjBC,MAAI2K,GAAoB,CAAEnB,wBAQxDF,GAAmB/G,YAAc0G,GACjC,IAAIe,GAAa,mBACbY,GAAmBrC,aACrB,CAACN,EAAOO,KACN,MAAMN,mBAAEA,KAAuB2C,GAAe5C,EACxCG,EAAcL,GAAeG,GACnC,OAAuBlI,MAAI8K,EAAuB,IAAK1C,KAAgByC,EAAY/D,IAAK0B,MAG5FoC,GAAiBrI,YAAcyH,GAC/B,IAAIe,GAAmB,yBACnBC,GAAyBzC,aAAiB,CAACN,EAAOO,KACpD,MAAMN,mBAAEA,KAAuB+C,GAAqBhD,EAC9CG,EAAcL,GAAeG,GACnC,OAAuBlI,MAAIkL,EAA6B,IAAK9C,KAAgB6C,EAAkBnE,IAAK0B,MAEtGwC,GAAuBzI,YAAcwI,GACrC,IACII,GAAoB5C,aACtB,CAACN,EAAOO,KACN,MAAMN,mBAAEA,KAAuBkD,GAAgBnD,EACzCG,EAAcL,GAAeG,GACnC,OAAuBlI,MAAIqL,EAAuB,IAAKjD,KAAgBgD,EAAatE,IAAK0B,MAG7F2C,GAAkB5I,YARA,oBASlB,IAAI+I,GAAc,oBACdC,GAAoBhD,aACtB,CAACN,EAAOO,KACN,MAAMN,mBAAEA,KAAuBsD,GAAgBvD,GACzC2B,UAAEA,GAAcT,GAA6BmC,GAAapD,GAC1DE,EAAcL,GAAeG,GAC7BpB,EAAM6C,EAAgBnB,EAAcoB,GAC1C,OAAuB5J,MAAIqL,EAAuB,IAAKjD,KAAgBoD,EAAa1E,UAGxFyE,GAAkBhJ,YAAc+I,GAChC,IAAIX,GAAqB,EAAGnB,iBAC1B,MAAMiC,EAAU,KAAKxC,iIAEcA,uBAAiC8B,sQAEsF9B,kRAS1J,OANAyC,YAAgB,KACSC,SAASC,eAC9BpC,EAAWnD,SAASwF,aAAa,sBAGlC,CAACJ,EAASjC,IACN,MAKLsC,GAAWhD,GACXiD,GAAWzC,GACX0C,GAASb,GACTc,GAASV,GACTW,GAAStB,GACTuB,GAAenB,GC7InB,MAAMhD,GDqIMA,GCjINW,GDmIQA,GCjIRG,GAAqBP,aAGzB,EAAG1J,eAAcoJ,GAASnB,IAC1B9G,MAACoM,GAAA,CACCvN,UAAWwN,EACT,kDACA,+DACA,6DACAxN,MAEEoJ,EACJnB,SAGJgC,GAAmBvG,YAAc6J,GAA6B7J,YAE9D,MAAM+G,GAAqBf,aAGzB,EAAG1J,eAAcoJ,GAASnB,IAC1BnH,OAACgJ,GAAA,CACC5I,SAAA,CAAAC,MAAC8I,GAAA,IACD9I,MAACsM,GAAA,CACCxF,MACAjI,UAAWwN,EACT,kCACA,wDACA,6CACA,wCACA,eACA,+DACA,6DACA,+DACA,uFACA,qFACAxN,MAEEoJ,QAIVqB,GAAmB/G,YAAc+J,GAA6B/J,YAE9D,MAAMgK,GAAoB,EACxB1N,eACGoJ,KAEHjI,MAAC,OACCnB,UAAWwN,EACT,oCACAxN,MAEEoJ,IAGRsE,GAAkBhK,YAAc,oBAEhC,MAAMiK,GAAoB,EACxB3N,eACGoJ,KAEHjI,MAAC,OACCnB,UAAWwN,EACT,yDACAxN,MAEEoJ,IAGRuE,GAAkBjK,YAAc,oBAEhC,MAAMqI,GAAmBrC,aAGvB,EAAG1J,eAAcoJ,GAASnB,IAC1B9G,MAACyM,GAAA,CACC3F,MACAjI,UAAWwN,EAAG,qDAAsDxN,MAChEoJ,KAGR2C,GAAiBrI,YAAckK,GAA2BlK,YAE1D,MAAMyI,GAAyBzC,aAG7B,EAAG1J,eAAcoJ,GAASnB,IAC1B9G,MAAC0M,GAAA,CACC5F,MACAjI,UAAWwN,EAAG,wBAAyBxN,MACnCoJ,KAGR+C,GAAuBzI,YACrBmK,GAAiCnK,YAEnC,MAAM4I,GAAoB5C,aAGxB,EAAG1J,eAAcoJ,GAASnB,IAC1B9G,MAAC2M,GAAA,CACC7F,MACAjI,UAAWwN,EAAGO,IAAkB/N,MAC5BoJ,KAGRkD,GAAkB5I,YAAcoK,GAA4BpK,YAE5D,MAAMgJ,GAAoBhD,aAGxB,EAAG1J,eAAcoJ,GAASnB,IAC1B9G,MAAC6M,GAAA,CACC/F,MACAjI,UAAWwN,EACTO,EAAe,CAAExM,QAAS,YAC1B,eACAvB,MAEEoJ,KAGRsD,GAAkBhJ,YAAcsK,GAA4BtK,YCnG5D,MAAMC,GAAc7D,OAAK,EAAGzI,eAC1B,MAAMuM,EAASvM,EAASqB,YACpB,YACoC,aAAnCrB,EAASC,uBAA0E,aAAlCD,EAASE,qBAC3D,aACoC,aAAnCF,EAASC,uBAA0E,aAAlCD,EAASE,qBAC3D,WACA,WASEsM,KAAEA,EAAA7D,UAAMA,GAPC,CACb8D,UAAW,CAAED,KAAM,OAAQ7D,UAAW,iBACtC+D,WAAY,CAAEF,KAAM,OAAQ7D,UAAW,iBACvCgE,SAAU,CAAEH,KAAM,KAAM7D,UAAW,gBACnC5G,QAAS,CAAEyK,KAAM,OAAQ7D,UAAW,kBAGH4D,GACnC,aAAQ,QAAK5D,UAAW,eAAeA,IAAckB,SAAA2C,MAGvDF,GAAYD,YAAc,cAG1B,MAAMuK,GAAqBnJ,GACpBA,EACD,CAAC,MAAO,IAAK,KAAKtN,SAASsN,GAAkB,IAC7C,CAAC,MAAO,IAAK,MAAMtN,SAASsN,GAAkB,IAC9C,CAAC,MAAO,KAAKtN,SAASsN,GAAkB,IACxC,CAAC,MAAO,IAAK,KAAKtN,SAASsN,IAC3B,CAAC,MAAO,KAAM,KAAKtN,SAASsN,GADiB,IAE1CA,EANe,IAYlBoJ,GAEY,6CAFZA,GAKiB,0EALjBA,GAOa,6CAPbA,GAQW,iCARXA,GASS,kDATTA,GAUQ,6CAVRA,GAWS,iCAXTA,GAYiB,iCAZjBA,GAawB,iCAbxBA,GAcM,mCAdNA,GAeW,mCAfXA,GAgBM,6CAhBNA,GAkBO,8CAlBPA,GAmBI,8CAnBJA,GAsBI,wCAtBJA,GAyBW,mCAzBXA,GA0Bc,mCA1BdA,GA2BS,mCA3BTA,GA4Ba,6CA5BbA,GA6BI,+CA7BJA,GA8BK,+CA9BLA,GAgCE,iCAhCFA,GAiCC,6CAKDC,GAAsBrO,OAAK,EAAGzI,eAClC,MAAM8B,aAAEA,GAAiB+D,KAGnBkR,EAAiBjV,GAAckV,KAAKC,GAAKA,EAAErP,KAAO5H,EAAS4H,KAAO5H,EAElEkX,EAA0D,aAAzCH,EAAe9W,sBAChCkX,EAA0D,aAAzCJ,EAAe9W,sBAChCkB,EAAwD,aAAxC4V,EAAe7W,qBAC/BkX,EAAwD,aAAxCL,EAAe7W,qBAGrC,OAAIiX,GAAkBC,IAGlB3N,KAAC,OAAId,UAAU,qCACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,4BACbkB,eAAC,OAAIlB,UAAU,8DAEhB,QAAKA,UAAU,oCAAoCkB,SAAA,UAOtDqN,GAAkB/V,IAGlBsI,KAAC,OAAId,UAAU,qCACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,4BACbkB,eAAC,OAAIlB,UAAU,kDAEhB,QAAKA,UAAU,sCAAsCkB,SAAA,aAOxDqN,GAAmB/V,GAAkBiW,IAkBvC3N,KAAC,OAAId,UAAU,qCACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,0BACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,2CACfmB,IAAC,OAAInB,UAAU,4BACfmB,IAAC,OAAInB,UAAU,kDAEhB,QAAKA,UAAU,qCAAqCkB,SAAA,cArBrDJ,KAAC,OAAId,UAAU,qCACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,0BACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,4CACfmB,IAAC,OAAInB,UAAU,4BACfmB,IAAC,OAAInB,UAAU,kDAEhB,QAAKA,UAAU,uCAAuCkB,SAAA,eAsB/DiN,GAAoBzK,YAAc,sBAIlC,MAAMgL,GAAqB5O,OAAK,EAAGzI,WAAU4N,gBAC3C,MAAM9L,aAAEA,GAAiB+D,KAGnBkR,EAAiBjV,GAAckV,KAAKC,GAAKA,EAAErP,KAAO5H,EAAS4H,KAAO5H,EAGxE,GAAkB,SAAd4N,EAAsB,CAIxB,GAH6D,QAApCmJ,EAAe3W,kBAA8B2W,EAAe3W,kBAAkBD,SAAS,OAI9G,SACE2J,IAAC,OAAInB,UAAU,mCACbkB,eAAC,QAAKlB,UAAU,2BAA2BkB,SAAA,OAInD,CAGA,GAAIkN,EAAehW,qBAEjB,SACE0I,KAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,qCACbkB,SAAAC,MAAC,OACCnB,UAAU,mCACV+E,MAAO,CAAEpP,MAAO,kBAGnB,QAAKqK,UAAU,2BAA2BkB,SAAA,YAMjD,IAAKkN,EAAejU,wBAA2E,IAAjDiU,EAAejU,uBAAuBd,OAElF,SACEyH,KAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,qCACbkB,SAAAC,MAAC,OACCnB,UAAU,iCACV+E,MAAO,CAAEpP,MAAO,gBAGnB,QAAKqK,UAAU,2BAA2BkB,SAAA,UAMjD,MAAMtC,EAAQwP,EAAejU,uBAAuBd,OAC9CyK,EAAYsK,EAAejU,uBAAuB/C,OAAQgD,IAChC,IAA9BA,EAAKhC,sBACLiB,OACI+K,EAAaxF,EAAQ,EAAI0F,KAAKC,MAAOT,EAAYlF,EAAS,KAAO,EAGvE,SACEkC,KAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,qCACbkB,SAAAC,MAAC,OACCnB,UAAW,uBACM,MAAfoE,EAAqB,gBACrBA,EAAa,EAAI,gBAAkB,eAErCW,MAAO,CAAEpP,MAAO,GAAGyO,YAGvBtD,KAAC,QAAKd,UAAU,2BAA4BkB,SAAA,CAAAkD,EAAW,YAK7DsK,GAAmBhL,YAAc,qBAIjC,MAAMiL,GAAqB7O,OAAK,EAAGzI,eACjC,MAAM8B,aAAEA,GAAiB+D,KAGnBkR,EAAiBjV,GAAckV,KAAKC,GAAKA,EAAErP,KAAO5H,EAAS4H,KAAO5H,EAGxE,IAAK+W,EAAejU,wBAA2E,IAAjDiU,EAAejU,uBAAuBd,OAClF,SACEyH,KAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,qCACbkB,SAAAC,MAAC,OACCnB,UAAU,iCACV+E,MAAO,CAAEpP,MAAO,gBAGnB,QAAKqK,UAAU,2BAA2BkB,SAAA,UAMjD,MAAMtC,EAAQwP,EAAejU,uBAAuBd,OAC9C8K,EAAWiK,EAAejU,uBAAuB/C,OAAQgD,IACxC,IAArBA,EAAK1B,aACLW,OACI+K,EAAaxF,EAAQ,EAAI0F,KAAKC,MAAOJ,EAAWvF,EAAS,KAAO,EAEtE,SACEkC,KAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,qCACbkB,SAAAC,MAAC,OACCnB,UAAW,uBACM,MAAfoE,EAAqB,cACrBA,EAAa,EAAI,cAAgB,eAEnCW,MAAO,CAAEpP,MAAO,GAAGyO,YAGvBtD,KAAC,QAAKd,UAAU,2BAA4BkB,SAAA,CAAAkD,EAAW,YAK7DuK,GAAmBjL,YAAc,qBAIjC,MAAMkL,GAAuB9O,OAAK,EAAGzI,eACnC,MAAM8B,aAAEA,GAAiB+D,KAGnB2R,EAAkBnQ,UAAQ,KAC9B,IAAKvF,EAAc,OAAO9B,EAE1B,OADuB8B,EAAakV,QAAUC,EAAErP,KAAO5H,EAAS4H,KACvC5H,GACxB,CAAC8B,EAAc9B,EAAS4H,GAAI5H,IAGzByX,EAAoBpQ,UAAQ,KAChC,MAAMqQ,EAAQF,EAAgB1U,wBAA0B0U,EAAgBE,OAAS,GACjF,GAAqB,IAAjBA,EAAM1V,OACR,MAAO,CAAEyK,UAAW,EAAGlF,MAAO,EAAGwF,WAAY,GAG/C,MAAMxF,EAAQmQ,EAAM1V,OACdyK,EAAYiL,EAAM3X,OAAQgD,IAA6C,IAA/BA,EAAKtB,uBAAgCO,OAGnF,MAAO,CAAEyK,YAAWlF,QAAOwF,WAFRxF,EAAQ,EAAI0F,KAAKC,MAAOT,EAAYlF,EAAS,KAAO,IAGtE,CAACiQ,IAEJ,SACE/N,KAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,qCACbkB,SAAAC,MAAC,OACCnB,UAAW,uBACwB,MAAjC8O,EAAkB1K,WAAqB,eACvC0K,EAAkB1K,WAAa,EAAI,eAAiB,eAEtDW,MAAO,CAAEpP,MAAO,GAAGmZ,EAAkB1K,qBAGzCtD,KAAC,QAAKd,UAAU,2BACbkB,SAAA,CAAA4N,EAAkB1K,WAAW,YAMtCwK,GAAqBlL,YAAc,uBAKT5D,OAAK,EAAGkP,UACL,QAATA,GAAkBA,GAAMxX,SAAS,aAI9C,QAAKwI,UAAU,oCAAoCkB,SAAA,cAOrD,QAAKlB,UAAU,qCAAqCkB,SAAA,QAMvCwC,YAAc,oBAGhC,MAAMuL,GAAWnP,OAAK,EAAGzI,WAAUyK,UAASmD,YAAWE,cAAaC,oBAAmBC,oBAAmBC,kBAAiBrF,mBAAkBsF,wBAW3I,MAAMd,EAAuC,QAA3BpN,EAASiB,eAA2BjB,EAASiB,eAAed,SAAS,OAGjFuI,EAAasC,IAEZpC,IACiC,IAA/BA,EAAiBoC,GAG1B,OACEvB,OAAC,MACCd,UAAW,gEAA+DyE,EAAY,6BAA+B,IACrH3C,QAAS,IAAMA,EAAQzK,GAGrB6J,SAAA,EAAc,YAAd+D,GAAyC,aAAdA,MAC3B9D,IAAC,MAAGnB,UAAW,iCAAiCkO,KAC9ChN,SAAAC,MAACgN,GAAA,CAAoB9W,eAIV,YAAd4N,GAA2BlF,EAAU,qBACpCoB,MAAC,MAAGnB,UAAW,eAAekO,KAC5BhN,SAAAC,MAACwN,GAAA,CAAmBtX,eAIT,SAAd4N,GAAwBlF,EAAU,uBACjCoB,MAAC,MAAGnB,UAAW,eAAekO,KAC5BhN,SAAAC,MAACyN,GAAA,CAAqBvX,eAIzB0I,EAAU,4BACToB,IAAC,MAAGnB,UAAW,4CAA4CkO,KAC3DhN,SAAAJ,OAAC,OAAId,UAAU,0BAEZkB,SAAA,CAAAoE,GACCnE,MAAC,OACC+N,IAAI,mBACJC,IAAI,UACJxZ,MAAM,KACNC,OAAO,KACPoK,UAAW,iFACP3I,EAAS+X,eAAiB,yBAA2B,uBACzB,QAA3B/X,EAASiB,eAA2BjB,EAASiB,eAAed,SAAS,QAClC,aAAnCH,EAASC,uBAA0E,aAAlCD,EAASE,qBACxDF,EAAS+X,eAAiB,iBAAmB,iCAC9C,4CACNtN,QAASuN,MAAOtI,KACiB,QAA3B1P,EAASiB,eAA2BjB,EAASiB,eAAed,SAAS,QACjC,aAAnCH,EAASC,uBAA0E,aAAlCD,EAASE,wBAC7DwP,EAAEuI,wBACIhK,EAAgBjO,KAG1B0N,MAAO,CACLwK,cAA2C,QAA3BlY,EAASiB,eAA2BjB,EAASiB,eAAed,SAAS,QAC/C,aAAnCH,EAASC,uBAA0E,aAAlCD,EAASE,qBACzD,OAAS,QAEfoI,MAAOtI,EAAS+X,eAAiB,UAAY,uBAGhD,QAAKpP,UAAU,iBAAiBL,MAAOtI,EAASO,uBAAyB,GACvEsJ,SAAA,CAAA7J,EAASO,uBAAyB,IAClCP,EAAS8C,wBAA0B9C,EAAS8C,uBAAuBd,OAAS,GAC3EyH,OAAC,QAAKd,UAAU,uBAAuBkB,SAAA,KAAE7J,EAAS8C,uBAAuBd,OAAO,eAOvF0G,EAAU,2BACR,MAAGC,UAAW,4CAA4CkO,KACzDhN,eAAC,QAAKlB,UAAW,gBACe,SAA9B3I,EAASI,kBAA6D,UAA9BJ,EAASI,iBAA+B,yBAClD,OAA9BJ,EAASI,iBAA4B,2BACP,SAA9BJ,EAASI,kBAA6D,UAA9BJ,EAASI,kBACjDJ,EAASI,iBADuE,2BAI9EyJ,SAEkC,OAA9B7J,EAASI,iBAAkC,OACb,UAA9BJ,EAASI,iBAAqC,OAChB,UAA9BJ,EAASI,iBAAqC,OAC3CJ,EAASI,kBAAoB,QAM3CsI,EAAU,mBACToB,MAAC,MAAGnB,UAAW,4CAA4CkO,KACzDhN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAASQ,gBAAkB,GAChEqJ,SAAA7J,EAASQ,gBAAkB,QAKjCkI,EAAU,iBACToB,MAAC,MAAGnB,UAAW,uCAAuCkO,KACnDhN,SAAAwD,EAAgBrN,EAASkF,gBAIf,SAAd0I,GAAwBlF,EAAU,eACjCoB,MAAC,MAAGnB,UAAW,wFAAwFkO,KACrGhN,SAAAC,MAAC,QAAKnB,UAAY3I,EAAiB0B,eAAiB,qBAAuB,oBACvEmI,SAAA7J,EAAiB0B,eAAiB,KAAO,SAKhDgH,EAAU,gBACToB,MAAC,MACCnB,UAAW,+BAA6C,SAAdiF,EAAuBiJ,GAAmC,0BACpGnJ,MAAqB,SAAdE,OAAuB,EAAY,CACxCtP,MAAO,GAAG4P,GAAqB,OAC/BiK,SAAU,GAAGjK,GAAqB,OAClCkK,SAAU,GAAGlK,GAAqB,QAGpCrE,SAAAC,MAAC,QAAKnB,UAAU,iBAAiBL,MAAOtI,EAAS4C,aAAe,GAC7DiH,SAAA7J,EAAS4C,aAAe,QAK9B8F,EAAU,iBACToB,MAAC,MAAGnB,UAAW,4CAA4CkO,KACzDhN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAAS6C,cAAgB,GAC9DgH,SAAA7J,EAAS6C,cAAgB,QAK/B6F,EAAU,gCACR,MAAGC,UAAW,4CAA4CkO,MACzD7W,EAASqY,8BAAgC,gBAAkB,KAE1DxO,SAAAwD,EAAgBrN,EAASuL,0BAId,YAAdqC,GAAyC,SAAdA,IAAyBlF,EAAU,gCAC7D,MAAGC,UAAW,4CAA4CkO,KACxDhN,SAAAwD,EAAgBrN,EAASqY,iCAI7B3P,EAAU,cACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,SAAAC,MAAC,QAAKnB,UAAU,iBAAiBL,MAAOtI,EAAS8C,yBAAyB,IAAIE,WAAa,GACxF6G,SAAA7J,EAAS8C,yBAAyB,IAAIE,WAAa,QAKzD0F,EAAU,kBACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,SAAAC,MAAC,QAAKnB,UAAU,iBAAiBL,MAAOtI,EAAS8C,yBAAyB,IAAIM,eAAiB,GAC5FyG,SAAA7J,EAAS8C,yBAAyB,IAAIM,eAAiB,QAK7DsF,EAAU,aACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACrChN,SAAc,YAAd+D,GAAyC,SAAdA,QAEzB,MAAMnC,EAAWzL,EAAS8C,yBAAyB,IAAI2I,UAAY,EAC7D6M,EAAmBtY,EAAS8C,yBAAyB,IAAIyV,mBAAqB,EAE9EC,EAAcF,EAAmB,EAEvC,OAHmB7M,GAAY,KAAO6M,GAAoB,MAKtD7O,KAAC,OAAId,UAAU,2CACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAW6P,EAAc,gBAAkB,GAAK3O,SAAA4B,WACpD,OAAI9C,UAAW6P,EAAc,GAAK,gBAAiB3O,SAAA,KAAEyO,eAKvD,QACCzO,SAAA,CAAAC,MAAC,QAAKnB,UAAW6P,EAAc,gBAAkB,GAAK3O,SAAA4B,WACrD,QAAK9C,UAAW6P,EAAc,GAAK,gBAAiB3O,SAAA,KAAEyO,OAI/D,KAEAtY,EAAS8C,yBAAyB,IAAI2I,UAAY,IAKvD/C,EAAU,qBACR,MAAGC,UAAW,4CAA4CkO,KACxDhN,SAAA7J,EAAS8C,yBAAyB,IAAI2V,iBAAmB,GAAGzY,EAAS8C,uBAAuB,GAAG2V,iBAAiBjL,oBAAoBoJ,GAAkB5W,EAAS8C,uBAAuB,IAAI4V,qBAAuB,SAAW,KAAK9B,GAAkB5W,EAAS8C,yBAAyB,IAAI4V,qBAAuB,WAIpThQ,EAAU,WACToB,MAAC,MAAGnB,UAAW,6CAA6CkO,KACzDhN,SAAA7J,EAAS8C,yBAAyB,IAAIwK,aAAe,GAAGtN,EAAS8C,uBAAuB,GAAGwK,aAAaE,oBAAoBoJ,GAAkB5W,EAAS8C,uBAAuB,IAAI6V,iBAAmB,SAAW3Y,EAASuN,aAAe,GAAGvN,EAASuN,aAAaC,oBAAoBoJ,GAAkB5W,EAASyN,UAAY,SAAW,KAAKmJ,GAAkB5W,EAASyN,UAAY,YAKxW,YAAdG,GAAyC,aAAdA,WAC3B7C,WAAA,CACGlB,SAAA,CAAAnB,EAAU,WACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,SAAAC,MAAC,QAAKnB,UAAU,iBAAiBL,MAAOtI,EAAS8C,yBAAyB,IAAI8I,QAAU,GACrF/B,SAAA7J,EAAS8C,yBAAyB,IAAI8I,QAAU,QAIxC,aAAdgC,GAA4BlF,EAAU,eACpC,MAAGC,UAAW,0BAA0BkO,KACtChN,SAAA7J,EAAS8C,yBAAyB,IAAI+I,KACrC/B,MAAC,KACC8O,KAAM5Y,EAAS8C,yBAAyB,IAAI+I,KAC5CgN,OAAO,SACPC,IAAI,sBACJnQ,UAAU,6DACVL,MAAOtI,EAAS8C,yBAAyB,IAAI+I,KAC9ChC,SAAA,UAIDC,MAAC,QAAKnB,UAAU,gBAAgBkB,iBAIrCnB,EAAU,mBACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAAS8L,gBAAkB,GAChEjC,SAAA7J,EAAS8L,gBAAkB,QAIjCpD,EAAU,iBACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAAS+L,cAAgB,GAC9DlC,SAAA7J,EAAS+L,cAAgB,QAI/BrD,EAAU,uBACToB,MAAC,MAAGnB,UAAW,4CAA4CkO,KACzDhN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAASgM,oBAAsB,GACpEnC,SAAA7J,EAASgM,oBAAsB,WAQ3B,YAAd4B,GACCnE,OAAAsB,WAAA,CACGlB,SAAA,CAAAnB,EAAU,WACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,SAAAC,MAAC,QAAKnB,UAAU,iBAAiBL,MAAOtI,EAAS8C,yBAAyB,IAAI8I,QAAU,GACrF/B,SAAA7J,EAAS8C,yBAAyB,IAAI8I,QAAU,QAItDlD,EAAU,mBACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAAS8L,gBAAkB,GAChEjC,SAAA7J,EAAS8L,gBAAkB,QAIjCpD,EAAU,iBACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAAS+L,cAAgB,GAC9DlC,SAAA7J,EAAS+L,cAAgB,QAI/BrD,EAAU,uBACToB,MAAC,MAAGnB,UAAW,4CAA4CkO,KACzDhN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAASgM,oBAAsB,GACpEnC,SAAA7J,EAASgM,oBAAsB,YAO1B,SAAd4B,IAAyBA,MACzBnE,KAAAsB,WAAA,CAEGlB,SAAA,CAAAnB,EAAU,WACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,SAAAC,MAAC,QAAKnB,UAAU,iBAAiBL,MAAOtI,EAAS8C,yBAAyB,IAAI8I,QAAU,GACrF/B,SAAA7J,EAAS8C,yBAAyB,IAAI8I,QAAU,QAKtDlD,EAAU,WACToB,IAAC,MAAGnB,UAAW,0BAA0BkO,KACtChN,SAAA7J,EAAS8C,yBAAyB,IAAI+I,KACrC/B,MAAC,KACC8O,KAAM5Y,EAAS8C,yBAAyB,IAAI+I,KAC5CgN,OAAO,SACPC,IAAI,sBACJnQ,UAAU,6DACVL,MAAOtI,EAAS8C,yBAAyB,IAAI+I,KAC9ChC,SAAA,UAIDC,MAAC,QAAKnB,UAAU,gBAAgBkB,iBAKrCnB,EAAU,mBACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAAS8L,gBAAkB,GAChEjC,SAAA7J,EAAS8L,gBAAkB,QAKjCpD,EAAU,iBACToB,MAAC,MAAGnB,UAAW,0BAA0BkO,KACvChN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAAS+L,cAAgB,GAC9DlC,SAAA7J,EAAS+L,cAAgB,QAK/BrD,EAAU,uBACToB,MAAC,MAAGnB,UAAW,4CAA4CkO,KACzDhN,eAAC,QAAKlB,UAAU,iBAAiBL,MAAOtI,EAASgM,oBAAsB,GACpEnC,SAAA7J,EAASgM,oBAAsB,QAKrCtD,EAAU,sBAAsC,aAAdkF,SAChC,MAAGjF,UAAW,eAAekO,KAC5BhN,SAAAC,MAACuN,GAAA,CAAmBrX,WAAoB4N,gBAI3ClF,EAAU,2BACR,MAAGC,UAAW,eAAekO,MAA+C,SAAdjJ,EAAuB,kBAAoB,KACxG/D,SAAAC,MAACwN,GAAA,CAAmBtX,uBAUlC4X,GAASvL,YAAc,WAGvB,MAAM0M,GAAoB,EACxB1Z,YACAuO,YAAY,OACZoL,mBAAmB,GACnBC,YACAC,qBACAnL,oBACAC,oBACApF,uBAGApC,YAAU,KACRnG,EAAO8Y,KAAK,2CAA4C,CAAEvQ,sBACzD,CAACA,IACJ,MAAOwQ,EAAoBC,GAAyBlT,WAAwB,OACrEmT,EAAaC,GAAkBpT,YAAS,IACxCqT,EAAmBC,GAAwBtT,YAAS,IACpDuT,EAAkBC,GAAuBxT,WAA0B,MAEpEyT,EAAWC,IAGX/L,EAAckL,IAClBA,EAAiB7Y,SAAS,eAC1B6Y,EAAiB7Y,SAAS,cAKZ6Y,EAAiB7Y,SAAS,mBAC1B6Y,EAAiB7Y,SAAS,cAC1B6Y,EAAiB7Y,SAAS,OAK1C,MAAM+N,EAAoB7G,UAAQ,KAChC,IAAKhI,GAAkC,IAArBA,EAAU2C,OAAc,OAAO,GAGhB3C,EAAU2C,OAE3C,IAAI8X,EAAY,EAGhB,MAAMC,EAAa9M,KAAKrI,IAAIvF,EAAU2C,OAAQ,KACrB3C,EAAUmF,MAAM,EAAGuV,GAE3BC,QAAQha,IACvB,MAEMia,GAFaja,EAAS4C,aAAe,IAET9C,MAAM,IAAImI,OAAO,CAACC,EAAKgS,IAChDhS,GAAO,QAAQiS,KAAKD,GAAQ,IAAM,GACxC,GACHJ,EAAY7M,KAAKpI,IAAIiV,EAAW7M,KAAKmC,KAAK6K,MAY5C,OARwBhN,KAAKpI,IAAI,GAAIoI,KAAKrI,IAAI,IAAiB,EAAZkV,EAAgB,MASlE,CAACza,EAAWuO,IAETwM,EAAiBjT,cAAanH,IAClCqZ,EAAsBrZ,EAAS4H,IAC/B2R,GAAe,IACd,IAEGc,EAAmBlT,cAAY,KACnCoS,GAAe,GACfF,EAAsB,OACrB,IAGGiB,EAAsBnT,cAAY6Q,MAAOhY,IAC7C,IAEE,MAAQua,KAAMC,EAAiBlU,MAAOmU,SAAuBb,EAC1Dc,KAAK,qBACLC,OAAO,KACPC,GAAG,wBAAyB5a,EAASO,uBACrCsa,SAEH,GAAIJ,IAAiBD,EAEnB,YADAM,EAAMxU,MAAM,8BAKd,MAAQiU,KAAMQ,EAAYzU,MAAO0U,SAAqBpB,EACnDc,KAAK,0BACLC,OAAO,KACPC,GAAG,wBAAyB5a,EAASO,uBACrC0a,MAAM,eAET,GAAID,IAAeD,GAAoC,IAAtBA,EAAW/Y,OAE1C,YADA8Y,EAAMxU,MAAM,iCAKd,MAAM4U,EAAa,CACjBtY,YAAa5C,EAAS4C,YACtBuY,aAAc,GACdC,WAAY,GACZC,oBAAqB,GACrBC,wBAAyB,IAG3B,IACE,MAAMC,EAAWf,EAAgBgB,WAAaxb,EAASwb,UACjDC,EAAYjB,EAAgBkB,YAAc1b,EAAS0b,WAGzD,GAAIH,EAAU,CACZ,MAAQhB,KAAMoB,SAAqB/B,EAChCc,KAAK,WACLC,OAAO,qDACPC,GAAG,KAAMW,GACTV,SAECc,IACFT,EAAWC,aAAeQ,EAAWR,cAAgB,GACrDD,EAAWE,WAAaO,EAAWP,YAAc,GACjDF,EAAWI,wBAA0BK,EAAWL,yBAA2B,GAE/E,CAGA,GAAIG,EAAW,CACb,MAAQlB,KAAMqB,SAAsBhC,EACjCc,KAAK,mBACLC,OAAO,8CACPC,GAAG,KAAMa,GACTZ,SACCe,IACFV,EAAWG,oBAAsBO,EAAY/Y,cAAgB,GAEjE,CACF,OAASyD,GAET,CAEA,MAAMuV,EAA+B,CACnCtb,sBAAuBia,EAAgBja,uBAAyB,GAChE2E,aAAcsV,EAAgBtV,aAC9BqG,sBAAuBiP,EAAgBjP,sBACvC/K,eAAgBga,EAAgBha,eAChCoC,YAAasY,EAAWtY,aAAe,GACvCyY,oBAAqBH,EAAWG,oBAChCF,aAAcD,EAAWC,aACzBC,WAAYF,EAAWE,WACvBtP,eAAgB0O,EAAgB1O,eAChCE,mBAAoBwO,EAAgBxO,mBACpCD,aAAcyO,EAAgBzO,aAC9BuP,wBAAyBJ,EAAWI,wBACpC5D,MAAOqD,EAAWnb,IAAKmD,IAAA,CACrB+Y,YAAa/Y,EAAK+Y,YAClB9Y,UAAWD,EAAKC,UAChBI,cAAeL,EAAKK,cACpBqI,SAAU1I,EAAK0I,SACfgN,iBAAkB1V,EAAK0V,iBACvBnL,aAAcvK,EAAKuK,aACnB1B,OAAQ7I,EAAK6I,OACb6B,SAAU+M,EAAgB/M,UAAY,UAKpCsO,QAAaC,EAA6BH,GAG1CI,EAAmB,OAAOJ,EAAUjZ,eAAeiZ,EAAUtb,6BAG7D2b,EAAMnM,OAAOoM,IAAIC,gBAAgBL,GACjCzW,EAAImQ,SAAS4G,cAAc,KACjC/W,EAAEsT,KAAOsD,EACT5W,EAAEgX,SAAWL,EACbxG,SAAS8G,KAAKC,YAAYlX,GAC1BA,EAAEmX,QACFhH,SAAS8G,KAAKG,YAAYpX,GAC1ByK,OAAOoM,IAAIQ,gBAAgBT,GAE3BpB,EAAM8B,QAAQ,qBAGd,IAKE,GAJsB5D,GACpBA,EAAiB7Y,SAAS,cAGT,CACjB,MAAQmG,MAAOuW,SAA0BjD,EACtCc,KAAK,qBACLoC,OAAO,CAAE/E,gBAAgB,IACzB6C,GAAG,wBAAyB5a,EAASO,uBAEnCsc,GAEH5D,KAEJ,CACF,OAAS8D,GAET,CACF,OAASzW,GACPwU,EAAMxU,MAAM,mBACd,GACC,CAACsT,IAEEoD,EAAsB7V,cAAY6Q,UACtC,GAAK0B,EAAL,CAGA,IAEE,MAAMuD,EAAc,2CAGpB,IAAKA,IAFmB,oNAEgBA,EAAY9c,SAAS,eAG3D,OAFAE,EAAO6c,KAAK,oDACZpC,EAAMxU,MAAM,qBAKd,MAAQiU,MAAM4C,KAAEA,GAAQ7W,MAAO8W,SAAoBxD,EAASyD,KAAKC,UAGjE,GAAIF,IAAcD,EAEhB,YADArC,EAAMxU,MAAM,eAKd,MAAQiU,KAAMgD,EAAUjX,MAAOkX,SAAmB5D,EAC/Cc,KAAK,aACLC,OAAO,8BACPC,GAAG,QAASuC,EAAKM,OACjB5C,SAGH,GAAI2C,IAAaD,EAEf,YADAzC,EAAMxU,MAAM,uBAKd,IAAIoX,EAAkB,GACtB,GAAIH,EAAS5d,cACX,GAAIF,MAAMC,QAAQ6d,EAAS5d,eACzB+d,EAAQH,EAAS5d,cAAcC,IAAKf,GAAW0E,OAAO1E,GAAGgB,YACpD,CAEL6d,EADmBna,OAAOga,EAAS5d,eAChBG,MAAM,KAAKF,IAAKf,GAAcA,EAAEgB,QAAQE,OAAQlB,GAAcA,EAAEmD,OAAS,EAC9F,CAGF,MAAM2b,EAAUD,EAAMvd,SAAS,mBACfud,EAAMvd,SAAS,cACfud,EAAMvd,SAAS,OAEzByd,EAAuD,aAA1ClE,EAAiBxZ,qBAC9BoB,EAAcoY,EAAiBlZ,iBAAmB+c,EAAS9c,KAIjE,KAHsBmd,EAAaD,EAAWA,GAAWrc,GAKvD,YADAwZ,EAAMxU,MAAM,gBAMd,MAAQiU,KAAMsD,EAAcvX,MAAO0U,SAAqBpB,EACrDc,KAAK,0BACLoD,SACAlD,GAAG,sBAAuBlB,EAAiB9R,IAC3C+S,SAEH,GAAIK,EAOF,MANA3a,EAAOiG,MAAM,iBAAkB0U,EAAY,CACzC+C,KAAM/C,EAAW+C,KACjBC,QAAShD,EAAWgD,QACpBC,QAASjD,EAAWiD,QACpBC,KAAMlD,EAAWkD,OAEblD,EAKR,MAAQT,KAAM4D,EAAgB7X,MAAOmU,SAAuBb,EACzDc,KAAK,qBACLoD,SACAlD,GAAG,KAAMlB,EAAiB9R,IAC1B+S,SAEH,GAAIF,EAOF,MANApa,EAAOiG,MAAM,kBAAmBmU,EAAc,CAC5CsD,KAAMtD,EAAasD,KACnBC,QAASvD,EAAauD,QACtBC,QAASxD,EAAawD,QACtBC,KAAMzD,EAAayD,OAEfzD,EAKc2D,EAAyB1E,EAAiB9R,IAM9DvH,EAAO8Y,KAAK,6CAA8C,CACxDkF,WAAY3E,EAAiB9R,KAL/BvH,EAAO6c,KAAK,2CAA4C,CACtDmB,WAAY3E,EAAiB9R,KAQjCkT,EAAM8B,QAAQ,qBACd3D,KACF,OAAS3S,GACP,MAAMgY,EAAWhY,EACjBjG,EAAOiG,MAAM,kBAAmBgY,EAAU,CACxC7d,KAAM6d,GAAU7d,KAChBud,QAASM,GAAUN,QACnBD,KAAMO,GAAUP,KAChBE,QAASK,GAAUL,QACnBC,KAAMI,GAAUJ,KAChBK,MAAOD,GAAUC,QAEnBzD,EAAMxU,MAAM,oBAAoBgY,GAAUN,SAAW,cACvD,CAEAvE,GAAqB,GACrBE,EAAoB,KA9HG,GA+HtB,CAACC,EAAUF,EAAkBT,IAG1BuF,EAAkBrX,cAAa6D,IAC9BpC,IACiC,IAA/BA,EAAiBoC,GACvB,CAACpC,IAGEuF,EAAc9G,UAAQ,KAC1B,GAAkB,YAAduG,GAAyC,aAAdA,EAC7B,OACE9D,MAAC,SAAMnB,UAAU,aACfkB,gBAAC,MACCA,SAAA,CAAAC,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAwChN,SAAA,SACjH2U,EAAgB,0BACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA6ChN,SAAA,SAElI2U,EAAgB,qBACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAyChN,SAAA,SAEpH2U,EAAgB,mBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAuChN,SAAA,QAE5H2U,EAAgB,iBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAqChN,SAAA,QAE1H2U,EAAgB,gBACf1U,MAAC,MACCnB,UAAU,wEACV+E,MAAO,CACLpP,MAAO,GAAG4P,GAAqB,OAC/BiK,SAAU,GAAGjK,GAAqB,OAClCkK,SAAU,GAAGlK,GAAqB,QAErCrE,SAAA,OAEF2U,EAAgB,iBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAqChN,SAAA,QAE1H2U,EAAgB,0BACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA6ChN,SAAA,UAElI2U,EAAgB,cACf1U,MAAC,MAAGnB,UAAW,mDAAmDkO,KAAkChN,SAAA,OAErG2U,EAAgB,kBACf1U,MAAC,MAAGnB,UAAW,mDAAmDkO,KAAuChN,SAAA,OAE1G2U,EAAgB,aACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAkChN,SAAA,SAE7G2U,EAAgB,eACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAmChN,SAAA,OAE9G2U,EAAgB,WACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAgChN,SAAA,OAE3G2U,EAAgB,WACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAgChN,SAAA,OAEvG,aAAd+D,GAA4B4Q,EAAgB,WAC3C1U,IAAC,MAAGnB,UAAW,qEAAqEkO,KAA8BhN,SAAA,OAEnH2U,EAAgB,mBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAuChN,SAAA,SAE5H2U,EAAgB,iBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAqChN,SAAA,YAE1H2U,EAAgB,uBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA0ChN,SAAA,cAOxI,MAAM4U,EACJhV,OAAAsB,WAAA,CACGlB,SAAA,CAAA2U,EAAgB,0BACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA6ChN,SAAA,SAElI2U,EAAgB,qBACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAyChN,SAAA,SAEpH2U,EAAgB,mBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAuChN,SAAA,QAE5H2U,EAAgB,iBACf1U,MAAC,MAAGnB,UAAW,sDAAsDkO,KAAqChN,SAAA,QAG7F,SAAd+D,GAAwB4Q,EAAgB,iBACvC1U,IAAC,MAAGnB,UAAW,4EAA4EkO,KAA6BhN,SAAA,QAEzH2U,EAAgB,gBACf1U,MAAC,MACCnB,UAAW,mDAAiE,SAAdiF,EAAuBiJ,GAAmC,0BACxHnJ,MAAqB,SAAdE,OAAuB,EAAY,CACxCtP,MAAO,GAAG4P,GAAqB,OAC/BiK,SAAU,GAAGjK,GAAqB,OAClCkK,SAAU,GAAGlK,GAAqB,QAErCrE,SAAA,OAEF2U,EAAgB,iBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAqChN,SAAA,QAE1H2U,EAAgB,0BACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA6ChN,SAAA,WAEnH,YAAd+D,GAAyC,SAAdA,IAAyB4Q,EAAgB,0BACpE1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAoDhN,SAAA,WAEzI2U,EAAgB,cACf1U,MAAC,MAAGnB,UAAW,mDAAmDkO,KAAkChN,SAAA,OAErG2U,EAAgB,kBACf1U,MAAC,MAAGnB,UAAW,mDAAmDkO,KAAuChN,SAAA,OAE1G2U,EAAgB,aACf1U,MAAC,MAAGnB,UAAW,yCAAyCkO,KACpDhN,SAAc,eAA2B,SAAd+D,SAC1B,OAAIjF,UAAU,2CACbkB,SAAA,OAAC,OAAIlB,UAAU,aAAakB,SAAA,gBAC3B,OAAIlB,UAAU,cAAckB,SAAA,YAG/B,SAIL2U,EAAgB,eACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAmChN,SAAA,OAE9G2U,EAAgB,WACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAgChN,SAAA,UAKhH,IAAI6U,EAAoB,KAgDxB,MA9CkB,YAAd9Q,EACF8Q,EACEjV,OAAAsB,WAAA,CACGlB,SAAA,CAAA2U,EAAgB,WACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAgChN,SAAA,OAErH2U,EAAgB,mBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAuChN,SAAA,SAE5H2U,EAAgB,iBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAqChN,SAAA,YAE1H2U,EAAgB,uBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA0ChN,SAAA,YAI7G,SAAd+D,IAET8Q,EACEjV,OAAAsB,WAAA,CACGlB,SAAA,CAAA2U,EAAgB,WACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAgChN,SAAA,OAErH2U,EAAgB,SACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA8BhN,SAAA,OAEnH2U,EAAgB,mBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAuChN,SAAA,SAE5H2U,EAAgB,iBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAAqChN,SAAA,YAE1H2U,EAAgB,uBACf1U,MAAC,MAAGnB,UAAW,qEAAqEkO,KAA0ChN,SAAA,SAE/H2U,EAAgB,sBACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAgChN,SAAA,SAE3G2U,EAAgB,qBACf1U,MAAC,MAAGnB,UAAW,2DAA2DkO,KAAiChN,SAAA,aAOjHC,MAAC,SAAMnB,UAAU,aACfkB,gBAAC,MAEEA,SAAA,CAAc,YAAd+D,GAA2B4Q,EAAgB,uBAC1C1U,IAAC,MAAGnB,UAAW,2DAA2DkO,KAAyChN,SAAA,SAGtG,SAAd+D,GAAwB4Q,EAAgB,yBACvC1U,IAAC,MAAGnB,UAAW,2DAA2DkO,KAAyChN,SAAA,UAEpH4U,EACAC,QAIN,CAAC9Q,EAAW4Q,EAAiBtQ,IAG1BG,EAAqBhH,UAAQ,KACjC,IAAKuB,EAAkB,OAAO,EAE9B,QADkBQ,OAAOC,OAAOT,GAAkBjI,KAAKge,IAAYA,IAGlE,CAAC/V,IAGEgW,EAAyBvX,UAAQ,IAC9BhI,EAAU2C,QAAU,IAC1B,CAAC3C,EAAU2C,SAEd,OACEyH,OAAAsB,WAAA,CAEElB,SAAA,CAAAC,MAAC,OAAInB,UAAW,oBAAmB0F,EAAqB,QAAU,UAEvExE,SAAA+U,EAES9U,MAAC6D,GAAA,CACCtO,YACAuO,YACAC,WAAYuM,EACZtM,cACAC,oBACAC,oBACAC,gBAAiBqM,EACjB1R,mBACAsF,oBACAC,cACAC,kBAAmBwJ,GACnBvJ,6BAID,OAAI1F,UAAW0F,EAAqB,2BAA6B,oCAChExE,WAAAJ,KAAC,SAAMd,UAAW0F,EAAqB,kBAAkBT,QAAkB,wCACxE/D,SAAA,CAAAsE,QACA,SACEtE,SAAAxK,EAAUO,IAAKI,GACd8J,MAAC8N,GAAA,CAEC5X,WACAyK,QAAS2P,EACTxM,YACAE,cACAC,oBACAC,oBACAC,gBAAiBqM,EACjBpM,oBACAtF,oBATK5I,EAAS4H,oBAmB3B,OAAIe,UAAU,mCACbkB,WAAAC,IAAC,OAAInB,UAAU,oCACbkB,SAAAJ,OAAC,SAAMd,UAAU,kCACfkB,SAAA,CAAAC,MAAC,SAAMnB,UAAU,aACfkB,SAAAJ,OAAC,MACCI,SAAA,OAAC,MAAGlB,UAAU,+CAA+CkB,SAAA,eAC5D,MAAGlB,UAAU,+CAA+CkB,SAAA,UAC7DC,IAAC,MAAGnB,UAAU,gEAAgE+E,MAAO,CAAEpP,MAAO,GAAG4P,GAAqB,QAAUrE,SAAA,aAC/H,MAAGlB,UAAU,+CAA+CkB,SAAA,aAC5D,MAAGlB,UAAU,gDAAgDkB,SAAA,aAC7D,MAAGlB,UAAU,iDAAiDkB,SAAA,kBAGlE,SACEA,SAAAxK,EAAUO,IAAKI,GACdyJ,OAAC,MAECd,UAAU,2CACV8B,QAAS,IAAM2P,EAAepa,GAE9B6J,SAAA,CAAAC,MAAC,MAAGnB,UAAU,kBAAmBkB,SAAA7J,EAASO,uBAAyB,MACnEuJ,MAAC,MAAGnB,UAAU,MAAOkB,WAASrJ,iBAC9BsJ,MAAC,MAAGnB,UAAU,eAAeL,MAAOtI,EAAS4C,YAAciH,WAASjH,oBACnE,MAAG+F,UAAU,eAAeL,MAAOtI,EAAS8C,yBAAyB,IAAIE,UAAY6G,SAAA7J,EAAS8C,yBAAyB,IAAIE,WAAa,MACzI8G,MAAC,MAAGnB,UAAU,6BACXkB,WAAS/G,yBAAyB,IAAIwK,aAAe,GAAGtN,EAAS8C,uBAAuB,GAAGwK,aAAaE,oBAAoBoJ,GAAkB5W,EAAS8C,uBAAuB,IAAI6V,iBAAmB,SAAW3Y,EAASuN,aAAe,GAAGvN,EAASuN,aAAaC,oBAAoBoJ,GAAkB5W,EAASyN,UAAY,SAAW,KAAKmJ,GAAkB5W,EAASyN,UAAY,iBAErX,MAAG9E,UAAU,kBACZkB,SAAAC,MAACwC,GAAA,CAAYtM,iBAZVA,EAAS4H,oBAsBzB,OAAIe,UAAU,sBACZkB,SAAAxK,EAAUO,IAAKI,GACd8J,MAAC8C,GAAA,CAEC5M,WACAyK,QAAS,IAAM2P,EAAepa,IAFzBA,EAAS4H,OAQpBkC,MAAC+U,EAAA,CACCR,WAAYjF,EACZnQ,OAAQqQ,EACRwF,QAASzE,EACTrB,mBACApL,YACAqL,YACAC,qBACA6F,SAAW/e,IACT2Z,EAAoB3Z,GACpByZ,GAAqB,YAKxB3H,GAAA,CAAYnI,KAAM6P,EAAmB5P,aAAc6P,EAClD5P,gBAACuJ,GAAA,CACCvJ,SAAA,CAAAJ,OAAC4M,GAAA,CACCxM,SAAA,GAAAC,IAAC4K,IAAiB7K,SAAA,sBACjBiL,GAAA,CAAuBjL,SAAA,WACd6P,GAAkBnZ,sBAAsB,6CAInD+V,GAAA,CACCzM,SAAA,GAAAC,IAACuL,IAAkBxL,SAAA,OACnBC,MAACmL,GAAA,CACCxK,QAASuS,EACTrU,UAAU,8BACXkB,SAAA,mBAUbkP,GAAkB1M,YAAc,oBCv3ChC,MAAM2S,GAAgB,CAEpB,CACE7gB,IAAK,aACL0J,MAAO,MACP8P,KAAM,aACNsH,KAAMC,GACNC,SAAU,MAEZ,CACEhhB,IAAK,aACL0J,MAAO,KACP8P,KAAM,aACNsH,KAAMC,GACNC,SAAU,MAIZ,CACEhhB,IAAK,iBACL0J,MAAO,MACP8P,KAAM,oBACNsH,KAAMG,EACND,SAAU,OAEZ,CACEhhB,IAAK,cACL0J,MAAO,KACP8P,KAAM,oBACNsH,KAAMjhB,GACNmhB,SAAU,OAEZ,CACEhhB,IAAK,eACL0J,MAAO,MACP8P,KAAM,oBACNsH,KAAMG,EACND,SAAU,OAIZ,CACEhhB,IAAK,wBACL0J,MAAO,OACP8P,KAAM,OACNsH,KAAMI,GACNF,SAAU,OAEZ,CACEhhB,IAAK,YACL0J,MAAO,KACP8P,KAAM,OACNsH,KAAMI,GACNF,SAAU,OAEZ,CACEhhB,IAAK,gBACL0J,MAAO,KACP8P,KAAM,OACNsH,KAAMI,GACNF,SAAU,OAEZ,CACEhhB,IAAK,SACL0J,MAAO,KACP8P,KAAM,OACNsH,KAAMI,GACNF,SAAU,OAEZ,CACEhhB,IAAK,iBACL0J,MAAO,OACP8P,KAAM,OACNsH,KAAMjhB,GACNmhB,SAAU,OAEZ,CACEhhB,IAAK,eACL0J,MAAO,UACP8P,KAAM,OACNsH,KAAMI,GACNF,SAAU,OAEZ,CACEhhB,IAAK,qBACL0J,MAAO,OACP8P,KAAM,OACNsH,KAAMI,GACNF,SAAU,OAIZ,CACEhhB,IAAK,WACL0J,MAAO,KACP8P,KAAM,SACNsH,KAAMK,EACNH,SAAU,MAEZ,CACEhhB,IAAK,mBACL0J,MAAO,KACP8P,KAAM,SACNsH,KAAMK,EACNH,SAAU,MAEZ,CACEhhB,IAAK,eACL0J,MAAO,KACP8P,KAAM,SACNsH,KAAMK,EACNH,SAAU,MAIZ,CACEhhB,IAAK,mBACL0J,MAAO,OACP8P,KAAM,SACNsH,KAAMM,GACNJ,SAAU,KACV/c,QAAS,CAAC,OAAQ,OAAQ,SAE5B,CACEjE,IAAK,mBACL0J,MAAO,QACP8P,KAAM,oBACNsH,KAAMC,GACNC,SAAU,MAEZ,CACEhhB,IAAK,uBACL0J,MAAO,OACP8P,KAAM,SACNsH,KAAM9S,EACNgT,SAAU,KACV/c,QAAS,CAAC,KAAM,OAElB,CACEjE,IAAK,cACL0J,MAAO,OACP8P,KAAM,SACNsH,KAAM9S,EACNgT,SAAU,KACV/c,QAAS,CAAC,KAAM,OAElB,CACEjE,IAAK,wBACL0J,MAAO,WACP8P,KAAM,SACNsH,KAAM9S,EACNgT,SAAU,KACV/c,QAAS,CAAC,KAAM,OAElB,CACEjE,IAAK,iBACL0J,MAAO,SACP8P,KAAM,SACNsH,KAAMM,GACNJ,SAAU,KACV/c,QAAS,CAAC,KAAM,QAsCdod,GAAc,CAClB,CAAE5d,MAAO,eAAgBiG,MAAO,OAChC,CAAEjG,MAAO,wBAAyBiG,MAAO,SACzC,CAAEjG,MAAO,uBAAwBiG,MAAO,SACxC,CAAEjG,MAAO,cAAeiG,MAAO,SAC/B,CAAEjG,MAAO,aAAciG,MAAO,OAC9B,CAAEjG,MAAO,wBAAyBiG,MAAO,aAIrC4X,GAAc,CAClB,CAAE7d,MAAO,eAAgBiG,MAAO,OAChC,CAAEjG,MAAO,wBAAyBiG,MAAO,QACzC,CAAEjG,MAAO,cAAeiG,MAAO,OAC/B,CAAEjG,MAAO,iBAAkBiG,MAAO,OAClC,CAAEjG,MAAO,eAAgBiG,MAAO,MAChC,CAAEjG,MAAO,wBAAyBiG,MAAO,SACzC,CAAEjG,MAAO,aAAciG,MAAO,QAGhC,SAAwB6X,IAAcC,cACpCA,EAAAva,WACAA,EAAA3C,WACAA,EAAAmd,gBACAA,EAAAC,aACAA,EAAAC,eACAA,EAAAC,mBACAA,EAAqB,GAAAC,iBACrBA,EAAmB,GAAAC,kBACnBA,EAAoB,GAAAC,0BACpBA,EAA4B,GAAArW,SAC5BA,IAEA,MAAOsW,EAAcC,GAAmBja,YAAS,IAC1Cka,EAAYC,GAAiBna,YAAS,IACtCoa,EAAkBC,GAAuBra,YAAS,IAClDsa,EAAWC,GAAgBva,WAA8B,KACzDwa,EAAgBC,GAAqBza,YAAS,IAC9C0a,EAAiBC,GAAsB3a,YAAS,IAChD4a,EAAeC,GAAoB7a,WAAmC,KACtE8a,EAAWC,GAAgB/a,cAC3Bgb,EAAgBC,GAAqBjb,WAAmC,KACxEkb,EAAUC,GAAenb,WAAuD,KAChFob,EAAaC,GAAkBrb,WAAS,IACzCsb,EAAiBlT,SAAyB,MAGhD/H,YAAU,KACJ+Z,GAAoBkB,EAAetR,SACrCsR,EAAetR,QAAQmE,SAExB,CAACiM,IAGJ/Z,YAAU,KACJ6Z,GACFiB,EAAY,CACV9f,MAAO4D,GAAY5D,OAAS,GAC5BmE,UAAWP,GAAYO,WAAa,SAGvC,CAAC0a,EAAYjb,IAEhB,MAoDMsc,EAAsBC,IAC1B/B,EAAgBD,EAAc5f,OAAO6hB,GAAKA,EAAEha,KAAO+Z,KAuD/CE,EAAmB,KACvB,MAAMC,EAAc9C,GAAchI,QAAU4K,EAAEzjB,MAAQsiB,EAAUjf,OAChE,IAAKsgB,EAAa,OAAO,KAEzB,OAAQA,EAAYnK,MAClB,IAAK,OACH,OACE7N,MAACiY,EAAA,CACCC,YAAY,OACZpgB,MAAO6e,EAAU7e,OAAS,GAC1BqgB,SAAWvS,GAAMgR,EAAaxV,IAAA,IAAcA,EAAMtJ,MAAO8N,EAAEmJ,OAAOjX,SAClE+G,UAAU,qGACV+E,MAAO,CAACwU,QAAS,WAAYC,SAAU,OAAQC,WAAY,SAIjE,IAAK,SACH,OACEtY,MAACiY,EAAA,CACCpK,KAAK,SACLqK,YAAY,QACZpgB,MAAO6e,EAAU7e,OAAS,GAC1BqgB,SAAWvS,GAAMgR,EAAaxV,IAAA,IAAcA,EAAMtJ,MAAO8N,EAAEmJ,OAAOjX,SAClE+G,UAAU,qGACV+E,MAAO,CAACwU,QAAS,WAAYC,SAAU,OAAQC,WAAY,SAIjE,IAAK,oBACH,IAAIhgB,EAAoB,GACpB4f,EAAc,KACM,mBAApBF,EAAY3jB,KACdiE,EAAU2d,EACViC,EAAc,OACe,gBAApBF,EAAY3jB,KACrBiE,EAAU4d,EACVgC,EAAc,MACe,iBAApBF,EAAY3jB,MACrBiE,EAAU6d,EACV+B,EAAc,OAIhB,MAAMK,EAAkBjgB,EAAQrC,UAC9BuiB,EAAO3f,cAAcxC,SAASohB,EAAY5e,gBAG5C,SACE8G,KAAC8Y,EAAA,CAAQ3Y,aAAeD,IACjBA,GACH6X,EAAe,KAGjB3X,SAAA,GAAAC,IAAC0Y,EAAA,CAAexY,SAAO,EACrBH,SAAAJ,OAACQ,EAAA,CACCC,QAAQ,UACRtJ,KAAK,WACL+H,UAAU,yHAEVkB,SAAA,GAAAC,IAAC,QAAKnB,UAAU,qBAAqB+E,MAAO,CAACyU,SAAU,OAAQC,WAAY,OACxEvY,SAAA4W,EAAU7e,OAASogB,MAEtBlY,IAAC2Y,GAAA,CAAO9Z,UAAU,0CAGtBmB,MAAC4Y,GAAe/Z,UAAU,mCAAmC2B,MAAM,QACjET,WAAAJ,KAAC,OAAId,UAAU,YAEbkB,SAAA,CAAAC,MAACiY,EAAA,CACCC,YAAa,GAAGA,UAChBrZ,UAAU,gGACV+E,MAAO,CAACwU,QAAS,YACjBtgB,MAAO2f,EACPU,SAAWvS,GAAM8R,EAAe9R,EAAEmJ,OAAOjX,OACzC+gB,WAAS,UAIV,OAAIha,UAAU,gCACZkB,SAA2B,IAA3BwY,EAAgBrgB,OACf8H,MAAC,OAAInB,UAAU,4BACZkB,SAAA0X,EAAc,cAAgB,GAAGS,iBAGpCK,EAAgBziB,IAAI0iB,GAClB7Y,OAACQ,EAAA,CAECC,QAAQ,QACRO,QAAS,KACPiW,UAA2BxV,EAAMtJ,MAAO0gB,KACxCd,EAAe,KAEjB7Y,UAAU,8DAEVkB,SAAA,CAAAC,MAACqC,EAAA,CACCxD,UAAW,iBACT8X,EAAU7e,QAAU0gB,EAAS,cAAgB,eAGjDxY,MAAC,QAAKnB,UAAU,mBAAoBkB,SAAAyY,MAb/BA,cAuBvB,IAAK,SACH,cACGM,EAAA,CAAOhhB,MAAO6e,EAAU7e,OAAS,GAAIihB,cAAgBjhB,GAAU8e,UAA2BxV,EAAMtJ,WAC/FiI,SAAA,CAAAC,MAACgZ,IAAcna,UAAU,8GACvBkB,eAACkZ,GAAA,CAAYf,YAAY,eAE1BgB,GAAA,CACEnZ,SAAAiY,EAAY1f,SAASxC,IAAI0iB,SACvBW,GAAA,CAAwBrhB,MAAO0gB,EAC9BzY,SAAAC,MAAC,QAAKnB,UAAU,mBAAoBkB,cADrByY,SAQ3B,IAAK,oBACH,MAAMY,EAAkB,CAAC,QAAShD,GAClC,cACG0C,EAAA,CAAOhhB,MAAO6e,EAAU7e,OAAS,GAAIihB,cAAgBjhB,GAAU8e,UAA2BxV,EAAMtJ,WAC/FiI,SAAA,CAAAC,MAACgZ,IAAcna,UAAU,8GACvBkB,eAACkZ,GAAA,CAAYf,YAAY,kBAE1BgB,GAAA,CACEnZ,SAAAqZ,EAAgBtjB,IAAI0iB,SAClBW,GAAA,CAAwBrhB,MAAO0gB,EAC9BzY,SAAAC,MAAC,QAAKnB,UAAU,mBAAoBkB,cADrByY,SAQ3B,IAAK,aACH,cACGC,EAAA,CAAQ5Y,KAAMgX,EAAgB/W,aAAeD,IAC5C,GAAIA,EAEF,GAAI8W,EAAU7e,MACZ,GAAI6e,EAAU7e,MAAMzB,SAAS,KAAM,CACjC,MAAOkP,EAAOE,GAAOkR,EAAU7e,MAAM9B,MAAM,KAC3CkhB,EAAiB,CACftG,KAAM,IAAIxW,KAAKmL,GACf8T,GAAI,IAAIjf,KAAKqL,IAEjB,MACEyR,EAAiB,CACftG,KAAM,IAAIxW,KAAKuc,EAAU7e,OACzBuhB,QAAI,SAIRnC,EAAiB,IAGrBJ,EAAkBjX,IAElBE,SAAA,GAAAC,IAAC0Y,EAAA,CAAexY,SAAO,EACrBH,SAAAC,MAACG,EAAA,CACCC,QAAQ,UACRvB,UAAU,iHAEVkB,SAAAJ,OAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAACoV,GAAA,CAASvW,UAAU,gCACnB,QAAKA,UAAU,qDACbkB,SAAA4W,EAAU7e,MAAA,MACT,GAAI6e,EAAU7e,MAAMzB,SAAS,KAAM,CACjC,MAAOkP,EAAOE,GAAOkR,EAAU7e,MAAM9B,MAAM,KAC3C,MAAO,GAAGsjB,GAAO,IAAIlf,KAAKmL,GAAQ,kBAAkB+T,GAAO,IAAIlf,KAAKqL,GAAM,aAC5E,CACE,OAAO6T,GAAO,IAAIlf,KAAKuc,EAAU7e,OAAQ,WAE7C,EAPW,GAOJ,iBAKfkI,MAAC4Y,GAAe/Z,UAAU,aAAa2B,MAAM,QAC3CT,WAAAJ,KAAC,OAAId,UAAU,YACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,WACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,yCAAyCkB,SAAA,aACxDC,MAACuZ,GAAA,CACCC,KAAK,QACLC,SAAUxC,EACVyC,SAAWC,IACLA,GACFzC,EAAiByC,IAGrBC,eAAgB,EAChBC,cAAY,EACZhb,UAAU,0BAGdc,KAAC,OAAId,UAAU,sBACbkB,SAAA,CAAAC,MAACG,EAAA,CACCQ,QAAS,KACPuW,EAAiB,IACjBJ,GAAkB,IAEpB1W,QAAQ,UACRvB,UAAU,oFACXkB,SAAA,OAGDC,MAACG,EAAA,CACCQ,QAAS,KACP,GAAIsW,EAAcrG,KAAM,CACtB,GAAIqG,EAAcoC,GAAI,CAEpB,MAAMS,EAAa,GAAGR,GAAOrC,EAAcrG,KAAM,iBAAiB0I,GAAOrC,EAAcoC,GAAI,gBAC3FzC,UAA2BxV,EAAMtJ,MAAOgiB,IAC1C,MAEElD,EAAaxV,IAAA,IAAcA,EAAMtJ,MAAOwhB,GAAOrC,EAAcrG,KAAM,iBAErEkG,GAAkB,EACpB,GAEFxW,UAAW2W,EAAcrG,KACzB/R,UAAU,8DACXkB,SAAA,kBASb,IAAK,aACH,cACG0Y,EAAA,CAAQ5Y,KAAMkX,EAAiBjX,aAAeD,IAC7C,GAAIA,EAEF,GAAI8W,EAAU7e,MACZ,GAAI6e,EAAU7e,MAAMzB,SAAS,KAAM,CACjC,MAAOkP,EAAOE,GAAOkR,EAAU7e,MAAM9B,MAAM,KAC3CshB,EAAkB,CAChB1G,KAAM,IAAIxW,KAAK,GAAGmL,QAClB8T,GAAI,IAAIjf,KAAK,GAAGqL,SAEpB,MACE6R,EAAkB,CAChB1G,KAAM,IAAIxW,KAAK,GAAGuc,EAAU7e,YAC5BuhB,QAAI,SAIR/B,EAAkB,IAGtBN,EAAmBnX,IAEnBE,SAAA,GAAAC,IAAC0Y,EAAA,CAAexY,SAAO,EACrBH,SAAAC,MAACG,EAAA,CACCC,QAAQ,UACRvB,UAAU,iHAEVkB,SAAAJ,OAAC,OAAId,UAAU,4BACbkB,SAAA,GAAAC,IAACoV,GAAA,CAASvW,UAAU,gCACnB,QAAKA,UAAU,qDACbkB,SAAA4W,EAAU7e,MAAA,MACT,GAAI6e,EAAU7e,MAAMzB,SAAS,KAAM,CACjC,MAAOkP,EAAOE,GAAOkR,EAAU7e,MAAM9B,MAAM,MACpC+jB,EAAWxf,GAAcgL,EAAMvP,MAAM,MACrCgkB,EAASxf,GAAYiL,EAAIzP,MAAM,KACtC,MAAO,GAAG+jB,EAAUrf,OAAM,MAAOH,QAAiByf,EAAQtf,OAAM,MAAOF,GACzE,CAAO,CACL,MAAOyf,EAAMC,GAASvD,EAAU7e,MAAM9B,MAAM,KAC5C,MAAO,GAAGikB,EAAKvf,OAAM,MAAOwf,GAC9B,CACF,EAVW,GAUJ,gBAKfla,MAAC4Y,GAAe/Z,UAAU,aAAa2B,MAAM,QAC3CT,WAAAJ,KAAC,OAAId,UAAU,YACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,WACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,yCAAyCkB,SAAA,WAGxDJ,KAAC,OAAId,UAAU,aACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,SACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,6BAA6BkB,SAAA,kBAE3C,OAAIlB,UAAU,OACbkB,SAAAJ,OAAC,OAAId,UAAU,yCACbkB,SAAA,CAAAC,MAACG,EAAA,CACCQ,QAAS,KACP,MAAMwZ,EAAc9C,EAAezG,KAAOyG,EAAezG,KAAKwJ,mBAAoBhgB,MAAOggB,cACnFC,EAAU,IAAIjgB,KAAK+f,EAAc,EAAG9C,EAAezG,KAAOyG,EAAezG,KAAK0J,WAAa,EAAG,GACpGhD,UAAgClW,EAAMwP,KAAMyJ,MAE9Cja,QAAQ,UACRC,KAAK,KACLxB,UAAU,6EACXkB,SAAA,QAGDJ,KAAC,QAAKd,UAAU,oCACbkB,SAAA,CAAAsX,EAAezG,KAAOyG,EAAezG,KAAKwJ,eAAA,IAAoBhgB,MAAOggB,cAAc,OAEtFpa,MAACG,EAAA,CACCQ,QAAS,KACP,MAAMwZ,EAAc9C,EAAezG,KAAOyG,EAAezG,KAAKwJ,mBAAoBhgB,MAAOggB,cACnFC,EAAU,IAAIjgB,KAAK+f,EAAc,EAAG9C,EAAezG,KAAOyG,EAAezG,KAAK0J,WAAa,EAAG,GACpGhD,UAAgClW,EAAMwP,KAAMyJ,MAE9Cja,QAAQ,UACRC,KAAK,KACLxB,UAAU,6EACXkB,SAAA,WAOLC,MAAC,OAAInB,UAAU,yBACZkB,SAAApK,MAAMib,KAAK,CAAE1Y,OAAQ,IAAM,CAACqiB,EAAGC,KAC9B,MAAML,EAAc9C,EAAezG,KAAOyG,EAAezG,KAAKwJ,mBAAoBhgB,MAAOggB,cACnFK,EAAY,IAAIrgB,KAAK+f,EAAaK,EAAG,GACrCE,EAAarD,EAAezG,MAChCyG,EAAezG,KAAKwJ,gBAAkBD,GACtC9C,EAAezG,KAAK0J,aAAeE,EAErC,OACE7a,OAACQ,EAAA,CAECQ,QAAS,KACP2W,UAAgClW,EAAMwP,KAAM6J,MAE9Cra,QAAQ,UACRvB,UAAW,4BACT6b,EACI,2DACA,2DAGL3a,SAAA,CAAAya,EAAI,EAAE,MAXFA,UAkBdnD,EAAezG,MACdjR,OAAC,OAAId,UAAU,SACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,6BAA6BkB,SAAA,yBAE3C,OAAIlB,UAAU,OACbkB,SAAAJ,OAAC,OAAId,UAAU,yCACbkB,SAAA,CAAAC,MAACG,EAAA,CACCQ,QAAS,KACP,MAAMwZ,EAAc9C,EAAegC,GAAKhC,EAAegC,GAAGe,cAAgB/C,EAAezG,KAAKwJ,cACxFC,EAAU,IAAIjgB,KAAK+f,EAAc,EAAG9C,EAAegC,GAAKhC,EAAegC,GAAGiB,WAAa,GAAI,GACjGhD,UAAgClW,EAAMiY,GAAIgB,MAE5Cja,QAAQ,UACRC,KAAK,KACLxB,UAAU,6EACXkB,SAAA,QAGDJ,KAAC,QAAKd,UAAU,oCACbkB,SAAA,CAAAsX,EAAegC,GAAKhC,EAAegC,GAAGe,cAAgB/C,EAAezG,KAAKwJ,cAAc,OAE3Fpa,MAACG,EAAA,CACCQ,QAAS,KACP,MAAMwZ,EAAc9C,EAAegC,GAAKhC,EAAegC,GAAGe,cAAgB/C,EAAezG,KAAKwJ,cACxFC,EAAU,IAAIjgB,KAAK+f,EAAc,EAAG9C,EAAegC,GAAKhC,EAAegC,GAAGiB,WAAa,GAAI,GACjGhD,UAAgClW,EAAMiY,GAAIgB,MAE5Cja,QAAQ,UACRC,KAAK,KACLxB,UAAU,6EACXkB,SAAA,WAOLC,MAAC,OAAInB,UAAU,yBACZkB,SAAApK,MAAMib,KAAK,CAAE1Y,OAAQ,IAAM,CAACqiB,EAAGC,KAC9B,MAAML,EAAc9C,EAAegC,GAAKhC,EAAegC,GAAGe,cAAgB/C,EAAezG,KAAKwJ,cACxFK,EAAY,IAAIrgB,KAAK+f,EAAaK,EAAG,GACrCE,EAAarD,EAAegC,IAChChC,EAAegC,GAAGe,gBAAkBD,GACpC9C,EAAegC,GAAGiB,aAAeE,EAC7BG,EAAaF,EAAYpD,EAAezG,KAE9C,OACEjR,OAACQ,EAAA,CAECQ,QAAS,KACFga,GACHrD,UAAgClW,EAAMiY,GAAIoB,MAG9Cra,QAAQ,UACRE,SAAUqa,EACV9b,UAAW,4BACT6b,EACI,2DACAC,EACA,+DACA,2DAGL5a,SAAA,CAAAya,EAAI,EAAE,MAhBFA,SAsBbxa,IAAC,OAAInB,UAAU,OACbkB,SAAAC,MAACG,EAAA,CACCQ,QAAS,KACP2W,UAAgClW,EAAMiY,QAAI,MAE5CjZ,QAAQ,UACRC,KAAK,KACLxB,UAAU,qFACXkB,SAAA,yBAQXJ,KAAC,OAAId,UAAU,sBACbkB,SAAA,CAAAC,MAACG,EAAA,CACCQ,QAAS,KACP2W,EAAkB,IAClBN,GAAmB,IAErB5W,QAAQ,UACRvB,UAAU,oFACXkB,SAAA,OAGDC,MAACG,EAAA,CACCQ,QAAS,KACP,GAAI0W,EAAezG,KAAM,CACvB,GAAIyG,EAAegC,GAAI,CAErB,MAAMS,EAAa,GAAGR,GAAOjC,EAAezG,KAAM,cAAc0I,GAAOjC,EAAegC,GAAI,aAC1FzC,UAA2BxV,EAAMtJ,MAAOgiB,IAC1C,MAEElD,EAAaxV,IAAA,IAAcA,EAAMtJ,MAAOwhB,GAAOjC,EAAezG,KAAM,cAEtEoG,GAAmB,EACrB,GAEF1W,UAAW+W,EAAezG,KAC1B/R,UAAU,8DACXkB,SAAA,kBASb,QACE,OAAO,OAIb,SACEJ,KAAC,OAAId,UAAU,mBAEbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,oCACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,0BAEbkB,SAAA,CAAAJ,OAAC8Y,EAAA,CAAQ5Y,KAAMwW,EAAcvW,aAAcwW,EACzCvW,SAAA,GAAAC,IAAC0Y,EAAA,CAAexY,SAAO,EACrBH,SAAAJ,OAACQ,EAAA,CACCC,QAAQ,UACRvB,UAAU,6EAEVkB,SAAA,GAAAC,IAAC4a,GAAA,CAAQ/b,UAAU,iBACnBmB,MAAC,QAAKnB,UAAU,cAAckB,SAAA,OAC7B8V,EAAc3d,OAAS,GACtB8H,MAAC,QAAKnB,UAAU,4CACbkB,WAAc7H,cAKvB8H,MAAC4Y,GAAe/Z,UAAU,WAAW2B,MAAM,QACzCT,WAAAJ,KAAC,OAAId,UAAU,YACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,oCACbkB,SAAA,CAAAC,MAAC,MAAGnB,UAAU,aAAakB,SAAA,OAC1B8V,EAAc3d,OAAS,GACtB8H,MAACG,EAAA,CACCC,QAAQ,QACRO,QApjBU,KAC5BmV,EAAgB,IAChBQ,GAAgB,IAmjBEzX,UAAU,8DAEVkB,WAAAC,IAAC,QAAKnB,UAAU,cAAckB,SAAA,gBAMnC8V,EAAc3d,OAAS,GACtByH,OAAC,OAAId,UAAU,YACZkB,SAAA,CAAA8V,EAAc/f,IAAIG,GACjB0J,OAAC,OAAoBd,UAAU,mEAC7BkB,SAAA,GAAAJ,KAAC,QAAKd,UAAU,mBACbkB,SAAA,CAAA9J,EAAO8H,MACP9H,EAAO8D,WACN4F,OAAC,QAAKd,UAAU,gBAAgBkB,SAAA,KAC5B2V,GAAYxI,KAAK2N,GAAMA,EAAG/iB,QAAU7B,EAAO8D,YAAYgE,MAAM,OAEjE,KACC9H,EAAO6B,SAEZkI,MAACG,EAAA,CACCC,QAAQ,QACRO,QAAS,IAAMiX,EAAmB3hB,EAAO6H,IACzCe,UAAU,0CAEVkB,SAAAC,MAACsC,EAAA,CAAEzD,UAAU,gBAfP5I,EAAO6H,OAmBnBkC,IAAC,OAAInB,UAAU,uCAKnBc,KAAC,OAAId,UAAU,YACbkB,SAAA,GAAAJ,KAACmZ,EAAA,CAAOC,cAjpBCrhB,IACvB,MAAMsgB,EAAc9C,GAAchI,KAAK4K,GAAKA,EAAEzjB,MAAQqD,GACtD,IAAKsgB,EAAa,OAGlB,IAAI8C,EAAmB,WACE,eAArB9C,EAAYnK,MAA8C,eAArBmK,EAAYnK,OACnDiN,EAAmB,UAGrBlE,EAAa,CACX9Y,GAAI,GAAGpG,KAAS0C,KAAK2gB,QACrBrjB,QACAoC,UAAWghB,EACXhjB,MAAO,GACPiG,MAAOia,EAAYja,SAmoBLgC,SAAA,CAAAC,MAACgZ,IAAcna,UAAU,8GACvBkB,eAACkZ,GAAA,CAAYf,YAAY,cAE3BlY,MAACkZ,GAAA,CACCra,UAAU,gCACV+E,MAAO,CACLoX,eAAgB,OAChBC,eAAgB,kBAChBC,qBAAsB,OAGvBnb,SAAAT,OAAO6b,QACNjG,GAAc/W,OAAO,CAACC,EAAK1G,KACpB0G,EAAI1G,EAAM2d,YAAWjX,EAAI1G,EAAM2d,UAAY,IAChDjX,EAAI1G,EAAM2d,UAAU+F,KAAK1jB,GAClB0G,GACN,KACHtI,IAAI,EAAEuf,EAAUgG,YACf,OACCtb,SAAA,CAAAC,MAAC,OAAInB,UAAU,uCACZkB,SAAAsV,IAEFgG,EAAOvlB,IAAI4B,GACVsI,MAACmZ,GAAA,CAA2BrhB,MAAOJ,EAAMrD,IACvC0L,SAAAJ,OAAC,OAAId,UAAU,0BACbkB,SAAA,GAAAC,IAACtI,EAAMyd,KAAN,CAAWtW,UAAU,YACtBmB,MAAC,QAAKnB,UAAU,mBAAoBkB,WAAMhC,YAH7BrG,EAAMrD,QALjBghB,SAkBfsB,EAAUjf,OACTiI,OAAC,OAAId,UAAU,gDACbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,0BACbkB,SAAAJ,OAAC,QAAKd,UAAU,aAAckB,SAAA,CAAA4W,EAAU5Y,MAAM,WAI1B,eAApB4Y,EAAUjf,OAA8C,eAApBif,EAAUjf,MAC9CiI,OAAC,OAAId,UAAU,yBAEbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,mBACbkB,SAAAJ,OAACmZ,EAAA,CACChhB,MAAO6e,EAAU5c,WAAa,GAC9Bgf,cAAgBjhB,GAAU8e,EAAaxV,IAAA,IAAcA,EAAMrH,UAAWjC,KAEtEiI,SAAA,GAAAC,IAACgZ,GAAA,CAAcna,UAAU,oIACvBkB,SAAAC,MAACiZ,IAAYf,YAAY,QAAQrZ,UAAU,kBAE7CmB,MAACkZ,IACEnZ,SAAA2V,GAAY5f,OACXkK,MAACmZ,GAAA,CAAiCrhB,MAAOiC,EAAUjC,MACjDiI,eAAC,QAAKlB,UAAU,mBAAoBkB,SAAAhG,EAAUgE,SAD/BhE,EAAUjC,eASnCkI,MAAC,OAAInB,UAAU,mBACZkB,oBAKLC,IAAC,OACED,SAAAgY,QAILpY,KAAC,OAAId,UAAU,aACbkB,SAAA,CAAAC,MAACG,EAAA,CACCQ,QA7sBE,KACxB,MAAM2a,EAAmC,eAApB3E,EAAUjf,OAA8C,eAApBif,EAAUjf,MAC7D6jB,EAAoBD,IAAiB3E,EAAU5c,UAGrD,IAAIyhB,EAAiB7E,EAAU7c,UAC/B,IAAK0hB,EACH,GAAIF,EACFE,EAAiB,aACZ,CAEL,MAAMxD,EAAc9C,GAAchI,QAAU4K,EAAEzjB,MAAQsiB,EAAUjf,OAChE8jB,EAAwC,WAAtBxD,GAAanK,MAA2C,sBAAtBmK,GAAanK,MAAsD,sBAAtBmK,GAAanK,KAC1G,SACA,UACN,CAGF,GAAI8I,EAAUjf,YAA4B,IAAnB8jB,GAAoD,KAApB7E,EAAU7e,QAAiByjB,EAAmB,CACnG,MAAMtlB,EAAqB,CACzB6H,GAAI6Y,EAAU7Y,GACdpG,MAAOif,EAAUjf,MACjBoC,UAAW0hB,EACX1jB,MAAO6e,EAAU7e,MACjBiG,MAAO4Y,EAAU5Y,MACjBhE,UAAW4c,EAAU5c,WAEvB+b,EAAgB,IAAID,EAAe5f,IACnC2gB,EAAa,IACbN,GAAgB,EAClB,GAgrBsBhW,UACGqW,EAAUjf,OACS,KAApBif,EAAU7e,QACY,eAApB6e,EAAUjf,OAA8C,eAApBif,EAAUjf,SAA4Bif,EAAU5c,UAExF8E,UAAU,8DACXkB,SAAA,OAGDC,MAACG,EAAA,CACCC,QAAQ,UACRO,QAAS,IAAMiW,EAAa,IAC5B/X,UAAU,oFACXkB,SAAA,wBAYfJ,OAAC8Y,EAAA,CAAQ5Y,KAAM0W,EAAYzW,aAAc0W,EACvCzW,SAAA,GAAAC,IAAC0Y,EAAA,CAAexY,SAAO,EACrBH,SAAAJ,OAACQ,EAAA,CACCC,QAAQ,UACRvB,UAAU,6EAEVkB,SAAA,GAAAC,IAACyb,EAAA,CAAY5c,UAAU,iBACvBmB,MAAC,QAAKnB,UAAU,cAAckB,SAAA,OAC7BzE,GACCqE,OAAC,QAAKd,UAAU,wBAAwBkB,SAAA,KACX,QAAzBzE,EAAWO,UAAsB,IAAM,IAAI,YAKrDmE,MAAC4Y,GAAe/Z,UAAU,WAAW2B,MAAM,QACzCT,WAAAJ,KAAC,OAAId,UAAU,YACbkB,SAAA,CAAAC,MAAC,MAAGnB,UAAU,aAAakB,SAAA,YAE3BJ,KAAC,OAAId,UAAU,YAEbkB,SAAA,CAAAJ,OAAC,OACCI,SAAA,CAAAC,MAAC,SAAMnB,UAAU,mCAAmCkB,SAAA,UACpDJ,OAACmZ,EAAA,CACChhB,MAAOyf,EAAS7f,OAAS,GACzBqhB,cAttBWrhB,IAC7B8f,EAAYpW,IAAA,IAAcA,EAAM1J,YAutBdqI,SAAA,CAAAC,MAACgZ,IAAcna,UAAU,kGACvBkB,eAACkZ,GAAA,CAAYf,YAAY,YAE3BlY,MAACkZ,IACEnZ,SAAA4V,GAAY7f,OACXkK,MAACmZ,GAAA,CAA6BrhB,MAAOJ,EAAMI,MACzCiI,eAAC,QAAKlB,UAAU,mBAAoBkB,SAAArI,EAAMqG,SAD3BrG,EAAMI,gBAS9Byf,EAAS7f,OACRiI,OAAC,OACCI,SAAA,CAAAC,MAAC,SAAMnB,UAAU,mCAAmCkB,SAAA,UACpDJ,OAACmZ,EAAA,CACChhB,MAAOyf,EAAS1b,WAAa,GAC7Bkd,cAvuBald,IACjC2b,EAAYpW,IAAA,IAAcA,EAAMvF,gBAwuBZkE,SAAA,CAAAC,MAACgZ,IAAcna,UAAU,kGACvBkB,eAACkZ,GAAA,CAAYf,YAAY,mBAE1BgB,GAAA,CACCnZ,SAAA,GAAAC,IAACmZ,GAAA,CAAWrhB,MAAM,MAChBiI,SAAAC,MAAC,QAAKnB,UAAU,mBAAmBkB,wBAErCC,IAACmZ,IAAWrhB,MAAM,OAChBiI,eAAC,QAAKlB,UAAU,mBAAmBkB,SAAA,wBAQ7CJ,KAAC,OAAId,UAAU,kBACbkB,SAAA,CAAAC,MAACG,EAAA,CACCQ,QAvvBI,KACtB,GAAI4W,EAAS7f,OAAS6f,EAAS1b,UAAW,CACxC,MAAMmc,EAAcrC,GAAYzI,QAAU4K,EAAEhgB,QAAUyf,EAAS7f,OAC3DsgB,GACFjC,EAAa,CACXre,MAAO6f,EAAS7f,MAChBmE,UAAW0b,EAAS1b,UACpBkC,MAAOia,EAAYja,OAGzB,CACAyY,GAAc,GACdgB,EAAY,KA4uBMlX,UAAWiX,EAAS7f,QAAU6f,EAAS1b,UACvCgD,UAAU,8DACXkB,SAAA,OAGDC,MAACG,EAAA,CACCQ,QA/uBI,KACtBoV,EAAa,MACbyB,EAAY,IACZhB,GAAc,IA6uBI3X,UAAU,6EACXkB,SAAA,cAMJzE,KACC0E,IAAC,OAAInB,UAAU,gBACbkB,SAAAC,MAACG,EAAA,CACCC,QAAQ,UACRO,QAAS,IAAMoV,EAAa,MAC5BlX,UAAU,0DAEVkB,WAAAC,IAAC,QAAKnB,UAAU,cAAckB,SAAA,sBAS1CC,MAAC,OAAInB,UAAU,0BACZkB,SAAC0W,EAUA9W,OAAC,OAAId,UAAU,0BACbkB,SAAA,CAAAC,MAACiY,EAAA,CACCnR,IAAK6Q,EACLO,YAAY,WACZpgB,MAAOa,EACPwf,SAAWvS,GAAMoQ,EAAepQ,EAAEmJ,OAAOjX,OACzC+G,UAAU,yFAEZmB,MAACG,EAAA,CACCC,QAAQ,QACRO,QAAS,KACP+V,GAAoB,GACpBV,EAAe,KAEjBnX,UAAU,0BAEVkB,SAAAC,MAACsC,EAAA,CAAEzD,UAAU,iBAzBjBc,OAACQ,EAAA,CACCC,QAAQ,UACRO,QAAS,IAAM+V,GAAoB,GACnC7X,UAAU,6EAEVkB,SAAA,GAAAC,IAAC2Y,GAAA,CAAO9Z,UAAU,iBAClBmB,MAAC,QAAKnB,UAAU,cAAckB,SAAA,YA0BpCJ,OAACQ,EAAA,CACCC,QAAQ,UACRO,QAAS,KACPqV,EAAe,IACfF,EAAgB,IAChBC,EAAa,CACXre,MAAO,aACPmE,UAAW,OACXkC,MAAO,QAET2Y,GAAoB,IAEtB7X,UAAU,mGACXkB,SAAA,MACGC,MAAC,QAAKnB,UAAU,4BAA4BkB,SAAA,gBAKlDC,IAAC,OAAInB,UAAU,0BACZkB,gBAKJ8V,EAAc3d,OAAS,GACtB8H,MAAC,OAAInB,UAAU,uBACZkB,SAAA8V,EAAc/f,IAAIG,GACjB0J,OAAC,QAECd,UAAU,sFAETkB,SAAA,CAAA9J,EAAO8H,MACP9H,EAAO8D,WACN4F,OAAC,QAAKd,UAAU,gBAAgBkB,SAAA,KAC5B2V,GAAYxI,KAAK2N,GAAMA,EAAG/iB,QAAU7B,EAAO8D,YAAYgE,MAAM,OAEjE,KACC9H,EAAO6B,MACVkI,MAACG,EAAA,CACCC,QAAQ,QACRC,KAAK,KACLM,QAAS,IAAMiX,EAAmB3hB,EAAO6H,IACzCe,UAAU,qCAEVkB,SAAAC,MAACsC,EAAA,CAAEzD,UAAU,gBAhBV5I,EAAO6H,SAwB1B,CCtuCO,MAAM4d,GAAgC,CAC3C,mBACA,YACA,uBACA,sBAaWrmB,GAAmB,CAAC,OA0C1B,SAASsmB,GACd/N,EACAlY,GAEA,OAzC6Bke,EAyCVle,EAxCZgmB,GAAc7kB,KAAKC,GAAQ8c,EAAMvd,SAASS,IAyCxC8W,EAEFA,EAAM3X,OAAOgD,IAAS5D,GAAiBgB,SAAS4C,EAAKvC,iBA5CvD,IAAwBkd,CA6C/B,CCvEA,MAAMgI,GAAqBC,OAAK,UAAMC,OAAO,oCAA0CC,8DAcjFC,GAA6C,CACjD,CAAE3nB,IAAK,UAAW0J,MAAO,QACzB,CAAE1J,IAAK,WAAY0J,MAAO,SAC1B,CAAE1J,IAAK,UAAW0J,MAAO,SACzB,CAAE1J,IAAK,OAAQ0J,MAAO,UAIxB,SAAwBke,IAAiBC,gBAAEA,GAAkB,IAC1CC,IACjB,MAAMC,EAAWC,IACXvM,EAAWC,KACVuM,EAAkBC,GAAuBlgB,WAA0B,OACnEmT,EAAaC,GAAkBpT,YAAS,IAGxCwZ,EAAe2G,GAAoBngB,WAAuB,KAC1Df,EAAYmhB,GAAiBpgB,WAA0B,CAC5D3E,MAAO,aACPmE,UAAW,OACXkC,MAAO,SAEFpF,EAAY+jB,GAAiBrgB,WAAS,KACtC4Z,EAAoB0G,GAAyBtgB,WAAmB,KAChE6Z,EAAkB0G,GAAuBvgB,WAAmB,KAC5D8Z,EAAmB0G,GAAwBxgB,WAAmB,KAC9D+Z,EAA2B0G,GAAgCzgB,WAAmB,KAInFrE,aAAczC,EAAA+G,QACdA,EAAA7G,YACAA,EAAA2H,qBACAA,GAEErB,MAGE+C,iBAAEA,EAAkB3C,UAAW4gB,sBAAiBhe,EAAAC,eAAqBA,GCnD5C,MAC/B,MAAOF,EAAkBke,GAAuB3gB,WAA2B6B,KACpE/B,EAAW8gB,GAAgB5gB,YAAS,IACpCG,EAAOC,GAAYJ,WAAwB,QACzC6gB,GAAe7gB,WAAS,GAC3ByT,EAAWC,IAGXoN,EAAmB9f,cAAY6Q,UACnC,IACE+O,GAAa,GACbxgB,EAAS,MAGT,MAAQgU,MAAM4C,KAAEA,GAAQ7W,MAAO8W,SAAoBxD,EAASyD,KAAKC,UAEjE,GAAIF,IAAcD,GAAMM,MAGtB,OAFApd,EAAO6c,KAAK,mCAAoC,CAAEE,mBAClD0J,EAAoB9e,IAKtB,MAAQuS,KAAM2M,EAAU5gB,MAAO6gB,SAAwBvN,EACpDc,KAAK,oBACLC,OAAO,iBACPC,GAAG,aAAcuC,EAAKM,OACtB7C,GAAG,eAAgB,qBACnBA,GAAG,cAAe,sBAClBwM,cAEH,GAAID,EAMF,OALA9mB,EAAOiG,MAAM,+BAAgC6gB,EAAe,CAC1DE,UAAWlK,EAAKM,QAElBlX,EAAS,+BACTugB,EAAoB9e,IAItB,GAAIkf,GAAUI,cAAe,CAE3B,MAAMC,EAAgBL,EAASI,cAGzBE,EAAiB,IAAKxf,MAA8Buf,GAE1DT,EAAoBU,GACpBnnB,EAAOC,MAAM,mCAAoC,CAC/C+mB,UAAWlK,EAAKM,MAChBgK,cAAere,OAAOzH,KAAK6lB,GAAgBxlB,QAE/C,MAEE8kB,EAAoB9e,IACpB3H,EAAOC,MAAM,+BAAgC,CAC3C+mB,UAAWlK,EAAKM,OAGtB,OAASnX,GACPjG,EAAOiG,MAAM,oCAAqCA,GAClDC,EAAS,0BACTugB,EAAoB9e,GACtB,SACE+e,GAAa,EACf,GACC,CAACnN,IAGE8N,EAAmBvgB,cAAY6Q,MAAO2P,IAC1C,IACE,MAAQpN,MAAM4C,KAAEA,GAAQ7W,MAAO8W,SAAoBxD,EAASyD,KAAKC,UAEjE,GAAIF,IAAcD,GAAMM,MAEtB,YADApd,EAAO6c,KAAK,2CAA4C,CAAEE,cAI5D,MAAQ9W,MAAOshB,SAAsBhO,EAClCc,KAAK,oBACLmN,OAAO,CACNC,WAAY3K,EAAKM,MACjBsK,aAAc,oBACdC,YAAa,qBACbV,cAAeK,GACd,CACDM,WAAY,wCAGhB,GAAIL,EAKF,MAJAvnB,EAAOiG,MAAM,+BAAgCshB,EAAa,CACxDP,UAAWlK,EAAKM,MAChByJ,SAAUS,IAENC,EAGRvnB,EAAO8Y,KAAK,+BAAgC,CAC1CkO,UAAWlK,EAAKM,MAChBgK,cAAere,OAAOzH,KAAKgmB,GAAa3lB,OACxCkmB,eAAgB9e,OAAO6b,QAAQ0C,GAAa5nB,OAAO,EAAC,CAAG4e,KAAaA,GAAS3c,QAEjF,OAASsE,GAEP,MADAjG,EAAOiG,MAAM,oCAAqCA,GAC5CA,CACR,GACC,CAACsT,IAGEuO,EAAehhB,cAAa6D,IAChC8b,EAAoBsB,IAClB,MAAMT,EAAc,IACfS,EACHpd,CAACA,IAAYod,EAAapd,IAW5B,OAPA0c,EAAiBC,GAAaU,MAAM/hB,IAElCwgB,EAAoBsB,GACpBtN,EAAMxU,MAAM,kBACZjG,EAAOiG,MAAM,sCAAuCA,KAG/CqhB,KAER,CAACD,IAGE7e,EAAsB1B,cAAawgB,IACvCtnB,EAAO8Y,KAAK,6CAA8C,CACxDwO,cACAhmB,KAAMyH,OAAOzH,KAAKgmB,GAClBte,OAAQD,OAAOC,OAAOse,KAIxBb,EAAoBa,GACpBX,EAAY9b,GAAQA,EAAO,GAC3B7K,EAAO8Y,KAAK,8CAA+C,CAAEwO,gBAG7DD,EAAiBC,GAAaW,KAAK,KACjCxN,EAAM8B,QAAQ,mBACdvc,EAAO8Y,KAAK,kCACXkP,MAAM/hB,IACPjG,EAAOiG,MAAM,+BAAgCA,GAC7CwU,EAAMxU,MAAM,qBAEb,CAACohB,IAGE5e,EAAiB3B,cAAY,KACjC2f,EAAoB9e,IAGpB0f,EAAiB1f,IAA2BqgB,MAAM/hB,IAChDwU,EAAMxU,MAAM,qBACZjG,EAAOiG,MAAM,gCAAiCA,KAGhDwU,EAAM8B,QAAQ,2BACb,CAAC8K,IAOJ,OAJAlhB,YAAU,KACRygB,KACC,CAACA,IAEG,CACLre,mBACAuf,eACAtf,sBACAC,iBACA7C,YACAK,UD5H4FiiB,GAGxFC,EAAmBnhB,UAAQ,MAC1BuB,GACEQ,OAAOC,OAAOT,GAAkBjI,KAAKge,IAAYA,GACvD,CAAC/V,IAGJpC,YAAU,KACRnG,EAAO8Y,KAAK,yCAA0C,CAAEvQ,sBACvD,CAACA,IAEJ,MAAMoQ,EAAmBvZ,MAAMC,QAAQH,GAAaI,eAChDJ,EAAYI,cAAcC,IAAKf,GAAcA,EAAEgB,QACT,iBAA/BN,GAAaI,cACpBJ,EAAYI,cAAcG,MAAM,KAAKF,IAAKf,GAAcA,EAAEgB,QAC1D,GAEE4oB,EAAkBlpB,GAAakB,MAAQ,MAGtCioB,EAAgBC,GAAqBxiB,WAAS,IAG9CyiB,EAAiBC,GAAsB1iB,WAAS,CACrDpE,QAAS,EACT/B,SAAU,EACViC,QAAS,EACTC,KAAM,IAIF4mB,EAAgB3hB,cAAY6Q,UAChC3X,EAAOC,MAAM,kCACbqoB,EAAkBzd,GAAQA,EAAO,IAChC,IAGG6d,EAA2B5hB,cAAY,CAACkX,EAAoB2K,KAChEC,EAAuB5K,EAAY2K,IAClC,IAEGE,EAAUlQ,GAAkB7Y,SAAS,aAGrCgpB,EAAW9hB,UAAQ,KAAM+hB,ODvDL1L,ECuDiB1E,IDtDZ,IAAjB0E,EAAM1b,OAGhB0b,EAAMvd,SAAS,cAAgBud,EAAMvd,SAAS,OAAe,EAG7Dud,EAAMvd,SAAS,uBACfud,EAAMvd,SAAS,yBACfud,EAAMvd,SAAS,qBAGfud,EAAMvd,SAAS,kBAH4B,EAKxC,EAbkC,EADpC,IAAqBud,GCuDoC,CAAC1E,IAGzDqQ,EAAuBhiB,UAAQ,KACnC,IAAKohB,EACH,MAAO,CAAE1mB,QAAS,MAAO/B,SAAU,MAAOiC,QAAS,MAAOC,KAAM,OAIlE,MAAMd,EAAY4X,EAAiB7Y,SAAS,MACtCmpB,EAAyBtQ,EAAiB7Y,SAAS,oBACnDO,EAAiBsY,EAAiBrY,KAAMC,GAC5C,CAAC,YAAa,MAAO,aAAc,eAAgB,uBAAwB,qBAAsB,mBAAoB,MAAMT,SAASS,IAGtI,MAAO,CACLmB,QAAsB,IAAbonB,EAAiB,MAAQV,EAClCzoB,SAAUU,GAAuC,IAAbyoB,EAAT,MAAkCV,EAC7DxmB,QAAUb,GAAakoB,GAAgD,IAAbH,EAAT,MAAkCV,EACnFvmB,KAAM,QAEP,CAACumB,EAAiBU,EAAUnQ,IAazBuQ,GAVgB,MACpB,MACMjqB,EADe,IAAIkqB,gBAAgBtD,EAASuD,QACzBC,IAAI,OAC7B,OAAIpqB,GAAO,CAAC,UAAW,WAAY,UAAW,QAAQa,SAASb,GACtDA,EAEF,WAIUqqB,IACZ/b,GAAWgc,IAAgBzjB,WAASojB,KACpCM,GAAkBC,IAAuB3jB,WAAiB,IACxDkjB,EAAqBE,KAAoD,QAE3EQ,GAAWC,IAAmBC,kBAGZ5iB,UAAQ,IACxBoe,GAA2BpmB,EAAW2Z,GAC5C,CAAC3Z,EAAW2Z,IAIfxS,YAAU,KACR,MACMlH,EADe,IAAIkqB,gBAAgBtD,EAASuD,QACzBC,IAAI,OACzBpqB,GAAO,CAAC,UAAW,WAAY,UAAW,QAAQa,SAASb,KAC7DsqB,GAAatqB,GAEbwqB,GAAoBT,EAAqB/pB,IAA6C,SAEvF,CAAC4mB,EAASuD,OAAQJ,IAGrB7iB,YAAU,KACqBwR,WAE3B,IAAKkS,MAAmBnkB,EAAoBjE,aAAc,CACxDzB,EAAO8Y,KAAK,iDAAkD,CAC5D+Q,aAAcA,IACdC,UAAWpkB,EAAoBjE,aAC/B6E,UAAWZ,EAAoBY,YAGjC,UACQyjB,EAAoB7qB,GAAaqI,IACvCvH,EAAO8Y,KAAK,mCACd,OAAS7S,GACPjG,EAAOiG,MAAM,oCAAqCA,EACpD,CACF,GAGF+jB,IACC,CAAC9qB,GAAaqI,KAGjBpB,YAAU,KACkBwR,WACxB,IAEE,MAAQuC,KAAM+P,SAAoB1Q,EAC/Bc,KAAK,aACLC,OAAO,QAEV,GAAI2P,EAAW,CACb,MAAMC,EAAgB,IAAI,IAAIC,IAAIF,EAAU1qB,IAAK8P,GAAWA,EAAEjP,MAAMV,OAAOuJ,WAC3Emd,EAAsB8D,EACxB,CAGA,MAAQhQ,KAAMkQ,SAAkB7Q,EAC7Bc,KAAK,WACLC,OAAO,eAEV,GAAI8P,EAAS,CACX,MAAMC,EAAc,IAAI,IAAIF,IAAIC,EAAQ7qB,IAAKmF,GAAWA,EAAEnC,aAAa7C,OAAOuJ,WAC9Eod,EAAoBgE,EACtB,CAGA,MAAQnQ,KAAMoQ,SAAmB/Q,EAC9Bc,KAAK,mBACLC,OAAO,gBAEV,GAAIgQ,EAAU,CACZ,MAAMC,EAAe,IAAI,IAAIJ,IAAIG,EAAS/qB,IAAKirB,GAAWA,EAAEhoB,cAAc9C,OAAOuJ,WACjFqd,EAAqBiE,EACvB,CAGA,MAAQrQ,KAAMuQ,SAAoBlR,EAC/Bc,KAAK,WACLC,OAAO,2BAEV,GAAImQ,EAAW,CACb,MAAMC,EAAgB,IAAI,IAAIP,IAAIM,EAAUlrB,IAAKorB,GAAWA,EAAE1P,yBAAyBvb,OAAOuJ,WAC9Fsd,EAA6BmE,EAC/B,CACF,OAASzkB,GACPjG,EAAOiG,MAAM,kBAAmBA,EAClC,GAGF2kB,IACC,CAACrR,IAImBzS,cAAanH,GAC9BA,EAASqB,YACJyI,MAAC,QAAKnB,UAAU,sCAAsCkB,SAAA,SACjB,aAAnC7J,EAASC,uBAA0E,aAAlCD,EAASE,qBAC5D4J,MAAC,QAAKnB,UAAU,qCAAqCkB,SAAA,SAChB,aAAnC7J,EAASC,uBAA0E,aAAlCD,EAASE,qBAC5D4J,MAAC,QAAKnB,UAAU,oCAAoCkB,SAAA,OAEpDC,MAAC,QAAKnB,UAAU,uCAAuCkB,SAAA,SAE/D,IAsCmB1C,cAAY,CAACnH,EAAoBwB,KACrD,OAAQA,GACN,IAAK,wBACH,OAAOxB,EAASO,sBAClB,IAAK,mBACH,OAAOP,EAASI,iBAClB,IAAK,iBACH,OAAOJ,EAASQ,eAClB,IAAK,cACH,OAAOR,EAAS4C,YAClB,IAAK,eAqBL,IAAK,mBAEH,MAAO,IApBT,IAAK,YACH,OAAO5C,EAAS8C,yBAAyB,IAAIE,WAAa,GAC5D,IAAK,gBACH,OAAOhD,EAAS8C,yBAAyB,IAAIM,eAAiB,GAChE,IAAK,WACH,OAAOpD,EAAS8C,yBAAyB,IAAI2I,UAAY,EAC3D,IAAK,mBACH,OAAOzL,EAAS8C,yBAAyB,IAAI2V,kBAAoB,EACnE,IAAK,eACH,OAAOzY,EAASuN,aAClB,IAAK,SACH,OAAOvN,EAAS8C,yBAAyB,IAAI8I,QAAU,GACzD,IAAK,iBACH,OAAO5L,EAAS8L,eAClB,IAAK,eACH,OAAO9L,EAAS+L,aAClB,IAAK,qBACH,OAAO/L,EAASgM,mBAIlB,IAAK,uBAEH,OAAOhM,EAASe,qBAAuB,KAAO,KAChD,IAAK,cAEH,OAAOf,EAASqB,YAAc,KAAO,KACvC,IAAK,wBACH,OAAOrB,EAASyB,sBAAwB,KAAO,KACjD,IAAK,iBACH,OAAOzB,EAAS0B,eAAiB,KAAO,KAC1C,IAAK,eACH,OAAO1B,EAASkF,aAClB,IAAK,wBACH,OAAOlF,EAASuL,sBAClB,IAAK,uBACH,OAAOvL,EAASkrB,qBAClB,IAAK,cACH,OAAOlrB,EAASmrB,YAClB,IAAK,aACH,OAAOnrB,EAASorB,WAClB,IAAK,wBACH,OAAOprB,EAAS8C,yBAAyB,IAAIuoB,yBAA2B,KAC1E,QACE,OAAO,OAEV,IAG0BlkB,cAAY,CAACrD,EAAiBF,EAAmB0nB,EAAkBC,KAC9F,GAAIznB,QACF,MAAqB,aAAdF,EAIT,GAAoB,eAAhB2nB,GAAgCD,GAAsC,iBAAhBA,GAA4BA,EAAYnrB,SAAS,KAAM,CAC/G,IAAK2D,EAAY,OAAO,EAExB,MAAOC,EAAWC,GAAWsnB,EAAYxrB,MAAM,KACzC0rB,EAAY,IAAItnB,KAAKJ,GACrBuL,EAAQ,IAAInL,KAAKH,GACjBwL,EAAM,IAAIrL,KAAKF,GAGrB,OAAOwnB,GAAanc,GAASmc,GAAajc,CAC5C,CAGA,GAAoB,eAAhBgc,GAAgCD,GAAsC,iBAAhBA,GAA4BA,EAAYnrB,SAAS,KAAM,CAC/G,IAAK2D,EAAY,OAAO,EAExB,MAAOO,EAAYC,GAAYgnB,EAAYxrB,MAAM,KAC3C0rB,EAAY,IAAItnB,KAAKJ,GACrBuL,EAAQ,IAAInL,KAAK,GAAGG,QACpBkL,EAAM,IAAIrL,KAAK,GAAGI,QAGlBmnB,EAAa,IAAIvnB,KAAKqL,EAAI2U,cAAe3U,EAAI6U,WAAa,EAAG,EAAG,GAAI,GAAI,IAC9E,OAAOoH,GAAanc,GAASmc,GAAaC,CAC5C,CAGA,GAAIF,IAAgC,eAAhBA,GAAgCA,EAAY7mB,SAAS,WAAY,CACnF,IAAK4mB,EAAa,OAAO,EAEzB,MAAME,EAAY,IAAItnB,KAAKJ,IACpB4nB,EAAYC,GAAeL,EAAYxrB,MAAM,KAEpD,OAAO0rB,EAAUtH,gBAAkB0H,SAASF,IACpCF,EAAUpH,WAAa,IAAOwH,SAASD,EACjD,CAEA,MAAME,EAAWtoB,OAAOO,GAAYnB,cAC9BmpB,EAAYvoB,OAAO+nB,GAAa3oB,cAEtC,OAAQiB,GACN,IAAK,WACH,OAAOioB,EAAS1rB,SAAS2rB,GAC3B,IAAK,SAEH,GAAoB,eAAhBP,GAAgCD,EAAYlnB,MAAM,+BAAgC,CACpF,IAAKN,EAAY,OAAO,EACxB,IACE,MAAM0nB,EAAY,IAAItnB,KAAKJ,GAAYK,cAAcrE,MAAM,KAAK,GAEhE,OAAO0rB,IADYF,EAAYxrB,MAAM,KAAK,EAE5C,OAASwG,GAEP,OADAjG,EAAOiG,MAAM,YAAaA,IACnB,CACT,CACF,CACA,OAAOulB,IAAaC,EACtB,IAAK,cACH,OAAOD,EAASpnB,WAAWqnB,GAC7B,IAAK,YACH,OAAOD,EAASnnB,SAASonB,GAC3B,IAAK,WACH,OAAQhoB,GAAkC,KAApB+nB,EAAShsB,OACjC,IAAK,eACH,QAASiE,GAAkC,KAApB+nB,EAAShsB,OAClC,IAAK,eACH,OAAO8E,OAAOb,GAAca,OAAO2mB,GACrC,IAAK,YACH,OAAO3mB,OAAOb,GAAca,OAAO2mB,GACrC,IAAK,UASL,QACE,OAAO,EAPT,IAAK,QACH,OAAO,IAAIpnB,KAAKJ,GAAc,IAAII,KAAKonB,GACzC,IAAK,SACH,OAAO,IAAIpnB,KAAKJ,GAAc,IAAII,KAAKonB,GACzC,IAAK,aACH,OAAOO,IAAaC,IAIvB,IAIH,MAcMC,GAdwB1kB,UAAQ,IAG7BH,EAAqB,CAC1B5H,IAAKsO,GACLtL,aAJwC,QAArBunB,IAAmD,OAArBA,GAA4B,KAAOA,GAKpFpnB,aACAgB,gBAAiBkc,EACjBva,WAAYA,EAAa,CAAEjH,IAAKiH,EAAW5D,MAAOmE,UAAWP,EAAWO,gBAAc,IAEvF,CAACuB,EAAsB0G,GAAWic,GAAkBpnB,EAAYkd,EAAeva,EAAY/F,IAQ9FmH,YAAU,KAER,GAAInH,GAAaA,EAAU2C,OAAS,EAAG,CACrC,MAAMgqB,EAAYnqB,GAAmBxC,EAAWE,GAChDspB,EAAmBmD,EACrB,SAAWjmB,EAAoBjE,cAAgBiE,EAAoBjE,aAAaE,OAAS,EAAG,CAE1F,MAAMgqB,EAAYnqB,GAAmBkE,EAAoBjE,aAAcvC,GACvEspB,EAAmBmD,EACrB,GACC,CAAC3sB,EAAWE,IAGf,MAAM0sB,GAAoBrD,EAGpBsD,GAAkB/kB,cAAaglB,IAEnC,GAAe,SAAXA,EAAmB,CAIrB,OAF2BxM,EAAc3d,OAAS,EAIzC+pB,GAAqB/pB,OAAOoqB,WAG5B,IAEX,CAGA,OAAOH,GAAkBE,GAA0CC,YAClE,CAACzM,EAAc3d,OAAQ+pB,GAAqB/pB,OAAQiqB,KAIjDI,GAAuBhlB,UAAQ,KAEnC,MAAMilB,EAAe3M,EAAc5f,OAAOA,GACvB,eAAjBA,EAAOyB,OACW,eAAjBzB,EAAOyB,OAA0BzB,EAAO8D,WAAa9D,EAAO8D,UAAU1D,SAAS,WAGlF,GAA4B,IAAxBmsB,EAAatqB,OAAc,OAAO,KAEtC,MACMspB,EADcgB,EAAa,GACD1qB,MAGhC,GAAI0pB,GAAsC,iBAAhBA,GAA4BA,EAAYnrB,SAAS,KAAM,CAE/E,MAAOkE,EAAYC,GAAYgnB,EAAYxrB,MAAM,KAC3CiE,EAAY,IAAIG,KAAK,GAAGG,QACxBL,EAAU,IAAIE,KAAK,GAAGI,QAEtBioB,EAAgB,GACtB,IAAIC,EAAW,EAGf,MAAMC,EAAc,IAAIvoB,KAAKH,GAC7B,KAAO0oB,GAAezoB,GAAS,CAC7B,MAAM+f,EAAO0I,EAAYvI,cACnBF,EAAQyI,EAAYrI,WAAa,EACjCsI,EAAW,GAAG3I,KAAQC,EAAMoI,WAAWO,SAAS,EAAG,OAGnDC,EAAYb,GAAqBhsB,OAAOC,IAC5C,MAAMiE,EAAe,IAAIC,KAAKlE,EAASkF,cACvC,OAAOjB,EAAaigB,gBAAkBH,GAC9B9f,EAAamgB,WAAa,IAAOJ,IAIrC6I,EAAaD,EAAU3kB,OAAO,CAAC6kB,EAAK9sB,KAExC,GAAIA,EAAS8C,wBAAwBd,OAAQ,CAI3C,OAAO8qB,EAHY9sB,EAAS8C,uBAAuBmF,OAAO,CAAC8kB,EAAiBhqB,IACnEgqB,GAAWhqB,EAAKuK,cAAgB,GACtC,EAEL,CACA,OAAOwf,GAAO9sB,EAASuN,cAAgB,IACtC,GAEHgf,EAAcrH,KAAK,CACjBnB,OACAC,QACA0I,WACAnlB,MAAOslB,EACPG,MAAOJ,EAAU5qB,SAGnBwqB,GAAYK,EAGZJ,EAAYQ,SAASR,EAAYrI,WAAa,EAChD,CAEA,MAAO,CACLzM,KAAM,QACNuV,OAAQX,EACRY,WAAYX,EAEhB,CAAO,CAEL,MAAOzI,EAAMC,IAAiC,iBAAhBsH,EAA2BA,EAAc,IAAIxrB,MAAM,KAC3E8sB,EAAYb,GAAqBhsB,OAAOC,IAC5C,MAAMiE,EAAe,IAAIC,KAAKlE,EAASkF,cACvC,OAAOjB,EAAaigB,gBAAkB0H,SAAS7H,IACvC9f,EAAamgB,WAAa,IAAOwH,SAAS5H,KAG9C6I,EAAaD,EAAU3kB,OAAO,CAAC6kB,EAAK9sB,KAExC,GAAIA,EAAS8C,wBAAwBd,OAAQ,CAI3C,OAAO8qB,EAHY9sB,EAAS8C,uBAAuBmF,OAAO,CAAC8kB,EAAiBhqB,IACnEgqB,GAAWhqB,EAAKuK,cAAgB,GACtC,EAEL,CACA,OAAOwf,GAAO9sB,EAASuN,cAAgB,IACtC,GAEH,MAAO,CACLoK,KAAM,SACNoM,KAAM6H,SAAS7H,GACfC,MAAO4H,SAAS5H,GAChBzc,MAAOslB,EACPG,MAAOJ,EAAU5qB,OAErB,GACC,CAAC2d,EAAeoM,KA0BbqB,GAAwBjmB,cAAY6Q,MAAOqG,IAC/C,IACE,MAAMgP,GAAA,IAAkBnpB,MAAOC,eAGxBmpB,EAAeC,SAAqBC,QAAQC,IAAI,CACrD7T,EACGc,KAAK,qBACLoC,OAAO,CACNzb,aAAa,EACb8pB,YAAakC,IAEdzS,GAAG,KAAMyD,GACZzE,EACGc,KAAK,0BACLoC,OAAO,CACNzb,aAAa,EACbqsB,gBAAiB,aAElB9S,GAAG,sBAAuByD,KAG/B,GAAIiP,EAAchnB,MAAO,MAAMgnB,EAAchnB,MAC7C,GAAIinB,EAAYjnB,MAAO,MAAMinB,EAAYjnB,MAGnBqnB,EAAuBtP,IAE3Che,EAAO6c,KAAK,yCAA0C,CAAEmB,eAG1DvD,EAAM8B,QAAQ,uBACRkM,GACR,OAASxiB,GACPwU,EAAMxU,MAAM,mBACd,GACC,CAACsT,EAAUkP,IAER8E,GAAwBzmB,cAAY6Q,MAAOqG,IAC/C,IACE,MAAMgP,GAAA,IAAkBnpB,MAAOC,eAGxBmpB,EAAeC,SAAqBC,QAAQC,IAAI,CACrD7T,EACGc,KAAK,qBACLoC,OAAO,CACN/b,sBAAsB,EACtBmqB,qBAAsBmC,IAEvBzS,GAAG,KAAMyD,GACZzE,EACGc,KAAK,0BACLoC,OAAO,CACN/b,sBAAsB,EACtBmqB,qBAAsBmC,IAEvBzS,GAAG,sBAAuByD,KAG/B,GAAIiP,EAAchnB,MAAO,MAAMgnB,EAAchnB,MAC7C,GAAIinB,EAAYjnB,MAAO,MAAMinB,EAAYjnB,MAGnBunB,EAA+BxP,KAEnDhe,EAAO6c,KAAK,6CAA8C,CAAEmB,qBACtDyK,KAGRhO,EAAM8B,QAAQ,gBAChB,OAAStW,GACPjG,EAAOiG,MAAM,iCAAkCA,GAC/CwU,EAAMxU,MAAM,mBACd,GACC,CAACsT,EAAUkP,IAEW3hB,cAAanH,IACpCqmB,EAAoBrmB,GACpBuZ,GAAe,IACd,IAGH,MAAMuU,GAAoBzmB,UAAQ,IAC3B+e,EACE,IACFA,EACHxjB,YAAawjB,EAAiBxjB,aAAe,GAC7CkJ,eAAgBsa,EAAiBta,gBAAkB,GACnDE,mBAAoBoa,EAAiBpa,oBAAsB,GAC3DD,aAAcqa,EAAiBra,cAAgB,IANnB,KAQ7B,CAACqa,IAEJ,SACE3c,KAAC,OAAId,UAAU,SAEbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,OACbkB,SAAAJ,OAAC,OACCI,SAAA,CAAAC,MAAC,MAAGnB,UAAU,aAAakB,SAAA,YAC3BC,MAAC,KAAEnB,UAAU,gBAAgB+E,MAAO,CAACqgB,UAAU,OAAOC,aAAa,QAASnkB,SAAA,+BAKhFC,IAAC,OAAInB,UAAU,OACbkB,SAAAC,MAAC4V,GAAA,CACCC,gBACAva,aACA3C,aACAmd,gBAAiB0G,EACjBzG,aAAc0G,EACdzG,eAAgB0G,EAChBzG,qBACAC,mBACAC,oBACAC,4BAGArW,SAAAC,MAACtB,GAAA,CACCE,WAAW,EACXE,mBACAC,sBACAC,iBACA7C,UAAW4gB,UAOjBpd,KAAC,OAAId,UAAU,YAGbkB,SAAA,CAAAC,MAAC,OAAInB,UAAU,2HACZkB,SAAAic,GAASlmB,IAAKN,GACbmK,OAAC,UAECgB,QAAS,KAEPuf,GAAgB,KACdJ,GAAatqB,EAAInB,KAEjB2rB,GAAoBT,EAAqB/pB,EAAInB,MAA6C,UAG9FwK,UAAW,2IACTiF,KAActO,EAAInB,IACd,2DACA,sEAGN0L,SAAA,CAAAC,MAAC,QAAKnB,UAAU,oBAAqBkB,SAAAvK,EAAIuI,QACzCiC,MAAC,QACCnB,UACE,gBACEiF,KAActO,EAAInB,IACd,6BACA,6BAIP0L,SAAAqiB,GAAgB5sB,EAAInB,SAzBlBmB,EAAInB,QAgCdkuB,MACCviB,IAAC,OAAInB,UAAU,OACZkB,SAA8B,cAAT8N,OAEpBlO,KAAC,OAAId,UAAU,6IACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,4BACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,2CACfc,KAAC,QAAKd,UAAU,8BACbkB,SAAA,CAAAwiB,GAAqBtI,KAAK,KAAGsI,GAAqBrI,MAAM,SAE3Dva,KAAC,QAAKd,UAAU,2BACbkB,SAAA,CAAAwiB,GAAqBW,MAAM,YAGhCljB,IAAC,OAAInB,UAAU,2BACfc,KAAC,QAAKd,UAAU,0CAA0CkB,SAAA,KACtDwiB,GAAqB9kB,OAAOiG,kBAAoB,YAKtD/D,KAACwkB,GAAA,CAAKtlB,UAAU,wDACdkB,SAAA,CAAAC,MAACokB,IAAWvlB,UAAU,iBACpBkB,SAAAJ,OAAC,OAAId,UAAU,0BACbkB,SAAA,GAAAJ,KAAC,OAAId,UAAU,0BACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,yCACfmB,MAACqkB,GAAA,CAAUxlB,UAAU,8BAA8BkB,SAAA,oBAGrDJ,KAAC,OAAId,UAAU,0BACbkB,SAAA,GAAAJ,KAAC,QAAKd,UAAU,2BAA2BkB,SAAA,KACvCwiB,GAAqBa,QAAQjlB,OAAO,CAAC6kB,EAAKsB,IAAMtB,EAAMsB,EAAEpB,MAAO,IAAM,EAAE,UAE3EljB,IAAC,OAAInB,UAAU,2BACfc,KAAC,QAAKd,UAAU,sCAAsCkB,SAAA,KAClDwiB,GAAqBc,YAAY3f,kBAAoB,iBAK/D1D,IAACukB,GAAA,CAAY1lB,UAAU,YAErBkB,SAAAC,MAAC,OAAInB,UAAU,kCACZkB,SAAAwiB,GAAqBa,QAAQttB,IAAKgtB,GACjC9iB,MAAC,OAECnB,UAAU,yIAEVkB,SAAAJ,OAAC,OAAId,UAAU,8BACbkB,SAAA,GAAAJ,KAAC,QAAKd,UAAU,wDACbkB,SAAA,CAAA+iB,EAAU5I,MAAM,SAEnBva,KAAC,QAAKd,UAAU,6CAA6CkB,SAAA,KACzD+iB,EAAUI,MAAM,SAEpBvjB,KAAC,QAAKd,UAAU,6DAA6DkB,SAAA,KACzE+iB,EAAUrlB,MAAMiG,wBAXjBof,EAAUF,0BAwB9BuB,GAAA,CAAKtlB,UAAW,2CAA0C6f,EAAmB,QAAU,IACtF3e,SAAAC,MAACukB,GAAA,CAAY1lB,UAAU,MACpBkB,SAAAzD,EACCqD,OAAC,OAAId,UAAU,yCACbkB,SAAA,GAAAC,IAAC,OAAInB,UAAU,qFACfmB,MAAC,QAAKnB,UAAU,qBAAqBkB,SAAA,eAEL,IAAhCkiB,GAAqB/pB,OACvByH,OAAC,OAAId,UAAU,oBACbkB,SAAA,GAAAC,IAACuV,GAAA,CAAQ1W,UAAU,yCACnBmB,MAAC,MAAGnB,UAAU,2CAA2CkB,SAAA,gBACzDC,MAAC,KAAEnB,UAAU,gBAAgBkB,SAAA,0BAG/BC,MAACiP,GAAA,CACC1Z,UAAW0sB,GACXne,aACAoL,mBACAC,UAAW6P,EACX5P,mBAAoB6P,EACpBhb,kBAAmB6f,GACnB5f,kBAAmBof,GACnBxkB,4BAQTklB,IACChkB,MAACwkB,WAAA,CAASC,SAAUzkB,MAAC,OAAInB,UAAU,kEAAkEkB,SAAAC,MAAC,OAAInB,UAAU,gEAClHkB,SAAAC,MAAC4b,GAAA,CACCzc,OAAQqQ,EACRwF,QAAS,KACPvF,GAAe,GACf8M,EAAoB,OAEtBrmB,SAAU8tB,GACV5E,QAASA,IAAW,EACpBsF,SAAU1F,EACVlb,mBAMZ","names":["Building","createLucideIcon","d","key","x","y","width","height","rx","EyeOff","Settings","cx","cy","r","SlidersVertical","x1","x2","y1","y2","HIDDEN_EMPLOYEES","filterByTab","purchases","tab","currentUser","userRoles","Array","isArray","purchase_role","map","trim","split","filter","purchase","middle_manager_status","final_manager_status","includes","payment_category","logger","debug","purchase_order_number","requester_name","name","hasManagerRole","some","role","isRequest","notPaid","is_payment_completed","isSeonJin","progress_type","isIlban","finalApproved","hasHrRole","is_received","isRequester","getFieldValue","field","is_statement_received","is_utk_checked","keys","value","calculateTabCounts","allPurchases","pending","length","receipt","done","applyAllFilters","options","filtered","employeeName","requestorName","filterByEmployee","searchTerm","term","toLowerCase","vendor_name","contact_name","purchase_request_items","item","item_name","item_detail","manufacturer","model","specification","spec","flat","String","filterBySearchTerm","advancedFilters","filters","every","condition","dateField","fieldValue","startDate","endDate","purchaseDate","Date","toISOString","match","startMonth","endMonth","purchaseMonth","slice","startsWith","endsWith","Number","min","max","numValue","v","applyAdvancedFilters","requestDate","request_date","filterByDateRange","sortConfig","sort","a","b","aValue","bValue","comparison","direction","sortPurchases","usePurchaseMemory","initialPurchases","purchaseMemoryCache","initialLoading","isLoading","setPurchases","useState","loading","setLoading","error","setError","useEffect","lastArrayRef","lastFetchTime","lastFetch","checkCache","arrayChanged","fetchTimeChanged","interval","setInterval","clearInterval","getFilteredPurchases","useCallback","tabCounts","useMemo","stats","total","loaded","loadedCount","memoryUsage","DONE_TAB_COLUMNS","id","label","description","defaultVisible","DEFAULT_COLUMN_VISIBILITY","reduce","acc","column","REQUIRED_COLUMNS","COLUMN_GROUPS","title","columns","ColumnSettingsDropdown","memo","isVisible","className","columnVisibility","applyColumnSettings","resetToDefault","tempVisibility","setTempVisibility","isOpen","setIsOpen","visibleColumnCount","Object","values","Boolean","totalColumnCount","tempVisibleCount","jsxs","DropdownMenu","open","onOpenChange","children","jsx","DropdownMenuTrigger","asChild","Button","variant","size","disabled","DropdownMenuContent","align","onInteractOutside","DropdownMenuLabel","onClick","RotateCcw","DropdownMenuSeparator","group","groupIndex","React","Fragment","columnId","isRequired","prev","handleColumnToggle","Eye","statement_progress","utk_status","delivery_request_date","revised_delivery_date","quantity","unit_price","amount","remark","link","project_vendor","project_item","sales_order_number","purchase_progress","receipt_progress","Check","X","displayName","StatusBadge","status","text","completed","inProgress","rejected","MobilePurchaseCard","receiptProgress","received","percentage","actual_received_date","Math","round","getReceiptProgress","isAdvance","formatDateShort","amount_value","total_amount","toLocaleString","currency","style","VirtualScrollTable","activeTab","onRowClick","isLeadBuyer","onPaymentComplete","onReceiptComplete","onExcelDownload","vendorColumnWidth","tableHeader","TableRowComponent","shouldUseFitLayout","containerRef","useRef","scrollTop","setScrollTop","containerHeight","setContainerHeight","dynamicHeight","setDynamicHeight","startIndex","endIndex","visibleItems","totalHeight","itemCount","visibleCount","ceil","start","floor","end","actualStart","handleScroll","e","adjustedScrollTop","currentTarget","calculateDynamicHeight","windowHeight","window","innerHeight","calculatedHeight","updateHeight","current","rect","getBoundingClientRect","timer","setTimeout","handleResize","addEventListener","clearTimeout","removeEventListener","ref","overflow","position","onScroll","top","zIndex","backgroundColor","borderBottom","transform","left","right","index","ROOT_NAME","createAlertDialogContext","createAlertDialogScope","createContextScope","createDialogScope","useDialogScope","AlertDialog","props","__scopeAlertDialog","alertDialogProps","dialogScope","DialogPrimitive.Root","modal","React.forwardRef","forwardedRef","triggerProps","DialogPrimitive.Trigger","AlertDialogPortal","portalProps","DialogPrimitive.Portal","AlertDialogOverlay","overlayProps","DialogPrimitive.Overlay","CONTENT_NAME","AlertDialogContentProvider","useAlertDialogContentContext","Slottable","createSlottable","AlertDialogContent","contentProps","contentRef","React.useRef","composedRefs","useComposedRefs","cancelRef","DialogPrimitive.WarningProvider","contentName","titleName","TITLE_NAME","docsSlug","scope","DialogPrimitive.Content","onOpenAutoFocus","composeEventHandlers","event","preventDefault","focus","preventScroll","onPointerDownOutside","DescriptionWarning","AlertDialogTitle","titleProps","DialogPrimitive.Title","DESCRIPTION_NAME","AlertDialogDescription","descriptionProps","DialogPrimitive.Description","AlertDialogAction","actionProps","DialogPrimitive.Close","CANCEL_NAME","AlertDialogCancel","cancelProps","MESSAGE","React.useEffect","document","getElementById","getAttribute","Overlay2","Content2","Action","Cancel","Title2","Description2","AlertDialogPrimitive.Overlay","cn","AlertDialogPrimitive.Content","AlertDialogHeader","AlertDialogFooter","AlertDialogPrimitive.Title","AlertDialogPrimitive.Description","AlertDialogPrimitive.Action","buttonVariants","AlertDialogPrimitive.Cancel","getCurrencySymbol","COMMON_COLUMN_CLASSES","ApprovalStatusBadge","memoryPurchase","find","p","middleApproved","middleRejected","finalRejected","PaymentProgressBar","ReceiptProgressBar","StatementProgressBar","currentPurchase","statementProgress","items","type","TableRow","src","alt","is_po_download","async","stopPropagation","pointerEvents","minWidth","maxWidth","revised_delivery_request_date","receivedQuantity","received_quantity","hasReceived","unit_price_value","unit_price_currency","amount_currency","href","target","rel","FastPurchaseTable","currentUserRoles","onRefresh","onOptimisticUpdate","info","selectedPurchaseId","setSelectedPurchaseId","isModalOpen","setIsModalOpen","deleteConfirmOpen","setDeleteConfirmOpen","purchaseToDelete","setPurchaseToDelete","supabase","createClient","maxLength","sampleSize","forEach","adjustedLength","char","test","handleRowClick","handleCloseModal","handleExcelDownload","data","purchaseRequest","requestError","from","select","eq","single","toast","orderItems","itemsError","order","vendorInfo","vendor_phone","vendor_fax","vendor_contact_name","vendor_payment_schedule","vendorId","vendor_id","contactId","contact_id","vendorData","contactData","excelData","line_number","blob","generatePurchaseOrderExcelJS","downloadFilename","url","URL","createObjectURL","createElement","download","body","appendChild","click","removeChild","revokeObjectURL","success","downloadFlagErr","update","flagErr","handleConfirmDelete","supabaseUrl","warn","user","authError","auth","getUser","employee","empError","email","roles","canEdit","isApproved","deletedItems","delete","code","message","details","hint","deletedRequest","removePurchaseFromMemory","purchaseId","errorObj","stack","isColumnVisible","baseHeaders","additionalHeaders","visible","shouldUseVirtualScroll","PurchaseDetailModal","onClose","onDelete","FILTER_FIELDS","icon","Calendar","category","User","Package","DollarSign","CheckCircle","DATE_FIELDS","SORT_FIELDS","FilterToolbar","activeFilters","onFiltersChange","onSortChange","onSearchChange","availableEmployees","availableVendors","availableContacts","availablePaymentSchedules","isFilterOpen","setIsFilterOpen","isSortOpen","setIsSortOpen","isSearchExpanded","setIsSearchExpanded","newFilter","setNewFilter","datePickerOpen","setDatePickerOpen","monthPickerOpen","setMonthPickerOpen","tempDateRange","setTempDateRange","tempMonth","setTempMonth","tempMonthRange","setTempMonthRange","tempSort","setTempSort","searchValue","setSearchValue","searchInputRef","handleRemoveFilter","filterId","f","renderValueInput","fieldConfig","Input","placeholder","onChange","padding","fontSize","fontWeight","filteredOptions","option","Popover","PopoverTrigger","Search","PopoverContent","autoFocus","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","scheduleOptions","to","format","CalendarComponent","mode","selected","onSelect","range","numberOfMonths","initialFocus","rangeValue","startYear","endYear","year","month","currentYear","getFullYear","newDate","getMonth","_","i","monthDate","isSelected","isDisabled","Sliders","df","defaultCondition","now","scrollbarWidth","scrollbarColor","WebkitScrollbarWidth","entries","push","fields","isDateFilter","requiresDateField","finalCondition","ArrowUpDown","MANAGER_ROLES","filterByEmployeeVisibility","PurchaseItemsModal","lazy","import","__VITE_PRELOAD__","NAV_TABS","PurchaseListMain","showEmailButton","useNavigate","location","useLocation","selectedPurchase","setSelectedPurchase","setActiveFilters","setSortConfig","setSearchTerm","setAvailableEmployees","setAvailableVendors","setAvailableContacts","setAvailablePaymentSchedules","isColumnLoading","setColumnVisibility","setIsLoading","forceUpdate","loadUserSettings","settings","settingsError","maybeSingle","userEmail","setting_value","savedSettings","mergedSettings","settingsCount","saveUserSettings","newSettings","upsertError","upsert","user_email","setting_type","setting_key","onConflict","visibleColumns","toggleColumn","prevSettings","catch","then","useColumnSettings","hasHiddenColumns","currentUserName","refreshTrigger","setRefreshTrigger","cachedTabCounts","setCachedTabCounts","loadPurchases","updatePurchaseOptimistic","updater","updatePurchaseInMemory","isAdmin","roleCase","getRoleCase","defaultEmployeeByTab","hasPurchaseManagerRole","initialTab","URLSearchParams","search","get","getInitialTab","setActiveTab","selectedEmployee","setSelectedEmployee","isPending","startTransition","useTransition","isCacheValid","hasData","loadAllPurchaseData","checkAndRefreshCache","employees","employeeNames","Set","vendors","vendorNames","contacts","contactNames","c","schedules","scheduleNames","s","loadFilterOptions","payment_completed_at","received_at","created_at","statement_received_date","filterValue","filterField","fieldDate","endOfMonth","filterYear","filterMonth","parseInt","fieldStr","filterStr","tabFilteredPurchases","newCounts","filteredTabCounts","getTabBadgeText","tabKey","toString","monthlyFilterSummary","monthFilters","monthlyTotals","totalSum","currentDate","monthStr","padStart","monthData","monthTotal","sum","itemSum","count","setMonth","months","grandTotal","handleReceiptComplete","currentTime","requestResult","itemsResult","Promise","all","delivery_status","markPurchaseAsReceived","handlePaymentComplete","markPurchaseAsPaymentCompleted","modalPurchaseData","marginTop","marginBottom","Card","CardHeader","CardTitle","m","CardContent","Suspense","fallback","onUpdate"],"ignoreList":[0,1,2,3,11],"sources":["../../node_modules/lucide-react/dist/esm/icons/building.js","../../node_modules/lucide-react/dist/esm/icons/eye-off.js","../../node_modules/lucide-react/dist/esm/icons/settings.js","../../node_modules/lucide-react/dist/esm/icons/sliders-vertical.js","../../src/config/constants.ts","../../src/utils/purchaseFilters.ts","../../src/hooks/usePurchaseMemory.ts","../../src/constants/columnSettings.ts","../../src/components/purchase/ColumnSettingsDropdown.tsx","../../src/components/purchase/MobilePurchaseCard.tsx","../../src/components/purchase/VirtualScrollTable.tsx","../../node_modules/@radix-ui/react-alert-dialog/dist/index.mjs","../../src/components/ui/alert-dialog.tsx","../../src/components/purchase/FastPurchaseTable.tsx","../../src/components/purchase/FilterToolbar.tsx","../../src/utils/roleHelper.ts","../../src/components/purchase/PurchaseListMain.tsx","../../src/hooks/useColumnSettings.ts"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 10h.01\", key: \"1nrarc\" }],\n  [\"path\", { d: \"M12 14h.01\", key: \"1etili\" }],\n  [\"path\", { d: \"M12 6h.01\", key: \"1vi96p\" }],\n  [\"path\", { d: \"M16 10h.01\", key: \"1m94wz\" }],\n  [\"path\", { d: \"M16 14h.01\", key: \"1gbofw\" }],\n  [\"path\", { d: \"M16 6h.01\", key: \"1x0f13\" }],\n  [\"path\", { d: \"M8 10h.01\", key: \"19clt8\" }],\n  [\"path\", { d: \"M8 14h.01\", key: \"6423bh\" }],\n  [\"path\", { d: \"M8 6h.01\", key: \"1dz90k\" }],\n  [\"path\", { d: \"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3\", key: \"cabbwy\" }],\n  [\"rect\", { x: \"4\", y: \"2\", width: \"16\", height: \"20\", rx: \"2\", key: \"1uxh74\" }]\n];\nconst Building = createLucideIcon(\"building\", __iconNode);\n\nexport { __iconNode, Building as default };\n//# sourceMappingURL=building.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",\n      key: \"ct8e1f\"\n    }\n  ],\n  [\"path\", { d: \"M14.084 14.158a3 3 0 0 1-4.242-4.242\", key: \"151rxh\" }],\n  [\n    \"path\",\n    {\n      d: \"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",\n      key: \"13bj9a\"\n    }\n  ],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst EyeOff = createLucideIcon(\"eye-off\", __iconNode);\n\nexport { __iconNode, EyeOff as default };\n//# sourceMappingURL=eye-off.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915\",\n      key: \"1i5ecw\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Settings = createLucideIcon(\"settings\", __iconNode);\n\nexport { __iconNode, Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"21\", y2: \"14\", key: \"1p332r\" }],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"10\", y2: \"3\", key: \"gb41h5\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"21\", y2: \"12\", key: \"hf2csr\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"8\", y2: \"3\", key: \"1kfi7u\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"21\", y2: \"16\", key: \"1lhrwl\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"12\", y2: \"3\", key: \"16vvfq\" }],\n  [\"line\", { x1: \"2\", x2: \"6\", y1: \"14\", y2: \"14\", key: \"1uebub\" }],\n  [\"line\", { x1: \"10\", x2: \"14\", y1: \"8\", y2: \"8\", key: \"1yglbp\" }],\n  [\"line\", { x1: \"18\", x2: \"22\", y1: \"16\", y2: \"16\", key: \"1jxqpz\" }]\n];\nconst SlidersVertical = createLucideIcon(\"sliders-vertical\", __iconNode);\n\nexport { __iconNode, SlidersVertical as default };\n//# sourceMappingURL=sliders-vertical.js.map\n","/**\n *    \n */\n\n//         \nexport const HIDDEN_EMPLOYEES = ['']\n\n//  ...\n","/**\n *     \n *     \n */\n\nimport type { Purchase, Employee } from '@/types/purchase'\nimport { HIDDEN_EMPLOYEES } from '@/config/constants'\nimport { logger } from '@/lib/logger'\n\n//   \nexport type TabType = 'pending' | 'purchase' | 'receipt' | 'done'\n\n/**\n *  \n */\nexport const filterByTab = (\n  purchases: Purchase[],\n  tab: TabType,\n  currentUser: Employee | null\n): Purchase[] => {\n  if (!purchases || !currentUser) return []\n  \n  const userRoles = Array.isArray(currentUser.purchase_role) \n    ? currentUser.purchase_role.map((r: string) => r.trim())\n    : typeof currentUser.purchase_role === 'string' \n    ? currentUser.purchase_role.split(',').map((r: string) => r.trim())\n    : []\n  \n  switch (tab) {\n    case 'pending': {\n      //   :  \n      return purchases.filter(purchase => {\n        //  :   approved \n        if (purchase.middle_manager_status === 'approved' && \n            purchase.final_manager_status === 'approved') {\n          return false //     \n        }\n        \n        //   \n        if (purchase.middle_manager_status === 'rejected' || \n            purchase.final_manager_status === 'rejected') {\n          return false\n        }\n        \n        // 1.     (  )\n        if (userRoles.includes('consumable_manager')) {\n          //     \n          if (purchase.payment_category !== ' ') {\n            return false\n          }\n        }\n        \n        if (userRoles.includes('raw_material_manager')) {\n          //    \n          if (purchase.payment_category !== '') {\n            return false\n          }\n        }\n        \n        // 2.    (app_admin ceo)\n        if (userRoles.includes('app_admin') || \n            userRoles.includes('ceo')) {\n          logger.debug(' App Admin detected! Showing all items for:', { purchase_order_number: purchase.purchase_order_number });\n          return true\n        }\n        \n        // 3. middle_manager   \n        if (userRoles.includes('middle_manager')) {\n          const isMiddlePending = ['pending', '', '', null, undefined].includes(\n            purchase.middle_manager_status as any\n          )\n          return isMiddlePending\n        }\n        \n        // 4.     \n        return purchase.requester_name === currentUser?.name\n      })\n    }\n    \n    case 'purchase': {\n      //   :   \n      //   \n      const hasManagerRole = userRoles.some((role: string) => \n        ['app_admin', 'ceo', 'lead buyer', 'finance_team', 'raw_material_manager', 'consumable_manager', 'purchase_manager', 'hr'].includes(role)\n      )\n      \n      return purchases.filter(purchase => {\n        const isRequest = purchase.payment_category === ' '\n        const notPaid = !purchase.is_payment_completed\n        if (!isRequest || !notPaid) return false\n\n        const isSeonJin = (purchase.progress_type || '').includes('')\n        const isIlban = (purchase.progress_type || '').includes('') || !purchase.progress_type || purchase.progress_type === ''\n        const finalApproved = purchase.final_manager_status === 'approved'\n        const matchesProgress = isSeonJin || (isIlban && finalApproved)\n        \n        if (!matchesProgress) return false\n        \n        //    ,    \n        if (hasManagerRole) {\n          return true\n        }\n        \n        //     \n        return purchase.requester_name === currentUser?.name\n      })\n    }\n    \n    case 'receipt': {\n      //   :   \n      // hr       \n      const hasHrRole = userRoles.includes('hr')\n      const hasManagerRole = userRoles.some((role: string) => \n        ['app_admin', 'ceo', 'lead buyer', 'finance_team', 'raw_material_manager', 'consumable_manager', 'purchase_manager'].includes(role)\n      )\n      \n      return purchases.filter(purchase => {\n        if (purchase.is_received) return false\n        \n        // hr     \n        if (hasHrRole || hasManagerRole) {\n          const isSeonJin = (purchase.progress_type || '').includes('')\n          const finalApproved = purchase.final_manager_status === 'approved'\n          return isSeonJin || finalApproved\n        }\n        \n        //     \n        const isSeonJin = (purchase.progress_type || '').includes('')\n        const finalApproved = purchase.final_manager_status === 'approved'\n        const isRequester = purchase.requester_name === currentUser?.name\n        \n        return (isSeonJin || finalApproved) && isRequester\n      })\n    }\n    \n    case 'done':\n    default: {\n      //   :  \n      return purchases\n    }\n  }\n}\n\n/**\n *  \n */\nexport const filterByEmployee = (\n  purchases: Purchase[],\n  employeeName: string | null,\n  currentUser: Employee | null\n): Purchase[] => {\n  if (!purchases || !employeeName || employeeName === '') return purchases\n  \n  // HIDDEN_EMPLOYEES  (  )\n  const userRoles = Array.isArray(currentUser?.purchase_role) \n    ? currentUser.purchase_role.map((r: string) => r.trim())\n    : typeof currentUser?.purchase_role === 'string' \n    ? currentUser.purchase_role.split(',').map((r: string) => r.trim())\n    : []\n  const hasManagerRole = userRoles.some((role: string) => \n    ['lead buyer', 'ceo', 'finance_team', 'raw_material_manager', 'consumable_manager'].includes(role)\n  )\n  \n  return purchases.filter(purchase => {\n    const requestorName = purchase.requester_name || ''\n    \n    // HIDDEN_EMPLOYEES \n    if (HIDDEN_EMPLOYEES.includes(requestorName) && !hasManagerRole) {\n      return false\n    }\n    \n    return requestorName === employeeName\n  })\n}\n\n/**\n *   \n */\nexport const applyAdvancedFilters = (\n  purchases: Purchase[],\n  filters: any[]\n): Purchase[] => {\n  if (!filters || filters.length === 0) return purchases\n  \n  return purchases.filter(purchase => {\n    return filters.every(filter => {\n      const { field, condition, value, dateField } = filter\n      \n      //       \n      const targetField = dateField || field\n      const fieldValue = getFieldValue(purchase, targetField)\n      \n      switch (condition) {\n        case 'contains':\n          return String(fieldValue).toLowerCase().includes(String(value).toLowerCase())\n        case 'equals':\n          //   \n          if (typeof value === 'string' && value.includes('~')) {\n            const [startDate, endDate] = value.split('~')\n            const purchaseDate = new Date(fieldValue).toISOString().split('T')[0]\n            return purchaseDate >= startDate && purchaseDate <= endDate\n          }\n          //    (YYYY-MM )\n          if (typeof value === 'string' && (value.match(/^\\d{4}-\\d{2}$/) || value.match(/^\\d{4}-\\d{2}~\\d{4}-\\d{2}$/))) {\n            if (value.includes('~')) {\n              const [startMonth, endMonth] = value.split('~')\n              const purchaseMonth = new Date(fieldValue).toISOString().slice(0, 7) // YYYY-MM \n              return purchaseMonth >= startMonth && purchaseMonth <= endMonth\n            } else {\n              const purchaseMonth = new Date(fieldValue).toISOString().slice(0, 7)\n              return purchaseMonth === value\n            }\n          }\n          return fieldValue === value\n        case 'not_equals':\n          return fieldValue !== value\n        case 'starts_with':\n          return String(fieldValue).toLowerCase().startsWith(String(value).toLowerCase())\n        case 'ends_with':\n          return String(fieldValue).toLowerCase().endsWith(String(value).toLowerCase())\n        case 'greater_than':\n          return Number(fieldValue) > Number(value)\n        case 'less_than':\n          return Number(fieldValue) < Number(value)\n        case 'after':\n          return new Date(fieldValue) > new Date(value)\n        case 'before':\n          return new Date(fieldValue) < new Date(value)\n        case 'is_empty':\n          return !fieldValue || fieldValue === '' || fieldValue === null\n        case 'is_not_empty':\n          return fieldValue && fieldValue !== '' && fieldValue !== null\n        case 'between': {\n          const [min, max] = value.split(',').map(Number)\n          const numValue = Number(fieldValue)\n          return numValue >= min && numValue <= max\n        }\n        case 'in': {\n          const values = value.split(',').map((v: string) => v.trim())\n          return values.includes(String(fieldValue))\n        }\n        default:\n          return true\n      }\n    })\n  })\n}\n\n/**\n *  \n */\nexport const filterBySearchTerm = (\n  purchases: Purchase[],\n  searchTerm: string\n): Purchase[] => {\n  if (!searchTerm || searchTerm.trim() === '') return purchases\n  \n  const term = searchTerm.toLowerCase().trim()\n  \n  return purchases.filter(purchase => {\n    //   \n    const searchableFields = [\n      purchase.purchase_order_number,\n      purchase.requester_name,\n      purchase.vendor_name,\n      purchase.contact_name,\n      // purchase_request_items    \n      ...(purchase.purchase_request_items || []).map((item: any) => [\n        item.item_name,\n        item.item_detail,\n        item.manufacturer,\n        item.model,\n        item.specification, // spec -> specification \n        item.spec //    \n      ]).flat()\n    ]\n    \n    //    true\n    return searchableFields.some(field => \n      field && String(field).toLowerCase().includes(term)\n    )\n  })\n}\n\n/**\n *   \n */\nexport const filterByDateRange = (\n  purchases: Purchase[],\n  startDate?: string,\n  endDate?: string\n): Purchase[] => {\n  if (!startDate && !endDate) return purchases\n  \n  return purchases.filter(purchase => {\n    const requestDate = new Date(purchase.request_date)\n    \n    if (startDate && requestDate < new Date(startDate)) return false\n    if (endDate && requestDate > new Date(endDate)) return false\n    \n    return true\n  })\n}\n\n/**\n *  \n */\nexport const sortPurchases = (\n  purchases: Purchase[],\n  sortConfig?: { key: string; direction: 'asc' | 'desc' }\n): Purchase[] => {\n  if (!sortConfig) return purchases\n  \n  return [...purchases].sort((a, b) => {\n    const aValue = getFieldValue(a, sortConfig.key)\n    const bValue = getFieldValue(b, sortConfig.key)\n    \n    if (aValue === null || aValue === undefined) return 1\n    if (bValue === null || bValue === undefined) return -1\n    \n    let comparison = 0\n    if (aValue > bValue) comparison = 1\n    if (aValue < bValue) comparison = -1\n    \n    return sortConfig.direction === 'desc' ? -comparison : comparison\n  })\n}\n\n/**\n *    \n */\nconst getFieldValue = (purchase: Purchase, field: string): any => {\n  // boolean     (   )\n  if (field === 'is_payment_completed') {\n    const value = purchase.is_payment_completed\n    return value === true ? '' : ''\n  }\n  if (field === 'is_received') {\n    // purchase_requests.is_received  (  X)\n    const value = purchase.is_received\n    return value === true ? '' : ''\n  }\n  if (field === 'is_statement_received') {\n    const value = purchase.is_statement_received\n    return value === true ? '' : ''\n  }\n  if (field === 'is_utk_checked') {\n    const value = purchase.is_utk_checked\n    return value === true ? '' : ''\n  }\n  \n  //    (: items.0.item_name)\n  const keys = field.split('.')\n  let value: any = purchase\n  \n  for (const key of keys) {\n    if (value === null || value === undefined) return null\n    value = value[key]\n  }\n  \n  return value\n}\n\n/**\n *   \n */\nexport const calculateTabCounts = (\n  allPurchases: Purchase[],\n  currentUser: Employee | null\n): Record<TabType, number> => {\n  return {\n    pending: filterByTab(allPurchases, 'pending', currentUser).length,\n    purchase: filterByTab(allPurchases, 'purchase', currentUser).length,\n    receipt: filterByTab(allPurchases, 'receipt', currentUser).length,\n    done: filterByTab(allPurchases, 'done', currentUser).length\n  }\n}\n\n/**\n *   \n */\nexport interface FilterOptions {\n  tab?: TabType\n  employeeName?: string | null\n  searchTerm?: string\n  advancedFilters?: any[]\n  startDate?: string\n  endDate?: string\n  sortConfig?: { key: string; direction: 'asc' | 'desc' }\n}\n\nexport const applyAllFilters = (\n  purchases: Purchase[],\n  options: FilterOptions,\n  currentUser: Employee | null\n): Purchase[] => {\n  let filtered = purchases\n  \n  // 1.  \n  if (options.tab) {\n    filtered = filterByTab(filtered, options.tab, currentUser)\n  }\n  \n  // 2.  \n  if (options.employeeName) {\n    filtered = filterByEmployee(filtered, options.employeeName, currentUser)\n  }\n  \n  // 3.  \n  if (options.searchTerm) {\n    filtered = filterBySearchTerm(filtered, options.searchTerm)\n  }\n  \n  // 4.  \n  if (options.advancedFilters) {\n    filtered = applyAdvancedFilters(filtered, options.advancedFilters)\n  }\n  \n  // 5.   \n  if (options.startDate || options.endDate) {\n    filtered = filterByDateRange(filtered, options.startDate, options.endDate)\n  }\n  \n  // 6. \n  if (options.sortConfig) {\n    filtered = sortPurchases(filtered, options.sortConfig)\n  }\n  \n  return filtered\n}\n","/**\n *     Hook\n *     \n */\n\nimport { useState, useEffect, useMemo, useCallback } from 'react'\nimport { purchaseMemoryCache } from '@/stores/purchaseMemoryStore'\nimport { applyAllFilters, calculateTabCounts, type FilterOptions, type TabType } from '@/utils/purchaseFilters'\nimport type { Purchase } from '@/types/purchase'\n\nexport function usePurchaseMemory() {\n  const initialPurchases = purchaseMemoryCache.allPurchases\n    ? [...purchaseMemoryCache.allPurchases]\n    : []\n  const initialLoading = !purchaseMemoryCache.allPurchases && purchaseMemoryCache.isLoading\n\n  //  \n  const [purchases, setPurchases] = useState<Purchase[]>(initialPurchases)\n  const [loading, setLoading] = useState(initialLoading)\n  const [error, setError] = useState<string | null>(purchaseMemoryCache.error)\n  \n  //   \n  const currentUser = purchaseMemoryCache.currentUser\n  \n  //   \n  useEffect(() => {\n    let lastArrayRef = purchaseMemoryCache.allPurchases\n    let lastFetchTime = purchaseMemoryCache.lastFetch\n    \n    //    \n    const checkCache = () => {\n      //    lastFetch  \n      const arrayChanged = purchaseMemoryCache.allPurchases !== lastArrayRef\n      const fetchTimeChanged = purchaseMemoryCache.lastFetch !== lastFetchTime\n      \n      if (arrayChanged || fetchTimeChanged || purchases.length === 0) {\n        console.log(' [usePurchaseMemory]   ', {\n          arrayChanged,\n          fetchTimeChanged,\n          currentLastFetch: purchaseMemoryCache.lastFetch,\n          prevLastFetch: lastFetchTime,\n          purchasesCount: purchaseMemoryCache.allPurchases?.length || 0,\n          currentPurchasesCount: purchases.length\n        })\n        \n        if (purchaseMemoryCache.allPurchases) {\n          setPurchases([...purchaseMemoryCache.allPurchases]) //     \n          setLoading(false)\n          lastArrayRef = purchaseMemoryCache.allPurchases\n          lastFetchTime = purchaseMemoryCache.lastFetch\n          \n          console.log(' [usePurchaseMemory] purchases   ', {\n            newPurchasesCount: purchaseMemoryCache.allPurchases.length\n          })\n        } else {\n          setLoading(purchaseMemoryCache.isLoading)\n        }\n        setError(purchaseMemoryCache.error)\n      }\n    }\n    \n    //  \n    checkCache()\n    \n    //     (    10ms )\n    //      ,    \n    const interval = setInterval(checkCache, 10)\n    \n    return () => clearInterval(interval)\n  }, [purchases.length]) // purchases.length  state   \n  \n  //    \n  const getFilteredPurchases = useCallback((options: FilterOptions): Purchase[] => {\n    if (!purchaseMemoryCache.allPurchases) return []\n    \n    return applyAllFilters(\n      purchaseMemoryCache.allPurchases,\n      options,\n      currentUser\n    )\n  }, [currentUser])\n  \n  //    - purchases    \n  const tabCounts = useMemo(() => {\n    if (!purchases || purchases.length === 0) {\n      return {\n        pending: 0,\n        purchase: 0,\n        receipt: 0,\n        done: 0\n      }\n    }\n    \n    return calculateTabCounts(purchases, currentUser)\n  }, [purchases, currentUser])\n  \n  //  \n  const stats = useMemo(() => {\n    return {\n      total: purchases.length,\n      loaded: purchaseMemoryCache.stats?.loadedCount || 0,\n      memoryUsage: purchaseMemoryCache.stats?.memoryUsage || 0,\n      lastFetch: purchaseMemoryCache.lastFetch\n    }\n  }, [purchases])\n  \n  return {\n    // \n    allPurchases: purchases,\n    getFilteredPurchases,\n    \n    // \n    loading,\n    error,\n    \n    //  & \n    tabCounts,\n    stats,\n    \n    //  \n    currentUser\n  }\n}\n\n/**\n *   Hook\n */\nexport function usePurchaseTab(tab: TabType) {\n  const { getFilteredPurchases, loading, error, currentUser } = usePurchaseMemory()\n  const [filteredData, setFilteredData] = useState<Purchase[]>([])\n  \n  useEffect(() => {\n    //   \n    const data = getFilteredPurchases({ tab })\n    setFilteredData(data)\n  }, [tab, getFilteredPurchases])\n  \n  return {\n    purchases: filteredData,\n    loading,\n    error,\n    currentUser\n  }\n}\n","import { ColumnInfo, DoneTabColumnId, ColumnVisibility } from '@/types/columnSettings';\n\n/**\n *     \n * 22     \n */\n\n//     ( )\nexport const DONE_TAB_COLUMNS: ColumnInfo[] = [\n  {\n    id: 'statement_progress',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'purchase_order_number',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'payment_category',\n    label: '',\n    description: '  (, ,  )',\n    defaultVisible: true,\n  },\n  {\n    id: 'requester_name',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'request_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'utk_status',\n    label: 'UTK',\n    description: 'UTK  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'vendor_name',\n    label: '',\n    description: '',\n    defaultVisible: true,\n  },\n  {\n    id: 'contact_name',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'delivery_request_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'revised_delivery_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'item_name',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'specification',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'quantity',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'unit_price',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'amount',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'remark',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'link',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'project_vendor',\n    label: 'PJ',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'project_item',\n    label: 'PJ ITEM',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'sales_order_number',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'purchase_progress',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'receipt_progress',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n];\n\n//     (  )\nexport const DEFAULT_COLUMN_VISIBILITY: ColumnVisibility = DONE_TAB_COLUMNS.reduce(\n  (acc, column) => {\n    acc[column.id] = column.defaultVisible;\n    return acc;\n  },\n  {} as ColumnVisibility\n);\n\n//  ID    \nexport const COLUMN_INFO_MAP: Record<DoneTabColumnId, ColumnInfo> = DONE_TAB_COLUMNS.reduce(\n  (acc, column) => {\n    acc[column.id] = column;\n    return acc;\n  },\n  {} as Record<DoneTabColumnId, ColumnInfo>\n);\n\n//   (   )\nexport const REQUIRED_COLUMNS: DoneTabColumnId[] = [\n  'purchase_order_number',\n  'vendor_name',\n  'item_name',\n  'amount',\n];\n\n//   ( UI )\nexport const COLUMN_GROUPS = [\n  {\n    title: ' ',\n    columns: [\n      'statement_progress',\n      'purchase_order_number',\n      'payment_category',\n      'requester_name',\n      'request_date',\n      'utk_status',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'vendor_name',\n      'contact_name',\n      'delivery_request_date',\n      'revised_delivery_date',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'item_name',\n      'specification',\n      'quantity',\n      'unit_price',\n      'amount',\n      'remark',\n      'link',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'project_vendor',\n      'project_item',\n      'sales_order_number',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'purchase_progress',\n      'receipt_progress',\n    ] as DoneTabColumnId[],\n  },\n] as const;","import React, { memo, useState, useEffect } from 'react';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Button } from '@/components/ui/button';\nimport { Settings, RotateCcw, Eye, EyeOff, Check, X } from 'lucide-react';\nimport { COLUMN_GROUPS, REQUIRED_COLUMNS } from '@/constants/columnSettings';\nimport { DoneTabColumnId, ColumnVisibility } from '@/types/columnSettings';\nimport { Skeleton } from '@/components/ui/skeleton';\n\ninterface ColumnSettingsDropdownProps {\n  /**\n   *    \n   */\n  isVisible?: boolean;\n  /**\n   *  CSS \n   */\n  className?: string;\n  /**\n   *   \n   */\n  columnVisibility: ColumnVisibility;\n  /**\n   *    \n   */\n  applyColumnSettings: (newSettings: ColumnVisibility) => void;\n  /**\n   *   \n   */\n  resetToDefault: () => void;\n  /**\n   *  \n   */\n  isLoading?: boolean;\n}\n\n/**\n *      \n * -   \n * -   \n * -  \n * -   \n */\nconst ColumnSettingsDropdown: React.FC<ColumnSettingsDropdownProps> = memo(({\n  isVisible = true,\n  className = '',\n  columnVisibility,\n  applyColumnSettings,\n  resetToDefault,\n  isLoading = false,\n}) => {\n  \n  //    (  )\n  const [tempVisibility, setTempVisibility] = useState<ColumnVisibility>(columnVisibility);\n  const [isOpen, setIsOpen] = useState(false);\n\n  //      \n  useEffect(() => {\n    if (isOpen) {\n      setTempVisibility(columnVisibility);\n    }\n  }, [isOpen, columnVisibility]);\n\n  //     \n  if (!isVisible) {\n    return null;\n  }\n\n  //    \n  const visibleColumnCount = Object.values(columnVisibility).filter(Boolean).length;\n  const totalColumnCount = Object.keys(columnVisibility).length;\n  const tempVisibleCount = Object.values(tempVisibility).filter(Boolean).length;\n\n  //    (  )\n  const handleColumnToggle = (columnId: DoneTabColumnId) => {\n    //     \n    if (REQUIRED_COLUMNS.includes(columnId) && tempVisibility[columnId]) {\n      return;\n    }\n    \n    setTempVisibility(prev => ({\n      ...prev,\n      [columnId]: !prev[columnId]\n    }));\n  };\n\n  //  \n  const handleApply = () => {\n    applyColumnSettings(tempVisibility);\n    setIsOpen(false);\n  };\n\n  // \n  const handleCancel = () => {\n    setTempVisibility(columnVisibility);\n    setIsOpen(false);\n  };\n\n  //  \n  const handleReset = () => {\n    resetToDefault();\n    setIsOpen(false);\n  };\n\n  return (\n    <DropdownMenu open={isOpen} onOpenChange={setIsOpen}>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\" className={`button-base ${className}`} disabled={isLoading}>\n          <Settings className=\"w-4 h-4 mr-2\" />\n          <span className=\"button-text\">\n            {isLoading ? ' ...' : `  (${visibleColumnCount}/${totalColumnCount})`}\n          </span>\n        </Button>\n      </DropdownMenuTrigger>\n      \n      <DropdownMenuContent className=\"w-[320px] overflow-x-hidden\" align=\"end\" onInteractOutside={() => {\n        setTempVisibility(columnVisibility);\n        setIsOpen(false);\n      }}>\n        <div className=\"max-h-[min(600px,80vh)] overflow-y-auto overflow-x-hidden\">\n        {/*  */}\n        <DropdownMenuLabel className=\"flex items-center justify-between py-1.5\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"modal-section-title\">  </span>\n            <span className=\"card-description\">\n              ({tempVisibleCount}/{totalColumnCount})\n            </span>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={handleReset}\n            className=\"h-5 px-1.5\"\n            title=\" \"\n          >\n            <RotateCcw className=\"w-3 h-3\" />\n          </Button>\n        </DropdownMenuLabel>\n        \n        <DropdownMenuSeparator />\n\n        {/*    */}\n        {COLUMN_GROUPS.map((group, groupIndex) => (\n          <React.Fragment key={group.title}>\n            {/*   */}\n            <div className=\"px-3 py-1\">\n              <div className=\"modal-label\">\n                {group.title}\n              </div>\n            </div>\n\n            {/*    - 2  */}\n            <div className=\"grid grid-cols-2 gap-x-1 px-2\">\n              {group.columns.map((columnId) => {\n                const isVisible = tempVisibility[columnId];\n                const isRequired = REQUIRED_COLUMNS.includes(columnId);\n                \n                //   \n                const columnLabels: Record<DoneTabColumnId, string> = {\n                  statement_progress: '',\n                  purchase_order_number: '',\n                  payment_category: '',\n                  requester_name: '',\n                  request_date: '',\n                  utk_status: 'UTK',\n                  vendor_name: '',\n                  contact_name: '',\n                  delivery_request_date: '',\n                  revised_delivery_date: '',\n                  item_name: '',\n                  specification: '',\n                  quantity: '',\n                  unit_price: '',\n                  amount: '',\n                  remark: '',\n                  link: '',\n                  project_vendor: 'PJ',\n                  project_item: 'PJ ITEM',\n                  sales_order_number: '',\n                  purchase_progress: '',\n                  receipt_progress: '',\n                };\n\n                return (\n                  <div\n                    key={columnId}\n                    className={`flex items-center gap-1 py-1 rounded overflow-hidden ${\n                      isRequired && isVisible ? 'opacity-75' : 'cursor-pointer hover:bg-gray-50'\n                    }`}\n                    onClick={() => {\n                      if (!(isRequired && isVisible)) {\n                        handleColumnToggle(columnId);\n                      }\n                    }}\n                  >\n                    <div className={`p-0.5 ${\n                      isRequired && isVisible ? '' : 'hover:bg-gray-100 rounded transition-colors'\n                    }`}>\n                      {isVisible ? (\n                        <Eye className=\"w-3.5 h-3.5 text-green-600\" />\n                      ) : (\n                        <EyeOff className=\"w-3.5 h-3.5 text-gray-400\" />\n                      )}\n                    </div>\n                    \n                    <div className=\"flex-1 min-w-0\">\n                      <div className={`modal-value truncate ${\n                        !isVisible ? 'text-gray-500' : ''\n                      }`}>\n                        {columnLabels[columnId]}\n                        {isRequired && (\n                          <span className=\"ml-1 text-red-500\" title=\" \">*</span>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n\n            {/*   (  ) */}\n            {groupIndex < COLUMN_GROUPS.length - 1 && <DropdownMenuSeparator />}\n          </React.Fragment>\n        ))}\n\n        <DropdownMenuSeparator />\n\n        {/*   */}\n        <div className=\"px-3 py-2\">\n          <div className=\"card-description space-y-1\">\n            <div>  (*)   </div>\n            <div>     </div>\n            <div>    </div>\n          </div>\n        </div>\n\n        </div>\n        \n        <DropdownMenuSeparator />\n\n        {/* /  */}\n        <div className=\"px-3 py-3 flex gap-2 border-t bg-white\">\n          <Button\n            onClick={handleApply}\n            className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n          >\n            <Check className=\"w-4 h-4 mr-1\" />\n            \n          </Button>\n          <Button\n            onClick={handleCancel}\n            variant=\"outline\"\n            className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n          >\n            <X className=\"w-4 h-4 mr-1\" />\n            \n          </Button>\n        </div>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n});\n\nColumnSettingsDropdown.displayName = 'ColumnSettingsDropdown';\n\nexport default ColumnSettingsDropdown;","import { memo } from 'react'\nimport { Eye } from 'lucide-react'\nimport { Purchase } from '@/types/purchase'\nimport { formatDateShort } from '@/utils/helpers'\n\ninterface MobilePurchaseCardProps {\n  purchase: Purchase\n  onClick: (purchase: Purchase) => void\n}\n\n\nconst getReceiptProgress = (purchase: Purchase) => {\n  if (!purchase.purchase_request_items || purchase.purchase_request_items.length === 0) return { received: 0, total: 0, percentage: 0 }\n  \n  const total = purchase.purchase_request_items.length\n  const received = purchase.purchase_request_items.filter((item: any) => \n    item.actual_received_date !== null && item.actual_received_date !== undefined\n  ).length\n  const percentage = total > 0 ? Math.round((received / total) * 100) : 0\n  \n  return { received, total, percentage }\n}\n\nconst StatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const status = purchase.is_received \n    ? 'completed'\n    : (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')\n    ? 'inProgress'\n    : (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected')\n    ? 'rejected'\n    : 'pending'\n  \n  const config = {\n    completed: { text: '', className: 'badge-success' },\n    inProgress: { text: '', className: 'badge-primary' },\n    rejected: { text: '', className: 'badge-danger' },\n    pending: { text: '', className: 'badge-warning' }\n  }\n  \n  const { text, className } = config[status]\n  return <span className={`badge-stats ${className}`}>{text}</span>\n})\n\nStatusBadge.displayName = 'StatusBadge'\n\nconst MobilePurchaseCard = memo(({ purchase, onClick }: MobilePurchaseCardProps) => {\n  const receiptProgress = getReceiptProgress(purchase)\n  const isAdvance = purchase.progress_type === '' || purchase.progress_type?.includes('')\n  \n  return (\n    <div \n      className={`bg-white rounded-lg border p-4 space-y-3 cursor-pointer transition-all hover:shadow-md ${isAdvance ? 'border-red-400 bg-red-50 hover:bg-red-100' : 'hover:bg-gray-50'}`}\n      onClick={() => onClick(purchase)}\n    >\n      {/*  */}\n      <div className=\"flex items-start justify-between\">\n        <div>\n          <div className=\"flex items-center gap-2\">\n            {isAdvance ? (\n              <span className=\"badge-stats bg-red-500 text-white\">\n                \n              </span>\n            ) : (\n              <span className=\"badge-stats bg-gray-500 text-white\">\n                \n              </span>\n            )}\n            <span className=\"card-title text-gray-900\">\n              {purchase.purchase_order_number || '-'}\n            </span>\n          </div>\n          <div className=\"badge-text text-gray-500 mt-1\">\n            {formatDateShort(purchase.request_date)} \n          </div>\n        </div>\n        <StatusBadge purchase={purchase} />\n      </div>\n\n      {/*   */}\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"card-title\">{purchase.requester_name}</span>\n        </div>\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"card-title\">{purchase.vendor_name}</span>\n        </div>\n        {purchase.project_vendor && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\">PJ</span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.project_vendor}</span>\n          </div>\n        )}\n        {purchase.project_item && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\">PJ ITEM</span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.project_item}</span>\n          </div>\n        )}\n        {purchase.sales_order_number && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\"></span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.sales_order_number}</span>\n          </div>\n        )}\n        {purchase.item_name && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\"></span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.item_name}</span>\n          </div>\n        )}\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"font-semibold text-gray-900\">\n            {(purchase.amount_value || purchase.total_amount)?.toLocaleString()} {purchase.currency}\n          </span>\n        </div>\n      </div>\n\n      {/*   */}\n      <div className=\"space-y-1\">\n        <div className=\"flex items-center justify-between badge-text\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"text-gray-700\">\n            {receiptProgress.received}/{receiptProgress.total} ({receiptProgress.percentage}%)\n          </span>\n        </div>\n        <div className=\"bg-gray-200 rounded-full h-2\">\n          <div \n            className={`h-2 rounded-full transition-all ${\n              receiptProgress.percentage === 100 ? 'bg-green-500' : \n              receiptProgress.percentage > 0 ? 'bg-hansl-500' : 'bg-gray-300'\n            }`}\n            style={{ width: `${receiptProgress.percentage}%` }}\n          />\n        </div>\n      </div>\n\n      {/*   */}\n      {purchase.is_payment_completed !== undefined && (\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          {purchase.is_payment_completed ? (\n            <span className=\"badge-stats bg-green-500 text-white\"></span>\n          ) : (\n            <span className=\"badge-stats bg-gray-500 text-white\"></span>\n          )}\n        </div>\n      )}\n\n      {/*       */}\n      <div className=\"pt-2 border-t\">\n        <div className=\"flex items-center justify-center badge-text text-gray-500\">\n          <Eye className=\"w-3 h-3 mr-1\" />\n           \n        </div>\n      </div>\n    </div>\n  )\n})\n\nMobilePurchaseCard.displayName = 'MobilePurchaseCard'\n\nexport default MobilePurchaseCard","import React, { memo, useMemo, useRef, useEffect, useState, useCallback } from 'react';\nimport { Purchase } from '@/types/purchase';\nimport { ColumnVisibility } from '@/types/columnSettings';\n\ninterface VirtualScrollTableProps {\n  purchases: Purchase[];\n  activeTab?: string;\n  onRowClick: (purchase: Purchase) => void;\n  isLeadBuyer?: boolean;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n  onExcelDownload?: (purchase: Purchase) => Promise<void>;\n  columnVisibility?: ColumnVisibility;\n  vendorColumnWidth?: number;\n  tableHeader: React.ReactNode;\n  TableRowComponent: React.ComponentType<any>;\n  height?: number;\n  shouldUseFitLayout?: boolean;\n}\n\nconst ITEM_HEIGHT = 30; //     ( py-1.5 +  )\nconst BUFFER_SIZE = 5; //      \n\nconst VirtualScrollTable = memo<VirtualScrollTableProps>(({\n  purchases,\n  activeTab,\n  onRowClick,\n  isLeadBuyer,\n  onPaymentComplete,\n  onReceiptComplete,\n  onExcelDownload,\n  columnVisibility,\n  vendorColumnWidth,\n  tableHeader,\n  TableRowComponent,\n  height = 600,\n  shouldUseFitLayout = false\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [scrollTop, setScrollTop] = useState(0);\n  const [containerHeight, setContainerHeight] = useState(height);\n  \n  //    \n  const [dynamicHeight, setDynamicHeight] = useState(height);\n\n  //   \n  const { startIndex, endIndex, visibleItems, totalHeight } = useMemo(() => {\n    const itemCount = purchases.length;\n    const visibleCount = Math.ceil(containerHeight / ITEM_HEIGHT);\n    \n    const start = Math.floor(scrollTop / ITEM_HEIGHT);\n    const end = Math.min(start + visibleCount + BUFFER_SIZE, itemCount);\n    const actualStart = Math.max(0, start - BUFFER_SIZE);\n    \n    return {\n      startIndex: actualStart,\n      endIndex: end,\n      visibleItems: purchases.slice(actualStart, end),\n      totalHeight: itemCount * ITEM_HEIGHT\n    };\n  }, [purchases, scrollTop, containerHeight]);\n\n  //    -   \n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    const headerHeight = 30; //     ( )\n    const adjustedScrollTop = Math.max(0, e.currentTarget.scrollTop - headerHeight);\n    setScrollTop(adjustedScrollTop);\n  }, []);\n\n  //       \n  useEffect(() => {\n    const calculateDynamicHeight = () => {\n      const windowHeight = window.innerHeight;\n      \n      //      \n      let calculatedHeight;\n      \n      if (windowHeight <= 800) {\n        //  :  60% ( 450px)\n        calculatedHeight = Math.min(450, windowHeight * 0.6);\n      } else if (windowHeight <= 1080) {\n        //  :  70% ( 725px)\n        calculatedHeight = Math.min(725, windowHeight * 0.7);\n      } else if (windowHeight <= 1440) {\n        //  :  75% ( 1000px)\n        calculatedHeight = Math.min(1000, windowHeight * 0.75);\n      } else {\n        //   :  80% ( 1200px)\n        calculatedHeight = Math.min(1200, windowHeight * 0.8);\n      }\n      \n      console.log('   :', {\n        windowHeight,\n        calculatedHeight,\n        category: windowHeight <= 800 ? '' : \n                 windowHeight <= 1080 ? '' :\n                 windowHeight <= 1440 ? '' : ''\n      });\n      \n      setDynamicHeight(calculatedHeight);\n      setContainerHeight(calculatedHeight);\n    };\n\n    const updateHeight = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        setContainerHeight(Math.min(dynamicHeight, rect.height));\n      }\n    };\n\n    // DOM    \n    const timer = setTimeout(() => {\n      calculateDynamicHeight();\n      updateHeight();\n    }, 100); // 100ms  DOM   \n    \n    //   \n    const handleResize = () => {\n      calculateDynamicHeight();\n      updateHeight();\n    };\n    \n    window.addEventListener('resize', handleResize);\n    \n    return () => {\n      clearTimeout(timer);\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [dynamicHeight]);\n\n  return (\n    <div className={shouldUseFitLayout ? 'table-container-fit-left' : 'border rounded-lg'}>\n      {/*     - x y    */}\n      <div\n        ref={containerRef}\n        className=\"virtual-scroll-body\"\n        style={{ \n          height: `${dynamicHeight}px`, \n          overflow: 'auto',\n          position: 'relative'\n        }}\n        onScroll={handleScroll}\n      >\n        {/*   -      */}\n        <div style={{ \n          position: 'sticky', \n          top: 0, \n          zIndex: 10,\n          backgroundColor: 'white',\n          borderBottom: '1px solid #e5e7eb'\n        }}>\n          <table className={shouldUseFitLayout ? `table-fit-left ${activeTab}-tab` : 'w-full min-w-[1790px] border-collapse'}>\n            {tableHeader}\n          </table>\n        </div>\n        \n        {/*     */}\n        <div style={{ height: `${totalHeight}px`, position: 'relative' }}>\n          {/*    */}\n          <div\n            style={{\n              transform: `translateY(${startIndex * ITEM_HEIGHT}px)`,\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              right: 0,\n            }}\n          >\n            <table className={`${shouldUseFitLayout ? `table-fit-left ${activeTab}-tab` : 'w-full min-w-[1790px] border-collapse'} virtual-scroll-table`}>\n              <tbody>\n                {visibleItems.map((purchase, index) => (\n                  <TableRowComponent\n                    key={purchase.id}\n                    purchase={purchase}\n                    onClick={onRowClick}\n                    activeTab={activeTab}\n                    isLeadBuyer={isLeadBuyer}\n                    onPaymentComplete={onPaymentComplete}\n                    onReceiptComplete={onReceiptComplete}\n                    onExcelDownload={onExcelDownload}\n                    vendorColumnWidth={vendorColumnWidth}\n                    columnVisibility={columnVisibility}\n                  />\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/*    */}\n        {purchases.length === 0 && (\n          <div className=\"text-center py-12 bg-white\">\n            <p className=\"card-subtitle\"> .</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n});\n\nVirtualScrollTable.displayName = 'VirtualScrollTable';\n\nexport default VirtualScrollTable;","\"use client\";\n\n// src/alert-dialog.tsx\nimport * as React from \"react\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\nimport { createDialogScope } from \"@radix-ui/react-dialog\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { createSlottable } from \"@radix-ui/react-slot\";\nimport { jsx, jsxs } from \"react/jsx-runtime\";\nvar ROOT_NAME = \"AlertDialog\";\nvar [createAlertDialogContext, createAlertDialogScope] = createContextScope(ROOT_NAME, [\n  createDialogScope\n]);\nvar useDialogScope = createDialogScope();\nvar AlertDialog = (props) => {\n  const { __scopeAlertDialog, ...alertDialogProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Root, { ...dialogScope, ...alertDialogProps, modal: true });\n};\nAlertDialog.displayName = ROOT_NAME;\nvar TRIGGER_NAME = \"AlertDialogTrigger\";\nvar AlertDialogTrigger = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...triggerProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Trigger, { ...dialogScope, ...triggerProps, ref: forwardedRef });\n  }\n);\nAlertDialogTrigger.displayName = TRIGGER_NAME;\nvar PORTAL_NAME = \"AlertDialogPortal\";\nvar AlertDialogPortal = (props) => {\n  const { __scopeAlertDialog, ...portalProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Portal, { ...dialogScope, ...portalProps });\n};\nAlertDialogPortal.displayName = PORTAL_NAME;\nvar OVERLAY_NAME = \"AlertDialogOverlay\";\nvar AlertDialogOverlay = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...overlayProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Overlay, { ...dialogScope, ...overlayProps, ref: forwardedRef });\n  }\n);\nAlertDialogOverlay.displayName = OVERLAY_NAME;\nvar CONTENT_NAME = \"AlertDialogContent\";\nvar [AlertDialogContentProvider, useAlertDialogContentContext] = createAlertDialogContext(CONTENT_NAME);\nvar Slottable = createSlottable(\"AlertDialogContent\");\nvar AlertDialogContent = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, children, ...contentProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    const contentRef = React.useRef(null);\n    const composedRefs = useComposedRefs(forwardedRef, contentRef);\n    const cancelRef = React.useRef(null);\n    return /* @__PURE__ */ jsx(\n      DialogPrimitive.WarningProvider,\n      {\n        contentName: CONTENT_NAME,\n        titleName: TITLE_NAME,\n        docsSlug: \"alert-dialog\",\n        children: /* @__PURE__ */ jsx(AlertDialogContentProvider, { scope: __scopeAlertDialog, cancelRef, children: /* @__PURE__ */ jsxs(\n          DialogPrimitive.Content,\n          {\n            role: \"alertdialog\",\n            ...dialogScope,\n            ...contentProps,\n            ref: composedRefs,\n            onOpenAutoFocus: composeEventHandlers(contentProps.onOpenAutoFocus, (event) => {\n              event.preventDefault();\n              cancelRef.current?.focus({ preventScroll: true });\n            }),\n            onPointerDownOutside: (event) => event.preventDefault(),\n            onInteractOutside: (event) => event.preventDefault(),\n            children: [\n              /* @__PURE__ */ jsx(Slottable, { children }),\n              /* @__PURE__ */ jsx(DescriptionWarning, { contentRef })\n            ]\n          }\n        ) })\n      }\n    );\n  }\n);\nAlertDialogContent.displayName = CONTENT_NAME;\nvar TITLE_NAME = \"AlertDialogTitle\";\nvar AlertDialogTitle = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...titleProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Title, { ...dialogScope, ...titleProps, ref: forwardedRef });\n  }\n);\nAlertDialogTitle.displayName = TITLE_NAME;\nvar DESCRIPTION_NAME = \"AlertDialogDescription\";\nvar AlertDialogDescription = React.forwardRef((props, forwardedRef) => {\n  const { __scopeAlertDialog, ...descriptionProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Description, { ...dialogScope, ...descriptionProps, ref: forwardedRef });\n});\nAlertDialogDescription.displayName = DESCRIPTION_NAME;\nvar ACTION_NAME = \"AlertDialogAction\";\nvar AlertDialogAction = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...actionProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Close, { ...dialogScope, ...actionProps, ref: forwardedRef });\n  }\n);\nAlertDialogAction.displayName = ACTION_NAME;\nvar CANCEL_NAME = \"AlertDialogCancel\";\nvar AlertDialogCancel = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...cancelProps } = props;\n    const { cancelRef } = useAlertDialogContentContext(CANCEL_NAME, __scopeAlertDialog);\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    const ref = useComposedRefs(forwardedRef, cancelRef);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Close, { ...dialogScope, ...cancelProps, ref });\n  }\n);\nAlertDialogCancel.displayName = CANCEL_NAME;\nvar DescriptionWarning = ({ contentRef }) => {\n  const MESSAGE = `\\`${CONTENT_NAME}\\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \\`${CONTENT_NAME}\\` by passing a \\`${DESCRIPTION_NAME}\\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \\`id\\` and passing the same value to the \\`aria-describedby\\` prop in \\`${CONTENT_NAME}\\`. If the description is confusing or duplicative for sighted users, you can use the \\`@radix-ui/react-visually-hidden\\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;\n  React.useEffect(() => {\n    const hasDescription = document.getElementById(\n      contentRef.current?.getAttribute(\"aria-describedby\")\n    );\n    if (!hasDescription) console.warn(MESSAGE);\n  }, [MESSAGE, contentRef]);\n  return null;\n};\nvar Root2 = AlertDialog;\nvar Trigger2 = AlertDialogTrigger;\nvar Portal2 = AlertDialogPortal;\nvar Overlay2 = AlertDialogOverlay;\nvar Content2 = AlertDialogContent;\nvar Action = AlertDialogAction;\nvar Cancel = AlertDialogCancel;\nvar Title2 = AlertDialogTitle;\nvar Description2 = AlertDialogDescription;\nexport {\n  Action,\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogOverlay,\n  AlertDialogPortal,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n  Cancel,\n  Content2 as Content,\n  Description2 as Description,\n  Overlay2 as Overlay,\n  Portal2 as Portal,\n  Root2 as Root,\n  Title2 as Title,\n  Trigger2 as Trigger,\n  createAlertDialogScope\n};\n//# sourceMappingURL=index.mjs.map\n","import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm\",\n      \"data-[state=open]:animate-in data-[state=closed]:animate-out\",\n      \"data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50\",\n        \"w-full max-w-md translate-x-[-50%] translate-y-[-50%]\",\n        \"grid gap-4 bg-white border border-gray-200\",\n        \"rounded-lg p-6 shadow-professional-xl\",\n        \"duration-200\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out\",\n        \"data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n        \"data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95\",\n        \"data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]\",\n        \"data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end gap-3\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-gray-800 tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-gray-600\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}","import { memo, useMemo, useState, useCallback, useEffect } from \"react\";\nimport PurchaseDetailModal from \"./PurchaseDetailModal\";\nimport MobilePurchaseCard from \"./MobilePurchaseCard\";\nimport VirtualScrollTable from \"./VirtualScrollTable\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { generatePurchaseOrderExcelJS, PurchaseOrderData } from \"@/utils/exceljs/generatePurchaseOrderExcel\";\nimport { formatDateShort } from \"@/utils/helpers\";\nimport { logger } from \"@/lib/logger\";\nimport { usePurchaseMemory } from \"@/hooks/usePurchaseMemory\";\nimport { removePurchaseFromMemory } from '@/stores/purchaseMemoryStore';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Purchase, PurchaseRequestWithDetails } from \"@/types/purchase\";\nimport { DoneTabColumnId, ColumnVisibility } from \"@/types/columnSettings\";\n\ninterface FastPurchaseTableProps {\n  purchases: Purchase[];\n  activeTab?: string; //   \n  currentUserRoles?: string[];\n  onRefresh?: (forceRefresh?: boolean, options?: { silent?: boolean }) => void | Promise<void>;\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n  columnVisibility?: ColumnVisibility; //   \n}\n\n//    ( )\nconst StatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const status = purchase.is_received \n    ? 'completed'\n    : (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')\n    ? 'inProgress'\n    : (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected')\n    ? 'rejected'\n    : 'pending';\n  \n  const config = {\n    completed: { text: '', className: 'badge-success' },\n    inProgress: { text: '', className: 'badge-primary' },\n    rejected: { text: '', className: 'badge-danger' },\n    pending: { text: '', className: 'badge-warning' }\n  };\n  \n  const { text, className } = config[status];\n  return <span className={`badge-stats ${className}`}>{text}</span>;\n});\n\nStatusBadge.displayName = 'StatusBadge';\n\n//     \nconst getCurrencySymbol = (currency: string) => {\n  if (!currency) return '';\n  if (['KRW', '', ''].includes(currency)) return '';\n  if (['USD', '$', ''].includes(currency)) return '$';\n  if (['EUR', ''].includes(currency)) return '';\n  if (['JPY', '', ''].includes(currency)) return '';\n  if (['CNY', '', ''].includes(currency)) return '';\n  return currency;\n};\n\n//   DB  1,979        (2025-10-28)\n//   : 90      \n//  min-width = max-width   , truncate   \nconst COMMON_COLUMN_CLASSES = {\n  //    \n  approvalStatus: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  \n  //     ( )\n  purchaseOrderNumber: \"pl-2 w-[155px] min-w-[155px] max-w-[155px] purchase-order-number-column\",      //  +  + \n  purchaseOrderNumberCompact: \"pl-2 w-36 min-w-[140px] max-w-[140px]\", //   (  )\n  paymentCategory: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  requesterName: \"w-12 min-w-[48px] max-w-[48px]\",                    //   2-3  (,  )\n  requestDate: \"text-center px-2 w-16 min-w-[64px] max-w-[68px]\",\n  vendorName: \"pl-3 pr-2 w-32 min-w-[128px] max-w-[128px]\",           //     (95% )\n  contactName: \"w-16 min-w-[68px] max-w-[68px]\",\n  deliveryRequestDate: \"w-20 min-w-[85px] max-w-[85px]\",\n  revisedDeliveryRequestDate: \"w-20 min-w-[85px] max-w-[85px]\",\n  itemName: \"w-44 min-w-[176px] max-w-[176px]\",                       //    : 160px  176px\n  specification: \"w-64 min-w-[260px] max-w-[260px]\",                  //  15.5 +  (  )\n  quantity: \"text-center w-14 min-w-[60px] max-w-[60px]\",\n  receivedQuantity: \"text-center w-16 min-w-[70px] max-w-[70px]\",\n  unitPrice: \"text-right w-24 min-w-[100px] max-w-[100px]\",\n  amount: \"text-right w-24 min-w-[100px] max-w-[100px]\",\n  \n  //    ( )\n  remark: \"w-[165px] min-w-[165px] max-w-[165px]\",                         //  1.8,  \n  paymentSchedule: \"w-24 min-w-[100px] max-w-[100px]\",\n  purchaseStatus: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  projectVendor: \"w-24 min-w-[105px] max-w-[105px]\",                  //  6.6\n  salesOrderNumber: \"w-28 min-w-[115px] max-w-[115px]\",               //  8.6\n  projectItem: \"w-44 min-w-[180px] max-w-[180px]\",                    //  11.1 +  (  )\n  receiptProgress: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  status: \"text-center w-24 min-w-[100px] max-w-[100px]\",\n  receipt: \"text-center w-24 min-w-[100px] max-w-[100px]\",           //  +  \n  paymentStatus: \"text-center w-16 min-w-[70px] max-w-[70px]\",\n  link: \"w-20 min-w-[85px] max-w-[85px]\",\n  utk: \"text-center w-14 min-w-[56px] max-w-[60px]\"  // UTK   ()\n};\n\n//      ( )\n//       usePurchaseMemory  \nconst ApprovalStatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //     (  )\n  const memoryPurchase = allPurchases?.find(p => p.id === purchase.id) || purchase;\n  \n  const middleApproved = memoryPurchase.middle_manager_status === 'approved';\n  const middleRejected = memoryPurchase.middle_manager_status === 'rejected';\n  const finalApproved = memoryPurchase.final_manager_status === 'approved';\n  const finalRejected = memoryPurchase.final_manager_status === 'rejected';\n\n  //   \n  if (middleRejected || finalRejected) {\n    //    \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-0.5\">\n          <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse\"></div>\n        </div>\n        <span className=\"badge-stats bg-red-500 text-white\">\n          \n        </span>\n      </div>\n    );\n  }\n  \n  if (middleApproved && finalApproved) {\n    //    \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-0.5\">\n          <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\n        </div>\n        <span className=\"badge-stats bg-green-500 text-white\">\n          \n        </span>\n      </div>\n    );\n  }\n  \n  if (middleApproved && !finalApproved && !finalRejected) {\n    //  \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-1\">\n          <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\n          <div className=\"w-3 h-0.5 bg-gray-300\"></div>\n          <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n        </div>\n        <span className=\"badge-stats bg-yellow-500 text-white\">\n          1 \n        </span>\n      </div>\n    );\n  }\n  \n  //   \n  return (\n    <div className=\"flex flex-col items-center gap-0.5\">\n      <div className=\"flex items-center gap-1\">\n        <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n        <div className=\"w-3 h-0.5 bg-gray-300\"></div>\n        <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n      </div>\n      <span className=\"badge-stats bg-gray-500 text-white\">\n        \n      </span>\n    </div>\n  );\n});\n\nApprovalStatusBadge.displayName = 'ApprovalStatusBadge';\n\n//    ( )\n//       usePurchaseMemory  \nconst PaymentProgressBar = memo(({ purchase, activeTab }: { purchase: Purchase; activeTab?: string }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //     (  )\n  const memoryPurchase = allPurchases?.find(p => p.id === purchase.id) || purchase;\n\n  //     \"-\"  (    )\n  if (activeTab === 'done') {\n    const isAdvancePayment = memoryPurchase.payment_category === '' || memoryPurchase.payment_category?.includes('');\n    \n    //   \"-\" \n    if (isAdvancePayment) {\n      return (\n        <div className=\"flex items-center justify-center\">\n          <span className=\"card-title text-gray-500\">-</span>\n        </div>\n      );\n    }\n  }\n  \n  // purchase_requests  is_payment_completed   \n  if (memoryPurchase.is_payment_completed) {\n    const progress = { completed: 1, total: 1, percentage: 100 };\n    return (\n      <div className=\"flex items-center justify-center gap-1\">\n        <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n          <div \n            className=\"h-1.5 rounded-full bg-orange-500\"\n            style={{ width: '100%' }}\n          />\n        </div>\n        <span className=\"card-title text-gray-600\">100%</span>\n      </div>\n    );\n  }\n  \n  // items     \n  if (!memoryPurchase.purchase_request_items || memoryPurchase.purchase_request_items.length === 0) {\n    const progress = { completed: 0, total: 1, percentage: 0 };\n    return (\n      <div className=\"flex items-center justify-center gap-1\">\n        <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n          <div \n            className=\"h-1.5 rounded-full bg-gray-300\"\n            style={{ width: '0%' }}\n          />\n        </div>\n        <span className=\"card-title text-gray-600\">0%</span>\n      </div>\n    );\n  }\n  \n  //     \n  const total = memoryPurchase.purchase_request_items.length;\n  const completed = memoryPurchase.purchase_request_items.filter((item: any) => \n    item.is_payment_completed === true\n  ).length;\n  const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n  \n\n  return (\n    <div className=\"flex items-center justify-center gap-1\">\n      <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n        <div \n          className={`h-1.5 rounded-full ${\n            percentage === 100 ? 'bg-orange-500' : \n            percentage > 0 ? 'bg-orange-400' : 'bg-gray-300'\n          }`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      <span className=\"card-title text-gray-600\">{percentage}%</span>\n    </div>\n  );\n});\n\nPaymentProgressBar.displayName = 'PaymentProgressBar';\n\n//    ( )  \n//       usePurchaseMemory  \nconst ReceiptProgressBar = memo(({ purchase }: { purchase: Purchase }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //     (  )\n  const memoryPurchase = allPurchases?.find(p => p.id === purchase.id) || purchase;\n  \n  // items     \n  if (!memoryPurchase.purchase_request_items || memoryPurchase.purchase_request_items.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center gap-1\">\n        <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n          <div \n            className=\"h-1.5 rounded-full bg-gray-300\"\n            style={{ width: '0%' }}\n          />\n        </div>\n        <span className=\"card-title text-gray-600\">0%</span>\n      </div>\n    );\n  }\n  \n  //       (is_received )\n  const total = memoryPurchase.purchase_request_items.length;\n  const received = memoryPurchase.purchase_request_items.filter((item: any) => \n    item.is_received === true\n  ).length;\n  const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n\n  return (\n    <div className=\"flex items-center justify-center gap-1\">\n      <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n        <div \n          className={`h-1.5 rounded-full ${\n            percentage === 100 ? 'bg-blue-500' : \n            percentage > 0 ? 'bg-blue-400' : 'bg-gray-300'\n          }`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      <span className=\"card-title text-gray-600\">{percentage}%</span>\n    </div>\n  );\n});\n\nReceiptProgressBar.displayName = 'ReceiptProgressBar';\n\n//    ( )  \n//       usePurchaseMemory  \nconst StatementProgressBar = memo(({ purchase }: { purchase: Purchase }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //      (  )\n  const currentPurchase = useMemo(() => {\n    if (!allPurchases) return purchase;\n    const memoryPurchase = allPurchases.find(p => p.id === purchase.id);\n    return memoryPurchase || purchase;\n  }, [allPurchases, purchase.id, purchase]);\n\n  //    \n  const statementProgress = useMemo(() => {\n    const items = currentPurchase.purchase_request_items || currentPurchase.items || [];\n    if (items.length === 0) {\n      return { completed: 0, total: 1, percentage: 0 };\n    }\n    \n    const total = items.length;\n    const completed = items.filter((item: any) => item.is_statement_received === true).length;\n    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n    \n    return { completed, total, percentage };\n  }, [currentPurchase]);\n\n  return (\n    <div className=\"flex items-center justify-center gap-1\">\n      <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n        <div \n          className={`h-1.5 rounded-full ${\n            statementProgress.percentage === 100 ? 'bg-green-500' : \n            statementProgress.percentage > 0 ? 'bg-green-400' : 'bg-gray-300'\n          }`}\n          style={{ width: `${statementProgress.percentage}%` }}\n        />\n      </div>\n      <span className=\"card-title text-gray-600\">\n        {statementProgress.percentage}%\n      </span>\n    </div>\n  );\n});\n\nStatementProgressBar.displayName = 'StatementProgressBar';\n\n\n\n//   \nconst ProgressTypeBadge = memo(({ type }: { type?: string }) => {\n  const isAdvance = type === '' || type?.includes('');\n  \n  if (isAdvance) {\n    return (\n      <span className=\"badge-stats bg-red-500 text-white\">\n        \n      </span>\n    );\n  }\n  \n  return (\n    <span className=\"badge-stats bg-gray-500 text-white\">\n      \n    </span>\n  );\n});\n\nProgressTypeBadge.displayName = 'ProgressTypeBadge';\n\n//    \nconst TableRow = memo(({ purchase, onClick, activeTab, isLeadBuyer, onPaymentComplete, onReceiptComplete, onExcelDownload, columnVisibility, vendorColumnWidth }: { \n  purchase: Purchase; \n  onClick: (purchase: Purchase) => void;\n  activeTab?: string;\n  isLeadBuyer?: boolean;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n  onExcelDownload?: (purchase: Purchase) => Promise<void>;\n  columnVisibility?: ColumnVisibility;\n  vendorColumnWidth?: number;\n}) => {\n  const isAdvance = purchase.progress_type === '' || purchase.progress_type?.includes('');\n  \n  //    \n  const isVisible = (columnId: DoneTabColumnId) => {\n    //      \n    if (!columnVisibility) return true;\n    return columnVisibility[columnId] !== false;\n  };\n  \n  return (\n    <tr \n      className={`border-b hover:bg-gray-100 cursor-pointer transition-colors ${isAdvance ? 'bg-red-50 hover:bg-red-100' : ''}`}\n      onClick={() => onClick(purchase)}\n    >\n      {/* /      */}\n      {(activeTab === 'pending' || activeTab === 'purchase') && (\n        <td className={`px-2 py-1.5 whitespace-nowrap ${COMMON_COLUMN_CLASSES.approvalStatus}`}>\n          <ApprovalStatusBadge purchase={purchase} />\n        </td>\n      )}\n      {/*       */}\n      {activeTab === 'receipt' && isVisible('receipt_progress') && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <ReceiptProgressBar purchase={purchase} />\n        </td>\n      )}\n      {/*    */}\n      {activeTab === 'done' && isVisible('statement_progress') && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <StatementProgressBar purchase={purchase} />\n        </td>\n      )}\n      {/*   */}\n      {isVisible('purchase_order_number') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}>\n        <div className=\"flex items-center gap-1\">\n          {/*    -  ,   / */}\n          {onExcelDownload && (\n            <img\n              src=\"/excels-icon.svg\"\n              alt=\" \"\n              width=\"16\"\n              height=\"16\"\n              className={`inline-block align-middle transition-transform p-0.5 rounded\n                ${purchase.is_po_download ? 'border border-gray-400' : ''}\n                ${(purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                  (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved'))\n                  ? (purchase.is_po_download ? 'cursor-pointer' : 'cursor-pointer hover:scale-110')\n                  : 'opacity-40 grayscale cursor-not-allowed'}`}\n              onClick={async (e: React.MouseEvent) => {\n                if (purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                    (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')) {\n                  e.stopPropagation();\n                  await onExcelDownload(purchase);\n                }\n              }}\n              style={{\n                pointerEvents: (purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                  (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved'))\n                  ? 'auto' : 'none'\n              }}\n              title={purchase.is_po_download ? ' ' : '  '}\n            />\n          )}\n          <span className=\"block truncate\" title={purchase.purchase_order_number || ''}>\n            {purchase.purchase_order_number || '-'}\n            {purchase.purchase_request_items && purchase.purchase_request_items.length > 1 && (\n              <span className=\"text-gray-500 ml-0.5\">({purchase.purchase_request_items.length})</span>\n            )}\n          </span>\n        </div>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('payment_category') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}>\n          <span className={`badge-stats ${\n            purchase.payment_category === '' || purchase.payment_category === ' ' ? 'bg-blue-500 text-white' :\n            purchase.payment_category === '' ? 'bg-green-500 text-white' :\n            purchase.payment_category === '' || purchase.payment_category === ' ' ? 'bg-gray-500 text-white' :\n            purchase.payment_category === ' ' ? 'bg-gray-500 text-white' :\n            'bg-gray-500 text-white'\n          }`}>\n            {(() => {\n              //   \n              if (purchase.payment_category === '') return '';\n              if (purchase.payment_category === ' ') return '';\n              if (purchase.payment_category === ' ') return '';\n              return purchase.payment_category || '-';\n            })()}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('requester_name') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.requesterName}`}>\n          <span className=\"block truncate\" title={purchase.requester_name || ''}>\n            {purchase.requester_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('request_date') && (\n        <td className={`py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.requestDate}`}>\n          {formatDateShort(purchase.request_date)}\n        </td>\n      )}\n      {/* UTK   */}\n      {activeTab === 'done' && isVisible('utk_status') && (\n        <td className={`pl-2 pr-3 py-1.5 card-title whitespace-nowrap text-center overflow-visible text-clip ${COMMON_COLUMN_CLASSES.utk}`}>\n          <span className={(purchase as any).is_utk_checked ? 'badge-utk-complete' : 'badge-utk-pending'}>\n            {(purchase as any).is_utk_checked ? '' : ''}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('vendor_name') && (\n        <td \n          className={`pl-3 pr-2 py-1.5 card-title ${activeTab === 'done' ? COMMON_COLUMN_CLASSES.vendorName : 'vendor-dynamic-column'}`}\n          style={activeTab === 'done' ? undefined : { \n            width: `${vendorColumnWidth || 80}px`, \n            minWidth: `${vendorColumnWidth || 80}px`, \n            maxWidth: `${vendorColumnWidth || 80}px` \n          }}\n        >\n          <span className=\"block truncate\" title={purchase.vendor_name || ''}>\n            {purchase.vendor_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('contact_name') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.contactName}`}>\n          <span className=\"block truncate\" title={purchase.contact_name || ''}>\n            {purchase.contact_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('delivery_request_date') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.deliveryRequestDate} ${\n          purchase.revised_delivery_request_date ? 'text-gray-400' : ''\n        }`}>\n          {formatDateShort(purchase.delivery_request_date)}\n        </td>\n      )}\n      {/*   */}\n      {(activeTab === 'receipt' || activeTab === 'done') && isVisible('revised_delivery_date') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.revisedDeliveryRequestDate}`}>\n          {formatDateShort(purchase.revised_delivery_request_date)}\n        </td>\n      )}\n      {/*   */}\n      {isVisible('item_name') && (\n        <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.itemName}`}>\n          <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.item_name || ''}>\n            {purchase.purchase_request_items?.[0]?.item_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('specification') && (\n        <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.specification}`}>\n          <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.specification || ''}>\n            {purchase.purchase_request_items?.[0]?.specification || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('quantity') && (\n        <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.quantity}`}>\n          {(activeTab === 'receipt' || activeTab === 'done') ? (\n            (() => {\n              const quantity = purchase.purchase_request_items?.[0]?.quantity || 0\n              const receivedQuantity = purchase.purchase_request_items?.[0]?.received_quantity ?? 0\n              const shouldWrap = quantity >= 100 || receivedQuantity >= 100\n              const hasReceived = receivedQuantity > 0\n              \n              if (shouldWrap) {\n                return (\n                  <div className=\"flex flex-col items-center leading-tight\">\n                    <div className={hasReceived ? 'text-gray-400' : ''}>{quantity}</div>\n                    <div className={hasReceived ? '' : 'text-gray-400'}>/{receivedQuantity}</div>\n                  </div>\n                )\n              } else {\n                return (\n                  <span>\n                    <span className={hasReceived ? 'text-gray-400' : ''}>{quantity}</span>\n                    <span className={hasReceived ? '' : 'text-gray-400'}>/{receivedQuantity}</span>\n                  </span>\n                )\n              }\n            })()\n          ) : (\n            purchase.purchase_request_items?.[0]?.quantity || 0\n          )}\n        </td>\n      )}\n      {/*   */}\n      {isVisible('unit_price') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}>\n          {purchase.purchase_request_items?.[0]?.unit_price_value ? `${purchase.purchase_request_items[0].unit_price_value.toLocaleString()} ${getCurrencySymbol(purchase.purchase_request_items[0]?.unit_price_currency || 'KRW')}` : `0 ${getCurrencySymbol(purchase.purchase_request_items?.[0]?.unit_price_currency || 'KRW')}`}\n        </td>\n      )}\n      {/*   */}\n      {isVisible('amount') && (\n        <td className={`px-2 py-1.5 card-amount whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}>\n          {purchase.purchase_request_items?.[0]?.amount_value ? `${purchase.purchase_request_items[0].amount_value.toLocaleString()} ${getCurrencySymbol(purchase.purchase_request_items[0]?.amount_currency || 'KRW')}` : purchase.total_amount ? `${purchase.total_amount.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : `0 ${getCurrencySymbol(purchase.currency || 'KRW')}`}\n        </td>\n      )}\n      \n      {/*     */}\n      {(activeTab === 'pending' || activeTab === 'purchase') && (\n        <>\n          {isVisible('remark') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n              <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.remark || ''}>\n                {purchase.purchase_request_items?.[0]?.remark || '-'}\n              </span>\n            </td>\n          )}\n          {activeTab === 'purchase' && isVisible('link') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.link}`}>\n              {purchase.purchase_request_items?.[0]?.link ? (\n                <a \n                  href={purchase.purchase_request_items?.[0]?.link} \n                  target=\"_blank\" \n                  rel=\"noopener noreferrer\" \n                  className=\"text-blue-600 hover:text-blue-800 underline truncate block\"\n                  title={purchase.purchase_request_items?.[0]?.link}\n                >\n                   \n                </a>\n              ) : (\n                <span className=\"text-gray-400\">-</span>\n              )}\n            </td>\n          )}\n          {isVisible('project_vendor') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n              <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n                {purchase.project_vendor || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('project_item') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n              <span className=\"block truncate\" title={purchase.project_item || ''}>\n                {purchase.project_item || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('sales_order_number') && (\n            <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n              <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n                {purchase.sales_order_number || '-'}\n              </span>\n            </td>\n          )}\n        </>\n      )}\n      \n      \n      {activeTab === 'receipt' && (\n        <>\n          {isVisible('remark') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n              <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.remark || ''}>\n                {purchase.purchase_request_items?.[0]?.remark || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('project_vendor') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n              <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n                {purchase.project_vendor || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('project_item') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n              <span className=\"block truncate\" title={purchase.project_item || ''}>\n                {purchase.project_item || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('sales_order_number') && (\n            <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n              <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n                {purchase.sales_order_number || '-'}\n              </span>\n            </td>\n          )}\n        </>\n      )}\n      \n      {(activeTab === 'done' || !activeTab) && (\n        <>\n          {/*   */}\n          {isVisible('remark') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n              <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.remark || ''}>\n                {purchase.purchase_request_items?.[0]?.remark || '-'}\n              </span>\n            </td>\n          )}\n          {/*   */}\n          {isVisible('link') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.link}`}>\n              {purchase.purchase_request_items?.[0]?.link ? (\n                <a \n                  href={purchase.purchase_request_items?.[0]?.link} \n                  target=\"_blank\" \n                  rel=\"noopener noreferrer\" \n                  className=\"text-blue-600 hover:text-blue-800 underline truncate block\"\n                  title={purchase.purchase_request_items?.[0]?.link}\n                >\n                   \n                </a>\n              ) : (\n                <span className=\"text-gray-400\">-</span>\n              )}\n            </td>\n          )}\n          {/* PJ  */}\n          {isVisible('project_vendor') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n              <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n                {purchase.project_vendor || '-'}\n              </span>\n            </td>\n          )}\n          {/* PJ ITEM  */}\n          {isVisible('project_item') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n              <span className=\"block truncate\" title={purchase.project_item || ''}>\n                {purchase.project_item || '-'}\n              </span>\n            </td>\n          )}\n          {/*   */}\n          {isVisible('sales_order_number') && (\n            <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n              <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n                {purchase.sales_order_number || '-'}\n              </span>\n            </td>\n          )}\n          {/*   */}\n          {isVisible('purchase_progress') && activeTab !== 'purchase' && (\n            <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.status}`}>\n              <PaymentProgressBar purchase={purchase} activeTab={activeTab} />\n            </td>\n          )}\n          {/*   */}\n          {isVisible('receipt_progress') && (\n            <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receipt} ${activeTab === 'done' ? 'column-progress' : ''}`}>\n              <ReceiptProgressBar purchase={purchase} />\n            </td>\n          )}\n        </>\n      )}\n      \n    </tr>\n  );\n});\n\nTableRow.displayName = 'TableRow';\n\n//   \nconst FastPurchaseTable = ({ \n  purchases, \n  activeTab = 'done', \n  currentUserRoles = [], \n  onRefresh,\n  onOptimisticUpdate,\n  onPaymentComplete,\n  onReceiptComplete,\n  columnVisibility\n}: FastPurchaseTableProps) => {\n  //  \n  useEffect(() => {\n    logger.info('[FastPurchaseTable] columnVisibility ', { columnVisibility });\n  }, [columnVisibility]);\n  const [selectedPurchaseId, setSelectedPurchaseId] = useState<number | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [deleteConfirmOpen, setDeleteConfirmOpen] = useState(false);\n  const [purchaseToDelete, setPurchaseToDelete] = useState<Purchase | null>(null);\n  // vendorColumnWidth  useMemo  \n  const supabase = createClient();\n\n  //   - lead buyer app_admin /   \n  const isLeadBuyer = currentUserRoles && (\n    currentUserRoles.includes('lead buyer') ||\n    currentUserRoles.includes('app_admin')\n  );\n  \n\n  //  \n  const canEdit = currentUserRoles.includes('final_approver') || \n                  currentUserRoles.includes('app_admin') || \n                  currentUserRoles.includes('ceo');\n  \n  const canDelete = canEdit;\n\n  //      (useState useEffect   )\n  const vendorColumnWidth = useMemo(() => {\n    if (!purchases || purchases.length === 0) return 80;\n\n    //        \n    const cacheKey = `${activeTab}-${purchases.length}`;\n    \n    let maxLength = 2; // \"\"  \n\n    //  :  100  \n    const sampleSize = Math.min(purchases.length, 100);\n    const sampledPurchases = purchases.slice(0, sampleSize);\n    \n    sampledPurchases.forEach(purchase => {\n      const vendorName = purchase.vendor_name || '';\n      // /     ( 1.5 )\n      const adjustedLength = vendorName.split('').reduce((acc, char) => {\n        return acc + (/[-]/.test(char) ? 1.5 : 1)\n      }, 0);\n      maxLength = Math.max(maxLength, Math.ceil(adjustedLength));\n    });\n\n    //    (  7px +  20px)\n    const calculatedWidth = Math.max(80, Math.min(200, maxLength * 7 + 20));\n    console.log(' [FastPurchaseTable]    :', { \n      activeTab,\n      maxLength,\n      calculatedWidth,\n      sampleSize,\n      firstVendor: sampledPurchases[0]?.vendor_name \n    });\n    return calculatedWidth;\n  }, [purchases, activeTab]);\n\n  const handleRowClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchaseId(purchase.id);\n    setIsModalOpen(true);\n  }, []);\n\n  const handleCloseModal = useCallback(() => {\n    setIsModalOpen(false);\n    setSelectedPurchaseId(null);\n  }, []);\n\n  //   \n  const handleExcelDownload = useCallback(async (purchase: Purchase) => {\n    try {\n      // DB    \n      const { data: purchaseRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .single();\n\n      if (requestError || !purchaseRequest) {\n        toast.error('     .');\n        return;\n      }\n\n      //   \n      const { data: orderItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .order('line_number');\n\n      if (itemsError || !orderItems || orderItems.length === 0) {\n        toast.error('      .');\n        return;\n      }\n\n      //       \n      const vendorInfo = {\n        vendor_name: purchase.vendor_name,\n        vendor_phone: '',\n        vendor_fax: '',\n        vendor_contact_name: '',\n        vendor_payment_schedule: ''\n      };\n\n      try {\n        const vendorId = purchaseRequest.vendor_id || purchase.vendor_id;\n        const contactId = purchaseRequest.contact_id || purchase.contact_id;\n        \n        // vendor  \n        if (vendorId) {\n          const { data: vendorData } = await supabase\n            .from('vendors')\n            .select('vendor_phone, vendor_fax, vendor_payment_schedule')\n            .eq('id', vendorId)\n            .single();\n\n          if (vendorData) {\n            vendorInfo.vendor_phone = vendorData.vendor_phone || '';\n            vendorInfo.vendor_fax = vendorData.vendor_fax || '';\n            vendorInfo.vendor_payment_schedule = vendorData.vendor_payment_schedule || '';\n          }\n        }\n\n        // vendor_contacts contact_id   \n        if (contactId) {\n          const { data: contactData } = await supabase\n            .from('vendor_contacts')\n            .select('contact_name, contact_phone, contact_email')\n            .eq('id', contactId)\n            .single();\n          if (contactData) {\n            vendorInfo.vendor_contact_name = contactData.contact_name || '';\n          }\n        }\n      } catch (error) {\n        //     \n      }\n\n      const excelData: PurchaseOrderData = {\n        purchase_order_number: purchaseRequest.purchase_order_number || '',\n        request_date: purchaseRequest.request_date,\n        delivery_request_date: purchaseRequest.delivery_request_date,\n        requester_name: purchaseRequest.requester_name,\n        vendor_name: vendorInfo.vendor_name || '',\n        vendor_contact_name: vendorInfo.vendor_contact_name,\n        vendor_phone: vendorInfo.vendor_phone,\n        vendor_fax: vendorInfo.vendor_fax,\n        project_vendor: purchaseRequest.project_vendor,\n        sales_order_number: purchaseRequest.sales_order_number,\n        project_item: purchaseRequest.project_item,\n        vendor_payment_schedule: vendorInfo.vendor_payment_schedule,\n        items: orderItems.map((item: any) => ({\n          line_number: item.line_number,\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          amount_value: item.amount_value,\n          remark: item.remark,\n          currency: purchaseRequest.currency || 'KRW'\n        }))\n      };\n\n      //   ExcelJS \n      const blob = await generatePurchaseOrderExcelJS(excelData);\n      \n      //  \n      const downloadFilename = `_${excelData.vendor_name}_${excelData.purchase_order_number}.xlsx`;\n\n      //  \n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = downloadFilename;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success('  .');\n      \n      // DB   (is_po_download)  - lead buyer \n      try {\n        const canUpdateFlag = currentUserRoles && (\n          currentUserRoles.includes('lead buyer')\n        );\n\n        if (canUpdateFlag) {\n          const { error: downloadFlagErr } = await supabase\n            .from('purchase_requests')\n            .update({ is_po_download: true })\n            .eq('purchase_order_number', purchase.purchase_order_number);\n          \n          if (!downloadFlagErr) {\n            //  \n            onRefresh?.();\n          }\n        }\n      } catch (flagErr) {\n        //    \n      }\n    } catch (error) {\n      toast.error('  .');\n    }\n  }, [supabase]);\n\n  const handleConfirmDelete = useCallback(async () => {\n    if (!purchaseToDelete) return;\n\n\n    try {\n      // Supabase   \n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n      const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n      \n      if (!supabaseUrl || !supabaseAnonKey || supabaseUrl.includes('placeholder')) {\n        logger.warn('Supabase     - FastPurchaseTable');\n        toast.error(\"   .\");\n        return;\n      }\n\n      //    \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      \n      if (authError || !user) {\n        toast.error(\" .\");\n        return;\n      }\n\n      //   \n      const { data: employee, error: empError } = await supabase\n        .from('employees')\n        .select('name, email, purchase_role')\n        .eq('email', user.email)\n        .single();\n\n\n      if (empError || !employee) {\n        toast.error(\"    .\");\n        return;\n      }\n\n      //  \n      let roles: string[] = [];\n      if (employee.purchase_role) {\n        if (Array.isArray(employee.purchase_role)) {\n          roles = employee.purchase_role.map((r: any) => String(r).trim());\n        } else {\n          const roleString = String(employee.purchase_role);\n          roles = roleString.split(',').map((r: string) => r.trim()).filter((r: string) => r.length > 0);\n        }\n      }\n\n      const canEdit = roles.includes('final_approver') || \n                      roles.includes('app_admin') || \n                      roles.includes('ceo');\n      \n      const isApproved = purchaseToDelete.final_manager_status === 'approved';\n      const isRequester = purchaseToDelete.requester_name === employee.name;\n      const canDeleteThis = isApproved ? canEdit : (canEdit || isRequester);\n\n\n      if (!canDeleteThis) {\n        toast.error(\"  .\");\n        return;\n      }\n\n\n      //   \n      const { data: deletedItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .delete()\n        .eq('purchase_request_id', purchaseToDelete.id)\n        .select();\n\n      if (itemsError) {\n        logger.error('    ', itemsError, {\n          code: itemsError.code,\n          message: itemsError.message,\n          details: itemsError.details,\n          hint: itemsError.hint\n        });\n        throw itemsError;\n      }\n\n\n      //  \n      const { data: deletedRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .delete()\n        .eq('id', purchaseToDelete.id)\n        .select();\n\n      if (requestError) {\n        logger.error('    ', requestError, {\n          code: requestError.code,\n          message: requestError.message,\n          details: requestError.details,\n          hint: requestError.hint\n        });\n        throw requestError;\n      }\n\n\n      //      (   )\n      const memoryUpdated = removePurchaseFromMemory(purchaseToDelete.id);\n      if (!memoryUpdated) {\n        logger.warn('[handleConfirmDelete]     ', { \n          purchaseId: purchaseToDelete.id \n        });\n      } else {\n        logger.info(' [handleConfirmDelete]     ', { \n          purchaseId: purchaseToDelete.id \n        });\n      }\n\n      toast.success(\"  .\");\n      onRefresh?.();\n    } catch (error) {\n      const errorObj = error as any;\n      logger.error('    ', errorObj, {\n        name: errorObj?.name,\n        message: errorObj?.message,\n        code: errorObj?.code,\n        details: errorObj?.details,\n        hint: errorObj?.hint,\n        stack: errorObj?.stack\n      });\n      toast.error(`   : ${errorObj?.message || '   '}`);\n    }\n    \n    setDeleteConfirmOpen(false);\n    setPurchaseToDelete(null);\n  }, [supabase, purchaseToDelete, onRefresh]);\n\n  //     \n  const isColumnVisible = useCallback((columnId: DoneTabColumnId) => {\n    if (!columnVisibility) return true; // columnVisibility    \n    return columnVisibility[columnId] !== false;\n  }, [columnVisibility]);\n\n  //    \n  const tableHeader = useMemo(() => {\n    if (activeTab === 'pending' || activeTab === 'purchase') {\n      return (\n        <thead className=\"bg-gray-50\">\n          <tr>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.approvalStatus}`}></th>\n            {isColumnVisible('purchase_order_number') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}></th>\n            )}\n            {isColumnVisible('payment_category') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}></th>\n            )}\n            {isColumnVisible('requester_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requesterName}`}></th>\n            )}\n            {isColumnVisible('request_date') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requestDate}`}></th>\n            )}\n            {isColumnVisible('vendor_name') && (\n              <th \n                className=\"px-2 py-1.5 modal-label text-gray-900 text-left vendor-dynamic-column\"\n                style={{ \n                  width: `${vendorColumnWidth || 80}px`, \n                  minWidth: `${vendorColumnWidth || 80}px`, \n                  maxWidth: `${vendorColumnWidth || 80}px` \n                }}\n              ></th>\n            )}\n            {isColumnVisible('contact_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.contactName}`}></th>\n            )}\n            {isColumnVisible('delivery_request_date') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.deliveryRequestDate}`}></th>\n            )}\n            {isColumnVisible('item_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.itemName}`}></th>\n            )}\n            {isColumnVisible('specification') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.specification}`}></th>\n            )}\n            {isColumnVisible('quantity') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.quantity}`}></th>\n            )}\n            {isColumnVisible('unit_price') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}></th>\n            )}\n            {isColumnVisible('amount') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}></th>\n            )}\n            {isColumnVisible('remark') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n            )}\n            {activeTab === 'purchase' && isColumnVisible('link') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.link}`}></th>\n            )}\n            {isColumnVisible('project_vendor') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n            )}\n            {isColumnVisible('project_item') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n            )}\n            {isColumnVisible('sales_order_number') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n            )}\n          </tr>\n        </thead>\n      );\n    }\n    \n    const baseHeaders = (\n      <>\n        {isColumnVisible('purchase_order_number') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}></th>\n        )}\n        {isColumnVisible('payment_category') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}></th>\n        )}\n        {isColumnVisible('requester_name') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requesterName}`}></th>\n        )}\n        {isColumnVisible('request_date') && (\n          <th className={`py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.requestDate}`}></th>\n        )}\n        {/*   UTK     */}\n        {activeTab === 'done' && isColumnVisible('utk_status') && (\n          <th className={`pl-2 pr-3 py-1.5 modal-label text-gray-900 whitespace-nowrap text-center ${COMMON_COLUMN_CLASSES.utk}`}>UTK</th>\n        )}\n        {isColumnVisible('vendor_name') && (\n          <th \n            className={`px-2 py-1.5 modal-label text-gray-900 text-left ${activeTab === 'done' ? COMMON_COLUMN_CLASSES.vendorName : 'vendor-dynamic-column'}`}\n            style={activeTab === 'done' ? undefined : { \n              width: `${vendorColumnWidth || 80}px`, \n              minWidth: `${vendorColumnWidth || 80}px`, \n              maxWidth: `${vendorColumnWidth || 80}px` \n            }}\n          ></th>\n        )}\n        {isColumnVisible('contact_name') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.contactName}`}></th>\n        )}\n        {isColumnVisible('delivery_request_date') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.deliveryRequestDate}`}></th>\n        )}\n        {(activeTab === 'receipt' || activeTab === 'done') && isColumnVisible('revised_delivery_date') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.revisedDeliveryRequestDate}`}> </th>\n        )}\n        {isColumnVisible('item_name') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.itemName}`}></th>\n        )}\n        {isColumnVisible('specification') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.specification}`}></th>\n        )}\n        {isColumnVisible('quantity') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 ${COMMON_COLUMN_CLASSES.quantity}`}>\n            {(activeTab === 'receipt' || activeTab === 'done') ? (\n              <div className=\"flex flex-col items-center leading-tight\">\n                <div className=\"text-[9px]\">/</div>\n                <div className=\"text-[10px]\"></div>\n              </div>\n            ) : (\n              ''\n            )}\n          </th>\n        )}\n        {isColumnVisible('unit_price') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}></th>\n        )}\n        {isColumnVisible('amount') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}></th>\n        )}\n      </>\n    );\n\n    let additionalHeaders = null;\n    \n    if (activeTab === 'receipt') {\n      additionalHeaders = (\n        <>\n          {isColumnVisible('remark') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n          )}\n          {isColumnVisible('project_vendor') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n          )}\n          {isColumnVisible('project_item') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n          )}\n          {isColumnVisible('sales_order_number') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n          )}\n        </>\n      );\n    } else if (activeTab === 'done') {\n      //  \n      additionalHeaders = (\n        <>\n          {isColumnVisible('remark') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n          )}\n          {isColumnVisible('link') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.link}`}></th>\n          )}\n          {isColumnVisible('project_vendor') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n          )}\n          {isColumnVisible('project_item') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n          )}\n          {isColumnVisible('sales_order_number') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n          )}\n          {isColumnVisible('purchase_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.status}`}></th>\n          )}\n          {isColumnVisible('receipt_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receipt}`}></th>\n          )}\n        </>\n      );\n    }\n\n    return (\n      <thead className=\"bg-gray-50\">\n        <tr>\n          {/*      */}\n          {activeTab === 'receipt' && isColumnVisible('receipt_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n          )}\n          {/*       */}\n          {activeTab === 'done' && isColumnVisible('statement_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n          )}\n          {baseHeaders}\n          {additionalHeaders}\n        </tr>\n      </thead>\n    );\n  }, [activeTab, isColumnVisible, vendorColumnWidth]);\n\n  //        \n  const shouldUseFitLayout = useMemo(() => {\n    if (!columnVisibility) return false;\n    const hasHidden = Object.values(columnVisibility).some(visible => !visible);\n    if (!hasHidden) return false;\n    return true;\n  }, [columnVisibility]);\n\n  //      (100   )\n  const shouldUseVirtualScroll = useMemo(() => {\n    return purchases.length >= 100;\n  }, [purchases.length]);\n\n  return (\n    <>\n      {/*    -   1,979     */}\n      <div className={`hidden md:block ${shouldUseFitLayout ? 'w-fit' : 'w-full'}`}>\n        \n{shouldUseVirtualScroll ? (\n          //     (100  ) - DOM   \n          <VirtualScrollTable\n            purchases={purchases}\n            activeTab={activeTab}\n            onRowClick={handleRowClick}\n            isLeadBuyer={isLeadBuyer}\n            onPaymentComplete={onPaymentComplete}\n            onReceiptComplete={onReceiptComplete}\n            onExcelDownload={handleExcelDownload}\n            columnVisibility={columnVisibility}\n            vendorColumnWidth={vendorColumnWidth}\n            tableHeader={tableHeader}\n            TableRowComponent={TableRow}\n            shouldUseFitLayout={shouldUseFitLayout}\n          />\n        ) : (\n          //   (100  )\n          <div className={shouldUseFitLayout ? 'table-container-fit-left' : 'overflow-x-auto border rounded-lg'}>\n            <table className={shouldUseFitLayout ? `table-fit-left ${activeTab}-tab` : 'w-full min-w-[1790px] border-collapse'}>\n              {tableHeader}\n              <tbody>\n                {purchases.map((purchase) => (\n                  <TableRow \n                    key={purchase.id} \n                    purchase={purchase} \n                    onClick={handleRowClick}\n                    activeTab={activeTab}\n                    isLeadBuyer={isLeadBuyer}\n                    onPaymentComplete={onPaymentComplete}\n                    onReceiptComplete={onReceiptComplete}\n                    onExcelDownload={handleExcelDownload}\n                    vendorColumnWidth={vendorColumnWidth}\n                    columnVisibility={columnVisibility}\n                  />\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n      \n      {/*    */}\n      <div className=\"hidden sm:block md:hidden w-full\">\n        <div className=\"overflow-x-auto border rounded-lg\">\n          <table className=\"w-full min-w-[600px] card-title\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-24\"></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-16\"></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 vendor-dynamic-column\" style={{ width: `${vendorColumnWidth || 80}px` }}></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-32\"></th>\n                <th className=\"text-right p-2 modal-label text-gray-900 w-20\"></th>\n                <th className=\"text-center p-2 modal-label text-gray-900 w-16\"></th>\n              </tr>\n            </thead>\n            <tbody>\n              {purchases.map((purchase) => (\n                <tr \n                  key={purchase.id}\n                  className=\"border-b hover:bg-gray-50 cursor-pointer\"\n                  onClick={() => handleRowClick(purchase)}\n                >\n                  <td className=\"p-2 modal-value\">{purchase.purchase_order_number || '-'}</td>\n                  <td className=\"p-2\">{purchase.requester_name}</td>\n                  <td className=\"p-2 truncate\" title={purchase.vendor_name}>{purchase.vendor_name}</td>\n                  <td className=\"p-2 truncate\" title={purchase.purchase_request_items?.[0]?.item_name}>{purchase.purchase_request_items?.[0]?.item_name || '-'}</td>\n                  <td className=\"p-2 text-right card-amount\">\n                    {purchase.purchase_request_items?.[0]?.amount_value ? `${purchase.purchase_request_items[0].amount_value.toLocaleString()} ${getCurrencySymbol(purchase.purchase_request_items[0]?.amount_currency || 'KRW')}` : purchase.total_amount ? `${purchase.total_amount.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : `0 ${getCurrencySymbol(purchase.currency || 'KRW')}`}\n                  </td>\n                  <td className=\"p-2 text-center\">\n                    <StatusBadge purchase={purchase} />\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      \n      {/*    */}\n      <div className=\"sm:hidden space-y-3\">\n        {purchases.map((purchase) => (\n          <MobilePurchaseCard\n            key={purchase.id}\n            purchase={purchase}\n            onClick={() => handleRowClick(purchase)}\n          />\n        ))}\n      </div>\n      \n      {/*  /  */}\n      <PurchaseDetailModal\n        purchaseId={selectedPurchaseId}\n        isOpen={isModalOpen}\n        onClose={handleCloseModal}\n        currentUserRoles={currentUserRoles}\n        activeTab={activeTab}\n        onRefresh={onRefresh}\n        onOptimisticUpdate={onOptimisticUpdate}\n        onDelete={(purchase) => {\n          setPurchaseToDelete(purchase as unknown as Purchase);\n          setDeleteConfirmOpen(true);\n        }}\n      />\n\n      {/*    */}\n      <AlertDialog open={deleteConfirmOpen} onOpenChange={setDeleteConfirmOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>  </AlertDialogTitle>\n            <AlertDialogDescription>\n               {purchaseToDelete?.purchase_order_number} ?\n                  .\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel></AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmDelete}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              \n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  );\n};\n\nFastPurchaseTable.displayName = 'FastPurchaseTable';\n\nexport default FastPurchaseTable;","import { useState, useRef, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { \n  Sliders, \n  ArrowUpDown, \n  Search, \n  X, \n  Calendar,\n  Check,\n  User,\n  Building,\n  Package,\n  DollarSign,\n  CheckCircle\n} from 'lucide-react'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Calendar as CalendarComponent } from '@/components/ui/calendar'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\n\n//   \ntype FilterCondition = 'contains' | 'equals' | 'starts_with' | 'ends_with' | 'is_empty' | 'is_not_empty' | 'greater_than' | 'less_than' | 'after' | 'before' | 'not_equals'\n\n//   \nexport interface FilterRule {\n  id: string\n  field: string\n  condition: FilterCondition\n  value: string | number | Date\n  label: string\n  dateField?: string // /    \n}\n\nexport interface SortRule {\n  field: string\n  direction: 'asc' | 'desc'\n  label: string\n}\n\ninterface FilterToolbarProps {\n  activeFilters: FilterRule[]\n  sortConfig: SortRule | null\n  searchTerm: string\n  onFiltersChange: (filters: FilterRule[]) => void\n  onSortChange: (sort: SortRule | null) => void\n  onSearchChange: (search: string) => void\n  availableEmployees?: string[]\n  availableVendors?: string[]\n  availableContacts?: string[]\n  availablePaymentSchedules?: string[]\n  children?: React.ReactNode //      \n}\n\n//   \nconst FILTER_FIELDS = [\n  //  \n  { \n    key: 'date_range', \n    label: '', \n    type: 'date_range',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'date_month', \n    label: '', \n    type: 'date_month',\n    icon: Calendar,\n    category: ''\n  },\n  \n  // & \n  { \n    key: 'requester_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  { \n    key: 'vendor_name', \n    label: '', \n    type: 'searchable_select',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'contact_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'purchase_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'item_name', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'specification', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'remark', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'project_vendor', \n    label: 'PJ', \n    type: 'text',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'project_item', \n    label: 'PJ ITEM', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'sales_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'quantity', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'unit_price_value', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'total_amount', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'payment_category', \n    label: '', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '', '']\n  },\n  { \n    key: 'payment_schedule', \n    label: '', \n    type: 'select_with_empty',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'is_payment_completed', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_received', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_statement_received', \n    label: ' ', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_utk_checked', \n    label: 'UTK ', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '']\n  }\n]\n\n//   \nconst TEXT_CONDITIONS = [\n  { value: 'contains', label: '' },\n  { value: 'equals', label: '' },\n  { value: 'starts_with', label: '' },\n  { value: 'ends_with', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst NUMBER_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'greater_than', label: '' },\n  { value: 'less_than', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst DATE_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'after', label: '' },\n  { value: 'before', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst SELECT_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'not_equals', label: '' }\n]\n\n//    \nconst DATE_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'payment_completed_at', label: '' },\n  { value: 'received_at', label: '' },\n  { value: 'created_at', label: '' },\n  { value: 'statement_received_at', label: '' }\n]\n\n//   \nconst SORT_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'purchase_order_number', label: '' },\n  { value: 'vendor_name', label: '' },\n  { value: 'requester_name', label: '' },\n  { value: 'total_amount', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'created_at', label: '' }\n]\n\nexport default function FilterToolbar({\n  activeFilters,\n  sortConfig,\n  searchTerm,\n  onFiltersChange,\n  onSortChange,\n  onSearchChange,\n  availableEmployees = [],\n  availableVendors = [],\n  availableContacts = [],\n  availablePaymentSchedules = [],\n  children\n}: FilterToolbarProps) {\n  const [isFilterOpen, setIsFilterOpen] = useState(false)\n  const [isSortOpen, setIsSortOpen] = useState(false)\n  const [isSearchExpanded, setIsSearchExpanded] = useState(false)\n  const [newFilter, setNewFilter] = useState<Partial<FilterRule>>({})\n  const [datePickerOpen, setDatePickerOpen] = useState(false)\n  const [monthPickerOpen, setMonthPickerOpen] = useState(false)\n  const [tempDateRange, setTempDateRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempMonth, setTempMonth] = useState<Date | undefined>()\n  const [tempMonthRange, setTempMonthRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempSort, setTempSort] = useState<{field?: string, direction?: 'asc' | 'desc'}>({})\n  const [searchValue, setSearchValue] = useState('')\n  const searchInputRef = useRef<HTMLInputElement>(null)\n\n  //    \n  useEffect(() => {\n    if (isSearchExpanded && searchInputRef.current) {\n      searchInputRef.current.focus()\n    }\n  }, [isSearchExpanded])\n\n  //       \n  useEffect(() => {\n    if (isSortOpen) {\n      setTempSort({\n        field: sortConfig?.field || '',\n        direction: sortConfig?.direction || 'asc'\n      })\n    }\n  }, [isSortOpen, sortConfig])\n\n  const handleAddFilter = (field: string) => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === field)\n    if (!fieldConfig) return\n\n    //      \n    let defaultCondition = 'contains'\n    if (fieldConfig.type === 'date_range' || fieldConfig.type === 'date_month') {\n      defaultCondition = 'equals'\n    }\n\n    setNewFilter({\n      id: `${field}_${Date.now()}`,\n      field,\n      condition: defaultCondition,\n      value: '',\n      label: fieldConfig.label\n    })\n  }\n\n  const handleApplyFilter = () => {\n    const isDateFilter = newFilter.field === 'date_range' || newFilter.field === 'date_month'\n    const requiresDateField = isDateFilter && !newFilter.dateField\n    \n    //      \n    let finalCondition = newFilter.condition\n    if (!finalCondition) {\n      if (isDateFilter) {\n        finalCondition = 'equals'\n      } else {\n        //   'contains',   'equals'\n        const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n        finalCondition = (fieldConfig?.type === 'select' || fieldConfig?.type === 'select_with_empty' || fieldConfig?.type === 'searchable_select') \n          ? 'equals' \n          : 'contains'\n      }\n    }\n    \n    if (newFilter.field && finalCondition !== undefined && newFilter.value !== '' && !requiresDateField) {\n      const filter: FilterRule = {\n        id: newFilter.id!,\n        field: newFilter.field,\n        condition: finalCondition,\n        value: newFilter.value,\n        label: newFilter.label!,\n        dateField: newFilter.dateField //    \n      }\n      onFiltersChange([...activeFilters, filter])\n      setNewFilter({})\n      setIsFilterOpen(false)\n    }\n  }\n\n  const handleRemoveFilter = (filterId: string) => {\n    onFiltersChange(activeFilters.filter(f => f.id !== filterId))\n  }\n\n  const handleClearAllFilters = () => {\n    onFiltersChange([])\n    setIsFilterOpen(false)\n  }\n\n  const handleSortFieldChange = (field: string) => {\n    setTempSort(prev => ({ ...prev, field }))\n  }\n\n  const handleSortDirectionChange = (direction: 'asc' | 'desc') => {\n    setTempSort(prev => ({ ...prev, direction }))\n  }\n\n  const handleApplySort = () => {\n    if (tempSort.field && tempSort.direction) {\n      const fieldConfig = SORT_FIELDS.find(f => f.value === tempSort.field)\n      if (fieldConfig) {\n        onSortChange({\n          field: tempSort.field,\n          direction: tempSort.direction,\n          label: fieldConfig.label\n        })\n      }\n    }\n    setIsSortOpen(false)\n    setTempSort({})\n  }\n\n  const handleClearSort = () => {\n    onSortChange(null)\n    setTempSort({})\n    setIsSortOpen(false)\n  }\n\n  const getConditionOptions = (fieldType: string) => {\n    switch (fieldType) {\n      case 'text':\n      case 'searchable_select':\n        return TEXT_CONDITIONS\n      case 'number':\n        return NUMBER_CONDITIONS\n      case 'date_range':\n      case 'date_month':\n        return DATE_CONDITIONS\n      case 'select':\n      case 'select_with_empty':\n        return SELECT_CONDITIONS\n      default:\n        return TEXT_CONDITIONS\n    }\n  }\n\n  const renderValueInput = () => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n    if (!fieldConfig) return null\n\n    switch (fieldConfig.type) {\n      case 'text':\n        return (\n          <Input\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n      \n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n\n      case 'searchable_select':\n        let options: string[] = []\n        let placeholder = \"\"\n        if (fieldConfig.key === 'requester_name') {\n          options = availableEmployees\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'vendor_name') {\n          options = availableVendors\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'contact_name') {\n          options = availableContacts\n          placeholder = \"\"\n        }\n\n        //   \n        const filteredOptions = options.filter(option => \n          option.toLowerCase().includes(searchValue.toLowerCase())\n        )\n\n        return (\n          <Popover onOpenChange={(open) => {\n            if (!open) {\n              setSearchValue('')\n            }\n          }}>\n            <PopoverTrigger asChild>\n              <Button\n                variant=\"outline\"\n                role=\"combobox\"\n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between [&>svg]:hidden\"\n              >\n                <span className=\"truncate text-left\" style={{fontSize: '12px', fontWeight: '500'}}>\n                  {newFilter.value || placeholder}\n                </span>\n                <Search className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-[200px] p-1 border-0 shadow-lg\" align=\"start\">\n              <div className=\"space-y-1\">\n                {/*    */}\n                <Input\n                  placeholder={`${placeholder} ...`}\n                  className=\"h-auto border-0 focus:ring-0 focus:outline-none card-description placeholder:card-description\"\n                  style={{padding: '2px 10px'}}\n                  value={searchValue}\n                  onChange={(e) => setSearchValue(e.target.value)}\n                  autoFocus\n                />\n                \n                {/*   - Command   div  */}\n                <div className=\"max-h-[200px] overflow-y-auto\">\n                  {filteredOptions.length === 0 ? (\n                    <div className=\"p-2 text-sm text-gray-500\">\n                      {searchValue ? '  ' : `${placeholder}   `}\n                    </div>\n                  ) : (\n                    filteredOptions.map(option => (\n                      <Button\n                        key={option}\n                        variant=\"ghost\"\n                        onClick={() => {\n                          setNewFilter(prev => ({ ...prev, value: option }))\n                          setSearchValue('')\n                        }}\n                        className=\"w-full justify-start p-2 h-auto hover:bg-gray-100 text-left\"\n                      >\n                        <Check\n                          className={`mr-2 h-3 w-3 ${\n                            newFilter.value === option ? \"opacity-100\" : \"opacity-0\"\n                          }`}\n                        />\n                        <span className=\"card-description\">{option}</span>\n                      </Button>\n                    ))\n                  )}\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'select':\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {fieldConfig.options?.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'select_with_empty':\n        const scheduleOptions = ['', ...availablePaymentSchedules]\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {scheduleOptions.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'date_range':\n        return (\n          <Popover open={datePickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempDateRange({\n                    from: new Date(start),\n                    to: new Date(end)\n                  });\n                } else {\n                  setTempDateRange({\n                    from: new Date(newFilter.value),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempDateRange({});\n              }\n            }\n            setDatePickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5 min-h-[32px]\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        return `${format(new Date(start), 'yy/MM/dd')}\\n~ ${format(new Date(end), 'yy/MM/dd')}`;\n                      } else {\n                        return format(new Date(newFilter.value), 'yy/MM/dd');\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-2\">  </div>\n                  <CalendarComponent\n                    mode=\"range\"\n                    selected={tempDateRange}\n                    onSelect={(range) => {\n                      if (range) {\n                        setTempDateRange(range);\n                      }\n                    }}\n                    numberOfMonths={1}\n                    initialFocus\n                    className=\"compact-calendar\"\n                  />\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempDateRange({});\n                      setDatePickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempDateRange.from) {\n                        if (tempDateRange.to) {\n                          // ~ \n                          const rangeValue = `${format(tempDateRange.from, 'yyyy-MM-dd')}~${format(tempDateRange.to, 'yyyy-MM-dd')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  ( )\n                          setNewFilter(prev => ({ ...prev, value: format(tempDateRange.from, 'yyyy-MM-dd') }));\n                        }\n                        setDatePickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempDateRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'date_month':\n        return (\n          <Popover open={monthPickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempMonthRange({\n                    from: new Date(`${start}-01`),\n                    to: new Date(`${end}-01`)\n                  });\n                } else {\n                  setTempMonthRange({\n                    from: new Date(`${newFilter.value}-01`),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempMonthRange({});\n              }\n            }\n            setMonthPickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        const [startYear, startMonth] = start.split('-');\n                        const [endYear, endMonth] = end.split('-');\n                        return `${startYear.slice(-2)}/${startMonth}\\n~ ${endYear.slice(-2)}/${endMonth}`;\n                      } else {\n                        const [year, month] = newFilter.value.split('-');\n                        return `${year.slice(-2)}/${month}`;\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-3\"> </div>\n                  \n                  {/*   -  12  */}\n                  <div className=\"flex gap-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"text-xs text-gray-500 mb-2\">  </div>\n                      {/*   */}\n                      <div className=\"mb-3\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear - 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                          <span className=\"text-sm font-medium text-gray-700\">\n                            {tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear()}\n                          </span>\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear + 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                        </div>\n                      </div>\n                      \n                      {/* 12  */}\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        {Array.from({ length: 12 }, (_, i) => {\n                          const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                          const monthDate = new Date(currentYear, i, 1);\n                          const isSelected = tempMonthRange.from && \n                            tempMonthRange.from.getFullYear() === currentYear && \n                            tempMonthRange.from.getMonth() === i;\n                          \n                          return (\n                            <Button\n                              key={i}\n                              onClick={() => {\n                                setTempMonthRange(prev => ({ ...prev, from: monthDate }));\n                              }}\n                              variant=\"outline\"\n                              className={`button-base text-xs h-8 ${\n                                isSelected \n                                  ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                  : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                              }`}\n                            >\n                              {i + 1}\n                            </Button>\n                          );\n                        })}\n                      </div>\n                    </div>\n                    \n                    {tempMonthRange.from && (\n                      <div className=\"flex-1\">\n                        <div className=\"text-xs text-gray-500 mb-2\">   ()</div>\n                        {/*     */}\n                        <div className=\"mb-3\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear - 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                            <span className=\"text-sm font-medium text-gray-700\">\n                              {tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear()}\n                            </span>\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear + 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                          </div>\n                        </div>\n                        \n                        {/*   12  */}\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {Array.from({ length: 12 }, (_, i) => {\n                            const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                            const monthDate = new Date(currentYear, i, 1);\n                            const isSelected = tempMonthRange.to && \n                              tempMonthRange.to.getFullYear() === currentYear && \n                              tempMonthRange.to.getMonth() === i;\n                            const isDisabled = monthDate < tempMonthRange.from;\n                            \n                            return (\n                              <Button\n                                key={i}\n                                onClick={() => {\n                                  if (!isDisabled) {\n                                    setTempMonthRange(prev => ({ ...prev, to: monthDate }));\n                                  }\n                                }}\n                                variant=\"outline\"\n                                disabled={isDisabled}\n                                className={`button-base text-xs h-8 ${\n                                  isSelected \n                                    ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                    : isDisabled\n                                    ? 'border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed'\n                                    : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                                }`}\n                              >\n                                {i + 1}\n                              </Button>\n                            );\n                          })}\n                        </div>\n                        \n                        <div className=\"mt-3\">\n                          <Button\n                            onClick={() => {\n                              setTempMonthRange(prev => ({ ...prev, to: undefined }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50 text-xs\"\n                          >\n                              \n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempMonthRange({});\n                      setMonthPickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempMonthRange.from) {\n                        if (tempMonthRange.to) {\n                          //  \n                          const rangeValue = `${format(tempMonthRange.from, 'yyyy-MM')}~${format(tempMonthRange.to, 'yyyy-MM')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  \n                          setNewFilter(prev => ({ ...prev, value: format(tempMonthRange.from, 'yyyy-MM') }));\n                        }\n                        setMonthPickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempMonthRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"w-full space-y-3\">\n      {/*   */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          {/*   */}\n          <Popover open={isFilterOpen} onOpenChange={setIsFilterOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Sliders className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {activeFilters.length > 0 && (\n                  <span className=\"ml-1 badge-stats bg-blue-50 text-blue-700\">\n                    {activeFilters.length}\n                  </span>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-64 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"card-title\"></h4>\n                  {activeFilters.length > 0 && (\n                    <Button\n                      variant=\"ghost\"\n                      onClick={handleClearAllFilters}\n                      className=\"button-base text-red-600 hover:text-red-700 hover:bg-red-50\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  )}\n                </div>\n\n                {/*    */}\n                {activeFilters.length > 0 && (\n                  <div className=\"space-y-2\">\n                    {activeFilters.map(filter => (\n                      <div key={filter.id} className=\"flex items-center justify-between p-2 bg-gray-50 business-radius\">\n                        <span className=\"card-description\">\n                          {filter.label}\n                          {filter.dateField && (\n                            <span className=\"text-blue-600\">\n                              ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                            </span>\n                          )}\n                          : {filter.value}\n                        </span>\n                        <Button\n                          variant=\"ghost\"\n                          onClick={() => handleRemoveFilter(filter.id)}\n                          className=\"button-base h-6 w-6 p-0 hover:bg-red-50\"\n                        >\n                          <X className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                    <div className=\"border-t border-gray-200 my-2\" />\n                  </div>\n                )}\n\n                {/*    */}\n                <div className=\"space-y-2\">\n                  <Select onValueChange={handleAddFilter}>\n                    <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n                      <SelectValue placeholder=\"+  \" />\n                    </SelectTrigger>\n                    <SelectContent \n                      className=\"w-64 max-h-80 overflow-y-auto\"\n                      style={{\n                        scrollbarWidth: 'auto',\n                        scrollbarColor: '#9ca3af #f3f4f6',\n                        WebkitScrollbarWidth: '8px'\n                      }}\n                    >\n                      {Object.entries(\n                        FILTER_FIELDS.reduce((acc, field) => {\n                          if (!acc[field.category]) acc[field.category] = []\n                          acc[field.category].push(field)\n                          return acc\n                        }, {} as Record<string, typeof FILTER_FIELDS>)\n                      ).map(([category, fields]) => (\n                        <div key={category}>\n                          <div className=\"px-2 py-1 card-description uppercase\">\n                            {category}\n                          </div>\n                          {fields.map(field => (\n                            <SelectItem key={field.key} value={field.key}>\n                              <div className=\"flex items-center gap-2\">\n                                <field.icon className=\"w-4 h-4\" />\n                                <span className=\"card-description\">{field.label}</span>\n                              </div>\n                            </SelectItem>\n                          ))}\n                        </div>\n                      ))}\n                    </SelectContent>\n                  </Select>\n\n                  {/*   UI */}\n                  {newFilter.field && (\n                    <div className=\"space-y-2 p-3 border business-radius bg-white\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"card-title\">{newFilter.label} </span>\n                      </div>\n                      \n                      {/*    */}\n                      {(newFilter.field === 'date_range' || newFilter.field === 'date_month') ? (\n                        <div className=\"grid grid-cols-2 gap-2\">\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            <Select \n                              value={newFilter.dateField || ''} \n                              onValueChange={(value) => setNewFilter(prev => ({ ...prev, dateField: value }))}\n                            >\n                              <SelectTrigger className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center justify-center\">\n                                <SelectValue placeholder=\" \" className=\"text-center\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                {DATE_FIELDS.map(dateField => (\n                                  <SelectItem key={dateField.value} value={dateField.value}>\n                                    <span className=\"card-description\">{dateField.label}</span>\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                          </div>\n\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            {renderValueInput()}\n                          </div>\n                        </div>\n                      ) : (\n                        /*    -       */\n                        <div>\n                          {renderValueInput()}\n                        </div>\n                      )}\n\n                      <div className=\"flex gap-2\">\n                        <Button\n                          onClick={handleApplyFilter}\n                          disabled={\n                            !newFilter.field || \n                            newFilter.value === '' ||\n                            ((newFilter.field === 'date_range' || newFilter.field === 'date_month') && !newFilter.dateField)\n                          }\n                          className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                        >\n                          \n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => setNewFilter({})}\n                          className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                        >\n                          \n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <Popover open={isSortOpen} onOpenChange={setIsSortOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <ArrowUpDown className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {sortConfig && (\n                  <span className=\"ml-1 card-description\">\n                    ({sortConfig.direction === 'asc' ? '' : ''})\n                  </span>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-56 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <h4 className=\"card-title\"> </h4>\n                \n                <div className=\"space-y-2\">\n                  {/*    */}\n                  <div>\n                    <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                    <Select \n                      value={tempSort.field || ''} \n                      onValueChange={handleSortFieldChange}\n                    >\n                      <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                        <SelectValue placeholder=\"\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {SORT_FIELDS.map(field => (\n                          <SelectItem key={field.value} value={field.value}>\n                            <span className=\"card-description\">{field.label}</span>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  {/*    */}\n                  {tempSort.field && (\n                    <div>\n                      <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                      <Select \n                        value={tempSort.direction || ''} \n                        onValueChange={handleSortDirectionChange}\n                      >\n                        <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                          <SelectValue placeholder=\"\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"asc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                          <SelectItem value=\"desc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n\n                  {/* /  */}\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button \n                      onClick={handleApplySort}\n                      disabled={!tempSort.field || !tempSort.direction}\n                      className=\"button-base bg-blue-500 hover:bg-blue-600 text-white flex-1\"\n                    >\n                      \n                    </Button>\n                    <Button \n                      onClick={handleClearSort}\n                      className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n                    >\n                      \n                    </Button>\n                  </div>\n                </div>\n\n                {sortConfig && (\n                  <div className=\"border-t pt-2\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => onSortChange(null)}\n                      className=\"button-base w-full border border-gray-300 text-gray-700\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <div className=\"flex items-center gap-2\">\n            {!isSearchExpanded ? (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsSearchExpanded(true)}\n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Search className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n              </Button>\n            ) : (\n              <div className=\"flex items-center gap-2\">\n                <Input\n                  ref={searchInputRef}\n                  placeholder=\" ...\"\n                  value={searchTerm}\n                  onChange={(e) => onSearchChange(e.target.value)}\n                  className=\"w-64 business-radius-input button-base border border-gray-300 bg-white text-gray-700\"\n                />\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => {\n                    setIsSearchExpanded(false)\n                    onSearchChange('')\n                  }}\n                  className=\"button-base h-8 w-8 p-0\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/*    */}\n          <Button\n            variant=\"outline\"\n            onClick={() => {\n              onSearchChange('')\n              onFiltersChange([])\n              onSortChange({\n                field: 'created_at',\n                direction: 'desc',\n                label: ''\n              })\n              setIsSearchExpanded(false)\n            }}\n            className=\"button-base border border-gray-300 bg-white text-blue-600 hover:bg-blue-50 hover:border-blue-300\"\n          >\n             <span className=\"button-text text-blue-600\"></span>\n          </Button>\n        </div>\n\n        {/*   -     */}\n        <div className=\"flex items-center gap-2\">\n          {children}\n        </div>\n      </div>\n\n      {/*    - badge-stats span  */}\n      {activeFilters.length > 0 && (\n        <div className=\"flex flex-wrap gap-2\">\n          {activeFilters.map(filter => (\n            <span\n              key={filter.id}\n              className=\"badge-stats flex items-center gap-1 bg-blue-50 text-blue-700 border border-blue-200\"\n            >\n              {filter.label}\n              {filter.dateField && (\n                <span className=\"text-blue-600\">\n                  ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                </span>\n              )}\n              : {filter.value}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handleRemoveFilter(filter.id)}\n                className=\"h-4 w-4 p-0 hover:bg-blue-100 ml-1\"\n              >\n                <X className=\"w-3 h-3\" />\n              </Button>\n            </span>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}","/**\n *     \n *       \n */\n\nexport type PurchaseRole = \n  | 'app_admin' \n  | 'ceo' \n  | 'middle_manager' \n  | 'final_approver' \n  | 'raw_material_manager' \n  | 'consumable_manager' \n  | 'purchase_manager' \n  | 'requester' \n  | 'lead buyer' \n  | 'buyer' \n  | 'hr';\n\n//   \nexport const MANAGER_ROLES: PurchaseRole[] = [\n  'purchase_manager',\n  'app_admin',\n  'raw_material_manager',\n  'consumable_manager'\n];\n\n//   \nexport const APPROVER_ROLES: PurchaseRole[] = [\n  'final_approver',\n  'app_admin',\n  'ceo',\n  'middle_manager',\n  'hr'\n];\n\n//   \nexport const HIDDEN_EMPLOYEES = [''];\n\n/**\n *    \n */\nexport function hasManagerRole(roles: string[]): boolean {\n  return MANAGER_ROLES.some(role => roles.includes(role));\n}\n\n/**\n *    \n */\nexport function hasApproverRole(roles: string[]): boolean {\n  return APPROVER_ROLES.some(role => roles.includes(role));\n}\n\n/**\n *    (  )\n * 1:   ( )\n * 2:   (   )\n * 3:   (app_admin, ceo -  )\n */\nexport function getRoleCase(roles: string[]): number {\n  if (!roles || roles.length === 0) return 1;\n  \n  // app_admin ceo   (case 3)\n  if (roles.includes('app_admin') || roles.includes('ceo')) return 3;\n  \n  //     (case 2)\n  if (roles.includes('consumable_manager') || \n      roles.includes('raw_material_manager') ||\n      roles.includes('purchase_manager')) return 2;\n  \n  // middle_manager  \n  if (roles.includes('middle_manager')) return 2;\n  \n  return 1;\n}\n\n/**\n *    \n */\nexport function filterByEmployeeVisibility<T extends { requester_name: string }>(\n  items: T[],\n  userRoles: string[]\n): T[] {\n  if (hasManagerRole(userRoles)) {\n    return items; //    \n  }\n  return items.filter(item => !HIDDEN_EMPLOYEES.includes(item.requester_name));\n}","\nimport { useState, lazy, Suspense, useEffect, useCallback, useMemo, useTransition } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { usePurchaseMemory } from \"@/hooks/usePurchaseMemory\";\nimport { useColumnSettings } from \"@/hooks/useColumnSettings\";\nimport ColumnSettingsDropdown from \"@/components/purchase/ColumnSettingsDropdown\";\nimport FastPurchaseTable from \"@/components/purchase/FastPurchaseTable\";\nimport FilterToolbar, { FilterRule, SortRule } from \"@/components/purchase/FilterToolbar\";\nimport { updatePurchaseInMemory, loadAllPurchaseData } from \"@/services/purchaseDataLoader\";\nimport { markPurchaseAsPaymentCompleted, markPurchaseAsReceived, isCacheValid, purchaseMemoryCache } from '@/stores/purchaseMemoryStore';\n\nimport { Package, Info } from \"lucide-react\";\nimport { downloadPurchaseOrderExcel } from '@/utils/excelDownload';\n\n// Lazy load modal for better performance\nconst PurchaseItemsModal = lazy(() => import(\"@/components/purchase/PurchaseItemsModal\"));\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { Purchase } from \"@/types/purchase\";\nimport { hasManagerRole, getRoleCase, filterByEmployeeVisibility } from \"@/utils/roleHelper\";\nimport { filterByEmployee, sortPurchases, calculateTabCounts } from \"@/utils/purchaseFilters\";\nimport { logger } from \"@/lib/logger\";\n\ninterface PurchaseListMainProps {\n  showEmailButton?: boolean;\n}\n\n//   () \nconst NAV_TABS: { key: string; label: string }[] = [\n  { key: 'pending', label: '' },\n  { key: 'purchase', label: ' ' },\n  { key: 'receipt', label: ' ' },\n  { key: 'done', label: ' ' },\n];\n\n//    \nexport default function PurchaseListMain({ showEmailButton = true }: PurchaseListMainProps) {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const supabase = createClient();\n  const [selectedPurchase, setSelectedPurchase] = useState<Purchase | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  \n  //    \n  const [activeFilters, setActiveFilters] = useState<FilterRule[]>([]);\n  const [sortConfig, setSortConfig] = useState<SortRule | null>({\n    field: 'created_at',\n    direction: 'desc',\n    label: ''\n  });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [availableEmployees, setAvailableEmployees] = useState<string[]>([]);\n  const [availableVendors, setAvailableVendors] = useState<string[]>([]);\n  const [availableContacts, setAvailableContacts] = useState<string[]>([]);\n  const [availablePaymentSchedules, setAvailablePaymentSchedules] = useState<string[]>([]);\n  \n  //     \n  const {\n    allPurchases: purchases,\n    loading,\n    currentUser,\n    getFilteredPurchases,\n    tabCounts\n  } = usePurchaseMemory();\n  \n  //   \n  const { columnVisibility, isLoading: isColumnLoading, applyColumnSettings, resetToDefault } = useColumnSettings();\n  \n  //    \n  const hasHiddenColumns = useMemo(() => {\n    if (!columnVisibility) return false;\n    return Object.values(columnVisibility).some(visible => !visible);\n  }, [columnVisibility]);\n  \n  //  \n  useEffect(() => {\n    logger.info('[PurchaseListMain] columnVisibility ', { columnVisibility });\n  }, [columnVisibility]);\n  \n  const currentUserRoles = Array.isArray(currentUser?.purchase_role) \n    ? currentUser.purchase_role.map((r: string) => r.trim())\n    : typeof currentUser?.purchase_role === 'string' \n    ? currentUser.purchase_role.split(',').map((r: string) => r.trim())\n    : [];\n  \n  const currentUserName = currentUser?.name || null;\n  \n  //     \n  const [refreshTrigger, setRefreshTrigger] = useState(0)\n  \n  //    state  0   \n  const [cachedTabCounts, setCachedTabCounts] = useState({ \n    pending: 0, \n    purchase: 0, \n    receipt: 0, \n    done: 0 \n  })\n  \n  //     \n  const loadPurchases = useCallback(async () => {\n    logger.debug(' [loadPurchases]   ')\n    setRefreshTrigger(prev => prev + 1)\n  }, []);\n  \n  // Optimistic Update:    \n  const updatePurchaseOptimistic = useCallback((purchaseId: number, updater: (prev: Purchase) => Purchase) => {\n    updatePurchaseInMemory(purchaseId, updater)\n  }, []);\n  \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  \n  // roleCase  (   ) -  \n  const roleCase = useMemo(() => getRoleCase(currentUserRoles), [currentUserRoles]);\n\n  //      -    \n  const defaultEmployeeByTab = useMemo(() => {\n    if (!currentUserName) {\n      return { pending: 'all', purchase: 'all', receipt: 'all', done: 'all' };\n    }\n    \n    //   \n    const hasHrRole = currentUserRoles.includes('hr');\n    const hasPurchaseManagerRole = currentUserRoles.includes('purchase_manager');\n    const hasManagerRole = currentUserRoles.some((role: string) => \n      ['app_admin', 'ceo', 'lead buyer', 'finance_team', 'raw_material_manager', 'consumable_manager', 'purchase_manager', 'hr'].includes(role)\n    );\n    \n    return {\n      pending: roleCase === 3 ? 'all' : currentUserName,\n      purchase: hasManagerRole ? 'all' : (roleCase === 3 ? 'all' : currentUserName),\n      receipt: (hasHrRole || hasPurchaseManagerRole) ? 'all' : (roleCase === 3 ? 'all' : currentUserName),\n      done: 'all' //       \n    };\n  }, [currentUserName, roleCase, currentUserRoles]);\n\n  // URL   \n  const getInitialTab = () => {\n    const searchParams = new URLSearchParams(location.search);\n    const tab = searchParams.get('tab');\n    if (tab && ['pending', 'purchase', 'receipt', 'done'].includes(tab)) {\n      return tab;\n    }\n    return 'pending';\n  };\n\n  //    -  \n  const initialTab = getInitialTab();\n  const [activeTab, setActiveTab] = useState(initialTab);\n  const [selectedEmployee, setSelectedEmployee] = useState<string>(() => {\n    return defaultEmployeeByTab[initialTab as keyof typeof defaultEmployeeByTab] || 'all';\n  });\n  const [isPending, startTransition] = useTransition();\n\n  //    (  )\n  const visiblePurchases = useMemo(() => {\n    return filterByEmployeeVisibility(purchases, currentUserRoles);\n  }, [purchases, currentUserRoles]);\n\n\n  // URL     \n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const tab = searchParams.get('tab');\n    if (tab && ['pending', 'purchase', 'receipt', 'done'].includes(tab)) {\n      setActiveTab(tab);\n      //       (   )\n      setSelectedEmployee(defaultEmployeeByTab[tab as keyof typeof defaultEmployeeByTab] || 'all');\n    }\n  }, [location.search, defaultEmployeeByTab]);\n\n  //       \n  useEffect(() => {\n    const checkAndRefreshCache = async () => {\n      //      \n      if (!isCacheValid() || !purchaseMemoryCache.allPurchases) {\n        logger.info(' [PurchaseListMain]   ,   ...', {\n          isCacheValid: isCacheValid(),\n          hasData: !!purchaseMemoryCache.allPurchases,\n          lastFetch: purchaseMemoryCache.lastFetch\n        });\n        \n        try {\n          await loadAllPurchaseData(currentUser?.id);\n          logger.info(' [PurchaseListMain]   ');\n        } catch (error) {\n          logger.error(' [PurchaseListMain]   :', error);\n        }\n      }\n    };\n    \n    checkAndRefreshCache();\n  }, [currentUser?.id]); // currentUser   \n\n  //    \n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        //   (employees )\n        const { data: employees } = await supabase\n          .from('employees')\n          .select('name');\n        \n        if (employees) {\n          const employeeNames = [...new Set(employees.map((e: any) => e.name).filter(Boolean))];\n          setAvailableEmployees(employeeNames as string[]);\n        }\n\n        //   (vendors )\n        const { data: vendors } = await supabase\n          .from('vendors')\n          .select('vendor_name');\n        \n        if (vendors) {\n          const vendorNames = [...new Set(vendors.map((v: any) => v.vendor_name).filter(Boolean))];\n          setAvailableVendors(vendorNames as string[]);\n        }\n\n        //   (vendor_contacts )\n        const { data: contacts } = await supabase\n          .from('vendor_contacts')\n          .select('contact_name');\n        \n        if (contacts) {\n          const contactNames = [...new Set(contacts.map((c: any) => c.contact_name).filter(Boolean))];\n          setAvailableContacts(contactNames as string[]);\n        }\n\n        //   (vendors  vendor_payment_schedule)\n        const { data: schedules } = await supabase\n          .from('vendors')\n          .select('vendor_payment_schedule');\n        \n        if (schedules) {\n          const scheduleNames = [...new Set(schedules.map((s: any) => s.vendor_payment_schedule).filter(Boolean))];\n          setAvailablePaymentSchedules(scheduleNames as string[]);\n        }\n      } catch (error) {\n        logger.error('    ', error);\n      }\n    };\n\n    loadFilterOptions();\n  }, [supabase]);\n\n\n  //     -  \n  const getStatusBadge = useCallback((purchase: Purchase) => {\n    if (purchase.is_received) {\n      return <span className=\"badge-stats bg-green-500 text-white\"></span>;\n    } else if (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved') {\n      return <span className=\"badge-stats bg-blue-500 text-white\"></span>;\n    } else if (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected') {\n      return <span className=\"badge-stats bg-red-500 text-white\"></span>;\n    } else {\n      return <span className=\"badge-stats bg-yellow-500 text-white\"></span>;\n    }\n  }, []);\n\n  //    \n  const getReceiptProgress = (purchase: Purchase) => {\n    if (!purchase.purchase_request_items || purchase.purchase_request_items.length === 0) {\n      return { received: 0, total: 0, percentage: 0 };\n    }\n    \n    const total = purchase.purchase_request_items.length;\n    const received = purchase.purchase_request_items.filter((item: any) => \n      item.is_received === true\n    ).length;\n    const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n    \n    return { received, total, percentage };\n  };\n  \n  //    \n  const getPurchaseProgress = (purchase: Purchase) => {\n    if (!purchase.purchase_request_items || purchase.purchase_request_items.length === 0) {\n      return { completed: 0, total: 0, percentage: 0 };\n    }\n    \n    const total = purchase.purchase_request_items.length;\n    const completed = purchase.purchase_request_items.filter((item: any) => \n      item.is_payment_completed === true\n    ).length;\n    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n    \n    return { completed, total, percentage };\n  };\n\n  //   \n  const isAdvancePayment = (progress_type?: string) => {\n    return progress_type === '' || progress_type?.trim() === '' || progress_type?.includes('');\n  };\n\n  //     - useCallback \n  const getFieldValue = useCallback((purchase: Purchase, field: string): any => {\n    switch (field) {\n      case 'purchase_order_number':\n        return purchase.purchase_order_number;\n      case 'payment_category':\n        return purchase.payment_category;\n      case 'requester_name':\n        return purchase.requester_name;\n      case 'vendor_name':\n        return purchase.vendor_name;\n      case 'contact_name':\n        // vendor_contacts JOIN  -    \n        return '-'; // vendor_contacts JOIN \n      case 'item_name':\n        return purchase.purchase_request_items?.[0]?.item_name || '';\n      case 'specification':\n        return purchase.purchase_request_items?.[0]?.specification || '';\n      case 'quantity':\n        return purchase.purchase_request_items?.[0]?.quantity || 0;\n      case 'unit_price_value':\n        return purchase.purchase_request_items?.[0]?.unit_price_value || 0;\n      case 'total_amount':\n        return purchase.total_amount;\n      case 'remark':\n        return purchase.purchase_request_items?.[0]?.remark || '';\n      case 'project_vendor':\n        return purchase.project_vendor;\n      case 'project_item':\n        return purchase.project_item;\n      case 'sales_order_number':\n        return purchase.sales_order_number;\n      case 'payment_schedule':\n        // vendor_payment_schedule vendors   - JOIN \n        return '-';\n      case 'is_payment_completed':\n        //    \n        return purchase.is_payment_completed ? '' : '';\n      case 'is_received':\n        //    \n        return purchase.is_received ? '' : '';\n      case 'is_statement_received':\n        return purchase.is_statement_received ? '' : '';\n      case 'is_utk_checked':\n        return purchase.is_utk_checked ? '' : '';\n      case 'request_date':\n        return purchase.request_date;\n      case 'delivery_request_date':\n        return purchase.delivery_request_date;\n      case 'payment_completed_at':\n        return purchase.payment_completed_at;\n      case 'received_at':\n        return purchase.received_at;\n      case 'created_at':\n        return purchase.created_at;\n      case 'statement_received_at':\n        return purchase.purchase_request_items?.[0]?.statement_received_date || null;\n      default:\n        return null;\n    }\n  }, []);\n\n  //     - useCallback \n  const applyFilterCondition = useCallback((fieldValue: any, condition: string, filterValue: any, filterField?: string): boolean => {\n    if (fieldValue === null || fieldValue === undefined) {\n      return condition === 'is_empty';\n    }\n\n    //      (~)\n    if (filterField === 'date_range' && filterValue && typeof filterValue === 'string' && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startDate, endDate] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(startDate);\n      const end = new Date(endDate);\n      \n      //       \n      return fieldDate >= start && fieldDate <= end;\n    }\n\n    //      (~)\n    if (filterField === 'date_month' && filterValue && typeof filterValue === 'string' && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startMonth, endMonth] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(`${startMonth}-01`);\n      const end = new Date(`${endMonth}-01`);\n      \n      //    (    )\n      const endOfMonth = new Date(end.getFullYear(), end.getMonth() + 1, 0, 23, 59, 59);\n      return fieldDate >= start && fieldDate <= endOfMonth;\n    }\n\n    //     ( )\n    if (filterField && (filterField === 'date_month' || filterField.endsWith('_month'))) {\n      if (!filterValue) return true;\n      \n      const fieldDate = new Date(fieldValue);\n      const [filterYear, filterMonth] = filterValue.split('-');\n      \n      return fieldDate.getFullYear() === parseInt(filterYear) && \n             (fieldDate.getMonth() + 1) === parseInt(filterMonth);\n    }\n\n    const fieldStr = String(fieldValue).toLowerCase();\n    const filterStr = String(filterValue).toLowerCase();\n\n    switch (condition) {\n      case 'contains':\n        return fieldStr.includes(filterStr);\n      case 'equals':\n        //      \n        if (filterField === 'date_range' || filterValue.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}/)) {\n          if (!fieldValue) return false;\n          try {\n            const fieldDate = new Date(fieldValue).toISOString().split('T')[0];\n            const filterDate = filterValue.split('T')[0];\n            return fieldDate === filterDate;\n          } catch (error) {\n            logger.error('  :', error);\n            return false;\n          }\n        }\n        return fieldStr === filterStr;\n      case 'starts_with':\n        return fieldStr.startsWith(filterStr);\n      case 'ends_with':\n        return fieldStr.endsWith(filterStr);\n      case 'is_empty':\n        return !fieldValue || fieldStr.trim() === '';\n      case 'is_not_empty':\n        return !!fieldValue && fieldStr.trim() !== '';\n      case 'greater_than':\n        return Number(fieldValue) > Number(filterValue);\n      case 'less_than':\n        return Number(fieldValue) < Number(filterValue);\n      case 'between':\n        //    \n        return true;\n      case 'after':\n        return new Date(fieldValue) > new Date(filterValue);\n      case 'before':\n        return new Date(fieldValue) < new Date(filterValue);\n      case 'not_equals':\n        return fieldStr !== filterStr;\n      default:\n        return true;\n    }\n  }, []);\n\n\n  //   \n  const baseFilteredPurchases = useMemo(() => {\n    const employeeName = selectedEmployee === 'all' || selectedEmployee === '' ? null : selectedEmployee;\n    \n    return getFilteredPurchases({\n      tab: activeTab as any,\n      employeeName,\n      searchTerm,\n      advancedFilters: activeFilters,\n      sortConfig: sortConfig ? { key: sortConfig.field, direction: sortConfig.direction } : undefined\n    });\n  }, [getFilteredPurchases, activeTab, selectedEmployee, searchTerm, activeFilters, sortConfig, purchases]);\n\n  \n  //        \n  const tabFilteredPurchases = baseFilteredPurchases;\n\n\n  //     \n  useEffect(() => {\n    //      \n    if (purchases && purchases.length > 0) {\n      const newCounts = calculateTabCounts(purchases, currentUser);\n      setCachedTabCounts(newCounts);\n    } else if (purchaseMemoryCache.allPurchases && purchaseMemoryCache.allPurchases.length > 0) {\n      //  state    \n      const newCounts = calculateTabCounts(purchaseMemoryCache.allPurchases, currentUser);\n      setCachedTabCounts(newCounts);\n    }\n  }, [purchases, currentUser]);\n\n  //    (  )\n  const filteredTabCounts = cachedTabCounts;\n\n  //     \n  const getTabBadgeText = useCallback((tabKey: string) => {\n    //     \n    if (tabKey === 'done') {\n      //    \n      const hasAdvancedFilters = activeFilters.length > 0;\n      \n      if (hasAdvancedFilters) {\n        //       \n        return tabFilteredPurchases.length.toString();\n      } else {\n        //    \"\" \n        return \"\";\n      }\n    }\n    \n    //     \n    return filteredTabCounts[tabKey as keyof typeof filteredTabCounts].toString();\n  }, [activeFilters.length, tabFilteredPurchases.length, filteredTabCounts]);\n\n\n  //      \n  const monthlyFilterSummary = useMemo(() => {\n    //     \n    const monthFilters = activeFilters.filter(filter => \n      filter.field === 'date_month' || \n      (filter.field === 'date_range' && filter.dateField && filter.dateField.includes('_month'))\n    );\n    \n    if (monthFilters.length === 0) return null;\n    \n    const monthFilter = monthFilters[0];\n    const filterValue = monthFilter.value;\n    \n    //       \n    if (filterValue && typeof filterValue === 'string' && filterValue.includes('~')) {\n      //   (: \"2024-04~2024-09\")\n      const [startMonth, endMonth] = filterValue.split('~');\n      const startDate = new Date(`${startMonth}-01`);\n      const endDate = new Date(`${endMonth}-01`);\n      \n      const monthlyTotals = [];\n      let totalSum = 0;\n      \n      //   \n      const currentDate = new Date(startDate);\n      while (currentDate <= endDate) {\n        const year = currentDate.getFullYear();\n        const month = currentDate.getMonth() + 1;\n        const monthStr = `${year}-${month.toString().padStart(2, '0')}`;\n        \n        //    \n        const monthData = tabFilteredPurchases.filter(purchase => {\n          const purchaseDate = new Date(purchase.request_date);\n          return purchaseDate.getFullYear() === year && \n                 (purchaseDate.getMonth() + 1) === month;\n        });\n        \n        //    \n        const monthTotal = monthData.reduce((sum, purchase) => {\n          // items amount_value   total_amount \n          if (purchase.purchase_request_items?.length) {\n            const itemsTotal = purchase.purchase_request_items.reduce((itemSum: number, item: any) => {\n              return itemSum + (item.amount_value || 0);\n            }, 0);\n            return sum + itemsTotal;\n          }\n          return sum + (purchase.total_amount || 0);\n        }, 0);\n        \n        monthlyTotals.push({\n          year,\n          month,\n          monthStr,\n          total: monthTotal,\n          count: monthData.length\n        });\n        \n        totalSum += monthTotal;\n        \n        //   \n        currentDate.setMonth(currentDate.getMonth() + 1);\n      }\n      \n      return {\n        type: 'range',\n        months: monthlyTotals,\n        grandTotal: totalSum\n      };\n    } else {\n      //    (: \"2024-10\")\n      const [year, month] = (typeof filterValue === 'string' ? filterValue : '').split('-');\n      const monthData = tabFilteredPurchases.filter(purchase => {\n        const purchaseDate = new Date(purchase.request_date);\n        return purchaseDate.getFullYear() === parseInt(year) && \n               (purchaseDate.getMonth() + 1) === parseInt(month);\n      });\n      \n      const monthTotal = monthData.reduce((sum, purchase) => {\n        // items amount_value   total_amount \n        if (purchase.purchase_request_items?.length) {\n          const itemsTotal = purchase.purchase_request_items.reduce((itemSum: number, item: any) => {\n            return itemSum + (item.amount_value || 0);\n          }, 0);\n          return sum + itemsTotal;\n        }\n        return sum + (purchase.total_amount || 0);\n      }, 0);\n      \n      return {\n        type: 'single',\n        year: parseInt(year),\n        month: parseInt(month),\n        total: monthTotal,\n        count: monthData.length\n      };\n    }\n  }, [activeFilters, tabFilteredPurchases]);\n\n\n  //   -   \n  const handleExcelDownload = async (purchase: Purchase) => {\n    try {\n      await downloadPurchaseOrderExcel(\n        {\n          id: purchase.id,\n          purchase_order_number: purchase.purchase_order_number,\n          vendor_name: purchase.vendor_name,\n          vendor_id: purchase.vendor_id,\n          contact_id: purchase.contact_id\n        },\n        currentUserRoles,\n        () => {\n          //  :  \n          loadPurchases();\n        }\n      );\n    } catch (error) {\n      logger.error('Excel    ', error);\n    }\n  };\n\n  //   -    \n  const handleReceiptComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_received: true,\n            received_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_received: true,\n            delivery_status: 'received'\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      //      (UI  )\n      const memoryUpdated = markPurchaseAsReceived(purchaseId);\n      if (!memoryUpdated) {\n        logger.warn('[PurchaseListMain]     ', { purchaseId });\n      }\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handlePaymentComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_payment_completed: true,\n            payment_completed_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_payment_completed: true,\n            payment_completed_at: currentTime\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      //      (UI  )\n      const memoryUpdated = markPurchaseAsPaymentCompleted(purchaseId);\n      if (!memoryUpdated) {\n        logger.warn('[PurchaseListMain]    ,  ', { purchaseId });\n        await loadPurchases(); // fallback:      \n      }\n      \n      toast.success(' .');\n    } catch (error) {\n      logger.error('[PurchaseListMain]   :', error);\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handleItemsClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    setIsModalOpen(true);\n  }, []);\n  \n  //    -   \n  const modalPurchaseData = useMemo(() => {\n    if (!selectedPurchase) return null;\n    return {\n      ...selectedPurchase,\n      vendor_name: selectedPurchase.vendor_name || '',\n      project_vendor: selectedPurchase.project_vendor || '',\n      sales_order_number: selectedPurchase.sales_order_number || '',\n      project_item: selectedPurchase.project_item || ''\n    };\n  }, [selectedPurchase]);\n\n  return (\n    <div className=\"w-full\">\n      {/* Header */}\n      <div className=\"mb-4\">\n        <div>\n          <h1 className=\"page-title\"> </h1>\n          <p className=\"page-subtitle\" style={{marginTop:'-2px',marginBottom:'-4px'}}>Purchase Management</p>\n        </div>\n      </div>\n\n      {/*    -       */}\n      <div className=\"mb-3\">\n        <FilterToolbar\n          activeFilters={activeFilters}\n          sortConfig={sortConfig}\n          searchTerm={searchTerm}\n          onFiltersChange={setActiveFilters}\n          onSortChange={setSortConfig}\n          onSearchChange={setSearchTerm}\n          availableEmployees={availableEmployees}\n          availableVendors={availableVendors}\n          availableContacts={availableContacts}\n          availablePaymentSchedules={availablePaymentSchedules}\n        >\n          {/*         */}\n          <ColumnSettingsDropdown \n            isVisible={true} \n            columnVisibility={columnVisibility}\n            applyColumnSettings={applyColumnSettings}\n            resetToDefault={resetToDefault}\n            isLoading={isColumnLoading}\n          />\n        </FilterToolbar>\n        \n      </div>\n\n      {/*    (hanslwebapp ) -   */}\n      <div className=\"space-y-3\">\n\n        {/*   -    */}\n        <div className=\"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 business-radius-card border border-gray-200\">\n          {NAV_TABS.map((tab) => (\n            <button\n              key={tab.key}\n              onClick={() => {\n                //     startTransition \n                startTransition(() => {\n                  setActiveTab(tab.key);\n                  //       (    -  )\n                  setSelectedEmployee(defaultEmployeeByTab[tab.key as keyof typeof defaultEmployeeByTab] || 'all');\n                });\n              }}\n              className={`flex-1 flex items-center justify-center space-x-2 py-1.5 px-3 sm:px-4 business-radius-button button-text font-medium transition-colors ${\n                activeTab === tab.key\n                  ? 'text-hansl-600 bg-white shadow-sm border border-gray-200'\n                  : 'text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50'\n              }`}\n            >\n              <span className=\"whitespace-nowrap\">{tab.label}</span>\n              <span \n                className={\n                  `badge-stats ${\n                    activeTab === tab.key \n                      ? 'bg-hansl-50 text-hansl-700' \n                      : 'bg-gray-100 text-gray-600'\n                  }`\n                }\n              >\n                {getTabBadgeText(tab.key)}\n              </span>\n            </button>\n          ))}\n        </div>\n\n        {/*       */}\n        {monthlyFilterSummary && (\n          <div className=\"mb-3\">\n            {monthlyFilterSummary.type === 'single' ? (\n              //    -    \n              <div className=\"inline-flex items-center gap-2 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 business-radius-badge px-3 py-2 shadow-sm\">\n                <div className=\"flex items-center gap-1.5\">\n                  <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                  <span className=\"card-subtitle text-gray-700\">\n                    {monthlyFilterSummary.year} {monthlyFilterSummary.month}\n                  </span>\n                  <span className=\"badge-text text-gray-500\">\n                    {monthlyFilterSummary.count}\n                  </span>\n                </div>\n                <div className=\"h-4 w-px bg-blue-300\"></div>\n                <span className=\"modal-value text-blue-700 font-semibold\">\n                  {monthlyFilterSummary.total?.toLocaleString() || '0'}\n                </span>\n              </div>\n            ) : (\n              //   \n              <Card className=\"business-radius-card border border-gray-200 shadow-sm\">\n                <CardHeader className=\"pb-3 pt-4 px-4\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                      <CardTitle className=\"section-title text-gray-800\">  </CardTitle>\n                    </div>\n                    {/*      */}\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"badge-text text-gray-600\">\n                        ({monthlyFilterSummary.months?.reduce((sum, m) => sum + m.count, 0) || 0})\n                      </span>\n                      <div className=\"h-4 w-px bg-gray-300\"></div>\n                      <span className=\"modal-value text-gray-500 font-bold\">\n                        {monthlyFilterSummary.grandTotal?.toLocaleString() || '0'}\n                      </span>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"px-4 pb-4\">\n                  {/*   -     */}\n                  <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                    {monthlyFilterSummary.months?.map((monthData) => (\n                      <div \n                        key={monthData.monthStr} \n                        className=\"bg-gray-50 business-radius-card px-3 py-1.5 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all flex-shrink-0\"\n                      >\n                        <div className=\"flex items-baseline gap-1.5\">\n                          <span className=\"modal-value font-bold text-gray-800 whitespace-nowrap\">\n                            {monthData.month}\n                          </span>\n                          <span className=\"text-[9px] text-gray-500 whitespace-nowrap\">\n                            ({monthData.count})\n                          </span>\n                          <span className=\"modal-value text-gray-500 font-bold whitespace-nowrap ml-1\">\n                            {monthData.total.toLocaleString()}\n                          </span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        )}\n\n        {/*   */}\n        <Card className={`overflow-hidden border border-gray-200 ${hasHiddenColumns ? 'w-fit' : ''}`}>\n          <CardContent className=\"p-0\">\n            {loading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <div className=\"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin\" />\n                <span className=\"ml-3 card-subtitle\"> ...</span>\n              </div>\n            ) : tabFilteredPurchases.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Package className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\"> </h3>\n                <p className=\"card-subtitle\">  .</p>\n              </div>\n            ) : (\n              <FastPurchaseTable \n                purchases={tabFilteredPurchases} \n                activeTab={activeTab}\n                currentUserRoles={currentUserRoles}\n                onRefresh={loadPurchases}\n                onOptimisticUpdate={updatePurchaseOptimistic}\n                onPaymentComplete={handlePaymentComplete}\n                onReceiptComplete={handleReceiptComplete}\n                columnVisibility={columnVisibility}\n              />\n            )}\n          </CardContent>\n        </Card>\n      </div>\n      \n      {/*   -     */}\n      {modalPurchaseData && (\n        <Suspense fallback={<div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"><div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div></div>}>\n          <PurchaseItemsModal\n            isOpen={isModalOpen}\n            onClose={() => {\n              setIsModalOpen(false);\n              setSelectedPurchase(null);\n            }}\n            purchase={modalPurchaseData}\n            isAdmin={isAdmin || false}\n            onUpdate={loadPurchases}\n            activeTab={activeTab}\n          />\n        </Suspense>\n      )}\n    </div>\n  );\n}","import { useState, useEffect, useCallback } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { toast } from 'sonner';\nimport { logger } from '@/lib/logger';\nimport {\n  ColumnVisibility,\n  DoneTabColumnId,\n  UseColumnSettingsReturn,\n} from '@/types/columnSettings';\nimport { DEFAULT_COLUMN_VISIBILITY } from '@/constants/columnSettings';\n\n/**\n *      \n * -     DB /\n * -      \n */\nexport const useColumnSettings = (): UseColumnSettingsReturn => {\n  const [columnVisibility, setColumnVisibility] = useState<ColumnVisibility>(DEFAULT_COLUMN_VISIBILITY);\n  const [isLoading, setIsLoading] = useState(true); //    true \n  const [error, setError] = useState<string | null>(null);\n  const [, forceUpdate] = useState(0);\n  const supabase = createClient();\n\n  //   \n  const loadUserSettings = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      //    \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      if (authError || !user?.email) {\n        logger.warn('[useColumnSettings]    ', { authError });\n        setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n        return;\n      }\n\n      //   \n      const { data: settings, error: settingsError } = await supabase\n        .from('user_ui_settings')\n        .select('setting_value')\n        .eq('user_email', user.email)\n        .eq('setting_type', 'column_visibility')\n        .eq('setting_key', 'purchase_list_done')\n        .maybeSingle();\n\n      if (settingsError) {\n        logger.error('[useColumnSettings]   ', settingsError, {\n          userEmail: user.email\n        });\n        setError('    .');\n        setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n        return;\n      }\n\n      if (settings?.setting_value) {\n        // DB   \n        const savedSettings = settings.setting_value as ColumnVisibility;\n        \n        //   (    )\n        const mergedSettings = { ...DEFAULT_COLUMN_VISIBILITY, ...savedSettings };\n        \n        setColumnVisibility(mergedSettings);\n        logger.debug('[useColumnSettings]    ', {\n          userEmail: user.email,\n          settingsCount: Object.keys(mergedSettings).length\n        });\n      } else {\n        // DB     \n        setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n        logger.debug('[useColumnSettings]   ', {\n          userEmail: user.email\n        });\n      }\n    } catch (error) {\n      logger.error('[useColumnSettings]     ', error);\n      setError('    .');\n      setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [supabase]);\n\n  //  \n  const saveUserSettings = useCallback(async (newSettings: ColumnVisibility) => {\n    try {\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      if (authError || !user?.email) {\n        logger.warn('[useColumnSettings]     -  ', { authError });\n        return;\n      }\n\n      const { error: upsertError } = await supabase\n        .from('user_ui_settings')\n        .upsert({\n          user_email: user.email,\n          setting_type: 'column_visibility',\n          setting_key: 'purchase_list_done',\n          setting_value: newSettings,\n        }, {\n          onConflict: 'user_email,setting_type,setting_key'\n        });\n\n      if (upsertError) {\n        logger.error('[useColumnSettings]   ', upsertError, {\n          userEmail: user.email,\n          settings: newSettings\n        });\n        throw upsertError;\n      }\n\n      logger.info('[useColumnSettings]   ', {\n        userEmail: user.email,\n        settingsCount: Object.keys(newSettings).length,\n        visibleColumns: Object.entries(newSettings).filter(([, visible]) => visible).length\n      });\n    } catch (error) {\n      logger.error('[useColumnSettings]     ', error);\n      throw error;\n    }\n  }, [supabase]);\n\n  //   (  -  )\n  const toggleColumn = useCallback((columnId: DoneTabColumnId) => {\n    setColumnVisibility(prevSettings => {\n      const newSettings = {\n        ...prevSettings,\n        [columnId]: !prevSettings[columnId]\n      };\n\n      //  DB \n      saveUserSettings(newSettings).catch(error => {\n        //      \n        setColumnVisibility(prevSettings);\n        toast.error('  .');\n        logger.error('[useColumnSettings]   ,  ', error);\n      });\n\n      return newSettings;\n    });\n  }, [saveUserSettings]);\n\n  //    \n  const applyColumnSettings = useCallback((newSettings: ColumnVisibility) => {\n    logger.info('[useColumnSettings] applyColumnSettings ', { \n      newSettings,\n      keys: Object.keys(newSettings),\n      values: Object.values(newSettings)\n    });\n    \n    //  UI \n    setColumnVisibility(newSettings);\n    forceUpdate(prev => prev + 1); //  \n    logger.info('[useColumnSettings] setColumnVisibility ', { newSettings });\n\n    //  DB \n    saveUserSettings(newSettings).then(() => {\n      toast.success('  .');\n      logger.info('[useColumnSettings] DB  ');\n    }).catch(error => {\n      logger.error('[useColumnSettings]   ', error);\n      toast.error('  .');\n    });\n  }, [saveUserSettings]);\n\n  //  \n  const resetToDefault = useCallback(() => {\n    setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n\n    // DB  \n    saveUserSettings(DEFAULT_COLUMN_VISIBILITY).catch(error => {\n      toast.error('   .');\n      logger.error('[useColumnSettings]   ', error);\n    });\n\n    toast.success('   .');\n  }, [saveUserSettings]);\n\n  //     \n  useEffect(() => {\n    loadUserSettings();\n  }, [loadUserSettings]);\n\n  return {\n    columnVisibility,\n    toggleColumn,\n    applyColumnSettings,\n    resetToDefault,\n    isLoading,\n    error,\n  };\n};"],"file":"assets/PurchaseListMain-Cmgvego2.js"}