{"version":3,"mappings":"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","names":["Building","createLucideIcon","d","key","x","y","width","height","rx","DollarSign","x1","x2","y1","y2","EyeOff","LoaderCircle","Settings","cx","cy","r","SlidersVertical","Table","Zap","globalCache","purchases","lastFetch","userInfo","CACHE_DURATION","filteredData","Map","FILTER_CACHE_DURATION","invalidateFilterCache","tabKey","clear","DATE_LIMIT_OPTIONS","label","days","description","HIDDEN_EMPLOYEES","useFastPurchaseFilters","currentUserRoles","currentUserName","currentUserId","currentUserEmail","createClient","activeTab","setActiveTab","useState","selectedEmployee","setSelectedEmployee","dateLimit","initialLimit","currentLimitKey","setCurrentLimitKey","currentLimit","useMemo","find","opt","getNextLimit","useCallback","nextIndex","findIndex","length","getDateThreshold","Date","getTime","toISOString","split","setDateLimit","option","hasNextLimit","isFullyLoaded","getTotalCountMessage","totalCount","filteredCount","toLocaleString","useDateLimit","isAdmin","includes","isPurchaseManager","isLeadBuyer","isHr","roleCase","some","computeDefaultEmployee","useEffect","defaultEmployee","visiblePurchases","filter","p","requester_name","dateLimitedPurchases","threshold","data","item","itemDate","request_date","filterByDateLimit","tabFilteredPurchases","purchase","matches","middlePending","middle_manager_status","finalPending","final_manager_status","middleRejected","finalRejected","middleApproved","finalApproved","isRequest","payment_category","isSeonJin","progress_type","isIlban","is_payment_completed","is_received","employeeFilteredPurchases","result","filteredPurchases","sort","a","b","dateA","tabCounts","countPurchases","getUniqueOrderCount","filtered","Set","map","purchase_order_number","size","getFilteredDataForTab","pendingData","purchaseData","receiptData","doneData","pendingFiltered","purchaseFiltered","receiptFiltered","pending","receipt","done","totalDataCount","displayedDataCount","FastPurchaseTable","lazy","__vitePreload","import","__VITE_PRELOAD__","TableSkeleton","memo","jsx","className","children","Array","_","i","jsxs","displayName","LazyPurchaseTable","onRefresh","onOptimisticUpdate","onPaymentComplete","onReceiptComplete","Suspense","fallback","TableRow","index","style","getStatusBadge","Badge","getCurrencySymbol","currency","formatAmount","amount","items","vendor_name","item_name","specification","quantity","unit_price_value","total_amount","formatDateShort","onClick","e","preventDefault","stopPropagation","id","title","TableHeader","VirtualizedPurchaseTable","forwardRef","itemHeight","overscanCount","ref","listRef","useRef","useImperativeHandle","scrollToItem","align","current","scrollToTop","scrollToBottom","rowData","handleScroll","scrollOffset","scrollDirection","ReactWindow.FixedSizeList","itemCount","itemSize","itemData","onScroll","AdaptiveTableWrapper","virtualizationThreshold","forceVirtualization","forceTraditional","virtualizedHeight","virtualTableRef","shouldUseVirtualization","useVirtualization","logger","info","performanceStats","estimatedMemoryMB","Math","ceil","estimatedRenderTime","mode","Button","window","scrollTo","top","behavior","ArrowUp","FILTER_FIELDS","type","icon","Calendar","category","User","Package","CheckCircle","options","Check","DATE_FIELDS","value","SORT_FIELDS","FilterToolbar","activeFilters","sortConfig","searchTerm","onFiltersChange","onSortChange","onSearchChange","availableEmployees","availableVendors","availableContacts","availablePaymentSchedules","isFilterOpen","setIsFilterOpen","isSortOpen","setIsSortOpen","isSearchExpanded","setIsSearchExpanded","newFilter","setNewFilter","datePickerOpen","setDatePickerOpen","monthPickerOpen","setMonthPickerOpen","tempDateRange","setTempDateRange","tempMonth","setTempMonth","tempMonthRange","setTempMonthRange","tempSort","setTempSort","searchInputRef","focus","field","direction","handleRemoveFilter","filterId","f","renderValueInput","fieldConfig","Input","placeholder","onChange","prev","target","padding","fontSize","fontWeight","Popover","PopoverTrigger","asChild","variant","role","Search","PopoverContent","Command","CommandInput","CommandEmpty","CommandGroup","CommandItem","onSelect","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","scheduleOptions","open","onOpenChange","start","end","from","to","format","CalendarComponent","selected","range","numberOfMonths","initialFocus","rangeValue","disabled","startYear","startMonth","endYear","endMonth","slice","year","month","currentYear","getFullYear","newDate","getMonth","monthDate","isSelected","isDisabled","Sliders","dateField","df","X","defaultCondition","now","condition","scrollbarWidth","scrollbarColor","WebkitScrollbarWidth","Object","entries","reduce","acc","push","fields","isDateFilter","requiresDateField","finalCondition","ArrowUpDown","ProgressiveLoadingIndicator","state","onLoadMore","isNearEnd","autoLoading","setAutoLoading","hasMore","isLoading","finally","getProgressPercentage","min","round","loadedCount","getLoadingMessage","error","AlertCircle","Loader2","currentBatch","ChevronDown","nextBatchSize","batchSize","LoadMoreButton","nextLimit","displayedCount","onReset","progressiveState","onProgressiveLoadMore","enableProgressive","setIsLoading","async","max","RotateCcw","DEFAULT_CONFIG","maxResults","warningThreshold","enableAutoLimit","SmartFilterWarning","smartFilter","onConfigChange","isDismissed","setIsDismissed","showDetails","setShowDetails","warningMessage","getWarningMessage","styles","isLimited","isOverThreshold","containerClass","iconClass","textClass","badgeClass","getWarningStyles","AlertTriangle","getLimitMessage","limitConfig","Eye","setLimitConfig","PurchaseItemsModal","NAV_TABS","PurchaseListMain","showEmailButton","navigate","useNavigate","location","useLocation","supabase","selectedPurchase","setSelectedPurchase","isModalOpen","setIsModalOpen","setActiveFilters","setSortConfig","setSearchTerm","setAvailableEmployees","setAvailableVendors","setAvailableContacts","setAvailablePaymentSchedules","loading","refreshPurchases","loadPurchases","updatePurchaseOptimistic","setPurchases","setLoading","setCurrentUserRoles","setCurrentUserName","setCurrentUserEmail","setCurrentUserId","initializationRef","cacheValid","employeeData","roles","purchase_role","isArray","String","trim","name","full_name","email","userResult","auth","getUser","user","select","eq","maybeSingle","loadInitialData","forceRefresh","showSpinner","silent","authError","toast","order","ascending","limit","employeeList","vendorList","contactList","employeesResult","vendorsResult","contactsResult","Promise","all","today","processedData","startsWith","request","firstItem","purchase_request_items","requesterEmployee","emp","requester_id","vendorInfo","vendor","vendor_id","contactInfo","contact","contact_id","Number","delivery_request_date","revised_delivery_request_date","payment_completed_at","payment_completed_by_name","request_type","vendor_payment_schedule","vendor_contacts","requester_full_name","amount_value","remark","project_vendor","sales_order_number","project_item","line_number","contact_name","received_at","is_utk_checked","is_statement_received","is_po_download","link","sum","purchase_status","purchaseId","updater","next","usePurchaseData","URLSearchParams","search","get","employees","employeeNames","Boolean","vendors","vendorNames","v","contacts","contactNames","c","schedules","scheduleNames","s","loadFilterOptions","hasInitializedTabRefresh","refreshLatestData","applyAdvancedFilters","searchLower","toLowerCase","forEach","actualField","fieldValue","getFieldValue","filterFieldType","applyFilterCondition","created_at","statement_received_at","filterValue","filterField","startDate","endDate","fieldDate","endOfMonth","endsWith","filterYear","filterMonth","parseInt","fieldStr","filterStr","match","applySorting","aValue","bValue","comparison","localeCompare","advancedFilteredPurchases","hasActiveFilters","hasActiveFiltersDetected","sourceData","setLimitConfigState","shouldApplyLimit","limitedData","shouldShowWarning","hiddenCount","newConfig","resetLimit","useSmartFilterLimit","smartFilteredPurchases","shouldUseProgressive","progressiveLoading","initialBatchSize","maxBatchSize","prefetchThreshold","enablePrefetch","setState","loadedData","setLoadedData","setIsNearEnd","loadingRef","prefetchingRef","loadInitialBatch","initialData","loadMore","resolve","setTimeout","nextBatch","startIndex","endIndex","newData","debug","total","batch","prefetchNext","nextStartIndex","nextEndIndex","observer","IntersectionObserver","entry","isVisible","isIntersecting","intersectionRatio","rootMargin","observe","disconnect","reset","setData","useProgressiveLoading","displayPurchases","handleReceiptComplete","currentTime","requestResult","itemsResult","update","delivery_status","success","handlePaymentComplete","handleLoadMore","handleResetToThirtyDays","modalPurchaseData","marginTop","marginBottom","Plus","tab","Card","CardContent","Fragment","isOpen","onClose","onUpdate"],"ignoreList":[0,1,2,3,4,5,6,7],"sources":["../../node_modules/lucide-react/dist/esm/icons/building.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/eye-off.js","../../node_modules/lucide-react/dist/esm/icons/loader-circle.js","../../node_modules/lucide-react/dist/esm/icons/settings.js","../../node_modules/lucide-react/dist/esm/icons/sliders-vertical.js","../../node_modules/lucide-react/dist/esm/icons/table.js","../../node_modules/lucide-react/dist/esm/icons/zap.js","../../src/hooks/usePurchaseData.ts","../../src/hooks/useDateLimit.ts","../../src/hooks/useFastPurchaseFilters.ts","../../src/components/purchase/LazyPurchaseTable.tsx","../../src/components/purchase/VirtualizedPurchaseTable.tsx","../../src/components/purchase/AdaptiveTableWrapper.tsx","../../src/components/purchase/FilterToolbar.tsx","../../src/components/purchase/ProgressiveLoadingIndicator.tsx","../../src/components/purchase/LoadMoreButton.tsx","../../src/hooks/useProgressiveLoading.ts","../../src/hooks/useSmartFilterLimit.ts","../../src/components/purchase/SmartFilterWarning.tsx","../../src/components/purchase/PurchaseListMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 10h.01\", key: \"1nrarc\" }],\n  [\"path\", { d: \"M12 14h.01\", key: \"1etili\" }],\n  [\"path\", { d: \"M12 6h.01\", key: \"1vi96p\" }],\n  [\"path\", { d: \"M16 10h.01\", key: \"1m94wz\" }],\n  [\"path\", { d: \"M16 14h.01\", key: \"1gbofw\" }],\n  [\"path\", { d: \"M16 6h.01\", key: \"1x0f13\" }],\n  [\"path\", { d: \"M8 10h.01\", key: \"19clt8\" }],\n  [\"path\", { d: \"M8 14h.01\", key: \"6423bh\" }],\n  [\"path\", { d: \"M8 6h.01\", key: \"1dz90k\" }],\n  [\"path\", { d: \"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3\", key: \"cabbwy\" }],\n  [\"rect\", { x: \"4\", y: \"2\", width: \"16\", height: \"20\", rx: \"2\", key: \"1uxh74\" }]\n];\nconst Building = createLucideIcon(\"building\", __iconNode);\n\nexport { __iconNode, Building as default };\n//# sourceMappingURL=building.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",\n      key: \"ct8e1f\"\n    }\n  ],\n  [\"path\", { d: \"M14.084 14.158a3 3 0 0 1-4.242-4.242\", key: \"151rxh\" }],\n  [\n    \"path\",\n    {\n      d: \"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",\n      key: \"13bj9a\"\n    }\n  ],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst EyeOff = createLucideIcon(\"eye-off\", __iconNode);\n\nexport { __iconNode, EyeOff as default };\n//# sourceMappingURL=eye-off.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"path\", { d: \"M21 12a9 9 0 1 1-6.219-8.56\", key: \"13zald\" }]];\nconst LoaderCircle = createLucideIcon(\"loader-circle\", __iconNode);\n\nexport { __iconNode, LoaderCircle as default };\n//# sourceMappingURL=loader-circle.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915\",\n      key: \"1i5ecw\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Settings = createLucideIcon(\"settings\", __iconNode);\n\nexport { __iconNode, Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"21\", y2: \"14\", key: \"1p332r\" }],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"10\", y2: \"3\", key: \"gb41h5\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"21\", y2: \"12\", key: \"hf2csr\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"8\", y2: \"3\", key: \"1kfi7u\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"21\", y2: \"16\", key: \"1lhrwl\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"12\", y2: \"3\", key: \"16vvfq\" }],\n  [\"line\", { x1: \"2\", x2: \"6\", y1: \"14\", y2: \"14\", key: \"1uebub\" }],\n  [\"line\", { x1: \"10\", x2: \"14\", y1: \"8\", y2: \"8\", key: \"1yglbp\" }],\n  [\"line\", { x1: \"18\", x2: \"22\", y1: \"16\", y2: \"16\", key: \"1jxqpz\" }]\n];\nconst SlidersVertical = createLucideIcon(\"sliders-vertical\", __iconNode);\n\nexport { __iconNode, SlidersVertical as default };\n//# sourceMappingURL=sliders-vertical.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 3v18\", key: \"108xh3\" }],\n  [\"rect\", { width: \"18\", height: \"18\", x: \"3\", y: \"3\", rx: \"2\", key: \"afitv7\" }],\n  [\"path\", { d: \"M3 9h18\", key: \"1pudct\" }],\n  [\"path\", { d: \"M3 15h18\", key: \"5xshup\" }]\n];\nconst Table = createLucideIcon(\"table\", __iconNode);\n\nexport { __iconNode, Table as default };\n//# sourceMappingURL=table.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z\",\n      key: \"1xq2db\"\n    }\n  ]\n];\nconst Zap = createLucideIcon(\"zap\", __iconNode);\n\nexport { __iconNode, Zap as default };\n//# sourceMappingURL=zap.js.map\n","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { logger } from '@/lib/logger';\nimport { toast } from 'sonner';\n\nexport interface Purchase {\n  id: number;\n  purchase_order_number?: string;\n  request_date: string;\n  delivery_request_date?: string | null;\n  revised_delivery_request_date?: string | null;\n  progress_type: string;\n  is_payment_completed: boolean;\n  payment_category: string;\n  payment_completed_at?: string;\n  payment_completed_by_name?: string;\n  currency: string;\n  request_type: string;\n  vendor?: {\n    vendor_name: string;\n    vendor_payment_schedule?: string;\n  };\n  vendor_name: string;\n  vendor_payment_schedule?: string;\n  vendor_id?: number;\n  contact_id?: number;\n  vendor_contacts?: {\n    contact_name: string;\n  } | Array<{\n    contact_name: string;\n  }>;\n  contact_name?: string;\n  requester_id: string;\n  requester_name: string;\n  requester_full_name: string;\n  project_vendor: string;\n  sales_order_number: string;\n  project_item: string;\n  middle_manager_status?: string;\n  final_manager_status?: string;\n  total_amount: number;\n  is_received: boolean;\n  received_at?: string;\n\n  is_po_download?: boolean;\n  is_utk_checked?: boolean;\n  is_statement_received?: boolean;\n  items?: any[];\n  purchase_request_items?: any[];\n  item_name?: string;\n  specification?: string;\n  quantity?: number;\n  unit_price_value?: number;\n  amount_value?: number;\n  remark?: string;\n  line_number?: number;\n  link?: string;\n  purchase_status?: string;\n}\n\n\n//   \nconst globalCache = {\n  purchases: null as Purchase[] | null,\n  lastFetch: 0,\n  userInfo: null as any,\n  CACHE_DURATION: 5 * 60 * 1000, // 5  \n  //    \n  filteredData: new Map<string, { data: Purchase[]; timestamp: number }>(),\n  FILTER_CACHE_DURATION: 30 * 1000 // 30  \n};\n\n//    \nexport const clearPurchaseCache = () => {\n  globalCache.purchases = null;\n  globalCache.userInfo = null;\n  globalCache.lastFetch = 0;\n  globalCache.filteredData.clear();\n};\n\n//    ()\nexport const invalidateFilterCache = (tabKey?: string) => {\n  if (tabKey) {\n    for (const [key] of globalCache.filteredData.entries()) {\n      if (key.includes(tabKey)) {\n        globalCache.filteredData.delete(key);\n      }\n    }\n  } else {\n    globalCache.filteredData.clear();\n  }\n};\n\nexport const usePurchaseData = () => {\n  const [purchases, setPurchases] = useState<Purchase[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [currentUserRoles, setCurrentUserRoles] = useState<string[]>([]);\n  const [currentUserName, setCurrentUserName] = useState<string>('');\n  const [currentUserEmail, setCurrentUserEmail] = useState<string>('');\n  const [currentUserId, setCurrentUserId] = useState<string>('');\n  \n  const supabase = createClient();\n  const initializationRef = useRef(false);\n\n  //    ( ,  ) -  \n  useEffect(() => {\n    const loadInitialData = async () => {\n      if (initializationRef.current) return;\n      initializationRef.current = true;\n      \n      const now = Date.now();\n      const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n      \n      try {\n        //     \n        if (cacheValid && globalCache.userInfo) {\n          try {\n            const employeeData = globalCache.userInfo;\n            if (employeeData) {\n              let roles: string[] = [];\n              if (employeeData.purchase_role) {\n                if (Array.isArray(employeeData.purchase_role)) {\n                  roles = employeeData.purchase_role.map((r: any) => String(r).trim());\n                } else {\n                  const roleString = String(employeeData.purchase_role);\n                  roles = roleString\n                    .split(',')\n                    .map((r: string) => r.trim())\n                    .filter((r: string) => r.length > 0);\n                }\n              }\n              \n              setCurrentUserRoles(roles);\n              setCurrentUserName(employeeData.name || employeeData.full_name || '');\n              setCurrentUserEmail(employeeData.email || '');\n              setCurrentUserId(employeeData.id || '');\n            }\n            return;\n          } catch (error) {\n            logger.error('    ', error);\n            //  \n            globalCache.purchases = null;\n            globalCache.userInfo = null;\n            globalCache.lastFetch = 0;\n          }\n        }\n        \n        //      \n        const userResult = await supabase.auth.getUser();\n\n        //     \n        if (userResult.data.user && !userResult.error) {\n          // email    ( )\n          let employeeData = null;\n          if (userResult.data.user.email) {\n            const emailResult = await supabase\n              .from('employees')\n              .select('*')\n              .eq('email', userResult.data.user.email)\n              .maybeSingle();\n            \n            employeeData = emailResult.data;\n          }\n          \n          if (employeeData) {\n            globalCache.userInfo = employeeData;\n            \n            let roles: string[] = [];\n            if (employeeData.purchase_role) {\n              if (Array.isArray(employeeData.purchase_role)) {\n                roles = employeeData.purchase_role.map((r: any) => String(r).trim());\n              } else {\n                const roleString = String(employeeData.purchase_role);\n                roles = roleString\n                  .split(',')\n                  .map((r: string) => r.trim())\n                  .filter((r: string) => r.length > 0);\n              }\n            }\n            \n            setCurrentUserRoles(roles);\n            setCurrentUserName(employeeData.name || employeeData.full_name || '');\n            setCurrentUserEmail(employeeData.email || '');\n            setCurrentUserId(employeeData.id || '');\n          }\n          \n          globalCache.lastFetch = now;\n        }\n      } catch (error) {\n        logger.error('   ', error);\n      }\n    };\n\n    loadInitialData();\n  }, []);\n\n  //    -    \n  const loadPurchases = useCallback(async (forceRefresh?: boolean, options?: { silent?: boolean }) => {\n    const showSpinner = !options?.silent;\n\n    if (showSpinner) {\n      setLoading(true);\n    }\n    \n    try {\n      //  \n      const now = Date.now();\n      const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n      \n      //      \n      if (forceRefresh) {\n        invalidateFilterCache();\n        globalCache.purchases = null;\n        globalCache.lastFetch = 0;\n      }\n      \n      if (!forceRefresh && cacheValid && globalCache.purchases) {\n        try {\n          setPurchases(globalCache.purchases);\n          if (showSpinner) {\n            setLoading(false);\n          }\n          return;\n        } catch (error) {\n          logger.error('     ', error);\n          //  \n          globalCache.purchases = null;\n          globalCache.lastFetch = 0;\n          invalidateFilterCache();\n        }\n      }\n      \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      if (authError || !user) {\n        logger.error('  ', authError);\n        toast.error(' .');\n        if (showSpinner) {\n          setLoading(false);\n        }\n        return;\n      }\n\n      //        \n      \n      //  purchase_requests  (vendors JOIN )\n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          purchase_request_items(*)\n        `)\n        .order('request_date', { ascending: false })\n        .limit(1000); //  :  1000\n\n      if (error) {\n        throw error;\n      }\n\n      //  employees vendors, vendor_contacts   (   )\n      let employeeList: any[] = [];\n      let vendorList: any[] = [];\n      let contactList: any[] = [];\n      \n      //     \n      if (data && data.length > 0) {\n        //     (  )\n        const [employeesResult, vendorsResult, contactsResult] = await Promise.all([\n          supabase.from('employees').select('id, name, email'),\n          supabase.from('vendors').select('id, vendor_name, vendor_payment_schedule'),\n          supabase.from('vendor_contacts').select('id, contact_name')\n        ]);\n        \n        employeeList = employeesResult.data || [];\n        vendorList = vendorsResult.data || [];\n        contactList = contactsResult.data || [];\n      }\n\n      \n      //    \n      const today = new Date().toISOString().split('T')[0];\n      const todayItems = (data || []).filter((d: any) => d.request_date?.startsWith(today));\n\n      //   (hanslwebapp )\n      const processedData = (data || []).map((request: any) => {\n        //     (   )\n        const firstItem = request.purchase_request_items?.[0] || {};\n        \n        // requester_id employee \n        const requesterEmployee = employeeList.find(emp => emp.id === request.requester_id);\n        \n        // vendor_id vendor \n        const vendorInfo = vendorList.find(vendor => vendor.id === request.vendor_id);\n        \n        // contact_id  \n        const contactInfo = contactList.find(contact => contact.id === request.contact_id);\n        \n        return {\n          id: Number(request.id),\n          purchase_order_number: request.purchase_order_number as string,\n          request_date: request.request_date as string,\n          delivery_request_date: request.delivery_request_date ?? null,\n          revised_delivery_request_date: request.revised_delivery_request_date ?? null,\n          progress_type: request.progress_type as string,\n          payment_completed_at: request.payment_completed_at as string,\n          payment_completed_by_name: request.payment_completed_by_name as string,\n          payment_category: request.payment_category as string,\n          currency: request.currency as string,\n          request_type: request.request_type as string,\n          vendor: undefined, // vendors JOIN \n          vendor_name: request.vendor_name || '', // purchase_requests  vendor_name \n          vendor_payment_schedule: vendorInfo?.vendor_payment_schedule || '', // vendors  \n          vendor_contacts: [], // vendors JOIN  \n          requester_id: request.requester_id as string,\n          requester_name: request.requester_name as string,\n          requester_full_name: requesterEmployee?.name || request.requester_name || '',\n          item_name: firstItem.item_name as string || '',\n          specification: firstItem.specification as string || '',\n          quantity: Number(firstItem.quantity) || 0,\n          unit_price_value: Number(firstItem.unit_price_value) || 0,\n          amount_value: Number(firstItem.amount_value) || 0,\n          remark: firstItem.remark as string || '',\n          project_vendor: request.project_vendor as string,\n          sales_order_number: request.sales_order_number as string,\n          project_item: request.project_item as string,\n          line_number: Number(firstItem.line_number) || 1,\n          contact_name: contactInfo?.contact_name || '', // contact_id   \n          middle_manager_status: request.middle_manager_status,\n          final_manager_status: request.final_manager_status,\n          is_received: !!request.is_received,\n          received_at: request.received_at as string,\n          is_payment_completed: !!request.is_payment_completed,\n          is_utk_checked: !!request.is_utk_checked,\n          is_statement_received: !!request.is_statement_received,\n          is_po_download: !!request.is_po_download,\n          link: firstItem.link as string | undefined,\n          //     (hanslwebapp  items ) - line_number \n          items: (request.purchase_request_items || []).sort((a: any, b: any) => \n            (a.line_number || 0) - (b.line_number || 0)),\n          //   \n          total_amount: request.purchase_request_items?.reduce((sum: number, item: any) => \n            sum + (Number(item.amount_value) || 0), 0) || 0,\n          purchase_status: request.purchase_status || 'pending'\n        };\n      });\n\n\n      //     \n      setPurchases(processedData);\n      globalCache.purchases = processedData;\n      globalCache.lastFetch = now;\n    } catch (error) {\n      logger.error('   ', error);\n      toast.error('    .');\n    } finally {\n      if (showSpinner) {\n        setLoading(false);\n      }\n    }\n  }, [supabase]);\n\n  const updatePurchaseOptimistic = useCallback((purchaseId: number, updater: (prev: Purchase) => Purchase) => {\n    setPurchases(prev => {\n      const next = prev.map(purchase => (purchase.id === purchaseId ? updater(purchase) : purchase));\n      globalCache.purchases = next;\n      return next;\n    });\n  }, []);\n\n  useEffect(() => {\n    loadPurchases();\n  }, [loadPurchases]);\n\n  return {\n    purchases,\n    loading,\n    currentUserRoles,\n    currentUserName,\n    currentUserEmail,\n    currentUserId,\n    refreshPurchases: loadPurchases,\n    updatePurchaseOptimistic\n  };\n};\n","import { useState, useCallback, useMemo } from 'react';\n\nexport interface DateLimitOption {\n  key: string;\n  label: string;\n  days: number | null; // null = \n  description: string;\n}\n\n//   \nexport const DATE_LIMIT_OPTIONS: DateLimitOption[] = [\n  { key: '30d', label: ' 30', days: 30, description: ' 30 ' },\n  { key: '90d', label: ' 90', days: 90, description: ' 90 ' },\n  { key: '180d', label: ' 180', days: 180, description: ' 180 ' },\n  { key: 'all', label: '', days: null, description: ' ' }\n];\n\nexport interface UseDateLimitResult {\n  currentLimit: DateLimitOption;\n  setDateLimit: (option: DateLimitOption) => void;\n  getNextLimit: () => DateLimitOption | null;\n  hasNextLimit: boolean;\n  isFullyLoaded: boolean;\n  getDateThreshold: () => string | null;\n  getTotalCountMessage: (totalCount: number, filteredCount: number) => string;\n}\n\nexport const useDateLimit = (initialLimit: string = '30d'): UseDateLimitResult => {\n  const [currentLimitKey, setCurrentLimitKey] = useState(initialLimit);\n\n  //   \n  const currentLimit = useMemo(() => {\n    return DATE_LIMIT_OPTIONS.find(opt => opt.key === currentLimitKey) || DATE_LIMIT_OPTIONS[0];\n  }, [currentLimitKey]);\n\n  //    \n  const getNextLimit = useCallback((): DateLimitOption | null => {\n    const currentIndex = DATE_LIMIT_OPTIONS.findIndex(opt => opt.key === currentLimitKey);\n    const nextIndex = currentIndex + 1;\n    return nextIndex < DATE_LIMIT_OPTIONS.length ? DATE_LIMIT_OPTIONS[nextIndex] : null;\n  }, [currentLimitKey]);\n\n  //    (ISO )\n  const getDateThreshold = useCallback((): string | null => {\n    if (!currentLimit.days) return null;\n    \n    const now = new Date();\n    const threshold = new Date(now.getTime() - currentLimit.days * 24 * 60 * 60 * 1000);\n    return threshold.toISOString().split('T')[0];\n  }, [currentLimit]);\n\n  //  \n  const setDateLimit = useCallback((option: DateLimitOption) => {\n    setCurrentLimitKey(option.key);\n  }, []);\n\n  //    \n  const hasNextLimit = useMemo(() => {\n    return getNextLimit() !== null;\n  }, [getNextLimit]);\n\n  //   ( )\n  const isFullyLoaded = useMemo(() => {\n    return currentLimit.days === null;\n  }, [currentLimit]);\n\n  //    \n  const getTotalCountMessage = useCallback((totalCount: number, filteredCount: number): string => {\n    if (isFullyLoaded) {\n      return ` ${totalCount.toLocaleString()}`;\n    }\n    \n    if (totalCount === filteredCount) {\n      return `${currentLimit.label} (${filteredCount.toLocaleString()})`;\n    }\n    \n    return `${currentLimit.label} (${filteredCount.toLocaleString()} /  ${totalCount.toLocaleString()}+)`;\n  }, [currentLimit, isFullyLoaded]);\n\n  return {\n    currentLimit,\n    setDateLimit,\n    getNextLimit,\n    hasNextLimit,\n    isFullyLoaded,\n    getDateThreshold,\n    getTotalCountMessage\n  };\n};\n\n//      \nexport const filterByDateLimit = <T extends { request_date: string }>(\n  data: T[],\n  threshold: string | null\n): T[] => {\n  if (!threshold) return data;\n  \n  return data.filter(item => {\n    const itemDate = item.request_date?.split('T')[0];\n    return itemDate && itemDate >= threshold;\n  });\n};","import { useState, useMemo, useEffect, useCallback } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { Purchase } from './usePurchaseData';\nimport { useDateLimit, filterByDateLimit, DATE_LIMIT_OPTIONS } from './useDateLimit';\n\n//   -     (  )\nconst HIDDEN_EMPLOYEES = [''];  //  \n\nexport const useFastPurchaseFilters = (purchases: Purchase[], currentUserRoles: string[], currentUserName: string, currentUserId?: string, currentUserEmail?: string) => {\n  const supabase = createClient();\n  const [activeTab, setActiveTab] = useState('pending');\n  //   - hanslwebapp    \n  const [selectedEmployee, setSelectedEmployee] = useState<string>('');\n  \n  //    - \" \"   30 \n  const dateLimit = useDateLimit(activeTab === 'done' ? '30d' : 'all');\n\n  //   \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  const isFinalApprover = currentUserRoles?.includes('final_approver');\n  const isMiddleManager = currentUserRoles?.includes('middle_manager');\n  const isPurchaseManager = currentUserRoles?.includes('purchase_manager');\n  const hasApprovalRole = isAdmin || isFinalApprover || isMiddleManager;\n  \n  // lead buyer   \n  const isLeadBuyer = currentUserRoles?.includes('raw_material_manager') || \n                      currentUserRoles?.includes('consumable_manager') || \n                      currentUserRoles?.includes('purchase_manager');\n                      \n  // HR   \n  const isHr = currentUserRoles?.includes('hr');\n\n  // hanslwebapp   - roleCase  (lead buyer )\n  const roleCase = useMemo(() => {\n    if (!currentUserRoles || currentUserRoles.length === 0) return 1; // null\n    if (isPurchaseManager) return 2; // purchase_manager\n    if (currentUserRoles.some(r => ['middle_manager', 'final_approver', 'app_admin', 'ceo'].includes(r))) return 3;\n    return 1;\n  }, [currentUserRoles, isPurchaseManager]);\n  \n  //      (,  lead buyer, HR, app_admin  )\n  const computeDefaultEmployee = useCallback(\n    (tabKey: string): string => {\n      if (!currentUserName) return 'all';\n      \n      //   lead buyer, HR, app_admin  \n      if (tabKey === 'purchase') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return 'all';\n        }\n        return currentUserName;\n      }\n      \n      //   lead buyer, HR, app_admin  \n      if (tabKey === 'receipt') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return 'all';\n        }\n        return currentUserName;\n      }\n      \n      switch (roleCase) {\n        case 1: // role null\n          if (tabKey === 'done') return 'all';\n          return currentUserName;\n        case 2: // purchase_manager\n          if (tabKey === 'done') return 'all';\n          return currentUserName; // pending & receipt\n        case 3: //  \n          return 'all';\n        default:\n          return currentUserName;\n      }\n    },\n    [currentUserName, roleCase, isLeadBuyer, isHr, isAdmin]\n  );\n  \n  //    /     (hanslwebapp )\n  useEffect(() => {\n    if (!currentUserName) return;\n    const defaultEmployee = computeDefaultEmployee(activeTab);\n    setSelectedEmployee(defaultEmployee);\n    \n    // \" \"    ,    \n    if (activeTab === 'done') {\n      dateLimit.setDateLimit(DATE_LIMIT_OPTIONS[0]); // 30 \n    } else {\n      dateLimit.setDateLimit(DATE_LIMIT_OPTIONS[3]); //  \n    }\n  }, [activeTab, currentUserName, roleCase, computeDefaultEmployee, dateLimit]);\n  \n  // 1:   ( )\n  const visiblePurchases = useMemo(() => {\n    //    -   \n    const hasManagerRole = currentUserRoles.includes('purchase_manager') || currentUserRoles.includes('app_admin');\n    \n    const result = hasManagerRole \n      ? purchases \n      : purchases.filter(p => !HIDDEN_EMPLOYEES.includes(p.requester_name));\n    return result;\n  }, [purchases, currentUserRoles]);\n\n  // 1.5:    (\" \" )\n  const dateLimitedPurchases = useMemo(() => {\n    if (activeTab !== 'done') {\n      return visiblePurchases; //     \n    }\n    \n    const threshold = dateLimit.getDateThreshold();\n    return filterByDateLimit(visiblePurchases, threshold);\n  }, [visiblePurchases, activeTab, dateLimit]);\n\n\n  // 2:  \n  const tabFilteredPurchases = useMemo(() => {\n    //    (  )\n    const today = new Date().toISOString().split('T')[0];\n    \n    const result = dateLimitedPurchases.filter((purchase: Purchase) => {\n      let matches = false;\n      \n      switch (activeTab) {\n        case 'pending':\n          //     pending \n          const middlePending = ['pending', '', '', null, undefined].includes(purchase.middle_manager_status as any);\n          const finalPending = ['pending', '', '', null, undefined].includes(purchase.final_manager_status as any);\n          \n          //   \n          const middleRejected = purchase.middle_manager_status === 'rejected';\n          const finalRejected = purchase.final_manager_status === 'rejected';\n          \n          if (middleRejected || finalRejected) return false;\n          \n          //     \n          const middleApproved = purchase.middle_manager_status === 'approved';\n          const finalApproved = purchase.final_manager_status === 'approved';\n          \n          if (middleApproved && finalApproved) {\n            return false; //      \n          }\n          \n          //     \n          matches = middlePending || finalPending;\n          \n          return matches;\n          \n        case 'purchase': {\n          // DB  : ' ' ( )  ''\n          const isRequest = purchase.payment_category === ' ';\n          const isSeonJin = (purchase.progress_type || '').includes('');\n          const isIlban = (purchase.progress_type || '').includes('');\n          const finalApproved = purchase.final_manager_status === 'approved';\n          \n          //     \n          if (purchase.is_payment_completed) {\n            return false; //    \n          }\n          \n          //   :     \n          if (!isRequest) {\n            matches = false;\n          } else {\n            matches = (isSeonJin) || (isIlban && finalApproved);\n          }\n          \n          return matches;\n        }\n        \n        case 'receipt': {\n          // :  & ( or )\n          const isSeonJin = (purchase.progress_type || '').includes('');\n          const finalApproved = purchase.final_manager_status === 'approved';\n          \n          //     \n          if (purchase.is_received) {\n            return false; //    \n          }\n          \n          //   : ( or )\n          matches = (isSeonJin || finalApproved);\n          return matches;\n        }\n        \n        case 'done':\n          matches = true;\n          return matches;\n          \n        default:\n          return true;\n      }\n    });\n    return result;\n  }, [dateLimitedPurchases, activeTab]);\n\n  // 3:  \n  const employeeFilteredPurchases = useMemo(() => {\n    let result;\n    if (selectedEmployee && selectedEmployee !== 'all' && selectedEmployee !== '') {\n      result = tabFilteredPurchases.filter((purchase: Purchase) => purchase.requester_name === selectedEmployee);\n    } else {\n      result = tabFilteredPurchases;\n    }\n    return result;\n  }, [tabFilteredPurchases, selectedEmployee]);\n\n  // 4:      -  ()\n  const filteredPurchases = useMemo(() => {\n    return [...employeeFilteredPurchases].sort((a, b) => {\n      const dateA = a.request_date ? new Date(a.request_date).getTime() : 0\n      const dateB = b.request_date ? new Date(b.request_date).getTime() : 0\n      return dateB - dateA\n    })\n  }, [employeeFilteredPurchases]);\n\n  //   (hanslwebapp  )\n  const tabCounts = useMemo(() => {\n    //     \n    const countPurchases = visiblePurchases;\n    \n    //    -   \n    const dateFilteredForCount = countPurchases;\n    \n    //      ( )\n    const getUniqueOrderCount = (filtered: Purchase[]) => {\n      return new Set(filtered.map(p => p.purchase_order_number)).size;\n    };\n    \n    //       ()\n    const getFilteredDataForTab = (tabKey: string) => {\n      //    \n      if (tabKey === 'purchase') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return countPurchases;\n        } else {\n          return countPurchases.filter((p: Purchase) => p.requester_name === currentUserName);\n        }\n      }\n      \n      //    \n      if (tabKey === 'receipt') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return countPurchases;\n        } else {\n          return countPurchases.filter((p: Purchase) => p.requester_name === currentUserName);\n        }\n      }\n      \n      const defaultEmployee = computeDefaultEmployee(tabKey);\n      \n      if (defaultEmployee === 'all' || defaultEmployee === '') {\n        return countPurchases;\n      } else {\n        return countPurchases.filter((p: Purchase) => p.requester_name === defaultEmployee);\n      }\n    };\n    \n    //    \n    const pendingData = getFilteredDataForTab('pending');\n    const purchaseData = getFilteredDataForTab('purchase');\n    const receiptData = getFilteredDataForTab('receipt');\n    const doneData = getFilteredDataForTab('done');\n    \n    const pendingFiltered = pendingData.filter((p: Purchase) => {\n      //  \n      const today = new Date().toISOString().split('T')[0];\n      \n      //     pending \n      const middlePending = ['pending', '', '', null, undefined].includes(p.middle_manager_status as any);\n      const finalPending = ['pending', '', '', null, undefined].includes(p.final_manager_status as any);\n      \n      //   \n      const middleRejected = p.middle_manager_status === 'rejected';\n      const finalRejected = p.final_manager_status === 'rejected';\n      \n      if (middleRejected || finalRejected) return false;\n      \n      //     \n      const middleApproved = p.middle_manager_status === 'approved';\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      if (middleApproved && finalApproved) {\n        return false; //      \n      }\n      \n      //     \n      return middlePending || finalPending;\n    });\n    \n    const purchaseFiltered = purchaseData.filter((p: Purchase) => {\n      //  \n      const today = new Date().toISOString().split('T')[0];\n      \n      const isRequest = p.payment_category === ' ';\n      const isSeonJin = (p.progress_type || '').includes('');\n      const isIlban = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      //     \n      if (p.is_payment_completed) {\n        return false; //    \n      }\n      \n      if (!isRequest) return false;\n      return (isSeonJin) || (isIlban && finalApproved);\n    });\n    \n    const receiptFiltered = receiptData.filter((p: Purchase) => {\n      //  \n      const today = new Date().toISOString().split('T')[0];\n      \n      const isSeonJin = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      //     \n      if (p.is_received) {\n        return false; //    \n      }\n      \n      return (isSeonJin || finalApproved);\n    });\n    \n    const counts = {\n      pending: getUniqueOrderCount(pendingFiltered),\n      purchase: getUniqueOrderCount(purchaseFiltered),\n      receipt: getUniqueOrderCount(receiptFiltered),\n      done: getUniqueOrderCount(doneData)  //  \n    };\n    \n    return counts;\n  }, [visiblePurchases, roleCase, currentUserName, computeDefaultEmployee, isLeadBuyer, isHr, isAdmin]);\n\n\n  return {\n    // States\n    activeTab,\n    selectedEmployee,\n    \n    // Setters\n    setActiveTab,\n    setSelectedEmployee,\n    \n    // Computed values\n    filteredPurchases,\n    tabCounts,\n    \n    //   \n    dateLimit,\n    totalDataCount: visiblePurchases.length,\n    displayedDataCount: dateLimitedPurchases.length\n  };\n};","import { memo, lazy, Suspense } from 'react';\nimport { Purchase } from '@/hooks/usePurchaseData';\n\n// Lazy load the heavy table component\nconst FastPurchaseTable = lazy(() => import('./FastPurchaseTable'));\n\ninterface LazyPurchaseTableProps {\n  purchases: Purchase[];\n  activeTab: string;\n  currentUserRoles: string[];\n  onRefresh: (forceRefresh?: boolean, options?: { silent?: boolean }) => Promise<void> | void;\n  onOptimisticUpdate: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void;\n  onPaymentComplete: (id: number) => Promise<void>;\n  onReceiptComplete: (id: number) => Promise<void>;\n}\n\n// Memoized loading component\nconst TableSkeleton = memo(() => (\n  <div className=\"p-4 space-y-4\">\n    {[...Array(5)].map((_, i) => (\n      <div key={i} className=\"flex space-x-4 animate-pulse\">\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n      </div>\n    ))}\n  </div>\n));\nTableSkeleton.displayName = 'TableSkeleton';\n\n// Main component with memoization\nconst LazyPurchaseTable = memo<LazyPurchaseTableProps>(({\n  purchases,\n  activeTab,\n  currentUserRoles,\n  onRefresh,\n  onOptimisticUpdate,\n  onPaymentComplete,\n  onReceiptComplete\n}) => (\n  <Suspense fallback={<TableSkeleton />}>\n    <FastPurchaseTable\n      purchases={purchases}\n      activeTab={activeTab}\n      currentUserRoles={currentUserRoles}\n      onRefresh={onRefresh}\n      onOptimisticUpdate={onOptimisticUpdate}\n      onPaymentComplete={onPaymentComplete}\n      onReceiptComplete={onReceiptComplete}\n    />\n  </Suspense>\n));\n\nLazyPurchaseTable.displayName = 'LazyPurchaseTable';\n\nexport default LazyPurchaseTable;","import React, { memo, useMemo, useCallback, forwardRef, useImperativeHandle, useRef } from 'react';\nimport * as ReactWindow from 'react-window';\nimport { Purchase } from '@/hooks/usePurchaseData';\nimport { Badge } from '@/components/ui/badge';\nimport { formatDateShort } from '@/utils/helpers';\nimport { logger } from '@/lib/logger';\n\ninterface VirtualizedPurchaseTableProps {\n  purchases: Purchase[];\n  activeTab: string;\n  currentUserRoles: string[];\n  onRefresh?: () => void;\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void;\n  onPaymentComplete?: (id: number) => Promise<void>;\n  onReceiptComplete?: (id: number) => Promise<void>;\n  height?: number;\n  itemHeight?: number;\n  overscanCount?: number;\n  className?: string;\n}\n\nexport interface VirtualizedTableHandle {\n  scrollToItem: (index: number, align?: 'auto' | 'smart' | 'center' | 'end' | 'start') => void;\n  scrollToTop: () => void;\n  scrollToBottom: () => void;\n}\n\n//  \nconst TableRow = memo<{\n  index: number;\n  style: React.CSSProperties;\n  data: {\n    purchases: Purchase[];\n    activeTab: string;\n    currentUserRoles: string[];\n    onPaymentComplete?: (id: number) => Promise<void>;\n    onReceiptComplete?: (id: number) => Promise<void>;\n  };\n}>(({ index, style, data }) => {\n  const { purchases, activeTab, currentUserRoles, onPaymentComplete, onReceiptComplete } = data;\n  const purchase = purchases[index];\n\n  //  \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  const isLeadBuyer = currentUserRoles?.includes('raw_material_manager') || \n                     currentUserRoles?.includes('consumable_manager') || \n                     currentUserRoles?.includes('purchase_manager');\n\n  //   \n  const getStatusBadge = useCallback((purchase: Purchase) => {\n    if (purchase.is_received) {\n      return <Badge className=\"badge-success\"></Badge>;\n    } else if (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved') {\n      return <Badge className=\"badge-primary\"></Badge>;\n    } else if (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected') {\n      return <Badge className=\"badge-danger\"></Badge>;\n    } else {\n      return <Badge className=\"badge-warning\"></Badge>;\n    }\n  }, []);\n\n  //   \n  const getCurrencySymbol = useCallback((currency: string) => {\n    if (!currency) return '';\n    if (['KRW', '', ''].includes(currency)) return '';\n    if (['USD', '$', ''].includes(currency)) return '$';\n    return currency;\n  }, []);\n\n  //  \n  const formatAmount = useCallback((amount: number, currency: string = 'KRW') => {\n    return `${getCurrencySymbol(currency)}${amount.toLocaleString()}`;\n  }, [getCurrencySymbol]);\n\n  if (!purchase) {\n    return (\n      <div style={style} className=\"flex items-center justify-center\">\n        <div className=\"card-description\"> </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      style={style}\n      className=\"flex items-center border-b border-gray-100 hover:bg-gray-50 transition-colors px-4\"\n    >\n      {/*  */}\n      <div className=\"w-32 min-w-[128px] flex-shrink-0\">\n        <div className=\"card-title truncate\">\n          {purchase.purchase_order_number}\n        </div>\n        <div className=\"card-description\">\n          {purchase.items?.length || 1} \n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-20 min-w-[80px] flex-shrink-0\">\n        <div className=\"card-subtitle truncate\">\n          {purchase.requester_name}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-28 min-w-[112px] flex-shrink-0\">\n        <div className=\"card-subtitle truncate\">\n          {purchase.vendor_name}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-32 min-w-[128px] flex-shrink-0\">\n        <div className=\"card-description truncate\">\n          {purchase.item_name}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-40 min-w-[160px] flex-shrink-0\">\n        <div className=\"card-description truncate\">\n          {purchase.specification}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-16 min-w-[64px] flex-shrink-0 text-center\">\n        <div className=\"card-description\">\n          {purchase.quantity?.toLocaleString() || 0}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-24 min-w-[96px] flex-shrink-0 text-right\">\n        <div className=\"card-amount\">\n          {formatAmount(purchase.unit_price_value || 0, purchase.currency)}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-24 min-w-[96px] flex-shrink-0 text-right\">\n        <div className=\"card-amount-large\">\n          {formatAmount(purchase.total_amount || 0, purchase.currency)}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-20 min-w-[80px] flex-shrink-0\">\n        <div className=\"card-date\">\n          {formatDateShort(purchase.request_date)}\n        </div>\n      </div>\n\n      {/*  */}\n      <div className=\"w-20 min-w-[80px] flex-shrink-0 text-center\">\n        {getStatusBadge(purchase)}\n      </div>\n\n      {/*   () */}\n      <div className=\"w-24 min-w-[96px] flex-shrink-0 flex gap-1\">\n        {activeTab === 'purchase' && isLeadBuyer && !purchase.is_payment_completed && (\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              onPaymentComplete?.(purchase.id);\n            }}\n            className=\"button-base bg-green-500 hover:bg-green-600 text-white\"\n            title=\"\"\n          >\n            \n          </button>\n        )}\n        \n        {activeTab === 'receipt' && isLeadBuyer && !purchase.is_received && (\n          <button\n            onClick={(e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              onReceiptComplete?.(purchase.id);\n            }}\n            className=\"button-base bg-blue-500 hover:bg-blue-600 text-white\"\n            title=\"\"\n          >\n            \n          </button>\n        )}\n      </div>\n    </div>\n  );\n});\n\nTableRow.displayName = 'VirtualizedTableRow';\n\n//  \nconst TableHeader = memo(() => (\n  <div className=\"flex items-center bg-gray-50 border-b-2 border-gray-200 px-4 py-3 text-sm font-medium text-gray-700\">\n    <div className=\"w-32 min-w-[128px] flex-shrink-0\"></div>\n    <div className=\"w-20 min-w-[80px] flex-shrink-0\"></div>\n    <div className=\"w-28 min-w-[112px] flex-shrink-0\"></div>\n    <div className=\"w-32 min-w-[128px] flex-shrink-0\"></div>\n    <div className=\"w-40 min-w-[160px] flex-shrink-0\"></div>\n    <div className=\"w-16 min-w-[64px] flex-shrink-0 text-center\"></div>\n    <div className=\"w-24 min-w-[96px] flex-shrink-0 text-right\"></div>\n    <div className=\"w-24 min-w-[96px] flex-shrink-0 text-right\"></div>\n    <div className=\"w-20 min-w-[80px] flex-shrink-0\"></div>\n    <div className=\"w-20 min-w-[80px] flex-shrink-0 text-center\"></div>\n    <div className=\"w-24 min-w-[96px] flex-shrink-0 text-center\"></div>\n  </div>\n));\n\nTableHeader.displayName = 'VirtualizedTableHeader';\n\n//    \nconst VirtualizedPurchaseTable = forwardRef<VirtualizedTableHandle, VirtualizedPurchaseTableProps>(({\n  purchases,\n  activeTab,\n  currentUserRoles,\n  onRefresh,\n  onOptimisticUpdate,\n  onPaymentComplete,\n  onReceiptComplete,\n  height = 600,\n  itemHeight = 64,\n  overscanCount = 10,\n  className = \"\"\n}, ref) => {\n  \n  const listRef = useRef<ReactWindow.FixedSizeList>(null);\n\n  //       \n  useImperativeHandle(ref, () => ({\n    scrollToItem: (index: number, align = 'auto') => {\n      listRef.current?.scrollToItem(index, align);\n    },\n    scrollToTop: () => {\n      listRef.current?.scrollToItem(0, 'start');\n    },\n    scrollToBottom: () => {\n      listRef.current?.scrollToItem(purchases.length - 1, 'end');\n    }\n  }), [purchases.length]);\n\n  //   \n  const rowData = useMemo(() => ({\n    purchases,\n    activeTab,\n    currentUserRoles,\n    onPaymentComplete,\n    onReceiptComplete\n  }), [purchases, activeTab, currentUserRoles, onPaymentComplete, onReceiptComplete]);\n\n  //   \n  const handleScroll = useCallback(({ scrollOffset, scrollDirection }: any) => {\n    //   \n    if (process.env.NODE_ENV === 'development') {\n      logger.debug('  ', {\n        offset: scrollOffset,\n        direction: scrollDirection,\n        itemCount: purchases.length\n      });\n    }\n  }, [purchases.length]);\n\n  return (\n    <div className={`${className}`}>\n      {/*   */}\n      <TableHeader />\n      \n      {/*    */}\n      <div className=\"border border-gray-200 rounded-b-lg overflow-hidden\">\n        {purchases.length === 0 ? (\n          <div className=\"flex items-center justify-center py-12\">\n            <div className=\"text-center\">\n              <div className=\"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4\">\n                <span className=\"text-gray-400\"></span>\n              </div>\n              <div className=\"card-subtitle\">  </div>\n            </div>\n          </div>\n        ) : (\n          <ReactWindow.FixedSizeList\n            ref={listRef}\n            height={height}\n            itemCount={purchases.length}\n            itemSize={itemHeight}\n            itemData={rowData}\n            overscanCount={overscanCount}\n            onScroll={handleScroll}\n            className=\"virtualized-table-list\"\n          >\n            {TableRow}\n          </ReactWindow.FixedSizeList>\n        )}\n      </div>\n      \n      {/*    () */}\n      {process.env.NODE_ENV === 'development' && purchases.length > 0 && (\n        <div className=\"mt-2 text-xs text-gray-500\">\n          <span> : {purchases.length.toLocaleString()} ,   </span>\n        </div>\n      )}\n    </div>\n  );\n});\n\nVirtualizedPurchaseTable.displayName = 'VirtualizedPurchaseTable';\n\nexport default VirtualizedPurchaseTable;","import React, { memo, useMemo, useRef } from 'react';\nimport { Purchase } from '@/hooks/usePurchaseData';\nimport LazyPurchaseTable from './LazyPurchaseTable';\nimport VirtualizedPurchaseTable, { VirtualizedTableHandle } from './VirtualizedPurchaseTable';\nimport { Button } from '@/components/ui/button';\nimport { Zap, Table, ArrowUp } from 'lucide-react';\nimport { logger } from '@/lib/logger';\n\ninterface AdaptiveTableWrapperProps {\n  purchases: Purchase[];\n  activeTab: string;\n  currentUserRoles: string[];\n  onRefresh?: (forceRefresh?: boolean, options?: { silent?: boolean }) => Promise<void> | void;\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void;\n  onPaymentComplete?: (id: number) => Promise<void>;\n  onReceiptComplete?: (id: number) => Promise<void>;\n  \n  //  \n  virtualizationThreshold?: number; //      \n  forceVirtualization?: boolean;    //   \n  forceTraditional?: boolean;       //    \n  virtualizedHeight?: number;       //   \n}\n\nconst AdaptiveTableWrapper = memo<AdaptiveTableWrapperProps>(({\n  purchases,\n  activeTab,\n  currentUserRoles,\n  onRefresh,\n  onOptimisticUpdate,\n  onPaymentComplete,\n  onReceiptComplete,\n  virtualizationThreshold = 200,\n  forceVirtualization = false,\n  forceTraditional = false,\n  virtualizedHeight = 600\n}) => {\n  \n  const virtualTableRef = useRef<VirtualizedTableHandle>(null);\n\n  //    \n  const shouldUseVirtualization = useMemo(() => {\n    if (forceTraditional) return false;\n    if (forceVirtualization) return true;\n    \n    //     \n    const useVirtualization = purchases.length >= virtualizationThreshold;\n    \n    if (useVirtualization) {\n      logger.info('  ', {\n        itemCount: purchases.length,\n        threshold: virtualizationThreshold,\n        activeTab\n      });\n    }\n    \n    return useVirtualization;\n  }, [purchases.length, virtualizationThreshold, forceVirtualization, forceTraditional, activeTab]);\n\n  //   \n  const performanceStats = useMemo(() => {\n    const itemCount = purchases.length;\n    const estimatedMemoryMB = shouldUseVirtualization \n      ? Math.ceil(itemCount * 0.001) // :   \n      : Math.ceil(itemCount * 0.1);  // :   \n    \n    const estimatedRenderTime = shouldUseVirtualization\n      ? '< 100ms'                    // :  \n      : itemCount > 500 ? '> 1s' : '< 500ms'; // :   \n    \n    return {\n      itemCount,\n      estimatedMemoryMB,\n      estimatedRenderTime,\n      mode: shouldUseVirtualization ? 'virtualized' : 'traditional'\n    };\n  }, [purchases.length, shouldUseVirtualization]);\n\n  //   \n  const scrollToTop = () => {\n    if (shouldUseVirtualization) {\n      virtualTableRef.current?.scrollToTop();\n    } else {\n      window.scrollTo({ top: 0, behavior: 'smooth' });\n    }\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      {/*    (     ) */}\n      {(process.env.NODE_ENV === 'development' || purchases.length > 100) && (\n        <div className=\"flex items-center justify-between bg-blue-50 border border-blue-200 rounded-lg p-3\">\n          <div className=\"flex items-center gap-3\">\n            {shouldUseVirtualization ? (\n              <Zap className=\"w-4 h-4 text-blue-500\" />\n            ) : (\n              <Table className=\"w-4 h-4 text-blue-500\" />\n            )}\n            \n            <div className=\"text-sm\">\n              <div className=\"font-medium text-blue-800\">\n                {shouldUseVirtualization ? '   ' : '   '}\n              </div>\n              <div className=\"text-blue-600 text-xs mt-1\">\n                {performanceStats.itemCount.toLocaleString()}   \n                 : {performanceStats.estimatedMemoryMB}MB  \n                : {performanceStats.estimatedRenderTime}\n              </div>\n            </div>\n          </div>\n\n          {shouldUseVirtualization && purchases.length > 20 && (\n            <Button\n              onClick={scrollToTop}\n              className=\"button-base border border-blue-300 bg-white text-blue-600 hover:bg-blue-50\"\n            >\n              <ArrowUp className=\"w-4 h-4 mr-1\" />\n              \n            </Button>\n          )}\n        </div>\n      )}\n\n      {/*    */}\n      {shouldUseVirtualization ? (\n        <VirtualizedPurchaseTable\n          ref={virtualTableRef}\n          purchases={purchases}\n          activeTab={activeTab}\n          currentUserRoles={currentUserRoles}\n          onRefresh={onRefresh}\n          onOptimisticUpdate={onOptimisticUpdate}\n          onPaymentComplete={onPaymentComplete}\n          onReceiptComplete={onReceiptComplete}\n          height={virtualizedHeight}\n          itemHeight={64}\n          overscanCount={10}\n          className=\"border border-gray-200 rounded-lg overflow-hidden\"\n        />\n      ) : (\n        <LazyPurchaseTable\n          purchases={purchases}\n          activeTab={activeTab}\n          currentUserRoles={currentUserRoles}\n          onRefresh={onRefresh}\n          onOptimisticUpdate={onOptimisticUpdate}\n          onPaymentComplete={onPaymentComplete}\n          onReceiptComplete={onReceiptComplete}\n        />\n      )}\n\n      {/*   (  ) */}\n      {purchases.length > 1000 && !shouldUseVirtualization && (\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\n          <div className=\"flex items-start gap-3\">\n            <Zap className=\"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5\" />\n            <div className=\"text-sm\">\n              <div className=\"font-medium text-yellow-800 mb-1\">\n                  \n              </div>\n              <div className=\"text-yellow-700\">\n                {purchases.length.toLocaleString()}  . \n                            .\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/*     */}\n      {process.env.NODE_ENV === 'development' && (\n        <details className=\"text-xs text-gray-500\">\n          <summary className=\"cursor-pointer hover:text-gray-700\">\n              ( )\n          </summary>\n          <div className=\"mt-2 space-y-1 ml-4\">\n            <div>: {performanceStats.mode}</div>\n            <div> : {performanceStats.itemCount.toLocaleString()}</div>\n            <div> : {performanceStats.estimatedMemoryMB}MB</div>\n            <div>  : {performanceStats.estimatedRenderTime}</div>\n            <div> : {virtualizationThreshold.toLocaleString()}</div>\n            <div> : {activeTab}</div>\n          </div>\n        </details>\n      )}\n    </div>\n  );\n});\n\nAdaptiveTableWrapper.displayName = 'AdaptiveTableWrapper';\n\nexport default AdaptiveTableWrapper;","import { useState, useRef, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { \n  Sliders, \n  ArrowUpDown, \n  Search, \n  X, \n  Calendar,\n  Check,\n  User,\n  Building,\n  Package,\n  DollarSign,\n  CheckCircle\n} from 'lucide-react'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Calendar as CalendarComponent } from '@/components/ui/calendar'\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n} from '@/components/ui/command'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\n\n//   \ntype FilterCondition = 'contains' | 'equals' | 'starts_with' | 'ends_with' | 'is_empty' | 'is_not_empty' | 'greater_than' | 'less_than' | 'after' | 'before' | 'not_equals'\n\n//   \nexport interface FilterRule {\n  id: string\n  field: string\n  condition: FilterCondition\n  value: string | number | Date\n  label: string\n  dateField?: string // /    \n}\n\nexport interface SortRule {\n  field: string\n  direction: 'asc' | 'desc'\n  label: string\n}\n\ninterface FilterToolbarProps {\n  activeFilters: FilterRule[]\n  sortConfig: SortRule | null\n  searchTerm: string\n  onFiltersChange: (filters: FilterRule[]) => void\n  onSortChange: (sort: SortRule | null) => void\n  onSearchChange: (search: string) => void\n  availableEmployees?: string[]\n  availableVendors?: string[]\n  availableContacts?: string[]\n  availablePaymentSchedules?: string[]\n}\n\n//   \nconst FILTER_FIELDS = [\n  //  \n  { \n    key: 'date_range', \n    label: '', \n    type: 'date_range',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'date_month', \n    label: '', \n    type: 'date_month',\n    icon: Calendar,\n    category: ''\n  },\n  \n  // & \n  { \n    key: 'requester_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  { \n    key: 'vendor_name', \n    label: '', \n    type: 'searchable_select',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'contact_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'purchase_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'item_name', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'specification', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'remark', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'project_vendor', \n    label: 'PJ', \n    type: 'text',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'project_item', \n    label: 'PJ ITEM', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'sales_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'quantity', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'unit_price_value', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'total_amount', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'payment_category', \n    label: '', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '', '']\n  },\n  { \n    key: 'payment_schedule', \n    label: '', \n    type: 'select_with_empty',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'is_payment_completed', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_received', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_statement_received', \n    label: ' ', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_utk_checked', \n    label: 'UTK ', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '']\n  }\n]\n\n//   \nconst TEXT_CONDITIONS = [\n  { value: 'contains', label: '' },\n  { value: 'equals', label: '' },\n  { value: 'starts_with', label: '' },\n  { value: 'ends_with', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst NUMBER_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'greater_than', label: '' },\n  { value: 'less_than', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst DATE_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'after', label: '' },\n  { value: 'before', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst SELECT_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'not_equals', label: '' }\n]\n\n//    \nconst DATE_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'payment_completed_at', label: '' },\n  { value: 'received_at', label: '' },\n  { value: 'created_at', label: '' },\n  { value: 'statement_received_at', label: '' }\n]\n\n//   \nconst SORT_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'purchase_order_number', label: '' },\n  { value: 'vendor_name', label: '' },\n  { value: 'requester_name', label: '' },\n  { value: 'total_amount', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'created_at', label: '' }\n]\n\nexport default function FilterToolbar({\n  activeFilters,\n  sortConfig,\n  searchTerm,\n  onFiltersChange,\n  onSortChange,\n  onSearchChange,\n  availableEmployees = [],\n  availableVendors = [],\n  availableContacts = [],\n  availablePaymentSchedules = []\n}: FilterToolbarProps) {\n  const [isFilterOpen, setIsFilterOpen] = useState(false)\n  const [isSortOpen, setIsSortOpen] = useState(false)\n  const [isSearchExpanded, setIsSearchExpanded] = useState(false)\n  const [newFilter, setNewFilter] = useState<Partial<FilterRule>>({})\n  const [datePickerOpen, setDatePickerOpen] = useState(false)\n  const [monthPickerOpen, setMonthPickerOpen] = useState(false)\n  const [tempDateRange, setTempDateRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempMonth, setTempMonth] = useState<Date | undefined>()\n  const [tempMonthRange, setTempMonthRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempSort, setTempSort] = useState<{field?: string, direction?: 'asc' | 'desc'}>({})\n  const searchInputRef = useRef<HTMLInputElement>(null)\n\n  //    \n  useEffect(() => {\n    if (isSearchExpanded && searchInputRef.current) {\n      searchInputRef.current.focus()\n    }\n  }, [isSearchExpanded])\n\n  //       \n  useEffect(() => {\n    if (isSortOpen) {\n      setTempSort({\n        field: sortConfig?.field || '',\n        direction: sortConfig?.direction || 'asc'\n      })\n    }\n  }, [isSortOpen, sortConfig])\n\n  const handleAddFilter = (field: string) => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === field)\n    if (!fieldConfig) return\n\n    //      \n    let defaultCondition = 'contains'\n    if (fieldConfig.type === 'date_range' || fieldConfig.type === 'date_month') {\n      defaultCondition = 'equals'\n    }\n\n    setNewFilter({\n      id: `${field}_${Date.now()}`,\n      field,\n      condition: defaultCondition,\n      value: '',\n      label: fieldConfig.label\n    })\n  }\n\n  const handleApplyFilter = () => {\n    const isDateFilter = newFilter.field === 'date_range' || newFilter.field === 'date_month'\n    const requiresDateField = isDateFilter && !newFilter.dateField\n    \n    //      \n    let finalCondition = newFilter.condition\n    if (!finalCondition) {\n      if (isDateFilter) {\n        finalCondition = 'equals'\n      } else {\n        //   'contains',   'equals'\n        const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n        finalCondition = (fieldConfig?.type === 'select' || fieldConfig?.type === 'select_with_empty' || fieldConfig?.type === 'searchable_select') \n          ? 'equals' \n          : 'contains'\n      }\n    }\n    \n    if (newFilter.field && finalCondition !== undefined && newFilter.value !== '' && !requiresDateField) {\n      const filter: FilterRule = {\n        id: newFilter.id!,\n        field: newFilter.field,\n        condition: finalCondition,\n        value: newFilter.value,\n        label: newFilter.label!,\n        dateField: newFilter.dateField //    \n      }\n      onFiltersChange([...activeFilters, filter])\n      setNewFilter({})\n      setIsFilterOpen(false)\n    }\n  }\n\n  const handleRemoveFilter = (filterId: string) => {\n    onFiltersChange(activeFilters.filter(f => f.id !== filterId))\n  }\n\n  const handleClearAllFilters = () => {\n    onFiltersChange([])\n    setIsFilterOpen(false)\n  }\n\n  const handleSortFieldChange = (field: string) => {\n    setTempSort(prev => ({ ...prev, field }))\n  }\n\n  const handleSortDirectionChange = (direction: 'asc' | 'desc') => {\n    setTempSort(prev => ({ ...prev, direction }))\n  }\n\n  const handleApplySort = () => {\n    if (tempSort.field && tempSort.direction) {\n      const fieldConfig = SORT_FIELDS.find(f => f.value === tempSort.field)\n      if (fieldConfig) {\n        onSortChange({\n          field: tempSort.field,\n          direction: tempSort.direction,\n          label: fieldConfig.label\n        })\n      }\n    }\n    setIsSortOpen(false)\n    setTempSort({})\n  }\n\n  const handleClearSort = () => {\n    onSortChange(null)\n    setTempSort({})\n    setIsSortOpen(false)\n  }\n\n  const getConditionOptions = (fieldType: string) => {\n    switch (fieldType) {\n      case 'text':\n      case 'searchable_select':\n        return TEXT_CONDITIONS\n      case 'number':\n        return NUMBER_CONDITIONS\n      case 'date_range':\n      case 'date_month':\n        return DATE_CONDITIONS\n      case 'select':\n      case 'select_with_empty':\n        return SELECT_CONDITIONS\n      default:\n        return TEXT_CONDITIONS\n    }\n  }\n\n  const renderValueInput = () => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n    if (!fieldConfig) return null\n\n    switch (fieldConfig.type) {\n      case 'text':\n        return (\n          <Input\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n      \n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n\n      case 'searchable_select':\n        let options: string[] = []\n        let placeholder = \"\"\n        if (fieldConfig.key === 'requester_name') {\n          options = availableEmployees\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'vendor_name') {\n          options = availableVendors\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'contact_name') {\n          options = availableContacts\n          placeholder = \"\"\n        }\n\n        return (\n          <Popover>\n            <PopoverTrigger asChild>\n              <Button\n                variant=\"outline\"\n                role=\"combobox\"\n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between [&>svg]:hidden\"\n              >\n                <span className=\"truncate text-left\" style={{fontSize: '12px', fontWeight: '500'}}>\n                  {newFilter.value || placeholder}\n                </span>\n                <Search className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-[200px] p-0 border-0 shadow-lg\" align=\"start\">\n              <Command className=\"border-0\">\n                <CommandInput placeholder={`${placeholder} ...`} className=\"h-auto border-0 focus:ring-0 focus:outline-none card-description placeholder:card-description\" style={{padding: '2px 10px'}} />\n                <CommandEmpty>{placeholder}   .</CommandEmpty>\n                <CommandGroup className=\"max-h-[200px] overflow-y-auto\">\n                  {options.map(option => (\n                    <CommandItem\n                      key={option}\n                      value={option}\n                      onSelect={(value) => {\n                        setNewFilter(prev => ({ ...prev, value: value }));\n                      }}\n                      className=\"cursor-pointer\"\n                    >\n                      <Check\n                        className={`mr-2 h-3 w-3 ${\n                          newFilter.value === option ? \"opacity-100\" : \"opacity-0\"\n                        }`}\n                      />\n                      <span className=\"card-description\">{option}</span>\n                    </CommandItem>\n                  ))}\n                </CommandGroup>\n              </Command>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'select':\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {fieldConfig.options?.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'select_with_empty':\n        const scheduleOptions = ['', ...availablePaymentSchedules]\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {scheduleOptions.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'date_range':\n        return (\n          <Popover open={datePickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempDateRange({\n                    from: new Date(start),\n                    to: new Date(end)\n                  });\n                } else {\n                  setTempDateRange({\n                    from: new Date(newFilter.value),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempDateRange({});\n              }\n            }\n            setDatePickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5 min-h-[32px]\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        return `${format(new Date(start), 'yy/MM/dd')}\\n~ ${format(new Date(end), 'yy/MM/dd')}`;\n                      } else {\n                        return format(new Date(newFilter.value), 'yy/MM/dd');\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-2\">  </div>\n                  <CalendarComponent\n                    mode=\"range\"\n                    selected={tempDateRange}\n                    onSelect={(range) => {\n                      if (range) {\n                        setTempDateRange(range);\n                      }\n                    }}\n                    numberOfMonths={1}\n                    initialFocus\n                    className=\"compact-calendar\"\n                  />\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempDateRange({});\n                      setDatePickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempDateRange.from) {\n                        if (tempDateRange.to) {\n                          // ~ \n                          const rangeValue = `${format(tempDateRange.from, 'yyyy-MM-dd')}~${format(tempDateRange.to, 'yyyy-MM-dd')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  ( )\n                          setNewFilter(prev => ({ ...prev, value: format(tempDateRange.from, 'yyyy-MM-dd') }));\n                        }\n                        setDatePickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempDateRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'date_month':\n        return (\n          <Popover open={monthPickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempMonthRange({\n                    from: new Date(`${start}-01`),\n                    to: new Date(`${end}-01`)\n                  });\n                } else {\n                  setTempMonthRange({\n                    from: new Date(`${newFilter.value}-01`),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempMonthRange({});\n              }\n            }\n            setMonthPickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        const [startYear, startMonth] = start.split('-');\n                        const [endYear, endMonth] = end.split('-');\n                        return `${startYear.slice(-2)}/${startMonth}\\n~ ${endYear.slice(-2)}/${endMonth}`;\n                      } else {\n                        const [year, month] = newFilter.value.split('-');\n                        return `${year.slice(-2)}/${month}`;\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-3\"> </div>\n                  \n                  {/*   -  12  */}\n                  <div className=\"space-y-3\">\n                    <div>\n                      <div className=\"text-xs text-gray-500 mb-2\">  </div>\n                      {/*   */}\n                      <div className=\"mb-3\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear - 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                          <span className=\"text-sm font-medium text-gray-700\">\n                            {tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear()}\n                          </span>\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear + 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                        </div>\n                      </div>\n                      \n                      {/* 12  */}\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        {Array.from({ length: 12 }, (_, i) => {\n                          const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                          const monthDate = new Date(currentYear, i, 1);\n                          const isSelected = tempMonthRange.from && \n                            tempMonthRange.from.getFullYear() === currentYear && \n                            tempMonthRange.from.getMonth() === i;\n                          \n                          return (\n                            <Button\n                              key={i}\n                              onClick={() => {\n                                setTempMonthRange(prev => ({ ...prev, from: monthDate }));\n                              }}\n                              variant=\"outline\"\n                              className={`button-base text-xs h-8 ${\n                                isSelected \n                                  ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                  : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                              }`}\n                            >\n                              {i + 1}\n                            </Button>\n                          );\n                        })}\n                      </div>\n                    </div>\n                    \n                    {tempMonthRange.from && (\n                      <div>\n                        <div className=\"text-xs text-gray-500 mb-2\">   ()</div>\n                        {/*     */}\n                        <div className=\"mb-3\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear - 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                            <span className=\"text-sm font-medium text-gray-700\">\n                              {tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear()}\n                            </span>\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear + 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                          </div>\n                        </div>\n                        \n                        {/*   12  */}\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {Array.from({ length: 12 }, (_, i) => {\n                            const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                            const monthDate = new Date(currentYear, i, 1);\n                            const isSelected = tempMonthRange.to && \n                              tempMonthRange.to.getFullYear() === currentYear && \n                              tempMonthRange.to.getMonth() === i;\n                            const isDisabled = monthDate < tempMonthRange.from;\n                            \n                            return (\n                              <Button\n                                key={i}\n                                onClick={() => {\n                                  if (!isDisabled) {\n                                    setTempMonthRange(prev => ({ ...prev, to: monthDate }));\n                                  }\n                                }}\n                                variant=\"outline\"\n                                disabled={isDisabled}\n                                className={`button-base text-xs h-8 ${\n                                  isSelected \n                                    ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                    : isDisabled\n                                    ? 'border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed'\n                                    : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                                }`}\n                              >\n                                {i + 1}\n                              </Button>\n                            );\n                          })}\n                        </div>\n                        \n                        <div className=\"mt-3\">\n                          <Button\n                            onClick={() => {\n                              setTempMonthRange(prev => ({ ...prev, to: undefined }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50 text-xs\"\n                          >\n                              \n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempMonthRange({});\n                      setMonthPickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempMonthRange.from) {\n                        if (tempMonthRange.to) {\n                          //  \n                          const rangeValue = `${format(tempMonthRange.from, 'yyyy-MM')}~${format(tempMonthRange.to, 'yyyy-MM')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  \n                          setNewFilter(prev => ({ ...prev, value: format(tempMonthRange.from, 'yyyy-MM') }));\n                        }\n                        setMonthPickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempMonthRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"w-full space-y-3\">\n      {/*   */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          {/*   */}\n          <Popover open={isFilterOpen} onOpenChange={setIsFilterOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Sliders className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {activeFilters.length > 0 && (\n                  <Badge variant=\"secondary\" className=\"ml-1 badge-stats-primary\">\n                    {activeFilters.length}\n                  </Badge>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-64 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"card-title\"></h4>\n                  {activeFilters.length > 0 && (\n                    <Button\n                      variant=\"ghost\"\n                      onClick={handleClearAllFilters}\n                      className=\"button-base text-red-600 hover:text-red-700 hover:bg-red-50\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  )}\n                </div>\n\n                {/*    */}\n                {activeFilters.length > 0 && (\n                  <div className=\"space-y-2\">\n                    {activeFilters.map(filter => (\n                      <div key={filter.id} className=\"flex items-center justify-between p-2 bg-gray-50 business-radius\">\n                        <span className=\"card-description\">\n                          {filter.label}\n                          {filter.dateField && (\n                            <span className=\"text-blue-600\">\n                              ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                            </span>\n                          )}\n                          : {filter.value}\n                        </span>\n                        <Button\n                          variant=\"ghost\"\n                          onClick={() => handleRemoveFilter(filter.id)}\n                          className=\"button-base h-6 w-6 p-0 hover:bg-red-50\"\n                        >\n                          <X className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                    <div className=\"border-t border-gray-200 my-2\" />\n                  </div>\n                )}\n\n                {/*    */}\n                <div className=\"space-y-2\">\n                  <Select onValueChange={handleAddFilter}>\n                    <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n                      <SelectValue placeholder=\"+  \" />\n                    </SelectTrigger>\n                    <SelectContent \n                      className=\"w-64 max-h-80 overflow-y-auto\"\n                      style={{\n                        scrollbarWidth: 'auto',\n                        scrollbarColor: '#9ca3af #f3f4f6',\n                        WebkitScrollbarWidth: '8px'\n                      }}\n                    >\n                      {Object.entries(\n                        FILTER_FIELDS.reduce((acc, field) => {\n                          if (!acc[field.category]) acc[field.category] = []\n                          acc[field.category].push(field)\n                          return acc\n                        }, {} as Record<string, typeof FILTER_FIELDS>)\n                      ).map(([category, fields]) => (\n                        <div key={category}>\n                          <div className=\"px-2 py-1 card-description uppercase\">\n                            {category}\n                          </div>\n                          {fields.map(field => (\n                            <SelectItem key={field.key} value={field.key}>\n                              <div className=\"flex items-center gap-2\">\n                                <field.icon className=\"w-4 h-4\" />\n                                <span className=\"card-description\">{field.label}</span>\n                              </div>\n                            </SelectItem>\n                          ))}\n                        </div>\n                      ))}\n                    </SelectContent>\n                  </Select>\n\n                  {/*   UI */}\n                  {newFilter.field && (\n                    <div className=\"space-y-2 p-3 border business-radius bg-white\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"card-title\">{newFilter.label} </span>\n                      </div>\n                      \n                      {/*    */}\n                      {(newFilter.field === 'date_range' || newFilter.field === 'date_month') ? (\n                        <div className=\"grid grid-cols-2 gap-2\">\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            <Select \n                              value={newFilter.dateField || ''} \n                              onValueChange={(value) => setNewFilter(prev => ({ ...prev, dateField: value }))}\n                            >\n                              <SelectTrigger className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center justify-center\">\n                                <SelectValue placeholder=\" \" className=\"text-center\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                {DATE_FIELDS.map(dateField => (\n                                  <SelectItem key={dateField.value} value={dateField.value}>\n                                    <span className=\"card-description\">{dateField.label}</span>\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                          </div>\n\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            {renderValueInput()}\n                          </div>\n                        </div>\n                      ) : (\n                        /*    -       */\n                        <div>\n                          {renderValueInput()}\n                        </div>\n                      )}\n\n                      <div className=\"flex gap-2\">\n                        <Button\n                          onClick={handleApplyFilter}\n                          disabled={\n                            !newFilter.field || \n                            newFilter.value === '' ||\n                            ((newFilter.field === 'date_range' || newFilter.field === 'date_month') && !newFilter.dateField)\n                          }\n                          className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                        >\n                          \n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => setNewFilter({})}\n                          className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                        >\n                          \n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <Popover open={isSortOpen} onOpenChange={setIsSortOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <ArrowUpDown className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {sortConfig && (\n                  <span className=\"ml-1 card-description\">\n                    ({sortConfig.direction === 'asc' ? '' : ''})\n                  </span>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-56 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <h4 className=\"card-title\"> </h4>\n                \n                <div className=\"space-y-2\">\n                  {/*    */}\n                  <div>\n                    <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                    <Select \n                      value={tempSort.field || ''} \n                      onValueChange={handleSortFieldChange}\n                    >\n                      <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                        <SelectValue placeholder=\"\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {SORT_FIELDS.map(field => (\n                          <SelectItem key={field.value} value={field.value}>\n                            <span className=\"card-description\">{field.label}</span>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  {/*    */}\n                  {tempSort.field && (\n                    <div>\n                      <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                      <Select \n                        value={tempSort.direction || ''} \n                        onValueChange={handleSortDirectionChange}\n                      >\n                        <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                          <SelectValue placeholder=\"\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"asc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                          <SelectItem value=\"desc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n\n                  {/* /  */}\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button \n                      onClick={handleApplySort}\n                      disabled={!tempSort.field || !tempSort.direction}\n                      className=\"button-base bg-blue-500 hover:bg-blue-600 text-white flex-1\"\n                    >\n                      \n                    </Button>\n                    <Button \n                      onClick={handleClearSort}\n                      className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n                    >\n                      \n                    </Button>\n                  </div>\n                </div>\n\n                {sortConfig && (\n                  <div className=\"border-t pt-2\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => onSortChange(null)}\n                      className=\"button-base w-full border border-gray-300 text-gray-700\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <div className=\"flex items-center gap-2\">\n            {!isSearchExpanded ? (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsSearchExpanded(true)}\n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Search className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n              </Button>\n            ) : (\n              <div className=\"flex items-center gap-2\">\n                <Input\n                  ref={searchInputRef}\n                  placeholder=\" ...\"\n                  value={searchTerm}\n                  onChange={(e) => onSearchChange(e.target.value)}\n                  className=\"w-64 business-radius-input button-base border border-gray-300 bg-white text-gray-700\"\n                />\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => {\n                    setIsSearchExpanded(false)\n                    onSearchChange('')\n                  }}\n                  className=\"button-base h-8 w-8 p-0\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/*    */}\n          <Button\n            variant=\"outline\"\n            onClick={() => {\n              onSearchChange('')\n              onFiltersChange([])\n              onSortChange({\n                field: 'created_at',\n                direction: 'desc',\n                label: ''\n              })\n              setIsSearchExpanded(false)\n            }}\n            className=\"button-base border border-gray-300 bg-white text-blue-600 hover:bg-blue-50 hover:border-blue-300\"\n          >\n             <span className=\"button-text text-blue-600\"></span>\n          </Button>\n        </div>\n      </div>\n\n      {/*    */}\n      {activeFilters.length > 0 && (\n        <div className=\"flex flex-wrap gap-2\">\n          {activeFilters.map(filter => (\n            <Badge\n              key={filter.id}\n              variant=\"secondary\"\n              className=\"badge-base flex items-center gap-1 bg-blue-50 text-blue-700 border-blue-200\"\n            >\n              {filter.label}\n              {filter.dateField && (\n                <span className=\"text-blue-600\">\n                  ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                </span>\n              )}\n              : {filter.value}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handleRemoveFilter(filter.id)}\n                className=\"h-4 w-4 p-0 hover:bg-blue-100 ml-1\"\n              >\n                <X className=\"w-3 h-3\" />\n              </Button>\n            </Badge>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}","import { memo, useEffect, useState } from 'react';\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronDown, Loader2, AlertCircle } from \"lucide-react\";\nimport { ProgressiveLoadingState } from '@/hooks/useProgressiveLoading';\n\ninterface ProgressiveLoadingIndicatorProps {\n  state: ProgressiveLoadingState;\n  onLoadMore: () => Promise<void>;\n  isNearEnd?: boolean;\n  className?: string;\n  mode?: 'button' | 'auto' | 'both'; //  \n}\n\nconst ProgressiveLoadingIndicator = memo<ProgressiveLoadingIndicatorProps>(({\n  state,\n  onLoadMore,\n  isNearEnd = false,\n  className = \"\",\n  mode = 'both'\n}) => {\n  const [autoLoading, setAutoLoading] = useState(false);\n\n  //   \n  useEffect(() => {\n    if (mode !== 'button' && isNearEnd && state.hasMore && !state.isLoading && !autoLoading) {\n      setAutoLoading(true);\n      onLoadMore().finally(() => {\n        setAutoLoading(false);\n      });\n    }\n  }, [isNearEnd, state.hasMore, state.isLoading, autoLoading, onLoadMore, mode]);\n\n  const getProgressPercentage = (): number => {\n    if (state.totalCount === 0) return 0;\n    return Math.min(100, Math.round((state.loadedCount / state.totalCount) * 100));\n  };\n\n  const getLoadingMessage = (): string => {\n    if (state.isLoading) {\n      return `  ... (${state.loadedCount}/${state.totalCount})`;\n    }\n    \n    if (!state.hasMore) {\n      return `    (${state.totalCount})`;\n    }\n\n    const remaining = state.totalCount - state.loadedCount;\n    return `${remaining.toLocaleString()}  `;\n  };\n\n  const getBatchInfo = (): string => {\n    const nextBatchSize = Math.min(state.batchSize, state.totalCount - state.loadedCount);\n    return nextBatchSize > 0 ? `(: ${nextBatchSize})` : '';\n  };\n\n  //      \n  if (!state.hasMore && !state.isLoading && !state.error) {\n    return null;\n  }\n\n  return (\n    <div className={`flex flex-col items-center gap-3 py-6 ${className}`} ref={undefined}>\n      {/*   */}\n      <div className=\"w-full max-w-md\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <span className=\"card-description\">\n            {state.loadedCount.toLocaleString()} / {state.totalCount.toLocaleString()}\n          </span>\n          <span className=\"card-description\">\n            {getProgressPercentage()}%\n          </span>\n        </div>\n        \n        {/*   */}\n        <div className=\"w-full bg-gray-200 rounded-full h-2\">\n          <div \n            className=\"bg-hansl-500 h-2 rounded-full transition-all duration-300\"\n            style={{ width: `${getProgressPercentage()}%` }}\n          />\n        </div>\n      </div>\n\n      {/*   */}\n      {state.error && (\n        <div className=\"flex items-center gap-2 text-red-600\">\n          <AlertCircle className=\"w-4 h-4\" />\n          <span className=\"card-description\">{state.error}</span>\n        </div>\n      )}\n\n      {/*      */}\n      {state.isLoading ? (\n        <div className=\"flex items-center gap-3\">\n          <Loader2 className=\"w-5 h-5 animate-spin text-hansl-500\" />\n          <div className=\"text-center\">\n            <div className=\"card-subtitle\">{getLoadingMessage()}</div>\n            <div className=\"card-description\">\n               {state.currentBatch}  ...\n            </div>\n          </div>\n        </div>\n      ) : state.hasMore && (mode === 'button' || mode === 'both') ? (\n        <div className=\"flex flex-col items-center gap-2\">\n          <Button\n            onClick={onLoadMore}\n            className=\"button-base border border-hansl-200 bg-white text-hansl-600 hover:bg-hansl-50 hover:border-hansl-300\"\n            disabled={state.isLoading}\n          >\n            <ChevronDown className=\"w-4 h-4 mr-2\" />\n            {getLoadingMessage()}\n            <span className=\"ml-2 card-description\">\n              {getBatchInfo()}\n            </span>\n          </Button>\n          \n          {mode === 'both' && (\n            <div className=\"card-description text-center\">\n                 \n            </div>\n          )}\n        </div>\n      ) : null}\n\n      {/*    */}\n      {mode !== 'button' && state.hasMore && (\n        <div className=\"card-description text-center\">\n          {isNearEnd ? '  ...' : '  '}\n        </div>\n      )}\n\n      {/*   */}\n      {!state.hasMore && !state.isLoading && (\n        <div className=\"text-center\">\n          <div className=\"card-subtitle text-green-600\">\n                \n          </div>\n          <div className=\"card-description\">\n             {state.totalCount.toLocaleString()}  {state.currentBatch}  \n          </div>\n        </div>\n      )}\n    </div>\n  );\n});\n\nProgressiveLoadingIndicator.displayName = 'ProgressiveLoadingIndicator';\n\nexport default ProgressiveLoadingIndicator;","import { memo, useState } from 'react';\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronDown, Calendar, RotateCcw, Zap } from \"lucide-react\";\nimport { DateLimitOption } from '@/hooks/useDateLimit';\nimport ProgressiveLoadingIndicator from './ProgressiveLoadingIndicator';\nimport { ProgressiveLoadingState } from '@/hooks/useProgressiveLoading';\n\ninterface LoadMoreButtonProps {\n  currentLimit: DateLimitOption;\n  nextLimit: DateLimitOption | null;\n  totalCount: number;\n  displayedCount: number;\n  hasNextLimit: boolean;\n  isFullyLoaded: boolean;\n  onLoadMore: (nextLimit: DateLimitOption) => void;\n  onReset?: () => void;\n  className?: string;\n  \n  //    ()\n  progressiveState?: ProgressiveLoadingState;\n  onProgressiveLoadMore?: () => Promise<void>;\n  enableProgressive?: boolean;\n  isNearEnd?: boolean;\n}\n\nconst LoadMoreButton = memo<LoadMoreButtonProps>(({\n  currentLimit,\n  nextLimit,\n  totalCount,\n  displayedCount,\n  hasNextLimit,\n  isFullyLoaded,\n  onLoadMore,\n  onReset,\n  className = \"\",\n  \n  //   \n  progressiveState,\n  onProgressiveLoadMore,\n  enableProgressive = false,\n  isNearEnd = false\n}) => {\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleLoadMore = async () => {\n    if (!nextLimit || isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      onLoadMore(nextLimit);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleReset = async () => {\n    if (!onReset || isLoading) return;\n    \n    setIsLoading(true);\n    try {\n      onReset();\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  //      ()\n  const getEstimatedAdditionalCount = (): string => {\n    if (isFullyLoaded) return '';\n    \n    if (displayedCount === totalCount) {\n      return '  ';\n    }\n    \n    const remaining = Math.max(0, totalCount - displayedCount);\n    return `+${remaining.toLocaleString()}+`;\n  };\n\n  //       \n  if (enableProgressive && progressiveState && onProgressiveLoadMore) {\n    return (\n      <div className={className}>\n        <ProgressiveLoadingIndicator\n          state={progressiveState}\n          onLoadMore={onProgressiveLoadMore}\n          isNearEnd={isNearEnd}\n          mode=\"both\"\n        />\n      </div>\n    );\n  }\n\n  return (\n    <div className={`flex flex-col items-center gap-3 py-6 ${className}`}>\n      {/*     */}\n      <div className=\"text-center\">\n        <div className=\"flex items-center justify-center gap-2 mb-2\">\n          <Calendar className=\"w-4 h-4 text-gray-400\" />\n          <span className=\"card-subtitle\">\n            {isFullyLoaded \n              ? ` ${totalCount.toLocaleString()} `\n              : `${currentLimit.label} (${displayedCount.toLocaleString()})`\n            }\n          </span>\n          \n          {/*     */}\n          {isFullyLoaded && totalCount > 100 && (\n            <div className=\"flex items-center gap-1 ml-2\">\n              <Zap className=\"w-3 h-3 text-hansl-500\" />\n              <span className=\"card-description text-hansl-600\"> </span>\n            </div>\n          )}\n        </div>\n        \n        {/*    */}\n        {!isFullyLoaded && (\n          <div className=\"card-description\">\n            {displayedCount < totalCount && (\n              <span> {totalCount.toLocaleString()}   </span>\n            )}\n            {displayedCount === totalCount && hasNextLimit && (\n              <span>     </span>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/*  */}\n      <div className=\"flex items-center gap-2\">\n        {/*   */}\n        {hasNextLimit && !isFullyLoaded && (\n          <Button\n            onClick={handleLoadMore}\n            disabled={isLoading}\n            className=\"button-base border border-hansl-200 bg-white text-hansl-600 hover:bg-hansl-50 hover:border-hansl-300\"\n          >\n            {isLoading ? (\n              <div className=\"w-4 h-4 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin mr-2\" />\n            ) : (\n              <ChevronDown className=\"w-4 h-4 mr-2\" />\n            )}\n            {nextLimit?.label} \n            {hasNextLimit && (\n              <span className=\"ml-2 card-description\">\n                {getEstimatedAdditionalCount()}\n              </span>\n            )}\n          </Button>\n        )}\n\n        {/*   (30   ) */}\n        {!isLoading && currentLimit.key !== '30d' && onReset && (\n          <Button\n            onClick={handleReset}\n            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n          >\n            <RotateCcw className=\"w-4 h-4 mr-2\" />\n            30 \n          </Button>\n        )}\n      </div>\n\n      {/*     */}\n      {isLoading && (\n        <div className=\"text-center\">\n          <div className=\"card-description\">  ...</div>\n        </div>\n      )}\n    </div>\n  );\n});\n\nLoadMoreButton.displayName = 'LoadMoreButton';\n\nexport default LoadMoreButton;","import { useState, useCallback, useRef, useEffect } from 'react';\nimport { Purchase } from './usePurchaseData';\nimport { logger } from '@/lib/logger';\n\nexport interface ProgressiveLoadingState {\n  isLoading: boolean;\n  hasMore: boolean;\n  loadedCount: number;\n  totalCount: number;\n  error: string | null;\n  batchSize: number;\n  currentBatch: number;\n}\n\nexport interface UseProgressiveLoadingOptions {\n  initialBatchSize?: number;\n  maxBatchSize?: number;\n  prefetchThreshold?: number; //      (0.8 = 80% )\n  enablePrefetch?: boolean;\n}\n\nexport interface UseProgressiveLoadingResult {\n  state: ProgressiveLoadingState;\n  loadedData: Purchase[];\n  loadMore: () => Promise<void>;\n  reset: () => void;\n  setData: (data: Purchase[]) => void;\n  isNearEnd: boolean;\n  loadingRef: React.RefObject<HTMLDivElement>;\n}\n\nexport const useProgressiveLoading = (\n  sourceData: Purchase[],\n  options: UseProgressiveLoadingOptions = {}\n): UseProgressiveLoadingResult => {\n  const {\n    initialBatchSize = 50,\n    maxBatchSize = 200,\n    prefetchThreshold = 0.8,\n    enablePrefetch = true\n  } = options;\n\n  //  \n  const [state, setState] = useState<ProgressiveLoadingState>({\n    isLoading: false,\n    hasMore: true,\n    loadedCount: 0,\n    totalCount: sourceData.length,\n    error: null,\n    batchSize: initialBatchSize,\n    currentBatch: 0\n  });\n\n  const [loadedData, setLoadedData] = useState<Purchase[]>([]);\n  const [isNearEnd, setIsNearEnd] = useState(false);\n  \n  //    ref\n  const loadingRef = useRef<HTMLDivElement>(null);\n  const prefetchingRef = useRef<boolean>(false);\n\n  //      \n  useEffect(() => {\n    setState(prev => ({\n      ...prev,\n      totalCount: sourceData.length,\n      hasMore: prev.loadedCount < sourceData.length\n    }));\n  }, [sourceData.length, state.loadedCount]);\n\n  //   \n  useEffect(() => {\n    if (sourceData.length > 0 && loadedData.length === 0) {\n      loadInitialBatch();\n    }\n  }, [sourceData]);\n\n  //   \n  const loadInitialBatch = useCallback(() => {\n    const initialData = sourceData.slice(0, initialBatchSize);\n    setLoadedData(initialData);\n    setState(prev => ({\n      ...prev,\n      loadedCount: initialData.length,\n      hasMore: initialData.length < sourceData.length,\n      currentBatch: 1,\n      isLoading: false,\n      error: null\n    }));\n  }, [sourceData, initialBatchSize]);\n\n  //    \n  const loadMore = useCallback(async (): Promise<void> => {\n    if (state.isLoading || !state.hasMore || sourceData.length === 0) {\n      return;\n    }\n\n    setState(prev => ({ ...prev, isLoading: true, error: null }));\n\n    try {\n      //    ( API  )\n      await new Promise(resolve => setTimeout(resolve, 300));\n\n      const nextBatch = state.currentBatch;\n      const startIndex = state.loadedCount;\n      const endIndex = Math.min(startIndex + state.batchSize, sourceData.length);\n      \n      const newData = sourceData.slice(startIndex, endIndex);\n      \n      if (newData.length > 0) {\n        setLoadedData(prev => [...prev, ...newData]);\n        setState(prev => ({\n          ...prev,\n          loadedCount: prev.loadedCount + newData.length,\n          hasMore: prev.loadedCount + newData.length < sourceData.length,\n          currentBatch: prev.currentBatch + 1,\n          isLoading: false,\n          //    -   \n          batchSize: Math.min(prev.batchSize * 1.2, maxBatchSize)\n        }));\n\n        logger.debug(` : ${newData.length}   `, {\n          total: startIndex + newData.length,\n          batch: nextBatch + 1\n        });\n      } else {\n        setState(prev => ({ ...prev, hasMore: false, isLoading: false }));\n      }\n    } catch (error) {\n      logger.error('  ', error);\n      setState(prev => ({\n        ...prev,\n        isLoading: false,\n        error: '    .'\n      }));\n    }\n  }, [state, sourceData, maxBatchSize]);\n\n  //  \n  const prefetchNext = useCallback(async () => {\n    if (prefetchingRef.current || !enablePrefetch || !state.hasMore || state.isLoading) {\n      return;\n    }\n\n    prefetchingRef.current = true;\n\n    try {\n      //     \n      const nextStartIndex = state.loadedCount;\n      const nextEndIndex = Math.min(nextStartIndex + state.batchSize, sourceData.length);\n      \n      if (nextStartIndex < sourceData.length) {\n        //      (: API )\n        //    \n        logger.debug('  ', {\n          nextBatch: state.currentBatch + 1,\n          range: [nextStartIndex, nextEndIndex]\n        });\n      }\n    } catch (error) {\n      logger.error(' ', error);\n    } finally {\n      prefetchingRef.current = false;\n    }\n  }, [state, sourceData, enablePrefetch]);\n\n  //   \n  useEffect(() => {\n    if (!enablePrefetch || !loadingRef.current) return;\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const entry = entries[0];\n        const isVisible = entry.isIntersecting;\n        const intersectionRatio = entry.intersectionRatio;\n\n        setIsNearEnd(isVisible || intersectionRatio > prefetchThreshold);\n\n        //    \n        if (isVisible && state.hasMore) {\n          prefetchNext();\n        }\n      },\n      {\n        threshold: [0, prefetchThreshold, 1],\n        rootMargin: '100px' // 100px   \n      }\n    );\n\n    observer.observe(loadingRef.current);\n\n    return () => observer.disconnect();\n  }, [enablePrefetch, prefetchThreshold, state.hasMore, prefetchNext]);\n\n  //  \n  const reset = useCallback(() => {\n    setLoadedData([]);\n    setState({\n      isLoading: false,\n      hasMore: true,\n      loadedCount: 0,\n      totalCount: sourceData.length,\n      error: null,\n      batchSize: initialBatchSize,\n      currentBatch: 0\n    });\n    setIsNearEnd(false);\n    prefetchingRef.current = false;\n  }, [sourceData.length, initialBatchSize]);\n\n  //    (   )\n  const setData = useCallback((data: Purchase[]) => {\n    setLoadedData(data);\n    setState(prev => ({\n      ...prev,\n      loadedCount: data.length,\n      totalCount: data.length,\n      hasMore: false, //       \n      currentBatch: 1,\n      isLoading: false,\n      error: null\n    }));\n  }, []);\n\n  return {\n    state,\n    loadedData,\n    loadMore,\n    reset,\n    setData,\n    isNearEnd,\n    loadingRef\n  };\n};","import { useState, useCallback, useMemo } from 'react';\nimport { Purchase } from './usePurchaseData';\nimport { FilterRule } from '@/components/purchase/FilterToolbar';\n\nexport interface SmartFilterLimitConfig {\n  maxResults: number;\n  warningThreshold: number; //    \n  enableAutoLimit: boolean;\n}\n\nexport interface SmartFilterLimitResult {\n  limitedData: Purchase[];\n  totalCount: number;\n  displayedCount: number;\n  isLimited: boolean;\n  isOverThreshold: boolean;\n  limitConfig: SmartFilterLimitConfig;\n  setLimitConfig: (config: Partial<SmartFilterLimitConfig>) => void;\n  getLimitMessage: () => string;\n  getWarningMessage: () => string | null;\n  shouldShowWarning: boolean;\n  resetLimit: () => void;\n}\n\nconst DEFAULT_CONFIG: SmartFilterLimitConfig = {\n  maxResults: 500,\n  warningThreshold: 300,\n  enableAutoLimit: true\n};\n\nexport const useSmartFilterLimit = (\n  sourceData: Purchase[],\n  hasActiveFilters: boolean,\n  activeFilters: FilterRule[] = [],\n  searchTerm: string = ''\n): SmartFilterLimitResult => {\n  \n  const [limitConfig, setLimitConfigState] = useState<SmartFilterLimitConfig>(DEFAULT_CONFIG);\n\n  //     \n  const shouldApplyLimit = useMemo(() => {\n    return limitConfig.enableAutoLimit && hasActiveFilters && (\n      activeFilters.length > 0 || \n      searchTerm.trim().length > 0\n    );\n  }, [limitConfig.enableAutoLimit, hasActiveFilters, activeFilters.length, searchTerm]);\n\n  //   \n  const limitedData = useMemo(() => {\n    if (!shouldApplyLimit) {\n      return sourceData;\n    }\n\n    if (sourceData.length <= limitConfig.maxResults) {\n      return sourceData;\n    }\n\n    //     \n    return sourceData.slice(0, limitConfig.maxResults);\n  }, [sourceData, shouldApplyLimit, limitConfig.maxResults]);\n\n  //  \n  const totalCount = sourceData.length;\n  const displayedCount = limitedData.length;\n  const isLimited = shouldApplyLimit && totalCount > limitConfig.maxResults;\n  const isOverThreshold = totalCount > limitConfig.warningThreshold;\n  const shouldShowWarning = shouldApplyLimit && isOverThreshold;\n\n  //   \n  const getLimitMessage = useCallback((): string => {\n    if (!isLimited) {\n      return `${totalCount.toLocaleString()} `;\n    }\n\n    const hiddenCount = totalCount - displayedCount;\n    return `${displayedCount.toLocaleString()}  (${hiddenCount.toLocaleString()} )`;\n  }, [isLimited, totalCount, displayedCount]);\n\n  //   \n  const getWarningMessage = useCallback((): string | null => {\n    if (!shouldShowWarning) {\n      return null;\n    }\n\n    if (isLimited) {\n      const hiddenCount = totalCount - displayedCount;\n      return `  .    ${displayedCount.toLocaleString()} . ${hiddenCount.toLocaleString()}  .`;\n    }\n\n    if (totalCount > limitConfig.warningThreshold && totalCount <= limitConfig.maxResults) {\n      return `  ${totalCount.toLocaleString()}.        .`;\n    }\n\n    return null;\n  }, [shouldShowWarning, isLimited, totalCount, displayedCount, limitConfig.warningThreshold, limitConfig.maxResults]);\n\n  //  \n  const setLimitConfig = useCallback((newConfig: Partial<SmartFilterLimitConfig>) => {\n    setLimitConfigState(prev => ({ ...prev, ...newConfig }));\n  }, []);\n\n  //  \n  const resetLimit = useCallback(() => {\n    setLimitConfigState(DEFAULT_CONFIG);\n  }, []);\n\n  return {\n    limitedData,\n    totalCount,\n    displayedCount,\n    isLimited,\n    isOverThreshold,\n    limitConfig,\n    setLimitConfig,\n    getLimitMessage,\n    getWarningMessage,\n    shouldShowWarning,\n    resetLimit\n  };\n};\n\n//     \nexport const hasActiveFiltersDetected = (\n  activeFilters: FilterRule[],\n  searchTerm: string,\n  selectedEmployee?: string\n): boolean => {\n  return (\n    activeFilters.length > 0 ||\n    searchTerm.trim().length > 0 ||\n    (selectedEmployee && selectedEmployee !== 'all' && selectedEmployee !== '')\n  );\n};","import { memo, useState } from 'react';\nimport { AlertTriangle, Settings, X, Eye, EyeOff } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { SmartFilterLimitResult } from '@/hooks/useSmartFilterLimit';\n\ninterface SmartFilterWarningProps {\n  smartFilter: SmartFilterLimitResult;\n  className?: string;\n  onConfigChange?: () => void;\n}\n\nconst SmartFilterWarning = memo<SmartFilterWarningProps>(({\n  smartFilter,\n  className = \"\",\n  onConfigChange\n}) => {\n  const [isDismissed, setIsDismissed] = useState(false);\n  const [showDetails, setShowDetails] = useState(false);\n\n  const warningMessage = smartFilter.getWarningMessage();\n\n  //      \n  if (!warningMessage || isDismissed) {\n    return null;\n  }\n\n  const getWarningLevel = (): 'info' | 'warning' | 'error' => {\n    if (smartFilter.isLimited) return 'error';\n    if (smartFilter.isOverThreshold) return 'warning';\n    return 'info';\n  };\n\n  const getWarningStyles = () => {\n    const level = getWarningLevel();\n    switch (level) {\n      case 'error':\n        return {\n          containerClass: 'bg-red-50 border-red-200',\n          iconClass: 'text-red-500',\n          textClass: 'text-red-800',\n          badgeClass: 'badge-danger'\n        };\n      case 'warning':\n        return {\n          containerClass: 'bg-yellow-50 border-yellow-200',\n          iconClass: 'text-yellow-500',\n          textClass: 'text-yellow-800',\n          badgeClass: 'badge-warning'\n        };\n      default:\n        return {\n          containerClass: 'bg-blue-50 border-blue-200',\n          iconClass: 'text-blue-500',\n          textClass: 'text-blue-800',\n          badgeClass: 'badge-primary'\n        };\n    }\n  };\n\n  const styles = getWarningStyles();\n\n  return (\n    <div className={`rounded-lg border p-4 ${styles.containerClass} ${className}`}>\n      <div className=\"flex items-start gap-3\">\n        {/*   */}\n        <AlertTriangle className={`w-5 h-5 flex-shrink-0 mt-0.5 ${styles.iconClass}`} />\n        \n        {/*   */}\n        <div className=\"flex-1 min-w-0\">\n          <div className={`text-sm font-medium ${styles.textClass} mb-2`}>\n              \n          </div>\n          \n          <div className={`text-sm ${styles.textClass} mb-3`}>\n            {warningMessage}\n          </div>\n          \n          {/*   */}\n          <div className=\"flex items-center gap-3 mb-3\">\n            <Badge className={styles.badgeClass}>\n              {smartFilter.getLimitMessage()}\n            </Badge>\n            \n            {smartFilter.isLimited && (\n              <Badge className=\"badge-secondary\">\n                 : {smartFilter.limitConfig.maxResults.toLocaleString()}\n              </Badge>\n            )}\n          </div>\n\n          {/*    */}\n          <div className=\"mb-3\">\n            <button\n              onClick={() => setShowDetails(!showDetails)}\n              className={`inline-flex items-center gap-2 text-xs ${styles.textClass} hover:underline`}\n            >\n              {showDetails ? <EyeOff className=\"w-3 h-3\" /> : <Eye className=\"w-3 h-3\" />}\n              {showDetails ? '  ' : '  '}\n            </button>\n          </div>\n\n          {/*   */}\n          {showDetails && (\n            <div className={`text-xs ${styles.textClass} bg-white/50 rounded p-3 mb-3 space-y-2`}>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <span className=\"font-medium\">  :</span>\n                  <span className=\"ml-2\">{smartFilter.totalCount.toLocaleString()}</span>\n                </div>\n                <div>\n                  <span className=\"font-medium\"> :</span>\n                  <span className=\"ml-2\">{smartFilter.displayedCount.toLocaleString()}</span>\n                </div>\n                <div>\n                  <span className=\"font-medium\"> :</span>\n                  <span className=\"ml-2\">{smartFilter.limitConfig.maxResults.toLocaleString()}</span>\n                </div>\n                <div>\n                  <span className=\"font-medium\"> :</span>\n                  <span className=\"ml-2\">{smartFilter.limitConfig.warningThreshold.toLocaleString()}</span>\n                </div>\n              </div>\n              \n              <div className=\"pt-2 border-t border-white/20\">\n                <span className=\"font-medium\"> :</span>\n                <ul className=\"mt-1 space-y-1 list-disc list-inside ml-2\">\n                  <li>   </li>\n                  <li>  </li>\n                  <li>    </li>\n                  {smartFilter.isLimited && (\n                    <li>      </li>\n                  )}\n                </ul>\n              </div>\n            </div>\n          )}\n\n          {/*   */}\n          <div className=\"flex items-center gap-2\">\n            {onConfigChange && (\n              <Button\n                onClick={onConfigChange}\n                size=\"sm\"\n                className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n              >\n                <Settings className=\"w-4 h-4 mr-2\" />\n                \n              </Button>\n            )}\n            \n            {smartFilter.isLimited && (\n              <Button\n                onClick={() => smartFilter.setLimitConfig({ enableAutoLimit: false })}\n                size=\"sm\"\n                className={`button-base border ${styles.iconClass.includes('red') ? 'border-red-300 text-red-600 hover:bg-red-50' : 'border-yellow-300 text-yellow-600 hover:bg-yellow-50'}`}\n              >\n                 \n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/*   */}\n        <button\n          onClick={() => setIsDismissed(true)}\n          className={`p-1 hover:bg-white/20 rounded transition-colors ${styles.iconClass}`}\n          aria-label=\" \"\n        >\n          <X className=\"w-4 h-4\" />\n        </button>\n      </div>\n    </div>\n  );\n});\n\nSmartFilterWarning.displayName = 'SmartFilterWarning';\n\nexport default SmartFilterWarning;","\nimport { useState, lazy, Suspense, useEffect, useCallback, useMemo, useRef } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { usePurchaseData } from \"@/hooks/usePurchaseData\";\nimport { useFastPurchaseFilters } from \"@/hooks/useFastPurchaseFilters\";\nimport AdaptiveTableWrapper from \"@/components/purchase/AdaptiveTableWrapper\";\nimport FilterToolbar, { FilterRule, SortRule } from \"@/components/purchase/FilterToolbar\";\nimport LoadMoreButton from \"@/components/purchase/LoadMoreButton\";\nimport { DateLimitOption, DATE_LIMIT_OPTIONS } from '@/hooks/useDateLimit';\nimport { useProgressiveLoading } from '@/hooks/useProgressiveLoading';\nimport { useSmartFilterLimit, hasActiveFiltersDetected } from '@/hooks/useSmartFilterLimit';\nimport SmartFilterWarning from '@/components/purchase/SmartFilterWarning';\n\nimport { Plus, Package } from \"lucide-react\";\nimport { generatePurchaseOrderExcelJS, PurchaseOrderData } from \"@/utils/exceljs/generatePurchaseOrderExcel\";\n\n// Lazy load modal for better performance\nconst PurchaseItemsModal = lazy(() => import(\"@/components/purchase/PurchaseItemsModal\"));\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent } from \"@/components/ui/card\";\n// Tabs     (hanslwebapp )\nimport { Button } from \"@/components/ui/button\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { Purchase } from \"@/hooks/usePurchaseData\";\nimport { logger } from \"@/lib/logger\";\n\ninterface PurchaseListMainProps {\n  //      \n  onEmailToggle?: () => void;\n  showEmailButton?: boolean;\n}\n\n//   () \nconst NAV_TABS: { key: string; label: string }[] = [\n  { key: 'pending', label: '' },\n  { key: 'purchase', label: ' ' },\n  { key: 'receipt', label: ' ' },\n  { key: 'done', label: ' ' },\n];\n\n//    \nexport default function PurchaseListMain({ showEmailButton = true }: PurchaseListMainProps) {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const supabase = createClient();\n  const [selectedPurchase, setSelectedPurchase] = useState<Purchase | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  \n  //    \n  const [activeFilters, setActiveFilters] = useState<FilterRule[]>([]);\n  const [sortConfig, setSortConfig] = useState<SortRule | null>({\n    field: 'created_at',\n    direction: 'desc',\n    label: ''\n  });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [availableEmployees, setAvailableEmployees] = useState<string[]>([]);\n  const [availableVendors, setAvailableVendors] = useState<string[]>([]);\n  const [availableContacts, setAvailableContacts] = useState<string[]>([]);\n  const [availablePaymentSchedules, setAvailablePaymentSchedules] = useState<string[]>([]);\n  \n  //     \n  const {\n    purchases,\n    loading,\n    currentUserRoles,\n    currentUserName,\n    currentUserEmail,\n    currentUserId,\n    refreshPurchases: loadPurchases,\n    updatePurchaseOptimistic\n  } = usePurchaseData();\n  \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  \n\n  //    \n  const {\n    activeTab,\n    selectedEmployee,\n    setActiveTab,\n    setSelectedEmployee,\n    filteredPurchases,\n    tabCounts,\n    dateLimit,\n    totalDataCount,\n    displayedDataCount\n  } = useFastPurchaseFilters(purchases, currentUserRoles, currentUserName, currentUserId, currentUserEmail);\n  \n  // URL    \n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const tab = searchParams.get('tab');\n    if (tab === 'purchase') {\n      setActiveTab('purchase');\n    }\n  }, [location.search, setActiveTab]);\n\n  //    \n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        //   (employees )\n        const { data: employees } = await supabase\n          .from('employees')\n          .select('name');\n        \n        if (employees) {\n          const employeeNames = [...new Set(employees.map((e: any) => e.name).filter(Boolean))];\n          setAvailableEmployees(employeeNames as string[]);\n        }\n\n        //   (vendors )\n        const { data: vendors } = await supabase\n          .from('vendors')\n          .select('vendor_name');\n        \n        if (vendors) {\n          const vendorNames = [...new Set(vendors.map((v: any) => v.vendor_name).filter(Boolean))];\n          setAvailableVendors(vendorNames as string[]);\n        }\n\n        //   (vendor_contacts )\n        const { data: contacts } = await supabase\n          .from('vendor_contacts')\n          .select('contact_name');\n        \n        if (contacts) {\n          const contactNames = [...new Set(contacts.map((c: any) => c.contact_name).filter(Boolean))];\n          setAvailableContacts(contactNames as string[]);\n        }\n\n        //   (vendors  vendor_payment_schedule)\n        const { data: schedules } = await supabase\n          .from('vendors')\n          .select('vendor_payment_schedule');\n        \n        if (schedules) {\n          const scheduleNames = [...new Set(schedules.map((s: any) => s.vendor_payment_schedule).filter(Boolean))];\n          setAvailablePaymentSchedules(scheduleNames as string[]);\n        }\n      } catch (error) {\n        logger.error('    ', error);\n      }\n    };\n\n    loadFilterOptions();\n  }, [supabase]);\n  \n  //       \n  const hasInitializedTabRefresh = useRef(false);\n  useEffect(() => {\n    if (!hasInitializedTabRefresh.current) {\n      hasInitializedTabRefresh.current = true;\n      return;\n    }\n\n    const refreshLatestData = async () => {\n      try {\n        await loadPurchases(true, { silent: true });\n      } catch (error) {\n        logger.error('      ', error);\n      }\n    };\n\n    refreshLatestData();\n  }, [activeTab, loadPurchases]);\n\n\n  //     -  \n  const getStatusBadge = useCallback((purchase: Purchase) => {\n    if (purchase.is_received) {\n      return <Badge variant={null} className=\"badge-success\"></Badge>;\n    } else if (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved') {\n      return <Badge variant={null} className=\"badge-primary\"></Badge>;\n    } else if (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected') {\n      return <Badge variant={null} className=\"badge-danger\"></Badge>;\n    } else {\n      return <Badge variant={null} className=\"badge-warning\"></Badge>;\n    }\n  }, []);\n\n  //   \n  const getReceiptProgress = (purchase: Purchase) => {\n    if (!purchase.items || purchase.items.length === 0) return { received: 0, total: 0, percentage: 0 };\n    \n    const total = purchase.items.length;\n    const received = purchase.items.filter(item => \n      item.actual_received_date !== null && item.actual_received_date !== undefined\n    ).length;\n    const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n    \n    return { received, total, percentage };\n  };\n\n  //   \n  const isAdvancePayment = (progress_type?: string) => {\n    return progress_type === '' || progress_type?.trim() === '' || progress_type?.includes('');\n  };\n\n  //   \n  const applyAdvancedFilters = useCallback((purchases: Purchase[]) => {\n    let filtered = [...purchases];\n\n    //  \n    if (searchTerm.trim()) {\n      const searchLower = searchTerm.toLowerCase().trim();\n      filtered = filtered.filter(purchase => \n        purchase.purchase_order_number?.toLowerCase().includes(searchLower) ||\n        purchase.vendor_name?.toLowerCase().includes(searchLower) ||\n        purchase.requester_name?.toLowerCase().includes(searchLower) ||\n        purchase.item_name?.toLowerCase().includes(searchLower) ||\n        purchase.specification?.toLowerCase().includes(searchLower) ||\n        purchase.remark?.toLowerCase().includes(searchLower) ||\n        purchase.project_vendor?.toLowerCase().includes(searchLower) ||\n        purchase.project_item?.toLowerCase().includes(searchLower) ||\n        purchase.sales_order_number?.toLowerCase().includes(searchLower)\n      );\n    }\n\n    //   \n    activeFilters.forEach(filter => {\n      \n      filtered = filtered.filter(purchase => {\n        //       \n        const actualField = (filter.field === 'date_range' || filter.field === 'date_month') \n          ? filter.dateField || filter.field \n          : filter.field;\n        \n        const fieldValue = getFieldValue(purchase, actualField);\n        \n        //    \n        const filterFieldType = filter.field === 'date_month' ? 'date_month' : \n                               filter.field === 'date_range' ? 'date_range' : undefined;\n        \n        const result = applyFilterCondition(fieldValue, filter.condition, filter.value, filterFieldType);\n        \n        \n        return result;\n      });\n      \n    });\n\n    return filtered;\n  }, [searchTerm, activeFilters]);\n\n  //    \n  const getFieldValue = (purchase: Purchase, field: string): any => {\n    switch (field) {\n      case 'purchase_order_number':\n        return purchase.purchase_order_number;\n      case 'payment_category':\n        return purchase.payment_category;\n      case 'requester_name':\n        return purchase.requester_name;\n      case 'vendor_name':\n        return purchase.vendor_name;\n      case 'contact_name':\n        return purchase.contact_name;\n      case 'item_name':\n        return purchase.item_name;\n      case 'specification':\n        return purchase.specification;\n      case 'quantity':\n        return purchase.quantity;\n      case 'unit_price_value':\n        return purchase.unit_price_value;\n      case 'total_amount':\n        return purchase.total_amount;\n      case 'remark':\n        return purchase.remark;\n      case 'project_vendor':\n        return purchase.project_vendor;\n      case 'project_item':\n        return purchase.project_item;\n      case 'sales_order_number':\n        return purchase.sales_order_number;\n      case 'payment_schedule':\n        return (purchase as any).vendor_payment_schedule;\n      case 'is_payment_completed':\n        return purchase.is_payment_completed ? '' : '';\n      case 'is_received':\n        return purchase.is_received ? '' : '';\n      case 'is_statement_received':\n        return (purchase as any).is_statement_received ? '' : '';\n      case 'is_utk_checked':\n        return (purchase as any).is_utk_checked ? '' : '';\n      case 'request_date':\n        return purchase.request_date;\n      case 'delivery_request_date':\n        return purchase.delivery_request_date;\n      case 'payment_completed_at':\n        return purchase.payment_completed_at;\n      case 'received_at':\n        return purchase.received_at;\n      case 'created_at':\n        return (purchase as any).created_at;\n      case 'statement_received_at':\n        return (purchase as any).statement_received_at;\n      default:\n        return null;\n    }\n  };\n\n  //    \n  const applyFilterCondition = (fieldValue: any, condition: string, filterValue: any, filterField?: string): boolean => {\n    if (fieldValue === null || fieldValue === undefined) {\n      return condition === 'is_empty';\n    }\n\n    //      (~)\n    if (filterField === 'date_range' && filterValue && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startDate, endDate] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(startDate);\n      const end = new Date(endDate);\n      \n      //       \n      return fieldDate >= start && fieldDate <= end;\n    }\n\n    //      (~)\n    if (filterField === 'date_month' && filterValue && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startMonth, endMonth] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(`${startMonth}-01`);\n      const end = new Date(`${endMonth}-01`);\n      \n      //    (    )\n      const endOfMonth = new Date(end.getFullYear(), end.getMonth() + 1, 0, 23, 59, 59);\n      return fieldDate >= start && fieldDate <= endOfMonth;\n    }\n\n    //     ( )\n    if (filterField && (filterField === 'date_month' || filterField.endsWith('_month'))) {\n      if (!filterValue) return true;\n      \n      const fieldDate = new Date(fieldValue);\n      const [filterYear, filterMonth] = filterValue.split('-');\n      \n      return fieldDate.getFullYear() === parseInt(filterYear) && \n             (fieldDate.getMonth() + 1) === parseInt(filterMonth);\n    }\n\n    const fieldStr = String(fieldValue).toLowerCase();\n    const filterStr = String(filterValue).toLowerCase();\n\n    switch (condition) {\n      case 'contains':\n        return fieldStr.includes(filterStr);\n      case 'equals':\n        //      \n        if (filterField === 'date_range' || filterValue.match(/^\\d{4}-\\d{2}-\\d{2}/)) {\n          if (!fieldValue) return false;\n          try {\n            const fieldDate = new Date(fieldValue).toISOString().split('T')[0];\n            const filterDate = filterValue.split('T')[0];\n            return fieldDate === filterDate;\n          } catch (error) {\n            logger.error('  :', error);\n            return false;\n          }\n        }\n        return fieldStr === filterStr;\n      case 'starts_with':\n        return fieldStr.startsWith(filterStr);\n      case 'ends_with':\n        return fieldStr.endsWith(filterStr);\n      case 'is_empty':\n        return !fieldValue || fieldStr.trim() === '';\n      case 'is_not_empty':\n        return !!fieldValue && fieldStr.trim() !== '';\n      case 'greater_than':\n        return Number(fieldValue) > Number(filterValue);\n      case 'less_than':\n        return Number(fieldValue) < Number(filterValue);\n      case 'between':\n        //    \n        return true;\n      case 'after':\n        return new Date(fieldValue) > new Date(filterValue);\n      case 'before':\n        return new Date(fieldValue) < new Date(filterValue);\n      case 'not_equals':\n        return fieldStr !== filterStr;\n      default:\n        return true;\n    }\n  };\n\n  //   \n  const applySorting = useCallback((purchases: Purchase[]) => {\n    if (!sortConfig) return purchases;\n\n    return [...purchases].sort((a, b) => {\n      const aValue = getFieldValue(a, sortConfig.field);\n      const bValue = getFieldValue(b, sortConfig.field);\n\n      if (aValue === null || aValue === undefined) return 1;\n      if (bValue === null || bValue === undefined) return -1;\n\n      let comparison = 0;\n      if (typeof aValue === 'number' && typeof bValue === 'number') {\n        comparison = aValue - bValue;\n      } else if (aValue instanceof Date && bValue instanceof Date) {\n        comparison = aValue.getTime() - bValue.getTime();\n      } else {\n        comparison = String(aValue).localeCompare(String(bValue));\n      }\n\n      return sortConfig.direction === 'desc' ? -comparison : comparison;\n    });\n  }, [sortConfig]);\n\n  //      \n  const advancedFilteredPurchases = useMemo(() => {\n    let result = applyAdvancedFilters(filteredPurchases);\n    result = applySorting(result);\n    return result;\n  }, [filteredPurchases, applyAdvancedFilters, applySorting]);\n\n  //   \n  const hasActiveFilters = useMemo(() => {\n    return hasActiveFiltersDetected(activeFilters, searchTerm, selectedEmployee);\n  }, [activeFilters, searchTerm, selectedEmployee]);\n\n  //    \n  const smartFilter = useSmartFilterLimit(\n    advancedFilteredPurchases,\n    hasActiveFilters,\n    activeFilters,\n    searchTerm\n  );\n\n  //    \n  const smartFilteredPurchases = smartFilter.limitedData;\n\n  //    - \" \"      \n  //        \n  const shouldUseProgressive = useMemo(() => {\n    return activeTab === 'done' && \n           dateLimit.isFullyLoaded && \n           !smartFilter.isLimited &&\n           smartFilteredPurchases.length > 100;\n  }, [activeTab, dateLimit.isFullyLoaded, smartFilter.isLimited, smartFilteredPurchases.length]);\n\n  //   \n  const progressiveLoading = useProgressiveLoading(\n    shouldUseProgressive ? smartFilteredPurchases : [],\n    {\n      initialBatchSize: 50,\n      maxBatchSize: 200,\n      enablePrefetch: true,\n      prefetchThreshold: 0.8\n    }\n  );\n\n  //   \n  const displayPurchases = useMemo(() => {\n    if (shouldUseProgressive) {\n      return progressiveLoading.loadedData;\n    }\n    return smartFilteredPurchases;\n  }, [shouldUseProgressive, progressiveLoading.loadedData, smartFilteredPurchases]);\n\n  //      \n  useEffect(() => {\n    if (shouldUseProgressive) {\n      progressiveLoading.reset();\n    } else {\n      progressiveLoading.setData(smartFilteredPurchases);\n    }\n  }, [shouldUseProgressive, smartFilteredPurchases]);\n\n\n  //  \n  const handleExcelDownload = async (purchase: Purchase) => {\n    try {\n      // DB    \n      const { data: purchaseRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .single();\n\n      if (requestError || !purchaseRequest) {\n        toast.error('     .');\n        return;\n      }\n\n      //   \n      const { data: orderItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .order('line_number');\n\n      if (itemsError || !orderItems || orderItems.length === 0) {\n        toast.error('      .');\n        return;\n      }\n\n      //       \n      const vendorInfo = {\n        vendor_name: purchase.vendor_name,\n        vendor_phone: '',\n        vendor_fax: '',\n        vendor_contact_name: ''\n      };\n\n      try {\n        const vendorId = purchaseRequest.vendor_id || purchase.vendor_id;\n        const contactId = purchaseRequest.contact_id || purchase.contact_id;\n        \n        // vendor  \n        if (vendorId) {\n          const { data: vendorData, error: vendorError } = await supabase\n            .from('vendors')\n            .select('vendor_phone, vendor_fax')\n            .eq('id', vendorId)\n            .single();\n\n          if (vendorData && !vendorError) {\n            vendorInfo.vendor_phone = vendorData.vendor_phone || '';\n            vendorInfo.vendor_fax = vendorData.vendor_fax || '';\n          }\n        }\n\n        // vendor_contacts contact_id   \n        if (contactId) {\n          const { data: contactData, error: contactError } = await supabase\n            .from('vendor_contacts')\n            .select('contact_name, contact_phone, contact_email')\n            .eq('id', contactId)\n            .single();\n          if (contactData && !contactError) {\n            vendorInfo.vendor_contact_name = contactData.contact_name || '';\n          }\n        }\n      } catch (error) {\n      }\n\n      const excelData: PurchaseOrderData = {\n        purchase_order_number: purchaseRequest.purchase_order_number || '',\n        request_date: purchaseRequest.request_date,\n        delivery_request_date: purchaseRequest.delivery_request_date,\n        requester_name: purchaseRequest.requester_name,\n        vendor_name: vendorInfo.vendor_name || '',\n        vendor_contact_name: vendorInfo.vendor_contact_name,\n        vendor_phone: vendorInfo.vendor_phone,\n        vendor_fax: vendorInfo.vendor_fax,\n        project_vendor: purchaseRequest.project_vendor,\n        sales_order_number: purchaseRequest.sales_order_number,\n        project_item: purchaseRequest.project_item,\n        items: orderItems.map((item: any) => ({\n          line_number: item.line_number,\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          amount_value: item.amount_value,\n          remark: item.remark,\n          currency: purchaseRequest.currency || 'KRW'\n        }))\n      };\n\n      //   ExcelJS  (    )\n      const blob = await generatePurchaseOrderExcelJS(excelData);\n      \n      //  : _{}_\n      const downloadFilename = `_${excelData.vendor_name}_${excelData.purchase_order_number}.xlsx`;\n\n      //    \n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = downloadFilename;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success('  .');\n      \n      // DB   (is_po_download)  - lead buyer \n      try {\n        const isLeadBuyer = currentUserRoles && currentUserRoles.includes('lead buyer');\n\n        if (isLeadBuyer) {\n          const { error: downloadFlagErr } = await supabase\n            .from('purchase_requests')\n            .update({ is_po_download: true })\n            .eq('purchase_order_number', purchase.purchase_order_number);\n          if (downloadFlagErr) {\n          } else {\n            //  \n            await loadPurchases();\n          }\n        }\n      } catch (flagErr) {\n      }\n    } catch (error) {\n      toast.error('  .');\n    }\n  };\n\n  //   -    \n  const handleReceiptComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_received: true,\n            received_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_received: true,\n            delivery_status: 'received'\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handlePaymentComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_payment_completed: true,\n            payment_completed_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_payment_completed: true\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handleItemsClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    setIsModalOpen(true);\n  }, []);\n\n  //   \n  const handleLoadMore = useCallback((nextLimit: DateLimitOption) => {\n    dateLimit.setDateLimit(nextLimit);\n  }, [dateLimit]);\n\n  // 30  \n  const handleResetToThirtyDays = useCallback(() => {\n    dateLimit.setDateLimit(DATE_LIMIT_OPTIONS[0]); // 30\n  }, [dateLimit]);\n  \n  //    -   \n  const modalPurchaseData = useMemo(() => {\n    if (!selectedPurchase) return null;\n    return {\n      ...selectedPurchase,\n      vendor_name: selectedPurchase.vendor_name || '',\n      project_vendor: selectedPurchase.project_vendor || '',\n      sales_order_number: selectedPurchase.sales_order_number || '',\n      project_item: selectedPurchase.project_item || ''\n    };\n  }, [selectedPurchase]);\n\n  return (\n    <div className=\"w-full\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4\">\n        <div>\n          <h1 className=\"page-title\"> </h1>\n          <p className=\"page-subtitle\" style={{marginTop:'-2px',marginBottom:'-4px'}}>Purchase Management</p>\n        </div>\n        <Button \n          onClick={() => navigate('/purchase/new')}\n          className=\"mt-4 sm:mt-0 bg-hansl-500 hover:bg-hansl-600\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n            \n        </Button>\n      </div>\n\n      {/*    -       */}\n      <div className=\"mb-3\">\n        <FilterToolbar\n          activeFilters={activeFilters}\n          sortConfig={sortConfig}\n          searchTerm={searchTerm}\n          onFiltersChange={setActiveFilters}\n          onSortChange={setSortConfig}\n          onSearchChange={setSearchTerm}\n          availableEmployees={availableEmployees}\n          availableVendors={availableVendors}\n          availableContacts={availableContacts}\n          availablePaymentSchedules={availablePaymentSchedules}\n        />\n      </div>\n\n      {/*    */}\n      {smartFilter.shouldShowWarning && (\n        <div className=\"mb-4\">\n          <SmartFilterWarning\n            smartFilter={smartFilter}\n          />\n        </div>\n      )}\n\n      {/*    (hanslwebapp ) -   */}\n      <div className=\"space-y-3\">\n        {/*   -    */}\n        <div className=\"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 business-radius-card border border-gray-200\">\n          {NAV_TABS.map((tab) => (\n            <button\n              key={tab.key}\n              onClick={() => {\n                setActiveTab(tab.key);\n              }}\n              className={`flex-1 flex items-center justify-center space-x-2 py-1.5 px-3 sm:px-4 business-radius-button button-text font-medium transition-colors ${\n                activeTab === tab.key\n                  ? 'text-hansl-600 bg-white shadow-sm border border-gray-200'\n                  : 'text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50'\n              }`}\n            >\n              <span className=\"whitespace-nowrap\">{tab.label}</span>\n              <Badge \n                variant=\"secondary\" \n                className={\n                  activeTab === tab.key \n                    ? 'badge-stats-active' \n                    : 'badge-stats-secondary'\n                }\n              >\n                {tab.key === activeTab && smartFilter.isLimited \n                  ? `${smartFilter.displayedCount.toLocaleString()}/${smartFilter.totalCount.toLocaleString()}`\n                  : tabCounts[tab.key as keyof typeof tabCounts]\n                }\n              </Badge>\n            </button>\n          ))}\n        </div>\n\n        {/*   */}\n        <Card className=\"overflow-hidden border border-gray-200\">\n          <CardContent className=\"p-0\">\n            {loading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <div className=\"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin\" />\n                <span className=\"ml-3 card-subtitle\"> ...</span>\n              </div>\n            ) : advancedFilteredPurchases.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Package className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\"> </h3>\n                <p className=\"card-subtitle\">  .</p>\n              </div>\n            ) : (\n              <>\n                <AdaptiveTableWrapper\n                  purchases={displayPurchases} \n                  activeTab={activeTab}\n                  currentUserRoles={currentUserRoles}\n                  onRefresh={loadPurchases}\n                  onOptimisticUpdate={updatePurchaseOptimistic}\n                  onPaymentComplete={handlePaymentComplete}\n                  onReceiptComplete={handleReceiptComplete}\n                  virtualizationThreshold={200}\n                  virtualizedHeight={600}\n                />\n                \n                {/*   - \" \"   */}\n                {activeTab === 'done' && (\n                  <>\n                    <LoadMoreButton\n                      currentLimit={dateLimit.currentLimit}\n                      nextLimit={dateLimit.getNextLimit()}\n                      totalCount={totalDataCount}\n                      displayedCount={shouldUseProgressive ? progressiveLoading.loadedData.length : displayedDataCount}\n                      hasNextLimit={dateLimit.hasNextLimit}\n                      isFullyLoaded={dateLimit.isFullyLoaded}\n                      onLoadMore={handleLoadMore}\n                      onReset={handleResetToThirtyDays}\n                      className=\"border-t border-gray-100\"\n                      \n                      //   \n                      enableProgressive={shouldUseProgressive}\n                      progressiveState={progressiveLoading.state}\n                      onProgressiveLoadMore={progressiveLoading.loadMore}\n                      isNearEnd={progressiveLoading.isNearEnd}\n                    />\n                    \n                    {/*     invisible element */}\n                    {shouldUseProgressive && (\n                      <div \n                        ref={progressiveLoading.loadingRef} \n                        className=\"h-1 w-full invisible\"\n                        aria-hidden=\"true\"\n                      />\n                    )}\n                  </>\n                )}\n              </>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n      \n      {/*   -     */}\n      {modalPurchaseData && (\n        <Suspense fallback={<div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"><div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div></div>}>\n          <PurchaseItemsModal\n            isOpen={isModalOpen}\n            onClose={() => {\n              setIsModalOpen(false);\n              setSelectedPurchase(null);\n            }}\n            purchase={modalPurchaseData}\n            isAdmin={isAdmin || false}\n            onUpdate={loadPurchases}\n            activeTab={activeTab}\n          />\n        </Suspense>\n      )}\n    </div>\n  );\n}"],"file":"assets/PurchaseListMain-Cv6QhGaj.js"}