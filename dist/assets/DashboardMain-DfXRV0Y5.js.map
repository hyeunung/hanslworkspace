{"version":3,"file":"DashboardMain-DfXRV0Y5.js","sources":["../../node_modules/lucide-react/dist/esm/icons/arrow-right.js","../../node_modules/lucide-react/dist/esm/icons/circle-check.js","../../node_modules/lucide-react/dist/esm/icons/clock.js","../../src/services/dashboardService.ts","../../src/components/dashboard/PurchaseStatusModal.tsx","../../src/components/dashboard/DashboardMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M5 12h14\", key: \"1ays0h\" }],\n  [\"path\", { d: \"m12 5 7 7-7 7\", key: \"xquz4c\" }]\n];\nconst ArrowRight = createLucideIcon(\"arrow-right\", __iconNode);\n\nexport { __iconNode, ArrowRight as default };\n//# sourceMappingURL=arrow-right.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m9 12 2 2 4-4\", key: \"dzmm74\" }]\n];\nconst CircleCheck = createLucideIcon(\"circle-check\", __iconNode);\n\nexport { __iconNode, CircleCheck as default };\n//# sourceMappingURL=circle-check.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 6v6l4 2\", key: \"mmk7yg\" }],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]\n];\nconst Clock = createLucideIcon(\"clock\", __iconNode);\n\nexport { __iconNode, Clock as default };\n//# sourceMappingURL=clock.js.map\n","import { createClient } from '@/lib/supabase/client'\nimport { logger } from '@/lib/logger'\nimport type { \n  DashboardData, \n  DashboardStats, \n  UrgentRequest, \n  MyRequestStatus, \n  QuickAction,\n  Employee,\n  PurchaseRequestWithDetails \n} from '@/types/purchase'\n\n// ëŒ€ì‹œë³´ë“œ ë°ì´í„° ìºì‹œ\nconst dashboardCache = {\n  data: null as DashboardData | null,\n  lastFetch: 0,\n  CACHE_DURATION: 30 * 1000, // 30ì´ˆ ìºì‹œ\n  employeeId: null as string | null\n}\n\nexport class DashboardService {\n  private supabase = createClient()\n\n  // ì—­í•  íŒŒì‹± ìœ í‹¸: ë°°ì—´/CSV ë¬¸ìì—´/ë‹¨ì¼ ë¬¸ìì—´ì„ ëª¨ë‘ ë°°ì—´ë¡œ ì •ê·œí™”\n  private parseRoles(purchaseRole: string | string[] | null | undefined): string[] {\n    let roles: string[] = []\n    \n    if (purchaseRole) {\n      if (Array.isArray(purchaseRole)) {\n        // ë°°ì—´ì¸ ê²½ìš°\n        roles = purchaseRole.map((r: any) => String(r).trim())\n      } else {\n        // ë¬¸ìì—´ì¸ ê²½ìš° (ì¼ë°˜ì )\n        const roleString = String(purchaseRole)\n        // ì‰¼í‘œë¡œ ë¶„í• í•˜ê³  ê³µë°± ì œê±°\n        roles = roleString\n          .split(',')\n          .map((r: string) => r.trim())\n          .filter((r: string) => r.length > 0)\n      }\n    }\n    \n    return roles\n  }\n\n  // ë©”ì¸ ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ\n  async getDashboardData(employee: Employee, forceRefresh = false): Promise<DashboardData> {\n    const now = Date.now()\n    const cacheValid = !forceRefresh && \n                       dashboardCache.data && \n                       dashboardCache.employeeId === employee.id &&\n                       (now - dashboardCache.lastFetch) < dashboardCache.CACHE_DURATION\n\n    // ìºì‹œê°€ ìœ íš¨í•˜ë©´ ì¦‰ì‹œ ë°˜í™˜\n    if (cacheValid && dashboardCache.data) {\n      return dashboardCache.data\n    }\n\n    const results = await Promise.allSettled([\n      this.getDashboardStats(employee),\n      this.getMyRecentRequests(employee),\n      this.getPendingApprovals(employee),\n      this.getQuickActions(employee),\n      this.getTodaySummary(employee),\n      this.getMyPurchaseStatus(employee)\n    ])\n    \n    const statsResult = results[0]\n    const myRecentRequestsResult = results[1]\n    const pendingApprovalsResult = results[2]\n    const quickActionsResult = results[3]\n    const todaySummaryResult = results[4]\n    const myPurchaseStatusResult = results[5]\n    \n    const stats: DashboardStats = statsResult.status === 'fulfilled' \n      ? statsResult.value \n      : { total: 0, myRequests: 0, pending: 0, completed: 0, urgent: 0, todayActions: 0 }\n    \n    const myRecentRequests: MyRequestStatus[] = myRecentRequestsResult.status === 'fulfilled'\n      ? myRecentRequestsResult.value\n      : []\n    \n    const pendingApprovals: PurchaseRequestWithDetails[] = pendingApprovalsResult.status === 'fulfilled'\n      ? pendingApprovalsResult.value\n      : []\n    \n    const quickActions: QuickAction[] = quickActionsResult.status === 'fulfilled'\n      ? quickActionsResult.value\n      : []\n    \n    const todaySummary = todaySummaryResult.status === 'fulfilled'\n      ? todaySummaryResult.value\n      : { approved: 0, requested: 0, received: 0 }\n    \n    const myPurchaseStatus = myPurchaseStatusResult.status === 'fulfilled'\n      ? myPurchaseStatusResult.value\n      : { waitingPurchase: [], waitingDelivery: [], recentCompleted: [] }\n    \n    // ì‹¤íŒ¨í•œ í•­ëª© ë¡œê¹…\n    if (statsResult.status === 'rejected') {\n      logger.error('[DashboardService] getDashboardStats ì‹¤íŒ¨:', statsResult.reason)\n    }\n    if (myRecentRequestsResult.status === 'rejected') {\n      logger.error('[DashboardService] getMyRecentRequests ì‹¤íŒ¨:', myRecentRequestsResult.reason)\n    }\n    if (pendingApprovalsResult.status === 'rejected') {\n      logger.error('[DashboardService] getPendingApprovals ì‹¤íŒ¨:', pendingApprovalsResult.reason)\n    }\n    if (quickActionsResult.status === 'rejected') {\n      logger.error('[DashboardService] getQuickActions ì‹¤íŒ¨:', quickActionsResult.reason)\n    }\n    if (todaySummaryResult.status === 'rejected') {\n      logger.error('[DashboardService] getTodaySummary ì‹¤íŒ¨:', todaySummaryResult.reason)\n    }\n    if (myPurchaseStatusResult.status === 'rejected') {\n      logger.error('[DashboardService] getMyPurchaseStatus ì‹¤íŒ¨:', myPurchaseStatusResult.reason)\n    }\n\n    const dashboardData: DashboardData = {\n      employee,\n      stats,\n      urgentRequests: [],\n      myRecentRequests,\n      pendingApprovals,\n      quickActions,\n      todaySummary,\n      myPurchaseStatus\n    }\n\n    // ìºì‹œ ì—…ë°ì´íŠ¸\n    dashboardCache.data = dashboardData\n    dashboardCache.lastFetch = now\n    dashboardCache.employeeId = employee.id\n\n    return dashboardData\n  }\n\n  // í†µê³„ ì •ë³´ (ìš°ì„ ìˆœìœ„ ì¬ì •ë ¬)\n  async getDashboardStats(employee: Employee): Promise<DashboardStats> {\n    const today = new Date().toISOString().split('T')[0]\n    const roles = this.parseRoles(employee.purchase_role)\n\n\n    // ë³‘ë ¬ ì¿¼ë¦¬ë¡œ ì„±ëŠ¥ ìµœì í™”\n    const [\n      totalResult,\n      myRequestsResult,\n      pendingResult,\n      completedResult,\n      urgentResult,\n      todayActionsResult\n    ] = await Promise.all([\n      // ì „ì²´ ìš”ì²­ ìˆ˜\n      this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true }),\n\n      // ë‚´ ìš”ì²­ ìˆ˜\n      this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .eq('requester_name', employee.name),\n\n      // ë‚´ê°€ ì²˜ë¦¬í•´ì•¼ í•  ìŠ¹ì¸ ëŒ€ê¸°\n      this.getPendingCount(employee, roles),\n\n      // ì´ë²ˆ ë‹¬ ì™„ë£Œëœ ìš”ì²­ ìˆ˜  \n      this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .eq('is_received', true)\n        .gte('received_at', new Date(new Date().getFullYear(), new Date().getMonth(), 1).toISOString()),\n\n      // ê¸´ê¸‰ ìš”ì²­ ìˆ˜ (3ì¼ ì´ìƒ ëŒ€ê¸°)\n      this.getUrgentCount(employee, roles),\n\n      // ì˜¤ëŠ˜ ì²˜ë¦¬í•œ ì•¡ì…˜ ìˆ˜\n      this.getTodayActionsCount(employee, today)\n    ])\n\n    const stats = {\n      total: totalResult.count || 0,\n      myRequests: myRequestsResult.count || 0,\n      pending: pendingResult,\n      completed: completedResult.count || 0,\n      urgent: urgentResult,\n      todayActions: todayActionsResult\n    }\n\n    return stats\n  }\n\n  // ë‚´ ìµœê·¼ ìš”ì²­ ìƒíƒœ (ìŠ¹ì¸ ì§„í–‰ì¤‘ì¸ í•­ëª©ë§Œ - ìŠ¹ì¸ ëŒ€ê¸°ëŠ” ì œì™¸)\n  async getMyRecentRequests(employee: Employee): Promise<MyRequestStatus[]> {\n    const { data } = await this.supabase\n      .from('purchase_requests')\n      .select('*,vendors(vendor_name),purchase_request_items(id)')\n      .eq('requester_name', employee.name)\n      // ìŠ¹ì¸ì´ ì§„í–‰ì¤‘ì¸ í•­ëª©ë§Œ (1ì°¨ ìŠ¹ì¸ë¨ + ìµœì¢… ëŒ€ê¸°ì¤‘ OR ëª¨ë“  ìŠ¹ì¸ ì™„ë£Œ + êµ¬ë§¤ ëŒ€ê¸°ì¤‘)\n      .or('and(middle_manager_status.eq.approved,final_manager_status.eq.pending),and(final_manager_status.eq.approved,is_payment_completed.eq.false)')\n      .order('created_at', { ascending: false })\n      .limit(5)\n\n    return (data || []).map((item: any) => ({\n      ...item,\n      vendor_name: item.vendors?.vendor_name,\n      total_items: item.purchase_request_items?.length || 0,\n      progress_percentage: this.calculateProgress(item),\n      current_step: this.getCurrentStep(item),\n      next_action: this.getNextAction(item),\n      estimated_completion: this.estimateCompletion(item)\n    })) as MyRequestStatus[]\n  }\n\n  // ìŠ¹ì¸ ëŒ€ê¸° í•­ëª© (ì „ì²´ ì¡°íšŒ) - ë°œì£¼ ë¦¬ìŠ¤íŠ¸ì™€ ë™ì¼í•œ ë°©ì‹\n  async getPendingApprovals(employee: Employee): Promise<PurchaseRequestWithDetails[]> {\n    const roles = this.parseRoles(employee.purchase_role)\n\n    // ë¨¼ì € ëª¨ë“  ë°œì£¼ìš”ì²­ì„ ê°€ì ¸ì˜´ (ë°œì£¼ ë¦¬ìŠ¤íŠ¸ì™€ ë™ì¼)\n    // ìŠ¤í‚¤ë§ˆì— ë§ì¶° item ë‹¨ê°€/ê¸ˆì•¡ ì»¬ëŸ¼ ìˆ˜ì • (unit_price_value, amount_value)\n    let allRequests: any[] = []\n    let baseError: any = null\n\n\n    const firstTry = await this.supabase\n      .from('purchase_requests')\n      .select('*')\n      .order('request_date', { ascending: false })\n      .limit(100) // ìµœì í™”: 100ê°œë¡œ ì œí•œ\n\n\n    if (firstTry.error) {\n      // ê´€ê³„ ì¡°íšŒ ì‹¤íŒ¨ ì‹œ ìµœì†Œ ì»¬ëŸ¼ìœ¼ë¡œ ì¬ì‹œë„í•˜ì—¬ ë¦¬ìŠ¤íŠ¸ ìì²´ëŠ” í‘œì‹œë˜ë„ë¡ í•¨\n      baseError = firstTry.error\n      const fallback = await this.supabase\n        .from('purchase_requests')\n        .select('*')\n        .order('request_date', { ascending: false })\n        .limit(100) // ìµœì í™”: 100ê°œë¡œ ì œí•œ\n      if (fallback.error) {\n        // Fallback query also failed - will return empty array\n        return []\n      }\n      allRequests = fallback.data || []\n    } else {\n      allRequests = firstTry.data || []\n    }\n\n    // í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œì—ì„œ ì—­í• ë³„ í•„í„°ë§\n    let filteredData = allRequests || []\n\n    // ë°œì£¼ ë¦¬ìŠ¤íŠ¸ì™€ ë™ì¼í•œ í•„í„°ë§ ë¡œì§ ì‚¬ìš© - ìŠ¹ì¸ ëŒ€ê¸°ì¸ í•­ëª©ë§Œ\n    // pending, ëŒ€ê¸°, ë¹ˆë¬¸ìì—´, null ëª¨ë‘ ëŒ€ê¸°ë¡œ ì²˜ë¦¬\n    const isPending = (status: any) => (\n      status === 'pending' || status === 'ëŒ€ê¸°' || status === '' || status === null || status === undefined\n    )\n\n    // ë°œì£¼ ë¦¬ìŠ¤íŠ¸ì˜ pending íƒ­ê³¼ ë™ì¼í•œ ì¡°ê±´: ì¤‘ê°„ìŠ¹ì¸ìë‚˜ ìµœì¢…ìŠ¹ì¸ì ì¤‘ í•˜ë‚˜ë¼ë„ pendingì´ë©´ ìŠ¹ì¸ëŒ€ê¸°\n    logger.debug('ğŸ” ìŠ¹ì¸ëŒ€ê¸° í•„í„°ë§ ì „ ë°ì´í„°', {\n      employeeName: employee.name,\n      employeeRoles: this.parseRoles(employee.purchase_role),\n      totalRequests: allRequests?.length || 0,\n      sampleData: allRequests?.slice(0, 3).map(item => ({\n        id: item.id,\n        purchase_order_number: item.purchase_order_number,\n        middle_manager_status: item.middle_manager_status,\n        final_manager_status: item.final_manager_status,\n        vendor_name: item.vendor_name\n      })) || []\n    })\n    \n    filteredData = filteredData.filter(item => {\n      const middlePending = isPending(item.middle_manager_status)\n      const finalPending = isPending(item.final_manager_status)\n      \n      // ë°˜ë ¤ëœ ê²½ìš°ëŠ” ì œì™¸\n      const middleRejected = item.middle_manager_status === 'rejected'\n      const finalRejected = item.final_manager_status === 'rejected'\n      \n      if (middleRejected || finalRejected) return false\n      \n      // ì¤‘ê°„ìŠ¹ì¸ ëŒ€ê¸° ë˜ëŠ” ìµœì¢…ìŠ¹ì¸ ëŒ€ê¸°\n      const shouldInclude = middlePending || finalPending\n      \n      logger.debug('âœ… ìŠ¹ì¸ëŒ€ê¸° í•­ëª© í•„í„°ë§', {\n        id: item.id,\n        purchase_order_number: item.purchase_order_number,\n        middle_manager_status: item.middle_manager_status,\n        final_manager_status: item.final_manager_status,\n        middlePending,\n        finalPending,\n        shouldInclude\n      })\n      \n      return shouldInclude\n    })\n    \n    logger.debug('ğŸ” ìŠ¹ì¸ëŒ€ê¸° í•„í„°ë§ í›„ ë°ì´í„°', {\n      filteredCount: filteredData.length,\n      filteredItems: filteredData.map(item => ({\n        id: item.id,\n        purchase_order_number: item.purchase_order_number,\n        middle_manager_status: item.middle_manager_status,\n        final_manager_status: item.final_manager_status\n      }))\n    })\n    \n    // ì—­í• ì´ ìˆëŠ” ì‚¬ìš©ìë§Œ ìŠ¹ì¸ ëŒ€ê¸° í•­ëª©ì„ ë³¼ ìˆ˜ ìˆìŒ\n    if (roles.length === 0) {\n      return []\n    }\n\n    // ì—­í• ë³„ ê¶Œí•œì— ë”°ë¥¸ ì¶”ê°€ í•„í„°ë§ (app_adminì´ ìµœìš°ì„ )\n    let roleFilteredData = filteredData\n    \n    if (roles.includes('app_admin')) {\n      // app_adminì€ ëª¨ë“  ìŠ¹ì¸ ëŒ€ê¸° í•­ëª© ë³¼ ìˆ˜ ìˆìŒ (í•„í„°ë§ ì—†ìŒ)\n      logger.debug('ğŸ”‘ app_admin ê¶Œí•œìœ¼ë¡œ ëª¨ë“  ìŠ¹ì¸ëŒ€ê¸° í•­ëª© í‘œì‹œ', {\n        totalItems: roleFilteredData.length\n      })\n      // app_adminì¸ ê²½ìš° ì¶”ê°€ í•„í„°ë§ ì—†ì´ ëª¨ë“  í•­ëª© í‘œì‹œ\n    } else if (roles.includes('middle_manager')) {\n      // ì¤‘ê°„ìŠ¹ì¸ì: ì¤‘ê°„ìŠ¹ì¸ ëŒ€ê¸° í•­ëª©ë§Œ\n      roleFilteredData = filteredData.filter(item => {\n        const middlePending = isPending(item.middle_manager_status)\n        return middlePending\n      })\n      logger.debug('ğŸ”‘ middle_manager ê¶Œí•œìœ¼ë¡œ ì¤‘ê°„ìŠ¹ì¸ ëŒ€ê¸° í•­ëª©ë§Œ í‘œì‹œ', {\n        beforeFilter: filteredData.length,\n        afterFilter: roleFilteredData.length\n      })\n    } else if (roles.includes('final_approver') || roles.includes('ceo')) {\n      // ìµœì¢…ìŠ¹ì¸ì: ì¤‘ê°„ìŠ¹ì¸ ì™„ë£Œ + ìµœì¢…ìŠ¹ì¸ ëŒ€ê¸° í•­ëª©ë§Œ\n      roleFilteredData = filteredData.filter(item => {\n        const middleApproved = item.middle_manager_status === 'approved'\n        const finalPending = isPending(item.final_manager_status)\n        return middleApproved && finalPending\n      })\n      logger.debug('ğŸ”‘ final_approver/ceo ê¶Œí•œìœ¼ë¡œ ìµœì¢…ìŠ¹ì¸ ëŒ€ê¸° í•­ëª©ë§Œ í‘œì‹œ', {\n        beforeFilter: filteredData.length,\n        afterFilter: roleFilteredData.length\n      })\n    } else if (roles.includes('raw_material_manager') || roles.includes('consumable_manager')) {\n      // ì›ìì¬/ì†Œëª¨í’ˆ ë§¤ë‹ˆì €: ìµœì¢…ìŠ¹ì¸ìì™€ ë™ì¼í•œ ê¶Œí•œ\n      roleFilteredData = filteredData.filter(item => {\n        const middleApproved = item.middle_manager_status === 'approved'\n        const finalPending = isPending(item.final_manager_status)\n        return middleApproved && finalPending\n      })\n      logger.debug('ğŸ”‘ material_manager ê¶Œí•œìœ¼ë¡œ ìµœì¢…ìŠ¹ì¸ ëŒ€ê¸° í•­ëª©ë§Œ í‘œì‹œ', {\n        beforeFilter: filteredData.length,\n        afterFilter: roleFilteredData.length\n      })\n    } else if (roles.includes('lead buyer')) {\n      // êµ¬ë§¤ë‹´ë‹¹ì: ìµœì¢…ìŠ¹ì¸ ì™„ë£Œ + êµ¬ë§¤ ëŒ€ê¸° í•­ëª©ë§Œ\n      roleFilteredData = filteredData.filter(item => {\n        const finalApproved = item.final_manager_status === 'approved'\n        const purchasePending = !item.is_payment_completed\n        return finalApproved && purchasePending\n      })\n      logger.debug('ğŸ”‘ lead buyer ê¶Œí•œìœ¼ë¡œ êµ¬ë§¤ ëŒ€ê¸° í•­ëª©ë§Œ í‘œì‹œ', {\n        beforeFilter: filteredData.length,\n        afterFilter: roleFilteredData.length\n      })\n    } else {\n      // ê¸°íƒ€ ì—­í• ì€ ìŠ¹ì¸ ê¶Œí•œ ì—†ìŒ\n      roleFilteredData = []\n      logger.debug('ğŸ”‘ ìŠ¹ì¸ ê¶Œí•œ ì—†ëŠ” ì—­í• ', {\n        roles,\n        result: 'empty'\n      })\n    }\n    \n    // ìµœì¢… í•„í„°ë§ëœ ë°ì´í„° ì‚¬ìš©\n    filteredData = roleFilteredData\n    \n    logger.debug('ğŸ“‹ í’ˆëª© ì •ë³´ ì¡°íšŒ ì‹œì‘', {\n      filteredDataCount: filteredData.length,\n      filteredDataIds: filteredData.map(item => ({\n        id: item.id,\n        purchase_order_number: item.purchase_order_number\n      }))\n    })\n\n    // í’ˆëª© ì •ë³´ë¥¼ ë³„ë„ë¡œ ì¡°íšŒí•˜ì—¬ ì¶”ê°€\n    const enhancedData = await Promise.all(\n      filteredData.map(async (item) => {\n        // ê° ë°œì£¼ìš”ì²­ì— ëŒ€í•´ í’ˆëª© ì •ë³´ ì¡°íšŒ\n        const { data: items } = await this.supabase\n          .from('purchase_request_items')\n          .select('*')\n          .eq('purchase_request_id', item.id)\n\n        // ì—…ì²´ ì •ë³´ ì¡°íšŒ\n        let vendor_name = item.vendor_name\n        if (!vendor_name && item.vendor_id) {\n          const { data: vendor } = await this.supabase\n            .from('vendors')\n            .select('vendor_name')\n            .eq('id', item.vendor_id)\n            .single()\n          vendor_name = vendor?.vendor_name\n        }\n\n        const purchase_request_items = items || []\n        const total_amount = purchase_request_items.reduce((sum: number, i: any) => {\n          const amount = Number(i?.amount_value) || (Number(i?.quantity) || 0) * (Number(i?.unit_price_value) || 0)\n          return sum + amount\n        }, 0)\n\n        return {\n          ...item,\n          vendor_name,\n          purchase_request_items,\n          total_amount\n        }\n      })\n    )\n    \n    logger.debug('ğŸ“‹ í’ˆëª© ì •ë³´ ì¡°íšŒ ì™„ë£Œ', {\n      enhancedDataCount: enhancedData.length,\n      enhancedDataSummary: enhancedData.map(item => ({\n        id: item.id,\n        purchase_order_number: item.purchase_order_number,\n        itemsCount: item.purchase_request_items?.length || 0,\n        total_amount: item.total_amount\n      }))\n    })\n\n    return enhancedData\n  }\n\n  // ë¹ ë¥¸ ì•¡ì…˜ ë²„íŠ¼ ë°ì´í„°\n  async getQuickActions(employee: Employee): Promise<QuickAction[]> {\n    const roles = this.parseRoles(employee.purchase_role)\n\n    const actions: QuickAction[] = []\n\n    // ìŠ¹ì¸ ê¶Œí•œì´ ìˆëŠ” ê²½ìš°\n    if (roles.includes('app_admin') || roles.includes('middle_manager') || roles.includes('final_approver') || roles.includes('ceo')) {\n      const pendingCount = await this.getPendingCount(employee, roles)\n      if (pendingCount > 0) {\n        actions.push({\n          id: 'approve',\n          type: 'approve',\n          label: 'ìŠ¹ì¸ ëŒ€ê¸°',\n          description: `${pendingCount}ê±´ì˜ ìŠ¹ì¸ ëŒ€ê¸° ì¤‘`,\n          count: pendingCount,\n          color: 'red'\n        })\n      }\n    }\n\n    // êµ¬ë§¤ ê¶Œí•œì´ ìˆëŠ” ê²½ìš°\n    if (roles.includes('lead buyer') || roles.includes('lead buyer')) {\n      const { count: purchaseCount } = await this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .eq('final_manager_status', 'approved')\n        .eq('is_payment_completed', false)\n\n      if (purchaseCount && purchaseCount > 0) {\n        actions.push({\n          id: 'purchase',\n          type: 'purchase',\n          label: 'êµ¬ë§¤ ì²˜ë¦¬',\n          description: `${purchaseCount}ê±´ì˜ êµ¬ë§¤ ëŒ€ê¸° ì¤‘`,\n          count: purchaseCount,\n          color: 'yellow'\n        })\n      }\n    }\n\n    return actions\n  }\n\n  // ì˜¤ëŠ˜ ìš”ì•½ ì •ë³´\n  async getTodaySummary(employee: Employee) {\n    const today = new Date().toISOString().split('T')[0]\n    const tomorrow = new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString().split('T')[0]\n\n    const [approvedResult, requestedResult, receivedResult] = await Promise.all([\n      // ì˜¤ëŠ˜ ë‚´ê°€ ìŠ¹ì¸í•œ ê±´ìˆ˜\n      this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .gte('updated_at', today)\n        .lt('updated_at', tomorrow)\n        .or('middle_manager_status.eq.approved,final_manager_status.eq.approved'),\n\n      // ì˜¤ëŠ˜ ë‚´ê°€ ìš”ì²­í•œ ê±´ìˆ˜\n      this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .eq('requester_name', employee.name)\n        .gte('created_at', today)\n        .lt('created_at', tomorrow),\n\n      // ì˜¤ëŠ˜ ì…ê³  ì²˜ë¦¬í•œ ê±´ìˆ˜\n      this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .eq('is_received', true)\n        .gte('received_at', today)\n        .lt('received_at', tomorrow)\n    ])\n\n    return {\n      approved: approvedResult.count || 0,\n      requested: requestedResult.count || 0,\n      received: receivedResult.count || 0\n    }\n  }\n\n  // ë‚´ êµ¬ë§¤/ì…ê³  ìƒíƒœ í™•ì¸\n  async getMyPurchaseStatus(employee: Employee): Promise<{ waitingPurchase: PurchaseRequestWithDetails[], waitingDelivery: PurchaseRequestWithDetails[], recentCompleted: PurchaseRequestWithDetails[] }> {\n    \n    // nameì´ ì—†ìœ¼ë©´ email ì‚¬ìš©\n    const requesterName = employee.name || employee.email\n    \n    const sevenDaysAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()\n\n    // ë¨¼ì € ëª¨ë“  ë‚´ ìš”ì²­ì„ ê°€ì ¸ì˜¨ ë‹¤ìŒ í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•„í„°ë§\n    const myRequests = await this.supabase\n      .from('purchase_requests')\n      .select('*,vendors(vendor_name),purchase_request_items(item_name,quantity,specification,amount_value)')\n      .eq('requester_name', requesterName)\n      .order('created_at', { ascending: false })\n      .limit(100)\n\n    if (myRequests.error) {\n      logger.error('getMyPurchaseStatus ì—ëŸ¬', myRequests.error)\n      return {\n        waitingPurchase: [],\n        waitingDelivery: [],\n        recentCompleted: []\n      }\n    }\n\n    const allMyRequests = myRequests.data || []\n    \n\n    // í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ í•„í„°ë§ (PurchaseListMain êµ¬ë§¤/ì…ê³  íƒ­ê³¼ ë™ì¼í•œ ë¡œì§)\n    \n    const waitingPurchase = allMyRequests.filter((item: any) => {\n      // êµ¬ë§¤ ëŒ€ê¸°: êµ¬ë§¤/ë°œì£¼ ìš”ì²­ ì¹´í…Œê³ ë¦¬ + ê²°ì œ ë¯¸ì™„ë£Œ + ì„ ì§„í–‰(ìŠ¹ì¸ë¬´ê´€) OR ì¼ë°˜&ìµœì¢…ìŠ¹ì¸\n      // payment_categoryë¥¼ trim()í•˜ì—¬ ê³µë°± ì²˜ë¦¬ ë° ëŒ€ì†Œë¬¸ì ë¬´ì‹œ\n      const categoryNormalized = (item.payment_category || '').trim().replace(/\\s+/g, '')\n      const isPurchaseRequest = ['êµ¬ë§¤ìš”ì²­', 'ë°œì£¼ìš”ì²­'].includes(categoryNormalized)\n      const notPaid = !item.is_payment_completed\n      const isSeonJin = (item.progress_type || '').includes('ì„ ì§„í–‰')\n      \n      \n      // ì„ ì§„í–‰ì€ ìŠ¹ì¸ ìƒíƒœì™€ ë¬´ê´€í•˜ê²Œ êµ¬ë§¤ ëŒ€ê¸°\n      if (isPurchaseRequest && notPaid && isSeonJin) {\n        return true\n      }\n      \n      // ì¼ë°˜ì€ ìµœì¢… ìŠ¹ì¸ ì™„ë£Œë˜ì–´ì•¼ êµ¬ë§¤ ëŒ€ê¸°\n      const isIlban = (item.progress_type || '').includes('ì¼ë°˜') || !item.progress_type || item.progress_type === ''\n      const finalApproved = item.final_manager_status === 'approved'\n      \n      return isPurchaseRequest && notPaid && isIlban && finalApproved\n    }).slice(0, 10)\n\n\n    const waitingDelivery = allMyRequests.filter((item: any) => {\n      // ì…ê³  íƒ­ ë¡œì§: ì…ê³  ë¯¸ì™„ë£Œ + ì„ ì§„í–‰(ìŠ¹ì¸ë¬´ê´€) OR ìµœì¢…ìŠ¹ì¸\n      const notReceived = !item.is_received\n      const isSeonJin = (item.progress_type || '').includes('ì„ ì§„í–‰')\n      \n      // ì„ ì§„í–‰ì€ ìŠ¹ì¸ ìƒíƒœì™€ ë¬´ê´€í•˜ê²Œ ì…ê³  ëŒ€ê¸°\n      if (notReceived && isSeonJin) {\n        return true\n      }\n      \n      // ì¼ë°˜ì€ ìµœì¢… ìŠ¹ì¸ ì™„ë£Œë˜ì–´ì•¼ ì…ê³  ëŒ€ê¸°\n      const finalApproved = item.final_manager_status === 'approved'\n      \n      return notReceived && finalApproved\n    }).slice(0, 10)\n\n\n    const recentCompleted = allMyRequests.filter((item: any) => {\n      // ì…ê³  ì™„ë£Œ && 7ì¼ ì´ë‚´\n      if (item.is_received !== true) return false\n      if (!item.received_at) return false\n      const receivedDate = new Date(item.received_at)\n      const sevenDaysAgoDate = new Date(sevenDaysAgo)\n      return receivedDate >= sevenDaysAgoDate\n    }).slice(0, 10)\n\n\n    return {\n      waitingPurchase: waitingPurchase,\n      waitingDelivery: waitingDelivery,\n      recentCompleted: recentCompleted\n    }\n  }\n\n  // ì›í´ë¦­ ìŠ¹ì¸ API\n  async quickApprove(requestId: string, employee: Employee): Promise<{success: boolean, error?: string}> {\n    \n    try {\n      const roles = this.parseRoles(employee.purchase_role)\n\n      // ë¨¼ì € í˜„ì¬ ìš”ì²­ì˜ ìƒíƒœë¥¼ í™•ì¸\n      const { data: request } = await this.supabase\n        .from('purchase_requests')\n        .select('middle_manager_status, final_manager_status')\n        .eq('id', requestId)\n        .single()\n\n      if (!request) {\n        return { success: false, error: 'ìš”ì²­ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' }\n      }\n      \n\n      let updateData: any = {}\n\n      // pending, ëŒ€ê¸°, null, ë¹ˆ ë¬¸ìì—´ ëª¨ë‘ ëŒ€ê¸° ìƒíƒœë¡œ ê°„ì£¼\n      const isPending = (status: any) => (\n        status === 'pending' || status === 'ëŒ€ê¸°' || status === '' || status === null || status === undefined\n      )\n\n      // app_adminì€ í˜„ì¬ í•„ìš”í•œ ìŠ¹ì¸ ë‹¨ê³„ë¥¼ ì²˜ë¦¬\n      if (roles.includes('app_admin')) {\n        if (isPending(request.middle_manager_status)) {\n          updateData = {\n            middle_manager_status: 'approved'\n          }\n        } else if (request.middle_manager_status === 'approved' && isPending(request.final_manager_status)) {\n          updateData = {\n            final_manager_status: 'approved'\n          }\n        }\n      } else if (roles.includes('middle_manager')) {\n        if (isPending(request.middle_manager_status)) {\n          updateData = {\n            middle_manager_status: 'approved'\n          }\n        }\n      } else if (roles.includes('final_approver') || roles.includes('ceo')) {\n        if (request.middle_manager_status === 'approved' && isPending(request.final_manager_status)) {\n          updateData = {\n            final_manager_status: 'approved'\n          }\n        }\n      } else if (roles.includes('raw_material_manager') || roles.includes('consumable_manager')) {\n        // raw_material_managerì™€ consumable_managerë„ ìµœì¢… ìŠ¹ì¸ ê¶Œí•œì´ ìˆìŒ\n        if (request.middle_manager_status === 'approved' && isPending(request.final_manager_status)) {\n          updateData = {\n            final_manager_status: 'approved'\n          }\n        }\n      }\n\n      // updateDataê°€ ë¹„ì–´ìˆìœ¼ë©´ ìŠ¹ì¸í•  ë‹¨ê³„ê°€ ì—†ìŒ\n      if (Object.keys(updateData).length === 0) {\n        return { success: false, error: 'ìŠ¹ì¸í•  ìˆ˜ ìˆëŠ” ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.' }\n      }\n      \n\n      const { data: updatedData, error } = await this.supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', requestId)\n        .select()\n        .single()\n\n      if (error) {\n        // Error details are handled by the caller\n        throw error\n      }\n\n      return { success: true }\n    } catch (error) {\n      return { success: false, error: (error as Error).message }\n    }\n  }\n\n  // Helper methods\n  private async getPendingCount(employee: Employee, roles: string[]): Promise<number> {\n    // ê³µí†µ: 'ëŒ€ê¸°', null, ë¹ˆ ë¬¸ìì—´ë„ ëŒ€ê¸° ìƒíƒœë¡œ ê°„ì£¼\n    const pendingClause = (col: string) => (\n      `${col}.in.(pending,ëŒ€ê¸°),${col}.is.null`\n    )\n\n    // ì—­í• ë³„ ì¹´ìš´íŠ¸ ì¿¼ë¦¬ êµ¬ì„±\n    if (roles.includes('app_admin')) {\n      // 1) ì¤‘ê°„ ìŠ¹ì¸ ëŒ€ê¸° + 2) ìµœì¢… ìŠ¹ì¸ ëŒ€ê¸°(ì¤‘ê°„ ìŠ¹ì¸ ì™„ë£Œ) + 3) êµ¬ë§¤ ëŒ€ê¸°(ìµœì¢… ìŠ¹ì¸ ì™„ë£Œ)\n      const [mid, fin, pur] = await Promise.all([\n        this.supabase\n          .from('purchase_requests')\n          .select('id', { count: 'exact', head: true })\n          .or(`middle_manager_status.in.(pending,ëŒ€ê¸°),middle_manager_status.is.null`),\n        this.supabase\n          .from('purchase_requests')\n          .select('id', { count: 'exact', head: true })\n          .eq('middle_manager_status', 'approved')\n          .or(`final_manager_status.in.(pending,ëŒ€ê¸°),final_manager_status.is.null`),\n        this.supabase\n          .from('purchase_requests')\n          .select('id', { count: 'exact', head: true })\n          .eq('final_manager_status', 'approved')\n          .eq('is_payment_completed', false)\n      ])\n\n      const total = (mid.count || 0) + (fin.count || 0) + (pur.count || 0)\n      return total\n    }\n\n    if (roles.includes('middle_manager')) {\n      const { count, error } = await this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .or(`middle_manager_status.in.(pending,ëŒ€ê¸°),middle_manager_status.is.null`)\n\n      if (error) {\n        // Count error for middle_manager - will use 0\n        return 0\n      }\n      return count || 0\n    }\n\n    if (roles.includes('final_approver') || roles.includes('ceo')) {\n      const { count, error } = await this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .eq('middle_manager_status', 'approved')\n        .or(`final_manager_status.in.(pending,ëŒ€ê¸°),final_manager_status.is.null`)\n\n      if (error) {\n        // Count error for final_approver/ceo - will use 0\n        return 0\n      }\n      return count || 0\n    }\n\n    if (roles.includes('lead buyer')) {\n      const { count, error } = await this.supabase\n        .from('purchase_requests')\n        .select('id', { count: 'exact', head: true })\n        .eq('final_manager_status', 'approved')\n        .eq('is_payment_completed', false)\n\n      if (error) {\n        // Count error for lead buyer - will use 0\n        return 0\n      }\n      return count || 0\n    }\n\n    return 0\n  }\n\n  private async getUrgentCount(employee: Employee, roles: string[]): Promise<number> {\n    // ì—­í• ì´ ì—†ìœ¼ë©´ ê¸´ê¸‰ ìš”ì²­ ì¹´ìš´íŠ¸ë„ 0\n    if (roles.length === 0) {\n      return 0\n    }\n\n    const threeDaysAgo = new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString()\n    \n    let query = this.supabase\n      .from('purchase_requests')\n      .select('id', { count: 'exact', head: true })\n      .lt('created_at', threeDaysAgo)\n\n    if (roles.includes('app_admin')) {\n      query = query.or('middle_manager_status.eq.pending,final_manager_status.eq.pending,is_payment_completed.eq.false')\n    } else if (roles.includes('middle_manager')) {\n      query = query.eq('middle_manager_status', 'pending')\n    } else if (roles.includes('final_approver') || roles.includes('ceo')) {\n      query = query\n        .eq('middle_manager_status', 'approved')\n        .eq('final_manager_status', 'pending')\n    } else if (roles.includes('lead buyer')) {\n      query = query\n        .eq('final_manager_status', 'approved')\n        .eq('is_payment_completed', false)\n    } else {\n      return 0\n    }\n\n    const { count } = await query\n    return count || 0\n  }\n\n  private async getTodayActionsCount(employee: Employee, today: string): Promise<number> {\n    // middle_manager_idì™€ final_manager_id ì»¬ëŸ¼ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ\n    // ì˜¤ëŠ˜ ì—…ë°ì´íŠ¸ëœ ìš”ì²­ ì¤‘ í•´ë‹¹ ì§ì›ì´ ìš”ì²­í•œ ìš”ì²­ë§Œ ì¹´ìš´íŠ¸\n    const tomorrow = new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString().split('T')[0]\n    \n    const { count } = await this.supabase\n      .from('purchase_requests')\n      .select('id', { count: 'exact', head: true })\n      .gte('updated_at', today)\n      .lt('updated_at', tomorrow)\n      .eq('requester_name', employee.name)\n\n    return count || 0\n  }\n\n  // ì „ì²´ ì…ê³ ëŒ€ê¸° ê±´ìˆ˜ ì¡°íšŒ (ê¶Œí•œì— ê´€ê³„ì—†ì´ ì „ì²´ ì¡°íšŒ)\n  async getTotalDeliveryWaitingCount(): Promise<number> {\n    const { count } = await this.supabase\n      .from('purchase_requests')\n      .select('id', { count: 'exact', head: true })\n      .eq('is_received', false)\n      .or('is_payment_completed.eq.true,progress_type.ilike.%ì„ ì§„í–‰%')\n\n    return count || 0\n  }\n\n  private calculateProgress(request: any): number {\n    let progress = 0\n    \n    if (request.middle_manager_status === 'approved') progress += 25\n    if (request.final_manager_status === 'approved') progress += 25\n    if (request.is_payment_completed) progress += 25\n    if (request.is_received) progress += 25\n    \n    return progress\n  }\n\n  private getCurrentStep(request: any): 'approval' | 'purchase' | 'delivery' | 'payment' | 'completed' {\n    if (request.is_received) return 'completed'\n    if (request.is_payment_completed) return 'delivery'\n    if (request.final_manager_status === 'approved') return 'purchase'\n    return 'approval'\n  }\n\n  private getNextAction(request: any): string {\n    if (request.middle_manager_status === 'pending') return 'ì¤‘ê°„ ìŠ¹ì¸ ëŒ€ê¸° ì¤‘'\n    if (request.final_manager_status === 'pending') return 'ìµœì¢… ìŠ¹ì¸ ëŒ€ê¸° ì¤‘'\n    if (!request.is_payment_completed) return 'êµ¬ë§¤ ì²˜ë¦¬ ëŒ€ê¸° ì¤‘'\n    if (!request.is_received) return 'ì…ê³  ëŒ€ê¸° ì¤‘'\n    return 'ì™„ë£Œ'\n  }\n\n  private estimateCompletion(request: any): string {\n    const created = new Date(request.created_at)\n    const today = new Date()\n    const daysPassed = Math.floor((today.getTime() - created.getTime()) / (1000 * 60 * 60 * 24))\n    \n    // í‰ê·  ì²˜ë¦¬ ì‹œê°„ì„ ê¸°ë°˜ìœ¼ë¡œ ì˜ˆìƒ ì™„ë£Œì¼ ê³„ì‚°\n    let estimatedDays = 7 // ê¸°ë³¸ 7ì¼\n    if (request.progress_type === 'ê¸´ê¸‰') estimatedDays = 3\n    \n    const estimatedCompletion = new Date(created.getTime() + estimatedDays * 24 * 60 * 60 * 1000)\n    return estimatedCompletion.toLocaleDateString('ko-KR')\n  }\n\n  // lead buyerë¥¼ ìœ„í•œ ë¯¸ë‹¤ìš´ë¡œë“œ ë°œì£¼ì„œ ëª©ë¡ ì¡°íšŒ\n  async getUndownloadedOrders(employee: Employee): Promise<PurchaseRequestWithDetails[]> {\n    const roles = this.parseRoles(employee.purchase_role)\n    \n    // lead buyer ë˜ëŠ” \"lead buyer\" (ê³µë°± í¬í•¨) ê¶Œí•œ ì²´í¬\n    if (!roles.includes('lead buyer') && !roles.includes('lead buyer')) {\n      return []\n    }\n\n    // ë¨¼ì € ëª¨ë“  ë°œì£¼ì„œë¥¼ ê°€ì ¸ì˜¨ ë‹¤ìŒ í´ë¼ì´ì–¸íŠ¸ì—ì„œ í•„í„°ë§\n    const { data, error } = await this.supabase\n      .from('purchase_requests')\n      .select('*,purchase_request_items(id,item_name,specification,quantity,unit_price_value,amount_value)')\n      .order('created_at', { ascending: false })\n      .limit(100)\n\n    if (error) {\n      logger.error('Failed to fetch undownloaded orders', error)\n      return []\n    }\n\n    // í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ í•„í„°ë§\n    // ì¡°ê±´: (ì„ ì§„í–‰ì´ê±°ë‚˜ ìµœì¢…ìŠ¹ì¸ ì™„ë£Œ) AND (is_po_downloadê°€ false ë˜ëŠ” null)\n    const filteredData = (data || []).filter((item: any) => {\n      // ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥ ì¡°ê±´ ì²´í¬\n      const isDownloadable = item.progress_type === 'ì„ ì§„í–‰' || \n        (item.middle_manager_status === 'approved' && item.final_manager_status === 'approved')\n      \n      // ì•„ì§ ë‹¤ìš´ë¡œë“œ ì•ˆ ëœ ê²ƒë§Œ\n      const notDownloaded = !item.is_po_download || item.is_po_download === false || item.is_po_download === null\n      \n      return isDownloadable && notDownloaded\n    })\n\n    // ì˜¤ë˜ëœ ìˆœìœ¼ë¡œ ì •ë ¬ (created_at ê¸°ì¤€ ì˜¤ë¦„ì°¨ìˆœ)\n    filteredData.sort((a: any, b: any) => new Date(a.created_at).getTime() - new Date(b.created_at).getTime())\n\n    return filteredData.slice(0, 10) // ìƒìœ„ 10ê°œë§Œ ë°˜í™˜\n  }\n}\n\nexport const dashboardService = new DashboardService()","import { useState, useEffect } from 'react'\nimport { \n  Dialog, \n  DialogContent,\n  DialogHeader,\n  DialogTitle\n} from '@/components/ui/dialog'\nimport { Button } from '@/components/ui/button'\nimport { DatePickerPopover } from '@/components/ui/date-picker-popover'\nimport { \n  ShoppingCart, \n  Truck, \n  Package, \n  CheckCircle,\n  Clock,\n  ArrowRight,\n  X,\n  CheckCircle2\n} from 'lucide-react'\nimport { useNavigate } from 'react-router-dom'\nimport { createClient } from '@/lib/supabase/client'\nimport { toast } from 'sonner'\nimport { logger } from '@/lib/logger'\n\ninterface PurchaseStatusModalProps {\n  isOpen: boolean\n  onClose: () => void\n  item: any\n  type: 'pending' | 'purchase' | 'delivery' | 'completed'\n  onRefresh?: () => void\n}\n\nexport default function PurchaseStatusModal({ \n  isOpen, \n  onClose, \n  item, \n  type,\n  onRefresh\n}: PurchaseStatusModalProps) {\n  const navigate = useNavigate()\n  const supabase = createClient()\n  const [currentUserRoles, setCurrentUserRoles] = useState<string[]>([])\n  const [processing, setProcessing] = useState(false)\n  const [localItem, setLocalItem] = useState(item)\n\n  // localItemì„ item prop ë³€ê²½ ì‹œ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    setLocalItem(item)\n  }, [item])\n\n  // Get current user roles\n  useEffect(() => {\n    const fetchUserRoles = async () => {\n      const { data: { user } } = await supabase.auth.getUser()\n      \n      if (user?.email) {\n        const { data: employee } = await supabase\n          .from('employees')\n          .select('purchase_role')\n          .eq('email', user.email)\n          .single()\n        \n        \n        if (employee?.purchase_role) {\n          // purchase_roleì´ ì´ë¯¸ ë°°ì—´ì´ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©, ë¬¸ìì—´ì´ë©´ split\n          const roles = Array.isArray(employee.purchase_role) \n            ? employee.purchase_role \n            : employee.purchase_role.split(',').map((r: string) => r.trim())\n          setCurrentUserRoles(roles)\n        } else {\n        }\n      }\n    }\n    fetchUserRoles()\n  }, [type])\n\n  // êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ í•¨ìˆ˜ (ì‘ë™í•˜ëŠ” ë²„ì „)\n  const handlePurchaseComplete = async (itemId: string) => {\n    logger.debug('ğŸ–±ï¸ êµ¬ë§¤ì™„ë£Œ ë²„íŠ¼ í´ë¦­ë¨', {\n      itemId: itemId,\n      timestamp: new Date().toISOString()\n    })\n    \n    if (!confirm('ì´ í’ˆëª©ì„ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n      logger.debug('âŒ ì‚¬ìš©ìê°€ êµ¬ë§¤ì™„ë£Œ í™•ì¸ ì·¨ì†Œ')\n      return\n    }\n    \n    logger.debug('âœ… êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ ì‹œì‘', { itemId: itemId })\n    \n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({ \n          is_payment_completed: true,\n          payment_completed_at: new Date().toISOString()\n        })\n        .eq('id', itemId)\n\n      if (error) throw error\n      \n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\n      setLocalItem((prev: any) => ({\n        ...prev,\n        purchase_request_items: prev.purchase_request_items?.map((item: any) =>\n          item.id === itemId \n            ? { ...item, is_payment_completed: true, payment_completed_at: new Date().toISOString() }\n            : item\n        )\n      }))\n      \n      logger.debug('âœ… êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ ì„±ê³µ', { itemId: itemId })\n      toast.success('í’ˆëª© êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      onRefresh?.()\n    } catch (error) {\n      logger.error('âŒ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨', error, { itemId: itemId })\n      toast.error('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  // ë‚ ì§œ ì„ íƒ í›„ ì…ê³ ì™„ë£Œ ì²˜ë¦¬ í•¨ìˆ˜\n  const handleDateSelect = async (selectedDate: Date, itemId: string) => {\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({ \n          is_received: true,\n          received_at: new Date().toISOString(),\n          actual_received_date: selectedDate.toISOString()\n        })\n        .eq('id', itemId)\n\n      if (error) throw error\n      \n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\n      setLocalItem(prev => ({\n        ...prev,\n        purchase_request_items: prev.purchase_request_items?.map((item: any) =>\n          item.id === itemId ? { \n            ...item, \n            is_received: true, \n            received_at: new Date().toISOString(),\n            actual_received_date: selectedDate.toISOString()\n          } : item\n        ) || []\n      }))\n      \n      toast.success('ì…ê³ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      if (onRefresh) onRefresh()\n    } catch (error) {\n      toast.error('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  if (!localItem) return null\n\n  const items = localItem.purchase_request_items || []\n  const totalAmount = items.reduce((sum: number, i: any) => {\n    return sum + (Number(i.amount_value) || 0)\n  }, 0)\n  const totalQuantity = items.reduce((sum: number, i: any) => {\n    return sum + (Number(i.quantity) || 0)\n  }, 0)\n  \n  // ğŸš¨ ê¸´ê¸‰ ë””ë²„ê¹… - ëª¨ë‹¬ ì§„ì… ì‹œì \n  logger.debug('ğŸš¨ PurchaseStatusModal ê¸´ê¸‰ ë””ë²„ê¹…', {\n    type: `\"${type}\"`,\n    typeType: typeof type,\n    currentUserRoles,\n    item: localItem.purchase_order_number,\n    showPurchaseButton: type === 'purchase',\n    showDeliveryButton: type === 'delivery',\n    hasAdminPermission: currentUserRoles.includes('app_admin'),\n    hasLeadBuyerPermission: currentUserRoles.includes('lead buyer'),\n    leadBuyerCheck: currentUserRoles.some(role => role.trim().toLowerCase() === 'lead buyer'),\n    itemData: {\n      is_payment_completed: localItem.is_payment_completed,\n      is_received: localItem.is_received\n    },\n    shouldShowPurchaseColumn: type === 'purchase',\n    actualTypeValue: JSON.stringify(type)\n  })\n\n  const getTypeInfo = () => {\n    switch (type) {\n      case 'pending':\n        return {\n          icon: <Clock className=\"w-6 h-6 text-orange-600\" />,\n          title: 'ìŠ¹ì¸ ëŒ€ê¸°',\n          status: 'ìŠ¹ì¸ ì²˜ë¦¬ ëŒ€ê¸°ì¤‘',\n          color: 'bg-orange-50 text-orange-700 border-orange-200'\n        }\n      case 'purchase':\n        return {\n          icon: <ShoppingCart className=\"w-6 h-6 text-yellow-600\" />,\n          title: 'êµ¬ë§¤ ëŒ€ê¸°',\n          status: 'êµ¬ë§¤ ì²˜ë¦¬ ëŒ€ê¸°ì¤‘',\n          color: 'bg-yellow-50 text-yellow-700 border-yellow-200'\n        }\n      case 'delivery':\n        return {\n          icon: <Truck className=\"w-6 h-6 text-blue-600\" />,\n          title: 'ì…ê³  ëŒ€ê¸°',\n          status: 'ì…ê³  ì²˜ë¦¬ ëŒ€ê¸°ì¤‘',\n          color: 'bg-blue-50 text-blue-700 border-blue-200'\n        }\n      case 'completed':\n        return {\n          icon: <CheckCircle className=\"w-6 h-6 text-green-600\" />,\n          title: 'ì²˜ë¦¬ ì™„ë£Œ',\n          status: 'ëª¨ë“  ì²˜ë¦¬ ì™„ë£Œ',\n          color: 'bg-green-50 text-green-700 border-green-200'\n        }\n      default:\n        return {\n          icon: <Package className=\"w-6 h-6 text-gray-600\" />,\n          title: 'ìƒíƒœ í™•ì¸',\n          status: 'ìƒíƒœ í™•ì¸ í•„ìš”',\n          color: 'bg-gray-50 text-gray-700 border-gray-200'\n        }\n    }\n  }\n\n  const typeInfo = getTypeInfo()\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent \n        className=\"overflow-hidden bg-white rounded-3xl shadow-2xl border-0\"\n        style={{ maxWidth: '1280px', width: '90vw', maxHeight: '50vh' }}\n        showCloseButton={false}\n      >\n        <DialogHeader className=\"sr-only\">\n          <DialogTitle>ë°œì£¼ ì§„í–‰ ìƒíƒœ</DialogTitle>\n        </DialogHeader>\n        {/* Apple-style Header */}\n        <div className=\"relative px-6 pt-6 pb-4\">\n          <button\n            onClick={onClose}\n            className=\"absolute right-6 top-6 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-all duration-200\"\n          >\n            <X className=\"w-4 h-4 text-gray-500\" />\n          </button>\n          \n          <div className=\"pr-16\">\n            <div className=\"flex items-start gap-4 mb-2\">\n              <div className=\"w-10 h-10 rounded-2xl bg-blue-50 flex items-center justify-center flex-shrink-0\">\n                {typeInfo.icon}\n              </div>\n              <div className=\"min-w-0 flex-1\">\n                <h1 className=\"modal-title mb-1\">\n                  {localItem.purchase_order_number || 'POë²ˆí˜¸ ì—†ìŒ'}\n                </h1>\n                <p className=\"modal-subtitle\">{localItem.vendor_name || 'ì—…ì²´ëª… ì—†ìŒ'}</p>\n              </div>\n              <div className={`px-3 py-1.5 business-radius-badge badge-text ${typeInfo.color}`}>\n                {typeInfo.title}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Apple-style Content */}\n        <div className=\"overflow-y-auto max-h-[calc(50vh-160px)] px-6 pb-4 space-y-3\">\n          \n          {/* Dense Basic Information Grid */}\n          <div className=\"bg-gray-50 rounded-xl p-3 border border-gray-100\">\n            <div className=\"grid grid-cols-3 gap-x-4 gap-y-2 text-xs\">\n              <div><span className=\"modal-label\">ìš”ì²­ì:</span> <span className=\"modal-value\">{localItem.requester_name}</span></div>\n              <div><span className=\"modal-label\">ìš”ì²­ì¼:</span> <span className=\"modal-value\">{new Date(localItem.request_date || localItem.created_at).toLocaleDateString('ko-KR')}</span></div>\n              <div><span className=\"modal-label\">ë‚©ê¸°ìš”ì²­ì¼:</span> <span className=\"modal-value\">{localItem.delivery_request_date ? new Date(localItem.delivery_request_date).toLocaleDateString('ko-KR') : 'ë¯¸ì§€ì •'}</span></div>\n              \n              <div><span className=\"modal-label\">ì—…ì²´ëª…:</span> <span className=\"modal-value\">{localItem.vendor_name || '-'}</span></div>\n              <div><span className=\"modal-label\">ê²°ì œìœ í˜•:</span> <span className=\"modal-value\">{localItem.payment_category || 'ì¼ë°˜'}</span></div>\n              <div><span className=\"modal-label\">ì§„í–‰êµ¬ë¶„:</span> <span className=\"modal-value\">{localItem.progress_type || 'ì¼ë°˜'}</span></div>\n              \n              <div><span className=\"modal-label\">í”„ë¡œì íŠ¸ì—…ì²´:</span> <span className=\"modal-value\">{localItem.project_vendor || '-'}</span></div>\n              <div><span className=\"modal-label\">íŒë§¤ì£¼ë¬¸ë²ˆí˜¸:</span> <span className=\"modal-value\">{localItem.sales_order_number || '-'}</span></div>\n              <div><span className=\"modal-label\">ë°°ì†¡ì§€:</span> <span className=\"modal-value\">{localItem.shipping_address || 'ë³¸ì‚¬'}</span></div>\n              \n              <div><span className=\"modal-label\">í†µí™”:</span> <span className=\"modal-value\">{localItem.currency || 'KRW'}</span></div>\n              <div><span className=\"modal-label\">í…œí”Œë¦¿:</span> <span className=\"modal-value\">{localItem.po_template_type || 'ì¼ë°˜'}</span></div>\n              {localItem.revised_delivery_request_date && (\n                <div><span className=\"modal-label text-orange-500\">ë³€ê²½ì…ê³ ì¼:</span> <span className=\"modal-value text-orange-900\">{new Date(localItem.revised_delivery_request_date).toLocaleDateString('ko-KR')}</span></div>\n              )}\n            </div>\n          </div>\n\n\n          {/* Compact Items Table */}\n          <div className=\"bg-white rounded-xl border border-gray-100 overflow-hidden\">\n            <div className=\"bg-gray-50 px-3 py-2 border-b border-gray-100\">\n              <h3 className=\"modal-section-title text-gray-700\">ì£¼ë¬¸ í’ˆëª© ({items.length}ê°œ, ì´ â‚©{totalAmount.toLocaleString()})</h3>\n            </div>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full text-xs table-fixed\">\n                <colgroup>\n                  <col className=\"w-[25%]\" />\n                  <col className=\"w-[20%]\" />\n                  <col className=\"w-[10%]\" />\n                  <col className=\"w-[15%]\" />\n                  <col className=\"w-[15%]\" />\n                  {(type === 'delivery' || type === 'purchase') && <col className=\"w-[15%]\" />}\n                </colgroup>\n                <thead className=\"bg-gray-50 border-b border-gray-100\">\n                  <tr>\n                    <th className=\"text-left p-2 modal-label text-gray-600\">í’ˆëª©ëª…</th>\n                    <th className=\"text-left p-2 modal-label text-gray-600\">ê·œê²©</th>\n                    <th className=\"text-right p-2 modal-label text-gray-600\">ìˆ˜ëŸ‰</th>\n                    <th className=\"text-right p-2 modal-label text-gray-600\">ë‹¨ê°€</th>\n                    <th className=\"text-right p-2 modal-label text-gray-600\">ê¸ˆì•¡</th>\n                    {type === 'delivery' && <th className=\"text-center p-2 modal-label text-gray-600\">ì…ê³ ìƒíƒœ</th>}\n                    {type === 'purchase' && <th className=\"text-center p-2 modal-label text-gray-600\">êµ¬ë§¤ìƒíƒœ</th>}\n                  </tr>\n                </thead>\n                <tbody className=\"divide-y divide-gray-100\">\n                  {items.map((pItem: any, index: number) => {\n                    const unitPrice = pItem.quantity > 0 ? (Number(pItem.amount_value) || 0) / pItem.quantity : 0\n                    return (\n                      <tr key={index} className=\"hover:bg-gray-50\">\n                        <td className=\"p-2\">\n                          <div className=\"modal-value text-gray-900\">{pItem.item_name || 'í’ˆëª©ëª… ì—†ìŒ'}</div>\n                          {pItem.remark && (\n                            <div className=\"text-xs text-amber-600 mt-1\">ë¹„ê³ : {pItem.remark}</div>\n                          )}\n                        </td>\n                        <td className=\"p-2 text-gray-600\">{pItem.specification || '-'}</td>\n                        <td className=\"p-2 text-right modal-value\">{pItem.quantity || 0}</td>\n                        <td className=\"p-2 text-right\">â‚©{unitPrice.toLocaleString()}</td>\n                        <td className=\"p-2 text-right modal-value\">â‚©{(Number(pItem.amount_value) || 0).toLocaleString()}</td>\n                        {type === 'delivery' && (\n                          <td className=\"p-2 text-center\">\n                            {pItem.actual_received_date ? (\n                              <span className=\"inline-flex items-center gap-1 bg-green-50 text-green-700 px-2 py-1 business-radius-badge text-xs border border-green-200\">\n                                <CheckCircle2 className=\"w-3 h-3\" />\n                                ì™„ë£Œ\n                              </span>\n                            ) : (\n                              (currentUserRoles.includes('app_admin') || \n                               currentUserRoles.includes('requester')) && (\n                                <DatePickerPopover\n                                  onDateSelect={(date) => handleDateSelect(date, pItem.id)}\n                                  placeholder=\"ì‹¤ì œ ì…ê³ ëœ ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”\"\n                                  align=\"center\"\n                                  side=\"bottom\"\n                                >\n                                  <Button\n                                    size=\"sm\"\n                                    className=\"button-base bg-blue-600 hover:bg-blue-700 text-white\"\n                                  >\n                                    ì…ê³ ì™„ë£Œ\n                                  </Button>\n                                </DatePickerPopover>\n                              )\n                            )}\n                          </td>\n                        )}\n                        {type === 'purchase' && (\n                          <td className=\"p-2 text-center\">\n                            {pItem.is_payment_completed ? (\n                              <span className=\"inline-flex items-center gap-1 bg-green-50 text-green-700 px-2 py-1 business-radius-badge text-xs border border-green-200\">\n                                <CheckCircle2 className=\"w-3 h-3\" />\n                                ì™„ë£Œ\n                              </span>\n                            ) : (\n                              (currentUserRoles.includes('app_admin') || \n                               currentUserRoles.some(role => role.trim().toLowerCase() === 'lead buyer')) && (\n                                <Button\n                                  size=\"sm\"\n                                  onClick={() => handlePurchaseComplete(pItem.id)}\n                                  className=\"button-base bg-yellow-600 hover:bg-yellow-700 text-white\"\n                                >\n                                  êµ¬ë§¤ì™„ë£Œ\n                                </Button>\n                              )\n                            )}\n                          </td>\n                        )}\n                      </tr>\n                    )\n                  })}\n                </tbody>\n              </table>\n            </div>\n          </div>\n\n          {/* Compact Delivery Progress */}\n          {type === 'delivery' && items.length > 1 && (\n            <div className=\"bg-blue-50 rounded-xl p-3 border border-blue-100\">\n              {(() => {\n                const receivedCount = items.filter((i: any) => i.actual_received_date).length\n                const totalCount = items.length\n                const percentage = (receivedCount / totalCount) * 100\n                \n                return (\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"modal-value text-blue-700\">ì…ê³  ì§„í–‰ë¥ </div>\n                    <div className=\"flex-1 bg-blue-200 rounded-full h-2\">\n                      <div \n                        className=\"bg-blue-600 h-2 rounded-full transition-all duration-500\"\n                        style={{ width: `${percentage}%` }}\n                      />\n                    </div>\n                    <div className=\"modal-value text-blue-700\">{receivedCount}/{totalCount} ({percentage.toFixed(0)}%)</div>\n                  </div>\n                )\n              })()}\n            </div>\n          )}\n\n        </div>\n        \n        {/* Apple-style Action Bar */}\n        <div className=\"sticky bottom-0 bg-white border-t border-gray-100 px-6 py-6\">\n          <div className=\"flex items-center justify-between gap-6\">\n            {/* Purchase Complete Button - for purchase type with permissions */}\n            {type === 'purchase' && \n             (currentUserRoles.includes('app_admin') || \n              currentUserRoles.some(role => role.trim().toLowerCase() === 'lead buyer')) && (\n              <Button\n                onClick={async () => {\n                  setProcessing(true)\n                  try {\n                    const { error } = await supabase\n                      .from('purchase_requests')\n                      .update({ \n                        is_payment_completed: true,\n                        payment_completed_at: new Date().toISOString()\n                      })\n                      .eq('id', localItem.id)\n\n                    if (error) throw error\n                    \n                    setLocalItem((prev: any) => ({\n                      ...prev,\n                      is_payment_completed: true,\n                      payment_completed_at: new Date().toISOString()\n                    }))\n                    \n                    toast.success('êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n                    onRefresh?.()\n                  } catch (error) {\n                    toast.error('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n                  } finally {\n                    setProcessing(false)\n                  }\n                }}\n                disabled={processing}\n                className=\"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-8 py-4 rounded-2xl shadow-lg transition-all duration-200 modal-subtitle\"\n              >\n                {processing ? (\n                  <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-3\" />\n                ) : (\n                  <CheckCircle2 className=\"w-5 h-5 mr-3\" />\n                )}\n                êµ¬ë§¤ ì™„ë£Œ ì²˜ë¦¬\n              </Button>\n            )}\n\n            <div className=\"flex items-center gap-4 ml-auto\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  navigate(`/purchase?highlight=${localItem.id}`)\n                  onClose()\n                }}\n                className=\"border-gray-300 text-gray-700 hover:bg-gray-50 hover:text-gray-900 hover:border-gray-400 px-8 py-4 rounded-2xl modal-subtitle transition-all duration-200\"\n              >\n                ë°œì£¼ ëª©ë¡ì—ì„œ ë³´ê¸°\n                <ArrowRight className=\"w-5 h-5 ml-3\" />\n              </Button>\n              <Button \n                onClick={onClose} \n                className=\"bg-gray-900 hover:bg-gray-800 text-white px-10 py-4 rounded-2xl modal-subtitle transition-all duration-200 shadow-lg\"\n              >\n                ì™„ë£Œ\n              </Button>\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n      \n    </Dialog>\n  )\n}","\nimport { useState, useEffect, useCallback } from 'react'\nimport { useAuth } from '@/contexts/AuthContext'\nimport { dashboardService } from '@/services/dashboardService'\nimport { createClient } from '@/lib/supabase/client'\nimport { updatePurchaseInMemory } from '@/services/purchaseDataLoader'\nimport { Button } from '@/components/ui/button'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { Input } from '@/components/ui/input'\nimport { Clock, CheckCircle, ArrowRight, X, Package, Truck, ShoppingCart, Download, Search } from 'lucide-react'\nimport ExcelJS from 'exceljs'\n\n// Import modals\nimport PurchaseDetailModal from '@/components/purchase/PurchaseDetailModal'\nimport PurchaseStatusModal from '@/components/dashboard/PurchaseStatusModal'\nimport { toast } from 'sonner'\nimport type { DashboardData, Purchase } from '@/types/purchase'\nimport { useNavigate } from 'react-router-dom'\nimport { logger } from '@/lib/logger'\n\nexport default function DashboardMain() {\n  const [data, setData] = useState<DashboardData | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [actionLoading, setActionLoading] = useState<string | null>(null)\n  const [selectedApprovalId, setSelectedApprovalId] = useState<number | null>(null)\n  const [isModalOpen, setIsModalOpen] = useState(false)\n  const [currentUserRoles, setCurrentUserRoles] = useState<string[]>([])\n  const [undownloadedOrders, setUndownloadedOrders] = useState<any[]>([])\n  const [downloadingIds, setDownloadingIds] = useState<Set<string>>(new Set())\n  const [selectedOrder, setSelectedOrder] = useState<any>(null)\n  const [isOrderModalOpen, setIsOrderModalOpen] = useState(false)\n  \n  const supabase = createClient()\n  \n  // êµ¬ë§¤/ì…ê³  ìƒì„¸ ëª¨ë‹¬ ìƒíƒœ\n  const [selectedStatusItem, setSelectedStatusItem] = useState<any>(null)\n  const [statusModalType, setStatusModalType] = useState<'purchase' | 'delivery' | 'completed' | null>(null)\n  const [isStatusModalOpen, setIsStatusModalOpen] = useState(false)\n  \n  // ê²€ìƒ‰ ìƒíƒœ\n  const [searchTerms, setSearchTerms] = useState({\n    undownloaded: '',\n    pending: '',\n    purchase: '',\n    delivery: ''\n  })\n  \n  const navigate = useNavigate()\n  const { employee, currentUserRoles: userRoles } = useAuth()\n\n  const loadDashboardData = useCallback(async (showLoading = true, forceRefresh = false) => {\n    if (!employee) {\n      logger.error('[DashboardMain] No employee data available')\n      if (showLoading) {\n        setLoading(false)\n      }\n      return\n    }\n\n    try {\n      if (showLoading && !forceRefresh && !data) {\n        setLoading(true)\n      }\n      \n      const dashboardData = await dashboardService.getDashboardData(employee, forceRefresh)\n      setData(dashboardData)\n      setCurrentUserRoles(userRoles)\n      \n      // lead buyerì¸ ê²½ìš° ë¯¸ë‹¤ìš´ë¡œë“œ í•­ëª© ì¡°íšŒ\n      if (userRoles.includes('lead buyer')) {\n        try {\n          const undownloaded = await dashboardService.getUndownloadedOrders(employee)\n          setUndownloadedOrders(undownloaded)\n        } catch (undownloadedError) {\n          // ë¯¸ë‹¤ìš´ë¡œë“œ í•­ëª© ì¡°íšŒ ì‹¤íŒ¨ëŠ” ì¹˜ëª…ì ì´ì§€ ì•Šìœ¼ë¯€ë¡œ ê³„ì† ì§„í–‰\n        }\n      }\n    } catch (error) {\n      logger.error('[DashboardMain] Failed to load dashboard data:', error)\n      toast.error('ëŒ€ì‹œë³´ë“œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')\n      // ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ë¡œë”© ìƒíƒœ í•´ì œ\n      setLoading(false)\n      // ë¹ˆ ë°ì´í„°ë¼ë„ ì„¤ì •í•´ì„œ UIê°€ ë Œë”ë§ë˜ë„ë¡\n      setData(null)\n    } finally {\n      if (showLoading) {\n        setLoading(false)\n      }\n    }\n  }, [employee, userRoles, data])\n\n  useEffect(() => {\n    loadDashboardData()\n  }, [loadDashboardData])\n\n  const handleQuickApprove = async (requestId: string) => {\n    if (!data?.employee) {\n      toast.error('ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    // ìŠ¹ì¸ í™•ì¸ ë©”ì‹œì§€\n    if (!confirm('ì •ë§ë¡œ ìŠ¹ì¸í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n      return\n    }\n\n    setActionLoading(requestId)\n    \n    // Optimistic Update: ì¦‰ì‹œ UIì—ì„œ ì œê±°\n    const originalData = data\n    setData(prev => {\n      if (!prev) return prev\n      return {\n        ...prev,\n        pendingApprovals: prev.pendingApprovals.filter(item => item.id !== requestId),\n        stats: {\n          ...prev.stats,\n          pending: Math.max(0, prev.stats.pending - 1)\n        }\n      }\n    })\n\n    try {\n      const result = await dashboardService.quickApprove(requestId, data.employee)\n      \n      if (result.success) {\n        toast.success('ìŠ¹ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.')\n        // ì„±ê³µ ì‹œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°ì´í„° ë™ê¸°í™” (UI ê¹œë¹¡ì„ ì—†ì´)\n        setTimeout(() => {\n          loadDashboardData(false)  // falseë¥¼ ì „ë‹¬í•˜ì—¬ ë¡œë”© í™”ë©´ í‘œì‹œ ì•ˆ í•¨\n        }, 1000)\n      } else {\n        // ì‹¤íŒ¨ ì‹œ ì›ë˜ ë°ì´í„°ë¡œ ë¡¤ë°±\n        setData(originalData)\n        toast.error(result.error || 'ìŠ¹ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n      }\n    } catch (error) {\n      // ì—ëŸ¬ ì‹œ ì›ë˜ ë°ì´í„°ë¡œ ë¡¤ë°±\n      setData(originalData)\n      toast.error('ìŠ¹ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    } finally {\n      setActionLoading(null)\n    }\n  }\n\n  const handleStatusClick = (item: any, type: 'purchase' | 'delivery' | 'completed') => {\n    setSelectedStatusItem(item)\n    setStatusModalType(type)\n    setIsStatusModalOpen(true)\n  }\n\n  // ê²€ìƒ‰ í•„í„°ë§ í•¨ìˆ˜\n  const filterItems = (items: any[], searchTerm: string) => {\n    if (!searchTerm.trim()) return items\n    \n    return items.filter(item => {\n      const orderNumber = item.purchase_order_number || ''\n      const vendorName = item.vendor_name || ''\n      const itemsText = (item.purchase_request_items || [])\n        .map((pItem: any) => pItem.item_name || '')\n        .join(' ')\n      \n      return [orderNumber, vendorName, itemsText]\n        .join(' ')\n        .toLowerCase()\n        .includes(searchTerm.toLowerCase())\n    })\n  }\n\n  const handleDownloadExcel = async (purchase: any) => {\n    try {\n      setDownloadingIds(prev => new Set(prev).add(purchase.id))\n      \n      // Excel íŒŒì¼ ìƒì„± (FastPurchaseTableê³¼ ë™ì¼í•œ ë¡œì§)\n      const workbook = new ExcelJS.Workbook()\n      const worksheet = workbook.addWorksheet('ë°œì£¼ì„œ')\n      \n      // í—¤ë” ì„¤ì •\n      worksheet.columns = [\n        { header: 'ë°œì£¼ë²ˆí˜¸', key: 'purchase_order_number', width: 20 },\n        { header: 'ì—…ì²´ëª…', key: 'vendor_name', width: 30 },\n        { header: 'í’ˆëª©ëª…', key: 'item_name', width: 40 },\n        { header: 'ê·œê²©', key: 'specification', width: 30 },\n        { header: 'ìˆ˜ëŸ‰', key: 'quantity', width: 15 },\n        { header: 'ë‹¨ê°€', key: 'unit_price', width: 20 },\n        { header: 'ê¸ˆì•¡', key: 'amount', width: 20 },\n        { header: 'ìš”ì²­ì¼', key: 'request_date', width: 15 },\n        { header: 'ì§„í–‰ìƒíƒœ', key: 'progress_type', width: 15 }\n      ]\n      \n      // ë°ì´í„° ì¶”ê°€\n      const items = purchase.purchase_request_items || []\n      items.forEach((item: any) => {\n        worksheet.addRow({\n          purchase_order_number: purchase.purchase_order_number,\n          vendor_name: purchase.vendor_name || purchase.vendors?.vendor_name || '',\n          item_name: item.item_name || '',\n          specification: item.specification || '',\n          quantity: item.quantity || 0,\n          unit_price: item.unit_price_value || 0,\n          amount: item.amount_value || 0,\n          request_date: purchase.request_date || '',\n          progress_type: purchase.progress_type || ''\n        })\n      })\n      \n      // ìŠ¤íƒ€ì¼ ì ìš©\n      worksheet.getRow(1).font = { bold: true }\n      worksheet.getRow(1).fill = {\n        type: 'pattern',\n        pattern: 'solid',\n        fgColor: { argb: 'FFE0E0E0' }\n      }\n      \n      // íŒŒì¼ ë‹¤ìš´ë¡œë“œ\n      const buffer = await workbook.xlsx.writeBuffer()\n      const blob = new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' })\n      const url = window.URL.createObjectURL(blob)\n      const link = document.createElement('a')\n      link.href = url\n      link.download = `ë°œì£¼ì„œ_${purchase.purchase_order_number}_${new Date().toISOString().slice(0, 10)}.xlsx`\n      link.click()\n      window.URL.revokeObjectURL(url)\n      \n      // lead buyerì¸ ê²½ìš° is_po_downloadë¥¼ trueë¡œ ì—…ë°ì´íŠ¸\n      if (currentUserRoles.includes('lead buyer') || currentUserRoles.includes('lead buyer')) {\n        await supabase\n          .from('purchase_requests')\n          .update({ is_po_download: true })\n          .eq('id', purchase.id)\n        \n        // UIì—ì„œ ì œê±°\n        setUndownloadedOrders(prev => prev.filter(item => item.id !== purchase.id))\n      }\n      \n      toast.success('ë°œì£¼ì„œê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.')\n    } catch (error) {\n      toast.error('ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    } finally {\n      setDownloadingIds(prev => {\n        const newSet = new Set(prev)\n        newSet.delete(purchase.id)\n        return newSet\n      })\n    }\n  }\n\n  const getStepColor = (step: string) => {\n    switch (step) {\n      case 'approval': return 'bg-yellow-100 text-yellow-800'\n      case 'purchase': return 'bg-blue-100 text-blue-800'\n      case 'delivery': return 'bg-purple-100 text-purple-800'\n      case 'completed': return 'bg-green-100 text-green-800'\n      default: return 'bg-gray-100 text-gray-800'\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center\" style={{ minHeight: '400px', backgroundColor: '#f9fafb' }}>\n        <div className=\"text-center\">\n          <div className=\"w-12 h-12 border-3 border-hansl-500 border-t-transparent rounded-full animate-spin mx-auto\" />\n          <p className=\"mt-4 card-subtitle\">ëŒ€ì‹œë³´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...</p>\n          <p className=\"text-xs text-gray-400 mt-2\">Employee: {employee?.name || 'ì—†ìŒ'}</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (!data?.employee) {\n    logger.warn('[DashboardMain] ë°ì´í„° ì—†ìŒ', { \n      hasData: !!data, \n      hasEmployee: !!employee,\n      employeeName: employee?.name,\n      loading \n    })\n    return (\n      <div className=\"flex items-center justify-center\" style={{ minHeight: '400px', backgroundColor: '#f9fafb' }}>\n        <div className=\"text-center bg-white p-8 rounded-lg border border-gray-200 shadow-sm\">\n          <h3 className=\"modal-subtitle mb-2\">ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h3>\n          <p className=\"card-subtitle mb-4\">ë¡œê·¸ì¸ì„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>\n          <div className=\"text-xs text-gray-400 space-y-1\">\n            <p>Employee: {employee?.name || 'ì—†ìŒ'}</p>\n            <p>Loading: {loading ? 'true' : 'false'}</p>\n            <p>Has Data: {data ? 'true' : 'false'}</p>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  // ê¶Œí•œ íŒŒì‹± ë° í‘œì‹œ ì—¬ë¶€ ê²°ì •\n  const roles = Array.isArray(data.employee.purchase_role)\n    ? (data.employee.purchase_role as any[]).map((r: any) => String(r).trim())\n    : (data.employee.purchase_role\n        ? String(data.employee.purchase_role)\n            .split(',')\n            .map((r: string) => r.trim())\n            .filter((r: string) => r.length > 0)\n        : [])\n\n  const canSeeApprovalBox = roles.some((r: string) => ['middle_manager', 'final_approver', 'app_admin', 'raw_material_manager', 'consumable_manager'].includes(r))\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"w-full px-4 lg:px-6\">\n        {/* í—¤ë” */}\n        <div className=\"mb-3\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"page-title\">ëŒ€ì‹œë³´ë“œ</h1>\n              <p className=\"page-subtitle\" style={{marginTop:'-2px',marginBottom:'-4px'}}>Dashboard</p>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"badge-stats border border-gray-300 bg-white text-gray-600\">\n                {new Date().toLocaleDateString('ko-KR', { \n                  month: 'long', \n                  day: 'numeric',\n                  weekday: 'short'\n                })}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        {/* í†µí•© ëŒ€ì‹œë³´ë“œ ê·¸ë¦¬ë“œ */}\n        <div className=\"mb-2\">\n          <h2 className=\"section-title mb-2 flex items-center gap-1.5\">\n            <Package className=\"w-3.5 h-3.5 text-gray-600\" />\n            ì „ì²´ í˜„í™©\n          </h2>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3\">\n          {/* Lead Buyer - ë¯¸ë‹¤ìš´ë¡œë“œ ë°œì£¼ì„œ */}\n          {(currentUserRoles.includes('lead buyer') || currentUserRoles.includes('lead buyer')) && undownloadedOrders.length > 0 && (\n            <Card className=\"w-full col-span-1 row-span-2 border-gray-200 shadow-sm hover:shadow-md transition-shadow\">\n              <CardHeader className=\"py-3 px-4 bg-gray-50 border-b\">\n                <CardTitle className=\"section-title flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Download className=\"w-4 h-4 text-orange-600\" />\n                    <span>ë¯¸ë‹¤ìš´ë¡œë“œ ë°œì£¼ì„œ</span>\n                  </div>\n                  <span className=\"badge-stats bg-orange-100 text-orange-700\">\n                    {undownloadedOrders.length}\n                  </span>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-4\">\n                <div className=\"space-y-3\">\n                  {/* ê²€ìƒ‰ ì…ë ¥ */}\n                  <div className=\"relative\">\n                    <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                    <Input\n                      placeholder=\"ë°œì£¼ë²ˆí˜¸, ì—…ì²´ëª…, í’ˆëª©ìœ¼ë¡œ ê²€ìƒ‰...\"\n                      value={searchTerms.undownloaded}\n                      onChange={(e) => setSearchTerms(prev => ({ ...prev, undownloaded: e.target.value }))}\n                      className=\"pl-10 h-8 text-xs\"\n                    />\n                  </div>\n                  \n                  {/* í•­ëª© ë¦¬ìŠ¤íŠ¸ */}\n                  <div className=\"space-y-2 h-[36rem] overflow-y-auto\">\n                    {filterItems(undownloadedOrders, searchTerms.undownloaded).slice(0, 10).map((item) => {\n                      const items = item.purchase_request_items || []\n                      const firstItem = items[0] || {}\n                      const totalAmount = items.reduce((sum: number, i: any) => {\n                        return sum + (Number(i.amount_value) || 0)\n                      }, 0)\n                      const totalQty = items.reduce((sum: number, i: any) => {\n                        return sum + (Number(i.quantity) || 0)\n                      }, 0)\n                      const daysSince = Math.floor((Date.now() - new Date(item.created_at).getTime()) / (1000 * 60 * 60 * 24))\n                      const isAdvance = item.progress_type === 'ì„ ì§„í–‰'\n                      \n                      return (\n                        <div \n                          key={item.id} \n                          className={`border rounded-lg p-2 transition-all cursor-pointer hover:shadow-sm ${\n                            isAdvance ? 'bg-red-50 hover:bg-red-100 border-red-200' : 'bg-white hover:bg-gray-50 border-gray-200'\n                          }`}\n                          onClick={() => {\n                            setSelectedOrder(item)\n                            setIsOrderModalOpen(true)\n                          }}\n                        >\n                          <div className=\"flex items-center justify-between gap-2\">\n                            <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                              <span className=\"card-title\">\n                                {item.purchase_order_number || `PO-${item.id.slice(0, 8)}`}\n                              </span>\n                              <span className=\"card-subtitle truncate\">\n                                {item.vendor_name || 'ì—…ì²´ëª… ì—†ìŒ'}\n                              </span>\n                              <span className=\"card-description truncate\">\n                                {firstItem.item_name || 'í’ˆëª©'} \n                                {items.length > 1 && (\n                                  <span className=\"text-gray-400\"> ì™¸ {items.length - 1}ê±´</span>\n                                )}\n                              </span>\n                              {daysSince > 3 && (\n                                <span className=\"badge-stats border border-gray-300 bg-white text-gray-600 flex-shrink-0\">\n                                  {daysSince}ì¼\n                                </span>\n                              )}\n                            </div>\n                            <div>\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                className=\"h-7 px-2 badge-text border-orange-200 hover:bg-orange-50\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleDownloadExcel(item)\n                                }}\n                                disabled={downloadingIds.has(item.id)}\n                              >\n                                {downloadingIds.has(item.id) ? (\n                                  <div className=\"w-3 h-3 border border-orange-600 border-t-transparent rounded-full animate-spin\" />\n                                ) : (\n                                  <>\n                                    <Download className=\"w-3 h-3 mr-1\" />\n                                    ë‹¤ìš´ë¡œë“œ\n                                  </>\n                                )}\n                              </Button>\n                            </div>\n                          </div>\n                        </div>\n                      )\n                    })}\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n\n          {/* ìŠ¹ì¸ ëŒ€ê¸° (ìŠ¹ì¸ ê¶Œí•œìë§Œ í‘œì‹œ) */}\n          {canSeeApprovalBox && (\n            <Card className=\"w-full col-span-1 row-span-2\">\n              <CardHeader className=\"pb-2 pt-3\">\n                <div className=\"flex items-center justify-between\">\n                  <CardTitle className=\"section-title flex items-center gap-1.5\">\n                    <Clock className=\"w-3.5 h-3.5 text-orange-500\" />\n                    ìŠ¹ì¸ ëŒ€ê¸°\n                    {data.pendingApprovals.length > 0 && (\n                      <span className=\"badge-stats bg-red-500 text-white h-4 px-1\">\n                        {data.pendingApprovals.length}\n                      </span>\n                    )}\n                  </CardTitle>\n                  {data.pendingApprovals.length > 0 && (\n                    <Button\n                      size=\"sm\"\n                      variant=\"ghost\"\n                      onClick={() => navigate('/purchase')}\n                      className=\"h-6 px-2\"\n                    >\n                      <ArrowRight className=\"w-3 h-3\" />\n                    </Button>\n                  )}\n                </div>\n              </CardHeader>\n              <CardContent className=\"p-3\">\n                {data.pendingApprovals.length === 0 ? (\n                  <div className=\"text-center py-4 text-gray-400\">\n                    <CheckCircle className=\"w-6 h-6 mx-auto mb-1\" />\n                    <p className=\"card-description\">ëŒ€ê¸° í•­ëª© ì—†ìŒ</p>\n                  </div>\n                  ) : (\n                  <div className=\"space-y-3\">\n                    {/* ê²€ìƒ‰ ì…ë ¥ */}\n                    <div className=\"relative\">\n                      <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <Input\n                        placeholder=\"ë°œì£¼ë²ˆí˜¸, ì—…ì²´ëª…, í’ˆëª©ìœ¼ë¡œ ê²€ìƒ‰...\"\n                        value={searchTerms.pending}\n                        onChange={(e) => setSearchTerms(prev => ({ ...prev, pending: e.target.value }))}\n                        className=\"pl-10 h-8 text-xs\"\n                      />\n                    </div>\n                    \n                    {/* í•­ëª© ë¦¬ìŠ¤íŠ¸ */}\n                    <div style={{ maxHeight: '36rem', overflowY: 'auto', display: 'flex', flexDirection: 'column', gap: '0.375rem' }}>\n                      {filterItems(data.pendingApprovals, searchTerms.pending).slice(0, 10).map((approval, index) => {\n                        const items = approval.purchase_request_items || []\n                        const firstItem = items[0] || {}\n                        const totalAmount = approval.total_amount || items.reduce((sum: number, i: any) => sum + (Number(i.amount_value) || 0), 0)\n                        const isAdvance = approval.progress_type === 'ì„ ì§„í–‰'\n                        \n                        return (\n                          <div \n                            key={`approval-${approval.id}`} \n                            className={`border rounded-lg p-2 hover:shadow-sm transition-all cursor-pointer mb-1.5 ${\n                              isAdvance ? 'bg-red-50 border-red-200' : 'hover:bg-orange-50/30'\n                            }`}\n                            style={{ display: 'block' }}\n                            onClick={(e) => {\n                              if ((e.target as HTMLElement).closest('button')) return\n                              setSelectedApprovalId(Number(approval.id))\n                              setIsModalOpen(true)\n                            }}\n                          >\n                            <div className=\"flex items-center justify-between gap-2\">\n                              <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                                <span className=\"card-title\">\n                                  {approval.purchase_order_number}\n                                </span>\n                                <span className=\"card-subtitle truncate\">{approval.vendor_name || 'ì—…ì²´'}</span>\n                                <span className=\"card-description truncate\">\n                                  {firstItem.item_name || 'í’ˆëª©'} {items.length > 1 && `ì™¸ ${items.length - 1}ê±´`}\n                                </span>\n                              </div>\n                              <Button\n                                size=\"sm\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleQuickApprove(approval.id)\n                                }}\n                                disabled={actionLoading === approval.id}\n                                className={`h-7 px-2 text-white badge-text shrink-0 ${\n                                  approval.middle_manager_status === 'approved' \n                                    ? 'bg-blue-600 hover:bg-blue-700' \n                                    : 'bg-green-600 hover:bg-green-700'\n                                }`}\n                              >\n                                {actionLoading === approval.id ? (\n                                  <div className=\"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin\" />\n                                ) : (\n                                  <>\n                                    {approval.middle_manager_status === 'approved' ? 'ìµœì¢…' : '1ì°¨'} ìŠ¹ì¸\n                                  </>\n                                )}\n                              </Button>\n                            </div>\n                          </div>\n                        )\n                      })}\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n          \n\n          {/* êµ¬ë§¤ ëŒ€ê¸°ì¤‘ - Lead Buyerë§Œ í‘œì‹œ */}\n          {currentUserRoles.includes('lead buyer') && (\n            <Card className=\"w-full col-span-1 border-gray-200 shadow-sm hover:shadow-md transition-shadow\">\n              <CardHeader className=\"py-3 px-4 bg-gray-50 border-b\">\n                <CardTitle className=\"section-title flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <ShoppingCart className=\"w-4 h-4 text-yellow-600\" />\n                    <span>êµ¬ë§¤ ëŒ€ê¸°</span>\n                  </div>\n                  {data.myPurchaseStatus && data.myPurchaseStatus.waitingPurchase && data.myPurchaseStatus.waitingPurchase.length > 0 && (\n                    <span className=\"badge-stats bg-yellow-100 text-yellow-700\">\n                      {data.myPurchaseStatus.waitingPurchase.length}\n                    </span>\n                  )}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-4\">\n                {!data.myPurchaseStatus || !data.myPurchaseStatus.waitingPurchase || data.myPurchaseStatus.waitingPurchase.length === 0 ? (\n                  <div className=\"text-center py-12 text-gray-400\">\n                    <ShoppingCart className=\"w-10 h-10 mx-auto mb-3 text-gray-300\" />\n                    <p className=\"card-subtitle\">êµ¬ë§¤ ëŒ€ê¸° í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {/* ê²€ìƒ‰ ì…ë ¥ */}\n                    <div className=\"relative\">\n                      <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <Input\n                        placeholder=\"ë°œì£¼ë²ˆí˜¸, ì—…ì²´ëª…, í’ˆëª©ìœ¼ë¡œ ê²€ìƒ‰...\"\n                        value={searchTerms.purchase}\n                        onChange={(e) => setSearchTerms(prev => ({ ...prev, purchase: e.target.value }))}\n                        className=\"pl-10 h-8 text-xs\"\n                      />\n                    </div>\n                    \n                    {/* í•­ëª© ë¦¬ìŠ¤íŠ¸ */}\n                    <div className=\"space-y-2 h-[36rem] overflow-y-auto\">\n                      {filterItems(data.myPurchaseStatus.waitingPurchase, searchTerms.purchase).slice(0, 10).map((item) => {\n                        const items = item.purchase_request_items || []\n                        const firstItem = items[0]\n                        const totalAmount = items.reduce((sum: number, i: any) => sum + (Number(i.amount_value) || 0), 0)\n                        const isSeonJin = (item.progress_type || '').includes('ì„ ì§„í–‰')\n                        \n                        return (\n                          <div \n                            key={item.id} \n                            className={`border rounded-lg p-3 transition-all hover:shadow-sm ${\n                              isSeonJin ? 'bg-red-50 hover:bg-red-100 border-red-200' : 'bg-white hover:bg-gray-50 border-gray-200'\n                            }`}\n                          >\n                            <div className=\"flex items-center justify-between gap-2\">\n                              <div \n                                className=\"flex items-center gap-2 flex-1 cursor-pointer\"\n                                onClick={() => handleStatusClick(item, 'purchase')}\n                              >\n                                <span className=\"card-title\">\n                                  {item.purchase_order_number || `PO-${item.id.slice(0, 8)}`}\n                                </span>\n                                <span className=\"card-subtitle truncate\">\n                                  {item.vendor_name || 'ì—…ì²´ëª… ì—†ìŒ'}\n                                </span>\n                                <span className=\"card-description truncate\">\n                                  {firstItem?.item_name || 'í’ˆëª©'} \n                                  {items.length > 1 && (\n                                    <span className=\"text-gray-400\"> ì™¸ {items.length - 1}ê±´</span>\n                                  )}\n                                </span>\n                              </div>\n                              \n                              {/* êµ¬ë§¤ì™„ë£Œ ë²„íŠ¼ - Lead Buyer, App Adminë§Œ í‘œì‹œ */}\n                              {(currentUserRoles.includes('lead buyer') || \n                                currentUserRoles.includes('app_admin')) && !item.is_payment_completed && (\n                                <Button\n                                  size=\"sm\"\n                                  onClick={async (e) => {\n                                    e.stopPropagation()\n                                    if (!confirm('ì´ ë°œì£¼ë¥¼ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return\n                                    \n                                    try {\n                                      const { error } = await supabase\n                                        .from('purchase_requests')\n                                        .update({ \n                                          is_payment_completed: true,\n                                          payment_completed_at: new Date().toISOString()\n                                        })\n                                        .eq('id', item.id)\n\n                                      if (error) throw error\n                                      \n                                      toast.success('êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n                                      loadDashboardData(false) // ë°ì´í„° ìƒˆë¡œê³ ì¹¨\n                                    } catch (error) {\n                                      toast.error('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n                                    }\n                                  }}\n                                  className=\"bg-yellow-600 hover:bg-yellow-700 text-white h-7 px-2 badge-text shrink-0\"\n                                >\n                                  êµ¬ë§¤ì™„ë£Œ\n                                </Button>\n                              )}\n                              \n                              {/* ì´ë¯¸ êµ¬ë§¤ì™„ë£Œëœ ê²½ìš° ì™„ë£Œ í‘œì‹œ */}\n                              {item.is_payment_completed && (\n                                <div className=\"bg-green-100 text-green-700 px-2 py-1 business-radius-badge badge-text shrink-0\">\n                                  ì™„ë£Œë¨\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        )\n                      })}\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* ì…ê³  ëŒ€ê¸°ì¤‘ */}\n          <Card className=\"w-full col-span-1 border-gray-200 shadow-sm hover:shadow-md transition-shadow\">\n              <CardHeader className=\"py-3 px-4 bg-gray-50 border-b\">\n                <CardTitle className=\"section-title flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Truck className=\"w-4 h-4 text-blue-600\" />\n                    <span>ì…ê³  ëŒ€ê¸°</span>\n                  </div>\n                  {data.myPurchaseStatus.waitingDelivery.length > 0 && (\n                    <span className=\"badge-stats bg-blue-100 text-blue-700\">\n                      {data.myPurchaseStatus.waitingDelivery.length}\n                    </span>\n                  )}\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-4\">\n                {data.myPurchaseStatus.waitingDelivery.length === 0 ? (\n                  <div className=\"text-center py-12 text-gray-400\">\n                    <Truck className=\"w-10 h-10 mx-auto mb-3 text-gray-300\" />\n                    <p className=\"card-subtitle\">ì…ê³  ëŒ€ê¸° í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {/* ê²€ìƒ‰ ì…ë ¥ */}\n                    <div className=\"relative\">\n                      <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n                      <Input\n                        placeholder=\"ë°œì£¼ë²ˆí˜¸, ì—…ì²´ëª…, í’ˆëª©ìœ¼ë¡œ ê²€ìƒ‰...\"\n                        value={searchTerms.delivery}\n                        onChange={(e) => setSearchTerms(prev => ({ ...prev, delivery: e.target.value }))}\n                        className=\"pl-10 h-8 text-xs\"\n                      />\n                    </div>\n                    \n                    {/* í•­ëª© ë¦¬ìŠ¤íŠ¸ */}\n                    <div className=\"space-y-2 h-[36rem] overflow-y-auto\">\n                      {filterItems(data.myPurchaseStatus.waitingDelivery, searchTerms.delivery).slice(0, 10).map((item) => {\n                        const items = item.purchase_request_items || []\n                        const firstItem = items[0]\n                        const totalItems = items.length\n                        const receivedItems = items.filter((i: any) => i.is_received).length\n                        const progress = totalItems > 0 ? Math.round((receivedItems / totalItems) * 100) : 0\n                        const totalAmount = items.reduce((sum: number, i: any) => sum + (Number(i.amount_value) || 0), 0)\n                        const isSeonJin = (item.progress_type || '').includes('ì„ ì§„í–‰')\n                        \n                        return (\n                          <div \n                            key={item.id} \n                            className={`border rounded-lg p-3 transition-all cursor-pointer hover:shadow-sm ${\n                              isSeonJin ? 'bg-red-50 hover:bg-red-100 border-red-200' : 'bg-white hover:bg-gray-50 border-gray-200'\n                            }`}\n                            onClick={() => handleStatusClick(item, 'delivery')}\n                          >\n                            <div className=\"flex items-center gap-2\">\n                              <span className=\"card-title\">\n                                {item.purchase_order_number || `PO-${item.id.slice(0, 8)}`}\n                              </span>\n                              <span className=\"card-subtitle truncate\">\n                                {item.vendor_name || 'ì—…ì²´ëª… ì—†ìŒ'}\n                              </span>\n                              <span className=\"card-description truncate\">\n                                {firstItem?.item_name || 'í’ˆëª©'} \n                                {totalItems > 1 && (\n                                  <span className=\"text-gray-400\"> ì™¸ {totalItems - 1}ê±´</span>\n                                )}\n                              </span>\n                            </div>\n                          </div>\n                        )\n                      })}\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n          </Card>\n\n        </div>\n\n        {/* ì˜¤ëŠ˜ì˜ ìš”ì•½ - ìƒë‹¨ í†µê³„ì— í†µí•© */}\n      </div>\n      \n      {/* ìŠ¹ì¸ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ */}\n      <PurchaseDetailModal\n        purchaseId={selectedApprovalId}\n        isOpen={isModalOpen}\n        onClose={() => {\n          setIsModalOpen(false)\n          setSelectedApprovalId(null)\n        }}\n        currentUserRoles={currentUserRoles}\n        onRefresh={() => {\n          loadDashboardData()\n          setIsModalOpen(false)\n          setSelectedApprovalId(null)\n        }}\n        onOptimisticUpdate={(purchaseId: number, updater: (prev: Purchase) => Purchase) => {\n          // ë©”ëª¨ë¦¬ ìºì‹œ ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n          updatePurchaseInMemory(purchaseId, updater)\n          // ëŒ€ì‹œë³´ë“œ ë°ì´í„°ë„ ìƒˆë¡œê³ ì¹¨\n          loadDashboardData(false)\n        }}\n      />\n      \n      {/* êµ¬ë§¤/ì…ê³  ìƒíƒœ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ */}\n      <PurchaseStatusModal\n          isOpen={isStatusModalOpen}\n          onClose={() => {\n            setIsStatusModalOpen(false)\n            setSelectedStatusItem(null)\n            setStatusModalType(null)\n          }}\n          item={selectedStatusItem}\n          type={statusModalType as any}\n          onRefresh={() => loadDashboardData(false)}\n      />\n\n      {/* Order Detail Modal - Apple-inspired Design */}\n      {isOrderModalOpen && selectedOrder && (\n        <Dialog open={isOrderModalOpen} onOpenChange={() => {\n          setIsOrderModalOpen(false)\n          setSelectedOrder(null)\n        }}>\n          <DialogContent \n            className=\"overflow-hidden bg-white rounded-3xl shadow-2xl border-0\"\n            style={{ maxWidth: '1280px', width: '90vw', maxHeight: '50vh' }}\n            showCloseButton={false}\n          >\n            <DialogHeader className=\"sr-only\">\n              <DialogTitle>ë°œì£¼ ìš”ì²­ ì„¸ë¶€ì‚¬í•­</DialogTitle>\n            </DialogHeader>\n            {/* Apple-style Header */}\n            <div className=\"relative px-6 pt-6 pb-4\">\n              <button\n                onClick={() => {\n                  setIsOrderModalOpen(false)\n                  setSelectedOrder(null)\n                }}\n                className=\"absolute right-6 top-6 w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-all duration-200\"\n              >\n                <X className=\"w-4 h-4 text-gray-500\" />\n              </button>\n              \n              <div className=\"pr-16\">\n                <div className=\"flex items-start gap-4 mb-2\">\n                  <div className=\"w-10 h-10 rounded-2xl bg-orange-50 flex items-center justify-center flex-shrink-0\">\n                    <Download className=\"w-6 h-6 text-orange-600\" />\n                  </div>\n                  <div className=\"min-w-0 flex-1\">\n                    <h1 className=\"modal-title mb-1\">\n                      {selectedOrder.purchase_order_number || 'POë²ˆí˜¸ ì—†ìŒ'}\n                    </h1>\n                    <p className=\"modal-subtitle\">{selectedOrder.vendor_name || 'ì—…ì²´ëª… ì—†ìŒ'}</p>\n                  </div>\n                  <span className=\"badge-stats bg-orange-50 text-orange-700\">\n                    ë¯¸ë‹¤ìš´ë¡œë“œ\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Apple-style Content */}\n            <div className=\"overflow-y-auto max-h-[calc(50vh-160px)] px-6 pb-4 space-y-3\">\n              \n              {/* Dense Basic Information Grid */}\n              <div className=\"bg-gray-50 rounded-xl p-3 border border-gray-100\">\n                <div className=\"grid grid-cols-3 gap-x-4 gap-y-2 text-xs\">\n                  <div><span className=\"text-gray-500\">ìš”ì²­ì:</span> <span className=\"font-medium\">{selectedOrder.requester_name}</span></div>\n                  <div><span className=\"text-gray-500\">ìš”ì²­ì¼:</span> <span className=\"font-medium\">{new Date(selectedOrder.request_date || selectedOrder.created_at).toLocaleDateString('ko-KR')}</span></div>\n                  <div><span className=\"text-gray-500\">ë‚©ê¸°ìš”ì²­ì¼:</span> <span className=\"font-medium\">{selectedOrder.delivery_request_date ? new Date(selectedOrder.delivery_request_date).toLocaleDateString('ko-KR') : 'ë¯¸ì§€ì •'}</span></div>\n                  \n                  <div><span className=\"text-gray-500\">ì—…ì²´ëª…:</span> <span className=\"font-medium\">{selectedOrder.vendor_name || '-'}</span></div>\n                  <div><span className=\"text-gray-500\">ê²°ì œìœ í˜•:</span> <span className=\"font-medium\">{selectedOrder.payment_category || 'ì¼ë°˜'}</span></div>\n                  <div><span className=\"text-gray-500\">ì§„í–‰êµ¬ë¶„:</span> <span className=\"font-medium\">{selectedOrder.progress_type || 'ì¼ë°˜'}</span></div>\n                  \n                  <div><span className=\"text-gray-500\">í”„ë¡œì íŠ¸ì—…ì²´:</span> <span className=\"font-medium\">{selectedOrder.project_vendor || '-'}</span></div>\n                  <div><span className=\"text-gray-500\">íŒë§¤ì£¼ë¬¸ë²ˆí˜¸:</span> <span className=\"font-medium\">{selectedOrder.sales_order_number || '-'}</span></div>\n                  <div><span className=\"text-gray-500\">ë°°ì†¡ì§€:</span> <span className=\"font-medium\">{selectedOrder.shipping_address || 'ë³¸ì‚¬'}</span></div>\n                  \n                  <div><span className=\"text-gray-500\">í†µí™”:</span> <span className=\"font-medium\">{selectedOrder.currency || 'KRW'}</span></div>\n                  <div><span className=\"text-gray-500\">í…œí”Œë¦¿:</span> <span className=\"font-medium\">{selectedOrder.po_template_type || 'ì¼ë°˜'}</span></div>\n                  {selectedOrder.revised_delivery_request_date && (\n                    <div><span className=\"text-orange-500\">ë³€ê²½ì…ê³ ì¼:</span> <span className=\"font-medium text-orange-900\">{new Date(selectedOrder.revised_delivery_request_date).toLocaleDateString('ko-KR')}</span></div>\n                  )}\n                </div>\n              </div>\n\n              {/* Compact Items Table */}\n              <div className=\"bg-white rounded-xl border border-gray-100 overflow-hidden\">\n                <div className=\"bg-gray-50 px-3 py-2 border-b border-gray-100\">\n                  <h3 className=\"text-sm font-medium text-gray-700\">ì£¼ë¬¸ í’ˆëª© ({(selectedOrder.purchase_request_items || []).length}ê°œ, ì´ â‚©{(selectedOrder.purchase_request_items || []).reduce((sum: number, i: any) => sum + (Number(i.amount_value) || 0), 0).toLocaleString()})</h3>\n                </div>\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full text-xs table-fixed\">\n                    <colgroup>\n                      <col className=\"w-[30%]\" />\n                      <col className=\"w-[25%]\" />\n                      <col className=\"w-[10%]\" />\n                      <col className=\"w-[15%]\" />\n                      <col className=\"w-[20%]\" />\n                    </colgroup>\n                    <thead className=\"bg-gray-50 border-b border-gray-100\">\n                      <tr>\n                        <th className=\"text-left p-2 font-medium text-gray-600\">í’ˆëª©ëª…</th>\n                        <th className=\"text-left p-2 font-medium text-gray-600\">ê·œê²©</th>\n                        <th className=\"text-right p-2 font-medium text-gray-600\">ìˆ˜ëŸ‰</th>\n                        <th className=\"text-right p-2 font-medium text-gray-600\">ë‹¨ê°€</th>\n                        <th className=\"text-right p-2 font-medium text-gray-600\">ê¸ˆì•¡</th>\n                      </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-gray-100\">\n                      {(selectedOrder.purchase_request_items || []).map((pItem: any, index: number) => {\n                        const unitPrice = pItem.quantity > 0 ? (Number(pItem.amount_value) || 0) / pItem.quantity : 0\n                        return (\n                          <tr key={index} className=\"hover:bg-gray-50\">\n                            <td className=\"p-2\">\n                              <div className=\"font-medium text-gray-900\">{pItem.item_name || 'í’ˆëª©ëª… ì—†ìŒ'}</div>\n                              {pItem.remark && (\n                                <div className=\"text-xs text-amber-600 mt-1\">ë¹„ê³ : {pItem.remark}</div>\n                              )}\n                            </td>\n                            <td className=\"p-2 text-gray-600\">{pItem.specification || '-'}</td>\n                            <td className=\"p-2 text-right font-medium\">{pItem.quantity || 0}</td>\n                            <td className=\"p-2 text-right\">â‚©{unitPrice.toLocaleString()}</td>\n                            <td className=\"p-2 text-right font-medium\">â‚©{(Number(pItem.amount_value) || 0).toLocaleString()}</td>\n                          </tr>\n                        )\n                      })}\n                    </tbody>\n                  </table>\n                </div>\n              </div>\n            </div>\n\n            {/* Apple-style Action Bar */}\n            <div className=\"sticky bottom-0 bg-white border-t border-gray-100 px-6 py-6\">\n              <div className=\"flex items-center justify-between gap-6\">\n                <Button\n                  onClick={() => handleDownloadExcel(selectedOrder)}\n                  disabled={downloadingIds.has(selectedOrder.id)}\n                  className=\"bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white px-8 py-4 rounded-2xl shadow-lg transition-all duration-200 modal-subtitle\"\n                >\n                  {downloadingIds.has(selectedOrder.id) ? (\n                    <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-3\" />\n                  ) : (\n                    <Download className=\"w-5 h-5 mr-3\" />\n                  )}\n                  Excel ë‹¤ìš´ë¡œë“œ\n                </Button>\n\n                <div className=\"flex items-center gap-4 ml-auto\">\n                  <Button\n                    variant=\"outline\"\n                    onClick={() => {\n                      navigate(`/purchase/list?tab=purchase`)\n                      setIsOrderModalOpen(false)\n                      setSelectedOrder(null)\n                    }}\n                    className=\"border-gray-300 text-gray-700 hover:bg-gray-50 hover:text-gray-900 hover:border-gray-400 px-8 py-4 rounded-2xl modal-subtitle transition-all duration-200\"\n                  >\n                    ë°œì£¼ ëª©ë¡ì—ì„œ ë³´ê¸°\n                    <ArrowRight className=\"w-5 h-5 ml-3\" />\n                  </Button>\n                  <Button \n                    onClick={() => {\n                      setIsOrderModalOpen(false)\n                      setSelectedOrder(null)\n                    }} \n                    className=\"bg-gray-900 hover:bg-gray-800 text-white px-10 py-4 rounded-2xl modal-subtitle transition-all duration-200 shadow-lg\"\n                  >\n                    ì™„ë£Œ\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n    </div>\n  )\n}"],"names":["ArrowRight","createLucideIcon","d","key","CircleCheck","cx","cy","r","Clock","dashboardCache","data","lastFetch","CACHE_DURATION","employeeId","dashboardService","constructor","this","supabase","createClient","parseRoles","purchaseRole","roles","Array","isArray","map","String","trim","split","filter","length","getDashboardData","employee","forceRefresh","now","Date","id","results","Promise","allSettled","getDashboardStats","getMyRecentRequests","getPendingApprovals","getQuickActions","getTodaySummary","getMyPurchaseStatus","statsResult","myRecentRequestsResult","pendingApprovalsResult","quickActionsResult","todaySummaryResult","myPurchaseStatusResult","stats","status","value","total","myRequests","pending","completed","urgent","todayActions","myRecentRequests","pendingApprovals","quickActions","todaySummary","approved","requested","received","myPurchaseStatus","waitingPurchase","waitingDelivery","recentCompleted","logger","error","reason","dashboardData","urgentRequests","today","toISOString","purchase_role","totalResult","myRequestsResult","pendingResult","completedResult","urgentResult","todayActionsResult","all","from","select","count","head","eq","name","getPendingCount","gte","getFullYear","getMonth","getUrgentCount","getTodayActionsCount","or","order","ascending","limit","item","vendor_name","vendors","total_items","purchase_request_items","progress_percentage","calculateProgress","current_step","getCurrentStep","next_action","getNextAction","estimated_completion","estimateCompletion","allRequests","firstTry","fallback","filteredData","isPending","debug","employeeName","employeeRoles","totalRequests","sampleData","slice","purchase_order_number","middle_manager_status","final_manager_status","middlePending","finalPending","middleRejected","finalRejected","shouldInclude","filteredCount","filteredItems","roleFilteredData","includes","totalItems","beforeFilter","afterFilter","middleApproved","finalApproved","purchasePending","is_payment_completed","result","filteredDataCount","filteredDataIds","enhancedData","async","items","vendor_id","vendor","single","total_amount","reduce","sum","i","Number","amount_value","quantity","unit_price_value","enhancedDataCount","enhancedDataSummary","itemsCount","actions","pendingCount","push","type","label","description","color","purchaseCount","tomorrow","approvedResult","requestedResult","receivedResult","lt","requesterName","email","sevenDaysAgo","allMyRequests","categoryNormalized","payment_category","replace","isPurchaseRequest","notPaid","isSeonJin","progress_type","isIlban","notReceived","is_received","received_at","quickApprove","requestId","request","success","updateData","Object","keys","updatedData","update","message","mid","fin","pur","threeDaysAgo","query","getTotalDeliveryWaitingCount","progress","created","created_at","Math","floor","getTime","estimatedDays","toLocaleDateString","getUndownloadedOrders","isDownloadable","notDownloaded","is_po_download","sort","a","b","PurchaseStatusModal","isOpen","onClose","onRefresh","navigate","useNavigate","currentUserRoles","setCurrentUserRoles","useState","processing","setProcessing","localItem","setLocalItem","useEffect","user","auth","getUser","fetchUserRoles","totalAmount","typeType","showPurchaseButton","showDeliveryButton","hasAdminPermission","hasLeadBuyerPermission","leadBuyerCheck","some","role","toLowerCase","itemData","shouldShowPurchaseColumn","actualTypeValue","JSON","stringify","typeInfo","icon","jsx","className","title","ShoppingCart","Truck","CheckCircle","Package","getTypeInfo","Dialog","open","onOpenChange","children","jsxs","DialogContent","style","maxWidth","width","maxHeight","showCloseButton","DialogHeader","DialogTitle","onClick","X","requester_name","request_date","delivery_request_date","project_vendor","sales_order_number","shipping_address","currency","po_template_type","revised_delivery_request_date","toLocaleString","pItem","index","unitPrice","item_name","remark","specification","actual_received_date","CheckCircle2","DatePickerPopover","onDateSelect","date","selectedDate","itemId","prev","toast","handleDateSelect","placeholder","align","side","Button","size","timestamp","confirm","payment_completed_at","handlePurchaseComplete","receivedCount","totalCount","percentage","toFixed","disabled","variant","DashboardMain","setData","loading","setLoading","actionLoading","setActionLoading","selectedApprovalId","setSelectedApprovalId","isModalOpen","setIsModalOpen","undownloadedOrders","setUndownloadedOrders","downloadingIds","setDownloadingIds","Set","selectedOrder","setSelectedOrder","isOrderModalOpen","setIsOrderModalOpen","selectedStatusItem","setSelectedStatusItem","statusModalType","setStatusModalType","isStatusModalOpen","setIsStatusModalOpen","searchTerms","setSearchTerms","undownloaded","purchase","delivery","userRoles","useAuth","loadDashboardData","useCallback","showLoading","undownloadedError","handleStatusClick","filterItems","searchTerm","join","handleDownloadExcel","add","workbook","ExcelJS","Workbook","worksheet","addWorksheet","columns","header","forEach","addRow","unit_price","amount","getRow","font","bold","fill","pattern","fgColor","argb","buffer","xlsx","writeBuffer","blob","Blob","url","window","URL","createObjectURL","link","document","createElement","href","download","click","revokeObjectURL","newSet","delete","minHeight","backgroundColor","warn","hasData","hasEmployee","canSeeApprovalBox","marginTop","marginBottom","month","day","weekday","Card","CardHeader","CardTitle","Download","CardContent","Search","Input","onChange","e","target","firstItem","daysSince","isAdvance","stopPropagation","has","Fragment","overflowY","display","flexDirection","gap","approval","closest","originalData","max","setTimeout","handleQuickApprove","PurchaseDetailModal","purchaseId","onOptimisticUpdate","updater","updatePurchaseInMemory"],"mappings":";;;;;;GASA,MAIMA,EAAaC,EAAiB,cAJjB,CACjB,CAAC,OAAQ,CAAEC,EAAG,WAAYC,IAAK,WAC/B,CAAC,OAAQ,CAAED,EAAG,gBAAiBC,IAAK,aCEhCC,EAAcH,EAAiB,eAJlB,CACjB,CAAC,SAAU,CAAEI,GAAI,KAAMC,GAAI,KAAMC,EAAG,KAAMJ,IAAK,WAC/C,CAAC,OAAQ,CAAED,EAAG,gBAAiBC,IAAK,aCEhCK,EAAQP,EAAiB,QAJZ,CACjB,CAAC,OAAQ,CAAEC,EAAG,cAAeC,IAAK,WAClC,CAAC,SAAU,CAAEE,GAAI,KAAMC,GAAI,KAAMC,EAAG,KAAMJ,IAAK,aCE3CM,EAAiB,CACrBC,KAAM,KACNC,UAAW,EACXC,eAAgB,IAChBC,WAAY,MA82BP,MAAMC,EAAmB,IA32BzB,MAAA,WAAAC,GACLC,KAAQC,SAAWC,GAAa,CAGxB,UAAAC,CAAWC,GACjB,IAAIC,EAAkB,GAEtB,GAAID,EACF,GAAIE,MAAMC,QAAQH,GAEhBC,EAAQD,EAAaI,IAAKjB,GAAWkB,OAAOlB,GAAGmB,YAC1C,CAILL,EAFmBI,OAAOL,GAGvBO,MAAM,KACNH,IAAKjB,GAAcA,EAAEmB,QACrBE,OAAQrB,GAAcA,EAAEsB,OAAS,EACtC,CAGF,OAAOR,CACT,CAGA,sBAAMS,CAAiBC,EAAoBC,GAAe,GACxD,MAAMC,EAAMC,KAAKD,MAOjB,IANoBD,GACDvB,EAAeC,MACfD,EAAeI,aAAekB,EAASI,IACtCF,EAAMxB,EAAeE,UAAaF,EAAeG,gBAGnDH,EAAeC,KAC/B,OAAOD,EAAeC,KAGxB,MAAM0B,QAAgBC,QAAQC,WAAW,CACvCtB,KAAKuB,kBAAkBR,GACvBf,KAAKwB,oBAAoBT,GACzBf,KAAKyB,oBAAoBV,GACzBf,KAAK0B,gBAAgBX,GACrBf,KAAK2B,gBAAgBZ,GACrBf,KAAK4B,oBAAoBb,KAGrBc,EAAcT,EAAQ,GACtBU,EAAyBV,EAAQ,GACjCW,EAAyBX,EAAQ,GACjCY,EAAqBZ,EAAQ,GAC7Ba,EAAqBb,EAAQ,GAC7Bc,EAAyBd,EAAQ,GAEjCe,EAA+C,cAAvBN,EAAYO,OACtCP,EAAYQ,MACZ,CAAEC,MAAO,EAAGC,WAAY,EAAGC,QAAS,EAAGC,UAAW,EAAGC,OAAQ,EAAGC,aAAc,GAE5EC,EAAwE,cAAlCd,EAAuBM,OAC/DN,EAAuBO,MACvB,GAEEQ,EAAmF,cAAlCd,EAAuBK,OAC1EL,EAAuBM,MACvB,GAEES,EAA4D,cAA9Bd,EAAmBI,OACnDJ,EAAmBK,MACnB,GAEEU,EAA6C,cAA9Bd,EAAmBG,OACpCH,EAAmBI,MACnB,CAAEW,SAAU,EAAGC,UAAW,EAAGC,SAAU,GAErCC,EAAqD,cAAlCjB,EAAuBE,OAC5CF,EAAuBG,MACvB,CAAEe,gBAAiB,GAAIC,gBAAiB,GAAIC,gBAAiB,IAGtC,aAAvBzB,EAAYO,QACdmB,EAAOC,MAAM,2CAA4C3B,EAAY4B,QAEjC,aAAlC3B,EAAuBM,QACzBmB,EAAOC,MAAM,6CAA8C1B,EAAuB2B,QAE9C,aAAlC1B,EAAuBK,QACzBmB,EAAOC,MAAM,6CAA8CzB,EAAuB0B,QAElD,aAA9BzB,EAAmBI,QACrBmB,EAAOC,MAAM,yCAA0CxB,EAAmByB,QAE1C,aAA9BxB,EAAmBG,QACrBmB,EAAOC,MAAM,yCAA0CvB,EAAmBwB,QAEtC,aAAlCvB,EAAuBE,QACzBmB,EAAOC,MAAM,6CAA8CtB,EAAuBuB,QAGpF,MAAMC,EAA+B,CACnC3C,WACAoB,QACAwB,eAAgB,GAChBf,mBACAC,mBACAC,eACAC,eACAI,oBAQF,OAJA1D,EAAeC,KAAOgE,EACtBjE,EAAeE,UAAYsB,EAC3BxB,EAAeI,WAAakB,EAASI,GAE9BuC,CACT,CAGA,uBAAMnC,CAAkBR,GACtB,MAAM6C,GAAA,IAAY1C,MAAO2C,cAAclD,MAAM,KAAK,GAC5CN,EAAQL,KAAKG,WAAWY,EAAS+C,gBAKrCC,EACAC,EACAC,EACAC,EACAC,EACAC,SACQ/C,QAAQgD,IAAI,CAEpBrE,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IAGxCzE,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,iBAAkB3D,EAAS4D,MAGjC3E,KAAK4E,gBAAgB7D,EAAUV,GAG/BL,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,eAAe,GAClBG,IAAI,cAAe,IAAI3D,MAAA,IAASA,MAAO4D,eAAA,IAAmB5D,MAAO6D,WAAY,GAAGlB,eAGnF7D,KAAKgF,eAAejE,EAAUV,GAG9BL,KAAKiF,qBAAqBlE,EAAU6C,KAYtC,MATc,CACZtB,MAAOyB,EAAYS,OAAS,EAC5BjC,WAAYyB,EAAiBQ,OAAS,EACtChC,QAASyB,EACTxB,UAAWyB,EAAgBM,OAAS,EACpC9B,OAAQyB,EACRxB,aAAcyB,EAIlB,CAGA,yBAAM5C,CAAoBT,GACxB,MAAMrB,KAAEA,SAAeM,KAAKC,SACzBqE,KAAK,qBACLC,OAAO,qDACPG,GAAG,iBAAkB3D,EAAS4D,MAE9BO,GAAG,8IACHC,MAAM,aAAc,CAAEC,WAAW,IACjCC,MAAM,GAET,OAAQ3F,GAAQ,IAAIc,IAAK8E,IAAA,IACpBA,EACHC,YAAaD,EAAKE,SAASD,YAC3BE,YAAaH,EAAKI,wBAAwB7E,QAAU,EACpD8E,oBAAqB3F,KAAK4F,kBAAkBN,GAC5CO,aAAc7F,KAAK8F,eAAeR,GAClCS,YAAa/F,KAAKgG,cAAcV,GAChCW,qBAAsBjG,KAAKkG,mBAAmBZ,KAElD,CAGA,yBAAM7D,CAAoBV,GACxB,MAAMV,EAAQL,KAAKG,WAAWY,EAAS+C,eAIvC,IAAIqC,EAAqB,GAIzB,MAAMC,QAAiBpG,KAAKC,SACzBqE,KAAK,qBACLC,OAAO,KACPY,MAAM,eAAgB,CAAEC,WAAW,IACnCC,MAAM,KAGT,GAAIe,EAAS5C,MAAO,CAEN4C,EAAS5C,MACrB,MAAM6C,QAAiBrG,KAAKC,SACzBqE,KAAK,qBACLC,OAAO,KACPY,MAAM,eAAgB,CAAEC,WAAW,IACnCC,MAAM,KACT,GAAIgB,EAAS7C,MAEX,MAAO,GAET2C,EAAcE,EAAS3G,MAAQ,EACjC,MACEyG,EAAcC,EAAS1G,MAAQ,GAIjC,IAAI4G,EAAeH,GAAe,GAIlC,MAAMI,EAAanE,GACN,YAAXA,GAAmC,OAAXA,GAA8B,KAAXA,GAA3CA,MAA4DA,EAsD9D,GAlDAmB,EAAOiD,MAAM,oBAAqB,CAChCC,aAAc1F,EAAS4D,KACvB+B,cAAe1G,KAAKG,WAAWY,EAAS+C,eACxC6C,cAAeR,GAAatF,QAAU,EACtC+F,WAAYT,GAAaU,MAAM,EAAG,GAAGrG,IAAI8E,IAAA,CACvCnE,GAAImE,EAAKnE,GACT2F,sBAAuBxB,EAAKwB,sBAC5BC,sBAAuBzB,EAAKyB,sBAC5BC,qBAAsB1B,EAAK0B,qBAC3BzB,YAAaD,EAAKC,gBACb,KAGTe,EAAeA,EAAa1F,OAAO0E,IACjC,MAAM2B,EAAgBV,EAAUjB,EAAKyB,uBAC/BG,EAAeX,EAAUjB,EAAK0B,sBAG9BG,EAAgD,aAA/B7B,EAAKyB,sBACtBK,EAA8C,aAA9B9B,EAAK0B,qBAE3B,GAAIG,GAAkBC,EAAe,OAAO,EAG5C,MAAMC,EAAgBJ,GAAiBC,EAYvC,OAVA3D,EAAOiD,MAAM,gBAAiB,CAC5BrF,GAAImE,EAAKnE,GACT2F,sBAAuBxB,EAAKwB,sBAC5BC,sBAAuBzB,EAAKyB,sBAC5BC,qBAAsB1B,EAAK0B,qBAC3BC,gBACAC,eACAG,kBAGKA,IAGT9D,EAAOiD,MAAM,oBAAqB,CAChCc,cAAehB,EAAazF,OAC5B0G,cAAejB,EAAa9F,IAAI8E,IAAA,CAC9BnE,GAAImE,EAAKnE,GACT2F,sBAAuBxB,EAAKwB,sBAC5BC,sBAAuBzB,EAAKyB,sBAC5BC,qBAAsB1B,EAAK0B,0BAKV,IAAjB3G,EAAMQ,OACR,MAAO,GAIT,IAAI2G,EAAmBlB,EAEnBjG,EAAMoH,SAAS,aAEjBlE,EAAOiD,MAAM,kCAAmC,CAC9CkB,WAAYF,EAAiB3G,SAGtBR,EAAMoH,SAAS,mBAExBD,EAAmBlB,EAAa1F,OAAO0E,GACfiB,EAAUjB,EAAKyB,wBAGvCxD,EAAOiD,MAAM,wCAAyC,CACpDmB,aAAcrB,EAAazF,OAC3B+G,YAAaJ,EAAiB3G,UAEvBR,EAAMoH,SAAS,mBAAqBpH,EAAMoH,SAAS,QAE5DD,EAAmBlB,EAAa1F,OAAO0E,IACrC,MAAMuC,EAAgD,aAA/BvC,EAAKyB,sBACtBG,EAAeX,EAAUjB,EAAK0B,sBACpC,OAAOa,GAAkBX,IAE3B3D,EAAOiD,MAAM,4CAA6C,CACxDmB,aAAcrB,EAAazF,OAC3B+G,YAAaJ,EAAiB3G,UAEvBR,EAAMoH,SAAS,yBAA2BpH,EAAMoH,SAAS,uBAElED,EAAmBlB,EAAa1F,OAAO0E,IACrC,MAAMuC,EAAgD,aAA/BvC,EAAKyB,sBACtBG,EAAeX,EAAUjB,EAAK0B,sBACpC,OAAOa,GAAkBX,IAE3B3D,EAAOiD,MAAM,0CAA2C,CACtDmB,aAAcrB,EAAazF,OAC3B+G,YAAaJ,EAAiB3G,UAEvBR,EAAMoH,SAAS,eAExBD,EAAmBlB,EAAa1F,OAAO0E,IACrC,MAAMwC,EAA8C,aAA9BxC,EAAK0B,qBACrBe,GAAmBzC,EAAK0C,qBAC9B,OAAOF,GAAiBC,IAE1BxE,EAAOiD,MAAM,kCAAmC,CAC9CmB,aAAcrB,EAAazF,OAC3B+G,YAAaJ,EAAiB3G,WAIhC2G,EAAmB,GACnBjE,EAAOiD,MAAM,iBAAkB,CAC7BnG,QACA4H,OAAQ,WAKZ3B,EAAekB,EAEfjE,EAAOiD,MAAM,iBAAkB,CAC7B0B,kBAAmB5B,EAAazF,OAChCsH,gBAAiB7B,EAAa9F,IAAI8E,IAAA,CAChCnE,GAAImE,EAAKnE,GACT2F,sBAAuBxB,EAAKwB,2BAKhC,MAAMsB,QAAqB/G,QAAQgD,IACjCiC,EAAa9F,IAAI6H,MAAO/C,IAEtB,MAAQ5F,KAAM4I,SAAgBtI,KAAKC,SAChCqE,KAAK,0BACLC,OAAO,KACPG,GAAG,sBAAuBY,EAAKnE,IAGlC,IAAIoE,EAAcD,EAAKC,YACvB,IAAKA,GAAeD,EAAKiD,UAAW,CAClC,MAAQ7I,KAAM8I,SAAiBxI,KAAKC,SACjCqE,KAAK,WACLC,OAAO,eACPG,GAAG,KAAMY,EAAKiD,WACdE,SACHlD,EAAciD,GAAQjD,WACxB,CAEA,MAAMG,EAAyB4C,GAAS,GAClCI,EAAehD,EAAuBiD,OAAO,CAACC,EAAaC,IAExDD,GADQE,OAAOD,GAAGE,gBAAkBD,OAAOD,GAAGG,WAAa,IAAMF,OAAOD,GAAGI,mBAAqB,IAEtG,GAEH,MAAO,IACF3D,EACHC,cACAG,yBACAgD,mBAeN,OAVAnF,EAAOiD,MAAM,iBAAkB,CAC7B0C,kBAAmBd,EAAavH,OAChCsI,oBAAqBf,EAAa5H,IAAI8E,IAAA,CACpCnE,GAAImE,EAAKnE,GACT2F,sBAAuBxB,EAAKwB,sBAC5BsC,WAAY9D,EAAKI,wBAAwB7E,QAAU,EACnD6H,aAAcpD,EAAKoD,kBAIhBN,CACT,CAGA,qBAAM1G,CAAgBX,GACpB,MAAMV,EAAQL,KAAKG,WAAWY,EAAS+C,eAEjCuF,EAAyB,GAG/B,GAAIhJ,EAAMoH,SAAS,cAAgBpH,EAAMoH,SAAS,mBAAqBpH,EAAMoH,SAAS,mBAAqBpH,EAAMoH,SAAS,OAAQ,CAChI,MAAM6B,QAAqBtJ,KAAK4E,gBAAgB7D,EAAUV,GACtDiJ,EAAe,GACjBD,EAAQE,KAAK,CACXpI,GAAI,UACJqI,KAAM,UACNC,MAAO,QACPC,YAAa,GAAGJ,cAChB9E,MAAO8E,EACPK,MAAO,OAGb,CAGA,GAAItJ,EAAMoH,SAAS,eAAiBpH,EAAMoH,SAAS,cAAe,CAChE,MAAQjD,MAAOoF,SAAwB5J,KAAKC,SACzCqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,uBAAwB,YAC3BA,GAAG,wBAAwB,GAE1BkF,GAAiBA,EAAgB,GACnCP,EAAQE,KAAK,CACXpI,GAAI,WACJqI,KAAM,WACNC,MAAO,QACPC,YAAa,GAAGE,cAChBpF,MAAOoF,EACPD,MAAO,UAGb,CAEA,OAAON,CACT,CAGA,qBAAM1H,CAAgBZ,GACpB,MAAM6C,GAAA,IAAY1C,MAAO2C,cAAclD,MAAM,KAAK,GAC5CkJ,EAAW,IAAI3I,KAAKA,KAAKD,MAAQ,OAAqB4C,cAAclD,MAAM,KAAK,IAE9EmJ,EAAgBC,EAAiBC,SAAwB3I,QAAQgD,IAAI,CAE1ErE,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCI,IAAI,aAAcjB,GAClBqG,GAAG,aAAcJ,GACjB3E,GAAG,sEAGNlF,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,iBAAkB3D,EAAS4D,MAC9BE,IAAI,aAAcjB,GAClBqG,GAAG,aAAcJ,GAGpB7J,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,eAAe,GAClBG,IAAI,cAAejB,GACnBqG,GAAG,cAAeJ,KAGvB,MAAO,CACL7G,SAAU8G,EAAetF,OAAS,EAClCvB,UAAW8G,EAAgBvF,OAAS,EACpCtB,SAAU8G,EAAexF,OAAS,EAEtC,CAGA,yBAAM5C,CAAoBb,GAGxB,MAAMmJ,EAAgBnJ,EAAS4D,MAAQ5D,EAASoJ,MAE1CC,EAAe,IAAIlJ,KAAKA,KAAKD,MAAQ,QAAyB4C,cAG9DtB,QAAmBvC,KAAKC,SAC3BqE,KAAK,qBACLC,OAAO,gGACPG,GAAG,iBAAkBwF,GACrB/E,MAAM,aAAc,CAAEC,WAAW,IACjCC,MAAM,KAET,GAAI9C,EAAWiB,MAEb,OADAD,EAAOC,MAAM,yBAA0BjB,EAAWiB,OAC3C,CACLJ,gBAAiB,GACjBC,gBAAiB,GACjBC,gBAAiB,IAIrB,MAAM+G,EAAgB9H,EAAW7C,MAAQ,GAsDzC,MAAO,CACL0D,gBAlDsBiH,EAAczJ,OAAQ0E,IAG5C,MAAMgF,GAAsBhF,EAAKiF,kBAAoB,IAAI7J,OAAO8J,QAAQ,OAAQ,IAC1EC,EAAoB,CAAC,OAAQ,QAAQhD,SAAS6C,GAC9CI,GAAWpF,EAAK0C,qBAChB2C,GAAarF,EAAKsF,eAAiB,IAAInD,SAAS,OAItD,GAAIgD,GAAqBC,GAAWC,EAClC,OAAO,EAIT,MAAME,GAAWvF,EAAKsF,eAAiB,IAAInD,SAAS,QAAUnC,EAAKsF,eAAwC,KAAvBtF,EAAKsF,cACnF9C,EAA8C,aAA9BxC,EAAK0B,qBAE3B,OAAOyD,GAAqBC,GAAWG,GAAW/C,IACjDjB,MAAM,EAAG,IAgCVxD,gBA7BsBgH,EAAczJ,OAAQ0E,IAE5C,MAAMwF,GAAexF,EAAKyF,YACpBJ,GAAarF,EAAKsF,eAAiB,IAAInD,SAAS,OAGtD,GAAIqD,GAAeH,EACjB,OAAO,EAIT,MAAM7C,EAA8C,aAA9BxC,EAAK0B,qBAE3B,OAAO8D,GAAehD,IACrBjB,MAAM,EAAG,IAgBVvD,gBAbsB+G,EAAczJ,OAAQ0E,IAE5C,IAAyB,IAArBA,EAAKyF,YAAsB,OAAO,EACtC,IAAKzF,EAAK0F,YAAa,OAAO,EAG9B,OAFqB,IAAI9J,KAAKoE,EAAK0F,cACV,IAAI9J,KAAKkJ,KAEjCvD,MAAM,EAAG,IAQd,CAGA,kBAAMoE,CAAaC,EAAmBnK,GAEpC,IACE,MAAMV,EAAQL,KAAKG,WAAWY,EAAS+C,gBAG/BpE,KAAMyL,SAAkBnL,KAAKC,SAClCqE,KAAK,qBACLC,OAAO,+CACPG,GAAG,KAAMwG,GACTzC,SAEH,IAAK0C,EACH,MAAO,CAAEC,SAAS,EAAO5H,MAAO,kBAIlC,IAAI6H,EAAkB,CAAA,EAGtB,MAAM9E,EAAanE,GACN,YAAXA,GAAmC,OAAXA,GAA8B,KAAXA,GAA3CA,MAA4DA,EAoC9D,GAhCI/B,EAAMoH,SAAS,aACblB,EAAU4E,EAAQpE,uBACpBsE,EAAa,CACXtE,sBAAuB,YAEkB,aAAlCoE,EAAQpE,uBAAwCR,EAAU4E,EAAQnE,wBAC3EqE,EAAa,CACXrE,qBAAsB,aAGjB3G,EAAMoH,SAAS,kBACpBlB,EAAU4E,EAAQpE,yBACpBsE,EAAa,CACXtE,sBAAuB,aAGlB1G,EAAMoH,SAAS,mBAAqBpH,EAAMoH,SAAS,OACtB,aAAlC0D,EAAQpE,uBAAwCR,EAAU4E,EAAQnE,wBACpEqE,EAAa,CACXrE,qBAAsB,cAGjB3G,EAAMoH,SAAS,yBAA2BpH,EAAMoH,SAAS,wBAE5B,aAAlC0D,EAAQpE,uBAAwCR,EAAU4E,EAAQnE,wBACpEqE,EAAa,CACXrE,qBAAsB,aAMW,IAAnCsE,OAAOC,KAAKF,GAAYxK,OAC1B,MAAO,CAAEuK,SAAS,EAAO5H,MAAO,sBAIlC,MAAQ9D,KAAM8L,EAAAhI,MAAaA,SAAgBxD,KAAKC,SAC7CqE,KAAK,qBACLmH,OAAOJ,GACP3G,GAAG,KAAMwG,GACT3G,SACAkE,SAEH,GAAIjF,EAEF,MAAMA,EAGR,MAAO,CAAE4H,SAAS,EACpB,OAAS5H,GACP,MAAO,CAAE4H,SAAS,EAAO5H,MAAQA,EAAgBkI,QACnD,CACF,CAGA,qBAAc9G,CAAgB7D,EAAoBV,GAOhD,GAAIA,EAAMoH,SAAS,aAAc,CAE/B,MAAOkE,EAAKC,EAAKC,SAAaxK,QAAQgD,IAAI,CACxCrE,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCS,GAAG,uEACNlF,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,wBAAyB,YAC5BQ,GAAG,qEACNlF,KAAKC,SACFqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,uBAAwB,YAC3BA,GAAG,wBAAwB,KAIhC,OADeiH,EAAInH,OAAS,IAAMoH,EAAIpH,OAAS,IAAMqH,EAAIrH,OAAS,EAEpE,CAEA,GAAInE,EAAMoH,SAAS,kBAAmB,CACpC,MAAMjD,MAAEA,QAAOhB,SAAgBxD,KAAKC,SACjCqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCS,GAAG,uEAEN,OAAI1B,EAEK,EAEFgB,GAAS,CAClB,CAEA,GAAInE,EAAMoH,SAAS,mBAAqBpH,EAAMoH,SAAS,OAAQ,CAC7D,MAAMjD,MAAEA,EAAAhB,MAAOA,SAAgBxD,KAAKC,SACjCqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,wBAAyB,YAC5BQ,GAAG,qEAEN,OAAI1B,EAEK,EAEFgB,GAAS,CAClB,CAEA,GAAInE,EAAMoH,SAAS,cAAe,CAChC,MAAMjD,MAAEA,EAAAhB,MAAOA,SAAgBxD,KAAKC,SACjCqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,uBAAwB,YAC3BA,GAAG,wBAAwB,GAE9B,OAAIlB,EAEK,EAEFgB,GAAS,CAClB,CAEA,OAAO,CACT,CAEA,oBAAcQ,CAAejE,EAAoBV,GAE/C,GAAqB,IAAjBA,EAAMQ,OACR,OAAO,EAGT,MAAMiL,EAAe,IAAI5K,KAAKA,KAAKD,MAAQ,QAAyB4C,cAEpE,IAAIkI,EAAQ/L,KAAKC,SACdqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCwF,GAAG,aAAc6B,GAEpB,GAAIzL,EAAMoH,SAAS,aACjBsE,EAAQA,EAAM7G,GAAG,uGACnB,GAAW7E,EAAMoH,SAAS,kBACxBsE,EAAQA,EAAMrH,GAAG,wBAAyB,gBAC5C,GAAWrE,EAAMoH,SAAS,mBAAqBpH,EAAMoH,SAAS,OAC5DsE,EAAQA,EACLrH,GAAG,wBAAyB,YAC5BA,GAAG,uBAAwB,eAChC,KAAWrE,EAAMoH,SAAS,cAKxB,OAAO,EAJPsE,EAAQA,EACLrH,GAAG,uBAAwB,YAC3BA,GAAG,wBAAwB,EAGhC,CAEA,MAAMF,MAAEA,SAAgBuH,EACxB,OAAOvH,GAAS,CAClB,CAEA,0BAAcS,CAAqBlE,EAAoB6C,GAGrD,MAAMiG,EAAW,IAAI3I,KAAKA,KAAKD,MAAQ,OAAqB4C,cAAclD,MAAM,KAAK,IAE/E6D,MAAEA,SAAgBxE,KAAKC,SAC1BqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCI,IAAI,aAAcjB,GAClBqG,GAAG,aAAcJ,GACjBnF,GAAG,iBAAkB3D,EAAS4D,MAEjC,OAAOH,GAAS,CAClB,CAGA,kCAAMwH,GACJ,MAAMxH,MAAEA,SAAgBxE,KAAKC,SAC1BqE,KAAK,qBACLC,OAAO,KAAM,CAAEC,MAAO,QAASC,MAAM,IACrCC,GAAG,eAAe,GAClBQ,GAAG,0DAEN,OAAOV,GAAS,CAClB,CAEQ,iBAAAoB,CAAkBuF,GACxB,IAAIc,EAAW,EAOf,MALsC,aAAlCd,EAAQpE,wBAAsCkF,GAAY,IACzB,aAAjCd,EAAQnE,uBAAqCiF,GAAY,IACzDd,EAAQnD,uBAAsBiE,GAAY,IAC1Cd,EAAQJ,cAAakB,GAAY,IAE9BA,CACT,CAEQ,cAAAnG,CAAeqF,GACrB,OAAIA,EAAQJ,YAAoB,YAC5BI,EAAQnD,qBAA6B,WACJ,aAAjCmD,EAAQnE,qBAA4C,WACjD,UACT,CAEQ,aAAAhB,CAAcmF,GACpB,MAAsC,YAAlCA,EAAQpE,sBAA4C,aACnB,YAAjCoE,EAAQnE,qBAA2C,aAClDmE,EAAQnD,qBACRmD,EAAQJ,YACN,KAD0B,UADS,YAG5C,CAEQ,kBAAA7E,CAAmBiF,GACzB,MAAMe,EAAU,IAAIhL,KAAKiK,EAAQgB,YAC3BvI,MAAY1C,KACCkL,KAAKC,OAAOzI,EAAM0I,UAAYJ,EAAQI,WAAA,OAGzD,IAAIC,EAAgB,EACU,OAA1BpB,EAAQP,gBAAwB2B,EAAgB,GAGpD,OAD4B,IAAIrL,KAAKgL,EAAQI,UAA4B,GAAhBC,EAAqB,GAAK,GAAK,KAC7DC,mBAAmB,QAChD,CAGA,2BAAMC,CAAsB1L,GAC1B,MAAMV,EAAQL,KAAKG,WAAWY,EAAS+C,eAGvC,IAAKzD,EAAMoH,SAAS,gBAAkBpH,EAAMoH,SAAS,cACnD,MAAO,GAIT,MAAM/H,KAAEA,QAAM8D,SAAgBxD,KAAKC,SAChCqE,KAAK,qBACLC,OAAO,+FACPY,MAAM,aAAc,CAAEC,WAAW,IACjCC,MAAM,KAET,GAAI7B,EAEF,OADAD,EAAOC,MAAM,sCAAuCA,GAC7C,GAKT,MAAM8C,GAAgB5G,GAAQ,IAAIkB,OAAQ0E,IAExC,MAAMoH,EAAwC,QAAvBpH,EAAKsF,eACM,aAA/BtF,EAAKyB,uBAAsE,aAA9BzB,EAAK0B,qBAG/C2F,GAAiBrH,EAAKsH,iBAA0C,IAAxBtH,EAAKsH,gBAAoD,OAAxBtH,EAAKsH,eAEpF,OAAOF,GAAkBC,IAM3B,OAFArG,EAAauG,KAAK,CAACC,EAAQC,IAAW,IAAI7L,KAAK4L,EAAEX,YAAYG,UAAY,IAAIpL,KAAK6L,EAAEZ,YAAYG,WAEzFhG,EAAaO,MAAM,EAAG,GAC/B,GC51BF,SAAwBmG,GAAoBC,OAC1CA,EAAAC,QACAA,EAAA5H,KACAA,EAAAkE,KACAA,EAAA2D,UACAA,IAEA,MAAMC,EAAWC,IACXpN,EAAWC,KACVoN,EAAkBC,GAAuBC,EAAAA,SAAmB,KAC5DC,EAAYC,GAAiBF,EAAAA,UAAS,IACtCG,EAAWC,GAAgBJ,EAAAA,SAASlI,GAG3CuI,EAAAA,UAAU,KACRD,EAAatI,IACZ,CAACA,IAGJuI,EAAAA,UAAU,KACexF,WACrB,MAAQ3I,MAAMoO,KAAEA,UAAiB7N,EAAS8N,KAAKC,UAE/C,GAAIF,GAAM3D,MAAO,CACf,MAAQzK,KAAMqB,SAAmBd,EAC9BqE,KAAK,aACLC,OAAO,iBACPG,GAAG,QAASoJ,EAAK3D,OACjB1B,SAGH,GAAI1H,GAAU+C,cAAe,CAE3B,MAAMzD,EAAQC,MAAMC,QAAQQ,EAAS+C,eACjC/C,EAAS+C,cACT/C,EAAS+C,cAAcnD,MAAM,KAAKH,IAAKjB,GAAcA,EAAEmB,QAC3D6M,EAAoBlN,EACtB,CAEF,GAEF4N,IACC,CAACzE,IAgFJ,IAAKmE,EAAW,OAAO,KAEvB,MAAMrF,EAAQqF,EAAUjI,wBAA0B,GAC5CwI,EAAc5F,EAAMK,OAAO,CAACC,EAAaC,IACtCD,GAAOE,OAAOD,EAAEE,eAAiB,GACvC,GACmBT,EAAMK,OAAO,CAACC,EAAaC,IACxCD,GAAOE,OAAOD,EAAEG,WAAa,GACnC,GAGHzF,EAAOiD,MAAM,gCAAiC,CAC5CgD,KAAM,IAAIA,KACV2E,gBAAiB3E,EACjB8D,mBACAhI,KAAMqI,EAAU7G,sBAChBsH,mBAA6B,aAAT5E,EACpB6E,mBAA6B,aAAT7E,EACpB8E,mBAAoBhB,EAAiB7F,SAAS,aAC9C8G,uBAAwBjB,EAAiB7F,SAAS,cAClD+G,eAAgBlB,EAAiBmB,KAAKC,GAAsC,eAA9BA,EAAKhO,OAAOiO,eAC1DC,SAAU,CACR5G,qBAAsB2F,EAAU3F,qBAChC+C,YAAa4C,EAAU5C,aAEzB8D,yBAAmC,aAATrF,EAC1BsF,gBAAiBC,KAAKC,UAAUxF,KAGlC,MAwCMyF,EAxCc,MAClB,OAAQzF,GACN,IAAK,UACH,MAAO,CACL0F,KAAMC,EAAAA,IAAC3P,EAAA,CAAM4P,UAAU,4BACvBC,MAAO,QACPjN,OAAQ,YACRuH,MAAO,kDAEX,IAAK,WACH,MAAO,CACLuF,KAAMC,EAAAA,IAACG,EAAA,CAAaF,UAAU,4BAC9BC,MAAO,QACPjN,OAAQ,YACRuH,MAAO,kDAEX,IAAK,WACH,MAAO,CACLuF,KAAMC,EAAAA,IAACI,EAAA,CAAMH,UAAU,0BACvBC,MAAO,QACPjN,OAAQ,YACRuH,MAAO,4CAEX,IAAK,YACH,MAAO,CACLuF,KAAMC,EAAAA,IAACK,EAAA,CAAYJ,UAAU,2BAC7BC,MAAO,QACPjN,OAAQ,WACRuH,MAAO,+CAEX,QACE,MAAO,CACLuF,KAAMC,EAAAA,IAACM,EAAA,CAAQL,UAAU,0BACzBC,MAAO,QACPjN,OAAQ,WACRuH,MAAO,8CAKE+F,GAEjB,OACEP,EAAAA,IAACQ,EAAA,CAAOC,KAAM3C,EAAQ4C,aAAc3C,EAClC4C,SAAAC,EAAAA,KAACC,EAAA,CACCZ,UAAU,2DACVa,MAAO,CAAEC,SAAU,SAAUC,MAAO,OAAQC,UAAW,QACvDC,iBAAiB,EAEjBP,SAAA,CAAAX,EAAAA,IAACmB,GAAalB,UAAU,UACtBU,SAAAX,MAACoB,EAAA,CAAYT,0BAGfC,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,CAAAX,EAAAA,IAAC,SAAA,CACCqB,QAAStD,EACTkC,UAAU,yIAEVU,SAAAX,EAAAA,IAACsB,EAAA,CAAErB,UAAU,kCAGd,MAAA,CAAIA,UAAU,QACbU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,8BACbU,SAAA,CAAAX,EAAAA,IAAC,MAAA,CAAIC,UAAU,kFACZU,SAAAb,EAASC,SAEZa,KAAC,MAAA,CAAIX,UAAU,iBACbU,SAAA,CAAAX,MAAC,KAAA,CAAGC,UAAU,mBACXU,SAAAnC,EAAU7G,uBAAyB,kBAErC,IAAA,CAAEsI,UAAU,iBAAkBU,SAAAnC,EAAUpI,aAAe,cAE1D4J,EAAAA,IAAC,OAAIC,UAAW,gDAAgDH,EAAStF,QACtEmG,WAAST,kBAOlBU,KAAC,MAAA,CAAIX,UAAU,+DAGbU,SAAA,CAAAX,EAAAA,IAAC,OAAIC,UAAU,mDACbU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,2CACbU,SAAA,CAAAC,OAAC,MAAA,CAAID,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,SAAW,IAACX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAeU,WAAUY,2BACvF,MAAA,CAAIZ,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,SAAW,MAACX,IAAC,OAAA,CAAKC,UAAU,cAAeU,SAAA,IAAI5O,KAAKyM,EAAUgD,cAAgBhD,EAAUxB,YAAYK,mBAAmB,qBACzJ,MAAA,CAAIsD,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,WAAa,MAACX,IAAC,OAAA,CAAKC,UAAU,cAAeU,WAAUc,sBAAwB,IAAI1P,KAAKyM,EAAUiD,uBAAuBpE,mBAAmB,SAAW,kBAEzL,MAAA,CAAIsD,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,SAAW,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAUpI,aAAe,gBACtG,MAAA,CAAIuK,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,UAAY,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAUpD,kBAAoB,iBAC5G,MAAA,CAAIuF,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,UAAY,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAU/C,eAAiB,iBAEzG,MAAA,CAAIkF,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,YAAc,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAUkD,gBAAkB,gBAC5G,MAAA,CAAIf,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,YAAc,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAUmD,oBAAsB,gBAChH,MAAA,CAAIhB,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,SAAW,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAUoD,kBAAoB,iBAE3G,MAAA,CAAIjB,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,QAAU,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAUqD,UAAY,kBAClG,MAAA,CAAIlB,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAcU,SAAA,SAAW,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAnC,EAAUsD,kBAAoB,UAC3GtD,EAAUuD,+BACTnB,EAAAA,KAAC,MAAA,CAAID,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,8BAA8BU,SAAA,WAAa,IAACX,EAAAA,IAAC,OAAA,CAAKC,UAAU,8BAA+BU,SAAA,IAAI5O,KAAKyM,EAAUuD,+BAA+B1E,mBAAmB,qBAO3LuD,KAAC,MAAA,CAAIX,UAAU,6DACbU,SAAA,CAAAX,EAAAA,IAAC,OAAIC,UAAU,gDACbU,SAAAC,EAAAA,KAAC,KAAA,CAAGX,UAAU,oCAAoCU,SAAA,CAAA,UAAQxH,EAAMzH,OAAO,SAAOqN,EAAYiD,iBAAiB,eAE5G,MAAA,CAAI/B,UAAU,kBACbU,SAAAC,EAAAA,KAAC,QAAA,CAAMX,UAAU,6BACfU,SAAA,CAAAC,OAAC,WAAA,CACCD,SAAA,GAAAX,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,aACJ,aAAT5F,GAAgC,aAATA,IAAwB2F,EAAAA,IAAC,MAAA,CAAIC,UAAU,eAElED,MAAC,QAAA,CAAMC,UAAU,sCACfU,gBAAC,KAAA,CACCA,SAAA,CAAAX,EAAAA,IAAC,KAAA,CAAGC,UAAU,0CAA0CU,SAAA,QACxDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,0CAA0CU,SAAA,OACxDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,2CAA2CU,SAAA,OACzDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,2CAA2CU,SAAA,OACzDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,2CAA2CU,SAAA,OAC/C,aAATtG,GAAuB2F,EAAAA,IAAC,KAAA,CAAGC,UAAU,4CAA4CU,SAAA,SACxE,aAATtG,GAAuB2F,EAAAA,IAAC,KAAA,CAAGC,UAAU,4CAA4CU,SAAA,cAGtFX,MAAC,SAAMC,UAAU,2BACdU,WAAMtP,IAAI,CAAC4Q,EAAYC,KACtB,MAAMC,EAAYF,EAAMpI,SAAW,GAAKF,OAAOsI,EAAMrI,eAAiB,GAAKqI,EAAMpI,SAAW,EAC5F,SACE+G,KAAC,KAAA,CAAeX,UAAU,mBACxBU,SAAA,GAAAC,KAAC,KAAA,CAAGX,UAAU,MACZU,SAAA,CAAAX,MAAC,MAAA,CAAIC,UAAU,4BAA6BU,SAAAsB,EAAMG,WAAa,WAC9DH,EAAMI,QACLzB,OAAC,MAAA,CAAIX,UAAU,8BAA8BU,SAAA,CAAA,OAAKsB,EAAMI,mBAG3D,KAAA,CAAGpC,UAAU,oBAAqBU,SAAAsB,EAAMK,eAAiB,YACzD,KAAA,CAAGrC,UAAU,6BAA8BU,SAAAsB,EAAMpI,UAAY,MAC9D+G,KAAC,KAAA,CAAGX,UAAU,iBAAiBU,SAAA,CAAA,IAAEwB,EAAUH,sBAC3CpB,KAAC,KAAA,CAAGX,UAAU,6BAA6BU,SAAA,CAAA,KAAGhH,OAAOsI,EAAMrI,eAAiB,GAAGoI,oBACrE,aAAT3H,GACC2F,EAAAA,IAAC,KAAA,CAAGC,UAAU,kBACXU,SAAAsB,EAAMM,qBACL3B,EAAAA,KAAC,OAAA,CAAKX,UAAU,4HACdU,SAAA,GAAAX,IAACwC,EAAA,CAAavC,UAAU,YAAY,SAIrC9B,EAAiB7F,SAAS,cAC1B6F,EAAiB7F,SAAS,eACzB0H,EAAAA,IAACyC,EAAA,CACCC,aAAeC,GA5NtBzJ,OAAO0J,EAAoBC,KAClD,IACE,MAAMxO,MAAEA,SAAgBvD,EACrBqE,KAAK,0BACLmH,OAAO,CACNV,aAAa,EACbC,aAAA,IAAiB9J,MAAO2C,cACxB6N,qBAAsBK,EAAalO,gBAEpCa,GAAG,KAAMsN,GAEZ,GAAIxO,EAAO,MAAMA,EAGjBoK,EAAaqE,IAAA,IACRA,EACHvM,uBAAwBuM,EAAKvM,wBAAwBlF,IAAK8E,GACxDA,EAAKnE,KAAO6Q,EAAS,IAChB1M,EACHyF,aAAa,EACbC,aAAA,IAAiB9J,MAAO2C,cACxB6N,qBAAsBK,EAAalO,eACjCyB,IACD,MAGP4M,EAAM9G,QAAQ,iBACV+B,GAAWA,GACjB,OAAS3J,GACP0O,EAAM1O,MAAM,mBACd,GA8LsD2O,CAAiBL,EAAMV,EAAMjQ,IACrDiR,YAAY,mBACZC,MAAM,SACNC,KAAK,SAELxC,SAAAX,EAAAA,IAACoD,EAAA,CACCC,KAAK,KACLpD,UAAU,uDACXU,SAAA,aAQD,aAATtG,GACC2F,EAAAA,IAAC,KAAA,CAAGC,UAAU,kBACXU,SAAAsB,EAAMpJ,qBACL+H,EAAAA,KAAC,OAAA,CAAKX,UAAU,4HACdU,SAAA,GAAAX,IAACwC,EAAA,CAAavC,UAAU,YAAY,SAIrC9B,EAAiB7F,SAAS,cAC1B6F,EAAiBmB,KAAKC,GAAsC,eAA9BA,EAAKhO,OAAOiO,iBACzCQ,EAAAA,IAACoD,EAAA,CACCC,KAAK,KACLhC,QAAS,IApSVnI,OAAO2J,IAMpC,GALAzO,EAAOiD,MAAM,kBAAmB,CAC9BwL,SACAS,WAAA,IAAevR,MAAO2C,gBAGnB6O,QAAQ,wBAAb,CAKAnP,EAAOiD,MAAM,eAAgB,CAAEwL,WAE/B,IACE,MAAMxO,MAAEA,SAAgBvD,EACrBqE,KAAK,0BACLmH,OAAO,CACNzD,sBAAsB,EACtB2K,sBAAA,IAA0BzR,MAAO2C,gBAElCa,GAAG,KAAMsN,GAEZ,GAAIxO,EAAO,MAAMA,EAGjBoK,EAAcqE,IAAA,IACTA,EACHvM,uBAAwBuM,EAAKvM,wBAAwBlF,IAAK8E,GACxDA,EAAKnE,KAAO6Q,EACR,IAAK1M,EAAM0C,sBAAsB,EAAM2K,0BAA0BzR,MAAO2C,eACxEyB,MAIR/B,EAAOiD,MAAM,eAAgB,CAAEwL,WAC/BE,EAAM9G,QAAQ,oBACd+B,KACF,OAAS3J,GACPD,EAAOC,MAAM,eAAgBA,EAAO,CAAEwO,WACtCE,EAAM1O,MAAM,mBACd,CA/BA,MAFED,EAAOiD,MAAM,sBA6R8BoM,CAAuBxB,EAAMjQ,IAC5CiO,UAAU,2DACXU,SAAA,aApDFuB,eAoEX,aAAT7H,GAAuBlB,EAAMzH,OAAS,GACrCsO,EAAAA,IAAC,MAAA,CAAIC,UAAU,mDACXU,SAAA,MACA,MAAM+C,EAAgBvK,EAAM1H,OAAQiI,GAAWA,EAAE6I,sBAAsB7Q,OACjEiS,EAAaxK,EAAMzH,OACnBkS,EAAcF,EAAgBC,EAAc,IAElD,SACE/C,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,CAAAX,EAAAA,IAAC,MAAA,CAAIC,UAAU,4BAA4BU,SAAA,aAC3CX,IAAC,MAAA,CAAIC,UAAU,sCACbU,SAAAX,EAAAA,IAAC,MAAA,CACCC,UAAU,2DACVa,MAAO,CAAEE,MAAO,GAAG4C,YAGvBhD,KAAC,MAAA,CAAIX,UAAU,4BAA6BU,SAAA,CAAA+C,EAAc,IAAEC,EAAW,KAAGC,EAAWC,QAAQ,GAAG,UAGtG,EAjBE,cAwBP,MAAA,CAAI5D,UAAU,8DACbU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,0CAEZU,SAAA,CAAS,aAATtG,IACC8D,EAAiB7F,SAAS,cAC1B6F,EAAiBmB,KAAKC,GAAsC,eAA9BA,EAAKhO,OAAOiO,iBAC1CoB,EAAAA,KAACwC,EAAA,CACC/B,QAASnI,UACPqF,GAAc,GACd,IACE,MAAMlK,MAAEA,SAAgBvD,EACrBqE,KAAK,qBACLmH,OAAO,CACNzD,sBAAsB,EACtB2K,sBAAA,IAA0BzR,MAAO2C,gBAElCa,GAAG,KAAMiJ,EAAUxM,IAEtB,GAAIqC,EAAO,MAAMA,EAEjBoK,EAAcqE,IAAA,IACTA,EACHjK,sBAAsB,EACtB2K,sBAAA,IAA0BzR,MAAO2C,iBAGnCqO,EAAM9G,QAAQ,iBACd+B,KACF,OAAS3J,GACP0O,EAAM1O,MAAM,mBACd,CAAA,QACEkK,GAAc,EAChB,GAEFuF,SAAUxF,EACV2B,UAAU,6KAETU,SAAA,CAAArC,EACC0B,EAAAA,IAAC,OAAIC,UAAU,wFAEfD,IAACwC,EAAA,CAAavC,UAAU,iBACxB,gBAKNW,KAAC,MAAA,CAAIX,UAAU,kCACbU,SAAA,CAAAC,EAAAA,KAACwC,EAAA,CACCW,QAAQ,UACR1C,QAAS,KACPpD,EAAS,uBAAuBO,EAAUxM,MAC1C+L,KAEFkC,UAAU,4JACXU,SAAA,CAAA,eAECX,IAACnQ,EAAA,CAAWoQ,UAAU,oBAExBD,EAAAA,IAACoD,EAAA,CACC/B,QAAStD,EACTkC,UAAU,uHACXU,SAAA,mBAUf,CC/cA,SAAwBqD,IACtB,MAAOzT,EAAM0T,GAAW5F,EAAAA,SAA+B,OAChD6F,EAASC,GAAc9F,EAAAA,UAAS,IAChC+F,EAAeC,GAAoBhG,EAAAA,SAAwB,OAC3DiG,EAAoBC,GAAyBlG,EAAAA,SAAwB,OACrEmG,EAAaC,GAAkBpG,EAAAA,UAAS,IACxCF,EAAkBC,GAAuBC,EAAAA,SAAmB,KAC5DqG,EAAoBC,GAAyBtG,EAAAA,SAAgB,KAC7DuG,EAAgBC,GAAqBxG,EAAAA,SAAsB,IAAIyG,MAC/DC,EAAeC,GAAoB3G,EAAAA,SAAc,OACjD4G,EAAkBC,GAAuB7G,EAAAA,UAAS,GAEnDvN,EAAWC,KAGVoU,EAAoBC,GAAyB/G,EAAAA,SAAc,OAC3DgH,GAAiBC,IAAsBjH,EAAAA,SAAuD,OAC9FkH,GAAmBC,IAAwBnH,EAAAA,UAAS,IAGpDoH,GAAaC,IAAkBrH,WAAS,CAC7CsH,aAAc,GACdtS,QAAS,GACTuS,SAAU,GACVC,SAAU,KAGN5H,GAAWC,KACXtM,SAAEA,GAAUuM,iBAAkB2H,IAAcC,IAE5CC,GAAoBC,EAAAA,YAAY/M,MAAOgN,GAAc,EAAMrU,GAAe,KAC9E,IAAKD,GAKH,OAJAwC,EAAOC,MAAM,mDACT6R,GACF/B,GAAW,IAKf,KACM+B,GAAgBrU,GAAiBtB,GACnC4T,GAAW,GAGb,MAAM5P,QAAsB5D,EAAiBgB,iBAAiBC,GAAUC,GAKxE,GAJAoS,EAAQ1P,GACR6J,EAAoB0H,IAGhBA,GAAUxN,SAAS,cACrB,IACE,MAAMqN,QAAqBhV,EAAiB2M,sBAAsB1L,IAClE+S,EAAsBgB,EACxB,OAASQ,GAET,CAEJ,OAAS9R,GACPD,EAAOC,MAAM,iDAAkDA,GAC/D0O,EAAM1O,MAAM,2BAEZ8P,GAAW,GAEXF,EAAQ,KACV,CAAA,QACMiC,GACF/B,GAAW,EAEf,GACC,CAACvS,GAAUkU,GAAWvV,IAEzBmO,EAAAA,UAAU,KACRsH,MACC,CAACA,KAEJ,MAkDMI,GAAoB,CAACjQ,EAAWkE,KACpC+K,EAAsBjP,GACtBmP,GAAmBjL,GACnBmL,IAAqB,IAIjBa,GAAc,CAAClN,EAAcmN,IAC5BA,EAAW/U,OAET4H,EAAM1H,OAAO0E,GAOX,CANaA,EAAKwB,uBAAyB,GAC/BxB,EAAKC,aAAe,IACpBD,EAAKI,wBAA0B,IAC/ClF,IAAK4Q,GAAeA,EAAMG,WAAa,IACvCmE,KAAK,MAGLA,KAAK,KACL/G,cACAlH,SAASgO,EAAW9G,gBAZMrG,EAgB3BqN,GAAsBtN,MAAO0M,IACjC,IACEf,EAAkB/B,GAAQ,IAAIgC,IAAIhC,GAAM2D,IAAIb,EAAS5T,KAGrD,MAAM0U,EAAW,IAAIC,EAAQC,SACvBC,EAAYH,EAASI,aAAa,OAGxCD,EAAUE,QAAU,CAClB,CAAEC,OAAQ,OAAQhX,IAAK,wBAAyBgR,MAAO,IACvD,CAAEgG,OAAQ,MAAOhX,IAAK,cAAegR,MAAO,IAC5C,CAAEgG,OAAQ,MAAOhX,IAAK,YAAagR,MAAO,IAC1C,CAAEgG,OAAQ,KAAMhX,IAAK,gBAAiBgR,MAAO,IAC7C,CAAEgG,OAAQ,KAAMhX,IAAK,WAAYgR,MAAO,IACxC,CAAEgG,OAAQ,KAAMhX,IAAK,aAAcgR,MAAO,IAC1C,CAAEgG,OAAQ,KAAMhX,IAAK,SAAUgR,MAAO,IACtC,CAAEgG,OAAQ,MAAOhX,IAAK,eAAgBgR,MAAO,IAC7C,CAAEgG,OAAQ,OAAQhX,IAAK,gBAAiBgR,MAAO,MAInC4E,EAASrP,wBAA0B,IAC3C0Q,QAAS9Q,IACb0Q,EAAUK,OAAO,CACfvP,sBAAuBiO,EAASjO,sBAChCvB,YAAawP,EAASxP,aAAewP,EAASvP,SAASD,aAAe,GACtEgM,UAAWjM,EAAKiM,WAAa,GAC7BE,cAAenM,EAAKmM,eAAiB,GACrCzI,SAAU1D,EAAK0D,UAAY,EAC3BsN,WAAYhR,EAAK2D,kBAAoB,EACrCsN,OAAQjR,EAAKyD,cAAgB,EAC7B4H,aAAcoE,EAASpE,cAAgB,GACvC/F,cAAemK,EAASnK,eAAiB,OAK7CoL,EAAUQ,OAAO,GAAGC,KAAO,CAAEC,MAAM,GACnCV,EAAUQ,OAAO,GAAGG,KAAO,CACzBnN,KAAM,UACNoN,QAAS,QACTC,QAAS,CAAEC,KAAM,aAInB,MAAMC,QAAelB,EAASmB,KAAKC,cAC7BC,EAAO,IAAIC,KAAK,CAACJ,GAAS,CAAEvN,KAAM,sEAClC4N,EAAMC,OAAOC,IAAIC,gBAAgBL,GACjCM,EAAOC,SAASC,cAAc,KACpCF,EAAKG,KAAOP,EACZI,EAAKI,SAAW,OAAO7C,EAASjO,0BAAqB,IAAQ5F,MAAO2C,cAAcgD,MAAM,EAAG,WAC3F2Q,EAAKK,QACLR,OAAOC,IAAIQ,gBAAgBV,IAGvB9J,EAAiB7F,SAAS,eAAiB6F,EAAiB7F,SAAS,uBACjExH,EACHqE,KAAK,qBACLmH,OAAO,CAAEmB,gBAAgB,IACzBlI,GAAG,KAAMqQ,EAAS5T,IAGrB2S,EAAsB7B,GAAQA,EAAKrR,OAAO0E,GAAQA,EAAKnE,KAAO4T,EAAS5T,MAGzE+Q,EAAM9G,QAAQ,kBAChB,OAAS5H,GACP0O,EAAM1O,MAAM,qBACd,CAAA,QACEwQ,EAAkB/B,IAChB,MAAM8F,EAAS,IAAI9D,IAAIhC,GAEvB,OADA8F,EAAOC,OAAOjD,EAAS5T,IAChB4W,GAEX,GAaF,GAAI1E,EACF,OACElE,EAAAA,IAAC,MAAA,CAAIC,UAAU,mCAAmCa,MAAO,CAAEgI,UAAW,QAASC,gBAAiB,WAC9FpI,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,cACbU,SAAA,GAAAX,IAAC,MAAA,CAAIC,UAAU,+FACfD,EAAAA,IAAC,IAAA,CAAEC,UAAU,qBAAqBU,SAAA,yBAClCC,KAAC,IAAA,CAAEX,UAAU,6BAA6BU,SAAA,CAAA,aAAW/O,IAAU4D,MAAQ,aAM/E,IAAKjF,GAAMqB,SAOT,OANAwC,EAAO4U,KAAK,yBAA0B,CACpCC,UAAW1Y,EACX2Y,cAAetX,GACf0F,aAAc1F,IAAU4D,KACxB0O,YAGAlE,EAAAA,IAAC,MAAA,CAAIC,UAAU,mCAAmCa,MAAO,CAAEgI,UAAW,QAASC,gBAAiB,WAC9FpI,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,uEACbU,SAAA,CAAAX,EAAAA,IAAC,KAAA,CAAGC,UAAU,sBAAsBU,SAAA,sBACpCX,EAAAA,IAAC,IAAA,CAAEC,UAAU,qBAAqBU,SAAA,sBAClCC,KAAC,MAAA,CAAIX,UAAU,kCACbU,SAAA,CAAAC,OAAC,IAAA,CAAED,SAAA,CAAA,aAAW/O,IAAU4D,MAAQ,eAC/B,IAAA,CAAEmL,SAAA,CAAA,YAAUuD,EAAU,OAAS,kBAC/B,IAAA,CAAEvD,SAAA,CAAA,aAAWpQ,EAAO,OAAS,mBAQxC,MASM4Y,IATQhY,MAAMC,QAAQb,EAAKqB,SAAS+C,eACrCpE,EAAKqB,SAAS+C,cAAwBtD,IAAKjB,GAAWkB,OAAOlB,GAAGmB,QAChEhB,EAAKqB,SAAS+C,cACXrD,OAAOf,EAAKqB,SAAS+C,eAClBnD,MAAM,KACNH,IAAKjB,GAAcA,EAAEmB,QACrBE,OAAQrB,GAAcA,EAAEsB,OAAS,GACpC,IAEwB4N,KAAMlP,GAAc,CAAC,iBAAkB,iBAAkB,YAAa,uBAAwB,sBAAsBkI,SAASlI,IAE7J,SACEwQ,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,sBAEbU,SAAA,CAAAX,EAAAA,IAAC,OAAIC,UAAU,OACbU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,oCACbU,SAAA,CAAAC,OAAC,MAAA,CACCD,SAAA,CAAAX,EAAAA,IAAC,KAAA,CAAGC,UAAU,aAAaU,SAAA,SAC3BX,EAAAA,IAAC,IAAA,CAAEC,UAAU,gBAAgBa,MAAO,CAACsI,UAAU,OAAOC,aAAa,QAAS1I,SAAA,mBAE9EX,IAAC,MAAA,CAAIC,UAAU,0BACbU,SAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,4DACbU,UAAA,IAAI5O,MAAOsL,mBAAmB,QAAS,CACtCiM,MAAO,OACPC,IAAK,UACLC,QAAS,yBAQlB,MAAA,CAAIvJ,UAAU,OACbU,SAAAC,EAAAA,KAAC,KAAA,CAAGX,UAAU,+CACZU,SAAA,GAAAX,IAACM,EAAA,CAAQL,UAAU,8BAA8B,eAIrDW,KAAC,MAAA,CAAIX,UAAU,sEAEXU,SAAA,EAAAxC,EAAiB7F,SAAS,eAAiB6F,EAAiB7F,SAAS,gBAAkBoM,EAAmBhT,OAAS,GACnHkP,OAAC6I,EAAA,CAAKxJ,UAAU,2FACdU,SAAA,CAAAX,EAAAA,IAAC0J,GAAWzJ,UAAU,gCACpBU,SAAAC,EAAAA,KAAC+I,EAAA,CAAU1J,UAAU,kDACnBU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,GAAAX,IAAC4J,EAAA,CAAS3J,UAAU,8BACpBD,IAAC,QAAKW,SAAA,iBAERX,EAAAA,IAAC,OAAA,CAAKC,UAAU,4CACbU,WAAmBjP,oBAIzBmY,EAAA,CAAY5J,UAAU,MACrBU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,YAEbU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,WACbU,SAAA,GAAAX,IAAC8J,EAAA,CAAO7J,UAAU,6EAClBD,EAAAA,IAAC+J,EAAA,CACC9G,YAAY,wBACZ/P,MAAOuS,GAAYE,aACnBqE,SAAWC,GAAMvE,GAAe5C,IAAA,IAAcA,EAAM6C,aAAcsE,EAAEC,OAAOhX,SAC3E+M,UAAU,2BAKdD,IAAC,MAAA,CAAIC,UAAU,sCACZU,YAAY+D,EAAoBe,GAAYE,cAAcjO,MAAM,EAAG,IAAIrG,IAAK8E,IAC3E,MAAMgD,EAAQhD,EAAKI,wBAA0B,GACvC4T,EAAYhR,EAAM,IAAM,CAAA,EACVA,EAAMK,OAAO,CAACC,EAAaC,IACtCD,GAAOE,OAAOD,EAAEE,eAAiB,GACvC,GACcT,EAAMK,OAAO,CAACC,EAAaC,IACnCD,GAAOE,OAAOD,EAAEG,WAAa,GACnC,GACH,MAAMuQ,EAAYnN,KAAKC,OAAOnL,KAAKD,MAAQ,IAAIC,KAAKoE,EAAK6G,YAAYG,kBAC/DkN,EAAmC,QAAvBlU,EAAKsF,cAEvB,OACEuE,EAAAA,IAAC,MAAA,CAECC,UAAW,wEACToK,EAAY,4CAA8C,6CAE5DhJ,QAAS,KACP2D,EAAiB7O,GACjB+O,GAAoB,IAGtBvE,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,0CACbU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,yCACbU,SAAA,GAAAX,IAAC,OAAA,CAAKC,UAAU,aACbU,SAAAxK,EAAKwB,uBAAyB,MAAMxB,EAAKnE,GAAG0F,MAAM,EAAG,aAEvD,OAAA,CAAKuI,UAAU,yBACbU,SAAAxK,EAAKC,aAAe,aAEvBwK,KAAC,OAAA,CAAKX,UAAU,4BACbU,SAAA,CAAAwJ,EAAU/H,WAAa,KACvBjJ,EAAMzH,OAAS,GACdkP,EAAAA,KAAC,OAAA,CAAKX,UAAU,gBAAgBU,SAAA,CAAA,MAAIxH,EAAMzH,OAAS,EAAE,UAGxD0Y,EAAY,GACXxJ,OAAC,OAAA,CAAKX,UAAU,0EACbU,SAAA,CAAAyJ,EAAU,gBAIhB,MAAA,CACCzJ,SAAAX,EAAAA,IAACoD,EAAA,CACCC,KAAK,KACLU,QAAQ,UACR9D,UAAU,2DACVoB,QAAU4I,IACRA,EAAEK,kBACF9D,GAAoBrQ,IAEtB2N,SAAUc,EAAe2F,IAAIpU,EAAKnE,IAEjC2O,SAAAiE,EAAe2F,IAAIpU,EAAKnE,UACtB,MAAA,CAAIiO,UAAU,oFAEfW,EAAAA,KAAA4J,EAAAA,SAAA,CACE7J,SAAA,GAAAX,IAAC4J,EAAA,CAAS3J,UAAU,iBAAiB,kBA5C1C9J,EAAKnE,gBA8DzBmX,IACCvI,EAAAA,KAAC6I,EAAA,CAAKxJ,UAAU,+BACdU,SAAA,CAAAX,EAAAA,IAAC0J,GAAWzJ,UAAU,YACpBU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,oCACbU,SAAA,GAAAC,KAAC+I,EAAA,CAAU1J,UAAU,0CACnBU,SAAA,GAAAX,IAAC3P,EAAA,CAAM4P,UAAU,gCAAgC,QAEhD1P,EAAKmD,iBAAiBhC,OAAS,KAC9BsO,IAAC,QAAKC,UAAU,6CACbU,SAAApQ,EAAKmD,iBAAiBhC,YAI5BnB,EAAKmD,iBAAiBhC,OAAS,GAC9BsO,EAAAA,IAACoD,EAAA,CACCC,KAAK,KACLU,QAAQ,QACR1C,QAAS,IAAMpD,GAAS,aACxBgC,UAAU,WAEVU,SAAAX,EAAAA,IAACnQ,EAAA,CAAWoQ,UAAU,qBAK9BD,IAAC6J,EAAA,CAAY5J,UAAU,MACpBU,SAAiC,IAAjCpQ,EAAKmD,iBAAiBhC,OACrBkP,EAAAA,KAAC,MAAA,CAAIX,UAAU,iCACbU,SAAA,GAAAX,IAACK,EAAA,CAAYJ,UAAU,yBACvBD,EAAAA,IAAC,IAAA,CAAEC,UAAU,mBAAmBU,SAAA,gBAGlCC,EAAAA,KAAC,MAAA,CAAIX,UAAU,YAEbU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,WACbU,SAAA,GAAAX,IAAC8J,EAAA,CAAO7J,UAAU,6EAClBD,EAAAA,IAAC+J,EAAA,CACC9G,YAAY,wBACZ/P,MAAOuS,GAAYpS,QACnB2W,SAAWC,GAAMvE,GAAe5C,IAAA,IAAcA,EAAMzP,QAAS4W,EAAEC,OAAOhX,SACtE+M,UAAU,yBAKdD,EAAAA,IAAC,MAAA,CAAIc,MAAO,CAAEG,UAAW,QAASwJ,UAAW,OAAQC,QAAS,OAAQC,cAAe,SAAUC,IAAK,YACjGjK,SAAA0F,GAAY9V,EAAKmD,iBAAkB+R,GAAYpS,SAASqE,MAAM,EAAG,IAAIrG,IAAI,CAACwZ,EAAU3I,KACnF,MAAM/I,EAAQ0R,EAAStU,wBAA0B,GAC3C4T,EAAYhR,EAAM,IAAM,CAAA,EACV0R,EAAStR,cAAgBJ,EAAMK,OAAO,CAACC,EAAaC,IAAWD,GAAOE,OAAOD,EAAEE,eAAiB,GAAI,GACxH,MAAMyQ,EAAuC,QAA3BQ,EAASpP,cAE3B,OACEuE,EAAAA,IAAC,MAAA,CAECC,UAAW,+EACToK,EAAY,2BAA6B,yBAE3CvJ,MAAO,CAAE4J,QAAS,SAClBrJ,QAAU4I,IACHA,EAAEC,OAAuBY,QAAQ,YACtCvG,EAAsB5K,OAAOkR,EAAS7Y,KACtCyS,GAAe,KAGjB9D,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,0CACbU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,yCACbU,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,aACbU,SAAAkK,EAASlT,8BAEX,OAAA,CAAKsI,UAAU,yBAA0BU,SAAAkK,EAASzU,aAAe,SAClEwK,KAAC,OAAA,CAAKX,UAAU,4BACbU,SAAA,CAAAwJ,EAAU/H,WAAa,KAAK,IAAEjJ,EAAMzH,OAAS,GAAK,KAAKyH,EAAMzH,OAAS,WAG3EsO,EAAAA,IAACoD,EAAA,CACCC,KAAK,KACLhC,QAAU4I,IACRA,EAAEK,kBAraPpR,OAAO6C,IAChC,IAAKxL,GAAMqB,SAET,YADAmR,EAAM1O,MAAM,sBAKd,IAAKkP,QAAQ,iBACX,OAGFc,EAAiBtI,GAGjB,MAAMgP,EAAexa,EACrB0T,EAAQnB,GACDA,EACE,IACFA,EACHpP,iBAAkBoP,EAAKpP,iBAAiBjC,OAAO0E,GAAQA,EAAKnE,KAAO+J,GACnE/I,MAAO,IACF8P,EAAK9P,MACRK,QAAS4J,KAAK+N,IAAI,EAAGlI,EAAK9P,MAAMK,QAAU,KAN5ByP,GAWpB,IACE,MAAMhK,QAAenI,EAAiBmL,aAAaC,EAAWxL,EAAKqB,UAE/DkH,EAAOmD,SACT8G,EAAM9G,QAAQ,gBAEdgP,WAAW,KACTjF,IAAkB,IACjB,OAGH/B,EAAQ8G,GACRhI,EAAM1O,MAAMyE,EAAOzE,OAAS,uBAEhC,OAASA,GAEP4P,EAAQ8G,GACRhI,EAAM1O,MAAM,sBACd,CAAA,QACEgQ,EAAiB,KACnB,GAuX8B6G,CAAmBL,EAAS7Y,KAE9B8R,SAAUM,IAAkByG,EAAS7Y,GACrCiO,UAAW,4CAC0B,aAAnC4K,EAASjT,sBACL,gCACA,mCAGL+I,SAAAyD,IAAkByG,EAAS7Y,GAC1BgO,EAAAA,IAAC,OAAIC,UAAU,+EAEfW,EAAAA,KAAA4J,EAAAA,SAAA,CACG7J,SAAA,CAAmC,aAAnCkK,EAASjT,sBAAuC,KAAO,KAAK,eAtChE,YAAYiT,EAAS7Y,kBAuD3CmM,EAAiB7F,SAAS,eACzBsI,EAAAA,KAAC6I,EAAA,CAAKxJ,UAAU,gFACdU,SAAA,CAAAX,EAAAA,IAAC0J,GAAWzJ,UAAU,gCACpBU,SAAAC,EAAAA,KAAC+I,EAAA,CAAU1J,UAAU,kDACnBU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,GAAAX,IAACG,EAAA,CAAaF,UAAU,8BACxBD,IAAC,QAAKW,SAAA,aAEPpQ,EAAKyD,kBAAoBzD,EAAKyD,iBAAiBC,iBAAmB1D,EAAKyD,iBAAiBC,gBAAgBvC,OAAS,SAC/G,OAAA,CAAKuO,UAAU,4CACbU,SAAApQ,EAAKyD,iBAAiBC,gBAAgBvC,oBAK9CmY,EAAA,CAAY5J,UAAU,MACpBU,SAACpQ,EAAKyD,kBAAqBzD,EAAKyD,iBAAiBC,iBAAoE,IAAjD1D,EAAKyD,iBAAiBC,gBAAgBvC,OAMzGkP,EAAAA,KAAC,MAAA,CAAIX,UAAU,YAEbU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,WACbU,SAAA,GAAAX,IAAC8J,EAAA,CAAO7J,UAAU,6EAClBD,EAAAA,IAAC+J,EAAA,CACC9G,YAAY,wBACZ/P,MAAOuS,GAAYG,SACnBoE,SAAWC,GAAMvE,GAAe5C,IAAA,IAAcA,EAAM8C,SAAUqE,EAAEC,OAAOhX,SACvE+M,UAAU,+BAKb,MAAA,CAAIA,UAAU,sCACZU,SAAA0F,GAAY9V,EAAKyD,iBAAiBC,gBAAiBwR,GAAYG,UAAUlO,MAAM,EAAG,IAAIrG,IAAK8E,IAC1F,MAAMgD,EAAQhD,EAAKI,wBAA0B,GACvC4T,EAAYhR,EAAM,GACJA,EAAMK,OAAO,CAACC,EAAaC,IAAWD,GAAOE,OAAOD,EAAEE,eAAiB,GAAI,GAC/F,MAAM4B,GAAarF,EAAKsF,eAAiB,IAAInD,SAAS,OAEtD,OACE0H,EAAAA,IAAC,MAAA,CAECC,UAAW,yDACTzE,EAAY,4CAA8C,6CAG5DmF,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,0CACbU,SAAA,CAAAC,EAAAA,KAAC,MAAA,CACCX,UAAU,gDACVoB,QAAS,IAAM+E,GAAkBjQ,EAAM,YAEvCwK,SAAA,GAAAX,IAAC,OAAA,CAAKC,UAAU,aACbU,SAAAxK,EAAKwB,uBAAyB,MAAMxB,EAAKnE,GAAG0F,MAAM,EAAG,aAEvD,OAAA,CAAKuI,UAAU,yBACbU,SAAAxK,EAAKC,aAAe,aAEvBwK,KAAC,OAAA,CAAKX,UAAU,4BACbU,SAAA,CAAAwJ,GAAW/H,WAAa,KACxBjJ,EAAMzH,OAAS,GACdkP,EAAAA,KAAC,OAAA,CAAKX,UAAU,gBAAgBU,SAAA,CAAA,MAAIxH,EAAMzH,OAAS,EAAE,cAMzDyM,EAAiB7F,SAAS,eAC1B6F,EAAiB7F,SAAS,gBAAkBnC,EAAK0C,sBACjDmH,EAAAA,IAACoD,EAAA,CACCC,KAAK,KACLhC,QAASnI,MAAO+Q,IAEd,GADAA,EAAEK,kBACG/G,QAAQ,wBAEb,IACE,MAAMlP,MAAEA,SAAgBvD,EACrBqE,KAAK,qBACLmH,OAAO,CACNzD,sBAAsB,EACtB2K,sBAAA,IAA0BzR,MAAO2C,gBAElCa,GAAG,KAAMY,EAAKnE,IAEjB,GAAIqC,EAAO,MAAMA,EAEjB0O,EAAM9G,QAAQ,iBACd+J,IAAkB,EACpB,OAAS3R,GACP0O,EAAM1O,MAAM,mBACd,GAEF4L,UAAU,4EACXU,SAAA,SAMFxK,EAAK0C,sBACJmH,EAAAA,IAAC,MAAA,CAAIC,UAAU,kFAAkFU,SAAA,YA1DhGxK,EAAKnE,WA3BpB4O,OAAC,MAAA,CAAIX,UAAU,kCACbU,SAAA,GAAAX,IAACG,EAAA,CAAaF,UAAU,yCACxBD,EAAAA,IAAC,IAAA,CAAEC,UAAU,gBAAgBU,SAAA,6BAmGvCC,KAAC6I,EAAA,CAAKxJ,UAAU,gFACZU,SAAA,CAAAX,EAAAA,IAAC0J,GAAWzJ,UAAU,gCACpBU,SAAAC,EAAAA,KAAC+I,EAAA,CAAU1J,UAAU,kDACnBU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,GAAAX,IAACI,EAAA,CAAMH,UAAU,4BACjBD,IAAC,QAAKW,SAAA,aAEPpQ,EAAKyD,iBAAiBE,gBAAgBxC,OAAS,KAC9CsO,IAAC,OAAA,CAAKC,UAAU,wCACbU,SAAApQ,EAAKyD,iBAAiBE,gBAAgBxC,gBAK/CsO,IAAC6J,EAAA,CAAY5J,UAAU,MACpBU,SAAiD,IAAjDpQ,EAAKyD,iBAAiBE,gBAAgBxC,OACrCkP,OAAC,MAAA,CAAIX,UAAU,kCACbU,SAAA,GAAAX,IAACI,EAAA,CAAMH,UAAU,yCACjBD,EAAAA,IAAC,IAAA,CAAEC,UAAU,gBAAgBU,SAAA,sBAG/BC,EAAAA,KAAC,MAAA,CAAIX,UAAU,YAEbU,SAAA,GAAAC,KAAC,MAAA,CAAIX,UAAU,WACbU,SAAA,GAAAX,IAAC8J,EAAA,CAAO7J,UAAU,6EAClBD,EAAAA,IAAC+J,EAAA,CACC9G,YAAY,wBACZ/P,MAAOuS,GAAYI,SACnBmE,SAAWC,GAAMvE,GAAe5C,IAAA,IAAcA,EAAM+C,SAAUoE,EAAEC,OAAOhX,SACvE+M,UAAU,+BAKb,MAAA,CAAIA,UAAU,sCACZU,SAAA0F,GAAY9V,EAAKyD,iBAAiBE,gBAAiBuR,GAAYI,UAAUnO,MAAM,EAAG,IAAIrG,IAAK8E,IAC1F,MAAMgD,EAAQhD,EAAKI,wBAA0B,GACvC4T,EAAYhR,EAAM,GAClBZ,EAAaY,EAAMzH,OACHyH,EAAM1H,OAAQiI,GAAWA,EAAEkC,aAAalK,OAE1CyH,EAAMK,OAAO,CAACC,EAAaC,IAAWD,GAAOE,OAAOD,EAAEE,eAAiB,GAAI,GAC/F,MAAM4B,GAAarF,EAAKsF,eAAiB,IAAInD,SAAS,OAEtD,OACE0H,EAAAA,IAAC,MAAA,CAECC,UAAW,wEACTzE,EAAY,4CAA8C,6CAE5D6F,QAAS,IAAM+E,GAAkBjQ,EAAM,YAEvCwK,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,GAAAX,IAAC,OAAA,CAAKC,UAAU,aACbU,SAAAxK,EAAKwB,uBAAyB,MAAMxB,EAAKnE,GAAG0F,MAAM,EAAG,aAEvD,OAAA,CAAKuI,UAAU,yBACbU,SAAAxK,EAAKC,aAAe,aAEvBwK,KAAC,OAAA,CAAKX,UAAU,4BACbU,SAAA,CAAAwJ,GAAW/H,WAAa,KACxB7J,EAAa,GACZqI,OAAC,OAAA,CAAKX,UAAU,gBAAgBU,SAAA,CAAA,MAAIpI,EAAa,EAAE,cAhBpDpC,EAAKnE,sBAmChCgO,EAAAA,IAACmL,EAAA,CACCC,WAAY9G,EACZxG,OAAQ0G,EACRzG,QAAS,KACP0G,GAAe,GACfF,EAAsB,OAExBpG,mBACAH,UAAW,KACTgI,KACAvB,GAAe,GACfF,EAAsB,OAExB8G,mBAAoB,CAACD,EAAoBE,KAEvCC,EAAuBH,EAAYE,GAEnCtF,IAAkB,MAKtBhG,EAAAA,IAACnC,EAAA,CACGC,OAAQyH,GACRxH,QAAS,KACPyH,IAAqB,GACrBJ,EAAsB,MACtBE,GAAmB,OAErBnP,KAAMgP,EACN9K,KAAMgL,GACNrH,UAAW,IAAMgI,IAAkB,KAItCf,GAAoBF,GACnB/E,MAACQ,GAAOC,KAAMwE,EAAkBvE,aAAc,KAC5CwE,GAAoB,GACpBF,EAAiB,OAEjBrE,SAAAC,EAAAA,KAACC,EAAA,CACCZ,UAAU,2DACVa,MAAO,CAAEC,SAAU,SAAUC,MAAO,OAAQC,UAAW,QACvDC,iBAAiB,EAEjBP,SAAA,CAAAX,EAAAA,IAACmB,GAAalB,UAAU,UACtBU,SAAAX,MAACoB,EAAA,CAAYT,4BAGfC,KAAC,MAAA,CAAIX,UAAU,0BACbU,SAAA,CAAAX,EAAAA,IAAC,SAAA,CACCqB,QAAS,KACP6D,GAAoB,GACpBF,EAAiB,OAEnB/E,UAAU,yIAEVU,SAAAX,EAAAA,IAACsB,EAAA,CAAErB,UAAU,kCAGd,MAAA,CAAIA,UAAU,QACbU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,8BACbU,SAAA,CAAAX,EAAAA,IAAC,OAAIC,UAAU,oFACbU,eAACiJ,EAAA,CAAS3J,UAAU,gCAEtBW,KAAC,MAAA,CAAIX,UAAU,iBACbU,SAAA,CAAAX,MAAC,KAAA,CAAGC,UAAU,mBACXU,SAAAoE,EAAcpN,uBAAyB,kBAEzC,IAAA,CAAEsI,UAAU,iBAAkBU,SAAAoE,EAAc3O,aAAe,cAE9D4J,EAAAA,IAAC,OAAA,CAAKC,UAAU,2CAA2CU,SAAA,oBAQjEC,KAAC,MAAA,CAAIX,UAAU,+DAGbU,SAAA,CAAAX,EAAAA,IAAC,OAAIC,UAAU,mDACbU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,2CACbU,SAAA,CAAAC,OAAC,MAAA,CAAID,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,SAAW,IAACX,EAAAA,IAAC,OAAA,CAAKC,UAAU,cAAeU,WAAcY,2BAC7F,MAAA,CAAIZ,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,SAAW,MAACX,IAAC,OAAA,CAAKC,UAAU,cAAeU,SAAA,IAAI5O,KAAKgT,EAAcvD,cAAgBuD,EAAc/H,YAAYK,mBAAmB,qBACnK,MAAA,CAAIsD,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,WAAa,MAACX,IAAC,OAAA,CAAKC,UAAU,cAAeU,WAAcc,sBAAwB,IAAI1P,KAAKgT,EAActD,uBAAuBpE,mBAAmB,SAAW,kBAEnM,MAAA,CAAIsD,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,SAAW,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAAc3O,aAAe,gBAC5G,MAAA,CAAIuK,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,UAAY,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAAc3J,kBAAoB,iBAClH,MAAA,CAAIuF,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,UAAY,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAActJ,eAAiB,iBAE/G,MAAA,CAAIkF,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,YAAc,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAAcrD,gBAAkB,gBAClH,MAAA,CAAIf,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,YAAc,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAAcpD,oBAAsB,gBACtH,MAAA,CAAIhB,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,SAAW,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAAcnD,kBAAoB,iBAEjH,MAAA,CAAIjB,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,QAAU,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAAclD,UAAY,kBACxG,MAAA,CAAIlB,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,gBAAgBU,SAAA,SAAW,UAAE,OAAA,CAAKV,UAAU,cAAeU,SAAAoE,EAAcjD,kBAAoB,UACjHiD,EAAchD,+BACbnB,EAAAA,KAAC,MAAA,CAAID,SAAA,CAAAX,EAAAA,IAAC,OAAA,CAAKC,UAAU,kBAAkBU,SAAA,WAAa,IAACX,EAAAA,IAAC,OAAA,CAAKC,UAAU,8BAA+BU,SAAA,IAAI5O,KAAKgT,EAAchD,+BAA+B1E,mBAAmB,qBAMnLuD,KAAC,MAAA,CAAIX,UAAU,6DACbU,SAAA,CAAAX,EAAAA,IAAC,OAAIC,UAAU,gDACbU,SAAAC,EAAAA,KAAC,KAAA,CAAGX,UAAU,oCAAoCU,SAAA,CAAA,WAASoE,EAAcxO,wBAA0B,IAAI7E,OAAO,UAAQqT,EAAcxO,wBAA0B,IAAIiD,OAAO,CAACC,EAAaC,IAAWD,GAAOE,OAAOD,EAAEE,eAAiB,GAAI,GAAGoI,iBAAiB,eAE5P,MAAA,CAAI/B,UAAU,kBACbU,SAAAC,EAAAA,KAAC,QAAA,CAAMX,UAAU,6BACfU,SAAA,CAAAC,OAAC,WAAA,CACCD,SAAA,GAAAX,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,cACfD,IAAC,MAAA,CAAIC,UAAU,eAEjBD,MAAC,QAAA,CAAMC,UAAU,sCACfU,gBAAC,KAAA,CACCA,SAAA,CAAAX,EAAAA,IAAC,KAAA,CAAGC,UAAU,0CAA0CU,SAAA,QACxDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,0CAA0CU,SAAA,OACxDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,2CAA2CU,SAAA,OACzDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,2CAA2CU,SAAA,OACzDX,EAAAA,IAAC,KAAA,CAAGC,UAAU,2CAA2CU,SAAA,YAG7DX,EAAAA,IAAC,QAAA,CAAMC,UAAU,2BACbU,UAAAoE,EAAcxO,wBAA0B,IAAIlF,IAAI,CAAC4Q,EAAYC,KAC7D,MAAMC,EAAYF,EAAMpI,SAAW,GAAKF,OAAOsI,EAAMrI,eAAiB,GAAKqI,EAAMpI,SAAW,EAC5F,SACE+G,KAAC,KAAA,CAAeX,UAAU,mBACxBU,SAAA,GAAAC,KAAC,KAAA,CAAGX,UAAU,MACZU,SAAA,CAAAX,MAAC,MAAA,CAAIC,UAAU,4BAA6BU,SAAAsB,EAAMG,WAAa,WAC9DH,EAAMI,QACLzB,OAAC,MAAA,CAAIX,UAAU,8BAA8BU,SAAA,CAAA,OAAKsB,EAAMI,mBAG3D,KAAA,CAAGpC,UAAU,oBAAqBU,SAAAsB,EAAMK,eAAiB,YACzD,KAAA,CAAGrC,UAAU,6BAA8BU,SAAAsB,EAAMpI,UAAY,MAC9D+G,KAAC,KAAA,CAAGX,UAAU,iBAAiBU,SAAA,CAAA,IAAEwB,EAAUH,sBAC3CpB,KAAC,KAAA,CAAGX,UAAU,6BAA6BU,SAAA,CAAA,KAAGhH,OAAOsI,EAAMrI,eAAiB,GAAGoI,sBAVxEE,wBAqBtB,MAAA,CAAIjC,UAAU,8DACbU,SAAAC,EAAAA,KAAC,MAAA,CAAIX,UAAU,0CACbU,SAAA,CAAAC,EAAAA,KAACwC,EAAA,CACC/B,QAAS,IAAMmF,GAAoBzB,GACnCjB,SAAUc,EAAe2F,IAAIxF,EAAc/S,IAC3CiO,UAAU,iLAETU,SAAA,CAAAiE,EAAe2F,IAAIxF,EAAc/S,IAChCgO,EAAAA,IAAC,MAAA,CAAIC,UAAU,sFAEfD,EAAAA,IAAC4J,EAAA,CAAS3J,UAAU,iBACpB,kBAIJW,KAAC,MAAA,CAAIX,UAAU,kCACbU,SAAA,CAAAC,EAAAA,KAACwC,EAAA,CACCW,QAAQ,UACR1C,QAAS,KACPpD,GAAS,+BACTiH,GAAoB,GACpBF,EAAiB,OAEnB/E,UAAU,4JACXU,SAAA,CAAA,eAECX,IAACnQ,EAAA,CAAWoQ,UAAU,oBAExBD,EAAAA,IAACoD,EAAA,CACC/B,QAAS,KACP6D,GAAoB,GACpBF,EAAiB,OAEnB/E,UAAU,uHACXU,SAAA,sBAWnB","x_google_ignoreList":[0,1,2]}