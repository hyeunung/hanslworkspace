import{c as N,p as y,u as f,r as n,a as b,j as e,b as x,U as v,B as _}from"./index-BZPnGuwA.js";import{t as w,B as a}from"./index-BRMmYxVM.js";import{C as k}from"./calendar-ghXAII5e.js";import{C}from"./credit-card-CqLIFE4x.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],o=N("arrow-left",S);function R(){const{id:i}=y(),d=f(),[h,g]=n.useState(!0),[s,p]=n.useState(null);n.useEffect(()=>{i&&u(i)},[i]);const u=async t=>{try{const r=b(),{data:c,error:m}=await r.from("purchase_requests").select("*,vendors(id,vendor_name),purchase_request_items(*)").eq("id",t).single();if(m)throw m;c&&p({...c,items:c.purchase_request_items||[],vendor:c.vendors||{id:0,vendor_name:"알 수 없음"},vendor_contacts:[]})}catch{w.error("발주 상세 정보를 불러오는데 실패했습니다.")}finally{g(!1)}},l=t=>{switch(t){case"approved":return e.jsx(a,{className:"bg-green-100 text-green-800",children:"승인"});case"rejected":return e.jsx(a,{className:"bg-red-100 text-red-800",children:"반려"});case"pending":return e.jsx(a,{className:"bg-yellow-100 text-yellow-800",children:"대기"});default:return e.jsx(a,{className:"bg-gray-100 text-gray-800",children:"-"})}},j=t=>{switch(t){case"completed":return e.jsx(a,{className:"bg-hansl-100 text-hansl-800",children:"납품완료"});case"partial":return e.jsx(a,{className:"bg-purple-100 text-purple-800",children:"부분납품"});case"pending":return e.jsx(a,{className:"bg-orange-100 text-orange-800",children:"납품대기"});default:return e.jsx(a,{className:"bg-gray-100 text-gray-800",children:"-"})}};return h?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(x,{variant:"ghost",size:"sm",onClick:()=>d("/purchase/list"),children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),"목록으로"]}),e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["발주 상세 - ",s.order_number]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"1차 승인"}),l(s.middle_manager_status)]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"최종 승인"}),l(s.final_manager_status)]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 처리"}),l(s.purchase_status||"pending")]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"납품 상태"}),j(s.delivery_status||"pending")]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"기본 정보"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"요청일"]}),e.jsx("p",{className:"font-medium",children:s.created_at?new Date(s.created_at).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"요청자"]}),e.jsx("p",{className:"font-medium",children:s.requester_name||"-"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"업체명"]}),e.jsx("p",{className:"font-medium",children:s.vendor?.vendor_name||"-"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"총 금액"]}),e.jsxs("p",{className:"font-medium",children:[s.total_amount?.toLocaleString("ko-KR"),"원"]})]})]}),s.purpose&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 목적"}),e.jsx("p",{className:"text-gray-900",children:s.purpose})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"구매 품목"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"품목명"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"수량"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"단가"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"금액"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(s.items||[]).map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.item_name}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.quantity," ",t.unit||"개"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.unit_price?.toLocaleString("ko-KR"),"원"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((t.quantity||0)*(t.unit_price||0)).toLocaleString("ko-KR"),"원"]})]},r))})]})})]}),(s.middle_manager_comment||s.final_manager_comment||s.purchase_comment)&&e.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"처리 내역"}),s.middle_manager_comment&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"1차 승인자 코멘트"}),e.jsx("p",{className:"text-gray-900",children:s.middle_manager_comment})]}),s.final_manager_comment&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"최종 승인자 코멘트"}),e.jsx("p",{className:"text-gray-900",children:s.final_manager_comment})]}),s.purchase_comment&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"구매담당자 코멘트"}),e.jsx("p",{className:"text-gray-900",children:s.purchase_comment})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주 정보를 찾을 수 없습니다"}),e.jsxs(x,{onClick:()=>d("/purchase/list"),className:"mt-4",children:[e.jsx(o,{className:"w-4 h-4 mr-2"}),"목록으로 돌아가기"]})]})}export{R as default};
//# sourceMappingURL=PurchaseDetailMain-DrFJl20x.js.map
