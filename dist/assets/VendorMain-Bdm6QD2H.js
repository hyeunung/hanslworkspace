import{a as e,l as s,r as a,j as r,B as t,X as n,_ as c}from"./index-C_LZWDMs.js";import{I as l,D as i,a as d,b as o,c as x,d as m}from"./input-BXAHxv7g.js";import{S as h,a as j,b as p,c as u,d as v}from"./select-B2fM0VXz.js";import{D as g}from"./download-BQ2kl9g7.js";import{P as b}from"./plus-DYvLfpIT.js";import{S as N}from"./search-5XtlTa9E.js";import{f as _}from"./helpers-Buk9LCEc.js";import{B as f,t as w}from"./index-Cg1kW5Oo.js";import{T as y,a as k,b as S,c as C,d as E,e as V}from"./table-BpL_on_6.js";import{u as q,S as D,D as F,a as $,E as K,b as T,c as z,d as O,T as R,e as B,M as I,f as L,g as M,h as P,F as A,i as G,j as H,k as J,l as Q,m as U}from"./form-C4op7IRG.js";import{E as W}from"./eye-DFTwwy5_.js";import{T as X}from"./trash-2-BnoOXldD.js";import{T as Y}from"./textarea-CxIo3bw2.js";import{u as Z}from"./index.esm-BkQ4-epH.js";import"./chevron-down-C9q7C-vj.js";import"./check-OIpCvz6_.js";import"./chevron-right-BtLl7SDQ.js";import"./card-qkIi65Fs.js";import"./label-B7IZFTIU.js";const ee=new class{constructor(){this.supabase=e()}async getVendors(e){try{let s=this.supabase.from("vendors").select("*,vendor_contacts(*)").order("vendor_name");e?.search&&(s=s.or(`\n          vendor_name.ilike.%${e.search}%,\n          business_number.ilike.%${e.search}%,\n          representative.ilike.%${e.search}%,\n          contact_phone.ilike.%${e.search}%,\n          email.ilike.%${e.search}%\n        `)),void 0!==e?.is_active&&(s=s.eq("is_active",e.is_active));const{data:a,error:r}=await s;if(r)throw r;return{success:!0,data:a||[]}}catch(a){return s.error("업체 목록 조회 실패",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다."}}}async getVendor(e){try{const{data:s,error:a}=await this.supabase.from("vendors").select("*").eq("id",e).single();if(a)throw a;return{success:!0,data:s}}catch(a){return s.error("업체 조회 실패",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다."}}}async createVendor(e){try{if(e.business_number){const{data:s}=await this.supabase.from("vendors").select("id").eq("business_number",e.business_number).single();if(s)return{success:!1,error:"이미 등록된 사업자번호입니다."}}const{data:s}=await this.supabase.from("vendors").select("id").eq("vendor_name",e.vendor_name).single();if(s)return{success:!1,error:"이미 등록된 업체명입니다."};const{data:a,error:r}=await this.supabase.from("vendors").insert({...e,is_active:!0}).select().single();if(r)throw r;return{success:!0,data:a}}catch(a){return s.error("업체 생성 실패",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다."}}}async updateVendor(e,a){try{if(a.business_number){const{data:s}=await this.supabase.from("vendors").select("id").eq("business_number",a.business_number).neq("id",e).single();if(s)return{success:!1,error:"이미 등록된 사업자번호입니다."}}if(a.vendor_name){const{data:s}=await this.supabase.from("vendors").select("id").eq("vendor_name",a.vendor_name).neq("id",e).single();if(s)return{success:!1,error:"이미 등록된 업체명입니다."}}const{data:s,error:r}=await this.supabase.from("vendors").update(a).eq("id",e).select().single();if(r)throw r;return{success:!0,data:s}}catch(r){return s.error("업체 수정 실패",r),{success:!1,error:r instanceof Error?r.message:"알 수 없는 오류가 발생했습니다."}}}async deleteVendor(e){try{const{data:s}=await this.supabase.from("purchase_requests").select("id").eq("vendor_id",e).limit(1);if(s&&s.length>0){const{error:s}=await this.supabase.from("vendors").update({is_active:!1}).eq("id",e);if(s)throw s;return{success:!0}}{const{error:s}=await this.supabase.from("vendors").delete().eq("id",e);if(s)throw s;return{success:!0}}}catch(a){return s.error("업체 삭제 실패",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다."}}}async toggleVendorStatus(e){try{const{data:s,error:a}=await this.supabase.from("vendors").select("is_active").eq("id",e).single();if(a)throw a;const{data:r,error:t}=await this.supabase.from("vendors").update({is_active:!s.is_active}).eq("id",e).select().single();if(t)throw t;return{success:!0,data:r}}catch(a){return s.error("업체 상태 변경 실패",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다."}}}async getVendorContacts(e){try{const{data:s,error:a}=await this.supabase.from("vendor_contacts").select("*").eq("vendor_id",e).order("contact_name");if(a)throw a;return{success:!0,data:s||[]}}catch(a){return s.error("업체 연락처 조회 실패",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다."}}}async getVendorsForExport(){try{const{data:e,error:s}=await this.supabase.from("vendors").select("*").order("vendor_name");if(s)throw s;return{success:!0,data:(e||[]).map(e=>({"업체명":e.vendor_name,"사업자번호":e.business_number||"","대표자":e.representative||"","연락처":e.contact_phone||"","주소":e.address||"","이메일":e.email||"","상태":e.is_active?"활성":"비활성","등록일":e.created_at?new Date(e.created_at).toLocaleDateString("ko-KR"):""}))}}catch(e){return s.error("업체 Excel 내보내기 실패",e),{success:!1,error:e instanceof Error?e.message:"알 수 없는 오류가 발생했습니다."}}}};function se({filters:e,onFiltersChange:s,onExport:c,onCreateNew:i}){const[d,o]=a.useState(e.search||""),x=e.search||void 0!==e.is_active;return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"page-title",children:"업체 관리"}),r.jsx("p",{className:"page-subtitle",style:{marginTop:"-2px",marginBottom:"-4px"},children:"Vendors Management"})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(t,{variant:"outline",onClick:c,className:"flex items-center gap-1 sm:gap-2 badge-text",children:[r.jsx(g,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r.jsx("span",{className:"hidden sm:inline badge-text",children:"Excel 내보내기"}),r.jsx("span",{className:"sm:hidden badge-text",children:"Excel"})]}),r.jsxs(t,{onClick:i,className:"flex items-center gap-1 sm:gap-2 badge-text",children:[r.jsx(b,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r.jsx("span",{className:"badge-text",children:"업체 등록"})]})]})]}),r.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-lg border space-y-4",children:r.jsxs("form",{onSubmit:a=>{a.preventDefault(),s({...e,search:d.trim()||void 0})},className:"flex flex-col sm:flex-row gap-3 sm:gap-4 sm:items-end",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("label",{className:"block modal-label mb-1",children:"검색"}),r.jsxs("div",{className:"relative",children:[r.jsx(N,{className:"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3 sm:w-4 sm:h-4"}),r.jsx(l,{type:"text",placeholder:"업체명, 사업자번호, 연락처 검색",value:d,onChange:e=>o(e.target.value),className:"pl-8 sm:pl-10 modal-value h-9"})]})]}),r.jsxs("div",{className:"w-full sm:w-auto sm:min-w-[120px]",children:[r.jsx("label",{className:"block modal-label mb-1",children:"상태"}),r.jsxs(h,{value:void 0===e.is_active?"all":e.is_active?"active":"inactive",onValueChange:a=>{s({...e,is_active:"all"===a?void 0:"active"===a})},children:[r.jsx(j,{className:"h-9",children:r.jsx(p,{})}),r.jsxs(u,{children:[r.jsx(v,{value:"all",children:"전체"}),r.jsx(v,{value:"active",children:"활성"}),r.jsx(v,{value:"inactive",children:"비활성"})]})]})]}),r.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[r.jsx(t,{type:"submit",className:"flex-1 sm:flex-none h-9 badge-text",children:r.jsx("span",{className:"badge-text",children:"검색"})}),x&&r.jsxs(t,{type:"button",variant:"outline",onClick:()=>{o(""),s({})},className:"flex items-center gap-1 h-9 badge-text",children:[r.jsx(n,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r.jsx("span",{className:"hidden sm:inline badge-text",children:"초기화"}),r.jsx("span",{className:"sm:hidden badge-text",children:"초기"})]})]})]})})]})}function ae({vendors:e,onEdit:s,onView:n,onRefresh:c}){const[l,i]=a.useState(null),{sortedData:d,sortConfig:o,handleSort:x}=q(e,"vendor_name","asc"),m=async e=>{i(e.id);try{const s=await ee.toggleVendorStatus(e.id);s.success?(w.success(`업체가 ${e.is_active?"비활성화":"활성화"}되었습니다.`),c()):w.error(s.error||"상태 변경에 실패했습니다.")}catch(s){w.error("상태 변경 중 오류가 발생했습니다.")}finally{i(null)}},h=async e=>{if(confirm(`정말로 '${e.vendor_name}' 업체를 삭제하시겠습니까?`)){i(e.id);try{const s=await ee.deleteVendor(e.id);s.success?(w.success("업체가 삭제되었습니다."),c()):w.error(s.error||"삭제에 실패했습니다.")}catch(s){w.error("삭제 중 오류가 발생했습니다.")}finally{i(null)}}};return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"hidden lg:block border rounded-lg overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs(y,{children:[r.jsx(k,{children:r.jsxs(S,{children:[r.jsx(C,{className:"w-24 min-w-[80px] lg:w-32",children:r.jsx(D,{sortKey:"vendor_name",currentSortKey:o.key,sortDirection:o.direction,onSort:()=>x("vendor_name"),children:"업체명"})}),r.jsx(C,{className:"w-16 min-w-[50px] text-center",children:"담당자"}),r.jsx(C,{className:"min-w-[200px]",children:"담당자 정보"}),r.jsx(C,{className:"w-28 min-w-[110px]",children:"전화번호"}),r.jsx(C,{className:"w-28 min-w-[110px]",children:"팩스번호"}),r.jsx(C,{className:"w-24 min-w-[100px]",children:"지출예정일"}),r.jsx(C,{className:"w-20 min-w-[60px]",children:r.jsx(D,{sortKey:"created_at",currentSortKey:o.key,sortDirection:o.direction,onSort:()=>x("created_at"),children:"등록일"})}),r.jsx(C,{className:"w-14 min-w-[45px] text-center",children:"작업"})]})}),r.jsx(E,{children:0===e.length?r.jsx(S,{children:r.jsx(V,{colSpan:8,className:"text-center py-8 text-gray-500",children:"등록된 업체가 없습니다."})}):d.map(e=>r.jsxs(S,{children:[r.jsx(V,{className:"modal-value px-2 py-1.5",children:e.vendor_name}),r.jsx(V,{className:"text-center text-[11px] px-1 py-1.5",children:r.jsxs(f,{variant:"outline",className:"text-[10px] px-1 py-0",children:[e.vendor_contacts?.length||0,"명"]})}),r.jsx(V,{className:"px-2 py-1.5",children:r.jsxs("div",{className:"space-y-0.5",children:[e.vendor_contacts&&e.vendor_contacts.length>0?e.vendor_contacts.slice(0,2).map((e,s)=>r.jsxs("div",{className:"text-[10px]",children:[r.jsx("span",{className:"modal-value",children:e.contact_name}),r.jsx("span",{className:"text-gray-500 ml-1",children:e.contact_phone}),e.contact_email&&r.jsx("span",{className:"text-gray-500 ml-1 truncate inline-block max-w-[180px]",children:e.contact_email})]},s)):r.jsx("span",{className:"text-gray-400 text-[10px]",children:"담당자 없음"}),e.vendor_contacts&&e.vendor_contacts.length>2&&r.jsxs("span",{className:"text-[10px] text-gray-500",children:["외 ",e.vendor_contacts.length-2,"명"]})]})}),r.jsx(V,{className:"text-[11px] px-2 py-1.5",children:r.jsx("span",{className:"block truncate",title:e.vendor_phone||"",children:e.vendor_phone||"-"})}),r.jsx(V,{className:"text-[11px] px-2 py-1.5",children:r.jsx("span",{className:"block truncate",title:e.vendor_fax||"",children:e.vendor_fax||"-"})}),r.jsx(V,{className:"text-[11px] px-2 py-1.5",children:r.jsx("span",{className:"block truncate",title:e.vendor_payment_schedule||"",children:e.vendor_payment_schedule||"-"})}),r.jsx(V,{className:"text-[11px] px-2 py-1.5",children:_(e.created_at)}),r.jsx(V,{className:"px-1 py-1.5 text-center",children:r.jsxs(F,{children:[r.jsx($,{asChild:!0,children:r.jsx(t,{variant:"ghost",className:"h-7 w-7 p-0",disabled:l===e.id,children:r.jsx(K,{className:"h-3 w-3"})})}),r.jsxs(T,{align:"end",children:[r.jsxs(z,{onClick:()=>n(e),children:[r.jsx(W,{className:"mr-2 h-4 w-4"}),"상세 보기"]}),r.jsxs(z,{onClick:()=>s(e),children:[r.jsx(O,{className:"mr-2 h-4 w-4"}),"수정"]}),r.jsx(z,{onClick:()=>m(e),children:e.is_active?r.jsxs(r.Fragment,{children:[r.jsx(R,{className:"mr-2 h-4 w-4"}),"비활성화"]}):r.jsxs(r.Fragment,{children:[r.jsx(B,{className:"mr-2 h-4 w-4"}),"활성화"]})}),r.jsxs(z,{onClick:()=>h(e),className:"text-red-600",children:[r.jsx(X,{className:"mr-2 h-4 w-4"}),"삭제"]})]})]})})]},e.id))})]})})}),r.jsx("div",{className:"hidden md:block lg:hidden",children:r.jsx("div",{className:"overflow-x-auto border rounded-lg",children:r.jsxs("table",{className:"w-full min-w-[900px]",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"text-left p-3 header-title text-gray-900",children:"업체명"}),r.jsx("th",{className:"text-center p-3 header-title text-gray-900 w-20",children:"담당자"}),r.jsx("th",{className:"text-left p-3 header-title text-gray-900",children:"연락처"}),r.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-28",children:"전화번호"}),r.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-28",children:"팩스번호"}),r.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-24",children:"지출예정일"}),r.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-24",children:"등록일"}),r.jsx("th",{className:"text-center p-3 header-title text-gray-900 w-16",children:"작업"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===d.length?r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"text-center py-8 text-gray-500",children:"등록된 업체가 없습니다."})}):d.map(e=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"p-3 modal-value",children:e.vendor_name}),r.jsx("td",{className:"p-3 text-center",children:r.jsxs(f,{variant:"outline",className:"badge-text",children:[e.vendor_contacts?.length||0,"명"]})}),r.jsx("td",{className:"p-3 modal-subtitle",children:e.vendor_contacts&&e.vendor_contacts.length>0?r.jsxs("div",{children:[r.jsx("div",{className:"modal-value",children:e.vendor_contacts[0].contact_name}),r.jsx("div",{className:"text-gray-500 badge-text",children:e.vendor_contacts[0].contact_phone})]}):r.jsx("span",{className:"text-gray-400",children:"담당자 없음"})}),r.jsx("td",{className:"p-3 modal-subtitle",children:r.jsx("span",{className:"block truncate",title:e.vendor_phone||"",children:e.vendor_phone||"-"})}),r.jsx("td",{className:"p-3 modal-subtitle",children:r.jsx("span",{className:"block truncate",title:e.vendor_fax||"",children:e.vendor_fax||"-"})}),r.jsx("td",{className:"p-3 modal-subtitle",children:r.jsx("span",{className:"block truncate",title:e.vendor_payment_schedule||"",children:e.vendor_payment_schedule||"-"})}),r.jsx("td",{className:"p-3 modal-subtitle",children:_(e.created_at)}),r.jsx("td",{className:"p-3 text-center",children:r.jsxs(F,{children:[r.jsx($,{asChild:!0,children:r.jsx(t,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:r.jsx(K,{className:"h-4 w-4"})})}),r.jsxs(T,{align:"end",children:[r.jsxs(z,{onClick:()=>n(e),children:[r.jsx(W,{className:"mr-2 h-4 w-4"}),"상세 보기"]}),r.jsxs(z,{onClick:()=>s(e),children:[r.jsx(O,{className:"mr-2 h-4 w-4"}),"수정"]}),r.jsx(z,{onClick:()=>m(e),children:e.is_active?r.jsxs(r.Fragment,{children:[r.jsx(R,{className:"mr-2 h-4 w-4"}),"비활성화"]}):r.jsxs(r.Fragment,{children:[r.jsx(B,{className:"mr-2 h-4 w-4"}),"활성화"]})}),r.jsxs(z,{onClick:()=>h(e),className:"text-red-600",children:[r.jsx(X,{className:"mr-2 h-4 w-4"}),"삭제"]})]})]})})]},e.id))})]})})}),r.jsx("div",{className:"block md:hidden space-y-3",children:0===d.length?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"등록된 업체가 없습니다."}):d.map(e=>r.jsxs(I,{children:[r.jsx(L,{children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:e.vendor_name}),r.jsxs(f,{variant:"outline",children:[e.vendor_contacts?.length||0,"명"]})]})}),r.jsx(M,{label:"담당자",value:r.jsxs("div",{className:"space-y-1",children:[e.vendor_contacts&&e.vendor_contacts.length>0?e.vendor_contacts.slice(0,2).map((e,s)=>r.jsxs("div",{className:"modal-subtitle",children:[r.jsx("div",{className:"modal-value",children:e.contact_name}),r.jsx("div",{className:"text-gray-500 badge-text",children:e.contact_phone}),e.contact_email&&r.jsx("div",{className:"text-gray-500 badge-text",children:e.contact_email})]},s)):r.jsx("span",{className:"text-gray-400",children:"담당자 없음"}),e.vendor_contacts&&e.vendor_contacts.length>2&&r.jsxs("span",{className:"modal-subtitle text-gray-500",children:["외 ",e.vendor_contacts.length-2,"명"]})]})}),r.jsx(M,{label:"전화번호",value:e.vendor_phone||"-"}),r.jsx(M,{label:"팩스번호",value:e.vendor_fax||"-"}),r.jsx(M,{label:"지출예정일",value:e.vendor_payment_schedule||"-"}),r.jsx(M,{label:"등록일",value:_(e.created_at)}),r.jsxs(P,{children:[r.jsx(t,{size:"sm",variant:"outline",onClick:()=>n(e),children:r.jsx(W,{className:"w-4 h-4"})}),r.jsx(t,{size:"sm",variant:"outline",onClick:()=>s(e),children:r.jsx(O,{className:"w-4 h-4"})}),r.jsx(t,{size:"sm",variant:"outline",onClick:()=>m(e),disabled:l===e.id,children:e.is_active?r.jsx(R,{className:"w-4 h-4"}):r.jsx(B,{className:"w-4 h-4"})}),r.jsx(t,{size:"sm",variant:"outline",className:"text-red-600",onClick:()=>h(e),disabled:l===e.id,children:r.jsx(X,{className:"w-4 h-4"})})]})]},e.id))})]})}function re({isOpen:e,onClose:s,vendor:n,onSave:c,mode:h}){const[j,p]=a.useState(!1),u=Z({defaultValues:{vendor_name:"",business_number:"",representative:"",contact_phone:"",address:"",email:""}});a.useEffect(()=>{n&&e?u.reset({vendor_name:n.vendor_name||"",business_number:n.business_number||"",representative:n.representative||"",contact_phone:n.contact_phone||"",address:n.address||"",email:n.email||""}):!n&&e&&u.reset({vendor_name:"",business_number:"",representative:"",contact_phone:"",address:"",email:""})},[n,e,u]);const v="view"===h;return r.jsx(i,{open:e,onOpenChange:s,children:r.jsxs(d,{className:"w-full max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsx(o,{children:r.jsx(x,{children:(()=>{switch(h){case"create":return"업체 등록";case"edit":return"업체 수정";case"view":return"업체 상세";default:return"업체"}})()})}),r.jsx(A,{...u,children:r.jsxs("form",{onSubmit:u.handleSubmit(async e=>{p(!0);try{let a;"create"===h?a=await ee.createVendor(e):"edit"===h&&n&&(a=await ee.updateVendor(n.id,e)),a?.success?(w.success("create"===h?"업체가 등록되었습니다.":"업체 정보가 수정되었습니다."),c(),s()):w.error(a?.error||"처리 중 오류가 발생했습니다.")}catch(a){w.error("처리 중 오류가 발생했습니다.")}finally{p(!1)}}),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(G,{control:u.control,name:"vendor_name",rules:{required:"업체명을 입력해주세요."},render:({field:e})=>r.jsxs(H,{children:[r.jsx(J,{children:"업체명 *"}),r.jsx(Q,{children:r.jsx(l,{...e,placeholder:"업체명을 입력하세요",disabled:v})}),r.jsx(U,{})]})}),r.jsx(G,{control:u.control,name:"business_number",render:({field:e})=>r.jsxs(H,{children:[r.jsx(J,{children:"사업자번호"}),r.jsx(Q,{children:r.jsx(l,{...e,placeholder:"000-00-00000",disabled:v})}),r.jsx(U,{})]})}),r.jsx(G,{control:u.control,name:"representative",render:({field:e})=>r.jsxs(H,{children:[r.jsx(J,{children:"대표자"}),r.jsx(Q,{children:r.jsx(l,{...e,placeholder:"대표자명을 입력하세요",disabled:v})}),r.jsx(U,{})]})}),r.jsx(G,{control:u.control,name:"contact_phone",render:({field:e})=>r.jsxs(H,{children:[r.jsx(J,{children:"연락처"}),r.jsx(Q,{children:r.jsx(l,{...e,placeholder:"010-0000-0000",disabled:v})}),r.jsx(U,{})]})}),r.jsx(G,{control:u.control,name:"email",render:({field:e})=>r.jsxs(H,{children:[r.jsx(J,{children:"이메일"}),r.jsx(Q,{children:r.jsx(l,{...e,type:"email",placeholder:"company@example.com",disabled:v})}),r.jsx(U,{})]})})]}),r.jsx(G,{control:u.control,name:"address",render:({field:e})=>r.jsxs(H,{children:[r.jsx(J,{children:"주소"}),r.jsx(Q,{children:r.jsx(Y,{...e,placeholder:"주소를 입력하세요",className:"min-h-[80px]",disabled:v})}),r.jsx(U,{})]})}),"view"===h&&n&&r.jsx("div",{className:"pt-4 border-t",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4 modal-subtitle",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500",children:"상태:"}),r.jsx("span",{className:"ml-2 px-2 py-1 business-radius-badge badge-text "+(n.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:n.is_active?"활성":"비활성"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500",children:"등록일:"}),r.jsx("span",{className:"ml-2",children:n.created_at?new Date(n.created_at).toLocaleDateString("ko-KR"):"-"})]})]})}),r.jsxs(m,{className:"gap-2",children:[r.jsx(t,{type:"button",variant:"outline",onClick:s,children:"view"===h?"닫기":"취소"}),!v&&r.jsx(t,{type:"submit",disabled:j,children:j?"create"===h?"등록 중...":"수정 중...":"create"===h?"등록":"수정"})]})]})})]})})}function te(){const[e,s]=a.useState([]),[t,n]=a.useState([]),[l,i]=a.useState(!0),[d,o]=a.useState({}),[x,m]=a.useState(!1),[h,j]=a.useState(null),[p,u]=a.useState("create"),v=async()=>{i(!0);try{const e=await ee.getVendors(d);e.success&&e.data?(s(e.data),n(e.data)):w.error(e.error||"업체 목록을 불러오는데 실패했습니다.")}catch(e){w.error("업체 목록을 불러오는 중 오류가 발생했습니다.")}finally{i(!1)}};a.useEffect(()=>{v()},[d]);return l&&0===e.length?r.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"mt-2 card-subtitle",children:"업체 목록을 불러오는 중..."})]})}):r.jsx(r.Fragment,{children:r.jsxs("div",{className:"space-y-6",children:[r.jsx(se,{filters:d,onFiltersChange:o,onExport:async()=>{try{const e=await ee.getVendorsForExport();if(e.success&&e.data){const s=await c(()=>import("./xlsx-ByDo_lG2.js"),[]),a=s.utils.json_to_sheet(e.data),r=s.utils.book_new();s.utils.book_append_sheet(r,a,"업체 목록");const t=`업체_목록_${(new Date).toISOString().slice(0,10)}.xlsx`;s.writeFile(r,t),w.success("Excel 파일이 다운로드되었습니다.")}else w.error(e.error||"Excel 내보내기에 실패했습니다.")}catch(e){w.error("Excel 내보내기 중 오류가 발생했습니다.")}},onCreateNew:()=>{j(null),u("create"),m(!0)}}),r.jsxs("div",{className:"bg-white rounded-lg border",children:[r.jsx("div",{className:"p-4 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h3",{className:"modal-title",children:"업체 목록"}),r.jsxs("span",{className:"badge-base bg-blue-50 text-blue-600",children:["총 ",t.length,"개"]})]}),r.jsx("div",{className:"card-description",children:l&&"업데이트 중..."})]})}),r.jsx(ae,{vendors:t,onEdit:e=>{j(e),u("edit"),m(!0)},onView:e=>{j(e),u("view"),m(!0)},onRefresh:v})]}),r.jsx(re,{isOpen:x,onClose:()=>{m(!1),j(null)},vendor:h,onSave:()=>{v()},mode:p})]})})}export{te as default};
//# sourceMappingURL=VendorMain-Bdm6QD2H.js.map
