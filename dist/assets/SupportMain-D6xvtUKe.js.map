{"version":3,"file":"SupportMain-D6xvtUKe.js","sources":["../../node_modules/lucide-react/dist/esm/icons/image-plus.js","../../node_modules/lucide-react/dist/esm/icons/send.js","../../src/components/ui/date-range-picker.tsx","../../src/components/support/SupportMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M16 5h6\", key: \"1vod17\" }],\n  [\"path\", { d: \"M19 2v6\", key: \"4bpg5p\" }],\n  [\"path\", { d: \"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5\", key: \"1ue2ih\" }],\n  [\"path\", { d: \"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\", key: \"1xmnt7\" }],\n  [\"circle\", { cx: \"9\", cy: \"9\", r: \"2\", key: \"af1f0g\" }]\n];\nconst ImagePlus = createLucideIcon(\"image-plus\", __iconNode);\n\nexport { __iconNode, ImagePlus as default };\n//# sourceMappingURL=image-plus.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",\n      key: \"1ffxy3\"\n    }\n  ],\n  [\"path\", { d: \"m21.854 2.147-10.94 10.939\", key: \"12cjpa\" }]\n];\nconst Send = createLucideIcon(\"send\", __iconNode);\n\nexport { __iconNode, Send as default };\n//# sourceMappingURL=send.js.map\n","import * as React from \"react\"\nimport { CalendarIcon, X } from \"lucide-react\"\nimport { DateRange } from \"react-day-picker\"\nimport { ko } from \"date-fns/locale\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Calendar } from \"@/components/ui/calendar\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\n\ninterface DateRangePickerProps extends React.HTMLAttributes<HTMLDivElement> {\n  date?: DateRange\n  onDateChange?: (date: DateRange | undefined) => void\n  placeholder?: string\n  disabled?: boolean\n}\n\nexport function DateRangePicker({\n  className,\n  date,\n  onDateChange,\n  placeholder = \"ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”\",\n  disabled = false,\n  ...props\n}: DateRangePickerProps) {\n  const [open, setOpen] = React.useState(false)\n\n  const formatDateRange = (range: DateRange | undefined) => {\n    if (!range?.from) {\n      return placeholder\n    }\n\n    const formatDate = (date: Date) => {\n      return date.toLocaleDateString('ko-KR', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      })\n    }\n\n    if (range.from && range.to) {\n      // ê°™ì€ ë‹¬ì¸ì§€ í™•ì¸\n      const isSameMonth = range.from.getFullYear() === range.to.getFullYear() && \n                         range.from.getMonth() === range.to.getMonth()\n      \n      if (isSameMonth) {\n        const year = range.from.getFullYear()\n        const month = range.from.toLocaleDateString('ko-KR', { month: 'long' })\n        const fromDay = range.from.getDate()\n        const toDay = range.to.getDate()\n        return `${year}ë…„ ${month} ${fromDay}ì¼ - ${toDay}ì¼`\n      }\n      \n      return `${formatDate(range.from)} - ${formatDate(range.to)}`\n    }\n\n    return formatDate(range.from)\n  }\n\n  return (\n    <div className={cn(\"grid gap-2\", className)} {...props}>\n      <Popover open={open} onOpenChange={setOpen}>\n        <PopoverTrigger asChild>\n          <Button\n            id=\"date\"\n            variant=\"outline\"\n            className={cn(\n              \"w-full justify-start text-left font-normal h-9 text-sm border-gray-200 hover:border-gray-300 hover:bg-gray-50 transition-colors\",\n              !date && \"text-gray-500\",\n              date && \"text-gray-900\"\n            )}\n            disabled={disabled}\n          >\n            <CalendarIcon className=\"mr-2 h-4 w-4 text-gray-400\" />\n            <span className=\"truncate\">{formatDateRange(date)}</span>\n            {date && (\n              <X \n                className=\"ml-auto h-4 w-4 text-gray-400 hover:text-gray-600 transition-colors\" \n                onClick={(e) => {\n                  e.stopPropagation()\n                  onDateChange?.(undefined)\n                  setOpen(false)\n                }}\n              />\n            )}\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent className=\"w-auto p-0 shadow-lg border border-gray-200\" align=\"start\">\n          <div className=\"bg-white rounded-lg overflow-hidden\">\n            <div className=\"bg-gray-50 border-b border-gray-100 px-4 py-3\">\n              <h4 className=\"text-sm font-medium text-gray-900\">ê¸°ê°„ ì„ íƒ</h4>\n              <p className=\"text-xs text-gray-500 mt-1\">ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ì„ íƒí•˜ì„¸ìš”</p>\n            </div>\n            <div className=\"p-4\">\n              <Calendar\n                initialFocus\n                mode=\"range\"\n                defaultMonth={date?.from}\n                selected={date}\n                onSelect={(newDate) => {\n                  onDateChange?.(newDate)\n                  // ì¢…ë£Œì¼ì´ ì„ íƒë˜ë©´ ìë™ìœ¼ë¡œ íŒì˜¤ë²„ ë‹«ê¸°\n                  if (newDate?.from && newDate?.to) {\n                    setOpen(false)\n                  }\n                }}\n                numberOfMonths={2}\n                disabled={disabled}\n                locale={ko}\n                className=\"rounded-md\"\n                classNames={{\n                  months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n                  month: \"space-y-4\",\n                  caption: \"flex justify-center pt-1 relative items-center text-sm font-medium\",\n                  caption_label: \"text-sm font-medium text-gray-900\",\n                  nav: \"space-x-1 flex items-center\",\n                  nav_button: \"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none border border-input bg-background hover:bg-accent hover:text-accent-foreground h-7 w-7\",\n                  nav_button_previous: \"absolute left-1\",\n                  nav_button_next: \"absolute right-1\",\n                  table: \"w-full border-collapse space-y-1\",\n                  head_row: \"flex\",\n                  head_cell: \"text-gray-500 rounded-md w-9 font-normal text-[0.8rem]\",\n                  row: \"flex w-full mt-2\",\n                  cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n                  day: \"inline-flex items-center justify-center rounded-md text-sm font-normal ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 aria-selected:opacity-100 h-9 w-9 hover:bg-gray-100 hover:text-gray-900 text-gray-900\",\n                  day_range_start: \"day-range-start bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                  day_range_end: \"day-range-end bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                  day_selected: \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                  day_today: \"bg-accent text-accent-foreground font-semibold\",\n                  outside: \"!text-gray-400 !opacity-40 hover:!text-gray-500 hover:bg-gray-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",\n                  day_disabled: \"!text-gray-400 !opacity-40\",\n                  day_range_middle: \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n                  day_hidden: \"invisible\",\n                }}\n              />\n            </div>\n            {date && (\n              <div className=\"bg-gray-50 border-t border-gray-100 px-4 py-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-xs text-gray-600\">\n                    ì„ íƒëœ ê¸°ê°„: {formatDateRange(date)}\n                  </span>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => {\n                      onDateChange?.(undefined)\n                      setOpen(false)\n                    }}\n                    className=\"h-6 px-2 text-xs\"\n                  >\n                    ì§€ìš°ê¸°\n                  </Button>\n                </div>\n              </div>\n            )}\n          </div>\n        </PopoverContent>\n      </Popover>\n    </div>\n  )\n}","import React, { useState, useEffect, useRef } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { MessageCircle, Send, Calendar, Search, CheckCircle, Clock, AlertCircle, ChevronRight, ChevronLeft, ChevronDown, ChevronUp, Eye, X, Edit2, Trash2, Save, ImagePlus, Loader2 } from 'lucide-react'\nimport { supportService, type SupportInquiry, type SupportAttachment } from '@/services/supportService'\nimport { createClient } from '@/lib/supabase/client'\nimport { toast } from 'sonner'\nimport { removePurchaseFromMemory } from '@/stores/purchaseMemoryStore'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog'\nimport { DateRangePicker } from '@/components/ui/date-range-picker'\nimport { DateRange } from 'react-day-picker'\nimport PurchaseDetailModal from '@/components/purchase/PurchaseDetailModal'\n\nexport default function SupportMain() {\n  const [inquiryType, setInquiryType] = useState('')\n  const [subject, setSubject] = useState('')\n  const [message, setMessage] = useState('')\n  const [loading, setLoading] = useState(false)\n  \n  // ì²¨ë¶€íŒŒì¼ ê´€ë ¨\n  const [attachments, setAttachments] = useState<SupportAttachment[]>([])\n  const [uploadingImage, setUploadingImage] = useState(false)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  \n  // ë°œì£¼ìš”ì²­ ì„ íƒ ê´€ë ¨\n  const [showPurchaseSelect, setShowPurchaseSelect] = useState(false)\n  const [dateRange, setDateRange] = useState<DateRange | undefined>()\n  const [purchaseRequests, setPurchaseRequests] = useState<any[]>([])\n  const [selectedPurchase, setSelectedPurchase] = useState<any>(null)\n  const [searchingPurchase, setSearchingPurchase] = useState(false)\n  const [currentPage, setCurrentPage] = useState(1)\n  const [expandedPurchase, setExpandedPurchase] = useState<string | null>(null)\n  const itemsPerPage = 5\n  \n  // ë¬¸ì˜ ëª©ë¡ ê´€ë ¨\n  const [inquiries, setInquiries] = useState<SupportInquiry[]>([])\n  const [isAdmin, setIsAdmin] = useState<boolean | null>(null)\n  const [currentUserEmail, setCurrentUserEmail] = useState('')\n  const [currentUserId, setCurrentUserId] = useState<string>('')\n  const [currentUserRoles, setCurrentUserRoles] = useState<string[]>([])\n  const [loadingInquiries, setLoadingInquiries] = useState(true)\n  const [expandedInquiry, setExpandedInquiry] = useState<number | null>(null)\n  \n  // ëª¨ë‹¬ ê´€ë ¨\n  const [showDetailModal, setShowDetailModal] = useState(false)\n  const [selectedInquiryDetail, setSelectedInquiryDetail] = useState<any>(null)\n  const [loadingDetail, setLoadingDetail] = useState(false)\n  const [editingItemId, setEditingItemId] = useState<string | null>(null)\n  const [editingItem, setEditingItem] = useState<any>(null)\n\n  // ì „ì²´í•­ëª© íƒ­ ìƒì„¸ëª¨ë‹¬(PurchaseDetailModal) ì¬ì‚¬ìš©\n  const [purchaseDetailModalOpen, setPurchaseDetailModalOpen] = useState(false)\n  const [purchaseDetailId, setPurchaseDetailId] = useState<number | null>(null)\n  const [deleteConfirmOpen, setDeleteConfirmOpen] = useState(false)\n  const [purchaseToDelete, setPurchaseToDelete] = useState<any>(null)\n  const [purchaseMissingOpen, setPurchaseMissingOpen] = useState(false)\n  const [purchaseMissingMessage, setPurchaseMissingMessage] = useState('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n\n  // ì´ˆê¸° ë°ì´í„° ë¡œë“œ\n  useEffect(() => {\n    const init = async () => {\n      await checkUserRole()\n    }\n    init()\n    \n    // ì‹¤ì‹œê°„ êµ¬ë… ì„¤ì •\n    const subscription = supportService.subscribeToInquiries((payload) => {\n      // isAdmin í™•ì¸ ì „ì—ëŠ” ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ\n      if (isAdmin === null) return\n\n      const eventType = payload?.eventType as 'INSERT' | 'UPDATE' | 'DELETE' | undefined\n      const newRow = payload?.new as SupportInquiry | undefined\n      const oldRow = payload?.old as SupportInquiry | undefined\n\n      const isRelevantRow = (row?: SupportInquiry) => {\n        if (!row) return false\n        if (isAdmin) return true\n        return !!currentUserId && row.user_id === currentUserId\n      }\n\n      // ì´ë²¤íŠ¸ì— ë”°ë¼ inquiries stateë¥¼ ì§ì ‘ ê°±ì‹  (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì—†ì´ ì‹¤ì‹œê°„ ë°˜ì˜)\n      if (eventType === 'DELETE') {\n        const deletedId = oldRow?.id\n        if (!deletedId) return\n        setInquiries(prev => {\n          const next = prev.filter(i => i.id !== deletedId)\n          return next\n        })\n        if (expandedInquiry === deletedId) {\n          setExpandedInquiry(null)\n        }\n        return\n      }\n\n      // INSERT/UPDATE\n      const row = newRow\n      if (!row?.id) return\n\n      setInquiries(prev => {\n        // ë¹„ê´€ë¦¬ìëŠ” ë‚´ ë¬¸ì˜ë§Œ ìœ ì§€\n        const relevant = isRelevantRow(row)\n        const idx = prev.findIndex(i => i.id === row.id)\n\n        // ê´€ë ¨ ì—†ëŠ” rowë©´ ê¸°ì¡´ì— ìˆë˜ ê²ƒë§Œ ì œê±°\n        if (!relevant) {\n          if (idx === -1) return prev\n          const next = prev.filter(i => i.id !== row.id)\n          return next\n        }\n\n        // upsert\n        const next = [...prev]\n        if (idx >= 0) {\n          next[idx] = row\n        } else {\n          next.unshift(row)\n        }\n\n        // ìµœì‹ ìˆœ ì •ë ¬ (created_at ë‚´ë¦¼ì°¨ìˆœ)\n        next.sort((a, b) => {\n          const at = a.created_at ? new Date(a.created_at).getTime() : 0\n          const bt = b.created_at ? new Date(b.created_at).getTime() : 0\n          return bt - at\n        })\n        return next\n      })\n    })\n    \n    return () => {\n      subscription.unsubscribe()\n    }\n  }, [isAdmin, currentUserId, expandedInquiry])\n\n  // ì‚¬ìš©ì ê¶Œí•œ í™•ì¸\n  const checkUserRole = async () => {\n    const supabase = createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return\n\n    setCurrentUserEmail(user.email || '')\n    setCurrentUserId(user.id)\n\n    const { data: employee } = await supabase\n      .from('employees')\n      .select('purchase_role')\n      .eq('email', user.email)\n      .single()\n\n    if (employee) {\n      const roles = Array.isArray(employee.purchase_role)\n        ? employee.purchase_role\n        : employee.purchase_role?.split(',').map((r: string) => r.trim()) || []\n      \n      setCurrentUserRoles(roles)\n      const adminStatus = roles.includes('app_admin')\n      setIsAdmin(adminStatus)\n      \n      // ê¶Œí•œ í™•ì¸ í›„ ë°”ë¡œ ëª©ë¡ ë¡œë“œ\n      loadInquiriesWithRole(adminStatus)\n    }\n  }\n  \n  // ì—­í• ì— ë”°ë¼ ë¬¸ì˜ ëª©ë¡ ë¡œë“œ (ë‚´ë¶€ í•¨ìˆ˜)\n  const loadInquiriesWithRole = async (adminStatus: boolean) => {\n    setLoadingInquiries(true)\n    \n    const result = adminStatus \n      ? await supportService.getAllInquiries()\n      : await supportService.getMyInquiries()\n    \n    \n    if (result.success) {\n      setInquiries(result.data)\n    } else {\n    }\n    \n    setLoadingInquiries(false)\n  }\n\n  // ë¬¸ì˜ ëª©ë¡ ë¡œë“œ\n  const loadInquiries = async () => {\n    // ê¶Œí•œ í™•ì¸ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìœ¼ë©´ ëŒ€ê¸°\n    if (isAdmin === null) {\n      return;\n    }\n    \n    setLoadingInquiries(true)\n    \n    // ê´€ë¦¬ìë©´ ëª¨ë“  ë¬¸ì˜, ì•„ë‹ˆë©´ ë‚´ ë¬¸ì˜ë§Œ\n    const result = isAdmin \n      ? await supportService.getAllInquiries()\n      : await supportService.getMyInquiries()\n    \n    \n    if (result.success) {\n      setInquiries(result.data)\n    } else {\n    }\n    \n    setLoadingInquiries(false)\n  }\n\n  // ë¬¸ì˜ ìœ í˜• ë³€ê²½ ì‹œ\n  useEffect(() => {\n    if (inquiryType === 'modify' || inquiryType === 'delete') {\n      setShowPurchaseSelect(true)\n    } else {\n      setShowPurchaseSelect(false)\n      setSelectedPurchase(null)\n    }\n  }, [inquiryType])\n\n  // ë°œì£¼ìš”ì²­ ê²€ìƒ‰\n  const searchPurchaseRequests = async () => {\n    setSearchingPurchase(true)\n    setCurrentPage(1) // ê²€ìƒ‰ ì‹œ ì²« í˜ì´ì§€ë¡œ ë¦¬ì…‹\n    \n    const startDate = dateRange?.from ? dateRange.from.toISOString().split('T')[0] : undefined\n    const endDate = dateRange?.to ? dateRange.to.toISOString().split('T')[0] : undefined\n    \n    const result = await supportService.getMyPurchaseRequests(startDate, endDate)\n    \n    if (result.success) {\n      setPurchaseRequests(result.data)\n    } else {\n      toast.error(result.error || 'ë°œì£¼ìš”ì²­ ì¡°íšŒ ì‹¤íŒ¨')\n    }\n    \n    setSearchingPurchase(false)\n  }\n\n  // í˜ì´ì§€ë„¤ì´ì…˜ ê³„ì‚°\n  const totalPages = Math.ceil(purchaseRequests.length / itemsPerPage)\n  const startIndex = (currentPage - 1) * itemsPerPage\n  const endIndex = startIndex + itemsPerPage\n  const currentPurchaseRequests = purchaseRequests.slice(startIndex, endIndex)\n\n  // ë¬¸ì˜ ì œì¶œ\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    \n    if (!inquiryType || !subject || !message) {\n      toast.error('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.')\n      return\n    }\n    \n    // ìˆ˜ì •/ì‚­ì œ ìš”ì²­ì¸ë° ë°œì£¼ë¥¼ ì„ íƒí•˜ì§€ ì•Šì€ ê²½ìš°\n    if ((inquiryType === 'modify' || inquiryType === 'delete') && !selectedPurchase) {\n      toast.error('ìˆ˜ì •/ì‚­ì œí•  ë°œì£¼ìš”ì²­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.')\n      return\n    }\n\n    setLoading(true)\n    \n    // ë°œì£¼ ì •ë³´ë¥¼ í…ìŠ¤íŠ¸ë¡œ êµ¬ì„±\n    let finalMessage = message;\n    let purchaseInfo = '';\n    \n    if (selectedPurchase) {\n      const items = selectedPurchase.purchase_request_items || [];\n      const itemsText = items.map((item: any) => \n        `- ${item.item_name} (${item.specification}) ${item.quantity}ê°œ`\n      ).join('\\n');\n      \n      const poNumberText = selectedPurchase.purchase_order_number || '(ìŠ¹ì¸ëŒ€ê¸°)'\n      purchaseInfo = `ë°œì£¼ë²ˆí˜¸: ${selectedPurchase.purchase_order_number}\nì—…ì²´: ${selectedPurchase.vendor_name}\nìš”ì²­ì: ${selectedPurchase.requester_name}\nìš”ì²­ì¼: ${selectedPurchase.request_date}\ní’ˆëª©:\n${itemsText}`;\n      purchaseInfo = `ë°œì£¼ë²ˆí˜¸: ${poNumberText}\nì—…ì²´: ${selectedPurchase.vendor_name}\nìš”ì²­ì: ${selectedPurchase.requester_name}\nìš”ì²­ì¼: ${selectedPurchase.request_date || selectedPurchase.created_at || '-'}\ní’ˆëª©:\n${itemsText}`;\n\n      finalMessage = `${message}\n\n[ê´€ë ¨ ë°œì£¼ ì •ë³´]\n${purchaseInfo}`;\n    }\n\n    const result = await supportService.createInquiry({\n      inquiry_type: inquiryType as any,\n      subject,\n      message: finalMessage,\n      purchase_request_id: selectedPurchase?.id,\n      purchase_info: purchaseInfo,\n      purchase_order_number: selectedPurchase?.purchase_order_number,\n      attachments: attachments\n    })\n\n    if (result.success) {\n      toast.success('ë¬¸ì˜ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      // í¼ ì´ˆê¸°í™”\n      setInquiryType('')\n      setSubject('')\n      setMessage('')\n      setSelectedPurchase(null)\n      setPurchaseRequests([])\n      setDateRange(undefined)\n      setAttachments([])\n      // ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      loadInquiries()\n    } else {\n      toast.error(result.error || 'ë¬¸ì˜ ì ‘ìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')\n    }\n    \n    setLoading(false)\n  }\n\n  // ì´ë¯¸ì§€ ì²¨ë¶€ í•¸ë“¤ëŸ¬\n  const handleImageSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files\n    if (!files || files.length === 0) return\n\n    // ìµœëŒ€ 5ê°œ ì œí•œ\n    if (attachments.length >= 5) {\n      toast.error('ì²¨ë¶€íŒŒì¼ì€ ìµœëŒ€ 5ê°œê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.')\n      return\n    }\n\n    const file = files[0]\n    \n    // íŒŒì¼ í¬ê¸° ì œí•œ (5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      toast.error('íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.')\n      return\n    }\n\n    // ì´ë¯¸ì§€ íƒ€ì… í™•ì¸\n    if (!file.type.startsWith('image/')) {\n      toast.error('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì²¨ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.')\n      return\n    }\n\n    setUploadingImage(true)\n    const result = await supportService.uploadAttachment(file)\n    \n    if (result.success && result.data) {\n      setAttachments(prev => [...prev, result.data!])\n      toast.success('ì´ë¯¸ì§€ê°€ ì²¨ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.')\n    } else {\n      toast.error(result.error || 'ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨')\n    }\n    \n    setUploadingImage(false)\n    \n    // input ì´ˆê¸°í™” (ê°™ì€ íŒŒì¼ ë‹¤ì‹œ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡)\n    if (fileInputRef.current) {\n      fileInputRef.current.value = ''\n    }\n  }\n\n  // ì²¨ë¶€íŒŒì¼ ì‚­ì œ í•¸ë“¤ëŸ¬\n  const handleRemoveAttachment = async (index: number) => {\n    const attachment = attachments[index]\n    \n    // Storageì—ì„œ ì‚­ì œ\n    await supportService.deleteAttachment(attachment.path)\n    \n    // stateì—ì„œ ì œê±°\n    setAttachments(prev => prev.filter((_, i) => i !== index))\n    toast.success('ì²¨ë¶€íŒŒì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n  }\n\n  // ë¬¸ì˜ ìƒíƒœ ì—…ë°ì´íŠ¸ (ê´€ë¦¬ììš©)\n  const handleStatusUpdate = async (inquiryId: number, newStatus: 'in_progress' | 'resolved' | 'closed', resolutionNote?: string) => {\n    // resolved ìƒíƒœë¡œ ë³€ê²½ ì‹œ ë‹µë³€ ë‚´ìš© í™•ì¸\n    if (newStatus === 'resolved') {\n      const note = resolutionNote || prompt('ì²˜ë¦¬ ì™„ë£Œ ë‹µë³€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”:')\n      if (!note || note.trim() === '') {\n        toast.error('ë‹µë³€ ë‚´ìš©ì„ ì…ë ¥í•´ì•¼ ì™„ë£Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.')\n        return\n      }\n      \n      const result = await supportService.updateInquiryStatus(inquiryId, newStatus, note.trim())\n      \n      if (result.success) {\n        toast.success('ë¬¸ì˜ê°€ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n        loadInquiries()\n      } else {\n        toast.error(result.error || 'ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨')\n      }\n    } else {\n      const result = await supportService.updateInquiryStatus(inquiryId, newStatus)\n      \n      if (result.success) {\n        toast.success('ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.')\n        loadInquiries()\n      } else {\n        toast.error(result.error || 'ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨')\n      }\n    }\n  }\n\n  // ë¬¸ì˜ ì‚­ì œ\n  const handleDeleteInquiry = async (inquiryId: number) => {\n    if (!confirm('ì •ë§ë¡œ ì´ ë¬¸ì˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\nì‚­ì œëœ ë¬¸ì˜ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return\n\n    const result = await supportService.deleteInquiry(inquiryId)\n    \n    if (result.success) {\n      toast.success('ë¬¸ì˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n      loadInquiries()\n    } else {\n      toast.error(result.error || 'ë¬¸ì˜ ì‚­ì œ ì‹¤íŒ¨')\n    }\n  }\n\n  // ë¬¸ì˜ ìƒì„¸ ë³´ê¸°\n  const viewInquiryDetail = (inquiry: SupportInquiry) => {\n    setSelectedInquiryDetail(inquiry)\n    setShowDetailModal(true)\n  }\n\n  const openPurchaseDetailFromInquiry = async (inquiry: SupportInquiry) => {\n    try {\n      // 1) ê°€ì¥ ì •í™•í•œ ê°’: purchase_request_id (ì‹ ê·œ ë¬¸ì˜ë¶€í„° ì €ì¥ë¨)\n      if (inquiry.purchase_request_id) {\n        setPurchaseDetailId(inquiry.purchase_request_id)\n        setPurchaseDetailModalOpen(true)\n        return\n      }\n\n      // 2) ê³¼ê±° ë°ì´í„° í˜¸í™˜: purchase_order_numberë¡œ purchase_requestsì—ì„œ id ì¡°íšŒ\n      const orderNumber = inquiry.purchase_order_number?.trim()\n      if (!orderNumber) {\n        setPurchaseMissingMessage('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n        setPurchaseMissingOpen(true)\n        return\n      }\n\n      const supabase = createClient()\n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select('id')\n        .eq('purchase_order_number', orderNumber)\n        .limit(1)\n        .maybeSingle()\n\n      if (error) throw error\n      if (!data?.id) {\n        setPurchaseMissingMessage('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n        setPurchaseMissingOpen(true)\n        return\n      }\n\n      setPurchaseDetailId(data.id)\n      setPurchaseDetailModalOpen(true)\n    } catch (e) {\n      setPurchaseMissingMessage('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n      setPurchaseMissingOpen(true)\n    }\n  }\n\n  // í’ˆëª© ìˆ˜ì • ì‹œì‘\n  const startEditItem = (item: any) => {\n    setEditingItemId(item.id)\n    setEditingItem({\n      item_name: item.item_name,\n      specification: item.specification,\n      quantity: item.quantity,\n      unit_price_value: item.unit_price_value,\n      remark: item.remark\n    })\n  }\n\n  // í’ˆëª© ìˆ˜ì • ì·¨ì†Œ\n  const cancelEditItem = () => {\n    setEditingItemId(null)\n    setEditingItem(null)\n  }\n\n  // í’ˆëª© ìˆ˜ì • ì €ì¥\n  const saveEditItem = async (itemId: string) => {\n    if (!editingItem) return\n\n    const totalPrice = (editingItem.quantity || 0) * (editingItem.unit_price_value || 0)\n    const result = await supportService.updatePurchaseRequestItem(itemId, {\n      item_name: editingItem.item_name,\n      specification: editingItem.specification,\n      quantity: editingItem.quantity,\n      unit_price_value: editingItem.unit_price_value,\n      amount_value: totalPrice,\n      remark: editingItem.remark\n    })\n\n    if (result.success) {\n      toast.success('í’ˆëª©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      // ëª©ë¡ ìƒˆë¡œê³ ì¹¨ - ìƒì„¸ ì •ë³´ê°€ ìˆë‹¤ë©´ ë‹¤ì‹œ ë¡œë“œ\n      if (selectedInquiryDetail?.id) {\n        // Refresh logic can be implemented here if needed\n      }\n      cancelEditItem()\n    } else {\n      toast.error(result.error || 'í’ˆëª© ìˆ˜ì • ì‹¤íŒ¨')\n    }\n  }\n\n  // í’ˆëª© ì‚­ì œ\n  const deleteItem = async (itemId: string) => {\n    if (!confirm('ì´ í’ˆëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return\n\n    const result = await supportService.deletePurchaseRequestItem(itemId)\n\n    if (result.success) {\n      toast.success('í’ˆëª©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n      // ëª©ë¡ ìƒˆë¡œê³ ì¹¨ - ìƒì„¸ ì •ë³´ê°€ ìˆë‹¤ë©´ ë‹¤ì‹œ ë¡œë“œ\n      if (selectedInquiryDetail?.id) {\n        // Refresh logic can be implemented here if needed\n      }\n    } else {\n      toast.error(result.error || 'í’ˆëª© ì‚­ì œ ì‹¤íŒ¨')\n    }\n  }\n\n  // ë°œì£¼ìš”ì²­ ì „ì²´ ì‚­ì œ\n  const deletePurchaseRequest = async () => {\n    if (!selectedInquiryDetail?.id) return\n    if (!confirm('ì´ ë°œì£¼ìš”ì²­ ì „ì²´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\nëª¨ë“  í’ˆëª©ì´ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.')) return\n\n    const result = await supportService.deletePurchaseRequest(selectedInquiryDetail.id)\n\n    if (result.success) {\n      // ğŸš€ ë©”ëª¨ë¦¬ ìºì‹œì—ì„œ ì¦‰ì‹œ ì‚­ì œ (ì‹¤ì‹œê°„ ë°˜ì˜)\n      const memoryUpdated = removePurchaseFromMemory(selectedInquiryDetail.id)\n      if (!memoryUpdated) {\n        console.warn('[deletePurchaseRequest] ë©”ëª¨ë¦¬ ìºì‹œì—ì„œ ë°œì£¼ì„œ ì‚­ì œ ì‹¤íŒ¨', { \n          purchaseId: selectedInquiryDetail.id \n        })\n      } else {\n        console.info('âœ… [deletePurchaseRequest] ë©”ëª¨ë¦¬ ìºì‹œì—ì„œ ë°œì£¼ì„œ ì‚­ì œ ì„±ê³µ', { \n          purchaseId: selectedInquiryDetail.id \n        })\n      }\n\n      toast.success('ë°œì£¼ìš”ì²­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n      setShowDetailModal(false)\n      setSelectedInquiryDetail(null)\n      // ë¬¸ì˜ ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      loadInquiries()\n    } else {\n      toast.error(result.error || 'ë°œì£¼ìš”ì²­ ì‚­ì œ ì‹¤íŒ¨')\n    }\n  }\n\n  const handleConfirmDeleteFromPurchaseModal = async () => {\n    if (!purchaseToDelete?.id) {\n      toast.error('ì‚­ì œí•  ë°œì£¼ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    const supabase = createClient()\n\n    try {\n      const purchaseIdForDelete =\n        typeof purchaseToDelete.id === 'string' ? parseInt(purchaseToDelete.id, 10) : purchaseToDelete.id\n\n      if (!purchaseIdForDelete || Number.isNaN(purchaseIdForDelete)) {\n        toast.error('ë°œì£¼ IDê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.')\n        return\n      }\n\n      // 1) ë¬¸ì˜ ê¸°ë¡ ë³´ì¡´: support_inquiresì—ì„œ purchase_request_idë§Œ nullë¡œ ë³€ê²½\n      const { error: inquiryUpdateError } = await supabase\n        .from('support_inquires')\n        .update({ purchase_request_id: null })\n        .eq('purchase_request_id', purchaseIdForDelete)\n\n      if (inquiryUpdateError) {\n        // ì—¬ê¸°ì„œ ë§‰ì§€ ì•Šê³  ê³„ì† ì§„í–‰í•˜ë©´ FKë¡œ ì‚­ì œê°€ ì‹¤íŒ¨í•  ìˆ˜ ìˆì–´ ì¤‘ë‹¨í•˜ëŠ” í¸ì´ ì•ˆì „\n        throw inquiryUpdateError\n      }\n\n      // 2) í’ˆëª© ì‚­ì œ\n      const { error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .delete()\n        .eq('purchase_request_id', purchaseIdForDelete)\n      if (itemsError) throw itemsError\n\n      // 3) ë°œì£¼ìš”ì²­ ì‚­ì œ\n      const { error: requestError } = await supabase\n        .from('purchase_requests')\n        .delete()\n        .eq('id', purchaseIdForDelete)\n      if (requestError) throw requestError\n\n      // 4) ë©”ëª¨ë¦¬ ìºì‹œ ì¦‰ì‹œ ë°˜ì˜\n      removePurchaseFromMemory(purchaseIdForDelete)\n\n      toast.success('ë°œì£¼ìš”ì²­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. (ë¬¸ì˜ ê¸°ë¡ì€ ë³´ì¡´ë©ë‹ˆë‹¤)')\n\n      // UI ì •ë¦¬\n      setDeleteConfirmOpen(false)\n      setPurchaseToDelete(null)\n      setPurchaseDetailModalOpen(false)\n      setPurchaseDetailId(null)\n\n      // ë¬¸ì˜ ëª©ë¡ ê°±ì‹ \n      loadInquiries()\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : 'ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    } finally {\n      setDeleteConfirmOpen(false)\n      setPurchaseToDelete(null)\n    }\n  }\n\n  // ìƒíƒœ ë°°ì§€ ìŠ¤íƒ€ì¼\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'open':\n        return <span className=\"badge-stats bg-yellow-100 text-yellow-800\">ëŒ€ê¸°</span>\n      case 'in_progress':\n        return <span className=\"badge-stats bg-blue-100 text-blue-800\">ì²˜ë¦¬ì¤‘</span>\n      case 'resolved':\n        return <span className=\"badge-stats bg-green-100 text-green-800\">ì™„ë£Œ</span>\n      case 'closed':\n        return <span className=\"badge-stats bg-gray-100 text-gray-800\">ì¢…ë£Œ</span>\n      default:\n        return <span className=\"badge-stats border border-gray-300 bg-white text-gray-600\">-</span>\n    }\n  }\n\n  // ë¬¸ì˜ ìœ í˜• ë¼ë²¨\n  const getInquiryTypeLabel = (type: string) => {\n    switch (type) {\n      case 'bug': return 'ì˜¤ë¥˜ ì‹ ê³ '\n      case 'modify': return 'ìˆ˜ì • ìš”ì²­'\n      case 'delete': return 'ì‚­ì œ ìš”ì²­'\n      case 'other': return 'ê¸°íƒ€ ë¬¸ì˜'\n      default: return type\n    }\n  }\n\n  // ê¶Œí•œ í™•ì¸ ì¤‘ì¼ ë•Œ ë¡œë”© í‘œì‹œ\n  if (isAdmin === null) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">ê¶Œí•œ í™•ì¸ ì¤‘...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"w-full\">\n        {/* í—¤ë” */}\n        <div className=\"mb-4\">\n          <h1 className=\"page-title text-gray-900\">ë¬¸ì˜í•˜ê¸°</h1>\n          <p className=\"page-subtitle text-gray-600 mt-1\">\n            {isAdmin \n              ? 'ëª¨ë“  ë¬¸ì˜ë¥¼ ê´€ë¦¬í•˜ê³  ë‹µë³€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤'\n              : 'ì‹œìŠ¤í…œ ì‚¬ìš© ì¤‘ ê¶ê¸ˆí•˜ì‹  ì ì´ë‚˜ ê°œì„ ì‚¬í•­ì„ ì•Œë ¤ì£¼ì„¸ìš”'}\n          </p>\n        </div>\n\n        <div className={`${isAdmin ? 'max-w-4xl' : 'grid grid-cols-1 xl:grid-cols-2 gap-4'}`}>\n          {/* ë¬¸ì˜ ì‘ì„± í¼ - app_adminì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ í‘œì‹œ */}\n          {!isAdmin && (\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <MessageCircle className=\"w-5 h-5\" />\n                  ë¬¸ì˜ ë‚´ìš©\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-1\">\n                    ë¬¸ì˜ ìœ í˜• <span className=\"text-red-500\">*</span>\n                  </label>\n                  <Select value={inquiryType} onValueChange={setInquiryType}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"ë¬¸ì˜ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"bug\">ì˜¤ë¥˜ ì‹ ê³ </SelectItem>\n                      <SelectItem value=\"modify\">ìˆ˜ì • ìš”ì²­</SelectItem>\n                      <SelectItem value=\"delete\">ì‚­ì œ ìš”ì²­</SelectItem>\n                      <SelectItem value=\"other\">ê¸°íƒ€ ë¬¸ì˜</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* ìˆ˜ì •/ì‚­ì œ ìš”ì²­ ì‹œ ë°œì£¼ìš”ì²­ ì„ íƒ */}\n                {showPurchaseSelect && (\n                  <div className=\"space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                    <div className=\"modal-label text-blue-900\">\n                      ìˆ˜ì •/ì‚­ì œí•  ë°œì£¼ìš”ì²­ ì„ íƒ\n                    </div>\n                    \n                    <div>\n                      <label className=\"modal-label text-gray-600 mb-2 block\">ê¸°ê°„ ì„ íƒ</label>\n                      <DateRangePicker\n                        date={dateRange}\n                        onDateChange={setDateRange}\n                        placeholder=\"ë°œì£¼ìš”ì²­ ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”\"\n                        className=\"w-full\"\n                      />\n                    </div>\n                    \n                    <Button\n                      type=\"button\"\n                      onClick={searchPurchaseRequests}\n                      disabled={searchingPurchase}\n                      className=\"w-full h-9\"\n                      variant=\"outline\"\n                    >\n                      {searchingPurchase ? (\n                        <>\n                          <div className=\"w-4 h-4 border-2 border-gray-600 border-t-transparent rounded-full animate-spin mr-2\" />\n                          ê²€ìƒ‰ ì¤‘...\n                        </>\n                      ) : (\n                        <>\n                          <Search className=\"w-4 h-4 mr-2\" />\n                          ë°œì£¼ìš”ì²­ ê²€ìƒ‰\n                        </>\n                      )}\n                    </Button>\n                    \n                    {purchaseRequests.length > 0 && (\n                      <div className=\"space-y-3\">\n                        <div className=\"modal-label text-gray-600\">\n                          ë°œì£¼ìš”ì²­ ì„ íƒ (ì´ {purchaseRequests.length}ê±´)\n                        </div>\n                        \n                        {/* ë°œì£¼ìš”ì²­ ë¦¬ìŠ¤íŠ¸ */}\n                        <div className=\"space-y-1\">\n                          {currentPurchaseRequests.map((pr) => (\n                            <div key={pr.id} className=\"border rounded overflow-hidden\">\n                              <div\n                                onClick={() => setSelectedPurchase(pr)}\n                                className={`px-3 py-2 cursor-pointer transition-all badge-text ${\n                                  selectedPurchase?.id === pr.id\n                                    ? 'border-blue-500 bg-blue-50'\n                                    : 'hover:bg-gray-50'\n                                }`}\n                              >\n                                <div className=\"flex items-center justify-between gap-2\">\n                                  <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                                    <span className=\"modal-value whitespace-nowrap\">\n                                      {pr.purchase_order_number || '(ìŠ¹ì¸ëŒ€ê¸°)'}\n                                    </span>\n                                    {(pr.final_manager_status && pr.final_manager_status !== 'approved') && (\n                                      <span\n                                        className={`badge-stats whitespace-nowrap ${\n                                          pr.final_manager_status === 'rejected' || pr.middle_manager_status === 'rejected'\n                                            ? 'bg-red-100 text-red-800'\n                                            : 'bg-yellow-100 text-yellow-800'\n                                        }`}\n                                      >\n                                        {pr.final_manager_status === 'rejected' || pr.middle_manager_status === 'rejected'\n                                          ? 'ë°˜ë ¤'\n                                          : 'ìŠ¹ì¸ëŒ€ê¸°'}\n                                      </span>\n                                    )}\n                                    <span className=\"text-gray-600 truncate\">\n                                      {pr.vendor_name}\n                                    </span>\n                                    <span className=\"text-gray-500\">\n                                      {pr.purchase_request_items?.[0]?.item_name || 'í’ˆëª© ì—†ìŒ'}\n                                      {pr.purchase_request_items?.length > 1 && (\n                                        <span className=\"modal-value text-blue-600\">\n                                          {` ì™¸ ${pr.purchase_request_items.length - 1}ê±´`}\n                                        </span>\n                                      )}\n                                    </span>\n                                    <span className=\"text-gray-400 whitespace-nowrap ml-auto\">\n                                      {(pr.request_date || pr.created_at) && format(new Date(pr.request_date || pr.created_at), 'MM/dd')}\n                                    </span>\n                                  </div>\n                                  <div className=\"flex items-center gap-1\">\n                                    {selectedPurchase?.id === pr.id && (\n                                      <CheckCircle className=\"w-4 h-4 text-blue-500 flex-shrink-0\" />\n                                    )}\n                                    {pr.purchase_request_items?.length > 1 && (\n                                      <button\n                                        type=\"button\"\n                                        onClick={(e) => {\n                                          e.stopPropagation()\n                                          setExpandedPurchase(expandedPurchase === pr.id ? null : pr.id)\n                                        }}\n                                        className=\"p-1 hover:bg-gray-200 rounded\"\n                                      >\n                                        {expandedPurchase === pr.id ? (\n                                          <ChevronUp className=\"w-4 h-4\" />\n                                        ) : (\n                                          <ChevronDown className=\"w-4 h-4\" />\n                                        )}\n                                      </button>\n                                    )}\n                                  </div>\n                                </div>\n                              </div>\n                              \n                              {/* ìƒì„¸ í’ˆëª© ëª©ë¡ */}\n                              {expandedPurchase === pr.id && pr.purchase_request_items?.length > 0 && (\n                                <div className=\"px-3 py-2 bg-gray-50 border-t badge-text\">\n                                  <div className=\"space-y-1\">\n                                    <div className=\"modal-value text-gray-700 mb-1\">í’ˆëª© ìƒì„¸</div>\n                                    {pr.purchase_request_items.map((item: any, index: number) => (\n                                      <div key={index} className=\"flex items-center gap-2 text-gray-600 pl-2\">\n                                        <span className=\"text-gray-400\">{index + 1}.</span>\n                                        <span>{item.item_name}</span>\n                                        {item.specification && (\n                                          <span className=\"text-gray-500\">({item.specification})</span>\n                                        )}\n                                        <span className=\"text-gray-500\">- {item.quantity}ê°œ</span>\n                                      </div>\n                                    ))}\n                                  </div>\n                                </div>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                        \n                        {/* í˜ì´ì§€ë„¤ì´ì…˜ */}\n                        {totalPages > 1 && (\n                          <div className=\"flex justify-center items-center gap-1 pt-2\">\n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                              disabled={currentPage === 1}\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <ChevronLeft className=\"w-4 h-4\" />\n                            </Button>\n                            \n                            {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\n                              <Button\n                                key={page}\n                                type=\"button\"\n                                variant={currentPage === page ? \"default\" : \"outline\"}\n                                size=\"sm\"\n                                onClick={() => setCurrentPage(page)}\n                                className=\"h-8 w-8 p-0\"\n                              >\n                                {page}\n                              </Button>\n                            ))}\n                            \n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n                              disabled={currentPage === totalPages}\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <ChevronRight className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-1\">\n                    ì œëª© <span className=\"text-red-500\">*</span>\n                  </label>\n                  <Input\n                    value={subject}\n                    onChange={(e) => setSubject(e.target.value)}\n                    placeholder=\"ë¬¸ì˜ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”\"\n                    maxLength={100}\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-1\">\n                    ë‚´ìš© <span className=\"text-red-500\">*</span>\n                  </label>\n                  <Textarea\n                    value={message}\n                    onChange={(e) => setMessage(e.target.value)}\n                    placeholder=\"ë¬¸ì˜ ë‚´ìš©ì„ ìì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”\"\n                    rows={6}\n                    maxLength={1000}\n                  />\n                  <p className=\"badge-text text-gray-500 mt-1\">\n                    {message.length}/1000\n                  </p>\n                </div>\n\n                {/* ì‚¬ì§„ ì²¨ë¶€ ì˜ì—­ */}\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-2\">\n                    ì‚¬ì§„ ì²¨ë¶€ <span className=\"badge-text text-gray-400\">(ì„ íƒ, ìµœëŒ€ 5ê°œ)</span>\n                  </label>\n                  \n                  {/* ì²¨ë¶€ëœ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° */}\n                  {attachments.length > 0 && (\n                    <div className=\"flex flex-wrap gap-2 mb-3\">\n                      {attachments.map((attachment, index) => (\n                        <div key={index} className=\"relative group\">\n                          <img\n                            src={attachment.url}\n                            alt={attachment.name}\n                            className=\"w-20 h-20 object-cover rounded-lg border border-gray-200\"\n                          />\n                          <button\n                            type=\"button\"\n                            onClick={() => handleRemoveAttachment(index)}\n                            className=\"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\"\n                            title=\"ì‚­ì œ\"\n                          >\n                            <X className=\"w-3 h-3\" />\n                          </button>\n                          <p className=\"text-[10px] text-gray-500 mt-1 truncate w-20 text-center\">\n                            {attachment.name}\n                          </p>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                  \n                  {/* ì´ë¯¸ì§€ ì¶”ê°€ ë²„íŠ¼ */}\n                  {attachments.length < 5 && (\n                    <div className=\"flex items-center gap-2\">\n                      <input\n                        ref={fileInputRef}\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={handleImageSelect}\n                        className=\"hidden\"\n                      />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        disabled={uploadingImage}\n                        className=\"button-action-secondary disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {uploadingImage ? (\n                          <>\n                            <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\n                            ì—…ë¡œë“œ ì¤‘...\n                          </>\n                        ) : (\n                          <>\n                            <ImagePlus className=\"w-3.5 h-3.5\" />\n                            ì‚¬ì§„ ì¶”ê°€\n                          </>\n                        )}\n                      </button>\n                      <span className=\"badge-text text-gray-400\">\n                        {attachments.length}/5\n                      </span>\n                    </div>\n                  )}\n                </div>\n\n                <Button \n                  type=\"submit\" \n                  className=\"w-full\"\n                  disabled={loading || uploadingImage}\n                >\n                  {loading ? (\n                    <>\n                      <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                      ì „ì†¡ ì¤‘...\n                    </>\n                  ) : (\n                    <>\n                      <Send className=\"w-4 h-4 mr-2\" />\n                      ë¬¸ì˜ ë³´ë‚´ê¸°\n                    </>\n                  )}\n                </Button>\n              </form>\n            </CardContent>\n          </Card>\n          )}\n\n          {/* ë¬¸ì˜ ëª©ë¡ */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <span className=\"flex items-center gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-orange-500\" />\n                  {isAdmin ? 'ì „ì²´ ë¬¸ì˜ ëª©ë¡' : 'ë‚´ ë¬¸ì˜ ë‚´ì—­'}\n                </span>\n                <span className=\"badge-stats border border-gray-300 bg-white text-gray-600\">\n                  {inquiries.length}ê±´\n                </span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {loadingInquiries ? (\n                <div className=\"flex items-center justify-center py-8\">\n                  <div className=\"w-6 h-6 border-2 border-gray-300 border-t-transparent rounded-full animate-spin\" />\n                </div>\n              ) : inquiries.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500\">\n                  <MessageCircle className=\"w-12 h-12 mx-auto mb-3 text-gray-300\" />\n                  <p className=\"text-sm\">ë¬¸ì˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>\n                </div>\n              ) : (\n                <div className=\"space-y-1 max-h-[600px] overflow-y-auto\">\n                  {inquiries.map((inquiry) => (\n                    <div key={inquiry.id} className=\"border rounded overflow-hidden\">\n                      {/* ë¬¸ì˜ ìš”ì•½ (í•œ ì¤„) */}\n                      <div \n                        className=\"px-3 py-2 hover:bg-gray-50 transition-colors cursor-pointer\"\n                        onClick={() => {\n                          setExpandedInquiry(expandedInquiry === inquiry.id ? null : inquiry.id!)\n                        }}\n                      >\n                        <div className=\"flex items-center justify-between gap-2\">\n                          <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                            <span className=\"badge-stats border border-gray-300 bg-white text-gray-600 badge-text whitespace-nowrap\">\n                              {getInquiryTypeLabel(inquiry.inquiry_type)}\n                            </span>\n                            {getStatusBadge(inquiry.status)}\n                            <span className=\"modal-label truncate\">\n                              {inquiry.subject}\n                            </span>\n                            {isAdmin && (\n                              <span className=\"badge-text text-gray-500\">\n                                {inquiry.user_name || inquiry.user_email}\n                              </span>\n                            )}\n                            {inquiry.purchase_order_number && (\n                              <button\n                                type=\"button\"\n                                className=\"badge-text text-blue-600 hover:underline\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  openPurchaseDetailFromInquiry(inquiry)\n                                }}\n                                title=\"ë°œì£¼ ìƒì„¸ ì—´ê¸°\"\n                              >\n                                [{inquiry.purchase_order_number}]\n                              </button>\n                            )}\n                            <span className=\"badge-text text-gray-400 ml-auto whitespace-nowrap\">\n                              {inquiry.created_at && format(new Date(inquiry.created_at), 'MM/dd HH:mm')}\n                            </span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            {isAdmin && inquiry.status === 'open' && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"outline\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleStatusUpdate(inquiry.id!, 'in_progress')\n                                }}\n                                className=\"h-6 badge-text px-2\"\n                              >\n                                ì²˜ë¦¬ì¤‘\n                              </Button>\n                            )}\n                            {isAdmin && (inquiry.status === 'open' || inquiry.status === 'in_progress') && (\n                              <Button\n                                size=\"sm\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleStatusUpdate(inquiry.id!, 'resolved')\n                                }}\n                                className=\"h-6 badge-text px-2 bg-green-600 hover:bg-green-700\"\n                              >\n                                ì™„ë£Œ\n                              </Button>\n                            )}\n                            {/* ì‚­ì œ ë²„íŠ¼ - ê´€ë¦¬ìëŠ” ëª¨ë“  ë¬¸ì˜ ì‚­ì œ ê°€ëŠ¥, ì¼ë°˜ ì‚¬ìš©ìëŠ” ë³¸ì¸ì˜ open ìƒíƒœë§Œ */}\n                            {(isAdmin || (inquiry.status === 'open' && !inquiry.resolution_note && inquiry.user_email === currentUserEmail)) && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"ghost\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleDeleteInquiry(inquiry.id!)\n                                }}\n                                className=\"h-6 w-6 p-0 hover:bg-red-50\"\n                                title=\"ë¬¸ì˜ ì‚­ì œ\"\n                              >\n                                <Trash2 className=\"w-3 h-3 text-red-600\" />\n                              </Button>\n                            )}\n                            <button\n                              type=\"button\"\n                              className=\"p-1 hover:bg-gray-200 rounded\"\n                            >\n                              {expandedInquiry === inquiry.id ? (\n                                <ChevronUp className=\"w-4 h-4\" />\n                              ) : (\n                                <ChevronDown className=\"w-4 h-4\" />\n                              )}\n                            </button>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {/* ìƒì„¸ ë‚´ì—­ */}\n                      {expandedInquiry === inquiry.id && (\n                        <div className=\"px-3 py-3 bg-gray-50 border-t text-sm\">\n                          <div className=\"space-y-2\">\n                            <div>\n                              <span className=\"modal-value text-gray-700\">ë‚´ìš©:</span>\n                              <p className=\"text-gray-600 mt-1 whitespace-pre-wrap\">{inquiry.message}</p>\n                            </div>\n                            {inquiry.purchase_order_number && (\n                              <div>\n                                <span className=\"modal-value text-gray-700\">ê´€ë ¨ ë°œì£¼ë²ˆí˜¸:</span>\n                                <button\n                                  type=\"button\"\n                                  className=\"text-blue-600 ml-2 hover:underline\"\n                                  onClick={(e) => {\n                                    e.stopPropagation()\n                                    openPurchaseDetailFromInquiry(inquiry)\n                                  }}\n                                  title=\"ë°œì£¼ ìƒì„¸ ì—´ê¸°\"\n                                >\n                                  {inquiry.purchase_order_number}\n                                </button>\n                              </div>\n                            )}\n                            {inquiry.handled_by && (\n                              <div>\n                                <span className=\"modal-value text-gray-700\">ì²˜ë¦¬ì:</span>\n                                <span className=\"text-green-600 ml-2\">\n                                  {inquiry.handled_by}\n                                  {inquiry.processed_at && ` (${format(new Date(inquiry.processed_at), 'yyyy-MM-dd HH:mm')})`}\n                                </span>\n                              </div>\n                            )}\n                            {inquiry.resolution_note && (\n                              <div>\n                                <span className=\"modal-value text-gray-700\">ì²˜ë¦¬ ë‚´ìš©:</span>\n                                <p className=\"text-gray-600 mt-1\">{inquiry.resolution_note}</p>\n                              </div>\n                            )}\n                            {/* ì²¨ë¶€ ì´ë¯¸ì§€ */}\n                            {inquiry.attachments && inquiry.attachments.length > 0 && (\n                              <div>\n                                <span className=\"modal-value text-gray-700\">ì²¨ë¶€ ì´ë¯¸ì§€:</span>\n                                <div className=\"flex flex-wrap gap-2 mt-2\">\n                                  {inquiry.attachments.map((attachment, index) => (\n                                    <a\n                                      key={index}\n                                      href={attachment.url}\n                                      target=\"_blank\"\n                                      rel=\"noopener noreferrer\"\n                                      className=\"block\"\n                                      onClick={(e) => e.stopPropagation()}\n                                    >\n                                      <img\n                                        src={attachment.url}\n                                        alt={attachment.name}\n                                        className=\"w-24 h-24 object-cover rounded-lg border border-gray-200 hover:border-blue-400 transition-colors cursor-pointer\"\n                                      />\n                                    </a>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* ë°œì£¼ìš”ì²­ ìƒì„¸ ëª¨ë‹¬ */}\n      <Dialog open={showDetailModal} onOpenChange={setShowDetailModal}>\n        <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center justify-between text-lg\">\n              <div className=\"flex items-center gap-2\">\n                <span>ë°œì£¼ìš”ì²­ ìƒì„¸</span>\n                {selectedInquiryDetail?.purchase_order_number && (\n                  <span className=\"badge-stats border border-gray-300 bg-white text-gray-600 font-normal\">\n                    {selectedInquiryDetail.purchase_order_number}\n                  </span>\n                )}\n              </div>\n              {isAdmin && selectedInquiryDetail && (\n                <Button\n                  variant=\"destructive\"\n                  size=\"sm\"\n                  onClick={deletePurchaseRequest}\n                  className=\"h-8 px-3\"\n                >\n                  <Trash2 className=\"w-4 h-4 mr-1\" />\n                  ì „ì²´ ì‚­ì œ\n                </Button>\n              )}\n            </DialogTitle>\n          </DialogHeader>\n          \n          {loadingDetail ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"w-6 h-6 border-2 border-gray-300 border-t-transparent rounded-full animate-spin\" />\n            </div>\n          ) : selectedInquiryDetail && (\n            <div className=\"space-y-6\">\n              {/* ê¸°ë³¸ ì •ë³´ */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg\">\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ë°œì£¼ë²ˆí˜¸</span>\n                  <p className=\"font-semibold text-sm mt-1\">{selectedInquiryDetail.purchase_order_number || 'N/A'}</p>\n                </div>\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ì—…ì²´ëª…</span>\n                  <p className=\"font-semibold text-sm mt-1\">{selectedInquiryDetail.vendor_name}</p>\n                </div>\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ìš”ì²­ì</span>\n                  <p className=\"font-semibold text-sm mt-1\">{selectedInquiryDetail.requester_name}</p>\n                </div>\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ìš”ì²­ì¼</span>\n                  <p className=\"font-semibold text-sm mt-1\">\n                    {selectedInquiryDetail.request_date && \n                      format(new Date(selectedInquiryDetail.request_date), 'yyyy-MM-dd')}\n                  </p>\n                </div>\n              </div>\n\n              {/* í’ˆëª© ëª©ë¡ - ê°œì„ ëœ ë””ìì¸ */}\n              <div>\n                <h3 className=\"font-semibold text-base mb-3\">í’ˆëª© ìƒì„¸</h3>\n                <div className=\"border rounded-lg overflow-x-auto\">\n                  <table className=\"w-full\">\n                    <thead className=\"bg-gray-50 border-b\">\n                      <tr>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 w-12\">ë²ˆí˜¸</th>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 min-w-[180px]\">í’ˆëª…</th>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 min-w-[150px]\">ê·œê²©</th>\n                        <th className=\"text-center badge-text modal-value text-gray-700 px-3 py-3 w-20\">ìˆ˜ëŸ‰</th>\n                        <th className=\"text-right badge-text modal-value text-gray-700 px-3 py-3 w-28\">ë‹¨ê°€</th>\n                        <th className=\"text-right badge-text modal-value text-gray-700 px-3 py-3 w-32\">ê¸ˆì•¡</th>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 min-w-[150px]\">ë¹„ê³ </th>\n                        <th className=\"text-center badge-text modal-value text-gray-700 px-3 py-3 w-16\">ë§í¬</th>\n                        {isAdmin && <th className=\"text-center badge-text modal-value text-gray-700 px-3 py-3 w-24\">ì‘ì—…</th>}\n                      </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-gray-200\">\n                      {selectedInquiryDetail.purchase_request_items?.map((item: any, index: number) => (\n                        <tr key={item.id} className=\"hover:bg-gray-50 transition-colors\">\n                          <td className=\"text-sm px-3 py-3 text-center modal-value text-gray-600\">\n                            {item.line_number || index + 1}\n                          </td>\n                          <td className=\"text-sm px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                value={editingItem?.item_name || ''}\n                                onChange={(e) => setEditingItem({...editingItem, item_name: e.target.value})}\n                                className=\"h-9 text-sm w-full\"\n                                autoFocus\n                              />\n                            ) : (\n                              <span className=\"modal-value text-gray-900\">{item.item_name}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                value={editingItem?.specification || ''}\n                                onChange={(e) => setEditingItem({...editingItem, specification: e.target.value})}\n                                className=\"h-9 text-sm w-full\"\n                              />\n                            ) : (\n                              <span className=\"text-gray-600\">{item.specification || '-'}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-center px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                type=\"number\"\n                                value={editingItem?.quantity || ''}\n                                onChange={(e) => setEditingItem({...editingItem, quantity: parseInt(e.target.value)})}\n                                className=\"h-9 text-sm text-center w-full\"\n                              />\n                            ) : (\n                              <span className=\"modal-value\">{item.quantity}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-right px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                type=\"number\"\n                                value={editingItem?.unit_price_value || ''}\n                                onChange={(e) => setEditingItem({...editingItem, unit_price_value: parseInt(e.target.value)})}\n                                className=\"h-9 text-sm text-right w-full\"\n                              />\n                            ) : (\n                              <span className=\"modal-value\">\n                                {item.unit_price_value ? `${parseFloat(item.unit_price_value).toLocaleString()}` : '-'}\n                              </span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-right px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <span className=\"font-semibold text-blue-600\">\n                                {((editingItem?.quantity || 0) * (editingItem?.unit_price_value || 0)).toLocaleString()}\n                              </span>\n                            ) : (\n                              <span className=\"font-semibold text-blue-600\">\n                                {item.amount_value ? `${parseFloat(item.amount_value).toLocaleString()}` : '-'}\n                              </span>\n                            )}\n                          </td>\n                          <td className=\"text-sm px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Textarea\n                                value={editingItem?.remark || ''}\n                                onChange={(e) => setEditingItem({...editingItem, remark: e.target.value})}\n                                className=\"h-9 text-sm w-full resize-none\"\n                                rows={1}\n                              />\n                            ) : (\n                              <span className=\"text-gray-600 badge-text\">{item.remark || '-'}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-center px-3 py-3\">\n                            {item.link ? (\n                              <a \n                                href={item.link} \n                                target=\"_blank\" \n                                rel=\"noopener noreferrer\" \n                                className=\"inline-flex items-center justify-center w-8 h-8 rounded hover:bg-blue-50 text-blue-600\"\n                              >\n                                <Eye className=\"w-4 h-4\" />\n                              </a>\n                            ) : (\n                              <span className=\"text-gray-400\">-</span>\n                            )}\n                          </td>\n                          {isAdmin && (\n                            <td className=\"text-sm text-center px-3 py-3\">\n                              {editingItemId === item.id ? (\n                                <div className=\"flex justify-center gap-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    onClick={() => saveEditItem(item.id)}\n                                    className=\"h-8 px-2 bg-green-600 hover:bg-green-700\"\n                                  >\n                                    <Save className=\"w-4 h-4 mr-1\" />\n                                    ì €ì¥\n                                  </Button>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={cancelEditItem}\n                                    className=\"h-8 px-2\"\n                                  >\n                                    ì·¨ì†Œ\n                                  </Button>\n                                </div>\n                              ) : (\n                                <div className=\"flex justify-center gap-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    onClick={() => startEditItem(item)}\n                                    className=\"h-8 w-8 p-0 hover:bg-blue-50\"\n                                  >\n                                    <Edit2 className=\"w-4 h-4 text-blue-600\" />\n                                  </Button>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    onClick={() => deleteItem(item.id)}\n                                    className=\"h-8 w-8 p-0 hover:bg-red-50\"\n                                  >\n                                    <Trash2 className=\"w-4 h-4 text-red-600\" />\n                                  </Button>\n                                </div>\n                              )}\n                            </td>\n                          )}\n                        </tr>\n                      ))}\n                    </tbody>\n                    <tfoot className=\"bg-gray-50 border-t-2\">\n                      <tr>\n                        <td colSpan={5} className=\"text-sm font-semibold text-right px-3 py-3\">\n                          í•©ê³„\n                        </td>\n                        <td className=\"text-sm font-bold text-right px-3 py-3 text-blue-600\">\n                          {selectedInquiryDetail.purchase_request_items\n                            ?.reduce((sum: number, item: any) => sum + (parseFloat(item.amount_value) || 0), 0)\n                            .toLocaleString()}\n                        </td>\n                        <td colSpan={isAdmin ? 3 : 2} className=\"px-3 py-3\"></td>\n                      </tr>\n                    </tfoot>\n                  </table>\n                </div>\n              </div>\n\n              {/* ë¹„ê³  */}\n              {selectedInquiryDetail.notes && (\n                <div>\n                  <h3 className=\"modal-value mb-2\">ë¹„ê³ </h3>\n                  <p className=\"page-subtitle text-gray-600 p-3 bg-gray-50 rounded-lg\">\n                    {selectedInquiryDetail.notes}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* ì „ì²´í•­ëª© íƒ­ ìƒì„¸ëª¨ë‹¬(ì¬ì‚¬ìš©) */}\n      <PurchaseDetailModal\n        purchaseId={purchaseDetailId}\n        isOpen={purchaseDetailModalOpen}\n        onClose={() => {\n          setPurchaseDetailModalOpen(false)\n          setPurchaseDetailId(null)\n        }}\n        currentUserRoles={currentUserRoles}\n        activeTab=\"done\"\n        onDelete={(purchase) => {\n          setPurchaseToDelete(purchase)\n          setDeleteConfirmOpen(true)\n        }}\n      />\n\n      {/* ì‚­ì œ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ (PurchaseDetailModal ì—°ë™) */}\n      <AlertDialog\n        open={deleteConfirmOpen}\n        onOpenChange={(open) => {\n          setDeleteConfirmOpen(open)\n          if (!open) setPurchaseToDelete(null)\n        }}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>ë°œì£¼ìš”ì²­ ë‚´ì—­ ì‚­ì œ</AlertDialogTitle>\n            <AlertDialogDescription>\n              ë°œì£¼ìš”ì²­ë²ˆí˜¸ <strong>{purchaseToDelete?.purchase_order_number || 'ì•Œ ìˆ˜ ì—†ìŒ'}</strong>ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n              <br />\n              ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>ì·¨ì†Œ</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmDeleteFromPurchaseModal}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              ì‚­ì œ\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* ì‚­ì œ/ì—†ìŒ ì•ˆë‚´ ëª¨ë‹¬ (ë¬¸ì˜ì—ì„œ ë°œì£¼ë¥¼ ëª» ì°¾ëŠ” ê²½ìš°) */}\n      <Dialog open={purchaseMissingOpen} onOpenChange={setPurchaseMissingOpen}>\n        <DialogContent\n          showCloseButton={false}\n          maxWidth=\"sm:max-w-md\"\n          className=\"p-0 overflow-hidden\"\n        >\n          <div className=\"px-8 py-10 text-center\">\n            <div className=\"text-xl font-semibold text-gray-900\">ì•ˆë‚´</div>\n            <div className=\"mt-4 text-base text-gray-700 whitespace-pre-wrap\">\n              {purchaseMissingMessage}\n            </div>\n            <div className=\"mt-6 text-sm text-gray-400\">\n              í™”ë©´ì„ í´ë¦­í•˜ê±°ë‚˜ ESCë¡œ ë‹«ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}"],"names":["ImagePlus","createLucideIcon","d","key","cx","cy","r","Send","DateRangePicker","className","date","onDateChange","placeholder","disabled","props","open","setOpen","React.useState","formatDateRange","range","from","formatDate","toLocaleDateString","year","month","day","to","getFullYear","getMonth","getDate","jsx","cn","children","jsxs","Popover","onOpenChange","PopoverTrigger","asChild","Button","id","variant","CalendarIcon","X","onClick","e","stopPropagation","PopoverContent","align","Calendar","initialFocus","mode","defaultMonth","selected","onSelect","newDate","numberOfMonths","locale","ko","classNames","months","caption","caption_label","nav","nav_button","nav_button_previous","nav_button_next","table","head_row","head_cell","row","cell","day_range_start","day_range_end","day_selected","day_today","outside","day_disabled","day_range_middle","day_hidden","size","SupportMain","inquiryType","setInquiryType","useState","subject","setSubject","message","setMessage","loading","setLoading","attachments","setAttachments","uploadingImage","setUploadingImage","fileInputRef","useRef","showPurchaseSelect","setShowPurchaseSelect","dateRange","setDateRange","purchaseRequests","setPurchaseRequests","selectedPurchase","setSelectedPurchase","searchingPurchase","setSearchingPurchase","currentPage","setCurrentPage","expandedPurchase","setExpandedPurchase","inquiries","setInquiries","isAdmin","setIsAdmin","currentUserEmail","setCurrentUserEmail","currentUserId","setCurrentUserId","currentUserRoles","setCurrentUserRoles","loadingInquiries","setLoadingInquiries","expandedInquiry","setExpandedInquiry","showDetailModal","setShowDetailModal","selectedInquiryDetail","setSelectedInquiryDetail","loadingDetail","setLoadingDetail","editingItemId","setEditingItemId","editingItem","setEditingItem","purchaseDetailModalOpen","setPurchaseDetailModalOpen","purchaseDetailId","setPurchaseDetailId","deleteConfirmOpen","setDeleteConfirmOpen","purchaseToDelete","setPurchaseToDelete","purchaseMissingOpen","setPurchaseMissingOpen","purchaseMissingMessage","setPurchaseMissingMessage","useEffect","async","checkUserRole","init","subscription","supportService","subscribeToInquiries","payload","eventType","newRow","new","oldRow","old","deletedId","prev","filter","i","relevant","user_id","idx","findIndex","next","unshift","sort","a","b","at","created_at","Date","getTime","unsubscribe","supabase","createClient","data","user","auth","getUser","email","employee","select","eq","single","roles","Array","isArray","purchase_role","split","map","trim","adminStatus","includes","loadInquiriesWithRole","result","getAllInquiries","getMyInquiries","success","loadInquiries","totalPages","Math","ceil","length","startIndex","endIndex","currentPurchaseRequests","slice","handleStatusUpdate","inquiryId","newStatus","resolutionNote","note","prompt","toast","error","updateInquiryStatus","openPurchaseDetailFromInquiry","inquiry","purchase_request_id","orderNumber","purchase_order_number","limit","maybeSingle","cancelEditItem","getStatusBadge","status","getInquiryTypeLabel","type","Card","CardHeader","CardTitle","MessageCircle","CardContent","onSubmit","preventDefault","finalMessage","purchaseInfo","itemsText","purchase_request_items","item","item_name","specification","quantity","join","poNumberText","vendor_name","requester_name","request_date","createInquiry","inquiry_type","purchase_info","Select","value","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","startDate","toISOString","endDate","getMyPurchaseRequests","Fragment","Search","pr","final_manager_status","middle_manager_status","format","CheckCircle","ChevronUp","ChevronDown","index","max","ChevronLeft","_","page","min","ChevronRight","Input","onChange","target","maxLength","Textarea","rows","attachment","src","url","alt","name","deleteAttachment","path","handleRemoveAttachment","title","ref","accept","files","file","startsWith","uploadAttachment","current","click","Loader2","AlertCircle","user_name","user_email","resolution_note","confirm","deleteInquiry","handleDeleteInquiry","Trash2","handled_by","processed_at","href","rel","Dialog","DialogContent","DialogHeader","DialogTitle","deletePurchaseRequest","removePurchaseFromMemory","line_number","autoFocus","parseInt","unit_price_value","parseFloat","toLocaleString","amount_value","remark","link","Eye","itemId","totalPrice","updatePurchaseRequestItem","saveEditItem","Save","startEditItem","Edit2","deletePurchaseRequestItem","deleteItem","colSpan","reduce","sum","notes","PurchaseDetailModal","purchaseId","isOpen","onClose","activeTab","onDelete","purchase","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","purchaseIdForDelete","Number","isNaN","inquiryUpdateError","update","itemsError","delete","requestError","Error","showCloseButton","maxWidth"],"mappings":"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","x_google_ignoreList":[0,1]}