import{c as e,f as s,u as t,r as a,a as r,j as c,B as i,U as l,g as d}from"./index-C7cUK919.js";import{t as n,B as m}from"./index-DnVeObT1.js";import{C as x}from"./calendar-zagxOyBn.js";import{C as h}from"./credit-card-CpDNzeSD.js";
/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o=e("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function p(){const{id:e}=s(),p=t(),[g,j]=a.useState(!0),[u,N]=a.useState(null);a.useEffect(()=>{e&&y(e)},[e]);const y=async e=>{try{const s=r(),{data:t,error:a}=await s.from("purchase_requests").select("*,vendors(id,vendor_name),purchase_request_items(*)").eq("id",e).single();if(a)throw a;t&&N({...t,items:t.purchase_request_items||[],vendor:t.vendors||{id:0,vendor_name:"알 수 없음"},vendor_contacts:[]})}catch(s){n.error("발주 상세 정보를 불러오는데 실패했습니다.")}finally{j(!1)}},f=e=>{switch(e){case"approved":return c.jsx(m,{className:"bg-green-100 text-green-800",children:"승인"});case"rejected":return c.jsx(m,{className:"bg-red-100 text-red-800",children:"반려"});case"pending":return c.jsx(m,{className:"bg-yellow-100 text-yellow-800",children:"대기"});default:return c.jsx(m,{className:"bg-gray-100 text-gray-800",children:"-"})}};return g?c.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):u?c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>p("/purchase/list"),children:[c.jsx(o,{className:"w-4 h-4 mr-2"}),"목록으로"]}),c.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["발주 상세 - ",u.order_number]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"1차 승인"}),f(u.middle_manager_status)]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"최종 승인"}),f(u.final_manager_status)]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 처리"}),f(u.purchase_status||"pending")]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"납품 상태"}),(e=>{switch(e){case"completed":return c.jsx(m,{className:"bg-hansl-100 text-hansl-800",children:"납품완료"});case"partial":return c.jsx(m,{className:"bg-purple-100 text-purple-800",children:"부분납품"});case"pending":return c.jsx(m,{className:"bg-orange-100 text-orange-800",children:"납품대기"});default:return c.jsx(m,{className:"bg-gray-100 text-gray-800",children:"-"})}})(u.delivery_status||"pending")]})]}),c.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"기본 정보"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[c.jsx(x,{className:"w-4 h-4 mr-2"}),"요청일"]}),c.jsx("p",{className:"font-medium",children:u.created_at?new Date(u.created_at).toLocaleDateString("ko-KR"):"-"})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[c.jsx(l,{className:"w-4 h-4 mr-2"}),"요청자"]}),c.jsx("p",{className:"font-medium",children:u.requester_name||"-"})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[c.jsx(d,{className:"w-4 h-4 mr-2"}),"업체명"]}),c.jsx("p",{className:"font-medium",children:u.vendor?.vendor_name||"-"})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[c.jsx(h,{className:"w-4 h-4 mr-2"}),"총 금액"]}),c.jsxs("p",{className:"font-medium",children:[u.total_amount?.toLocaleString("ko-KR"),"원"]})]})]}),u.purpose&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 목적"}),c.jsx("p",{className:"text-gray-900",children:u.purpose})]})]}),c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"구매 품목"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"품목명"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"수량"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"단가"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"금액"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(u.items||[]).map((e,s)=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.item_name}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.quantity," ",e.unit||"개"]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.unit_price?.toLocaleString("ko-KR"),"원"]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((e.quantity||0)*(e.unit_price||0)).toLocaleString("ko-KR"),"원"]})]},s))})]})})]}),(u.middle_manager_comment||u.final_manager_comment||u.purchase_comment)&&c.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"처리 내역"}),u.middle_manager_comment&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"1차 승인자 코멘트"}),c.jsx("p",{className:"text-gray-900",children:u.middle_manager_comment})]}),u.final_manager_comment&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"최종 승인자 코멘트"}),c.jsx("p",{className:"text-gray-900",children:u.final_manager_comment})]}),u.purchase_comment&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"구매담당자 코멘트"}),c.jsx("p",{className:"text-gray-900",children:u.purchase_comment})]})]})]}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주 정보를 찾을 수 없습니다"}),c.jsxs(i,{onClick:()=>p("/purchase/list"),className:"mt-4",children:[c.jsx(o,{className:"w-4 h-4 mr-2"}),"목록으로 돌아가기"]})]})}export{p as default};
//# sourceMappingURL=PurchaseDetailMain-BB2XWTfm.js.map
