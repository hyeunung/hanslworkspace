const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-CA-txWfr.js","assets/index-40I3XaeF.js","assets/index-BwJZidja.css","assets/PurchaseItemsModal-B0dvQCyO.js","assets/input-D213dS1U.js","assets/table-CN_Ncl6a.js","assets/index-C5sgUsXU.js","assets/eye-Cfe-inYv.js","assets/download-CSFD9Xp0.js","assets/format-k21jkg81.js","assets/plus-CHzXahmH.js","assets/save-D5dsHQV8.js","assets/card-Dz0IkuCr.js"])))=>i.map(i=>d[i]);
import{r as i,a as pe,l as ge,j as e,_ as Ce,f as Se,g as ut,h as gt,i as ft,k as Q,m as $e,u as ht,n as _t,b as yt}from"./index-40I3XaeF.js";import{t as B,B as q}from"./index-C5sgUsXU.js";import{a as jt,P as vt}from"./PurchaseDetailModal-JTusHWUb.js";import{f as he}from"./helpers-BMiTuHMe.js";import{E as wt}from"./eye-Cfe-inYv.js";import{g as De,R as Nt,P as bt,W as Ct,C as St,T as $t,h as Dt,i as Ae,O as At,j as kt,I as ce}from"./input-D213dS1U.js";import{S as _e,a as ye,b as je,c as ve,d as ae}from"./select-DLi3yd7r.js";import{C as Pt}from"./combobox-CFPAfJLL.js";import{C as we,a as Et,b as Ft,c as Ne}from"./card-Dz0IkuCr.js";import{P as Rt}from"./plus-CHzXahmH.js";import{F as qt}from"./funnel-FtwuJPNm.js";import{S as It}from"./search-DbP_5-pW.js";import"./format-k21jkg81.js";import"./chevron-down-Bcvg6Zyd.js";import"./popover-DczGRG8J.js";import"./calendar-v9YFQ2XB.js";import"./save-D5dsHQV8.js";const Ot=()=>{const[t,r]=i.useState([]),[s,a]=i.useState([]),[m,b]=i.useState([]),[v,j]=i.useState(!0),[y,f]=i.useState([]),[R,I]=i.useState(""),[C,z]=i.useState(""),[F,V]=i.useState(""),n=pe();i.useEffect(()=>{(async()=>{try{const[w,N,o]=await Promise.all([n.from("vendors").select("*"),n.from("employees").select("*"),n.auth.getUser()]);if(w.error)throw w.error;if(a(w.data||[]),N.error)throw N.error;if(b(N.data||[]),o.data.user&&!o.error){let x=null;if(o.data.user.email&&(x=(await n.from("employees").select("*").eq("email",o.data.user.email).maybeSingle()).data),x){let D=[];x.purchase_role&&(Array.isArray(x.purchase_role)?D=x.purchase_role.map(p=>String(p).trim()):D=String(x.purchase_role).split(",").map(A=>A.trim()).filter(A=>A.length>0)),f(D),I(x.name||x.full_name||""),z(x.email||""),V(x.id||"")}}}catch(w){ge.error("초기 데이터 로드 실패",w)}})()},[]);const c=i.useCallback(async()=>{j(!0);try{let _=m;if(_.length===0){const{data:p}=await n.from("employees").select("*");_=p||[]}const{data:{user:w},error:N}=await n.auth.getUser();if(N||!w){ge.error("사용자 인증 실패",N),B.error("로그인이 필요합니다."),j(!1);return}const{data:o,error:x}=await n.from("purchase_requests").select("*,vendors(vendor_name,vendor_payment_schedule),vendor_contacts(contact_name),purchase_request_items(*).order(line_number)").order("request_date",{ascending:!1}).limit(2e3);if(x)throw x;const D=(o||[]).map(p=>{const A=p.purchase_request_items?.[0]||{},k=_.find(S=>S.id===p.requester_id);return{id:Number(p.id),purchase_order_number:p.purchase_order_number,request_date:p.request_date,delivery_request_date:p.delivery_request_date,progress_type:p.progress_type,payment_completed_at:p.payment_completed_at,payment_category:p.payment_category,currency:p.currency,request_type:p.request_type,vendor:p.vendors||null,vendor_name:p.vendors?.vendor_name||"",vendor_payment_schedule:p.vendors?.vendor_payment_schedule||"",vendor_contacts:p.vendor_contacts||[],requester_id:p.requester_id,requester_name:p.requester_name,requester_full_name:k?.full_name||k?.name||p.requester_name||"",item_name:A.item_name||"",specification:A.specification||"",quantity:Number(A.quantity)||0,unit_price_value:Number(A.unit_price_value)||0,amount_value:Number(A.amount_value)||0,remark:A.remark||"",project_vendor:p.project_vendor,sales_order_number:p.sales_order_number,project_item:p.project_item,line_number:Number(A.line_number)||1,contact_name:p.vendor_contacts?.contact_name||"",middle_manager_status:p.middle_manager_status,final_manager_status:p.final_manager_status,is_received:!!p.is_received,received_at:p.received_at,is_payment_completed:!!p.is_payment_completed,is_po_download:!!p.is_po_download,link:A.link,items:p.purchase_request_items||[],total_amount:p.purchase_request_items?.reduce((S,K)=>S+(Number(K.amount_value)||0),0)||0,purchase_status:p.purchase_status||"pending"}});r(D)}catch(_){ge.error("발주 목록 로드 실패",_),B.error("발주 목록을 불러올 수 없습니다.")}finally{j(!1)}},[m]);return i.useEffect(()=>{c()},[c]),{purchases:t,vendors:s,employees:m,loading:v,currentUserRoles:y,currentUserName:R,currentUserEmail:C,currentUserId:F,refreshPurchases:c}};function Mt(t,r=500){const[s,a]=i.useState(t);return i.useEffect(()=>{const m=setTimeout(()=>{a(t)},r);return()=>{clearTimeout(m)}},[t,r]),s}const Tt=["정희웅"],Lt=(t,r,s,a,m)=>{const b=pe(),[v,j]=i.useState("pending"),[y,f]=i.useState(""),[R,I]=i.useState(""),[C,z]=i.useState(""),[F,V]=i.useState(""),[n,c]=i.useState(""),[_,w]=i.useState(""),[N,o]=i.useState(""),[x,D]=i.useState(""),p=new Date().getFullYear(),A=new Date(p,0,1).toISOString().split("T")[0],k=new Date().toISOString().split("T")[0],[S,K]=i.useState(A),[O,G]=i.useState(k),W=Mt(y,300),$=r?.includes("app_admin");r?.includes("final_approver"),r?.includes("middle_manager");const J=r?.includes("purchase_manager"),M=r?.includes("raw_material_manager")||r?.includes("consumable_manager")||r?.includes("purchase_manager"),U=i.useMemo(()=>!r||r.length===0?1:J?2:r.some(g=>["middle_manager","final_approver","app_admin","ceo"].includes(g))?3:1,[r,J]),Z=i.useCallback(g=>{if(!s)return"all";if(g==="purchase")return M||$?"all":s;switch(U){case 1:return g==="done"?"all":s;case 2:return g==="done"?"all":s;case 3:return"all";default:return s}},[s,U,M,$]);i.useEffect(()=>{if(!s)return;const g=Z(v);z(g)},[v,s,U,Z]);const ee=i.useMemo(()=>r.includes("purchase_manager")||r.includes("app_admin")?t:t.filter(g=>!Tt.includes(g.requester_name)),[t,r]),de=i.useMemo(()=>ee.filter(g=>{const d=g.request_date?g.request_date.split("T")[0]:"",h=!S||d>=S,P=!O||d<=O;return h&&P}),[ee,S,O]),te=i.useMemo(()=>de.filter(d=>{let h=!1;switch(v){case"pending":return h=["pending","대기","",null].includes(d.final_manager_status),h;case"purchase":{const P=d.payment_category==="구매 요청",le=!d.is_payment_completed,ie=(d.progress_type||"").includes("선진행"),xe=(d.progress_type||"").includes("일반"),ue=d.final_manager_status==="approved";return!P||!le?h=!1:h=ie||xe&&ue,h}case"receipt":{const P=!d.is_received,le=(d.progress_type||"").includes("선진행"),ie=d.final_manager_status==="approved";return h=P&&(le||ie),h}case"done":return h=!0,h;default:return!0}}),[de,v]),se=i.useMemo(()=>C&&C!=="all"&&C!=="전체"?te.filter(d=>d.requester_name===C):te,[te,C]),me=i.useMemo(()=>R?se.filter(g=>g.vendor_name===R):se,[se,R]),ne=i.useMemo(()=>{let g=me;if(F){const d=F.trim().toLowerCase();g=g.filter(h=>h.purchase_order_number?.toLowerCase().includes(d))}if(n){const d=n.trim().toLowerCase();g=g.filter(h=>h.items&&h.items.length>0?h.items.some(P=>P.item_name?.toLowerCase().includes(d)):!1)}if(_){const d=_.trim().toLowerCase();g=g.filter(h=>h.items&&h.items.length>0?h.items.some(P=>P.specification?.toLowerCase().includes(d)):!1)}if(N&&N!=="all"&&(g=g.filter(d=>{switch(N){case"pending":return!d.final_manager_status||d.final_manager_status==="pending"||d.final_manager_status==="대기";case"approved":return d.final_manager_status==="approved";case"rejected":return d.final_manager_status==="rejected"||d.middle_manager_status==="rejected";default:return!0}})),x){const d=x.trim().toLowerCase();g=g.filter(h=>h.items&&h.items.length>0?h.items.some(P=>P.remark?.toLowerCase().includes(d)):!1)}return g},[me,F,n,_,N,x]),u=i.useMemo(()=>{if(!W)return ne;const g=W.trim().toLowerCase();return ne.filter(d=>d.purchase_order_number?.toLowerCase().includes(g)||d.vendor_name?.toLowerCase().includes(g)||d.requester_name?.toLowerCase().includes(g)||d.project_vendor?.toLowerCase().includes(g)?!0:d.items&&d.items.length>0?d.items.some(h=>h.item_name&&h.item_name.toLowerCase().includes(g)||h.specification&&h.specification.toLowerCase().includes(g)):!1)},[ne,W]),L=i.useMemo(()=>[...u].sort((g,d)=>{const h=g.request_date?new Date(g.request_date).getTime():0;return(d.request_date?new Date(d.request_date).getTime():0)-h}),[u]),ot=i.useMemo(()=>{const d=ee.filter(E=>{const T=E.request_date?E.request_date.split("T")[0]:"",H=!S||T>=S,oe=!O||T<=O;return H&&oe}),h=E=>new Set(E.map(T=>T.purchase_order_number)).size,P=E=>{if(E==="purchase")return M||$?d:d.filter(H=>H.requester_name===s);const T=Z(E);return T==="all"||T==="전체"?d:d.filter(H=>H.requester_name===T)},le=P("pending"),ie=P("purchase"),xe=P("receipt"),ue=P("done"),ct=le.filter(E=>["pending","대기","",null].includes(E.final_manager_status)),dt=ie.filter(E=>{const T=E.payment_category==="구매 요청",H=!E.is_payment_completed;if(!T||!H)return!1;const oe=(E.progress_type||"").includes("선진행"),pt=(E.progress_type||"").includes("일반"),xt=E.final_manager_status==="approved";return oe||pt&&xt}),mt=xe.filter(E=>{const T=!E.is_received,H=(E.progress_type||"").includes("선진행"),oe=E.final_manager_status==="approved";return T&&(H||oe)});return{pending:h(ct),purchase:h(dt),receipt:h(mt),done:h(ue)}},[ee,S,O,U,s,Z,M,$]);return i.useEffect(()=>{(async()=>{const{data:{user:g}}=await b.auth.getUser();if(!g)return;const{data:d}=await b.from("user_preferences").select("period_start, period_end").eq("user_id",g.id).single();if(d){const h=d.period_start?new Date(d.period_start).toISOString().split("T")[0]:A,P=d.period_end?new Date(d.period_end).toISOString().split("T")[0]:k;K(h),G(P)}})()},[]),i.useEffect(()=>{(async()=>{const{data:{user:g}}=await b.auth.getUser();g&&(!S||!O||await b.from("user_preferences").upsert({user_id:g.id,period_start:S,period_end:O,updated_at:new Date().toISOString()}))})()},[S,O]),{activeTab:v,searchTerm:y,vendorFilter:R,dateFromFilter:S,dateToFilter:O,selectedEmployee:C,purchaseNumberFilter:F,itemNameFilter:n,specificationFilter:_,approvalStatusFilter:N,remarkFilter:x,setActiveTab:j,setSearchTerm:f,setVendorFilter:I,setDateFromFilter:K,setDateToFilter:G,setSelectedEmployee:z,setPurchaseNumberFilter:V,setItemNameFilter:c,setSpecificationFilter:w,setApprovalStatusFilter:o,setRemarkFilter:D,filteredPurchases:L,tabCounts:ot}},Bt=t=>{if(!t.items||t.items.length===0)return{received:0,total:0,percentage:0};const r=t.items.length,s=t.items.filter(m=>m.is_received||m.delivery_status==="received").length,a=r>0?Math.round(s/r*100):0;return{received:s,total:r,percentage:a}},ke=i.memo(({purchase:t})=>{const r=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",s={completed:{text:"입고완료",className:"bg-green-100 text-green-800"},inProgress:{text:"구매진행",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"반려",className:"bg-red-100 text-red-800"},pending:{text:"승인대기",className:"bg-yellow-100 text-yellow-800"}},{text:a,className:m}=s[r];return e.jsx(q,{className:`${m} text-xs`,children:a})});ke.displayName="StatusBadge";const Pe=i.memo(({purchase:t,onClick:r})=>{const s=Bt(t),a=t.progress_type==="선진행"||t.progress_type?.includes("선진행");return e.jsxs("div",{className:`bg-white rounded-lg border p-4 space-y-3 cursor-pointer transition-all hover:shadow-md ${a?"border-red-400 bg-red-50 hover:bg-red-100":"hover:bg-gray-50"}`,onClick:()=>r(t),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a?e.jsx(q,{className:"bg-red-500 text-white font-bold text-xs px-2 py-0.5",children:"선진행"}):e.jsx(q,{className:"bg-gray-200 text-gray-700 text-xs px-2 py-0.5",children:"일반"}),e.jsx("span",{className:"font-semibold text-sm text-gray-900",children:t.purchase_order_number||"-"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[he(t.request_date)," 요청"]})]}),e.jsx(ke,{purchase:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"요청자"}),e.jsx("span",{className:"font-medium",children:t.requester_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"업체"}),e.jsx("span",{className:"font-medium",children:t.vendor_name})]}),t.project_vendor&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJ업체"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_vendor})]}),t.project_item&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJ ITEM"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_item})]}),t.sales_order_number&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"수주번호"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.sales_order_number})]}),t.item_name&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"품목"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.item_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"금액"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[(t.amount_value||t.total_amount)?.toLocaleString()," ",t.currency]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"입고현황"}),e.jsxs("span",{className:"text-gray-700",children:[s.received,"/",s.total," (",s.percentage,"%)"]})]}),e.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${s.percentage===100?"bg-green-500":s.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${s.percentage}%`}})})]}),t.is_payment_completed!==void 0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"결제"}),t.is_payment_completed?e.jsx(q,{className:"bg-green-100 text-green-800 text-xs",children:"완료"}):e.jsx(q,{className:"bg-gray-100 text-gray-800 text-xs",children:"대기"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex items-center justify-center text-xs text-gray-500",children:[e.jsx(wt,{className:"w-3 h-3 mr-1"}),"클릭하여 상세보기"]})})]})});Pe.displayName="MobilePurchaseCard";function be(t){if(!t)return"";const r=new Date(t);return isNaN(r.getTime())?t:`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`}function fe(t){return t?["KRW","원","₩"].includes(t)?"₩":["USD","$","달러"].includes(t)?"$":["EUR","€"].includes(t)?"€":["JPY","엔","¥"].includes(t)||["CNY","위안","元"].includes(t)?"¥":t:""}async function zt(t){const r=await Ce(()=>import("./exceljs.min-CA-txWfr.js").then(n=>n.e),__vite__mapDeps([0,1,2])),s=new r.Workbook,a=s.addWorksheet("발주서",{pageSetup:{paperSize:9,orientation:"portrait",fitToPage:!0,fitToWidth:1,fitToHeight:1,horizontalCentered:!0,verticalCentered:!0,margins:{left:.3,right:.3,top:.5,bottom:.5,header:.2,footer:.2}}});a.getRow(1).height=29.8;for(let n=2;n<=60;n++)a.getRow(n).height=15.75;a.getRow(1).eachCell(n=>{n.font={...n.font||{},name:"맑은 고딕",size:20}});for(let n=2;n<=60;n++)a.getRow(n).eachCell(c=>{c.font={...c.font||{},name:"맑은 고딕",size:11}});a.mergeCells("A1:G1"),a.mergeCells("A2:B2"),a.mergeCells("C2:D2"),a.mergeCells("F2:G2"),a.mergeCells("A3:B3"),a.mergeCells("C3:D3"),a.mergeCells("F3:G3"),a.mergeCells("A4:B4"),a.mergeCells("C4:D4"),a.mergeCells("F4:G4"),a.mergeCells("A5:B5"),a.mergeCells("C5:D5"),a.mergeCells("F5:G5"),a.mergeCells("A6:B6"),a.mergeCells("C6:D6"),a.mergeCells("F6:G6"),a.mergeCells("A7:B7"),a.mergeCells("C7:D7"),a.mergeCells("F7:G7");try{const c=await(await fetch("/logo_KOR.png")).arrayBuffer(),_=s.addImage({buffer:c,extension:"png"}),w=a.getColumn("D").width||22,N=Math.max(1,w*7.2*.58)+4,o=34,x=3.5-.5,D=.5-.2;a.addImage(_,{tl:{col:x,row:D},ext:{width:N,height:o}})}catch{}a.getCell("D1").value="                발 주 서",a.getCell("D1").alignment={horizontal:"left",vertical:"middle",indent:1},a.getCell("D1").font={bold:!0,size:20},a.getCell("A2").value="업   체   명",a.getCell("A2").font={bold:!0},a.getCell("A3").value="담   당   자",a.getCell("A3").font={bold:!0},a.getCell("A4").value="청   구   일",a.getCell("A4").font={bold:!0},a.getCell("A5").value="TEL.",a.getCell("A5").font={bold:!0},a.getCell("A6").value="FAX.",a.getCell("A6").font={bold:!0},a.getCell("A7").value="입고요청일",a.getCell("A7").font={bold:!0},a.getCell("E2").value="구매요청자",a.getCell("E2").font={bold:!0},a.getCell("E3").value="주         소",a.getCell("E3").font={bold:!0},a.getCell("E4").value="발 주 번 호",a.getCell("E4").font={bold:!0},a.getCell("E5").value="TEL.",a.getCell("E5").font={bold:!0},a.getCell("E6").value="FAX.",a.getCell("E6").font={bold:!0},a.getCell("E7").value="지출 예정일",a.getCell("E7").font={bold:!0},a.getCell("F7").value=t.vendor_payment_schedule||"",a.getCell("C2").value=t.vendor_name,a.getCell("C3").value=t.vendor_contact_name||"",a.getCell("C4").value=be(t.request_date),a.getCell("C5").value=t.vendor_phone||"",a.getCell("C6").value=t.vendor_fax||"",a.getCell("C7").value=be(t.delivery_request_date),a.getCell("F2").value=t.requester_name,a.getCell("F3").value="대구광역시 달서구 성서공단북로305",a.getCell("F4").value=t.purchase_order_number,a.getCell("F5").value="(053) 626-7805",a.getCell("F6").value="(053) 657-7905",a.getCell("F5").alignment={horizontal:"center",vertical:"middle"},a.getCell("F6").alignment={horizontal:"center",vertical:"middle"};const m=["No","품명","규격","수량","단가","금액","비고"];for(let n=0;n<m.length;n++)a.getCell(String.fromCharCode(65+n)+"8").value=m[n],a.getCell(String.fromCharCode(65+n)+"8").font={bold:!0},n===6&&(a.getCell("G8").alignment={horizontal:"center",vertical:"middle"});const b=9,v=45,j=[...t.items].sort((n,c)=>n.line_number-c.line_number),y=j.length,f=b+Math.max(y,v);for(let n=0;n<j.length;n++){const c=j[n],_=b+n;a.getCell("A"+_).value=c.line_number;const w=a.getCell("B"+_);w.value=c.item_name,w.alignment={horizontal:"left",vertical:"middle"},a.getCell("C"+_).value=c.specification,a.getCell("C"+_).alignment={horizontal:"left",vertical:"middle"},a.getCell("D"+_).value=c.quantity;const N=fe(c.currency),o=c.unit_price_value!==void 0&&c.unit_price_value!==null?`${c.unit_price_value.toLocaleString()} ${N}`.trim():"";a.getCell("E"+_).value=o,a.getCell("E"+_).alignment={horizontal:"right",vertical:"middle"};const x=fe(c.currency),D=c.amount_value!==void 0&&c.amount_value!==null?`${c.amount_value.toLocaleString()} ${x}`.trim():"";a.getCell("F"+_).value=D,a.getCell("F"+_).alignment={horizontal:"right",vertical:"middle"};const p=a.getCell("G"+_);p.value=c.remark!==void 0&&c.remark!==null?String(c.remark):"",p.alignment={horizontal:"left",vertical:"middle",wrapText:!1,shrinkToFit:!0}}for(let n=y;n<v;n++){const c=b+n;for(let _=0;_<7;_++)a.getCell(String.fromCharCode(65+_)+c).value=""}a.mergeCells(`A${f}:E${f}`),a.getCell("A"+f).value="합계",a.getCell("A"+f).font={bold:!0};const R=fe(t.items[0]?.currency),I=t.items.reduce((n,c)=>n+(c.amount_value||0),0);a.getCell("F"+f).value=`${I.toLocaleString()} ${R}`.trim(),a.getCell("F"+f).alignment={horizontal:"right",vertical:"middle"};const C=f;for(let n=1;n<=C;n++)for(let c=1;c<=7;c++){const w=String.fromCharCode(64+c)+n,N=a.getCell(w),o=c===5||c===6,x=c===3,D=n>=b&&n<f;o&&(D||n===f)||x&&D||(N.alignment={horizontal:"center",vertical:"middle"}),N.border={top:{style:n===1||n===2||n===8||n===f?"medium":"thin"},left:{style:c===1?"medium":"thin"},right:{style:c===7?"medium":"thin"},bottom:{style:n===8||n===f||n===C?"medium":"thin"}}}for(let n=0;n<y;n++){const c=b+n;a.getCell("C"+c).alignment={horizontal:"left",vertical:"middle"}}for(let n=2;n<=7;n++)a.getCell("B"+n).border={...a.getCell("B"+n).border,right:{style:"medium"}},a.getCell("D"+n).border={...a.getCell("D"+n).border,right:{style:"medium"}},n<=6&&(a.getCell("E"+n).border={...a.getCell("E"+n).border,right:{style:"medium"}});a.getCell("E7").border={...a.getCell("E7").border,top:{style:"thin"},right:{style:"medium"}},a.getCell("G7").border={...a.getCell("G7").border,top:{style:"thin"}};for(let n=1;n<=7;n++){const c=a.getCell("A"+n).border||{};a.getCell("A"+n).border={...c,left:{style:"medium"}}}const z=a.getCell("A"+f).border||{};a.getCell("A"+f).border={...z,left:{style:"medium"}},Object.entries({A:4.7,B:23,C:30,D:11,E:15,F:16,G:37}).forEach(([n,c])=>{a.getColumn(n).width=c}),a.getRow(1).height=29.8,a.getRow(1).eachCell(n=>{n.font={...n.font||{},name:"맑은 고딕",size:20}});for(let n=2;n<=C;n++){const c=a.getRow(n);c.height=15.75,c.eachCell(_=>{_.font={..._.font||{},name:"맑은 고딕",size:11}})}for(let n=9;n<=C;n++)a.getCell("G"+n).alignment={horizontal:"left",vertical:"middle",wrapText:!1,shrinkToFit:!0},a.getCell("B"+n).alignment={horizontal:"left",vertical:"middle"};const V=await s.xlsx.writeBuffer();return new Blob([V],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}var Ee="AlertDialog",[Wt,$a]=ut(Ee,[De]),Y=De(),Fe=t=>{const{__scopeAlertDialog:r,...s}=t,a=Y(r);return e.jsx(Nt,{...a,...s,modal:!0})};Fe.displayName=Ee;var Vt="AlertDialogTrigger",Gt=i.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...a}=t,m=Y(s);return e.jsx(kt,{...m,...a,ref:r})});Gt.displayName=Vt;var Jt="AlertDialogPortal",Re=t=>{const{__scopeAlertDialog:r,...s}=t,a=Y(r);return e.jsx(bt,{...a,...s})};Re.displayName=Jt;var Ht="AlertDialogOverlay",qe=i.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...a}=t,m=Y(s);return e.jsx(At,{...m,...a,ref:r})});qe.displayName=Ht;var re="AlertDialogContent",[Yt,Kt]=Wt(re),Xt=ft("AlertDialogContent"),Ie=i.forwardRef((t,r)=>{const{__scopeAlertDialog:s,children:a,...m}=t,b=Y(s),v=i.useRef(null),j=Se(r,v),y=i.useRef(null);return e.jsx(Ct,{contentName:re,titleName:Oe,docsSlug:"alert-dialog",children:e.jsx(Yt,{scope:s,cancelRef:y,children:e.jsxs(St,{role:"alertdialog",...b,...m,ref:j,onOpenAutoFocus:gt(m.onOpenAutoFocus,f=>{f.preventDefault(),y.current?.focus({preventScroll:!0})}),onPointerDownOutside:f=>f.preventDefault(),onInteractOutside:f=>f.preventDefault(),children:[e.jsx(Xt,{children:a}),e.jsx(Ut,{contentRef:v})]})})})});Ie.displayName=re;var Oe="AlertDialogTitle",Me=i.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...a}=t,m=Y(s);return e.jsx($t,{...m,...a,ref:r})});Me.displayName=Oe;var Te="AlertDialogDescription",Le=i.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...a}=t,m=Y(s);return e.jsx(Dt,{...m,...a,ref:r})});Le.displayName=Te;var Qt="AlertDialogAction",Be=i.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...a}=t,m=Y(s);return e.jsx(Ae,{...m,...a,ref:r})});Be.displayName=Qt;var ze="AlertDialogCancel",We=i.forwardRef((t,r)=>{const{__scopeAlertDialog:s,...a}=t,{cancelRef:m}=Kt(ze,s),b=Y(s),v=Se(r,m);return e.jsx(Ae,{...b,...a,ref:v})});We.displayName=ze;var Ut=({contentRef:t})=>{const r=`\`${re}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${re}\` by passing a \`${Te}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${re}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return i.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(r)},[r,t]),null},Zt=Fe,ea=Re,Ve=qe,Ge=Ie,Je=Be,He=We,Ye=Me,Ke=Le;const ta=Zt,aa=ea,Xe=i.forwardRef(({className:t,...r},s)=>e.jsx(Ve,{className:Q("fixed inset-0 z-50 bg-black/40 backdrop-blur-sm","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:s}));Xe.displayName=Ve.displayName;const Qe=i.forwardRef(({className:t,...r},s)=>e.jsxs(aa,{children:[e.jsx(Xe,{}),e.jsx(Ge,{ref:s,className:Q("fixed left-[50%] top-[50%] z-50","w-full max-w-md translate-x-[-50%] translate-y-[-50%]","grid gap-4 bg-white border border-gray-200","rounded-lg p-6 shadow-professional-xl","duration-200","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]","data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",t),...r})]}));Qe.displayName=Ge.displayName;const Ue=({className:t,...r})=>e.jsx("div",{className:Q("flex flex-col space-y-2 text-left",t),...r});Ue.displayName="AlertDialogHeader";const Ze=({className:t,...r})=>e.jsx("div",{className:Q("flex flex-col-reverse sm:flex-row sm:justify-end gap-3",t),...r});Ze.displayName="AlertDialogFooter";const et=i.forwardRef(({className:t,...r},s)=>e.jsx(Ye,{ref:s,className:Q("text-lg font-semibold text-gray-800 tracking-tight",t),...r}));et.displayName=Ye.displayName;const tt=i.forwardRef(({className:t,...r},s)=>e.jsx(Ke,{ref:s,className:Q("text-sm text-gray-600",t),...r}));tt.displayName=Ke.displayName;const at=i.forwardRef(({className:t,...r},s)=>e.jsx(Je,{ref:s,className:Q($e(),t),...r}));at.displayName=Je.displayName;const rt=i.forwardRef(({className:t,...r},s)=>e.jsx(He,{ref:s,className:Q($e({variant:"outline"}),"mt-2 sm:mt-0",t),...r}));rt.displayName=He.displayName;const st=i.memo(({purchase:t})=>{const r=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",s={completed:{text:"입고완료",className:"bg-green-100 text-green-800"},inProgress:{text:"구매진행",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"반려",className:"bg-red-100 text-red-800"},pending:{text:"승인대기",className:"bg-yellow-100 text-yellow-800"}},{text:a,className:m}=s[r];return e.jsx(q,{className:m,children:a})});st.displayName="StatusBadge";const X=t=>!t||["KRW","원","₩"].includes(t)?"₩":["USD","$","달러"].includes(t)?"$":["EUR","€"].includes(t)?"€":["JPY","엔","¥"].includes(t)||["CNY","위안","元"].includes(t)?"¥":t,l={approvalStatus:"text-center w-20 min-w-[85px] max-w-[85px]",purchaseOrderNumber:"pl-2 w-36 min-w-[145px] max-w-[145px]",paymentCategory:"text-center w-20 min-w-[85px] max-w-[85px]",requesterName:"w-16 min-w-[68px] max-w-[68px]",requestDate:"w-20 min-w-[85px] max-w-[85px]",vendorName:"w-28 min-w-[115px] max-w-[115px]",contactName:"w-16 min-w-[68px] max-w-[68px]",deliveryRequestDate:"w-20 min-w-[85px] max-w-[85px]",itemName:"w-28 min-w-[120px] max-w-[120px]",specification:"w-64 min-w-[260px] max-w-[260px]",quantity:"text-center w-14 min-w-[60px] max-w-[60px]",unitPrice:"text-right w-24 min-w-[100px] max-w-[100px]",amount:"text-right w-24 min-w-[100px] max-w-[100px]",remark:"w-28 min-w-[115px] max-w-[115px]",paymentSchedule:"w-24 min-w-[100px] max-w-[100px]",projectVendor:"w-24 min-w-[105px] max-w-[105px]",salesOrderNumber:"w-28 min-w-[115px] max-w-[115px]",projectItem:"w-44 min-w-[180px] max-w-[180px]",receiptProgress:"text-center w-20 min-w-[85px] max-w-[85px]",status:"text-center w-20 min-w-[85px] max-w-[85px]",receipt:"text-center w-16 min-w-[70px] max-w-[70px]",paymentStatus:"text-center w-16 min-w-[70px] max-w-[70px]",link:"w-20 min-w-[85px] max-w-[85px]"},nt=i.memo(({purchase:t})=>{const r=t.middle_manager_status==="approved",s=t.middle_manager_status==="rejected",a=t.final_manager_status==="approved",m=t.final_manager_status==="rejected";return s||m?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"})}),e.jsx(q,{className:"bg-red-100 text-red-800 text-[11px] font-medium px-1.5 py-0",children:"반려"})]}):r&&a?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})}),e.jsx(q,{className:"bg-green-100 text-green-800 text-[11px] font-medium px-1.5 py-0",children:"승인완료"})]}):r&&!a&&!m?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(q,{className:"bg-yellow-100 text-yellow-800 text-[11px] font-medium px-1.5 py-0",children:"1차 승인"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(q,{className:"bg-gray-100 text-gray-600 text-[11px] font-medium px-1.5 py-0",children:"승인대기"})]})});nt.displayName="ApprovalStatusBadge";const ra=t=>{if(t.is_received)return{received:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{received:0,total:1,percentage:0};const r=t.items.length,s=t.items.filter(m=>m.is_received===!0).length,a=r>0?Math.round(s/r*100):0;return{received:s,total:r,percentage:a}},sa=t=>{if(t.is_payment_completed)return{completed:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{completed:0,total:1,percentage:0};const r=t.items.length,s=t.items.filter(m=>m.is_payment_completed===!0).length,a=r>0?Math.round(s/r*100):0;return{completed:s,total:r,percentage:a}},na=t=>{if(!t.items||t.items.length===0){if(t.is_received)return{percentage:100};if(t.is_payment_completed)return{percentage:80};const y=t.middle_manager_status==="rejected",f=t.final_manager_status==="rejected";if(y||f)return{percentage:0};const R=t.middle_manager_status==="approved",I=t.final_manager_status==="approved";return R&&I?{percentage:40}:{percentage:20}}const r=t.items.length,s=t.items.filter(y=>y.is_received===!0).length,a=t.items.filter(y=>y.is_payment_completed===!0).length;if(s===r)return{percentage:100};if(s>0){const y=Math.round(s/r*100);return{percentage:Math.min(80+Math.round(y*.2),99)}}if(a===r)return{percentage:80};if(a>0){const y=Math.round(a/r*100);return{percentage:Math.min(40+Math.round(y*.4),79)}}const m=t.middle_manager_status==="rejected",b=t.final_manager_status==="rejected";if(m||b)return{percentage:0};const v=t.middle_manager_status==="approved",j=t.final_manager_status==="approved";return v&&j?{percentage:40}:{percentage:20}},la=i.memo(({type:t})=>t==="선진행"||t?.includes("선진행")?e.jsx(q,{className:"bg-red-500 text-white font-bold text-[11px] px-2 py-0.5",children:"선진행"}):e.jsx(q,{className:"bg-gray-200 text-gray-700 text-[11px] px-2 py-0.5",children:"일반"}));la.displayName="ProgressTypeBadge";const lt=i.memo(({purchase:t,onClick:r,activeTab:s,isLeadBuyer:a,onPaymentComplete:m,onReceiptComplete:b,onExcelDownload:v})=>{const j=ra(t),y=sa(t),f=na(t),R=t.progress_type==="선진행"||t.progress_type?.includes("선진행");return e.jsxs("tr",{className:`border-b hover:bg-gray-100 cursor-pointer transition-colors ${R?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>r(t),children:[s==="pending"&&e.jsx("td",{className:`px-2 py-1.5 whitespace-nowrap ${l.approvalStatus}`,children:e.jsx(nt,{purchase:t})}),s==="purchase"&&e.jsx("td",{className:`px-2 py-1.5 ${l.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${y.percentage===100?"bg-blue-500":y.percentage>0?"bg-blue-400":"bg-gray-300"}`,style:{width:`${y.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[y.percentage,"%"]})]})}),s==="receipt"&&e.jsx("td",{className:`px-2 py-1.5 ${l.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${j.percentage===100?"bg-green-500":j.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${j.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[j.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 font-medium text-[11px] whitespace-nowrap ${l.purchaseOrderNumber}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[v&&e.jsx("img",{src:"/excels-icon.svg",alt:"엑셀 다운로드",width:"16",height:"16",className:`inline-block align-middle transition-transform p-0.5 rounded
                ${t.is_po_download?"border border-gray-400":""}
                ${t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?t.is_po_download?"cursor-pointer":"cursor-pointer hover:scale-110":"opacity-40 grayscale cursor-not-allowed"}`,onClick:async I=>{(t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved")&&(I.stopPropagation(),await v(t))},style:{pointerEvents:t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"auto":"none"},title:t.is_po_download?"다운로드 완료":"엑셀 발주서 다운로드"}),e.jsx("span",{className:"block truncate",title:t.purchase_order_number||"",children:t.purchase_order_number||"-"})]})}),(s==="pending"||s==="receipt"||s==="done"||!s)&&e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.paymentCategory}`,children:e.jsx(q,{className:`text-[11px] ${t.payment_category==="구매 요청"?"bg-blue-100 text-blue-800":t.payment_category==="발주"?"bg-green-100 text-green-800":t.payment_category==="경비 청구"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.payment_category==="구매 요청"?"구매요청":t.payment_category==="발주"?"발주요청":t.payment_category||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.requesterName}`,children:e.jsx("span",{className:"block truncate",title:t.requester_name||"",children:t.requester_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.requestDate}`,children:he(t.request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.vendorName}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_name||"",children:t.vendor_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.contactName}`,children:e.jsx("span",{className:"block truncate",title:t.contact_name||"",children:t.contact_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.deliveryRequestDate}`,children:he(t.delivery_request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.itemName}`,children:e.jsx("span",{className:"block truncate",title:t.item_name||"",children:t.item_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.specification}`,children:e.jsx("span",{className:"block truncate",title:t.specification||"",children:t.specification||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.quantity}`,children:t.quantity||0}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.unitPrice}`,children:t.unit_price_value?`${t.unit_price_value.toLocaleString()} ${X(t.currency||"KRW")}`:`0 ${X(t.currency||"KRW")}`}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] font-medium whitespace-nowrap ${l.amount}`,children:t.amount_value?`${t.amount_value.toLocaleString()} ${X(t.currency||"KRW")}`:t.total_amount?`${t.total_amount.toLocaleString()} ${X(t.currency||"KRW")}`:`0 ${X(t.currency||"KRW")}`}),s==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})})]}),s==="purchase"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"링크 보기"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),s==="receipt"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),(s==="done"||!s)&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"링크 보기"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${l.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${l.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})}),e.jsx("td",{className:`px-2 py-1.5 ${l.status}`,children:t.payment_category==="구매 요청"?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${f.percentage===100?"bg-green-500":f.percentage>=80?"bg-blue-500":f.percentage>=40?"bg-hansl-500":f.percentage>0?"bg-gray-400":"bg-red-500"}`,style:{width:`${f.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[f.percentage,"%"]})]}):e.jsx("span",{className:"text-gray-400 text-[11px]",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 ${l.receipt}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${j.percentage===100?"bg-green-500":j.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${j.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[j.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 ${l.paymentStatus}`,children:t.is_payment_completed?e.jsx(q,{className:"bg-green-100 text-green-800 text-[11px]",children:"완료"}):e.jsx(q,{className:"bg-gray-100 text-gray-800 text-[11px]",children:"대기"})})]})]})});lt.displayName="TableRow";const it=i.memo(({purchases:t,activeTab:r="done",currentUserRoles:s=[],onRefresh:a,onPaymentComplete:m,onReceiptComplete:b})=>{const[v,j]=i.useState(null),[y,f]=i.useState(!1),[R,I]=i.useState(!1),[C,z]=i.useState(null),F=pe(),V=s&&(s.includes("lead buyer")||s.includes("app_admin"));s.includes("final_approver")||s.includes("app_admin")||s.includes("ceo");const n=o=>{j(o.id),f(!0)},c=()=>{f(!1),j(null)},_=async o=>{try{const{data:x,error:D}=await F.from("purchase_requests").select("*").eq("purchase_order_number",o.purchase_order_number).single();if(D||!x){B.error("해당 발주요청번호의 데이터를 찾을 수 없습니다.");return}const{data:p,error:A}=await F.from("purchase_request_items").select("*").eq("purchase_order_number",o.purchase_order_number).order("line_number");if(A||!p||p.length===0){B.error("해당 발주요청번호의 품목 데이터를 찾을 수 없습니다.");return}const k={vendor_name:o.vendor_name,vendor_phone:"",vendor_fax:"",vendor_contact_name:"",vendor_payment_schedule:""};try{const $=x.vendor_id||o.vendor_id,J=x.contact_id||o.contact_id;if($){const{data:M}=await F.from("vendors").select("vendor_phone, vendor_fax, vendor_payment_schedule").eq("id",$).single();M&&(k.vendor_phone=M.vendor_phone||"",k.vendor_fax=M.vendor_fax||"",k.vendor_payment_schedule=M.vendor_payment_schedule||"")}if(J){const{data:M}=await F.from("vendor_contacts").select("contact_name, contact_phone, contact_email").eq("id",J).single();M&&(k.vendor_contact_name=M.contact_name||"")}}catch{}const S={purchase_order_number:x.purchase_order_number||"",request_date:x.request_date,delivery_request_date:x.delivery_request_date,requester_name:x.requester_name,vendor_name:k.vendor_name||"",vendor_contact_name:k.vendor_contact_name,vendor_phone:k.vendor_phone,vendor_fax:k.vendor_fax,project_vendor:x.project_vendor,sales_order_number:x.sales_order_number,project_item:x.project_item,vendor_payment_schedule:k.vendor_payment_schedule,items:p.map($=>({line_number:$.line_number,item_name:$.item_name,specification:$.specification,quantity:$.quantity,unit_price_value:$.unit_price_value,amount_value:$.amount_value,remark:$.remark,currency:x.currency||"KRW"}))},K=await zt(S),O=`발주서_${S.vendor_name}_${S.purchase_order_number}.xlsx`,G=window.URL.createObjectURL(K),W=document.createElement("a");W.href=G,W.download=O,document.body.appendChild(W),W.click(),document.body.removeChild(W),window.URL.revokeObjectURL(G),B.success("엑셀 파일이 다운로드되었습니다.");try{if(s&&s.includes("lead buyer")){const{error:J}=await F.from("purchase_requests").update({is_po_download:!0}).eq("purchase_order_number",o.purchase_order_number);J||a?.()}}catch{}}catch{B.error("엑셀 다운로드에 실패했습니다.")}},w=async()=>{if(C){try{const{error:o}=await F.from("purchase_request_items").delete().eq("purchase_request_id",C.id);if(o)throw o;const{error:x}=await F.from("purchase_requests").delete().eq("id",C.id);if(x)throw x;B.success("발주요청 내역이 삭제되었습니다."),a?.()}catch{B.error("삭제 중 오류가 발생했습니다.")}I(!1),z(null)}},N=i.useMemo(()=>{if(r==="pending")return e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.approvalStatus}`,children:"승인상태"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.purchaseOrderNumber}`,children:"발주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.paymentCategory}`,children:"결제종류"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.requesterName}`,children:"요청자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.requestDate}`,children:"청구일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${l.vendorName}`,children:"업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.contactName}`,children:"담당자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.deliveryRequestDate}`,children:"입고요청일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${l.itemName}`,children:"품명"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${l.specification}`,children:"규격"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.quantity}`,children:"수량"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.unitPrice}`,children:"단가"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.amount}`,children:"합계"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.salesOrderNumber}`,children:"수주번호"})]})});const o=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.purchaseOrderNumber}`,children:"발주번호"}),(r==="receipt"||r==="done"||!r)&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.paymentCategory}`,children:"결제종류"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.requesterName}`,children:"요청자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.requestDate}`,children:"청구일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.vendorName}`,children:"업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.contactName}`,children:"담당자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.deliveryRequestDate}`,children:"입고요청일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${l.itemName}`,children:"품명"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${l.specification}`,children:"규격"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.quantity}`,children:"수량"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.unitPrice}`,children:"단가"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.amount}`,children:"합계"})]});let x=null;return r==="purchase"?x=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.link}`,children:"링크"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.paymentSchedule}`,children:"지출예정일"})]}):r==="receipt"?x=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.salesOrderNumber}`,children:"수주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.paymentSchedule}`,children:"지출예정일"})]}):x=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.link}`,children:"링크"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.salesOrderNumber}`,children:"수주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${l.paymentSchedule}`,children:"지출예정일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.status}`,children:"구매진행"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.receipt}`,children:"입고진행"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.paymentStatus}`,children:"결제"})]}),e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[r==="purchase"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.receiptProgress}`,children:"구매진행"}),r==="receipt"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${l.receiptProgress}`,children:"입고진행"}),o,x]})})},[r]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-[1760px]",children:[N,e.jsx("tbody",{children:t.map(o=>e.jsx(lt,{purchase:o,onClick:n,activeTab:r,isLeadBuyer:V,onPaymentComplete:m,onReceiptComplete:b,onExcelDownload:_},o.id))})]})})}),e.jsx("div",{className:"hidden sm:block md:hidden w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-[600px] text-[11px]",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-24",children:"발주번호"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-16",children:"요청자"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-20",children:"업체"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-32",children:"품명"}),e.jsx("th",{className:"text-right p-2 font-medium text-gray-900 w-20",children:"금액"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-900 w-16",children:"상태"})]})}),e.jsx("tbody",{children:t.map(o=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 cursor-pointer",onClick:()=>n(o),children:[e.jsx("td",{className:"p-2 font-medium",children:o.purchase_order_number||"-"}),e.jsx("td",{className:"p-2",children:o.requester_name}),e.jsx("td",{className:"p-2 truncate",title:o.vendor_name,children:o.vendor_name}),e.jsx("td",{className:"p-2 truncate",title:o.item_name,children:o.item_name||"-"}),e.jsx("td",{className:"p-2 text-right font-medium",children:o.amount_value?`${o.amount_value.toLocaleString()} ${X(o.currency||"KRW")}`:o.total_amount?`${o.total_amount.toLocaleString()} ${X(o.currency||"KRW")}`:`0 ${X(o.currency||"KRW")}`}),e.jsx("td",{className:"p-2 text-center",children:e.jsx(st,{purchase:o})})]},o.id))})]})})}),e.jsx("div",{className:"sm:hidden space-y-3",children:t.map(o=>e.jsx(Pe,{purchase:o,onClick:()=>n(o)},o.id))}),e.jsx(jt,{purchaseId:v,isOpen:y,onClose:c,currentUserRoles:s,activeTab:r,onRefresh:a,onDelete:o=>{z(o),I(!0)}}),e.jsx(ta,{open:R,onOpenChange:I,children:e.jsxs(Qe,{children:[e.jsxs(Ue,{children:[e.jsx(et,{children:"발주요청 내역 삭제"}),e.jsxs(tt,{children:["발주요청번호 ",C?.purchase_order_number,"를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."]})]}),e.jsxs(Ze,{children:[e.jsx(rt,{children:"취소"}),e.jsx(at,{onClick:w,className:"bg-red-600 hover:bg-red-700",children:"삭제"})]})]})})]})});it.displayName="FastPurchaseTable";const ia=i.lazy(()=>Ce(()=>import("./PurchaseItemsModal-B0dvQCyO.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11,12]))),oa=[{key:"pending",label:"승인대기"},{key:"purchase",label:"구매 현황"},{key:"receipt",label:"입고 현황"},{key:"done",label:"전체 항목"}];function Da({onEmailToggle:t,showEmailButton:r=!0}){const s=ht(),a=_t(),m=pe(),[b,v]=i.useState(null),[j,y]=i.useState({}),[f,R]=i.useState(null),[I,C]=i.useState(!1),{purchases:z,vendors:F,employees:V,loading:n,currentUserRoles:c,currentUserName:_,refreshPurchases:w}=Ot(),N=c?.includes("app_admin"),{activeTab:o,searchTerm:x,vendorFilter:D,dateFromFilter:p,dateToFilter:A,selectedEmployee:k,purchaseNumberFilter:S,itemNameFilter:K,approvalStatusFilter:O,setActiveTab:G,setSearchTerm:W,setVendorFilter:$,setDateFromFilter:J,setDateToFilter:M,setSelectedEmployee:U,setPurchaseNumberFilter:Z,setItemNameFilter:ee,setApprovalStatusFilter:de,filteredPurchases:te,tabCounts:se}=Lt(z,c,_);i.useEffect(()=>{new URLSearchParams(a.search).get("tab")==="purchase"&&G("purchase")},[a.search,G]);const me=async u=>{try{const{error:L}=await m.from("purchase_requests").update({is_received:!0,received_at:new Date().toISOString()}).eq("id",u);if(L)throw L;await m.from("purchase_request_items").update({is_received:!0,delivery_status:"received"}).eq("purchase_request_id",u),B.success("입고완료 처리되었습니다."),await w()}catch{B.error("처리 중 오류가 발생했습니다.")}},ne=async u=>{try{const{error:L}=await m.from("purchase_requests").update({is_payment_completed:!0,payment_completed_at:new Date().toISOString()}).eq("id",u);if(L)throw L;await m.from("purchase_request_items").update({is_payment_completed:!0}).eq("purchase_request_id",u),B.success("구매완료 처리되었습니다."),await w()}catch{B.error("처리 중 오류가 발생했습니다.")}};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"발주요청 관리"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"발주요청서를 관리하고 승인 처리를 할 수 있습니다"})]}),e.jsxs(yt,{onClick:()=>s("/purchase/new"),className:"mt-4 sm:mt-0 bg-hansl-500 hover:bg-hansl-600",children:[e.jsx(Rt,{className:"w-4 h-4 mr-2"}),"새 발주요청 작성"]})]}),e.jsxs(we,{className:"mb-4 border border-gray-200",children:[e.jsx(Et,{className:"bg-white border-b border-gray-200 py-3",children:e.jsxs(Ft,{className:"flex items-center text-gray-900 text-sm font-medium",children:[e.jsx(qt,{className:"w-4 h-4 mr-2"}),"검색 필터"]})}),e.jsx(Ne,{className:"py-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"시작일"}),e.jsx(ce,{type:"date",value:p,onChange:u=>J(u.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"종료일"}),e.jsx(ce,{type:"date",value:A,onChange:u=>M(u.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"요청자"}),e.jsx(Pt,{value:k||"all",onValueChange:u=>{U(u)},options:[{value:"all",label:"전체"},...V.filter(u=>u.name&&u.name.trim()!=="").sort((u,L)=>(u.name||"").localeCompare(L.name||"")).map(u=>({value:u.name||"",label:`${u.name}${u.name===_?" (나)":""}`}))],placeholder:k==="all"?"전체":k||"선택",searchPlaceholder:"직원 이름 검색...",emptyText:"일치하는 직원이 없습니다",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"업체"}),e.jsxs(_e,{value:D||"all",onValueChange:u=>$(u==="all"?"":u),children:[e.jsx(ye,{className:"h-9 text-sm",children:e.jsx(je,{placeholder:"전체"})}),e.jsxs(ve,{children:[e.jsx(ae,{value:"all",children:"전체"}),F.map(u=>e.jsx(ae,{value:u.vendor_name,children:u.vendor_name},u.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"발주번호"}),e.jsx(ce,{placeholder:"번호",value:S,onChange:u=>Z(u.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"품명"}),e.jsx(ce,{placeholder:"품명",value:K,onChange:u=>ee(u.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"승인상태"}),e.jsxs(_e,{value:O||"all",onValueChange:u=>de(u==="all"?"":u),children:[e.jsx(ye,{className:"h-9 text-sm",children:e.jsx(je,{placeholder:"전체"})}),e.jsxs(ve,{children:[e.jsx(ae,{value:"all",children:"전체"}),e.jsx(ae,{value:"pending",children:"대기"}),e.jsx(ae,{value:"approved",children:"승인"}),e.jsx(ae,{value:"rejected",children:"반려"})]})]})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"통합검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(It,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx(ce,{placeholder:"검색...",value:x,onChange:u=>W(u.target.value),className:"pl-7 text-sm h-9"})]})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 rounded-lg border border-gray-200",children:oa.map(u=>e.jsxs("button",{onClick:()=>G(u.key),className:`flex-1 flex items-center justify-center space-x-2 py-2.5 px-3 sm:px-4 rounded-md text-xs sm:text-sm font-medium transition-colors ${o===u.key?"text-hansl-600 bg-white shadow-sm border border-gray-200":"text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50"}`,children:[e.jsx("span",{className:"whitespace-nowrap",children:u.label}),e.jsx(q,{variant:"secondary",className:`text-[10px] sm:text-xs ${o===u.key?"bg-hansl-50 text-hansl-700":"bg-gray-100 text-gray-600"}`,children:se[u.key]})]},u.key))}),e.jsx(we,{className:"overflow-hidden border border-gray-200",children:e.jsx(Ne,{className:"p-0",children:n?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"로딩 중..."})]}):te.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(vt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주요청서가 없습니다"}),e.jsx("p",{className:"text-gray-600",children:"새로운 발주요청서를 작성해보세요."})]}):e.jsx(it,{purchases:te,activeTab:o,currentUserRoles:c,onRefresh:w,onPaymentComplete:ne,onReceiptComplete:me})})})]}),f&&e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:e.jsx(ia,{isOpen:I,onClose:()=>{C(!1),R(null)},purchase:{...f,vendor_name:f.vendor_name||"",project_vendor:f.project_vendor||"",sales_order_number:f.sales_order_number||"",project_item:f.project_item||""},isAdmin:N||!1,onUpdate:w})})]})}export{Da as default};
//# sourceMappingURL=PurchaseListMain-Br9_9ugR.js.map
