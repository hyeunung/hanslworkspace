{"version":3,"mappings":"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","names":["Building","createLucideIcon","d","key","x","y","width","height","rx","DollarSign","x1","x2","y1","y2","Info","cx","cy","r","SlidersVertical","globalCache","purchases","lastFetch","userInfo","CACHE_DURATION","filteredData","Map","FILTER_CACHE_DURATION","usePurchaseData","now","Date","hasCache","length","setPurchases","useState","loading","setLoading","currentUserRoles","setCurrentUserRoles","currentUserName","setCurrentUserName","currentUserEmail","setCurrentUserEmail","currentUserId","setCurrentUserId","supabase","createClient","initializationRef","useRef","hasLoadedCacheRef","useEffect","async","current","cacheValid","employeeData","roles","purchase_role","Array","isArray","map","String","trim","split","filter","name","full_name","email","id","error","logger","userResult","auth","getUser","data","user","from","select","eq","maybeSingle","loadInitialData","loadPurchases","useCallback","forceRefresh","options","showSpinner","silent","clear","setTimeout","debug","authError","toast","order","ascending","limit","employeeList","vendorList","contactList","employeesResult","vendorsResult","contactsResult","Promise","all","today","toISOString","processedData","request_date","startsWith","request","firstItem","purchase_request_items","requesterEmployee","find","emp","requester_id","vendorInfo","vendor","vendor_id","contactInfo","contact","contact_id","Number","purchase_order_number","delivery_request_date","revised_delivery_request_date","progress_type","payment_completed_at","payment_completed_by_name","payment_category","currency","request_type","vendor_name","vendor_payment_schedule","vendor_contacts","requester_name","requester_full_name","item_name","specification","quantity","unit_price_value","amount_value","remark","project_vendor","sales_order_number","project_item","line_number","contact_name","middle_manager_status","final_manager_status","is_received","received_at","is_payment_completed","is_utk_checked","is_statement_received","is_po_download","link","items","sort","a","b","total_amount","reduce","sum","item","updatePurchaseOptimistic","purchaseId","updater","prev","next","purchase","catch","refreshPurchases","StatusBadge","memo","status","text","className","completed","inProgress","rejected","pending","jsx","Badge","variant","children","displayName","MobilePurchaseCard","onClick","receiptProgress","received","total","percentage","actual_received_date","Math","round","getReceiptProgress","isAdvance","includes","jsxs","formatDateShort","toLocaleString","style","Eye","formatDate","formatDateISO","getCurrencySymbol","ROOT_NAME","createAlertDialogContext","createAlertDialogScope","createContextScope","createDialogScope","useDialogScope","AlertDialog","props","__scopeAlertDialog","alertDialogProps","dialogScope","DialogPrimitive.Root","modal","React.forwardRef","forwardedRef","triggerProps","DialogPrimitive.Trigger","ref","AlertDialogPortal","portalProps","DialogPrimitive.Portal","AlertDialogOverlay","overlayProps","DialogPrimitive.Overlay","CONTENT_NAME","AlertDialogContentProvider","useAlertDialogContentContext","Slottable","createSlottable","AlertDialogContent","contentProps","contentRef","React.useRef","composedRefs","useComposedRefs","cancelRef","DialogPrimitive.WarningProvider","contentName","titleName","TITLE_NAME","docsSlug","scope","DialogPrimitive.Content","role","onOpenAutoFocus","composeEventHandlers","event","preventDefault","focus","preventScroll","onPointerDownOutside","onInteractOutside","DescriptionWarning","AlertDialogTitle","titleProps","DialogPrimitive.Title","DESCRIPTION_NAME","AlertDialogDescription","descriptionProps","DialogPrimitive.Description","AlertDialogAction","actionProps","DialogPrimitive.Close","CANCEL_NAME","AlertDialogCancel","cancelProps","MESSAGE","React.useEffect","document","getElementById","getAttribute","Overlay2","Content2","Action","Cancel","Title2","Description2","AlertDialogPrimitive.Overlay","cn","AlertDialogPrimitive.Content","AlertDialogHeader","AlertDialogFooter","AlertDialogPrimitive.Title","AlertDialogPrimitive.Description","AlertDialogPrimitive.Action","buttonVariants","AlertDialogPrimitive.Cancel","COMMON_COLUMN_CLASSES","ApprovalStatusBadge","middleApproved","middleRejected","finalApproved","finalRejected","type","TableRow","activeTab","isLeadBuyer","onPaymentComplete","onReceiptComplete","onExcelDownload","paymentProgress","getPaymentProgress","statementProgress","getStatementProgress","src","alt","e","stopPropagation","pointerEvents","title","Fragment","href","target","rel","FastPurchaseTable","onRefresh","onOptimisticUpdate","selectedPurchaseId","setSelectedPurchaseId","isModalOpen","setIsModalOpen","deleteConfirmOpen","setDeleteConfirmOpen","purchaseToDelete","setPurchaseToDelete","handleRowClick","handleCloseModal","handleExcelDownload","purchaseRequest","requestError","single","orderItems","itemsError","vendor_phone","vendor_fax","vendor_contact_name","vendorId","contactId","vendorData","contactData","excelData","blob","workbook","__vitePreload","import","then","n","__VITE_PRELOAD__","Workbook","sheet","addWorksheet","pageSetup","paperSize","orientation","fitToPage","fitToWidth","fitToHeight","horizontalCentered","verticalCentered","margins","left","right","top","bottom","header","footer","getRow","eachCell","cell","font","size","mergeCells","response","fetch","arrayBuffer","imageId","addImage","buffer","extension","dWidth","getColumn","logoWidth","max","logoHeight","logoCol","logoRow","tl","col","row","ext","_e","getCell","value","alignment","horizontal","vertical","indent","bold","tableHeaders","i","fromCharCode","sortedItems","itemRows","sumRow","rowIdx","bCell","unitSymbol","unitWithCurrency","amountSymbol","amountWithCurrency","gCell","wrapText","shrinkToFit","c","totalSymbol","totalAmount","lastRow","cellAddr","isItemRow","border","currentBorder","sumCellBorder","Object","entries","A","B","C","D","E","F","G","forEach","xlsx","writeBuffer","Blob","generatePurchaseOrderExcelJS","downloadFilename","url","window","URL","createObjectURL","createElement","download","body","appendChild","click","removeChild","revokeObjectURL","success","downloadFlagErr","update","flagErr","handleConfirmDelete","supabaseUrl","warn","employee","empError","canEdit","isApproved","isRequester","canDeleteThis","userRoles","deletedItems","delete","code","message","details","hint","deletedItemsCount","purchaseRequestId","deletedRequest","deletedRequestId","errorObj","stack","tableHeader","useMemo","baseHeaders","additionalHeaders","PurchaseDetailModal","isOpen","onClose","onDelete","open","onOpenChange","FILTER_FIELDS","label","icon","Calendar","category","User","Package","CheckCircle","Check","DATE_FIELDS","SORT_FIELDS","FilterToolbar","activeFilters","sortConfig","searchTerm","onFiltersChange","onSortChange","onSearchChange","availableEmployees","availableVendors","availableContacts","availablePaymentSchedules","isFilterOpen","setIsFilterOpen","isSortOpen","setIsSortOpen","isSearchExpanded","setIsSearchExpanded","newFilter","setNewFilter","datePickerOpen","setDatePickerOpen","monthPickerOpen","setMonthPickerOpen","tempDateRange","setTempDateRange","tempMonth","setTempMonth","tempMonthRange","setTempMonthRange","tempSort","setTempSort","searchInputRef","field","direction","handleRemoveFilter","filterId","f","renderValueInput","fieldConfig","Input","placeholder","onChange","padding","fontSize","fontWeight","Popover","PopoverTrigger","asChild","Button","Search","PopoverContent","align","Command","CommandInput","CommandEmpty","CommandGroup","option","CommandItem","onSelect","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","scheduleOptions","start","end","to","format","CalendarComponent","mode","selected","range","numberOfMonths","initialFocus","rangeValue","disabled","startYear","startMonth","endYear","endMonth","slice","year","month","currentYear","getFullYear","newDate","getMonth","_","monthDate","isSelected","isDisabled","Sliders","dateField","df","X","defaultCondition","condition","scrollbarWidth","scrollbarColor","WebkitScrollbarWidth","acc","push","fields","isDateFilter","requiresDateField","finalCondition","ArrowUpDown","PurchaseItemsModal","lazy","NAV_TABS","PurchaseListMain","showEmailButton","navigate","useNavigate","location","useLocation","selectedPurchase","setSelectedPurchase","setActiveFilters","setSortConfig","setSearchTerm","setAvailableEmployees","setAvailableVendors","setAvailableContacts","setAvailablePaymentSchedules","isAdmin","setActiveTab","selectedEmployee","setSelectedEmployee","visiblePurchases","HIDDEN_EMPLOYEES","p","roleCase","some","computeDefaultEmployee","tabKey","defaultEmployee","tab","URLSearchParams","search","get","employees","employeeNames","Set","Boolean","vendors","vendorNames","v","contacts","contactNames","schedules","scheduleNames","s","loadFilterOptions","getFieldValue","created_at","statement_received_at","applyFilterCondition","fieldValue","filterValue","filterField","startDate","endDate","fieldDate","endOfMonth","endsWith","filterYear","filterMonth","parseInt","fieldStr","toLowerCase","filterStr","match","tabFilteredPurchases","filtered","term","toString","join","matchesSearchAndEmployee","isMiddlePending","isFinalPending","isApprovedToday","final_manager_approved_at","approvedDate","getDate","isRequest","notPaid","isSeonJin","isIlban","sixtyDaysAgo","setDate","every","actualField","filterFieldType","aValue","bValue","comparison","getTime","localeCompare","getPriority","priorityA","priorityB","dateA","tabCounts","getUniqueOrderCount","pendingFiltered","isFinalPendingStrict","purchaseFiltered","receiptFiltered","receipt","done","filteredTabCounts","hasAnyFilter","baseData","searchLower","monthlyFilterSummary","monthFilters","monthlyTotals","totalSum","currentDate","monthStr","padStart","monthData","purchaseDate","monthTotal","count","setMonth","months","grandTotal","handleReceiptComplete","currentTime","requestResult","itemsResult","delivery_status","handlePaymentComplete","modalPurchaseData","marginTop","marginBottom","Plus","Card","CardHeader","CardTitle","m","CardContent","Suspense","fallback","onUpdate"],"ignoreList":[0,1,2,3,7],"sources":["../../node_modules/lucide-react/dist/esm/icons/building.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/info.js","../../node_modules/lucide-react/dist/esm/icons/sliders-vertical.js","../../src/hooks/usePurchaseData.ts","../../src/components/purchase/MobilePurchaseCard.tsx","../../src/utils/exceljs/generatePurchaseOrderExcel.ts","../../node_modules/@radix-ui/react-alert-dialog/dist/index.mjs","../../src/components/ui/alert-dialog.tsx","../../src/components/purchase/FastPurchaseTable.tsx","../../src/components/purchase/FilterToolbar.tsx","../../src/components/purchase/PurchaseListMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 10h.01\", key: \"1nrarc\" }],\n  [\"path\", { d: \"M12 14h.01\", key: \"1etili\" }],\n  [\"path\", { d: \"M12 6h.01\", key: \"1vi96p\" }],\n  [\"path\", { d: \"M16 10h.01\", key: \"1m94wz\" }],\n  [\"path\", { d: \"M16 14h.01\", key: \"1gbofw\" }],\n  [\"path\", { d: \"M16 6h.01\", key: \"1x0f13\" }],\n  [\"path\", { d: \"M8 10h.01\", key: \"19clt8\" }],\n  [\"path\", { d: \"M8 14h.01\", key: \"6423bh\" }],\n  [\"path\", { d: \"M8 6h.01\", key: \"1dz90k\" }],\n  [\"path\", { d: \"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3\", key: \"cabbwy\" }],\n  [\"rect\", { x: \"4\", y: \"2\", width: \"16\", height: \"20\", rx: \"2\", key: \"1uxh74\" }]\n];\nconst Building = createLucideIcon(\"building\", __iconNode);\n\nexport { __iconNode, Building as default };\n//# sourceMappingURL=building.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"M12 16v-4\", key: \"1dtifu\" }],\n  [\"path\", { d: \"M12 8h.01\", key: \"e9boi3\" }]\n];\nconst Info = createLucideIcon(\"info\", __iconNode);\n\nexport { __iconNode, Info as default };\n//# sourceMappingURL=info.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"21\", y2: \"14\", key: \"1p332r\" }],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"10\", y2: \"3\", key: \"gb41h5\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"21\", y2: \"12\", key: \"hf2csr\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"8\", y2: \"3\", key: \"1kfi7u\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"21\", y2: \"16\", key: \"1lhrwl\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"12\", y2: \"3\", key: \"16vvfq\" }],\n  [\"line\", { x1: \"2\", x2: \"6\", y1: \"14\", y2: \"14\", key: \"1uebub\" }],\n  [\"line\", { x1: \"10\", x2: \"14\", y1: \"8\", y2: \"8\", key: \"1yglbp\" }],\n  [\"line\", { x1: \"18\", x2: \"22\", y1: \"16\", y2: \"16\", key: \"1jxqpz\" }]\n];\nconst SlidersVertical = createLucideIcon(\"sliders-vertical\", __iconNode);\n\nexport { __iconNode, SlidersVertical as default };\n//# sourceMappingURL=sliders-vertical.js.map\n","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { logger } from '@/lib/logger';\nimport { toast } from 'sonner';\n\nexport interface Purchase {\n  id: number;\n  purchase_order_number?: string;\n  request_date: string;\n  delivery_request_date?: string | null;\n  revised_delivery_request_date?: string | null;\n  progress_type: string;\n  is_payment_completed: boolean;\n  payment_category: string;\n  payment_completed_at?: string;\n  payment_completed_by_name?: string;\n  currency: string;\n  request_type: string;\n  vendor?: {\n    vendor_name: string;\n    vendor_payment_schedule?: string;\n  };\n  vendor_name: string;\n  vendor_payment_schedule?: string;\n  vendor_id?: number;\n  contact_id?: number;\n  vendor_contacts?: {\n    contact_name: string;\n  } | Array<{\n    contact_name: string;\n  }>;\n  contact_name?: string;\n  requester_id: string;\n  requester_name: string;\n  requester_full_name: string;\n  project_vendor: string;\n  sales_order_number: string;\n  project_item: string;\n  middle_manager_status?: string;\n  final_manager_status?: string;\n  total_amount: number;\n  is_received: boolean;\n  received_at?: string;\n\n  is_po_download?: boolean;\n  is_utk_checked?: boolean;\n  is_statement_received?: boolean;\n  items?: any[];\n  purchase_request_items?: any[];\n  item_name?: string;\n  specification?: string;\n  quantity?: number;\n  unit_price_value?: number;\n  amount_value?: number;\n  remark?: string;\n  line_number?: number;\n  link?: string;\n}\n\n\n//   \nconst globalCache = {\n  purchases: null as Purchase[] | null,\n  lastFetch: 0,\n  userInfo: null as any,\n  CACHE_DURATION: 5 * 60 * 1000, // 5  \n  //    \n  filteredData: new Map<string, { data: Purchase[]; timestamp: number }>(),\n  FILTER_CACHE_DURATION: 30 * 1000 // 30  \n};\n\n//    \nexport const clearPurchaseCache = () => {\n  globalCache.purchases = null;\n  globalCache.userInfo = null;\n  globalCache.lastFetch = 0;\n  globalCache.filteredData.clear();\n};\n\n//    ()\nexport const invalidateFilterCache = (tabKey?: string) => {\n  if (tabKey) {\n    for (const [key] of globalCache.filteredData.entries()) {\n      if (key.includes(tabKey)) {\n        globalCache.filteredData.delete(key);\n      }\n    }\n  } else {\n    globalCache.filteredData.clear();\n  }\n};\n\nexport const usePurchaseData = () => {\n  //      \n  const now = Date.now();\n  const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n  const hasCache = cacheValid && globalCache.purchases && globalCache.purchases.length > 0;\n  \n  const [purchases, setPurchases] = useState<Purchase[]>(hasCache ? globalCache.purchases : []);\n  const [loading, setLoading] = useState(!hasCache);\n  const [currentUserRoles, setCurrentUserRoles] = useState<string[]>([]);\n  const [currentUserName, setCurrentUserName] = useState<string>('');\n  const [currentUserEmail, setCurrentUserEmail] = useState<string>('');\n  const [currentUserId, setCurrentUserId] = useState<string>('');\n  \n  const supabase = createClient();\n  const initializationRef = useRef(false);\n  const hasLoadedCacheRef = useRef(hasCache);\n\n  //    ( ,  ) -  \n  useEffect(() => {\n    const loadInitialData = async () => {\n      if (initializationRef.current) return;\n      initializationRef.current = true;\n      \n      const now = Date.now();\n      const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n      \n      try {\n        //     \n        if (cacheValid && globalCache.userInfo) {\n          try {\n            const employeeData = globalCache.userInfo;\n            if (employeeData) {\n              let roles: string[] = [];\n              if (employeeData.purchase_role) {\n                if (Array.isArray(employeeData.purchase_role)) {\n                  roles = employeeData.purchase_role.map((r: any) => String(r).trim());\n                } else {\n                  const roleString = String(employeeData.purchase_role);\n                  roles = roleString\n                    .split(',')\n                    .map((r: string) => r.trim())\n                    .filter((r: string) => r.length > 0);\n                }\n              }\n              \n              setCurrentUserRoles(roles);\n              setCurrentUserName(employeeData.name || employeeData.full_name || '');\n              setCurrentUserEmail(employeeData.email || '');\n              setCurrentUserId(employeeData.id || '');\n            }\n            return;\n          } catch (error) {\n            logger.error('    ', error);\n            //  \n            globalCache.purchases = null;\n            globalCache.userInfo = null;\n            globalCache.lastFetch = 0;\n          }\n        }\n        \n        //      \n        const userResult = await supabase.auth.getUser();\n\n        //     \n        if (userResult.data.user && !userResult.error) {\n          // email    ( )\n          let employeeData = null;\n          if (userResult.data.user.email) {\n            const emailResult = await supabase\n              .from('employees')\n              .select('*')\n              .eq('email', userResult.data.user.email)\n              .maybeSingle();\n            \n            employeeData = emailResult.data;\n          }\n          \n          if (employeeData) {\n            globalCache.userInfo = employeeData;\n            \n            let roles: string[] = [];\n            if (employeeData.purchase_role) {\n              if (Array.isArray(employeeData.purchase_role)) {\n                roles = employeeData.purchase_role.map((r: any) => String(r).trim());\n              } else {\n                const roleString = String(employeeData.purchase_role);\n                roles = roleString\n                  .split(',')\n                  .map((r: string) => r.trim())\n                  .filter((r: string) => r.length > 0);\n              }\n            }\n            \n            setCurrentUserRoles(roles);\n            setCurrentUserName(employeeData.name || employeeData.full_name || '');\n            setCurrentUserEmail(employeeData.email || '');\n            setCurrentUserId(employeeData.id || '');\n          }\n          \n          globalCache.lastFetch = now;\n        }\n      } catch (error) {\n        logger.error('   ', error);\n      }\n    };\n\n    loadInitialData();\n  }, []);\n\n  //    -    \n  const loadPurchases = useCallback(async (forceRefresh?: boolean, options?: { silent?: boolean }) => {\n    const showSpinner = !options?.silent && !hasLoadedCacheRef.current;\n    \n    try {\n      //  \n      const now = Date.now();\n      const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n      \n      //      \n      if (forceRefresh) {\n        invalidateFilterCache();\n        globalCache.purchases = null;\n        globalCache.lastFetch = 0;\n        hasLoadedCacheRef.current = false;\n        // silent       \n        if (showSpinner) {\n          setLoading(true);\n        }\n      } else if (cacheValid && globalCache.purchases) {\n        //    \n        setPurchases(globalCache.purchases);\n        setLoading(false);\n        hasLoadedCacheRef.current = true;\n        \n        // silent    \n        if (!options?.silent) {\n          setTimeout(async () => {\n            try {\n              //      (silent )\n              await loadPurchases(true, { silent: true });\n            } catch (error) {\n              //     (   )\n              logger.debug('    ()', error);\n            }\n          }, 100);\n        }\n        \n        return;\n      } else {\n        //     (    )\n        if (showSpinner && !hasLoadedCacheRef.current) {\n          setLoading(true);\n        }\n      }\n      \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      if (authError || !user) {\n        logger.error('  ', authError);\n        toast.error(' .');\n        if (showSpinner) {\n          setLoading(false);\n        }\n        return;\n      }\n\n      //        \n      \n      //  purchase_requests  (vendors JOIN )\n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          purchase_request_items(*)\n        `)\n        .order('request_date', { ascending: false })\n        .limit(1000); //  :  1000\n\n      if (error) {\n        throw error;\n      }\n\n      //  employees vendors, vendor_contacts   (   )\n      let employeeList: any[] = [];\n      let vendorList: any[] = [];\n      let contactList: any[] = [];\n      \n      //     \n      if (data && data.length > 0) {\n        //     (  )\n        const [employeesResult, vendorsResult, contactsResult] = await Promise.all([\n          supabase.from('employees').select('id, name, email'),\n          supabase.from('vendors').select('id, vendor_name, vendor_payment_schedule'),\n          supabase.from('vendor_contacts').select('id, contact_name')\n        ]);\n        \n        employeeList = employeesResult.data || [];\n        vendorList = vendorsResult.data || [];\n        contactList = contactsResult.data || [];\n      }\n\n      \n      //    \n      const today = new Date().toISOString().split('T')[0];\n      const todayItems = (data || []).filter((d: any) => d.request_date?.startsWith(today));\n\n      //   (hanslwebapp )\n      const processedData = (data || []).map((request: any) => {\n        //     (   )\n        const firstItem = request.purchase_request_items?.[0] || {};\n        \n        // requester_id employee \n        const requesterEmployee = employeeList.find(emp => emp.id === request.requester_id);\n        \n        // vendor_id vendor \n        const vendorInfo = vendorList.find(vendor => vendor.id === request.vendor_id);\n        \n        // contact_id  \n        const contactInfo = contactList.find(contact => contact.id === request.contact_id);\n        \n        return {\n          id: Number(request.id),\n          purchase_order_number: request.purchase_order_number as string,\n          request_date: request.request_date as string,\n          delivery_request_date: request.delivery_request_date ?? null,\n          revised_delivery_request_date: request.revised_delivery_request_date ?? null,\n          progress_type: request.progress_type as string,\n          payment_completed_at: request.payment_completed_at as string,\n          payment_completed_by_name: request.payment_completed_by_name as string,\n          payment_category: request.payment_category as string,\n          currency: request.currency as string,\n          request_type: request.request_type as string,\n          vendor: undefined, // vendors JOIN \n          vendor_name: request.vendor_name || '', // purchase_requests  vendor_name \n          vendor_payment_schedule: vendorInfo?.vendor_payment_schedule || '', // vendors  \n          vendor_contacts: [], // vendors JOIN  \n          requester_id: request.requester_id as string,\n          requester_name: request.requester_name as string,\n          requester_full_name: requesterEmployee?.name || request.requester_name || '',\n          item_name: firstItem.item_name as string || '',\n          specification: firstItem.specification as string || '',\n          quantity: Number(firstItem.quantity) || 0,\n          unit_price_value: Number(firstItem.unit_price_value) || 0,\n          amount_value: Number(firstItem.amount_value) || 0,\n          remark: firstItem.remark as string || '',\n          project_vendor: request.project_vendor as string,\n          sales_order_number: request.sales_order_number as string,\n          project_item: request.project_item as string,\n          line_number: Number(firstItem.line_number) || 1,\n          contact_name: contactInfo?.contact_name || '', // contact_id   \n          middle_manager_status: request.middle_manager_status,\n          final_manager_status: request.final_manager_status,\n          is_received: !!request.is_received,\n          received_at: request.received_at as string,\n          is_payment_completed: !!request.is_payment_completed,\n          is_utk_checked: !!request.is_utk_checked,\n          is_statement_received: !!request.is_statement_received,\n          is_po_download: !!request.is_po_download,\n          link: firstItem.link as string | undefined,\n          //     (hanslwebapp  items ) - line_number \n          items: (request.purchase_request_items || []).sort((a: any, b: any) => \n            (a.line_number || 0) - (b.line_number || 0)),\n          //   \n          total_amount: request.purchase_request_items?.reduce((sum: number, item: any) => \n            sum + (Number(item.amount_value) || 0), 0) || 0\n        };\n      });\n\n\n      //     \n      setPurchases(processedData);\n      globalCache.purchases = processedData;\n      globalCache.lastFetch = now;\n      hasLoadedCacheRef.current = true;\n    } catch (error) {\n      logger.error('   ', error);\n      toast.error('    .');\n    } finally {\n      if (showSpinner) {\n        setLoading(false);\n      } else {\n        // silent    false  (  )\n        setLoading(false);\n      }\n    }\n  }, [supabase]);\n\n  const updatePurchaseOptimistic = useCallback((purchaseId: number, updater: (prev: Purchase) => Purchase) => {\n    setPurchases(prev => {\n      const next = prev.map(purchase => (purchase.id === purchaseId ? updater(purchase) : purchase));\n      globalCache.purchases = next;\n      return next;\n    });\n  }, []);\n\n  //     \n  useEffect(() => {\n    if (hasLoadedCacheRef.current) {\n      //     \n      setTimeout(() => {\n        loadPurchases(true, { silent: true }).catch(() => {\n          //    \n        });\n      }, 100);\n      return;\n    }\n    \n    //    \n    loadPurchases();\n  }, [loadPurchases]);\n\n  return {\n    purchases,\n    loading,\n    currentUserRoles,\n    currentUserName,\n    currentUserEmail,\n    currentUserId,\n    refreshPurchases: loadPurchases,\n    updatePurchaseOptimistic\n  };\n};\n","import { memo } from 'react'\nimport { Eye } from 'lucide-react'\nimport { Badge } from '@/components/ui/badge'\nimport { Purchase } from '@/types/purchase'\nimport { formatDateShort } from '@/utils/helpers'\n\ninterface MobilePurchaseCardProps {\n  purchase: Purchase\n  onClick: (purchase: Purchase) => void\n}\n\n// formatDateShort utils/helpers.ts import\n\nconst getReceiptProgress = (purchase: Purchase) => {\n  if (!purchase.items || purchase.items.length === 0) return { received: 0, total: 0, percentage: 0 }\n  \n  const total = purchase.items.length\n  const received = purchase.items.filter((item: any) => \n    item.actual_received_date !== null && item.actual_received_date !== undefined\n  ).length\n  const percentage = total > 0 ? Math.round((received / total) * 100) : 0\n  \n  return { received, total, percentage }\n}\n\nconst StatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const status = purchase.is_received \n    ? 'completed'\n    : (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')\n    ? 'inProgress'\n    : (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected')\n    ? 'rejected'\n    : 'pending'\n  \n  const config = {\n    completed: { text: '', className: 'badge-success' },\n    inProgress: { text: '', className: 'badge-primary' },\n    rejected: { text: '', className: 'badge-danger' },\n    pending: { text: '', className: 'badge-warning' }\n  }\n  \n  const { text, className } = config[status]\n  return <Badge variant={null} className={className}>{text}</Badge>\n})\n\nStatusBadge.displayName = 'StatusBadge'\n\nconst MobilePurchaseCard = memo(({ purchase, onClick }: MobilePurchaseCardProps) => {\n  const receiptProgress = getReceiptProgress(purchase)\n  const isAdvance = purchase.progress_type === '' || purchase.progress_type?.includes('')\n  \n  return (\n    <div \n      className={`bg-white rounded-lg border p-4 space-y-3 cursor-pointer transition-all hover:shadow-md ${isAdvance ? 'border-red-400 bg-red-50 hover:bg-red-100' : 'hover:bg-gray-50'}`}\n      onClick={() => onClick(purchase)}\n    >\n      {/*  */}\n      <div className=\"flex items-start justify-between\">\n        <div>\n          <div className=\"flex items-center gap-2\">\n            {isAdvance ? (\n              <Badge variant={null} className=\"badge-danger\">\n                \n              </Badge>\n            ) : (\n              <Badge variant={null} className=\"badge-secondary\">\n                \n              </Badge>\n            )}\n            <span className=\"card-title text-gray-900\">\n              {purchase.purchase_order_number || '-'}\n            </span>\n          </div>\n          <div className=\"badge-text text-gray-500 mt-1\">\n            {formatDateShort(purchase.request_date)} \n          </div>\n        </div>\n        <StatusBadge purchase={purchase} />\n      </div>\n\n      {/*   */}\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"card-title\">{purchase.requester_name}</span>\n        </div>\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"card-title\">{purchase.vendor_name}</span>\n        </div>\n        {purchase.project_vendor && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\">PJ</span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.project_vendor}</span>\n          </div>\n        )}\n        {purchase.project_item && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\">PJ ITEM</span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.project_item}</span>\n          </div>\n        )}\n        {purchase.sales_order_number && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\"></span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.sales_order_number}</span>\n          </div>\n        )}\n        {purchase.item_name && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\"></span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.item_name}</span>\n          </div>\n        )}\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"font-semibold text-gray-900\">\n            {(purchase.amount_value || purchase.total_amount)?.toLocaleString()} {purchase.currency}\n          </span>\n        </div>\n      </div>\n\n      {/*   */}\n      <div className=\"space-y-1\">\n        <div className=\"flex items-center justify-between badge-text\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"text-gray-700\">\n            {receiptProgress.received}/{receiptProgress.total} ({receiptProgress.percentage}%)\n          </span>\n        </div>\n        <div className=\"bg-gray-200 rounded-full h-2\">\n          <div \n            className={`h-2 rounded-full transition-all ${\n              receiptProgress.percentage === 100 ? 'bg-green-500' : \n              receiptProgress.percentage > 0 ? 'bg-hansl-500' : 'bg-gray-300'\n            }`}\n            style={{ width: `${receiptProgress.percentage}%` }}\n          />\n        </div>\n      </div>\n\n      {/*   */}\n      {purchase.is_payment_completed !== undefined && (\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          {purchase.is_payment_completed ? (\n            <Badge variant={null} className=\"badge-success\"></Badge>\n          ) : (\n            <Badge variant={null} className=\"badge-secondary\"></Badge>\n          )}\n        </div>\n      )}\n\n      {/*       */}\n      <div className=\"pt-2 border-t\">\n        <div className=\"flex items-center justify-center badge-text text-gray-500\">\n          <Eye className=\"w-3 h-3 mr-1\" />\n           \n        </div>\n      </div>\n    </div>\n  )\n})\n\nMobilePurchaseCard.displayName = 'MobilePurchaseCard'\n\nexport default MobilePurchaseCard","// hanslwebapp    Excel \nimport { formatDateISO } from '@/utils/helpers';\n\nexport interface PurchaseOrderData {\n  purchase_order_number: string;\n  request_date: string;\n  delivery_request_date: string;\n  requester_name: string;\n  vendor_name: string;\n  vendor_contact_name?: string;\n  vendor_phone?: string;\n  vendor_fax?: string;\n  project_vendor: string;\n  sales_order_number: string;\n  project_item: string;\n  items: PurchaseOrderItem[];\n  vendor_payment_schedule?: string;\n}\n\nexport interface PurchaseOrderItem {\n  line_number: number;\n  item_name: string;\n  specification: string;\n  quantity: number;\n  unit_price_value: number;\n  amount_value: number;\n  remark: string;\n  currency: string;\n}\n\nconst formatDate = formatDateISO;\n\n// Helper: currency code to symbol\nfunction getCurrencySymbol(currency: string) {\n  if (!currency) return '';\n  if (['KRW', '', ''].includes(currency)) return '';\n  if (['USD', '$', ''].includes(currency)) return '$';\n  if (['EUR', ''].includes(currency)) return '';\n  if (['JPY', '', ''].includes(currency)) return '';\n  if (['CNY', '', ''].includes(currency)) return '';\n  return currency;\n}\n\n/**\n *    (ExcelJS) - hanslwebapp  \n * @param data PurchaseOrderData\n * @returns Blob (xlsx)\n */\nexport async function generatePurchaseOrderExcelJS(data: PurchaseOrderData): Promise<Blob> {\n  // ExcelJS  import    \n  const ExcelJS = await import('exceljs');\n  const workbook = new ExcelJS.Workbook();\n  \n  const sheet = workbook.addWorksheet('', {\n    pageSetup: {\n      paperSize: 9, // A4\n      orientation: 'portrait',\n      fitToPage: true,\n      fitToWidth: 1,\n      fitToHeight: 1,\n      horizontalCentered: true,\n      verticalCentered: true,\n      margins: {\n        left: 0.3,\n        right: 0.3,\n        top: 0.5,\n        bottom: 0.5,\n        header: 0.2,\n        footer: 0.2\n      }\n    }\n  });\n\n  //   : 1 39.75px(29.8pt), 2 18px(13.5pt)\n  sheet.getRow(1).height = 29.8; // 39.75px\n  for (let r = 2; r <= 60; r++) {\n    sheet.getRow(r).height = 15.75; // 21px15.75pt\n  }\n  //  : ,  11 (2), 1 20\n  // 1\n  sheet.getRow(1).eachCell(cell => {\n    cell.font = { ...(cell.font || {}), name: ' ', size: 20 };\n  });\n\n  //      (     bold )\n  for (let r = 2; r <= 60; r++) {\n    sheet.getRow(r).eachCell(cell => {\n      cell.font = { ...(cell.font || {}), name: ' ', size: 11 };\n    });\n  }\n\n  // 1.    1:1 \n  sheet.mergeCells('A1:G1');\n  sheet.mergeCells('A2:B2'); sheet.mergeCells('C2:D2'); sheet.mergeCells('F2:G2');\n  sheet.mergeCells('A3:B3'); sheet.mergeCells('C3:D3'); sheet.mergeCells('F3:G3');\n  sheet.mergeCells('A4:B4'); sheet.mergeCells('C4:D4'); sheet.mergeCells('F4:G4');\n  sheet.mergeCells('A5:B5'); sheet.mergeCells('C5:D5'); sheet.mergeCells('F5:G5');\n  sheet.mergeCells('A6:B6'); sheet.mergeCells('C6:D6'); sheet.mergeCells('F6:G6');\n  sheet.mergeCells('A7:B7'); sheet.mergeCells('C7:D7'); sheet.mergeCells('F7:G7');\n  // 8~46(//)  \n  //        \n  // ( sumRow   )\n\n  try {\n    const response = await fetch('/logo_KOR.png');\n    const arrayBuffer = await response.arrayBuffer();\n    const imageId = workbook.addImage({\n      buffer: arrayBuffer,\n      extension: 'png',\n    });\n    // ()  0.58col, ''      \n    // D width undefined/null/0  22 \n    const dWidth = sheet.getColumn('D').width || 22;\n    const logoWidth = Math.max(1, dWidth * 7.2 * 0.58) + 4; //  4px  \n    const logoHeight = 30 + 4; //  30 4px  \n    // D1  (3.5, 0.5)  2px(0.28col),  2px(0.13row) \n    const logoCol = 3.5 - 0.50;\n    const logoRow = 0.5 - 0.20;\n    sheet.addImage(imageId, {\n      tl: { col: logoCol, row: logoRow }, // D1    2px,  2px \n      ext: { width: logoWidth, height: logoHeight },\n    });\n  } catch (_e) {\n    // Logo loading failed, continue without logo\n  }\n\n  // 2.  (B1:H1 , )\n  sheet.getCell('D1').value = '                  ';\n  sheet.getCell('D1').alignment = { horizontal: 'left', vertical: 'middle', indent: 1 };\n  sheet.getCell('D1').font = { bold: true, size: 20 };\n\n  // 3.      ( )\n  sheet.getCell('A2').value = '      ';\n  sheet.getCell('A2').font = { bold: true };\n  sheet.getCell('A3').value = '      ';\n  sheet.getCell('A3').font = { bold: true };\n  sheet.getCell('A4').value = '      ';\n  sheet.getCell('A4').font = { bold: true };\n  sheet.getCell('A5').value = 'TEL.';\n  sheet.getCell('A5').font = { bold: true };\n  sheet.getCell('A6').value = 'FAX.';\n  sheet.getCell('A6').font = { bold: true };\n  sheet.getCell('A7').value = '';\n  sheet.getCell('A7').font = { bold: true };\n\n  sheet.getCell('E2').value = '';\n  sheet.getCell('E2').font = { bold: true };\n  sheet.getCell('E3').value = '         ';\n  sheet.getCell('E3').font = { bold: true };\n  sheet.getCell('E4').value = '   ';\n  sheet.getCell('E4').font = { bold: true };\n  sheet.getCell('E5').value = 'TEL.';\n  sheet.getCell('E5').font = { bold: true };\n  sheet.getCell('E6').value = 'FAX.';\n  sheet.getCell('E6').font = { bold: true };\n  sheet.getCell('E7').value = ' ';\n  sheet.getCell('E7').font = { bold: true };\n\n  sheet.getCell('F7').value = data.vendor_payment_schedule || '';\n\n  //  ()\n  sheet.getCell('C2').value = data.vendor_name;\n  sheet.getCell('C3').value = data.vendor_contact_name || '';\n  sheet.getCell('C4').value = formatDate(data.request_date);\n  sheet.getCell('C5').value = data.vendor_phone || '';\n  sheet.getCell('C6').value = data.vendor_fax || '';\n  sheet.getCell('C7').value = formatDate(data.delivery_request_date);\n\n  sheet.getCell('F2').value = data.requester_name;\n  sheet.getCell('F3').value = '  305';\n  sheet.getCell('F4').value = data.purchase_order_number;\n  sheet.getCell('F5').value = '(053) 626-7805';\n  sheet.getCell('F6').value = '(053) 657-7905';\n  sheet.getCell('F5').alignment = { horizontal: 'center', vertical: 'middle' };\n  sheet.getCell('F6').alignment = { horizontal: 'center', vertical: 'middle' };\n\n  // 8:  \n  const tableHeaders = ['No', '', '', '', '', '', ''];\n  for (let i = 0; i < tableHeaders.length; i++) {\n    sheet.getCell(String.fromCharCode(65 + i) + '8').value = tableHeaders[i];\n    sheet.getCell(String.fromCharCode(65 + i) + '8').font = { bold: true };\n    if(i===6){\n       sheet.getCell('G8').alignment = { horizontal:'center', vertical:'middle' };\n    }\n  }\n\n  //  45    /  \n  const baseRow = 9;\n  const minRows = 45;\n  // ---   line_number   ---\n  const sortedItems = [...data.items].sort((a, b) => a.line_number - b.line_number);\n  const itemRows = sortedItems.length;\n  const sumRow = baseRow + Math.max(itemRows, minRows); //  \n\n  //  \n  for (let i = 0; i < sortedItems.length; i++) {\n    const item = sortedItems[i];\n    const rowIdx = baseRow + i;\n    sheet.getCell('A' + rowIdx).value = item.line_number;\n    const bCell = sheet.getCell('B' + rowIdx);\n    bCell.value = item.item_name;\n    bCell.alignment = { horizontal: 'left', vertical: 'middle' };\n    sheet.getCell('C' + rowIdx).value = item.specification;\n    sheet.getCell('C' + rowIdx).alignment = { horizontal: 'left', vertical: 'middle' };\n    sheet.getCell('D' + rowIdx).value = item.quantity;\n    // (E) -   \n    const unitSymbol = getCurrencySymbol(item.currency);\n    const unitWithCurrency = (item.unit_price_value !== undefined && item.unit_price_value !== null)\n      ? `${item.unit_price_value.toLocaleString()} ${unitSymbol}`.trim()\n      : '';\n    sheet.getCell('E' + rowIdx).value = unitWithCurrency;\n    sheet.getCell('E' + rowIdx).alignment = { horizontal: 'right', vertical: 'middle' };\n\n    // (F) -   \n    const amountSymbol = getCurrencySymbol(item.currency);\n    const amountWithCurrency = (item.amount_value !== undefined && item.amount_value !== null)\n      ? `${item.amount_value.toLocaleString()} ${amountSymbol}`.trim()\n      : '';\n    sheet.getCell('F' + rowIdx).value = amountWithCurrency;\n    sheet.getCell('F' + rowIdx).alignment = { horizontal: 'right', vertical: 'middle' };\n    // G \n    const gCell = sheet.getCell('G' + rowIdx);\n    gCell.value = (item.remark !== undefined && item.remark !== null) ? String(item.remark) : '';\n    gCell.alignment = { horizontal: 'left', vertical: 'middle', wrapText: false, shrinkToFit: true };\n  }\n\n  //  45    \n  for (let i = itemRows; i < minRows; i++) {\n    const rowIdx = baseRow + i;\n    for (let c = 0; c < 7; c++) {\n      sheet.getCell(String.fromCharCode(65 + c) + rowIdx).value = '';\n    }\n  }\n\n  // \n  sheet.mergeCells(`A${sumRow}:E${sumRow}`);\n  sheet.getCell('A' + sumRow).value = '';\n  sheet.getCell('A' + sumRow).font = { bold: true };\n  const totalSymbol = getCurrencySymbol(data.items[0]?.currency);\n  const totalAmount = data.items.reduce((sum, item) => sum + (item.amount_value || 0), 0);\n  sheet.getCell('F' + sumRow).value = `${totalAmount.toLocaleString()} ${totalSymbol}`.trim();\n  sheet.getCell('F' + sumRow).alignment = { horizontal: 'right', vertical: 'middle' };\n\n  //         ()\n  const lastRow = sumRow;\n  for (let r = 1; r <= lastRow; r++) {\n    for (let c = 1; c <= 7; c++) {\n      const col = String.fromCharCode(64 + c); // A~G\n      const cellAddr = col + r;\n      const cell = sheet.getCell(cellAddr);\n      // E(5), F(6)   (/) , C(3)   () alignment  \n      const isPriceCol = (c === 5 || c === 6);\n      const isSpecCol = (c === 3);\n      const isItemRow = (r >= baseRow && r < sumRow);\n      const isSumRow = (r === sumRow);\n      if (!((isPriceCol && (isItemRow || isSumRow)) || (isSpecCol && isItemRow))) {\n        //    \n        cell.alignment = { horizontal: 'center', vertical: 'middle' };\n      }\n      //  : 2/8/(sumRow) , 8 ,  \n      cell.border = {\n        top:    { style: (r === 1) ? 'medium' : (r === 2 || r === 8 || r === sumRow) ? 'medium' : 'thin' },\n        left:   { style: c === 1 ? 'medium' : 'thin' },\n        right:  { style: c === 7 ? 'medium' : 'thin' },\n        bottom: { style: (r === 8 || r === sumRow || r === lastRow) ? 'medium' : 'thin' }\n      };\n    }\n  }\n  // (C) (  )    \n  for (let i = 0; i < itemRows; i++) {\n    const rowIdx = baseRow + i;\n    sheet.getCell('C' + rowIdx).alignment = { horizontal: 'left', vertical: 'middle' };\n  }\n\n  // B2:B7, D2:D7, E2:E6   \n  for (let r = 2; r <= 7; r++) {\n    sheet.getCell('B' + r).border = {\n      ...sheet.getCell('B' + r).border,\n      right: { style: 'medium' }\n    };\n    sheet.getCell('D' + r).border = {\n      ...sheet.getCell('D' + r).border,\n      right: { style: 'medium' }\n    };\n    if (r <= 6) {\n      sheet.getCell('E' + r).border = {\n        ...sheet.getCell('E' + r).border,\n        right: { style: 'medium' }\n      };\n    }\n  }\n  // E7, G7   ()\n  sheet.getCell('E7').border = {\n    ...sheet.getCell('E7').border,\n    top: { style: 'thin' },\n    right: { style: 'medium' }\n  };\n  sheet.getCell('G7').border = {\n    ...sheet.getCell('G7').border,\n    top: { style: 'thin' }\n  };\n\n  // A1~A7      ( )\n  for (let r = 1; r <= 7; r++) {\n    const currentBorder = sheet.getCell('A' + r).border || {};\n    sheet.getCell('A' + r).border = {\n      ...currentBorder,\n      left: { style: 'medium' }\n    };\n  }\n\n  //  (A)     \n  const sumCellBorder = sheet.getCell('A' + sumRow).border || {};\n  sheet.getCell('A' + sumRow).border = {\n    ...sumCellBorder,\n    left: { style: 'medium' }\n  };\n\n  //   ( )\n  const colWidths = { A:4.7, B:23, C:30, D:11, E:15, F:16, G:37 };\n  Object.entries(colWidths).forEach(([col, width]) => {\n    sheet.getColumn(col).width = width;\n  });\n\n  /* -----------------------------------\n        /  \n      1 : 39.75pt\n      2~lastRow : 18pt\n  ----------------------------------- */\n  sheet.getRow(1).height = 29.8; // 39.75px29.8pt\n  sheet.getRow(1).eachCell(c => { c.font = { ...(c.font || {}), name: ' ', size: 20 }; });\n\n  for (let r = 2; r <= lastRow; r++) {\n    const row = sheet.getRow(r);\n    row.height = 15.75; // 21px15.75pt\n    row.eachCell(c => {\n      c.font = { ...(c.font || {}), name: ' ', size: 11 };\n    });\n  }\n\n  // G       \n  for (let r = 9; r <= lastRow; r++) {\n    sheet.getCell('G' + r).alignment = { horizontal: 'left', vertical: 'middle', wrapText: false, shrinkToFit: true };\n    sheet.getCell('B' + r).alignment = { horizontal: 'left', vertical: 'middle' };\n  }\n\n  // 9.  \n  const buffer = await workbook.xlsx.writeBuffer();\n  return new Blob([buffer], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n}","\"use client\";\n\n// src/alert-dialog.tsx\nimport * as React from \"react\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\nimport { createDialogScope } from \"@radix-ui/react-dialog\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { createSlottable } from \"@radix-ui/react-slot\";\nimport { jsx, jsxs } from \"react/jsx-runtime\";\nvar ROOT_NAME = \"AlertDialog\";\nvar [createAlertDialogContext, createAlertDialogScope] = createContextScope(ROOT_NAME, [\n  createDialogScope\n]);\nvar useDialogScope = createDialogScope();\nvar AlertDialog = (props) => {\n  const { __scopeAlertDialog, ...alertDialogProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Root, { ...dialogScope, ...alertDialogProps, modal: true });\n};\nAlertDialog.displayName = ROOT_NAME;\nvar TRIGGER_NAME = \"AlertDialogTrigger\";\nvar AlertDialogTrigger = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...triggerProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Trigger, { ...dialogScope, ...triggerProps, ref: forwardedRef });\n  }\n);\nAlertDialogTrigger.displayName = TRIGGER_NAME;\nvar PORTAL_NAME = \"AlertDialogPortal\";\nvar AlertDialogPortal = (props) => {\n  const { __scopeAlertDialog, ...portalProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Portal, { ...dialogScope, ...portalProps });\n};\nAlertDialogPortal.displayName = PORTAL_NAME;\nvar OVERLAY_NAME = \"AlertDialogOverlay\";\nvar AlertDialogOverlay = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...overlayProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Overlay, { ...dialogScope, ...overlayProps, ref: forwardedRef });\n  }\n);\nAlertDialogOverlay.displayName = OVERLAY_NAME;\nvar CONTENT_NAME = \"AlertDialogContent\";\nvar [AlertDialogContentProvider, useAlertDialogContentContext] = createAlertDialogContext(CONTENT_NAME);\nvar Slottable = createSlottable(\"AlertDialogContent\");\nvar AlertDialogContent = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, children, ...contentProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    const contentRef = React.useRef(null);\n    const composedRefs = useComposedRefs(forwardedRef, contentRef);\n    const cancelRef = React.useRef(null);\n    return /* @__PURE__ */ jsx(\n      DialogPrimitive.WarningProvider,\n      {\n        contentName: CONTENT_NAME,\n        titleName: TITLE_NAME,\n        docsSlug: \"alert-dialog\",\n        children: /* @__PURE__ */ jsx(AlertDialogContentProvider, { scope: __scopeAlertDialog, cancelRef, children: /* @__PURE__ */ jsxs(\n          DialogPrimitive.Content,\n          {\n            role: \"alertdialog\",\n            ...dialogScope,\n            ...contentProps,\n            ref: composedRefs,\n            onOpenAutoFocus: composeEventHandlers(contentProps.onOpenAutoFocus, (event) => {\n              event.preventDefault();\n              cancelRef.current?.focus({ preventScroll: true });\n            }),\n            onPointerDownOutside: (event) => event.preventDefault(),\n            onInteractOutside: (event) => event.preventDefault(),\n            children: [\n              /* @__PURE__ */ jsx(Slottable, { children }),\n              /* @__PURE__ */ jsx(DescriptionWarning, { contentRef })\n            ]\n          }\n        ) })\n      }\n    );\n  }\n);\nAlertDialogContent.displayName = CONTENT_NAME;\nvar TITLE_NAME = \"AlertDialogTitle\";\nvar AlertDialogTitle = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...titleProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Title, { ...dialogScope, ...titleProps, ref: forwardedRef });\n  }\n);\nAlertDialogTitle.displayName = TITLE_NAME;\nvar DESCRIPTION_NAME = \"AlertDialogDescription\";\nvar AlertDialogDescription = React.forwardRef((props, forwardedRef) => {\n  const { __scopeAlertDialog, ...descriptionProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Description, { ...dialogScope, ...descriptionProps, ref: forwardedRef });\n});\nAlertDialogDescription.displayName = DESCRIPTION_NAME;\nvar ACTION_NAME = \"AlertDialogAction\";\nvar AlertDialogAction = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...actionProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Close, { ...dialogScope, ...actionProps, ref: forwardedRef });\n  }\n);\nAlertDialogAction.displayName = ACTION_NAME;\nvar CANCEL_NAME = \"AlertDialogCancel\";\nvar AlertDialogCancel = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...cancelProps } = props;\n    const { cancelRef } = useAlertDialogContentContext(CANCEL_NAME, __scopeAlertDialog);\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    const ref = useComposedRefs(forwardedRef, cancelRef);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Close, { ...dialogScope, ...cancelProps, ref });\n  }\n);\nAlertDialogCancel.displayName = CANCEL_NAME;\nvar DescriptionWarning = ({ contentRef }) => {\n  const MESSAGE = `\\`${CONTENT_NAME}\\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \\`${CONTENT_NAME}\\` by passing a \\`${DESCRIPTION_NAME}\\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \\`id\\` and passing the same value to the \\`aria-describedby\\` prop in \\`${CONTENT_NAME}\\`. If the description is confusing or duplicative for sighted users, you can use the \\`@radix-ui/react-visually-hidden\\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;\n  React.useEffect(() => {\n    const hasDescription = document.getElementById(\n      contentRef.current?.getAttribute(\"aria-describedby\")\n    );\n    if (!hasDescription) console.warn(MESSAGE);\n  }, [MESSAGE, contentRef]);\n  return null;\n};\nvar Root2 = AlertDialog;\nvar Trigger2 = AlertDialogTrigger;\nvar Portal2 = AlertDialogPortal;\nvar Overlay2 = AlertDialogOverlay;\nvar Content2 = AlertDialogContent;\nvar Action = AlertDialogAction;\nvar Cancel = AlertDialogCancel;\nvar Title2 = AlertDialogTitle;\nvar Description2 = AlertDialogDescription;\nexport {\n  Action,\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogOverlay,\n  AlertDialogPortal,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n  Cancel,\n  Content2 as Content,\n  Description2 as Description,\n  Overlay2 as Overlay,\n  Portal2 as Portal,\n  Root2 as Root,\n  Title2 as Title,\n  Trigger2 as Trigger,\n  createAlertDialogScope\n};\n//# sourceMappingURL=index.mjs.map\n","import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm\",\n      \"data-[state=open]:animate-in data-[state=closed]:animate-out\",\n      \"data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50\",\n        \"w-full max-w-md translate-x-[-50%] translate-y-[-50%]\",\n        \"grid gap-4 bg-white border border-gray-200\",\n        \"rounded-lg p-6 shadow-professional-xl\",\n        \"duration-200\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out\",\n        \"data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n        \"data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95\",\n        \"data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]\",\n        \"data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end gap-3\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-gray-800 tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-gray-600\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}","import { memo, useMemo, useState, useCallback } from \"react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport PurchaseDetailModal from \"./PurchaseDetailModal\";\nimport MobilePurchaseCard from \"./MobilePurchaseCard\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { generatePurchaseOrderExcelJS, PurchaseOrderData } from \"@/utils/exceljs/generatePurchaseOrderExcel\";\nimport { formatDateShort } from \"@/utils/helpers\";\nimport { logger } from \"@/lib/logger\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Purchase, PurchaseRequestWithDetails } from \"@/types/purchase\";\n\ninterface FastPurchaseTableProps {\n  purchases: Purchase[];\n  activeTab?: string; //   \n  currentUserRoles?: string[];\n  onRefresh?: (forceRefresh?: boolean, options?: { silent?: boolean }) => void | Promise<void>;\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n}\n\n//    ( )\nconst StatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const status = purchase.is_received \n    ? 'completed'\n    : (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')\n    ? 'inProgress'\n    : (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected')\n    ? 'rejected'\n    : 'pending';\n  \n  const config = {\n    completed: { text: '', className: 'badge-success' },\n    inProgress: { text: '', className: 'badge-primary' },\n    rejected: { text: '', className: 'badge-danger' },\n    pending: { text: '', className: 'badge-warning' }\n  };\n  \n  const { text, className } = config[status];\n  return <Badge className={className}>{text}</Badge>;\n});\n\nStatusBadge.displayName = 'StatusBadge';\n\n//     \nconst getCurrencySymbol = (currency: string) => {\n  if (!currency) return '';\n  if (['KRW', '', ''].includes(currency)) return '';\n  if (['USD', '$', ''].includes(currency)) return '$';\n  if (['EUR', ''].includes(currency)) return '';\n  if (['JPY', '', ''].includes(currency)) return '';\n  if (['CNY', '', ''].includes(currency)) return '';\n  return currency;\n};\n\n//   DB  1,979        (2025-10-28)\n//   : 90      \n//  min-width = max-width   , truncate   \nconst COMMON_COLUMN_CLASSES = {\n  //    \n  approvalStatus: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  \n  //     ( )\n  purchaseOrderNumber: \"pl-2 w-38 min-w-[155px] max-w-[155px]\",      //  +  + \n  purchaseOrderNumberCompact: \"pl-2 w-36 min-w-[140px] max-w-[140px]\", //   (  )\n  paymentCategory: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  requesterName: \"w-16 min-w-[68px] max-w-[68px]\",\n  requestDate: \"w-20 min-w-[85px] max-w-[85px]\",\n  vendorName: \"w-28 min-w-[115px] max-w-[115px]\",\n  contactName: \"w-16 min-w-[68px] max-w-[68px]\",\n  deliveryRequestDate: \"w-20 min-w-[85px] max-w-[85px]\",\n  revisedDeliveryRequestDate: \"w-20 min-w-[85px] max-w-[85px]\",\n  itemName: \"w-28 min-w-[120px] max-w-[120px]\",                       //  7.8 + \n  specification: \"w-64 min-w-[260px] max-w-[260px]\",                  //  15.5 +  (  )\n  quantity: \"text-center w-14 min-w-[60px] max-w-[60px]\",\n  unitPrice: \"text-right w-24 min-w-[100px] max-w-[100px]\",\n  amount: \"text-right w-24 min-w-[100px] max-w-[100px]\",\n  \n  //    ( )\n  remark: \"w-28 min-w-[115px] max-w-[115px]\",                         //  1.8,  \n  paymentSchedule: \"w-24 min-w-[100px] max-w-[100px]\",\n  purchaseStatus: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  projectVendor: \"w-24 min-w-[105px] max-w-[105px]\",                  //  6.6\n  salesOrderNumber: \"w-28 min-w-[115px] max-w-[115px]\",               //  8.6\n  projectItem: \"w-44 min-w-[180px] max-w-[180px]\",                    //  11.1 +  (  )\n  receiptProgress: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  status: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  receipt: \"text-center w-24 min-w-[100px] max-w-[100px]\",           //  +  \n  paymentStatus: \"text-center w-16 min-w-[70px] max-w-[70px]\",\n  link: \"w-20 min-w-[85px] max-w-[85px]\",\n  utk: \"text-center w-12 min-w-[50px] max-w-[50px]\"  // UTK   ( )\n};\n\n//      ( )\nconst ApprovalStatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const middleApproved = purchase.middle_manager_status === 'approved';\n  const middleRejected = purchase.middle_manager_status === 'rejected';\n  const finalApproved = purchase.final_manager_status === 'approved';\n  const finalRejected = purchase.final_manager_status === 'rejected';\n\n  //   \n  if (middleRejected || finalRejected) {\n    //    \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-0.5\">\n          <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse\"></div>\n        </div>\n        <Badge variant={null} className=\"badge-danger\">\n          \n        </Badge>\n      </div>\n    );\n  }\n  \n  if (middleApproved && finalApproved) {\n    //    \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-0.5\">\n          <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\n        </div>\n        <Badge variant={null} className=\"badge-success\">\n          \n        </Badge>\n      </div>\n    );\n  }\n  \n  if (middleApproved && !finalApproved && !finalRejected) {\n    //  \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-1\">\n          <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\n          <div className=\"w-3 h-0.5 bg-gray-300\"></div>\n          <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n        </div>\n        <Badge variant={null} className=\"badge-warning\">\n          1 \n        </Badge>\n      </div>\n    );\n  }\n  \n  //   \n  return (\n    <div className=\"flex flex-col items-center gap-0.5\">\n      <div className=\"flex items-center gap-1\">\n        <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n        <div className=\"w-3 h-0.5 bg-gray-300\"></div>\n        <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n      </div>\n      <Badge variant={null} className=\"badge-secondary\">\n        \n      </Badge>\n    </div>\n  );\n});\n\nApprovalStatusBadge.displayName = 'ApprovalStatusBadge';\n\n//     (actual_received_date )\nconst getReceiptProgress = (purchase: Purchase) => {\n  // items     \n  if (!purchase.items || purchase.items.length === 0) {\n    return { received: 0, total: 1, percentage: 0 };\n  }\n  \n  //       (actual_received_date )\n  const total = purchase.items.length;\n  const received = purchase.items.filter((item: any) => \n    item.actual_received_date !== null && item.actual_received_date !== undefined\n  ).length;\n  const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n  \n  return { received, total, percentage };\n};\n\n//    \nconst getPaymentProgress = (purchase: Purchase) => {\n  // purchase_requests  is_payment_completed   \n  if (purchase.is_payment_completed) {\n    return { completed: 1, total: 1, percentage: 100 };\n  }\n  \n  // items     \n  if (!purchase.items || purchase.items.length === 0) {\n    return { completed: 0, total: 1, percentage: 0 };\n  }\n  \n  //     \n  const total = purchase.items.length;\n  const completed = purchase.items.filter((item: any) => \n    item.is_payment_completed === true\n  ).length;\n  const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n  \n  return { completed, total, percentage };\n};\n\n//     \nconst getStatementProgress = (purchase: Purchase) => {\n  // items     \n  if (!purchase.items || purchase.items.length === 0) {\n    return { completed: 0, total: 1, percentage: 0 };\n  }\n  \n  //       (is_statement_received )\n  const total = purchase.items.length;\n  const completed = purchase.items.filter((item: any) => \n    item.is_statement_received === true\n  ).length;\n  const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n  \n  return { completed, total, percentage };\n};\n\n\n// formatDateShort utils/helpers.ts import\n\n//   \nconst ProgressTypeBadge = memo(({ type }: { type?: string }) => {\n  const isAdvance = type === '' || type?.includes('');\n  \n  if (isAdvance) {\n    return (\n      <Badge variant={null} className=\"badge-danger\">\n        \n      </Badge>\n    );\n  }\n  \n  return (\n    <Badge variant={null} className=\"badge-secondary\">\n      \n    </Badge>\n  );\n});\n\nProgressTypeBadge.displayName = 'ProgressTypeBadge';\n\n//    \nconst TableRow = memo(({ purchase, onClick, activeTab, isLeadBuyer, onPaymentComplete, onReceiptComplete, onExcelDownload }: { \n  purchase: Purchase; \n  onClick: (purchase: Purchase) => void;\n  activeTab?: string;\n  isLeadBuyer?: boolean;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n  onExcelDownload?: (purchase: Purchase) => Promise<void>;\n}) => {\n  const receiptProgress = getReceiptProgress(purchase);\n  const paymentProgress = getPaymentProgress(purchase);\n  const statementProgress = getStatementProgress(purchase);\n  const isAdvance = purchase.progress_type === '' || purchase.progress_type?.includes('');\n  \n  return (\n    <tr \n      className={`border-b hover:bg-gray-100 cursor-pointer transition-colors ${isAdvance ? 'bg-red-50 hover:bg-red-100' : ''}`}\n      onClick={() => onClick(purchase)}\n    >\n      {/*       */}\n      {activeTab === 'pending' && (\n        <td className={`px-2 py-1.5 whitespace-nowrap ${COMMON_COLUMN_CLASSES.approvalStatus}`}>\n          <ApprovalStatusBadge purchase={purchase} />\n        </td>\n      )}\n      {/*      */}\n      {activeTab === 'purchase' && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <div className=\"flex items-center justify-center gap-1\">\n            <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n              <div \n                className={`h-1.5 rounded-full ${\n                  paymentProgress.percentage === 100 ? 'bg-blue-500' : \n                  paymentProgress.percentage > 0 ? 'bg-blue-400' : 'bg-gray-300'\n                }`}\n                style={{ width: `${paymentProgress.percentage}%` }}\n              />\n            </div>\n            <span className=\"card-title text-gray-600\">\n              {paymentProgress.percentage}%\n            </span>\n          </div>\n        </td>\n      )}\n      {/*       */}\n      {activeTab === 'receipt' && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <div className=\"flex items-center justify-center gap-1\">\n            <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n              <div \n                className={`h-1.5 rounded-full ${\n                  receiptProgress.percentage === 100 ? 'bg-green-500' : \n                  receiptProgress.percentage > 0 ? 'bg-hansl-500' : 'bg-gray-300'\n                }`}\n                style={{ width: `${receiptProgress.percentage}%` }}\n              />\n            </div>\n            <span className=\"card-title text-gray-600\">\n              {receiptProgress.percentage}%\n            </span>\n          </div>\n        </td>\n      )}\n      {/*        */}\n      {activeTab === 'done' && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <div className=\"flex items-center justify-center gap-1\">\n            <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n              <div \n                className={`h-1.5 rounded-full ${\n                  statementProgress.percentage === 100 ? 'bg-green-500' : \n                  statementProgress.percentage > 0 ? 'bg-hansl-500' : 'bg-gray-300'\n                }`}\n                style={{ width: `${statementProgress.percentage}%` }}\n              />\n            </div>\n            <span className=\"card-title text-gray-600\">\n              {statementProgress.percentage}%\n            </span>\n          </div>\n        </td>\n      )}\n      <td className={`px-2 py-1.5 card-title whitespace-nowrap ${activeTab === 'purchase' ? COMMON_COLUMN_CLASSES.purchaseOrderNumberCompact : COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}>\n        <div className=\"flex items-center gap-1\">\n          {/*    -  ,   / */}\n          {onExcelDownload && (\n            <img\n              src=\"/excels-icon.svg\"\n              alt=\" \"\n              width=\"16\"\n              height=\"16\"\n              className={`inline-block align-middle transition-transform p-0.5 rounded\n                ${purchase.is_po_download ? 'border border-gray-400' : ''}\n                ${(purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                  (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved'))\n                  ? (purchase.is_po_download ? 'cursor-pointer' : 'cursor-pointer hover:scale-110')\n                  : 'opacity-40 grayscale cursor-not-allowed'}`}\n              onClick={async (e: React.MouseEvent) => {\n                if (purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                    (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')) {\n                  e.stopPropagation();\n                  await onExcelDownload(purchase);\n                }\n              }}\n              style={{\n                pointerEvents: (purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                  (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved'))\n                  ? 'auto' : 'none'\n              }}\n              title={purchase.is_po_download ? ' ' : '  '}\n            />\n          )}\n          <span className=\"block truncate\" title={purchase.purchase_order_number || ''}>\n            {purchase.purchase_order_number || '-'}\n            {purchase.items && purchase.items.length > 1 && (\n              <span className=\"text-gray-500 ml-0.5\">({purchase.items.length})</span>\n            )}\n          </span>\n        </div>\n      </td>\n      {/*     */}\n      {(activeTab === 'pending' || activeTab === 'purchase' || activeTab === 'receipt' || activeTab === 'done' || !activeTab) && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}>\n          <Badge variant={null} className={\n            purchase.payment_category === '' || purchase.payment_category === ' ' ? 'badge-primary' :\n            purchase.payment_category === '' ? 'badge-success' :\n            purchase.payment_category === '' || purchase.payment_category === ' ' ? 'badge-secondary' :\n            purchase.payment_category === ' ' ? 'badge-secondary' :\n            'badge-secondary'\n          }>\n            {(() => {\n              //   \n              if (purchase.payment_category === '') return '';\n              if (purchase.payment_category === ' ') return '';\n              if (purchase.payment_category === ' ') return '';\n              return purchase.payment_category || '-';\n            })()}\n          </Badge>\n        </td>\n      )}\n      <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.requesterName}`}>\n        <span className=\"block truncate\" title={purchase.requester_name || ''}>\n          {purchase.requester_name || '-'}\n        </span>\n      </td>\n      <td className={`pl-2 pr-0 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.requestDate}`}>\n        {formatDateShort(purchase.request_date)}\n      </td>\n      {/*   UTK    (  ) */}\n      {activeTab === 'done' && (\n        <td className={`pl-0 pr-2 py-1.5 card-title whitespace-nowrap text-center ${COMMON_COLUMN_CLASSES.utk}`}>\n          <Badge variant={null} className={\n            (purchase as any).is_utk_checked \n              ? 'bg-orange-500 text-white' \n              : 'bg-white border border-gray-300 text-gray-600'\n          }>\n            {(purchase as any).is_utk_checked ? '' : ''}\n          </Badge>\n        </td>\n      )}\n      <td className={`pl-2 pr-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.vendorName}`}>\n        <span className=\"block truncate\" title={purchase.vendor_name || ''}>\n          {purchase.vendor_name || '-'}\n        </span>\n      </td>\n      <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.contactName}`}>\n        <span className=\"block truncate\" title={purchase.contact_name || ''}>\n          {purchase.contact_name || '-'}\n        </span>\n      </td>\n      <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.deliveryRequestDate} ${\n        purchase.revised_delivery_request_date ? 'text-gray-400' : ''\n      }`}>\n        {formatDateShort(purchase.delivery_request_date)}\n      </td>\n      {(activeTab === 'receipt' || activeTab === 'done' || !activeTab) && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.revisedDeliveryRequestDate}`}>\n          {formatDateShort(purchase.revised_delivery_request_date)}\n        </td>\n      )}\n      <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.itemName}`}>\n        <span className=\"block truncate\" title={purchase.item_name || ''}>\n          {purchase.item_name || '-'}\n        </span>\n      </td>\n      <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.specification}`}>\n        <span className=\"block truncate\" title={purchase.specification || ''}>\n          {purchase.specification || '-'}\n        </span>\n      </td>\n      <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.quantity}`}>\n        {purchase.quantity || 0}\n      </td>\n      <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}>\n        {purchase.unit_price_value ? `${purchase.unit_price_value.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : `0 ${getCurrencySymbol(purchase.currency || 'KRW')}`}\n      </td>\n      <td className={`px-2 py-1.5 card-amount whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}>\n        {purchase.amount_value ? `${purchase.amount_value.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : purchase.total_amount ? `${purchase.total_amount.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : `0 ${getCurrencySymbol(purchase.currency || 'KRW')}`}\n      </td>\n      \n      {/*     */}\n      {activeTab === 'pending' && (\n        <>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n            <span className=\"block truncate\" title={purchase.remark || ''}>\n              {purchase.remark || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n            <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n              {purchase.project_vendor || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n            <span className=\"block truncate\" title={purchase.project_item || ''}>\n              {purchase.project_item || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n            <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n              {purchase.sales_order_number || '-'}\n            </span>\n          </td>\n        </>\n      )}\n      \n      {activeTab === 'purchase' && (\n        <>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n            <span className=\"block truncate\" title={purchase.remark || ''}>\n              {purchase.remark || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.link}`}>\n            {purchase.link ? (\n              <a \n                href={purchase.link} \n                target=\"_blank\" \n                rel=\"noopener noreferrer\" \n                className=\"text-blue-600 hover:text-blue-800 underline truncate block\"\n                title={purchase.link}\n              >\n                 \n              </a>\n            ) : (\n              <span className=\"text-gray-400\">-</span>\n            )}\n          </td>\n          {activeTab !== 'receipt' && (\n            <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentSchedule}`}>\n              <span className=\"block truncate\" title={purchase.vendor_payment_schedule || ''}>\n                {purchase.vendor_payment_schedule || '-'}\n              </span>\n            </td>\n          )}\n        </>\n      )}\n      \n      {activeTab === 'receipt' && (\n        <>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n            <span className=\"block truncate\" title={purchase.remark || ''}>\n              {purchase.remark || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n            <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n              {purchase.project_vendor || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n            <span className=\"block truncate\" title={purchase.project_item || ''}>\n              {purchase.project_item || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n            <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n              {purchase.sales_order_number || '-'}\n            </span>\n          </td>\n        </>\n      )}\n      \n      {(activeTab === 'done' || !activeTab) && (\n        <>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n            <span className=\"block truncate\" title={purchase.remark || ''}>\n              {purchase.remark || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.link}`}>\n            {purchase.link ? (\n              <a \n                href={purchase.link} \n                target=\"_blank\" \n                rel=\"noopener noreferrer\" \n                className=\"text-blue-600 hover:text-blue-800 underline truncate block\"\n                title={purchase.link}\n              >\n                 \n              </a>\n            ) : (\n              <span className=\"text-gray-400\">-</span>\n            )}\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n            <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n              {purchase.project_vendor || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n            <span className=\"block truncate\" title={purchase.project_item || ''}>\n              {purchase.project_item || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n            <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n              {purchase.sales_order_number || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentSchedule}`}>\n            <span className=\"block truncate\" title={purchase.vendor_payment_schedule || ''}>\n              {purchase.vendor_payment_schedule || '-'}\n            </span>\n          </td>\n          <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.status}`}>\n            <span className=\"text-gray-400 card-title\">-</span>\n          </td>\n          <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receipt}`}>\n            <div className=\"flex items-center justify-center gap-1\">\n              <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n                <div \n                  className={`h-1.5 rounded-full ${\n                    receiptProgress.percentage === 100 ? 'bg-green-500' : \n                    receiptProgress.percentage > 0 ? 'bg-hansl-500' : 'bg-gray-300'\n                  }`}\n                  style={{ width: `${receiptProgress.percentage}%` }}\n                />\n              </div>\n              <span className=\"card-title text-gray-600\">\n                {receiptProgress.percentage}%\n              </span>\n            </div>\n          </td>\n        </>\n      )}\n      \n    </tr>\n  );\n});\n\nTableRow.displayName = 'TableRow';\n\n//   \nconst FastPurchaseTable = memo(({ \n  purchases, \n  activeTab = 'done', \n  currentUserRoles = [], \n  onRefresh,\n  onOptimisticUpdate,\n  onPaymentComplete,\n  onReceiptComplete \n}: FastPurchaseTableProps) => {\n  const [selectedPurchaseId, setSelectedPurchaseId] = useState<number | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [deleteConfirmOpen, setDeleteConfirmOpen] = useState(false);\n  const [purchaseToDelete, setPurchaseToDelete] = useState<Purchase | null>(null);\n  const supabase = createClient();\n\n  //   - lead buyer app_admin /   \n  const isLeadBuyer = currentUserRoles && (\n    currentUserRoles.includes('lead buyer') ||\n    currentUserRoles.includes('app_admin')\n  );\n  \n\n  //  \n  const canEdit = currentUserRoles.includes('final_approver') || \n                  currentUserRoles.includes('app_admin') || \n                  currentUserRoles.includes('ceo');\n  \n  const canDelete = canEdit;\n\n  const handleRowClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchaseId(purchase.id);\n    setIsModalOpen(true);\n  }, []);\n\n  const handleCloseModal = useCallback(() => {\n    setIsModalOpen(false);\n    setSelectedPurchaseId(null);\n  }, []);\n\n  //   \n  const handleExcelDownload = useCallback(async (purchase: Purchase) => {\n    try {\n      // DB    \n      const { data: purchaseRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .single();\n\n      if (requestError || !purchaseRequest) {\n        toast.error('     .');\n        return;\n      }\n\n      //   \n      const { data: orderItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .order('line_number');\n\n      if (itemsError || !orderItems || orderItems.length === 0) {\n        toast.error('      .');\n        return;\n      }\n\n      //       \n      const vendorInfo = {\n        vendor_name: purchase.vendor_name,\n        vendor_phone: '',\n        vendor_fax: '',\n        vendor_contact_name: '',\n        vendor_payment_schedule: ''\n      };\n\n      try {\n        const vendorId = purchaseRequest.vendor_id || purchase.vendor_id;\n        const contactId = purchaseRequest.contact_id || purchase.contact_id;\n        \n        // vendor  \n        if (vendorId) {\n          const { data: vendorData } = await supabase\n            .from('vendors')\n            .select('vendor_phone, vendor_fax, vendor_payment_schedule')\n            .eq('id', vendorId)\n            .single();\n\n          if (vendorData) {\n            vendorInfo.vendor_phone = vendorData.vendor_phone || '';\n            vendorInfo.vendor_fax = vendorData.vendor_fax || '';\n            vendorInfo.vendor_payment_schedule = vendorData.vendor_payment_schedule || '';\n          }\n        }\n\n        // vendor_contacts contact_id   \n        if (contactId) {\n          const { data: contactData } = await supabase\n            .from('vendor_contacts')\n            .select('contact_name, contact_phone, contact_email')\n            .eq('id', contactId)\n            .single();\n          if (contactData) {\n            vendorInfo.vendor_contact_name = contactData.contact_name || '';\n          }\n        }\n      } catch (error) {\n        //     \n      }\n\n      const excelData: PurchaseOrderData = {\n        purchase_order_number: purchaseRequest.purchase_order_number || '',\n        request_date: purchaseRequest.request_date,\n        delivery_request_date: purchaseRequest.delivery_request_date,\n        requester_name: purchaseRequest.requester_name,\n        vendor_name: vendorInfo.vendor_name || '',\n        vendor_contact_name: vendorInfo.vendor_contact_name,\n        vendor_phone: vendorInfo.vendor_phone,\n        vendor_fax: vendorInfo.vendor_fax,\n        project_vendor: purchaseRequest.project_vendor,\n        sales_order_number: purchaseRequest.sales_order_number,\n        project_item: purchaseRequest.project_item,\n        vendor_payment_schedule: vendorInfo.vendor_payment_schedule,\n        items: orderItems.map((item: any) => ({\n          line_number: item.line_number,\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          amount_value: item.amount_value,\n          remark: item.remark,\n          currency: purchaseRequest.currency || 'KRW'\n        }))\n      };\n\n      //   ExcelJS \n      const blob = await generatePurchaseOrderExcelJS(excelData);\n      \n      //  \n      const downloadFilename = `_${excelData.vendor_name}_${excelData.purchase_order_number}.xlsx`;\n\n      //  \n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = downloadFilename;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success('  .');\n      \n      // DB   (is_po_download)  - lead buyer \n      try {\n        const canUpdateFlag = currentUserRoles && (\n          currentUserRoles.includes('lead buyer')\n        );\n\n        if (canUpdateFlag) {\n          const { error: downloadFlagErr } = await supabase\n            .from('purchase_requests')\n            .update({ is_po_download: true })\n            .eq('purchase_order_number', purchase.purchase_order_number);\n          \n          if (!downloadFlagErr) {\n            //  \n            onRefresh?.();\n          }\n        }\n      } catch (flagErr) {\n        //    \n      }\n    } catch (error) {\n      toast.error('  .');\n    }\n  }, [supabase]);\n\n  const handleConfirmDelete = useCallback(async () => {\n    if (!purchaseToDelete) return;\n\n    logger.debug('  ', {\n      id: purchaseToDelete.id,\n      purchase_order_number: purchaseToDelete.purchase_order_number,\n      requester_name: purchaseToDelete.requester_name,\n      final_manager_status: purchaseToDelete.final_manager_status\n    });\n\n    try {\n      // Supabase   \n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n      const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n      \n      if (!supabaseUrl || !supabaseAnonKey || supabaseUrl.includes('placeholder')) {\n        logger.warn('Supabase     - FastPurchaseTable');\n        toast.error(\"   .\");\n        return;\n      }\n\n      //    \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      \n      if (authError || !user) {\n        toast.error(\" .\");\n        return;\n      }\n\n      //   \n      const { data: employee, error: empError } = await supabase\n        .from('employees')\n        .select('name, email, purchase_role')\n        .eq('email', user.email)\n        .single();\n\n      logger.debug('  ', {\n        employee: employee?.name,\n        roles: employee?.purchase_role,\n        email: employee?.email\n      });\n\n      if (empError || !employee) {\n        toast.error(\"    .\");\n        return;\n      }\n\n      //  \n      let roles: string[] = [];\n      if (employee.purchase_role) {\n        if (Array.isArray(employee.purchase_role)) {\n          roles = employee.purchase_role.map(r => String(r).trim());\n        } else {\n          const roleString = String(employee.purchase_role);\n          roles = roleString.split(',').map(r => r.trim()).filter(r => r.length > 0);\n        }\n      }\n\n      const canEdit = roles.includes('final_approver') || \n                      roles.includes('app_admin') || \n                      roles.includes('ceo');\n      \n      const isApproved = purchaseToDelete.final_manager_status === 'approved';\n      const isRequester = purchaseToDelete.requester_name === employee.name;\n      const canDeleteThis = isApproved ? canEdit : (canEdit || isRequester);\n\n      logger.debug('  ', {\n        canEdit,\n        isApproved,\n        isRequester,\n        canDeleteThis,\n        userRoles: roles\n      });\n\n      if (!canDeleteThis) {\n        toast.error(\"  .\");\n        return;\n      }\n\n\n      //   \n      const { data: deletedItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .delete()\n        .eq('purchase_request_id', purchaseToDelete.id)\n        .select();\n\n      if (itemsError) {\n        logger.error('    ', itemsError, {\n          code: itemsError.code,\n          message: itemsError.message,\n          details: itemsError.details,\n          hint: itemsError.hint\n        });\n        throw itemsError;\n      }\n\n      logger.debug('  ', {\n        deletedItemsCount: deletedItems?.length || 0,\n        purchaseRequestId: purchaseToDelete.id\n      });\n\n      //  \n      const { data: deletedRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .delete()\n        .eq('id', purchaseToDelete.id)\n        .select();\n\n      if (requestError) {\n        logger.error('    ', requestError, {\n          code: requestError.code,\n          message: requestError.message,\n          details: requestError.details,\n          hint: requestError.hint\n        });\n        throw requestError;\n      }\n\n      logger.debug('  ', {\n        deletedRequestId: purchaseToDelete.id,\n        purchase_order_number: purchaseToDelete.purchase_order_number\n      });\n\n      toast.success(\"  .\");\n      onRefresh?.();\n    } catch (error) {\n      const errorObj = error as any;\n      logger.error('    ', errorObj, {\n        name: errorObj?.name,\n        message: errorObj?.message,\n        code: errorObj?.code,\n        details: errorObj?.details,\n        hint: errorObj?.hint,\n        stack: errorObj?.stack\n      });\n      toast.error(`   : ${errorObj?.message || '   '}`);\n    }\n    \n    setDeleteConfirmOpen(false);\n    setPurchaseToDelete(null);\n  }, [supabase, purchaseToDelete, onRefresh]);\n\n  //    \n  const tableHeader = useMemo(() => {\n    if (activeTab === 'pending') {\n      return (\n        <thead className=\"bg-gray-50\">\n          <tr>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.approvalStatus}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requesterName}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requestDate}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.vendorName}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.contactName}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.deliveryRequestDate}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.itemName}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.specification}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.quantity}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n          </tr>\n        </thead>\n      );\n    }\n    \n    const baseHeaders = (\n      <>\n        <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${activeTab === 'purchase' ? COMMON_COLUMN_CLASSES.purchaseOrderNumberCompact : COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}></th>\n        {(activeTab === 'purchase' || activeTab === 'receipt' || activeTab === 'done' || !activeTab) && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}></th>\n        )}\n        <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requesterName}`}></th>\n        <th className={`pl-2 pr-0 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requestDate}`}></th>\n        {/*   UTK     */}\n        {activeTab === 'done' && (\n          <th className={`pl-0 pr-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-center ${COMMON_COLUMN_CLASSES.utk}`}>UTK</th>\n        )}\n        <th className={`pl-2 pr-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.vendorName}`}></th>\n        <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.contactName}`}></th>\n        <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.deliveryRequestDate}`}></th>\n        {(activeTab === 'receipt' || activeTab === 'done' || !activeTab) && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.revisedDeliveryRequestDate}`}> </th>\n        )}\n        <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.itemName}`}></th>\n        <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.specification}`}></th>\n        <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.quantity}`}></th>\n        <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}></th>\n        <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}></th>\n      </>\n    );\n\n    let additionalHeaders = null;\n    \n    if (activeTab === 'purchase') {\n      additionalHeaders = (\n        <>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.link}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.paymentSchedule}`}></th>\n        </>\n      );\n    } else if (activeTab === 'receipt') {\n      additionalHeaders = (\n        <>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n        </>\n      );\n    } else {\n      // done  \n      additionalHeaders = (\n        <>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.link}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.paymentSchedule}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.status}`}></th>\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receipt}`}></th>\n        </>\n      );\n    }\n\n    return (\n      <thead className=\"bg-gray-50\">\n        <tr>\n          {/*       */}\n          {activeTab === 'purchase' && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n          )}\n          {/*      */}\n          {activeTab === 'receipt' && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n          )}\n          {/*       */}\n          {activeTab === 'done' && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n          )}\n          {baseHeaders}\n          {additionalHeaders}\n        </tr>\n      </thead>\n    );\n  }, [activeTab]);\n\n  return (\n    <>\n      {/*    -   1,979     */}\n      <div className=\"hidden md:block w-full\">\n        <div className=\"overflow-x-auto border rounded-lg\">\n          <table className=\"w-full min-w-[1790px] border-collapse\">\n            {tableHeader}\n            <tbody>\n              {purchases.map((purchase) => (\n                <TableRow \n                  key={purchase.id} \n                  purchase={purchase} \n                  onClick={handleRowClick}\n                  activeTab={activeTab}\n                  isLeadBuyer={isLeadBuyer}\n                  onPaymentComplete={onPaymentComplete}\n                  onReceiptComplete={onReceiptComplete}\n                  onExcelDownload={handleExcelDownload}\n                />\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      \n      {/*    */}\n      <div className=\"hidden sm:block md:hidden w-full\">\n        <div className=\"overflow-x-auto border rounded-lg\">\n          <table className=\"w-full min-w-[600px] card-title\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-24\"></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-16\"></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-20\"></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-32\"></th>\n                <th className=\"text-right p-2 modal-label text-gray-900 w-20\"></th>\n                <th className=\"text-center p-2 modal-label text-gray-900 w-16\"></th>\n              </tr>\n            </thead>\n            <tbody>\n              {purchases.map((purchase) => (\n                <tr \n                  key={purchase.id}\n                  className=\"border-b hover:bg-gray-50 cursor-pointer\"\n                  onClick={() => handleRowClick(purchase)}\n                >\n                  <td className=\"p-2 modal-value\">{purchase.purchase_order_number || '-'}</td>\n                  <td className=\"p-2\">{purchase.requester_name}</td>\n                  <td className=\"p-2 truncate\" title={purchase.vendor_name}>{purchase.vendor_name}</td>\n                  <td className=\"p-2 truncate\" title={purchase.item_name}>{purchase.item_name || '-'}</td>\n                  <td className=\"p-2 text-right card-amount\">\n                    {purchase.amount_value ? `${purchase.amount_value.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : purchase.total_amount ? `${purchase.total_amount.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : `0 ${getCurrencySymbol(purchase.currency || 'KRW')}`}\n                  </td>\n                  <td className=\"p-2 text-center\">\n                    <StatusBadge purchase={purchase} />\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      \n      {/*    */}\n      <div className=\"sm:hidden space-y-3\">\n        {purchases.map((purchase) => (\n          <MobilePurchaseCard\n            key={purchase.id}\n            purchase={purchase}\n            onClick={() => handleRowClick(purchase)}\n          />\n        ))}\n      </div>\n      \n      {/*  /  */}\n      <PurchaseDetailModal\n        purchaseId={selectedPurchaseId}\n        isOpen={isModalOpen}\n        onClose={handleCloseModal}\n        currentUserRoles={currentUserRoles}\n        activeTab={activeTab}\n        onRefresh={onRefresh}\n        onOptimisticUpdate={onOptimisticUpdate}\n        onDelete={(purchase) => {\n          setPurchaseToDelete(purchase as unknown as Purchase);\n          setDeleteConfirmOpen(true);\n        }}\n      />\n\n      {/*    */}\n      <AlertDialog open={deleteConfirmOpen} onOpenChange={setDeleteConfirmOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>  </AlertDialogTitle>\n            <AlertDialogDescription>\n               {purchaseToDelete?.purchase_order_number} ?\n                  .\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel></AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmDelete}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              \n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  );\n});\n\nFastPurchaseTable.displayName = 'FastPurchaseTable';\n\nexport default FastPurchaseTable;","import { useState, useRef, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { \n  Sliders, \n  ArrowUpDown, \n  Search, \n  X, \n  Calendar,\n  Check,\n  User,\n  Building,\n  Package,\n  DollarSign,\n  CheckCircle\n} from 'lucide-react'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Calendar as CalendarComponent } from '@/components/ui/calendar'\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n} from '@/components/ui/command'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\n\n//   \ntype FilterCondition = 'contains' | 'equals' | 'starts_with' | 'ends_with' | 'is_empty' | 'is_not_empty' | 'greater_than' | 'less_than' | 'after' | 'before' | 'not_equals'\n\n//   \nexport interface FilterRule {\n  id: string\n  field: string\n  condition: FilterCondition\n  value: string | number | Date\n  label: string\n  dateField?: string // /    \n}\n\nexport interface SortRule {\n  field: string\n  direction: 'asc' | 'desc'\n  label: string\n}\n\ninterface FilterToolbarProps {\n  activeFilters: FilterRule[]\n  sortConfig: SortRule | null\n  searchTerm: string\n  onFiltersChange: (filters: FilterRule[]) => void\n  onSortChange: (sort: SortRule | null) => void\n  onSearchChange: (search: string) => void\n  availableEmployees?: string[]\n  availableVendors?: string[]\n  availableContacts?: string[]\n  availablePaymentSchedules?: string[]\n}\n\n//   \nconst FILTER_FIELDS = [\n  //  \n  { \n    key: 'date_range', \n    label: '', \n    type: 'date_range',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'date_month', \n    label: '', \n    type: 'date_month',\n    icon: Calendar,\n    category: ''\n  },\n  \n  // & \n  { \n    key: 'requester_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  { \n    key: 'vendor_name', \n    label: '', \n    type: 'searchable_select',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'contact_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'purchase_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'item_name', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'specification', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'remark', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'project_vendor', \n    label: 'PJ', \n    type: 'text',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'project_item', \n    label: 'PJ ITEM', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'sales_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'quantity', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'unit_price_value', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'total_amount', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'payment_category', \n    label: '', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '', '']\n  },\n  { \n    key: 'payment_schedule', \n    label: '', \n    type: 'select_with_empty',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'is_payment_completed', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_received', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_statement_received', \n    label: ' ', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_utk_checked', \n    label: 'UTK ', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '']\n  }\n]\n\n//   \nconst TEXT_CONDITIONS = [\n  { value: 'contains', label: '' },\n  { value: 'equals', label: '' },\n  { value: 'starts_with', label: '' },\n  { value: 'ends_with', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst NUMBER_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'greater_than', label: '' },\n  { value: 'less_than', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst DATE_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'after', label: '' },\n  { value: 'before', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst SELECT_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'not_equals', label: '' }\n]\n\n//    \nconst DATE_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'payment_completed_at', label: '' },\n  { value: 'received_at', label: '' },\n  { value: 'created_at', label: '' },\n  { value: 'statement_received_at', label: '' }\n]\n\n//   \nconst SORT_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'purchase_order_number', label: '' },\n  { value: 'vendor_name', label: '' },\n  { value: 'requester_name', label: '' },\n  { value: 'total_amount', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'created_at', label: '' }\n]\n\nexport default function FilterToolbar({\n  activeFilters,\n  sortConfig,\n  searchTerm,\n  onFiltersChange,\n  onSortChange,\n  onSearchChange,\n  availableEmployees = [],\n  availableVendors = [],\n  availableContacts = [],\n  availablePaymentSchedules = []\n}: FilterToolbarProps) {\n  const [isFilterOpen, setIsFilterOpen] = useState(false)\n  const [isSortOpen, setIsSortOpen] = useState(false)\n  const [isSearchExpanded, setIsSearchExpanded] = useState(false)\n  const [newFilter, setNewFilter] = useState<Partial<FilterRule>>({})\n  const [datePickerOpen, setDatePickerOpen] = useState(false)\n  const [monthPickerOpen, setMonthPickerOpen] = useState(false)\n  const [tempDateRange, setTempDateRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempMonth, setTempMonth] = useState<Date | undefined>()\n  const [tempMonthRange, setTempMonthRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempSort, setTempSort] = useState<{field?: string, direction?: 'asc' | 'desc'}>({})\n  const searchInputRef = useRef<HTMLInputElement>(null)\n\n  //    \n  useEffect(() => {\n    if (isSearchExpanded && searchInputRef.current) {\n      searchInputRef.current.focus()\n    }\n  }, [isSearchExpanded])\n\n  //       \n  useEffect(() => {\n    if (isSortOpen) {\n      setTempSort({\n        field: sortConfig?.field || '',\n        direction: sortConfig?.direction || 'asc'\n      })\n    }\n  }, [isSortOpen, sortConfig])\n\n  const handleAddFilter = (field: string) => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === field)\n    if (!fieldConfig) return\n\n    //      \n    let defaultCondition = 'contains'\n    if (fieldConfig.type === 'date_range' || fieldConfig.type === 'date_month') {\n      defaultCondition = 'equals'\n    }\n\n    setNewFilter({\n      id: `${field}_${Date.now()}`,\n      field,\n      condition: defaultCondition,\n      value: '',\n      label: fieldConfig.label\n    })\n  }\n\n  const handleApplyFilter = () => {\n    const isDateFilter = newFilter.field === 'date_range' || newFilter.field === 'date_month'\n    const requiresDateField = isDateFilter && !newFilter.dateField\n    \n    //      \n    let finalCondition = newFilter.condition\n    if (!finalCondition) {\n      if (isDateFilter) {\n        finalCondition = 'equals'\n      } else {\n        //   'contains',   'equals'\n        const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n        finalCondition = (fieldConfig?.type === 'select' || fieldConfig?.type === 'select_with_empty' || fieldConfig?.type === 'searchable_select') \n          ? 'equals' \n          : 'contains'\n      }\n    }\n    \n    if (newFilter.field && finalCondition !== undefined && newFilter.value !== '' && !requiresDateField) {\n      const filter: FilterRule = {\n        id: newFilter.id!,\n        field: newFilter.field,\n        condition: finalCondition,\n        value: newFilter.value,\n        label: newFilter.label!,\n        dateField: newFilter.dateField //    \n      }\n      onFiltersChange([...activeFilters, filter])\n      setNewFilter({})\n      setIsFilterOpen(false)\n    }\n  }\n\n  const handleRemoveFilter = (filterId: string) => {\n    onFiltersChange(activeFilters.filter(f => f.id !== filterId))\n  }\n\n  const handleClearAllFilters = () => {\n    onFiltersChange([])\n    setIsFilterOpen(false)\n  }\n\n  const handleSortFieldChange = (field: string) => {\n    setTempSort(prev => ({ ...prev, field }))\n  }\n\n  const handleSortDirectionChange = (direction: 'asc' | 'desc') => {\n    setTempSort(prev => ({ ...prev, direction }))\n  }\n\n  const handleApplySort = () => {\n    if (tempSort.field && tempSort.direction) {\n      const fieldConfig = SORT_FIELDS.find(f => f.value === tempSort.field)\n      if (fieldConfig) {\n        onSortChange({\n          field: tempSort.field,\n          direction: tempSort.direction,\n          label: fieldConfig.label\n        })\n      }\n    }\n    setIsSortOpen(false)\n    setTempSort({})\n  }\n\n  const handleClearSort = () => {\n    onSortChange(null)\n    setTempSort({})\n    setIsSortOpen(false)\n  }\n\n  const getConditionOptions = (fieldType: string) => {\n    switch (fieldType) {\n      case 'text':\n      case 'searchable_select':\n        return TEXT_CONDITIONS\n      case 'number':\n        return NUMBER_CONDITIONS\n      case 'date_range':\n      case 'date_month':\n        return DATE_CONDITIONS\n      case 'select':\n      case 'select_with_empty':\n        return SELECT_CONDITIONS\n      default:\n        return TEXT_CONDITIONS\n    }\n  }\n\n  const renderValueInput = () => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n    if (!fieldConfig) return null\n\n    switch (fieldConfig.type) {\n      case 'text':\n        return (\n          <Input\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n      \n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n\n      case 'searchable_select':\n        let options: string[] = []\n        let placeholder = \"\"\n        if (fieldConfig.key === 'requester_name') {\n          options = availableEmployees\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'vendor_name') {\n          options = availableVendors\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'contact_name') {\n          options = availableContacts\n          placeholder = \"\"\n        }\n\n        return (\n          <Popover>\n            <PopoverTrigger asChild>\n              <Button\n                variant=\"outline\"\n                role=\"combobox\"\n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between [&>svg]:hidden\"\n              >\n                <span className=\"truncate text-left\" style={{fontSize: '12px', fontWeight: '500'}}>\n                  {newFilter.value || placeholder}\n                </span>\n                <Search className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-[200px] p-0 border-0 shadow-lg\" align=\"start\">\n              <Command className=\"border-0\">\n                <CommandInput placeholder={`${placeholder} ...`} className=\"h-auto border-0 focus:ring-0 focus:outline-none card-description placeholder:card-description\" style={{padding: '2px 10px'}} />\n                <CommandEmpty>{placeholder}   .</CommandEmpty>\n                <CommandGroup className=\"max-h-[200px] overflow-y-auto\">\n                  {options.map(option => (\n                    <CommandItem\n                      key={option}\n                      value={option}\n                      onSelect={(value) => {\n                        setNewFilter(prev => ({ ...prev, value: value }));\n                      }}\n                      className=\"cursor-pointer\"\n                    >\n                      <Check\n                        className={`mr-2 h-3 w-3 ${\n                          newFilter.value === option ? \"opacity-100\" : \"opacity-0\"\n                        }`}\n                      />\n                      <span className=\"card-description\">{option}</span>\n                    </CommandItem>\n                  ))}\n                </CommandGroup>\n              </Command>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'select':\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {fieldConfig.options?.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'select_with_empty':\n        const scheduleOptions = ['', ...availablePaymentSchedules]\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {scheduleOptions.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'date_range':\n        return (\n          <Popover open={datePickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempDateRange({\n                    from: new Date(start),\n                    to: new Date(end)\n                  });\n                } else {\n                  setTempDateRange({\n                    from: new Date(newFilter.value),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempDateRange({});\n              }\n            }\n            setDatePickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5 min-h-[32px]\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        return `${format(new Date(start), 'yy/MM/dd')}\\n~ ${format(new Date(end), 'yy/MM/dd')}`;\n                      } else {\n                        return format(new Date(newFilter.value), 'yy/MM/dd');\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-2\">  </div>\n                  <CalendarComponent\n                    mode=\"range\"\n                    selected={tempDateRange}\n                    onSelect={(range) => {\n                      if (range) {\n                        setTempDateRange(range);\n                      }\n                    }}\n                    numberOfMonths={1}\n                    initialFocus\n                    className=\"compact-calendar\"\n                  />\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempDateRange({});\n                      setDatePickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempDateRange.from) {\n                        if (tempDateRange.to) {\n                          // ~ \n                          const rangeValue = `${format(tempDateRange.from, 'yyyy-MM-dd')}~${format(tempDateRange.to, 'yyyy-MM-dd')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  ( )\n                          setNewFilter(prev => ({ ...prev, value: format(tempDateRange.from, 'yyyy-MM-dd') }));\n                        }\n                        setDatePickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempDateRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'date_month':\n        return (\n          <Popover open={monthPickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempMonthRange({\n                    from: new Date(`${start}-01`),\n                    to: new Date(`${end}-01`)\n                  });\n                } else {\n                  setTempMonthRange({\n                    from: new Date(`${newFilter.value}-01`),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempMonthRange({});\n              }\n            }\n            setMonthPickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        const [startYear, startMonth] = start.split('-');\n                        const [endYear, endMonth] = end.split('-');\n                        return `${startYear.slice(-2)}/${startMonth}\\n~ ${endYear.slice(-2)}/${endMonth}`;\n                      } else {\n                        const [year, month] = newFilter.value.split('-');\n                        return `${year.slice(-2)}/${month}`;\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-3\"> </div>\n                  \n                  {/*   -  12  */}\n                  <div className=\"flex gap-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"text-xs text-gray-500 mb-2\">  </div>\n                      {/*   */}\n                      <div className=\"mb-3\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear - 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                          <span className=\"text-sm font-medium text-gray-700\">\n                            {tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear()}\n                          </span>\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear + 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                        </div>\n                      </div>\n                      \n                      {/* 12  */}\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        {Array.from({ length: 12 }, (_, i) => {\n                          const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                          const monthDate = new Date(currentYear, i, 1);\n                          const isSelected = tempMonthRange.from && \n                            tempMonthRange.from.getFullYear() === currentYear && \n                            tempMonthRange.from.getMonth() === i;\n                          \n                          return (\n                            <Button\n                              key={i}\n                              onClick={() => {\n                                setTempMonthRange(prev => ({ ...prev, from: monthDate }));\n                              }}\n                              variant=\"outline\"\n                              className={`button-base text-xs h-8 ${\n                                isSelected \n                                  ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                  : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                              }`}\n                            >\n                              {i + 1}\n                            </Button>\n                          );\n                        })}\n                      </div>\n                    </div>\n                    \n                    {tempMonthRange.from && (\n                      <div className=\"flex-1\">\n                        <div className=\"text-xs text-gray-500 mb-2\">   ()</div>\n                        {/*     */}\n                        <div className=\"mb-3\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear - 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                            <span className=\"text-sm font-medium text-gray-700\">\n                              {tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear()}\n                            </span>\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear + 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                          </div>\n                        </div>\n                        \n                        {/*   12  */}\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {Array.from({ length: 12 }, (_, i) => {\n                            const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                            const monthDate = new Date(currentYear, i, 1);\n                            const isSelected = tempMonthRange.to && \n                              tempMonthRange.to.getFullYear() === currentYear && \n                              tempMonthRange.to.getMonth() === i;\n                            const isDisabled = monthDate < tempMonthRange.from;\n                            \n                            return (\n                              <Button\n                                key={i}\n                                onClick={() => {\n                                  if (!isDisabled) {\n                                    setTempMonthRange(prev => ({ ...prev, to: monthDate }));\n                                  }\n                                }}\n                                variant=\"outline\"\n                                disabled={isDisabled}\n                                className={`button-base text-xs h-8 ${\n                                  isSelected \n                                    ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                    : isDisabled\n                                    ? 'border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed'\n                                    : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                                }`}\n                              >\n                                {i + 1}\n                              </Button>\n                            );\n                          })}\n                        </div>\n                        \n                        <div className=\"mt-3\">\n                          <Button\n                            onClick={() => {\n                              setTempMonthRange(prev => ({ ...prev, to: undefined }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50 text-xs\"\n                          >\n                              \n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempMonthRange({});\n                      setMonthPickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempMonthRange.from) {\n                        if (tempMonthRange.to) {\n                          //  \n                          const rangeValue = `${format(tempMonthRange.from, 'yyyy-MM')}~${format(tempMonthRange.to, 'yyyy-MM')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  \n                          setNewFilter(prev => ({ ...prev, value: format(tempMonthRange.from, 'yyyy-MM') }));\n                        }\n                        setMonthPickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempMonthRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"w-full space-y-3\">\n      {/*   */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          {/*   */}\n          <Popover open={isFilterOpen} onOpenChange={setIsFilterOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Sliders className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {activeFilters.length > 0 && (\n                  <Badge variant=\"secondary\" className=\"ml-1 badge-stats-primary\">\n                    {activeFilters.length}\n                  </Badge>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-64 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"card-title\"></h4>\n                  {activeFilters.length > 0 && (\n                    <Button\n                      variant=\"ghost\"\n                      onClick={handleClearAllFilters}\n                      className=\"button-base text-red-600 hover:text-red-700 hover:bg-red-50\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  )}\n                </div>\n\n                {/*    */}\n                {activeFilters.length > 0 && (\n                  <div className=\"space-y-2\">\n                    {activeFilters.map(filter => (\n                      <div key={filter.id} className=\"flex items-center justify-between p-2 bg-gray-50 business-radius\">\n                        <span className=\"card-description\">\n                          {filter.label}\n                          {filter.dateField && (\n                            <span className=\"text-blue-600\">\n                              ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                            </span>\n                          )}\n                          : {filter.value}\n                        </span>\n                        <Button\n                          variant=\"ghost\"\n                          onClick={() => handleRemoveFilter(filter.id)}\n                          className=\"button-base h-6 w-6 p-0 hover:bg-red-50\"\n                        >\n                          <X className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                    <div className=\"border-t border-gray-200 my-2\" />\n                  </div>\n                )}\n\n                {/*    */}\n                <div className=\"space-y-2\">\n                  <Select onValueChange={handleAddFilter}>\n                    <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n                      <SelectValue placeholder=\"+  \" />\n                    </SelectTrigger>\n                    <SelectContent \n                      className=\"w-64 max-h-80 overflow-y-auto\"\n                      style={{\n                        scrollbarWidth: 'auto',\n                        scrollbarColor: '#9ca3af #f3f4f6',\n                        WebkitScrollbarWidth: '8px'\n                      }}\n                    >\n                      {Object.entries(\n                        FILTER_FIELDS.reduce((acc, field) => {\n                          if (!acc[field.category]) acc[field.category] = []\n                          acc[field.category].push(field)\n                          return acc\n                        }, {} as Record<string, typeof FILTER_FIELDS>)\n                      ).map(([category, fields]) => (\n                        <div key={category}>\n                          <div className=\"px-2 py-1 card-description uppercase\">\n                            {category}\n                          </div>\n                          {fields.map(field => (\n                            <SelectItem key={field.key} value={field.key}>\n                              <div className=\"flex items-center gap-2\">\n                                <field.icon className=\"w-4 h-4\" />\n                                <span className=\"card-description\">{field.label}</span>\n                              </div>\n                            </SelectItem>\n                          ))}\n                        </div>\n                      ))}\n                    </SelectContent>\n                  </Select>\n\n                  {/*   UI */}\n                  {newFilter.field && (\n                    <div className=\"space-y-2 p-3 border business-radius bg-white\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"card-title\">{newFilter.label} </span>\n                      </div>\n                      \n                      {/*    */}\n                      {(newFilter.field === 'date_range' || newFilter.field === 'date_month') ? (\n                        <div className=\"grid grid-cols-2 gap-2\">\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            <Select \n                              value={newFilter.dateField || ''} \n                              onValueChange={(value) => setNewFilter(prev => ({ ...prev, dateField: value }))}\n                            >\n                              <SelectTrigger className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center justify-center\">\n                                <SelectValue placeholder=\" \" className=\"text-center\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                {DATE_FIELDS.map(dateField => (\n                                  <SelectItem key={dateField.value} value={dateField.value}>\n                                    <span className=\"card-description\">{dateField.label}</span>\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                          </div>\n\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            {renderValueInput()}\n                          </div>\n                        </div>\n                      ) : (\n                        /*    -       */\n                        <div>\n                          {renderValueInput()}\n                        </div>\n                      )}\n\n                      <div className=\"flex gap-2\">\n                        <Button\n                          onClick={handleApplyFilter}\n                          disabled={\n                            !newFilter.field || \n                            newFilter.value === '' ||\n                            ((newFilter.field === 'date_range' || newFilter.field === 'date_month') && !newFilter.dateField)\n                          }\n                          className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                        >\n                          \n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => setNewFilter({})}\n                          className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                        >\n                          \n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <Popover open={isSortOpen} onOpenChange={setIsSortOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <ArrowUpDown className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {sortConfig && (\n                  <span className=\"ml-1 card-description\">\n                    ({sortConfig.direction === 'asc' ? '' : ''})\n                  </span>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-56 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <h4 className=\"card-title\"> </h4>\n                \n                <div className=\"space-y-2\">\n                  {/*    */}\n                  <div>\n                    <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                    <Select \n                      value={tempSort.field || ''} \n                      onValueChange={handleSortFieldChange}\n                    >\n                      <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                        <SelectValue placeholder=\"\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {SORT_FIELDS.map(field => (\n                          <SelectItem key={field.value} value={field.value}>\n                            <span className=\"card-description\">{field.label}</span>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  {/*    */}\n                  {tempSort.field && (\n                    <div>\n                      <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                      <Select \n                        value={tempSort.direction || ''} \n                        onValueChange={handleSortDirectionChange}\n                      >\n                        <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                          <SelectValue placeholder=\"\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"asc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                          <SelectItem value=\"desc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n\n                  {/* /  */}\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button \n                      onClick={handleApplySort}\n                      disabled={!tempSort.field || !tempSort.direction}\n                      className=\"button-base bg-blue-500 hover:bg-blue-600 text-white flex-1\"\n                    >\n                      \n                    </Button>\n                    <Button \n                      onClick={handleClearSort}\n                      className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n                    >\n                      \n                    </Button>\n                  </div>\n                </div>\n\n                {sortConfig && (\n                  <div className=\"border-t pt-2\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => onSortChange(null)}\n                      className=\"button-base w-full border border-gray-300 text-gray-700\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <div className=\"flex items-center gap-2\">\n            {!isSearchExpanded ? (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsSearchExpanded(true)}\n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Search className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n              </Button>\n            ) : (\n              <div className=\"flex items-center gap-2\">\n                <Input\n                  ref={searchInputRef}\n                  placeholder=\" ...\"\n                  value={searchTerm}\n                  onChange={(e) => onSearchChange(e.target.value)}\n                  className=\"w-64 business-radius-input button-base border border-gray-300 bg-white text-gray-700\"\n                />\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => {\n                    setIsSearchExpanded(false)\n                    onSearchChange('')\n                  }}\n                  className=\"button-base h-8 w-8 p-0\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/*    */}\n          <Button\n            variant=\"outline\"\n            onClick={() => {\n              onSearchChange('')\n              onFiltersChange([])\n              onSortChange({\n                field: 'created_at',\n                direction: 'desc',\n                label: ''\n              })\n              setIsSearchExpanded(false)\n            }}\n            className=\"button-base border border-gray-300 bg-white text-blue-600 hover:bg-blue-50 hover:border-blue-300\"\n          >\n             <span className=\"button-text text-blue-600\"></span>\n          </Button>\n        </div>\n      </div>\n\n      {/*    */}\n      {activeFilters.length > 0 && (\n        <div className=\"flex flex-wrap gap-2\">\n          {activeFilters.map(filter => (\n            <Badge\n              key={filter.id}\n              variant=\"secondary\"\n              className=\"badge-base flex items-center gap-1 bg-blue-50 text-blue-700 border-blue-200\"\n            >\n              {filter.label}\n              {filter.dateField && (\n                <span className=\"text-blue-600\">\n                  ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                </span>\n              )}\n              : {filter.value}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handleRemoveFilter(filter.id)}\n                className=\"h-4 w-4 p-0 hover:bg-blue-100 ml-1\"\n              >\n                <X className=\"w-3 h-3\" />\n              </Button>\n            </Badge>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}","\nimport { useState, lazy, Suspense, useEffect, useCallback, useMemo } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { usePurchaseData } from \"@/hooks/usePurchaseData\";\nimport FastPurchaseTable from \"@/components/purchase/FastPurchaseTable\";\nimport FilterToolbar, { FilterRule, SortRule } from \"@/components/purchase/FilterToolbar\";\n\nimport { Plus, Package, Info } from \"lucide-react\";\nimport { generatePurchaseOrderExcelJS, PurchaseOrderData } from \"@/utils/exceljs/generatePurchaseOrderExcel\";\n\n// Lazy load modal for better performance\nconst PurchaseItemsModal = lazy(() => import(\"@/components/purchase/PurchaseItemsModal\"));\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n// Tabs     (hanslwebapp )\nimport { Button } from \"@/components/ui/button\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { Purchase } from \"@/hooks/usePurchaseData\";\nimport { logger } from \"@/lib/logger\";\n\ninterface PurchaseListMainProps {\n  //      \n  onEmailToggle?: () => void;\n  showEmailButton?: boolean;\n}\n\n//   () \nconst NAV_TABS: { key: string; label: string }[] = [\n  { key: 'pending', label: '' },\n  { key: 'purchase', label: ' ' },\n  { key: 'receipt', label: ' ' },\n  { key: 'done', label: ' ' },\n];\n\n//    \nexport default function PurchaseListMain({ showEmailButton = true }: PurchaseListMainProps) {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const supabase = createClient();\n  const [selectedPurchase, setSelectedPurchase] = useState<Purchase | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  \n  //    \n  const [activeFilters, setActiveFilters] = useState<FilterRule[]>([]);\n  const [sortConfig, setSortConfig] = useState<SortRule | null>({\n    field: 'created_at',\n    direction: 'desc',\n    label: ''\n  });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [availableEmployees, setAvailableEmployees] = useState<string[]>([]);\n  const [availableVendors, setAvailableVendors] = useState<string[]>([]);\n  const [availableContacts, setAvailableContacts] = useState<string[]>([]);\n  const [availablePaymentSchedules, setAvailablePaymentSchedules] = useState<string[]>([]);\n  \n  //     \n  const {\n    purchases,\n    loading,\n    currentUserRoles,\n    currentUserName,\n    refreshPurchases: loadPurchases,\n    updatePurchaseOptimistic\n  } = usePurchaseData();\n  \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  \n  //    (hanslwebapp  -  )\n  const [activeTab, setActiveTab] = useState('pending');\n  const [selectedEmployee, setSelectedEmployee] = useState<string>('');\n\n  //    (  )\n  const visiblePurchases = useMemo(() => {\n    const HIDDEN_EMPLOYEES = [''];\n    const hasManagerRole = currentUserRoles?.includes('purchase_manager') || currentUserRoles?.includes('app_admin');\n    return hasManagerRole \n      ? purchases \n      : purchases.filter(p => !HIDDEN_EMPLOYEES.includes(p.requester_name));\n  }, [purchases, currentUserRoles]);\n\n  // roleCase  (   )\n  const roleCase = useMemo(() => {\n    if (!currentUserRoles || currentUserRoles.length === 0) return 1;\n    if (currentUserRoles.includes('purchase_manager')) return 2;\n    if (currentUserRoles.some(r => ['final_approver', 'app_admin', 'ceo', 'middle_manager', 'hr'].includes(r))) return 3;\n    return 1;\n  }, [currentUserRoles]);\n\n  //     \n  const computeDefaultEmployee = useCallback((tabKey: string): string => {\n    if (!currentUserName) return 'all';\n    switch (roleCase) {\n      case 1:\n        if (tabKey === 'done') return 'all';\n        return currentUserName;\n      case 2:\n        if (tabKey === 'done') return 'all';\n        return currentUserName;\n      case 3:\n        return 'all';\n      default:\n        return currentUserName;\n    }\n  }, [currentUserName, roleCase]);\n\n  //       \n  useEffect(() => {\n    if (!currentUserName) return;\n    const defaultEmployee = computeDefaultEmployee(activeTab);\n    setSelectedEmployee(defaultEmployee);\n  }, [activeTab, currentUserName, computeDefaultEmployee]);\n\n  // URL    \n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const tab = searchParams.get('tab');\n    if (tab && ['pending', 'purchase', 'receipt', 'done'].includes(tab)) {\n      setActiveTab(tab);\n    }\n  }, [location.search]);\n\n  //    \n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        //   (employees )\n        const { data: employees } = await supabase\n          .from('employees')\n          .select('name');\n        \n        if (employees) {\n          const employeeNames = [...new Set(employees.map((e: any) => e.name).filter(Boolean))];\n          setAvailableEmployees(employeeNames as string[]);\n        }\n\n        //   (vendors )\n        const { data: vendors } = await supabase\n          .from('vendors')\n          .select('vendor_name');\n        \n        if (vendors) {\n          const vendorNames = [...new Set(vendors.map((v: any) => v.vendor_name).filter(Boolean))];\n          setAvailableVendors(vendorNames as string[]);\n        }\n\n        //   (vendor_contacts )\n        const { data: contacts } = await supabase\n          .from('vendor_contacts')\n          .select('contact_name');\n        \n        if (contacts) {\n          const contactNames = [...new Set(contacts.map((c: any) => c.contact_name).filter(Boolean))];\n          setAvailableContacts(contactNames as string[]);\n        }\n\n        //   (vendors  vendor_payment_schedule)\n        const { data: schedules } = await supabase\n          .from('vendors')\n          .select('vendor_payment_schedule');\n        \n        if (schedules) {\n          const scheduleNames = [...new Set(schedules.map((s: any) => s.vendor_payment_schedule).filter(Boolean))];\n          setAvailablePaymentSchedules(scheduleNames as string[]);\n        }\n      } catch (error) {\n        logger.error('    ', error);\n      }\n    };\n\n    loadFilterOptions();\n  }, [supabase]);\n\n\n  //     -  \n  const getStatusBadge = useCallback((purchase: Purchase) => {\n    if (purchase.is_received) {\n      return <Badge variant={null} className=\"badge-success\"></Badge>;\n    } else if (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved') {\n      return <Badge variant={null} className=\"badge-primary\"></Badge>;\n    } else if (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected') {\n      return <Badge variant={null} className=\"badge-danger\"></Badge>;\n    } else {\n      return <Badge variant={null} className=\"badge-warning\"></Badge>;\n    }\n  }, []);\n\n  //   \n  const getReceiptProgress = (purchase: Purchase) => {\n    if (!purchase.items || purchase.items.length === 0) return { received: 0, total: 0, percentage: 0 };\n    \n    const total = purchase.items.length;\n    const received = purchase.items.filter(item => \n      item.actual_received_date !== null && item.actual_received_date !== undefined\n    ).length;\n    const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n    \n    return { received, total, percentage };\n  };\n\n  //   \n  const isAdvancePayment = (progress_type?: string) => {\n    return progress_type === '' || progress_type?.trim() === '' || progress_type?.includes('');\n  };\n\n  //     - useCallback \n  const getFieldValue = useCallback((purchase: Purchase, field: string): any => {\n    switch (field) {\n      case 'purchase_order_number':\n        return purchase.purchase_order_number;\n      case 'payment_category':\n        return purchase.payment_category;\n      case 'requester_name':\n        return purchase.requester_name;\n      case 'vendor_name':\n        return purchase.vendor_name;\n      case 'contact_name':\n        return purchase.contact_name;\n      case 'item_name':\n        return purchase.item_name;\n      case 'specification':\n        return purchase.specification;\n      case 'quantity':\n        return purchase.quantity;\n      case 'unit_price_value':\n        return purchase.unit_price_value;\n      case 'total_amount':\n        return purchase.total_amount;\n      case 'remark':\n        return purchase.remark;\n      case 'project_vendor':\n        return purchase.project_vendor;\n      case 'project_item':\n        return purchase.project_item;\n      case 'sales_order_number':\n        return purchase.sales_order_number;\n      case 'payment_schedule':\n        return (purchase as any).vendor_payment_schedule;\n      case 'is_payment_completed':\n        return purchase.is_payment_completed ? '' : '';\n      case 'is_received':\n        return purchase.is_received ? '' : '';\n      case 'is_statement_received':\n        return (purchase as any).is_statement_received ? '' : '';\n      case 'is_utk_checked':\n        return (purchase as any).is_utk_checked ? '' : '';\n      case 'request_date':\n        return purchase.request_date;\n      case 'delivery_request_date':\n        return purchase.delivery_request_date;\n      case 'payment_completed_at':\n        return purchase.payment_completed_at;\n      case 'received_at':\n        return purchase.received_at;\n      case 'created_at':\n        return (purchase as any).created_at;\n      case 'statement_received_at':\n        return (purchase as any).statement_received_at;\n      default:\n        return null;\n    }\n  }, []);\n\n  //     - useCallback \n  const applyFilterCondition = useCallback((fieldValue: any, condition: string, filterValue: any, filterField?: string): boolean => {\n    if (fieldValue === null || fieldValue === undefined) {\n      return condition === 'is_empty';\n    }\n\n    //      (~)\n    if (filterField === 'date_range' && filterValue && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startDate, endDate] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(startDate);\n      const end = new Date(endDate);\n      \n      //       \n      return fieldDate >= start && fieldDate <= end;\n    }\n\n    //      (~)\n    if (filterField === 'date_month' && filterValue && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startMonth, endMonth] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(`${startMonth}-01`);\n      const end = new Date(`${endMonth}-01`);\n      \n      //    (    )\n      const endOfMonth = new Date(end.getFullYear(), end.getMonth() + 1, 0, 23, 59, 59);\n      return fieldDate >= start && fieldDate <= endOfMonth;\n    }\n\n    //     ( )\n    if (filterField && (filterField === 'date_month' || filterField.endsWith('_month'))) {\n      if (!filterValue) return true;\n      \n      const fieldDate = new Date(fieldValue);\n      const [filterYear, filterMonth] = filterValue.split('-');\n      \n      return fieldDate.getFullYear() === parseInt(filterYear) && \n             (fieldDate.getMonth() + 1) === parseInt(filterMonth);\n    }\n\n    const fieldStr = String(fieldValue).toLowerCase();\n    const filterStr = String(filterValue).toLowerCase();\n\n    switch (condition) {\n      case 'contains':\n        return fieldStr.includes(filterStr);\n      case 'equals':\n        //      \n        if (filterField === 'date_range' || filterValue.match(/^\\d{4}-\\d{2}-\\d{2}/)) {\n          if (!fieldValue) return false;\n          try {\n            const fieldDate = new Date(fieldValue).toISOString().split('T')[0];\n            const filterDate = filterValue.split('T')[0];\n            return fieldDate === filterDate;\n          } catch (error) {\n            logger.error('  :', error);\n            return false;\n          }\n        }\n        return fieldStr === filterStr;\n      case 'starts_with':\n        return fieldStr.startsWith(filterStr);\n      case 'ends_with':\n        return fieldStr.endsWith(filterStr);\n      case 'is_empty':\n        return !fieldValue || fieldStr.trim() === '';\n      case 'is_not_empty':\n        return !!fieldValue && fieldStr.trim() !== '';\n      case 'greater_than':\n        return Number(fieldValue) > Number(filterValue);\n      case 'less_than':\n        return Number(fieldValue) < Number(filterValue);\n      case 'between':\n        //    \n        return true;\n      case 'after':\n        return new Date(fieldValue) > new Date(filterValue);\n      case 'before':\n        return new Date(fieldValue) < new Date(filterValue);\n      case 'not_equals':\n        return fieldStr !== filterStr;\n      default:\n        return true;\n    }\n  }, []);\n\n  //  useMemo    (hanslwebapp ) -  \n  const tabFilteredPurchases = useMemo(() => {\n    // 1.      \n    const matchesSearchAndEmployee = (item: Purchase) => {\n      //   \n      if (selectedEmployee && selectedEmployee !== 'all' && selectedEmployee !== '' && item.requester_name !== selectedEmployee) {\n        return false;\n      }\n      \n      //   \n      if (searchTerm && searchTerm.trim() !== '') {\n        const term = searchTerm.trim().toLowerCase();\n        const searchable = [\n          item.purchase_order_number,\n          item.vendor_name,\n          item.item_name,\n          item.specification,\n          item.requester_name,\n          item.remark,\n          item.project_vendor,\n          item.project_item,\n          item.sales_order_number,\n          item.unit_price_value?.toString(),\n          item.amount_value?.toString(),\n        ].map(v => (v || '').toLowerCase()).join(' ');\n        \n        if (!searchable.includes(term)) return false;\n      }\n      \n      return true;\n    };\n\n    // 2.  \n    let filtered = visiblePurchases.filter(item => {\n      if (!matchesSearchAndEmployee(item)) return false;\n\n      switch (activeTab) {\n        case 'pending': {\n          // consumable_manager  \n          if (currentUserRoles && currentUserRoles.includes('consumable_manager')) {\n            if (item.payment_category !== ' ') return false;\n          }\n          \n          //      (  )\n          const isMiddlePending = ['pending', '', '', null, undefined].includes(item.middle_manager_status as any);\n          \n          //      (  ,   )\n          const isFinalPending = (item.middle_manager_status === '' || item.middle_manager_status === 'approved') &&\n                                item.final_manager_status !== 'approved' && item.final_manager_status !== '';\n          \n          //  ,   \n          const isApprovedToday = (item.final_manager_status === 'approved' || item.final_manager_status === '') && \n                                item.final_manager_approved_at && (() => {\n            const approvedDate = new Date(item.final_manager_approved_at);\n            const today = new Date();\n            //     \n            return approvedDate.getFullYear() === today.getFullYear() &&\n                   approvedDate.getMonth() === today.getMonth() &&\n                   approvedDate.getDate() === today.getDate();\n          })();\n          \n          //  \n          if (item.middle_manager_status === 'rejected' || item.final_manager_status === 'rejected') return false;\n          \n          return isMiddlePending || isFinalPending || isApprovedToday;\n        }\n        case 'purchase': {\n          const isRequest = item.payment_category === ' ';\n          const notPaid = !item.is_payment_completed;\n          if (!isRequest || !notPaid) return false;\n\n          const isSeonJin = (item.progress_type || '').includes('');\n          const isIlban = (item.progress_type || '').includes('');\n          const finalApproved = item.final_manager_status === 'approved';\n\n          return (isSeonJin) || (isIlban && finalApproved);\n        }\n        case 'receipt': {\n          if (item.is_received) return false;\n          const isSeonJin = (item.progress_type || '').includes('');\n          const finalApproved = item.final_manager_status === 'approved';\n          return isSeonJin || finalApproved;\n        }\n        case 'done':\n          return true;\n        default:\n          return true;\n      }\n    });\n\n    // 3.  60  (  )\n    const hasAnyFilter = activeFilters.length > 0 || searchTerm.trim() !== '';\n    if (!hasAnyFilter) {\n      const sixtyDaysAgo = new Date();\n      sixtyDaysAgo.setDate(sixtyDaysAgo.getDate() - 60);\n      filtered = filtered.filter(purchase => {\n        if (!purchase.request_date) return false;\n        const requestDate = new Date(purchase.request_date);\n        return requestDate >= sixtyDaysAgo;\n      });\n    }\n\n    // 4.   \n    if (activeFilters.length > 0) {\n      filtered = filtered.filter(purchase => {\n        return activeFilters.every(filter => {\n          const actualField = (filter.field === 'date_range' || filter.field === 'date_month') \n            ? filter.dateField || filter.field \n            : filter.field;\n          \n          const fieldValue = getFieldValue(purchase, actualField);\n          const filterFieldType = filter.field === 'date_month' ? 'date_month' : \n                                 filter.field === 'date_range' ? 'date_range' : undefined;\n          \n          return applyFilterCondition(fieldValue, filter.condition, filter.value, filterFieldType);\n        });\n      });\n    }\n\n    // 5.  \n    if (sortConfig) {\n      filtered = [...filtered].sort((a, b) => {\n        const aValue = getFieldValue(a, sortConfig.field);\n        const bValue = getFieldValue(b, sortConfig.field);\n\n        if (aValue === null || aValue === undefined) return 1;\n        if (bValue === null || bValue === undefined) return -1;\n\n        let comparison = 0;\n        if (typeof aValue === 'number' && typeof bValue === 'number') {\n          comparison = aValue - bValue;\n        } else if (aValue instanceof Date && bValue instanceof Date) {\n          comparison = aValue.getTime() - bValue.getTime();\n        } else {\n          comparison = String(aValue).localeCompare(String(bValue));\n        }\n\n        return sortConfig.direction === 'desc' ? -comparison : comparison;\n      });\n    } else {\n      //  :    ,  \n      if (activeTab === 'pending') {\n        filtered = [...filtered].sort((a, b) => {\n          // 1.   \n          const getPriority = (item: Purchase) => {\n            //   (/  ) - \n            if (item.middle_manager_status !== '' && item.middle_manager_status !== 'approved') {\n              return 1;\n            }\n            // 1  ( ,  ) - \n            if (item.middle_manager_status === '' || item.middle_manager_status === 'approved') {\n              if (item.final_manager_status !== 'approved' && item.final_manager_status !== '') {\n                return 2;\n              }\n            }\n            //   (  ) - \n            if (item.final_manager_status === 'approved' || item.final_manager_status === '') {\n              return 3;\n            }\n            return 4; // \n          };\n          \n          const priorityA = getPriority(a);\n          const priorityB = getPriority(b);\n          \n          //    \n          if (priorityA !== priorityB) {\n            return priorityA - priorityB;\n          }\n          \n          //      ( )\n          const dateA = a.request_date ? new Date(a.request_date).getTime() : 0;\n          const dateB = b.request_date ? new Date(b.request_date).getTime() : 0;\n          return dateB - dateA;\n        });\n      } else {\n        //  : \n        filtered = [...filtered].sort((a, b) => {\n          const dateA = a.request_date ? new Date(a.request_date).getTime() : 0;\n          const dateB = b.request_date ? new Date(b.request_date).getTime() : 0;\n          return dateB - dateA;\n        });\n      }\n    }\n\n    return filtered;\n  }, [visiblePurchases, activeTab, selectedEmployee, searchTerm, activeFilters, sortConfig, currentUserRoles, getFieldValue, applyFilterCondition]);\n\n  //    ( useMemo )\n  const tabCounts = useMemo(() => {\n    const getUniqueOrderCount = (filtered: Purchase[]) => {\n      return new Set(filtered.map(p => p.purchase_order_number)).size;\n    };\n\n    //    (   )\n    const pendingFiltered = visiblePurchases.filter((p: Purchase) => {\n      const isMiddlePending = ['pending', '', '', null, undefined].includes(p.middle_manager_status as any);\n      const isFinalPendingStrict = (p.middle_manager_status === '' || p.middle_manager_status === 'approved') &&\n                                   p.final_manager_status !== 'approved' && p.final_manager_status !== '';\n      const isApprovedToday = (p.final_manager_status === 'approved' || p.final_manager_status === '') && \n                            p.final_manager_approved_at && (() => {\n        const approvedDate = new Date(p.final_manager_approved_at);\n        const today = new Date();\n        return approvedDate.getFullYear() === today.getFullYear() &&\n               approvedDate.getMonth() === today.getMonth() &&\n               approvedDate.getDate() === today.getDate();\n      })();\n      if (p.middle_manager_status === 'rejected' || p.final_manager_status === 'rejected') return false;\n      return isMiddlePending || isFinalPendingStrict || isApprovedToday;\n    });\n\n    const purchaseFiltered = visiblePurchases.filter((p: Purchase) => {\n      const isRequest = p.payment_category === ' ';\n      const notPaid = !p.is_payment_completed;\n      if (!isRequest || !notPaid) return false;\n      const isSeonJin = (p.progress_type || '').includes('');\n      const isIlban = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      return (isSeonJin) || (isIlban && finalApproved);\n    });\n\n    const receiptFiltered = visiblePurchases.filter((p: Purchase) => {\n      if (p.is_received) return false;\n      const isSeonJin = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      return isSeonJin || finalApproved;\n    });\n\n    return {\n      pending: getUniqueOrderCount(pendingFiltered),\n      purchase: getUniqueOrderCount(purchaseFiltered),\n      receipt: getUniqueOrderCount(receiptFiltered),\n      done: getUniqueOrderCount(visiblePurchases)\n    };\n  }, [visiblePurchases]);\n\n  //        \n  const filteredTabCounts = useMemo(() => {\n    //   \n    const hasAnyFilter = activeFilters.length > 0 || searchTerm.trim() !== '';\n    let baseData = visiblePurchases;\n    \n    if (!hasAnyFilter) {\n      // 60  \n      const sixtyDaysAgo = new Date();\n      sixtyDaysAgo.setDate(sixtyDaysAgo.getDate() - 60);\n      baseData = baseData.filter(purchase => {\n        if (!purchase.request_date) return false;\n        const requestDate = new Date(purchase.request_date);\n        return requestDate >= sixtyDaysAgo;\n      });\n    } else if (activeFilters.length > 0) {\n      //   \n      baseData = baseData.filter(purchase => {\n        return activeFilters.every(filter => {\n          const actualField = (filter.field === 'date_range' || filter.field === 'date_month') \n            ? filter.dateField || filter.field \n            : filter.field;\n          const fieldValue = getFieldValue(purchase, actualField);\n          const filterFieldType = filter.field === 'date_month' ? 'date_month' : \n                                 filter.field === 'date_range' ? 'date_range' : undefined;\n          return applyFilterCondition(fieldValue, filter.condition, filter.value, filterFieldType);\n        });\n      });\n    }\n\n    //   \n    if (searchTerm.trim()) {\n      const searchLower = searchTerm.toLowerCase().trim();\n      baseData = baseData.filter(purchase => {\n        const searchable = [\n          purchase.purchase_order_number,\n          purchase.vendor_name,\n          purchase.item_name,\n          purchase.specification,\n          purchase.requester_name,\n          purchase.remark,\n          purchase.project_vendor,\n          purchase.project_item,\n          purchase.sales_order_number,\n        ].map(v => (v || '').toLowerCase()).join(' ');\n        return searchable.includes(searchLower);\n      });\n    }\n    \n    const getUniqueOrderCount = (filtered: Purchase[]) => {\n      return new Set(filtered.map(p => p.purchase_order_number)).size;\n    };\n\n    const pendingFiltered = baseData.filter((p: Purchase) => {\n      const isMiddlePending = ['pending', '', '', null, undefined].includes(p.middle_manager_status as any);\n      const isFinalPendingStrict = (p.middle_manager_status === '' || p.middle_manager_status === 'approved') &&\n                                   p.final_manager_status !== 'approved' && p.final_manager_status !== '';\n      const isApprovedToday = (p.final_manager_status === 'approved' || p.final_manager_status === '') && \n                            p.final_manager_approved_at && (() => {\n        const approvedDate = new Date(p.final_manager_approved_at);\n        const today = new Date();\n        return approvedDate.getFullYear() === today.getFullYear() &&\n               approvedDate.getMonth() === today.getMonth() &&\n               approvedDate.getDate() === today.getDate();\n      })();\n      if (p.middle_manager_status === 'rejected' || p.final_manager_status === 'rejected') return false;\n      return isMiddlePending || isFinalPendingStrict || isApprovedToday;\n    });\n\n    const purchaseFiltered = baseData.filter((p: Purchase) => {\n      const isRequest = p.payment_category === ' ';\n      const notPaid = !p.is_payment_completed;\n      if (!isRequest || !notPaid) return false;\n      const isSeonJin = (p.progress_type || '').includes('');\n      const isIlban = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      return (isSeonJin) || (isIlban && finalApproved);\n    });\n\n    const receiptFiltered = baseData.filter((p: Purchase) => {\n      if (p.is_received) return false;\n      const isSeonJin = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      return isSeonJin || finalApproved;\n    });\n\n    return {\n      pending: getUniqueOrderCount(pendingFiltered),\n      purchase: getUniqueOrderCount(purchaseFiltered),\n      receipt: getUniqueOrderCount(receiptFiltered),\n      done: getUniqueOrderCount(baseData)\n    };\n  }, [visiblePurchases, activeFilters, searchTerm, getFieldValue, applyFilterCondition]);\n\n  //      \n  const monthlyFilterSummary = useMemo(() => {\n    //     \n    const monthFilters = activeFilters.filter(filter => \n      filter.field === 'date_month' || \n      (filter.field === 'date_range' && filter.dateField && filter.dateField.includes('_month'))\n    );\n    \n    if (monthFilters.length === 0) return null;\n    \n    const monthFilter = monthFilters[0];\n    const filterValue = monthFilter.value;\n    \n    //       \n    if (filterValue && filterValue.includes('~')) {\n      //   (: \"2024-04~2024-09\")\n      const [startMonth, endMonth] = filterValue.split('~');\n      const startDate = new Date(`${startMonth}-01`);\n      const endDate = new Date(`${endMonth}-01`);\n      \n      const monthlyTotals = [];\n      let totalSum = 0;\n      \n      //   \n      const currentDate = new Date(startDate);\n      while (currentDate <= endDate) {\n        const year = currentDate.getFullYear();\n        const month = currentDate.getMonth() + 1;\n        const monthStr = `${year}-${month.toString().padStart(2, '0')}`;\n        \n        //    \n        const monthData = tabFilteredPurchases.filter(purchase => {\n          const purchaseDate = new Date(purchase.request_date);\n          return purchaseDate.getFullYear() === year && \n                 (purchaseDate.getMonth() + 1) === month;\n        });\n        \n        //    \n        const monthTotal = monthData.reduce((sum, purchase) => {\n          const amount = purchase.amount_value || purchase.total_amount || 0;\n          return sum + amount;\n        }, 0);\n        \n        monthlyTotals.push({\n          year,\n          month,\n          monthStr,\n          total: monthTotal,\n          count: monthData.length\n        });\n        \n        totalSum += monthTotal;\n        \n        //   \n        currentDate.setMonth(currentDate.getMonth() + 1);\n      }\n      \n      return {\n        type: 'range',\n        months: monthlyTotals,\n        grandTotal: totalSum\n      };\n    } else {\n      //    (: \"2024-10\")\n      const [year, month] = filterValue.split('-');\n      const monthData = tabFilteredPurchases.filter(purchase => {\n        const purchaseDate = new Date(purchase.request_date);\n        return purchaseDate.getFullYear() === parseInt(year) && \n               (purchaseDate.getMonth() + 1) === parseInt(month);\n      });\n      \n      const monthTotal = monthData.reduce((sum, purchase) => {\n        const amount = purchase.amount_value || purchase.total_amount || 0;\n        return sum + amount;\n      }, 0);\n      \n      return {\n        type: 'single',\n        year: parseInt(year),\n        month: parseInt(month),\n        total: monthTotal,\n        count: monthData.length\n      };\n    }\n  }, [activeFilters, tabFilteredPurchases]);\n\n\n  //  \n  const handleExcelDownload = async (purchase: Purchase) => {\n    try {\n      // DB    \n      const { data: purchaseRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .single();\n\n      if (requestError || !purchaseRequest) {\n        toast.error('     .');\n        return;\n      }\n\n      //   \n      const { data: orderItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .order('line_number');\n\n      if (itemsError || !orderItems || orderItems.length === 0) {\n        toast.error('      .');\n        return;\n      }\n\n      //       \n      const vendorInfo = {\n        vendor_name: purchase.vendor_name,\n        vendor_phone: '',\n        vendor_fax: '',\n        vendor_contact_name: ''\n      };\n\n      try {\n        const vendorId = purchaseRequest.vendor_id || purchase.vendor_id;\n        const contactId = purchaseRequest.contact_id || purchase.contact_id;\n        \n        // vendor  \n        if (vendorId) {\n          const { data: vendorData, error: vendorError } = await supabase\n            .from('vendors')\n            .select('vendor_phone, vendor_fax')\n            .eq('id', vendorId)\n            .single();\n\n          if (vendorData && !vendorError) {\n            vendorInfo.vendor_phone = vendorData.vendor_phone || '';\n            vendorInfo.vendor_fax = vendorData.vendor_fax || '';\n          }\n        }\n\n        // vendor_contacts contact_id   \n        if (contactId) {\n          const { data: contactData, error: contactError } = await supabase\n            .from('vendor_contacts')\n            .select('contact_name, contact_phone, contact_email')\n            .eq('id', contactId)\n            .single();\n          if (contactData && !contactError) {\n            vendorInfo.vendor_contact_name = contactData.contact_name || '';\n          }\n        }\n      } catch (error) {\n      }\n\n      const excelData: PurchaseOrderData = {\n        purchase_order_number: purchaseRequest.purchase_order_number || '',\n        request_date: purchaseRequest.request_date,\n        delivery_request_date: purchaseRequest.delivery_request_date,\n        requester_name: purchaseRequest.requester_name,\n        vendor_name: vendorInfo.vendor_name || '',\n        vendor_contact_name: vendorInfo.vendor_contact_name,\n        vendor_phone: vendorInfo.vendor_phone,\n        vendor_fax: vendorInfo.vendor_fax,\n        project_vendor: purchaseRequest.project_vendor,\n        sales_order_number: purchaseRequest.sales_order_number,\n        project_item: purchaseRequest.project_item,\n        items: orderItems.map((item: any) => ({\n          line_number: item.line_number,\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          amount_value: item.amount_value,\n          remark: item.remark,\n          currency: purchaseRequest.currency || 'KRW'\n        }))\n      };\n\n      //   ExcelJS  (    )\n      const blob = await generatePurchaseOrderExcelJS(excelData);\n      \n      //  : _{}_\n      const downloadFilename = `_${excelData.vendor_name}_${excelData.purchase_order_number}.xlsx`;\n\n      //    \n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = downloadFilename;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success('  .');\n      \n      // DB   (is_po_download)  - lead buyer \n      try {\n        const isLeadBuyer = currentUserRoles && currentUserRoles.includes('lead buyer');\n\n        if (isLeadBuyer) {\n          const { error: downloadFlagErr } = await supabase\n            .from('purchase_requests')\n            .update({ is_po_download: true })\n            .eq('purchase_order_number', purchase.purchase_order_number);\n          if (downloadFlagErr) {\n          } else {\n            //  \n            await loadPurchases();\n          }\n        }\n      } catch (flagErr) {\n      }\n    } catch (error) {\n      toast.error('  .');\n    }\n  };\n\n  //   -    \n  const handleReceiptComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_received: true,\n            received_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_received: true,\n            delivery_status: 'received'\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handlePaymentComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_payment_completed: true,\n            payment_completed_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_payment_completed: true\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handleItemsClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    setIsModalOpen(true);\n  }, []);\n  \n  //    -   \n  const modalPurchaseData = useMemo(() => {\n    if (!selectedPurchase) return null;\n    return {\n      ...selectedPurchase,\n      vendor_name: selectedPurchase.vendor_name || '',\n      project_vendor: selectedPurchase.project_vendor || '',\n      sales_order_number: selectedPurchase.sales_order_number || '',\n      project_item: selectedPurchase.project_item || ''\n    };\n  }, [selectedPurchase]);\n\n  return (\n    <div className=\"w-full\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4\">\n        <div>\n          <h1 className=\"page-title\"> </h1>\n          <p className=\"page-subtitle\" style={{marginTop:'-2px',marginBottom:'-4px'}}>Purchase Management</p>\n        </div>\n        <Button \n          onClick={() => navigate('/purchase/new')}\n          className=\"mt-4 sm:mt-0 bg-hansl-500 hover:bg-hansl-600\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n            \n        </Button>\n      </div>\n\n      {/*    -       */}\n      <div className=\"mb-3\">\n        <FilterToolbar\n          activeFilters={activeFilters}\n          sortConfig={sortConfig}\n          searchTerm={searchTerm}\n          onFiltersChange={setActiveFilters}\n          onSortChange={setSortConfig}\n          onSearchChange={setSearchTerm}\n          availableEmployees={availableEmployees}\n          availableVendors={availableVendors}\n          availableContacts={availableContacts}\n          availablePaymentSchedules={availablePaymentSchedules}\n        />\n        {/*       */}\n        {activeFilters.length === 0 && !searchTerm.trim() && (\n          <div className=\"mt-2 flex items-center gap-1.5 text-xs text-gray-500\">\n            <Info className=\"w-3.5 h-3.5\" />\n            <span> 60  .      .</span>\n          </div>\n        )}\n      </div>\n\n      {/*    (hanslwebapp ) -   */}\n      <div className=\"space-y-3\">\n        {/*   -    */}\n        <div className=\"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 business-radius-card border border-gray-200\">\n          {NAV_TABS.map((tab) => (\n            <button\n              key={tab.key}\n              onClick={() => {\n                setActiveTab(tab.key);\n              }}\n              className={`flex-1 flex items-center justify-center space-x-2 py-1.5 px-3 sm:px-4 business-radius-button button-text font-medium transition-colors ${\n                activeTab === tab.key\n                  ? 'text-hansl-600 bg-white shadow-sm border border-gray-200'\n                  : 'text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50'\n              }`}\n            >\n              <span className=\"whitespace-nowrap\">{tab.label}</span>\n              <Badge \n                variant=\"secondary\" \n                className={\n                  activeTab === tab.key \n                    ? 'badge-stats-active' \n                    : 'badge-stats-secondary'\n                }\n              >\n                {(activeFilters.length > 0 || searchTerm.trim() !== '') \n                  ? filteredTabCounts[tab.key as keyof typeof filteredTabCounts]\n                  : tabCounts[tab.key as keyof typeof tabCounts]}\n              </Badge>\n            </button>\n          ))}\n        </div>\n\n        {/*       */}\n        {monthlyFilterSummary && (\n          <div className=\"mb-3\">\n            {monthlyFilterSummary.type === 'single' ? (\n              //    -    \n              <div className=\"inline-flex items-center gap-2 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 business-radius-badge px-3 py-2 shadow-sm\">\n                <div className=\"flex items-center gap-1.5\">\n                  <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                  <span className=\"card-subtitle text-gray-700\">\n                    {monthlyFilterSummary.year} {monthlyFilterSummary.month}\n                  </span>\n                  <span className=\"badge-text text-gray-500\">\n                    {monthlyFilterSummary.count}\n                  </span>\n                </div>\n                <div className=\"h-4 w-px bg-blue-300\"></div>\n                <span className=\"modal-value text-blue-700 font-semibold\">\n                  {monthlyFilterSummary.total.toLocaleString()}\n                </span>\n              </div>\n            ) : (\n              //   \n              <Card className=\"business-radius-card border border-gray-200 shadow-sm\">\n                <CardHeader className=\"pb-3 pt-4 px-4\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                      <CardTitle className=\"section-title text-gray-800\">  </CardTitle>\n                    </div>\n                    {/*      */}\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"badge-text text-gray-600\">\n                        ({monthlyFilterSummary.months.reduce((sum, m) => sum + m.count, 0)})\n                      </span>\n                      <div className=\"h-4 w-px bg-gray-300\"></div>\n                      <span className=\"modal-value text-gray-500 font-bold\">\n                        {monthlyFilterSummary.grandTotal.toLocaleString()}\n                      </span>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"px-4 pb-4\">\n                  {/*   -     */}\n                  <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                    {monthlyFilterSummary.months.map((monthData) => (\n                      <div \n                        key={monthData.monthStr} \n                        className=\"bg-gray-50 business-radius-card px-3 py-1.5 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all flex-shrink-0\"\n                      >\n                        <div className=\"flex items-baseline gap-1.5\">\n                          <span className=\"modal-value font-bold text-gray-800 whitespace-nowrap\">\n                            {monthData.month}\n                          </span>\n                          <span className=\"text-[9px] text-gray-500 whitespace-nowrap\">\n                            ({monthData.count})\n                          </span>\n                          <span className=\"modal-value text-gray-500 font-bold whitespace-nowrap ml-1\">\n                            {monthData.total.toLocaleString()}\n                          </span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        )}\n\n        {/*   */}\n        <Card className=\"overflow-hidden border border-gray-200\">\n          <CardContent className=\"p-0\">\n            {loading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <div className=\"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin\" />\n                <span className=\"ml-3 card-subtitle\"> ...</span>\n              </div>\n            ) : tabFilteredPurchases.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Package className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\"> </h3>\n                <p className=\"card-subtitle\">  .</p>\n              </div>\n            ) : (\n              <FastPurchaseTable \n                purchases={tabFilteredPurchases} \n                activeTab={activeTab}\n                currentUserRoles={currentUserRoles}\n                onRefresh={loadPurchases}\n                onOptimisticUpdate={updatePurchaseOptimistic}\n                onPaymentComplete={handlePaymentComplete}\n                onReceiptComplete={handleReceiptComplete}\n              />\n            )}\n          </CardContent>\n        </Card>\n      </div>\n      \n      {/*   -     */}\n      {modalPurchaseData && (\n        <Suspense fallback={<div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"><div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div></div>}>\n          <PurchaseItemsModal\n            isOpen={isModalOpen}\n            onClose={() => {\n              setIsModalOpen(false);\n              setSelectedPurchase(null);\n            }}\n            purchase={modalPurchaseData}\n            isAdmin={isAdmin || false}\n            onUpdate={loadPurchases}\n            activeTab={activeTab}\n          />\n        </Suspense>\n      )}\n    </div>\n  );\n}"],"file":"assets/PurchaseListMain-LDekvatK.js"}