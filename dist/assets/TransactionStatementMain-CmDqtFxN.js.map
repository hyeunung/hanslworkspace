{"version":3,"file":"TransactionStatementMain-CmDqtFxN.js","sources":["../../node_modules/lucide-react/dist/esm/icons/circle-x.js","../../node_modules/lucide-react/dist/esm/icons/external-link.js","../../node_modules/lucide-react/dist/esm/icons/refresh-cw.js","../../node_modules/lucide-react/dist/esm/icons/rotate-cw.js","../../node_modules/lucide-react/dist/esm/icons/sliders-horizontal.js","../../src/components/transaction-statement/StatementUploadModal.tsx","../../src/components/transaction-statement/StatementImageViewer.tsx","../../src/components/transaction-statement/StatementConfirmModal.tsx","../../src/components/transaction-statement/TransactionStatementMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"m15 9-6 6\", key: \"1uzhvr\" }],\n  [\"path\", { d: \"m9 9 6 6\", key: \"z0biqf\" }]\n];\nconst CircleX = createLucideIcon(\"circle-x\", __iconNode);\n\nexport { __iconNode, CircleX as default };\n//# sourceMappingURL=circle-x.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 3h6v6\", key: \"1q9fwt\" }],\n  [\"path\", { d: \"M10 14 21 3\", key: \"gplh6r\" }],\n  [\"path\", { d: \"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\", key: \"a6xqqp\" }]\n];\nconst ExternalLink = createLucideIcon(\"external-link\", __iconNode);\n\nexport { __iconNode, ExternalLink as default };\n//# sourceMappingURL=external-link.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8\", key: \"v9h5vc\" }],\n  [\"path\", { d: \"M21 3v5h-5\", key: \"1q7to0\" }],\n  [\"path\", { d: \"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16\", key: \"3uifl3\" }],\n  [\"path\", { d: \"M8 16H3v5\", key: \"1cv678\" }]\n];\nconst RefreshCw = createLucideIcon(\"refresh-cw\", __iconNode);\n\nexport { __iconNode, RefreshCw as default };\n//# sourceMappingURL=refresh-cw.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8\", key: \"1p45f6\" }],\n  [\"path\", { d: \"M21 3v5h-5\", key: \"1q7to0\" }]\n];\nconst RotateCw = createLucideIcon(\"rotate-cw\", __iconNode);\n\nexport { __iconNode, RotateCw as default };\n//# sourceMappingURL=rotate-cw.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"21\", x2: \"14\", y1: \"4\", y2: \"4\", key: \"obuewd\" }],\n  [\"line\", { x1: \"10\", x2: \"3\", y1: \"4\", y2: \"4\", key: \"1q6298\" }],\n  [\"line\", { x1: \"21\", x2: \"12\", y1: \"12\", y2: \"12\", key: \"1iu8h1\" }],\n  [\"line\", { x1: \"8\", x2: \"3\", y1: \"12\", y2: \"12\", key: \"ntss68\" }],\n  [\"line\", { x1: \"21\", x2: \"16\", y1: \"20\", y2: \"20\", key: \"14d8ph\" }],\n  [\"line\", { x1: \"12\", x2: \"3\", y1: \"20\", y2: \"20\", key: \"m0wm8r\" }],\n  [\"line\", { x1: \"14\", x2: \"14\", y1: \"2\", y2: \"6\", key: \"14e1ph\" }],\n  [\"line\", { x1: \"8\", x2: \"8\", y1: \"10\", y2: \"14\", key: \"1i6ji0\" }],\n  [\"line\", { x1: \"16\", x2: \"16\", y1: \"18\", y2: \"22\", key: \"1lctlv\" }]\n];\nconst SlidersHorizontal = createLucideIcon(\"sliders-horizontal\", __iconNode);\n\nexport { __iconNode, SlidersHorizontal as default };\n//# sourceMappingURL=sliders-horizontal.js.map\n","import { useState, useRef, useEffect } from \"react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Upload, X, Image as ImageIcon, Loader2 } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport transactionStatementService from \"@/services/transactionStatementService\";\n\ninterface StatementUploadModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess: (statementId: string, imageUrl: string) => void;\n}\n\n/**\n * ê±°ë˜ëª…ì„¸ì„œ ì´ë¯¸ì§€ ì—…ë¡œë“œ ëª¨ë‹¬\n */\nexport default function StatementUploadModal({\n  isOpen,\n  onClose,\n  onSuccess,\n}: StatementUploadModalProps) {\n  const [file, setFile] = useState<File | null>(null);\n  const [preview, setPreview] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [uploaderName, setUploaderName] = useState<string>(\"\");\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const supabase = createClient();\n\n  // í˜„ì¬ ì‚¬ìš©ì ì´ë¦„ ê°€ì ¸ì˜¤ê¸°\n  const loadUserName = async () => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user?.email) {\n        const { data: employee } = await supabase\n          .from('employees')\n          .select('name')\n          .eq('email', user.email)\n          .single();\n        \n        if (employee?.name) {\n          setUploaderName(employee.name);\n        }\n      }\n    } catch (e) {\n      console.warn('Failed to load user name:', e);\n    }\n  };\n\n  // ëª¨ë‹¬ ì—´ë¦´ ë•Œ ì‚¬ìš©ì ì´ë¦„ ë¡œë“œ\n  useEffect(() => {\n    if (isOpen) {\n      loadUserName();\n    }\n  }, [isOpen]);\n\n  // íŒŒì¼ ì„ íƒ ì²˜ë¦¬\n  const handleFileSelect = (selectedFile: File) => {\n    if (!selectedFile.type.startsWith('image/')) {\n      toast.error('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');\n      return;\n    }\n\n    if (selectedFile.size > 10 * 1024 * 1024) {\n      toast.error('íŒŒì¼ í¬ê¸°ëŠ” 10MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');\n      return;\n    }\n\n    setFile(selectedFile);\n\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      setPreview(reader.result as string);\n    };\n    reader.readAsDataURL(selectedFile);\n  };\n\n  // ë“œë˜ê·¸ì•¤ë“œë¡­ ì²˜ë¦¬\n  const handleDrop = (e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    const droppedFile = e.dataTransfer.files[0];\n    if (droppedFile) {\n      handleFileSelect(droppedFile);\n    }\n  };\n\n  const handleDragOver = (e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n  };\n\n  const handleClick = () => {\n    fileInputRef.current?.click();\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFile = e.target.files?.[0];\n    if (selectedFile) {\n      handleFileSelect(selectedFile);\n    }\n  };\n\n  const handleRemoveFile = () => {\n    setFile(null);\n    setPreview(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const handleUpload = async () => {\n    if (!file) {\n      toast.error('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');\n      return;\n    }\n\n\n    try {\n      setUploading(true);\n\n      const result = await transactionStatementService.uploadStatement(\n        file,\n        uploaderName || 'ì•Œ ìˆ˜ ì—†ìŒ'\n      );\n\n      if (result.success && result.data) {\n        toast.success('ì—…ë¡œë“œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');\n        onSuccess(result.data.statementId, result.data.imageUrl);\n        handleClose();\n      } else {\n        toast.error(result.error || 'ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      toast.error('ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleClose = () => {\n    if (uploading) return;\n    \n    setFile(null);\n    setPreview(null);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n    onClose();\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[480px] business-radius-modal\">\n        <DialogHeader className=\"border-b border-gray-100 pb-3\">\n          <DialogTitle className=\"flex items-center gap-2 text-[13px] font-bold text-gray-900\">\n            <Upload className=\"w-4 h-4 text-hansl-600\" />\n            ê±°ë˜ëª…ì„¸ì„œ ì—…ë¡œë“œ\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"py-4\">\n          {/* ë“œë˜ê·¸ì•¤ë“œë¡­ ì˜ì—­ */}\n          <div\n            className={`\n              border-2 border-dashed business-radius-card p-6 text-center cursor-pointer transition-colors\n              ${preview \n                ? 'border-hansl-300 bg-hansl-50' \n                : 'border-gray-200 hover:border-hansl-300 hover:bg-gray-50'\n              }\n            `}\n            onDrop={handleDrop}\n            onDragOver={handleDragOver}\n            onClick={handleClick}\n          >\n            <input\n              ref={fileInputRef}\n              type=\"file\"\n              accept=\"image/*\"\n              onChange={handleInputChange}\n              className=\"hidden\"\n            />\n\n            {preview ? (\n              <div className=\"relative\">\n                <img\n                  src={preview}\n                  alt=\"ë¯¸ë¦¬ë³´ê¸°\"\n                  className=\"max-h-52 mx-auto business-radius-card shadow-sm\"\n                />\n                <button\n                  className=\"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors\"\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleRemoveFile();\n                  }}\n                >\n                  <X className=\"w-3.5 h-3.5\" />\n                </button>\n                <p className=\"mt-3 text-[11px] text-gray-600 truncate px-4\">\n                  {file?.name}\n                </p>\n              </div>\n            ) : (\n              <>\n                <ImageIcon className=\"w-10 h-10 text-gray-300 mx-auto mb-3\" />\n                <p className=\"text-[11px] text-gray-600 mb-1\">\n                  ê±°ë˜ëª…ì„¸ì„œ ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒí•˜ì„¸ìš”\n                </p>\n                <p className=\"text-[10px] text-gray-400\">\n                  ì§€ì› í˜•ì‹: JPG, PNG, GIF, WEBP (ìµœëŒ€ 10MB)\n                </p>\n              </>\n            )}\n          </div>\n\n          {/* ì•ˆë‚´ ë¬¸êµ¬ */}\n          <div className=\"mt-3 p-2.5 bg-blue-50 business-radius-card border border-blue-100\">\n            <p className=\"text-[10px] text-blue-700 leading-relaxed\">\n              ğŸ’¡ ê±°ë˜ëª…ì„¸ì„œë¥¼ ì´¬ì˜í•˜ê±°ë‚˜ ìŠ¤ìº”í•œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.\n              ì—…ë¡œë“œ í›„ OCRë¡œ í’ˆëª©, ìˆ˜ëŸ‰, ê¸ˆì•¡, ë°œì£¼ë²ˆí˜¸ ë“±ì„ ìë™ìœ¼ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤.\n            </p>\n          </div>\n        </div>\n\n        <DialogFooter className=\"border-t border-gray-100 pt-3 gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={handleClose}\n            disabled={uploading}\n            className=\"button-base h-8 text-[11px]\"\n          >\n            ì·¨ì†Œ\n          </Button>\n          <Button\n            onClick={handleUpload}\n            disabled={!file || uploading}\n            className=\"button-base h-8 text-[11px] bg-hansl-600 hover:bg-hansl-700 text-white\"\n          >\n            {uploading ? (\n              <>\n                <Loader2 className=\"w-3.5 h-3.5 mr-1.5 animate-spin\" />\n                ì—…ë¡œë“œ ì¤‘...\n              </>\n            ) : (\n              <>\n                <Upload className=\"w-3.5 h-3.5 mr-1.5\" />\n                ì—…ë¡œë“œ\n              </>\n            )}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import {\n  Dialog,\n  DialogContent,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { X, ZoomIn, ZoomOut, RotateCw, Download } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { toast } from \"sonner\";\n\ninterface StatementImageViewerProps {\n  isOpen: boolean;\n  imageUrl: string;\n  onClose: () => void;\n}\n\n/**\n * ê±°ë˜ëª…ì„¸ì„œ ì´ë¯¸ì§€ ë·°ì–´ (ë¼ì´íŠ¸ë°•ìŠ¤)\n */\nexport default function StatementImageViewer({\n  isOpen,\n  imageUrl,\n  onClose,\n}: StatementImageViewerProps) {\n  const [scale, setScale] = useState(1);\n  const [rotation, setRotation] = useState(0);\n\n  const handleZoomIn = () => {\n    setScale((prev) => Math.min(prev + 0.25, 3));\n  };\n\n  const handleZoomOut = () => {\n    setScale((prev) => Math.max(prev - 0.25, 0.5));\n  };\n\n  const handleRotate = () => {\n    setRotation((prev) => (prev + 90) % 360);\n  };\n\n  const handleDownload = async () => {\n    try {\n      const response = await fetch(imageUrl);\n      const blob = await response.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `ê±°ë˜ëª…ì„¸ì„œ_${new Date().toISOString().split('T')[0]}.jpg`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n      toast.success('ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      toast.error('ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleClose = () => {\n    setScale(1);\n    setRotation(0);\n    onClose();\n  };\n\n  if (!imageUrl) return null;\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-[90vw] max-h-[90vh] p-0 bg-black/95 border-none\">\n        {/* ì»¨íŠ¸ë¡¤ ë°” */}\n        <div className=\"absolute top-0 left-0 right-0 z-50 flex items-center justify-between px-4 py-3 bg-gradient-to-b from-black/80 to-transparent\">\n          <div className=\"flex items-center gap-1.5\">\n            <button\n              onClick={handleZoomOut}\n              disabled={scale <= 0.5}\n              className=\"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white disabled:opacity-40 transition-colors\"\n            >\n              <ZoomOut className=\"w-4 h-4\" />\n            </button>\n            <span className=\"text-[11px] text-white min-w-[50px] text-center font-medium\">\n              {Math.round(scale * 100)}%\n            </span>\n            <button\n              onClick={handleZoomIn}\n              disabled={scale >= 3}\n              className=\"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white disabled:opacity-40 transition-colors\"\n            >\n              <ZoomIn className=\"w-4 h-4\" />\n            </button>\n            <div className=\"w-px h-5 bg-white/30 mx-1.5\" />\n            <button\n              onClick={handleRotate}\n              className=\"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors\"\n            >\n              <RotateCw className=\"w-4 h-4\" />\n            </button>\n            <button\n              onClick={handleDownload}\n              className=\"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors\"\n            >\n              <Download className=\"w-4 h-4\" />\n            </button>\n          </div>\n          <button\n            onClick={handleClose}\n            className=\"p-2 rounded-lg bg-white/10 hover:bg-white/20 text-white transition-colors\"\n          >\n            <X className=\"w-4 h-4\" />\n          </button>\n        </div>\n\n        {/* ì´ë¯¸ì§€ */}\n        <div className=\"flex items-center justify-center w-full h-[80vh] overflow-auto p-4 pt-16\">\n          <img\n            src={imageUrl}\n            alt=\"ê±°ë˜ëª…ì„¸ì„œ\"\n            className=\"max-w-full max-h-full object-contain transition-transform duration-200\"\n            style={{\n              transform: `scale(${scale}) rotate(${rotation}deg)`,\n            }}\n          />\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","import { useState, useEffect, useCallback, useMemo, useRef } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  CheckCircle,\n  XCircle,\n  Image as ImageIcon,\n  Loader2,\n  ChevronDown,\n  Check,\n  ExternalLink,\n  Search\n} from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport transactionStatementService from \"@/services/transactionStatementService\";\nimport type { \n  TransactionStatement, \n  TransactionStatementWithItems,\n  TransactionStatementItemWithMatch,\n  ConfirmItemRequest,\n  MatchCandidate,\n  OCRFieldType\n} from \"@/types/transactionStatement\";\nimport { normalizeOrderNumber } from \"@/types/transactionStatement\";\nimport StatementImageViewer from \"./StatementImageViewer\";\nimport PurchaseDetailModal from \"@/components/purchase/PurchaseDetailModal\";\n\ninterface StatementConfirmModalProps {\n  isOpen: boolean;\n  statement: TransactionStatement;\n  onClose: () => void;\n  onConfirm: () => void;\n}\n\n// ì‹œìŠ¤í…œ ë°œì£¼ í’ˆëª© íƒ€ì…\ninterface SystemPurchaseItem {\n  purchase_id: number;\n  item_id: number;\n  purchase_order_number: string;\n  sales_order_number?: string;\n  item_name: string;\n  specification?: string;  // ê·œê²© ì¶”ê°€ - êµì°¨ ë¹„êµìš©\n  quantity?: number;\n  received_quantity?: number;\n  unit_price?: number;\n  amount?: number;\n  vendor_name?: string;\n}\n\n// Levenshtein ê±°ë¦¬ ê³„ì‚° í•¨ìˆ˜\nfunction levenshteinDistance(str1: string, str2: string): number {\n  const s1 = str1.toLowerCase().replace(/\\s+/g, '');\n  const s2 = str2.toLowerCase().replace(/\\s+/g, '');\n  \n  if (s1 === s2) return 0;\n  if (s1.length === 0) return s2.length;\n  if (s2.length === 0) return s1.length;\n\n  const matrix: number[][] = [];\n\n  for (let i = 0; i <= s1.length; i++) {\n    matrix[i] = [i];\n  }\n  for (let j = 0; j <= s2.length; j++) {\n    matrix[0][j] = j;\n  }\n\n  for (let i = 1; i <= s1.length; i++) {\n    for (let j = 1; j <= s2.length; j++) {\n      const cost = s1[i - 1] === s2[j - 1] ? 0 : 1;\n      matrix[i][j] = Math.min(\n        matrix[i - 1][j] + 1,\n        matrix[i][j - 1] + 1,\n        matrix[i - 1][j - 1] + cost\n      );\n    }\n  }\n\n  return matrix[s1.length][s2.length];\n}\n\n// ë‹¨ì¼ ë¬¸ìì—´ ìœ ì‚¬ë„ ê³„ì‚° (ë‚´ë¶€ í—¬í¼) - ë” ì—„ê²©í•œ ë²„ì „\nfunction calculateStringSimilarity(ocrName: string, targetName: string): number {\n  const ocr = ocrName?.toLowerCase().replace(/\\s+/g, '') || '';\n  const target = targetName?.toLowerCase().replace(/\\s+/g, '') || '';\n  \n  if (!ocr || !target) return 0;\n  \n  // ì™„ì „ ì¼ì¹˜\n  if (ocr === target) return 100;\n  \n  // ë¶€ë¶„ í¬í•¨ - ê¸¸ì´ ë¹„ìœ¨ ì²´í¬ (ìµœì†Œ 50% ì´ìƒ ê²¹ì³ì•¼ ë†’ì€ ì ìˆ˜)\n  const minLen = Math.min(ocr.length, target.length);\n  const maxLen = Math.max(ocr.length, target.length);\n  const lengthRatio = minLen / maxLen;\n  \n  if (ocr.includes(target) || target.includes(ocr)) {\n    // ê¸¸ì´ ë¹„ìœ¨ì´ ë‚®ìœ¼ë©´ ì ìˆ˜ ê°ì†Œ (ì˜ˆ: \"A\"ê°€ \"ABCDEFG\"ì— í¬í•¨ë˜ë©´ ë‚®ì€ ì ìˆ˜)\n    if (lengthRatio >= 0.7) return 90; // 70% ì´ìƒ ê²¹ì¹¨\n    if (lengthRatio >= 0.5) return 70; // 50% ì´ìƒ ê²¹ì¹¨\n    if (lengthRatio >= 0.3) return 50; // 30% ì´ìƒ ê²¹ì¹¨\n    return 30; // ê·¸ ì™¸ (ë„ˆë¬´ ì§§ì€ ë¬¸ìì—´ì´ í¬í•¨ëœ ê²½ìš°)\n  }\n  \n  // Levenshtein ê±°ë¦¬ ê¸°ë°˜\n  const distance = levenshteinDistance(ocr, target);\n  const similarity = ((maxLen - distance) / maxLen) * 100;\n  \n  // ë‹¨ì–´ ì¼ë¶€ ì¼ì¹˜ ì²´í¬ - ë³´ë„ˆìŠ¤ ì¶•ì†Œ (30 â†’ 15)\n  const ocrWords = ocrName?.split(/\\s+/).filter(w => w.length >= 2) || [];\n  const targetWords = targetName?.split(/\\s+/).filter(w => w.length >= 2) || [];\n  \n  if (ocrWords.length === 0 || targetWords.length === 0) {\n    return similarity;\n  }\n  \n  const commonWords = ocrWords.filter(w => \n    targetWords.some(tw => {\n      const wLower = w.toLowerCase();\n      const twLower = tw.toLowerCase();\n      // ìµœì†Œ 3ê¸€ì ì´ìƒ ì¼ì¹˜í•´ì•¼ ë‹¨ì–´ ì¼ì¹˜ë¡œ ì¸ì •\n      return wLower === twLower || \n        (wLower.length >= 3 && twLower.includes(wLower)) || \n        (twLower.length >= 3 && wLower.includes(twLower));\n    })\n  );\n  const wordMatchBonus = (commonWords.length / Math.max(ocrWords.length, targetWords.length)) * 15;\n  \n  return Math.min(100, similarity + wordMatchBonus);\n}\n\n// í’ˆëª©ëª… ìœ ì‚¬ë„ ì ìˆ˜ ê³„ì‚° - í’ˆëª©ëª… ìš°ì„ , ê·œê²©ì€ ë³´ì¡°\nfunction calculateItemSimilarity(ocrName: string, systemItemName: string, systemSpec?: string): number {\n  // 1. item_nameê³¼ ë¹„êµ (ê¸°ë³¸)\n  const itemNameScore = calculateStringSimilarity(ocrName, systemItemName);\n  \n  // 2. specificationê³¼ë„ ë¹„êµ (ìˆìœ¼ë©´)\n  const specScore = systemSpec ? calculateStringSimilarity(ocrName, systemSpec) : 0;\n  \n  // 3. í’ˆëª©ëª…ì´ ì–´ëŠ ì •ë„ ì¼ì¹˜í•˜ë©´ (30% ì´ìƒ) ê·¸ ì ìˆ˜ ì‚¬ìš©\n  if (itemNameScore >= 30) {\n    return itemNameScore;\n  }\n  \n  // 4. í’ˆëª©ëª…ì´ ì „í˜€ ì•ˆ ë§ëŠ”ë° (30% ë¯¸ë§Œ) ê·œê²©ë§Œ ì¼ì¹˜í•˜ëŠ” ê²½ìš°\n  //    â†’ ê·œê²© ì¼ì¹˜ëŠ” ë³´ì¡° ì •ë³´ì´ë¯€ë¡œ ì ìˆ˜ì— í° íŒ¨ë„í‹° ë¶€ì—¬\n  if (specScore >= 60 && itemNameScore < 30) {\n    // ê·œê²©ì´ ì¼ì¹˜í•´ë„ í’ˆëª©ëª…ì´ ì „í˜€ ë‹¤ë¥´ë©´ ìµœëŒ€ 35%ë§Œ ì¸ì •\n    // (ì‚¬ìš©ìê°€ \"í’ˆëª©ëª…ì´ ë‹¤ë¥¸ë° ì™œ ì¼ì¹˜?\"ë¼ê³  í˜¼ë€ìŠ¤ëŸ¬ì›Œí•¨)\n    return Math.min(35, specScore * 0.4);\n  }\n  \n  // 5. ë‘˜ ë‹¤ ë‚®ìœ¼ë©´ ë‚®ì€ ì ìˆ˜ ë°˜í™˜\n  return Math.max(itemNameScore, specScore * 0.3);\n}\n\n// ìˆ˜ëŸ‰ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸ (ì •í™•íˆ ì¼ì¹˜í•˜ë©´ true)\nfunction isQuantityMatched(ocrQuantity: number | undefined | null, systemQuantity: number | undefined | null): boolean {\n  if (ocrQuantity === undefined || ocrQuantity === null) return false;\n  if (systemQuantity === undefined || systemQuantity === null) return false;\n  return ocrQuantity === systemQuantity;\n}\n\n// ìˆ˜ëŸ‰ ì¼ì¹˜ìœ¨ ê³„ì‚° (ë¶€ë¶„ ì…ê³  ê³ ë ¤ - 10% ì´ë‚´ ì˜¤ì°¨ í—ˆìš©)\nfunction getQuantityMatchLevel(ocrQuantity: number | undefined | null, systemQuantity: number | undefined | null): 'exact' | 'partial' | 'mismatch' {\n  if (ocrQuantity === undefined || ocrQuantity === null) return 'mismatch';\n  if (systemQuantity === undefined || systemQuantity === null) return 'mismatch';\n  \n  if (ocrQuantity === systemQuantity) return 'exact';\n  \n  // ë¶€ë¶„ ì…ê³ : OCR ìˆ˜ëŸ‰ì´ ì‹œìŠ¤í…œ ìˆ˜ëŸ‰ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìœ¼ë©´ partial\n  if (ocrQuantity <= systemQuantity) return 'partial';\n  \n  return 'mismatch';\n}\n\n/**\n * ê±°ë˜ëª…ì„¸ì„œ í™•ì¸/ìˆ˜ì •/í™•ì • ëª¨ë‹¬ - 3ë‹¨ ë¹„êµ ë ˆì´ì•„ì›ƒ\n */\nexport default function StatementConfirmModal({\n  isOpen,\n  statement,\n  onClose,\n  onConfirm,\n}: StatementConfirmModalProps) {\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [statementWithItems, setStatementWithItems] = useState<TransactionStatementWithItems | null>(null);\n  const [isImageViewerOpen, setIsImageViewerOpen] = useState(false);\n  const [confirmerName, setConfirmerName] = useState(\"\");\n  \n  // ì„ íƒëœ ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ (Case 1: ì „ì²´ ì ìš©ìš©)\n  const [selectedPONumber, setSelectedPONumber] = useState<string>(\"\");\n  \n  // ê° OCR í’ˆëª©ë³„ ì„ íƒëœ ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ (Case 2: ê°œë³„ ì ìš©ìš©)\n  const [itemPONumbers, setItemPONumbers] = useState<Map<string, string>>(new Map());\n  \n  // ê° OCR í’ˆëª©ë³„ ë§¤ì¹­ëœ ì‹œìŠ¤í…œ í’ˆëª©\n  const [itemMatches, setItemMatches] = useState<Map<string, SystemPurchaseItem | null>>(new Map());\n  \n  // ë“œë¡­ë‹¤ìš´ ì—´ë¦¼ ìƒíƒœ\n  const [openDropdowns, setOpenDropdowns] = useState<Set<string>>(new Set());\n  \n  // ë“œë¡­ë‹¤ìš´ ìœ„ì¹˜ (fixed positionìš©)\n  const [dropdownPosition, setDropdownPosition] = useState<{ top: number; left: number }>({ top: 0, left: 0 });\n  \n  // ë°œì£¼ ìƒì„¸ ëª¨ë‹¬ ìƒíƒœ\n  const [isPurchaseDetailModalOpen, setIsPurchaseDetailModalOpen] = useState(false);\n  const [selectedPurchaseIdForDetail, setSelectedPurchaseIdForDetail] = useState<number | null>(null);\n  \n  // OCR í’ˆëª© í¸ì§‘ ìƒíƒœ (í•™ìŠµìš©)\n  // key: itemId, value: ìˆ˜ì •ëœ ê°’ë“¤\n  interface EditedOCRItem {\n    item_name?: string;\n    quantity?: number;\n    unit_price?: number;\n    amount?: number;\n    po_number?: string;\n  }\n  const [editedOCRItems, setEditedOCRItems] = useState<Map<string, EditedOCRItem>>(new Map());\n  \n  // ë§¤ì¹­ ìƒì„¸ ì •ë³´ íŒì—…\n  const [matchDetailPopup, setMatchDetailPopup] = useState<{\n    isOpen: boolean;\n    ocrItemId: string;\n    ocrItemName: string;\n    systemItemName: string;\n    systemSpec: string;\n    similarity: number;\n    status: 'high' | 'med' | 'low' | 'unmatched';\n    reasons: string[];\n  } | null>(null);\n  \n  // í†µí•© ë§¤ì¹­ ìƒì„¸ íŒì—… (ë°œì£¼ë²ˆí˜¸ ì „ì²´ ë§¤ì¹­ ë‚´ì—­)\n  const [isIntegratedMatchDetailOpen, setIsIntegratedMatchDetailOpen] = useState(false);\n  \n  // ê±°ë˜ì²˜ ì¸ë¼ì¸ ê²€ìƒ‰ ìƒíƒœ\n  const [vendorInputValue, setVendorInputValue] = useState('');\n  const [vendorSearchResults, setVendorSearchResults] = useState<Array<{ id: number; name: string; english_name?: string }>>([]);\n  const [vendorSearchLoading, setVendorSearchLoading] = useState(false);\n  const [vendorDropdownOpen, setVendorDropdownOpen] = useState(false);\n  const [overrideVendorName, setOverrideVendorName] = useState<string | null>(null);\n  type VendorSearchRow = { id: number; vendor_name: string; english_name?: string | null };\n  const [poItemsMap, setPoItemsMap] = useState<Map<string, SystemPurchaseItem[]>>(new Map());\n  const autoVendorSelectionRef = useRef(false);\n  const systemCandidateLogKeyRef = useRef<string | null>(null);\n  \n  // ë°œì£¼ë²ˆí˜¸ ì¸ë¼ì¸ ê²€ìƒ‰ ìƒíƒœ\n  const [poSearchInputOpen, setPOSearchInputOpen] = useState(false);\n  const [poSearchInput, setPOSearchInput] = useState('');\n  const [poSearchResults, setPOSearchResults] = useState<Array<{ id: number; poNumber: string; soNumber?: string; vendorName?: string }>>([]);\n  const [poSearchLoading, setPOSearchLoading] = useState(false);\n  const [poDropdownOpen, setPODropdownOpen] = useState(false);\n  const [manuallySelectedPO, setManuallySelectedPO] = useState(false); // ìˆ˜ë™ ì„ íƒ ì—¬ë¶€\n  const keepPODropdownOpenRef = useRef(false);\n  const [itemPOSearchInputs, setItemPOSearchInputs] = useState<Record<string, string>>({});\n  const [itemPOSearchResults, setItemPOSearchResults] = useState<Record<string, Array<{ id: number; poNumber: string; soNumber?: string; vendorName?: string }>>>({});\n  const [itemPOSearchLoading, setItemPOSearchLoading] = useState<Record<string, boolean>>({});\n  const lastSelectedSystemItemRef = useRef<string | null>(null);\n  const tableContainerRef = useRef<HTMLDivElement | null>(null);\n  const tableRef = useRef<HTMLTableElement | null>(null);\n  const [statementDateInput, setStatementDateInput] = useState('');\n\n  // OCR ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ í˜ì–´ ìºì‹œ (ì‹¤ì‹œê°„ ì…ë ¥ìš©)\n  const [poPairOverrides, setPoPairOverrides] = useState<Map<string, string | null>>(new Map());\n  const pendingPairLookupsRef = useRef<Set<string>>(new Set());\n  \n  // ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ (Case 1ìš©)\n  const [setMatchResult, setSetMatchResult] = useState<{\n    bestMatch: {\n      purchase_id: number;\n      purchase_order_number: string;\n      sales_order_number?: string;\n      vendor_name?: string;\n      matchScore: number;\n      matchedItemCount: number;\n      totalItemCount: number;\n      confidence: 'high' | 'medium' | 'low';\n      itemMatches: Array<{\n        ocrItemId: string;\n        systemItemId: number;\n        systemItemName: string;\n        similarity: number;\n      }>;\n    } | null;\n    candidates: Array<{\n      purchase_id: number;\n      purchase_order_number: string;\n      sales_order_number?: string;\n      vendor_name?: string;\n      matchScore: number;\n      matchedItemCount: number;\n    }>;\n  } | null>(null);\n  \n  const supabase = createClient();\n\n  // ëª¨ë“  í’ˆëª©ì˜ ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ê°€ ë™ì¼í•œì§€ í™•ì¸\n  const isSamePONumber = useMemo(() => {\n    if (!statementWithItems?.items.length) return true;\n    \n    const poNumbers = statementWithItems.items\n      .map(item => item.extracted_po_number ? normalizeOrderNumber(item.extracted_po_number) : null)\n      .filter(Boolean);\n    \n    if (poNumbers.length === 0) return true;\n    \n    return poNumbers.every(po => po === poNumbers[0]);\n  }, [statementWithItems]);\n\n  // ê³µí†µ ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ (Case 1ìš©)\n  const commonPONumber = useMemo(() => {\n    if (!statementWithItems?.items.length) return null;\n    \n    const poNumber = statementWithItems.items.find(item => item.extracted_po_number)?.extracted_po_number;\n    return poNumber ? normalizeOrderNumber(poNumber) : null;\n  }, [statementWithItems]);\n\n  // ê±°ë˜ì²˜ëª… ì´ˆê¸°ê°’ ì„¤ì •\n  useEffect(() => {\n    if (!statementWithItems) return;\n    const initialVendor = statementWithItems.vendor_name || '';\n    if (initialVendor && !vendorInputValue) {\n      setVendorInputValue(initialVendor);\n    }\n    if (initialVendor && !autoVendorSelectionRef.current) {\n      autoVendorSelectionRef.current = true;\n      handleSelectVendor(initialVendor, { silent: true });\n    }\n  }, [statementWithItems, vendorInputValue]);\n\n  const normalizeStatementDate = (value?: string | null) => {\n    if (!value) return '';\n    const trimmed = value.trim();\n    if (!trimmed) return '';\n    if (/^\\d{4}-\\d{2}-\\d{2}$/.test(trimmed)) return trimmed;\n    const parsed = new Date(trimmed);\n    if (!Number.isNaN(parsed.getTime())) {\n      return parsed.toISOString().slice(0, 10);\n    }\n    return trimmed.slice(0, 10);\n  };\n\n  // ê±°ë˜ì¼ ì´ˆê¸°ê°’ ì„¤ì •\n  useEffect(() => {\n    if (!statementWithItems) return;\n    setStatementDateInput(normalizeStatementDate(statementWithItems.statement_date));\n  }, [statementWithItems]);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    const container = tableContainerRef.current;\n    const table = tableRef.current;\n    if (!container || !table) return;\n\n    const containerRect = container.getBoundingClientRect();\n    const tableRect = table.getBoundingClientRect();\n    const scrollbarWidth = container.offsetWidth - container.clientWidth;\n    // #region agent log\n    fetch('http://127.0.0.1:7242/ingest/b22edbac-a44c-4882-a88d-47f6cafc7628',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'StatementConfirmModal.tsx:layout:headerGap',message:'table_layout_metrics',data:{containerClientWidth:container.clientWidth,containerScrollWidth:container.scrollWidth,containerOffsetWidth:container.offsetWidth,tableWidth:table.offsetWidth,tableScrollWidth:table.scrollWidth,scrollbarWidth,containerRectWidth:containerRect.width,tableRectWidth:tableRect.width},timestamp:Date.now(),sessionId:'debug-session',runId:'run5',hypothesisId:'H1'})}).catch(()=>{});\n    // #endregion\n\n    // #region agent log\n    fetch('http://127.0.0.1:7242/ingest/b22edbac-a44c-4882-a88d-47f6cafc7628',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'StatementConfirmModal.tsx:layout:padding',message:'container_padding',data:{containerPaddingRight:window.getComputedStyle(container).paddingRight,containerPaddingLeft:window.getComputedStyle(container).paddingLeft,containerBg:window.getComputedStyle(container).backgroundColor},timestamp:Date.now(),sessionId:'debug-session',runId:'run6',hypothesisId:'H2'})}).catch(()=>{});\n    // #endregion\n\n    // #region agent log\n    fetch('http://127.0.0.1:7242/ingest/b22edbac-a44c-4882-a88d-47f6cafc7628',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'StatementConfirmModal.tsx:layout:tableStyles',message:'table_styles',data:{tableBg:window.getComputedStyle(table).backgroundColor,tableWidthStyle:window.getComputedStyle(table).width,tableMinWidth:window.getComputedStyle(table).minWidth,tbodyBg:window.getComputedStyle(table.tBodies[0]).backgroundColor,theadBg:window.getComputedStyle(table.tHead).backgroundColor},timestamp:Date.now(),sessionId:'debug-session',runId:'run7',hypothesisId:'H3'})}).catch(()=>{});\n    // #endregion\n\n    const firstRow = table.tBodies[0]?.rows?.[0];\n    const firstCell = firstRow?.cells?.[0];\n    const firstCellRect = firstCell?.getBoundingClientRect();\n    const firstCellLeftGap = firstCellRect ? firstCellRect.left - tableRect.left : null;\n    // #region agent log\n    fetch('http://127.0.0.1:7242/ingest/b22edbac-a44c-4882-a88d-47f6cafc7628',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'StatementConfirmModal.tsx:layout:leftGap',message:'table_left_gap',data:{firstCellLeftGap,tableBorderSpacing:window.getComputedStyle(table).borderSpacing,tablePaddingLeft:window.getComputedStyle(table).paddingLeft,tbodyPaddingLeft:window.getComputedStyle(table.tBodies[0]).paddingLeft,firstCellPaddingLeft:firstCell ? window.getComputedStyle(firstCell).paddingLeft : null},timestamp:Date.now(),sessionId:'debug-session',runId:'run8',hypothesisId:'H4'})}).catch(()=>{});\n    // #endregion\n  }, [isOpen, statementWithItems]);\n\n  // ë°ì´í„° ë¡œë“œ\n  const loadData = useCallback(async () => {\n    try {\n      setLoading(true);\n      \n      const { data: { user } } = await supabase.auth.getUser();\n      if (user?.email) {\n        const { data: employee } = await supabase\n          .from('employees')\n          .select('name')\n          .eq('email', user.email)\n          .single();\n        \n        if (employee?.name) {\n          setConfirmerName(employee.name);\n        }\n      }\n\n      const result = await transactionStatementService.getStatementWithItems(statement.id);\n      \n      if (result.success && result.data) {\n        setStatementWithItems(result.data);\n        \n        // ì´ˆê¸° ë°œì£¼ë²ˆí˜¸ ì„¤ì • ë° ìë™ ë§¤ì¹­\n        const initialPONumbers = new Map<string, string>();\n        const initialMatches = new Map<string, SystemPurchaseItem | null>();\n        \n        result.data.items.forEach(item => {\n          // ì¶”ì¶œëœ ë°œì£¼ë²ˆí˜¸ ì„¤ì • (ì‹œìŠ¤í…œ í˜•ì‹ìœ¼ë¡œ ì •ê·œí™”)\n          let poNumber = '';\n          if (item.extracted_po_number) {\n            poNumber = normalizeOrderNumber(item.extracted_po_number);\n            const hasCandidateMatch = item.match_candidates?.some(c =>\n              c.purchase_order_number === poNumber || c.sales_order_number === poNumber\n            );\n            if (hasCandidateMatch) {\n              initialPONumbers.set(item.id, poNumber);\n            }\n          }\n          \n          // ê¸°ì¡´ ë§¤ì¹­ ì •ë³´ê°€ ìˆìœ¼ë©´ ì„¤ì •\n          if (item.matched_purchase && item.matched_item_id) {\n            const matchedPO = item.matched_purchase.purchase_order_number ||\n              item.matched_purchase.sales_order_number ||\n              '';\n            if (matchedPO) {\n              initialPONumbers.set(item.id, matchedPO);\n            }\n            initialMatches.set(item.id, {\n              purchase_id: item.matched_purchase_id!,\n              item_id: item.matched_item_id!,\n              purchase_order_number: item.matched_purchase.purchase_order_number || '',\n              sales_order_number: item.matched_purchase.sales_order_number,\n              item_name: (item as any).matched_item_name || '',\n              quantity: (item as any).matched_item_quantity,\n              unit_price: (item as any).matched_item_unit_price,\n              amount: (item as any).matched_item_amount,\n              vendor_name: item.matched_purchase.vendor_name\n            });\n          } else {\n            // ìë™ ë§¤ì¹­: í•´ë‹¹ ë°œì£¼ë²ˆí˜¸ì˜ í›„ë³´ ì¤‘ì—ì„œ ê°€ì¥ ìœ ì‚¬í•œ í’ˆëª© ì°¾ê¸°\n            let bestMatch: SystemPurchaseItem | null = null;\n            let bestScore = -1;\n            \n            // 1. í•´ë‹¹ ë°œì£¼ë²ˆí˜¸ì™€ ì¼ì¹˜í•˜ëŠ” í›„ë³´ ê²€ìƒ‰\n            const matchingCandidates = item.match_candidates?.filter(c => \n              c.purchase_order_number === poNumber || c.sales_order_number === poNumber\n            ) || [];\n            \n            for (const c of matchingCandidates) {\n              const score = calculateItemSimilarity(item.extracted_item_name || '', c.item_name, c.specification);\n              if (score > bestScore) {\n                bestScore = score;\n                bestMatch = {\n                  purchase_id: c.purchase_id,\n                  item_id: c.item_id,\n                  purchase_order_number: c.purchase_order_number || '',\n                  sales_order_number: c.sales_order_number,\n                  item_name: c.item_name,\n                  specification: c.specification,\n                  quantity: c.quantity,\n                  unit_price: c.unit_price,\n                  amount: (c as any).amount,\n                  vendor_name: c.vendor_name\n                };\n              }\n            }\n            \n            // 2. ë°œì£¼ë²ˆí˜¸ë¡œ ëª» ì°¾ìœ¼ë©´ ëª¨ë“  í›„ë³´ì—ì„œ ìµœê³  ìœ ì‚¬ë„ë¡œ ê²€ìƒ‰ (fallback)\n            if (!bestMatch && item.match_candidates && item.match_candidates.length > 0) {\n              for (const c of item.match_candidates) {\n                const score = calculateItemSimilarity(item.extracted_item_name || '', c.item_name, c.specification);\n                if (score > bestScore && score >= 40) { // ìµœì†Œ 40ì  ì´ìƒ (ë” ì—„ê²©)\n                  bestScore = score;\n                  bestMatch = {\n                    purchase_id: c.purchase_id,\n                    item_id: c.item_id,\n                    purchase_order_number: c.purchase_order_number || '',\n                    sales_order_number: c.sales_order_number,\n                    item_name: c.item_name,\n                    specification: c.specification,\n                    quantity: c.quantity,\n                    unit_price: c.unit_price,\n                    amount: (c as any).amount,\n                    vendor_name: c.vendor_name\n                  };\n                }\n              }\n              \n              // fallbackìœ¼ë¡œ ì°¾ì•˜ìœ¼ë©´ ë°œì£¼ë²ˆí˜¸ë„ ì‹œìŠ¤í…œ ê²ƒìœ¼ë¡œ ì—…ë°ì´íŠ¸ (OCR ì˜¤ë¥˜ ìˆ˜ì •)\n              if (bestMatch) {\n                const matchedPO = bestMatch.purchase_order_number || bestMatch.sales_order_number || '';\n                if (matchedPO) {\n                  initialPONumbers.set(item.id, matchedPO);\n                }\n              }\n            }\n\n            if (!initialPONumbers.has(item.id) && item.match_candidates && item.match_candidates.length > 0) {\n              const bestCandidate = item.match_candidates.reduce((best, current) => {\n                if (!best) return current;\n                return (current.score ?? -1) > (best.score ?? -1) ? current : best;\n              }, item.match_candidates[0]);\n              const recommendedPO = bestCandidate.purchase_order_number || bestCandidate.sales_order_number || '';\n              if (recommendedPO) {\n                initialPONumbers.set(item.id, recommendedPO);\n              }\n\n              if (!bestMatch && recommendedPO) {\n                const candidatesForPO = item.match_candidates.filter(c =>\n                  c.purchase_order_number === recommendedPO || c.sales_order_number === recommendedPO\n                );\n                let bestItem: SystemPurchaseItem | null = null;\n                let bestItemScore = -1;\n                for (const c of candidatesForPO) {\n                  const score = calculateItemSimilarity(item.extracted_item_name || '', c.item_name, c.specification);\n                  if (score > bestItemScore) {\n                    bestItemScore = score;\n                    bestItem = {\n                      purchase_id: c.purchase_id,\n                      item_id: c.item_id,\n                      purchase_order_number: c.purchase_order_number || '',\n                      sales_order_number: c.sales_order_number,\n                      item_name: c.item_name,\n                      specification: c.specification,\n                      quantity: c.quantity,\n                      unit_price: c.unit_price,\n                      amount: (c as any).amount,\n                      vendor_name: c.vendor_name\n                    };\n                  }\n                }\n                if (bestItem) {\n                  initialMatches.set(item.id, bestItem);\n                }\n              }\n            }\n            \n            if (!initialMatches.has(item.id)) {\n              initialMatches.set(item.id, bestMatch);\n            }\n          }\n        });\n        \n        setItemPONumbers(initialPONumbers);\n        setItemMatches(initialMatches);\n        \n        // Case 1: ê³µí†µ ë°œì£¼ë²ˆí˜¸ ì„¤ì •\n        const firstPO = result.data.items.find(i => i.extracted_po_number)?.extracted_po_number;\n        if (firstPO) {\n          setSelectedPONumber(normalizeOrderNumber(firstPO));\n        }\n        \n        // ì„¸íŠ¸ ë§¤ì¹­ ì‹¤í–‰ (Case 1: ëª¨ë“  í’ˆëª©ì´ ê°™ì€ ë°œì£¼ë²ˆí˜¸ì¼ ë•Œ)\n        // ë°œì£¼ë²ˆí˜¸ê°€ ë™ì¼í•œì§€ í™•ì¸\n        const poNumbers = result.data.items\n          .map(item => item.extracted_po_number ? normalizeOrderNumber(item.extracted_po_number) : null)\n          .filter(Boolean);\n        const allSamePO = poNumbers.length === 0 || poNumbers.every(po => po === poNumbers[0]);\n        \n        if (allSamePO) {\n          // ì„¸íŠ¸ ë§¤ì¹­ í˜¸ì¶œ - ì „ì²´ í’ˆëª© ë¹„êµ (ê±°ë˜ì²˜ í•„í„°ë§ í¬í•¨)\n          const setMatchResponse = await transactionStatementService.findBestMatchingPurchaseOrderSet(\n            result.data.items,\n            firstPO,\n            result.data.vendor_name // ê±°ë˜ì²˜ëª… ì „ë‹¬\n          );\n          \n          if (setMatchResponse.success && setMatchResponse.data) {\n            setSetMatchResult(setMatchResponse.data);\n            \n            // ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ë¡œ ìµœì  ë°œì£¼ë²ˆí˜¸ ìë™ ì„ íƒ\n            if (setMatchResponse.data.bestMatch) {\n              const bestPO = setMatchResponse.data.bestMatch.purchase_order_number || \n                            setMatchResponse.data.bestMatch.sales_order_number || '';\n              setSelectedPONumber(bestPO);\n              \n              // ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ë¡œ í’ˆëª©ë“¤ ìë™ ë§¤ì¹­\n              const autoMatchedItems = new Map<string, SystemPurchaseItem | null>();\n              \n              setMatchResponse.data.bestMatch.itemMatches.forEach(match => {\n                // í•´ë‹¹ ì‹œìŠ¤í…œ í’ˆëª© ì •ë³´ ì°¾ê¸°\n                for (const item of result.data!.items) {\n                  const candidate = item.match_candidates?.find(c => c.item_id === match.systemItemId);\n                  if (candidate) {\n                    autoMatchedItems.set(match.ocrItemId, {\n                      purchase_id: candidate.purchase_id,\n                      item_id: candidate.item_id,\n                      purchase_order_number: candidate.purchase_order_number || '',\n                      sales_order_number: candidate.sales_order_number,\n                      item_name: candidate.item_name,\n                      specification: candidate.specification,\n                      quantity: candidate.quantity,\n                      unit_price: candidate.unit_price,\n                      amount: (candidate as any).amount,\n                      vendor_name: candidate.vendor_name\n                    });\n                    break;\n                  }\n                }\n              });\n              \n              // ê¸°ì¡´ ë§¤ì¹­ì— ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ ë³‘í•© (ì„¸íŠ¸ ë§¤ì¹­ ìš°ì„ )\n              const mergedMatches = new Map(initialMatches);\n              autoMatchedItems.forEach((value, key) => {\n                if (value) mergedMatches.set(key, value);\n              });\n              setItemMatches(mergedMatches);\n              \n              // ì„¸íŠ¸ ë§¤ì¹­ ì„±ê³µ ì•Œë¦¼\n              const confidence = setMatchResponse.data.bestMatch.confidence;\n              const confText = confidence === 'high' ? 'ë†’ìŒ' : confidence === 'medium' ? 'ë³´í†µ' : 'ë‚®ìŒ';\n              toast.success(\n                `ì„¸íŠ¸ ë§¤ì¹­ ì™„ë£Œ! ${setMatchResponse.data.bestMatch.matchedItemCount}/${result.data.items.length}ê°œ í’ˆëª© ë§¤ì¹­ (ì‹ ë¢°ë„: ${confText})`\n              );\n            }\n          }\n        }\n      } else {\n        toast.error(result.error || 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      toast.error('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    } finally {\n      setLoading(false);\n    }\n  }, [statement.id, supabase]);\n\n  useEffect(() => {\n    if (isOpen && statement) {\n      setManuallySelectedPO(false); // ëª¨ë‹¬ ì—´ë¦´ ë•Œ ìˆ˜ë™ ì„ íƒ í”Œë˜ê·¸ ë¦¬ì…‹\n      loadData();\n    }\n  }, [isOpen, statement, loadData]);\n\n  // ë°œì£¼ë²ˆí˜¸ ë³€ê²½ ì‹œ itemMatches ìë™ ë™ê¸°í™” + ë§¤ì¹­ëœ ì‹œìŠ¤í…œ ë°œì£¼ë²ˆí˜¸ë¡œ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    if (!statementWithItems || !isOpen) return;\n    \n    // ì•„ì§ ì´ˆê¸° ë¡œë“œ ì¤‘ì´ë©´ ìŠ¤í‚µ\n    if (loading) return;\n    \n    const newMatches = new Map<string, SystemPurchaseItem | null>();\n    const newPONumbers = new Map<string, string>(itemPONumbers);\n    let hasMatchChanges = false;\n    let hasPOChanges = false;\n    \n    statementWithItems.items.forEach(ocrItem => {\n      const currentMatch = itemMatches.get(ocrItem.id);\n      \n      // í˜„ì¬ ì ìš©í•´ì•¼ í•  ë°œì£¼ë²ˆí˜¸\n      const poNumber = isSamePONumber \n        ? selectedPONumber \n        : (itemPONumbers.get(ocrItem.id) || (ocrItem.extracted_po_number ? normalizeOrderNumber(ocrItem.extracted_po_number) : ''));\n      \n      // í˜„ì¬ ë§¤ì¹­ì´ ìˆê³  ë°œì£¼ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ë©´ ìœ ì§€\n      if (currentMatch && (currentMatch.purchase_order_number === poNumber || currentMatch.sales_order_number === poNumber)) {\n        newMatches.set(ocrItem.id, currentMatch);\n        return;\n      }\n      \n      // ìƒˆë¡œìš´ ë§¤ì¹­ ì°¾ê¸°\n      let bestMatch: SystemPurchaseItem | null = null;\n      let bestScore = -1;\n      \n      // í•´ë‹¹ ë°œì£¼ë²ˆí˜¸ í›„ë³´ì—ì„œ ê²€ìƒ‰\n      const matchingCandidates = poNumber \n        ? ocrItem.match_candidates?.filter(c => \n            c.purchase_order_number === poNumber || c.sales_order_number === poNumber\n          ) || []\n        : [];\n      \n      for (const c of matchingCandidates) {\n        const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', c.item_name, c.specification);\n        if (score > bestScore) {\n          bestScore = score;\n          bestMatch = {\n            purchase_id: c.purchase_id,\n            item_id: c.item_id,\n            purchase_order_number: c.purchase_order_number || '',\n            sales_order_number: c.sales_order_number,\n            item_name: c.item_name,\n            specification: c.specification,\n            quantity: c.quantity,\n            unit_price: c.unit_price,\n            amount: (c as any).amount,\n            vendor_name: c.vendor_name\n          };\n        }\n      }\n      \n      // ëª» ì°¾ìœ¼ë©´ ì „ì²´ í›„ë³´ì—ì„œ ê²€ìƒ‰ (fallback)\n      if (!bestMatch && ocrItem.match_candidates) {\n        for (const c of ocrItem.match_candidates) {\n          const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', c.item_name, c.specification);\n          if (score > bestScore && score >= 40) { // ìµœì†Œ 40ì  ì´ìƒ\n            bestScore = score;\n            bestMatch = {\n              purchase_id: c.purchase_id,\n              item_id: c.item_id,\n              purchase_order_number: c.purchase_order_number || '',\n              sales_order_number: c.sales_order_number,\n              item_name: c.item_name,\n              specification: c.specification,\n              quantity: c.quantity,\n              unit_price: c.unit_price,\n              amount: (c as any).amount,\n              vendor_name: c.vendor_name\n            };\n          }\n        }\n      }\n      \n      newMatches.set(ocrItem.id, bestMatch);\n      \n      // ë§¤ì¹­ëœ ì‹œìŠ¤í…œ í’ˆëª©ì˜ ë°œì£¼ë²ˆí˜¸ë¡œ í‘œì‹œ ë²ˆí˜¸ ì—…ë°ì´íŠ¸ (OCR ì˜¤ë¥˜ ìˆ˜ì •)\n      if (bestMatch) {\n        const matchedPO = bestMatch.purchase_order_number || bestMatch.sales_order_number || '';\n        const currentDisplayPO = itemPONumbers.get(ocrItem.id) || '';\n        \n        // í˜„ì¬ í‘œì‹œ ë²ˆí˜¸ì™€ ë‹¤ë¥´ë©´ ì‹œìŠ¤í…œ ë²ˆí˜¸ë¡œ ì—…ë°ì´íŠ¸\n        if (matchedPO && matchedPO !== currentDisplayPO) {\n          newPONumbers.set(ocrItem.id, matchedPO);\n          hasPOChanges = true;\n        }\n      }\n      \n      // ë³€ê²½ ê°ì§€\n      if (currentMatch !== bestMatch) {\n        hasMatchChanges = true;\n      }\n    });\n    \n    // ë³€ê²½ì´ ìˆì„ ë•Œë§Œ ìƒíƒœ ì—…ë°ì´íŠ¸ (ë¬´í•œ ë£¨í”„ ë°©ì§€)\n    if (hasMatchChanges) {\n      setItemMatches(newMatches);\n    }\n    \n    // ë°œì£¼ë²ˆí˜¸ í‘œì‹œë„ ì‹œìŠ¤í…œ ê²ƒìœ¼ë¡œ ì—…ë°ì´íŠ¸\n    if (hasPOChanges) {\n      setItemPONumbers(newPONumbers);\n    }\n  }, [selectedPONumber, isSamePONumber, statementWithItems, isOpen, loading]);\n\n  // ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ í›„ë³´ ëª©ë¡ (ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ + ê¸°ì¡´ í›„ë³´)\n  // - ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ê°€ ìˆìœ¼ë©´ ì ìˆ˜ í¬í•¨í•˜ì—¬ ì •ë ¬\n  // - OCRì—ì„œ Fë¡œ ì‹œì‘í•˜ëŠ” ë²ˆí˜¸ ì¶”ì¶œ â†’ ë°œì£¼ë²ˆí˜¸ë§Œ í‘œì‹œ\n  // - OCRì—ì„œ HSë¡œ ì‹œì‘í•˜ëŠ” ë²ˆí˜¸ ì¶”ì¶œ â†’ ìˆ˜ì£¼ë²ˆí˜¸ë§Œ í‘œì‹œ\n  // - OCRì—ì„œ ë²ˆí˜¸ ì—†ìŒ â†’ ë°œì£¼ë²ˆí˜¸ ê¸°ë³¸ê°’\n  const allPONumberCandidates = useMemo(() => {\n    if (!statementWithItems) return [];\n    \n    // ì²« ë²ˆì§¸ OCR ì¶”ì¶œ ë²ˆí˜¸ë¡œ íƒ€ì… ê²°ì • (F vs HS)\n    const firstExtracted = statementWithItems.items.find(i => i.extracted_po_number)?.extracted_po_number || '';\n    const normalizedFirst = firstExtracted ? normalizeOrderNumber(firstExtracted).toUpperCase() : '';\n    const useSONumber = normalizedFirst.startsWith('HS');\n    \n    type CandidateMapValue = {\n      poNumber: string;\n      salesOrderNumber?: string;\n      itemCount: number;\n      items: MatchCandidate[];\n      vendorName?: string;\n      setMatchScore?: number; // ì„¸íŠ¸ ë§¤ì¹­ ì ìˆ˜ (ì •ë ¬ìš©, ë°œì£¼ë²ˆí˜¸ ë³´ë„ˆìŠ¤ í¬í•¨)\n      displayScore?: number; // í‘œì‹œìš© ì ìˆ˜ (ì‹¤ì œ í’ˆëª© ìœ ì‚¬ë„, ìµœëŒ€ 100%)\n      matchedItemCount?: number;\n      purchaseId?: number; // ë°œì£¼ ìƒì„¸ ëª¨ë‹¬ìš©\n      quantityMatchedCount?: number; // ìˆ˜ëŸ‰ ì¼ì¹˜ í’ˆëª© ìˆ˜\n      quantityMismatchedCount?: number; // ìˆ˜ëŸ‰ ë¶ˆì¼ì¹˜ í’ˆëª© ìˆ˜\n    };\n    \n    const candidateMap = new Map<string, CandidateMapValue>();\n    \n    // 1. ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ê°€ ìˆìœ¼ë©´ ë¨¼ì € ì¶”ê°€ (ì ìˆ˜ í¬í•¨)\n    if (setMatchResult?.candidates) {\n      setMatchResult.candidates.forEach(candidate => {\n        const key = useSONumber \n          ? (candidate.sales_order_number || candidate.purchase_order_number)\n          : candidate.purchase_order_number;\n        \n        if (key) {\n          candidateMap.set(key, {\n            poNumber: candidate.purchase_order_number || '',\n            salesOrderNumber: candidate.sales_order_number,\n            itemCount: candidate.matchedItemCount,\n            items: [] as MatchCandidate[],\n            vendorName: candidate.vendor_name,\n            setMatchScore: candidate.matchScore,\n            matchedItemCount: candidate.matchedItemCount,\n            purchaseId: candidate.purchase_id\n          });\n        }\n      });\n    }\n    \n    // 2. ê¸°ì¡´ ê°œë³„ ë§¤ì¹­ í›„ë³´ë„ ì¶”ê°€ (ì„¸íŠ¸ ë§¤ì¹­ì— ì—†ëŠ” ê²ƒë§Œ)\n    statementWithItems.items.forEach(item => {\n      item.match_candidates?.forEach(candidate => {\n        const key = useSONumber \n          ? (candidate.sales_order_number || '') \n          : (candidate.purchase_order_number || '');\n        \n        if (key && !candidateMap.has(key)) {\n          candidateMap.set(key, {\n            poNumber: candidate.purchase_order_number || '',\n            salesOrderNumber: candidate.sales_order_number,\n            itemCount: 0,\n            items: [] as MatchCandidate[],\n            vendorName: candidate.vendor_name,\n            purchaseId: candidate.purchase_id\n          });\n        }\n        \n        if (key && candidateMap.has(key)) {\n          const existing = candidateMap.get(key)!;\n          existing.items.push(candidate);\n          if (!existing.setMatchScore) {\n            existing.itemCount = existing.items.length;\n          }\n        }\n      });\n    });\n    \n    // 2.6. PO ì•„ì´í…œ ë§µ ê¸°ë°˜ í›„ë³´ ì¶”ê°€ (ë§¤ì¹­ í›„ë³´ê°€ ë¹„ì–´ìˆì–´ë„ í‘œì‹œ)\n    if (poItemsMap.size > 0) {\n      poItemsMap.forEach((items, key) => {\n        const normalizedKey = normalizeOrderNumber(key);\n        const isSO = normalizedKey.startsWith('HS');\n        if (useSONumber && !isSO) return;\n        if (!useSONumber && isSO) return;\n        \n        if (!candidateMap.has(normalizedKey)) {\n          candidateMap.set(normalizedKey, {\n            poNumber: isSO ? '' : normalizedKey,\n            salesOrderNumber: isSO ? normalizedKey : undefined,\n            itemCount: items.length,\n            items: items.map((item): MatchCandidate => ({\n              purchase_id: item.purchase_id,\n              purchase_order_number: item.purchase_order_number || '',\n              sales_order_number: item.sales_order_number,\n              item_id: item.item_id,\n              item_name: item.item_name,\n              specification: item.specification,\n              quantity: item.quantity ?? 0,\n              unit_price: item.unit_price,\n              vendor_name: item.vendor_name,\n              score: 0,\n              match_reasons: ['po_items_map']\n            })),\n            vendorName: items[0]?.vendor_name,\n            purchaseId: items[0]?.purchase_id\n          });\n        }\n      });\n    }\n    \n    // 2.5. ì„¸íŠ¸ ë§¤ì¹­ ì ìˆ˜ê°€ ì—†ëŠ” í›„ë³´ë“¤ì— ëŒ€í•´ ê°œë³„ í’ˆëª© ìœ ì‚¬ë„ í‰ê·  ê³„ì‚° + ìˆ˜ëŸ‰ ì¼ì¹˜ ì—¬ë¶€\n    candidateMap.forEach((candidate: CandidateMapValue, key) => {\n      // ê° OCR í’ˆëª©ê³¼ í•´ë‹¹ ë°œì£¼ì˜ í’ˆëª© ê°„ ìµœëŒ€ ìœ ì‚¬ë„ ê³„ì‚° + ìˆ˜ëŸ‰ ì¼ì¹˜ í™•ì¸\n      let totalScore = 0;\n      let matchedCount = 0;\n      let quantityMatchedCount = 0;\n      let quantityMismatchedCount = 0;\n      const normalizedKey = normalizeOrderNumber(key).toUpperCase();\n      const extractedOrderNumbers = statementWithItems.items\n        .map(item => {\n          const value = getOCRItemValue(item, 'po_number') as string;\n          return value ? normalizeOrderNumber(value).toUpperCase() : null;\n        })\n        .filter(Boolean) as string[];\n      const hasOrderNumberMatch = extractedOrderNumbers.some(num => num === normalizedKey);\n      \n      const candidateItems = candidate.items as MatchCandidate[];\n      \n      statementWithItems.items.forEach(ocrItem => {\n        // í•´ë‹¹ ë°œì£¼ì˜ í’ˆëª©ë“¤ ì¤‘ ê°€ì¥ ìœ ì‚¬í•œ ê²ƒ ì°¾ê¸°\n        let bestScore = 0;\n        let bestMatchItem: MatchCandidate | null = null;\n        const ocrItemName = getOCRItemValue(ocrItem, 'item_name') as string;\n        \n        for (const sysItem of candidateItems) {\n          const item: MatchCandidate = sysItem;\n          const score = calculateItemSimilarity(\n            ocrItemName || '', \n            item.item_name, \n            item.specification\n          );\n          if (score > bestScore) {\n            bestScore = score;\n            bestMatchItem = item;\n          }\n        }\n        \n        if (bestScore >= 40 && bestMatchItem !== null) {\n          matchedCount++;\n          \n          // ìˆ˜ëŸ‰ ì¼ì¹˜ ì—¬ë¶€ í™•ì¸\n          const ocrQtyRaw = getOCRItemValue(ocrItem, 'quantity');\n          const ocrQty = typeof ocrQtyRaw === 'number'\n            ? ocrQtyRaw\n            : (ocrQtyRaw !== '' ? Number(ocrQtyRaw) : undefined);\n          const matchItem: MatchCandidate = bestMatchItem as MatchCandidate;\n          const sysQty: number = matchItem.quantity;\n          if (ocrQty !== undefined && !Number.isNaN(ocrQty) && isQuantityMatched(ocrQty, sysQty)) {\n            quantityMatchedCount++;\n          } else {\n            quantityMismatchedCount++;\n          }\n        }\n        totalScore += bestScore;\n      });\n      \n      // í‰ê·  ì ìˆ˜ ê³„ì‚° (ìˆ˜ëŸ‰ ì¼ì¹˜ ë³´ë„ˆìŠ¤ í¬í•¨)\n      const baseScore = statementWithItems.items.length > 0 \n        ? Math.round(totalScore / statementWithItems.items.length)\n        : 0;\n      \n      // ìˆ˜ëŸ‰ ì¼ì¹˜ ë³´ë„ˆìŠ¤: ëª¨ë“  ë§¤ì¹­ í’ˆëª©ì˜ ìˆ˜ëŸ‰ì´ ì¼ì¹˜í•˜ë©´ +10ì \n      const quantityBonus = (matchedCount > 0 && quantityMatchedCount === matchedCount) ? 10 : 0;\n      \n      // ì‹¤ì œ í’ˆëª© ìœ ì‚¬ë„ ì ìˆ˜ (ìµœëŒ€ 100%)\n      const actualScore = Math.min(100, baseScore + quantityBonus);\n      \n      // ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜ëŠ” ê°€ì¥ ë†’ì€ ìš°ì„ ìˆœìœ„ (ì •ë ¬ìš© ë³´ë„ˆìŠ¤)\n      const orderNumberBonus = hasOrderNumberMatch ? 100 : 0;\n      \n      if (candidate.setMatchScore === undefined) {\n        candidate.setMatchScore = actualScore + orderNumberBonus; // ì •ë ¬ìš©\n        candidate.displayScore = actualScore; // í‘œì‹œìš© (ì‹¤ì œ ìœ ì‚¬ë„)\n        candidate.matchedItemCount = matchedCount;\n      } else if (hasOrderNumberMatch) {\n        // ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ê°€ ìˆì–´ë„ ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜ ë³´ë„ˆìŠ¤ ì¶”ê°€\n        candidate.setMatchScore = (candidate.setMatchScore ?? 0) + orderNumberBonus;\n        // displayScoreëŠ” ì›ë˜ ê°’ ìœ ì§€ (ì—†ìœ¼ë©´ setMatchScore ì‚¬ìš©)\n        if (candidate.displayScore === undefined) {\n          candidate.displayScore = candidate.setMatchScore - orderNumberBonus;\n        }\n      }\n      \n      candidate.quantityMatchedCount = quantityMatchedCount;\n      candidate.quantityMismatchedCount = quantityMismatchedCount;\n      (candidate as any).hasOrderNumberMatch = hasOrderNumberMatch;\n    });\n    \n    // 3. ì •ë ¬: ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜ ì—¬ë¶€ ë¨¼ì €, ê·¸ ë‹¤ìŒ ì ìˆ˜ìˆœ\n    const result = Array.from(candidateMap.values());\n    \n    \n    result.sort((a, b) => {\n      // ë¨¼ì € ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜ ì—¬ë¶€ë¡œ ì •ë ¬ (ì¼ì¹˜í•˜ëŠ” ê²ƒì´ ë§¨ ìœ„)\n      const aHasMatch = (a as any).hasOrderNumberMatch ? 1 : 0;\n      const bHasMatch = (b as any).hasOrderNumberMatch ? 1 : 0;\n      if (aHasMatch !== bHasMatch) {\n        return bHasMatch - aHasMatch;\n      }\n      \n      // ê·¸ ë‹¤ìŒ ì ìˆ˜ìˆœ\n      const scoreA = a.setMatchScore ?? 0;\n      const scoreB = b.setMatchScore ?? 0;\n      if (scoreA !== scoreB) {\n        return scoreB - scoreA;\n      }\n      return b.itemCount - a.itemCount;\n    });\n    \n    return result;\n  }, [statementWithItems, setMatchResult, poItemsMap, editedOCRItems]);\n\n  const getPairedOrderNumber = useCallback((value?: string | null): string | undefined => {\n    if (!value) return undefined;\n    const normalizedValue = normalizeOrderNumber(value);\n    const candidate = allPONumberCandidates.find(\n      c =>\n        c.poNumber === normalizedValue ||\n        c.salesOrderNumber === normalizedValue ||\n        c.poNumber === value ||\n        c.salesOrderNumber === value\n    );\n    if (candidate) {\n      if (normalizedValue.startsWith('F')) return candidate.salesOrderNumber;\n      if (normalizedValue.startsWith('HS')) return candidate.poNumber;\n      return candidate.salesOrderNumber || candidate.poNumber;\n    }\n    const items = poItemsMap.get(normalizedValue) || poItemsMap.get(value) || [];\n    if (items.length > 0) {\n      const item = items[0];\n      if (normalizedValue.startsWith('F')) return item.sales_order_number;\n      if (normalizedValue.startsWith('HS')) return item.purchase_order_number || item.purchase_order_number;\n      return item.sales_order_number || item.purchase_order_number;\n    }\n    return undefined;\n  }, [allPONumberCandidates, poItemsMap]);\n\n  const getPairedOrderNumberWithOverrides = (value?: string | null): string | undefined => {\n    if (!value) return undefined;\n    const normalized = normalizeOrderNumber(value);\n    const override = poPairOverrides.get(normalized);\n    if (override !== undefined) {\n      return override || undefined;\n    }\n    return getPairedOrderNumber(value);\n  };\n\n  // ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜í•˜ëŠ” í›„ë³´ë¥¼ ìµœìš°ì„  ì„ íƒ, ì—†ìœ¼ë©´ ì²« ë²ˆì§¸ í›„ë³´ë¡œ ìë™ ë³€ê²½\n  // (ë‹¨, ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ì„ íƒí•œ ê²½ìš°ëŠ” ê±´ë„ˆëœ€)\n  useEffect(() => {\n    if (!allPONumberCandidates.length || !isSamePONumber) return;\n\n    // ì‚¬ìš©ìê°€ ìˆ˜ë™ìœ¼ë¡œ ë°œì£¼ë²ˆí˜¸ë¥¼ ì„ íƒí•œ ê²½ìš° ìë™ êµì • ê±´ë„ˆëœ€\n    if (manuallySelectedPO) return;\n\n    // ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜í•˜ëŠ” í›„ë³´ ì°¾ê¸° (hasOrderNumberMatchê°€ trueì¸ ê²ƒ)\n    const matchingCandidate = allPONumberCandidates.find(\n      c => (c as any).hasOrderNumberMatch === true\n    );\n\n    if (matchingCandidate) {\n      const matchingPO = matchingCandidate.poNumber || matchingCandidate.salesOrderNumber || '';\n      // í˜„ì¬ ì„ íƒëœ ê²ƒê³¼ ë‹¤ë¥´ë©´ ë³€ê²½\n      if (matchingPO && matchingPO !== selectedPONumber) {\n        console.log(`[ìë™ ì„ íƒ] ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜ í›„ë³´ \"${matchingPO}\"ë¡œ ìë™ ì„ íƒ`);\n        setSelectedPONumber(matchingPO);\n        return;\n      }\n    }\n\n    // ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜ í›„ë³´ê°€ ì—†ìœ¼ë©´, í˜„ì¬ ì„ íƒì´ í›„ë³´ ëª©ë¡ì— ìˆëŠ”ì§€ í™•ì¸\n    const isInCandidates = allPONumberCandidates.some(\n      c => c.poNumber === selectedPONumber || c.salesOrderNumber === selectedPONumber\n    );\n\n    // í›„ë³´ ëª©ë¡ì— ì—†ìœ¼ë©´ ì²« ë²ˆì§¸ í›„ë³´ë¡œ ìë™ ë³€ê²½\n    if (!isInCandidates && allPONumberCandidates[0]) {\n      const firstCandidate = allPONumberCandidates[0];\n      const newPO = firstCandidate.poNumber || firstCandidate.salesOrderNumber || '';\n      if (newPO) {\n        console.log(`[ìë™ ìˆ˜ì •] OCR ë°œì£¼ë²ˆí˜¸ \"${selectedPONumber}\"ê°€ DBì— ì—†ìŒ â†’ ì¶”ì²œ ë°œì£¼ \"${newPO}\"ë¡œ ë³€ê²½`);\n        setSelectedPONumber(newPO);\n      }\n    }\n  }, [allPONumberCandidates, selectedPONumber, isSamePONumber, manuallySelectedPO]);\n\n  // íŠ¹ì • ë°œì£¼ë²ˆí˜¸ì— í•´ë‹¹í•˜ëŠ” ì‹œìŠ¤í…œ í’ˆëª©ë“¤\n  const getSystemItemsForPO = useCallback((poNumber: string): SystemPurchaseItem[] => {\n    if (!statementWithItems || !poNumber) return [];\n    const mappedItems = poItemsMap.get(poNumber) || [];\n    if (mappedItems.length > 0) {\n      const deduped = mappedItems.filter((item, index, self) => \n        index === self.findIndex(t => t.item_id === item.item_id)\n      );\n      return deduped;\n    }\n    \n    const items: SystemPurchaseItem[] = [];\n    \n    statementWithItems.items.forEach(item => {\n      item.match_candidates?.forEach(candidate => {\n        if (candidate.purchase_order_number === poNumber || \n            candidate.sales_order_number === poNumber) {\n          items.push({\n            purchase_id: candidate.purchase_id,\n            item_id: candidate.item_id,\n            purchase_order_number: candidate.purchase_order_number || '',\n            sales_order_number: candidate.sales_order_number,\n            item_name: candidate.item_name,\n            specification: candidate.specification,\n            quantity: candidate.quantity,\n            unit_price: candidate.unit_price,\n            amount: (candidate as any).amount, // amountëŠ” ì¼ë¶€ í›„ë³´ì—ë§Œ ì¡´ì¬\n            vendor_name: candidate.vendor_name\n          });\n        }\n      });\n    });\n    \n    // ì¤‘ë³µ ì œê±°\n    const deduped = items.filter((item, index, self) => \n      index === self.findIndex(t => t.item_id === item.item_id)\n    );\n    return deduped;\n  }, [statementWithItems, poItemsMap]);\n\n  // íŠ¹ì • OCR í’ˆëª©ì— ëŒ€í•œ ë°œì£¼ë²ˆí˜¸ í›„ë³´ ëª©ë¡ (ì‹œìŠ¤í…œ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê°€ì ¸ì˜¨ ê²ƒë§Œ)\n  // - OCRì—ì„œ Fë¡œ ì‹œì‘í•˜ëŠ” ë²ˆí˜¸ ì¶”ì¶œ â†’ ë°œì£¼ë²ˆí˜¸(purchase_order_number)ë§Œ í‘œì‹œ\n  // - OCRì—ì„œ HSë¡œ ì‹œì‘í•˜ëŠ” ë²ˆí˜¸ ì¶”ì¶œ â†’ ìˆ˜ì£¼ë²ˆí˜¸(sales_order_number)ë§Œ í‘œì‹œ\n  // - OCRì—ì„œ ë²ˆí˜¸ ì—†ìŒ â†’ ë°œì£¼ë²ˆí˜¸(purchase_order_number) ê¸°ë³¸ê°’\n  const getPOCandidatesForItem = useCallback((ocrItemId: string): string[] => {\n    if (!statementWithItems) return [];\n    \n    const item = statementWithItems.items.find(i => i.id === ocrItemId);\n    if (!item) return [];\n    \n    const poNumbers = new Set<string>();\n    \n    // OCR ì¶”ì¶œ ë²ˆí˜¸ ì •ê·œí™”\n    const extractedNumber = item.extracted_po_number \n      ? normalizeOrderNumber(item.extracted_po_number).toUpperCase() \n      : '';\n    \n    // ì¶”ì¶œëœ ë²ˆí˜¸ê°€ HSë¡œ ì‹œì‘í•˜ë©´ ìˆ˜ì£¼ë²ˆí˜¸, ê·¸ ì™¸(F ë˜ëŠ” ì—†ìŒ)ëŠ” ë°œì£¼ë²ˆí˜¸\n    const useSONumber = extractedNumber.startsWith('HS');\n    \n    // ë§¤ì¹­ í›„ë³´ë“¤ì—ì„œ ì ì ˆí•œ ë²ˆí˜¸ë§Œ ì¶”ê°€\n    item.match_candidates?.forEach(c => {\n      if (useSONumber) {\n        // ìˆ˜ì£¼ë²ˆí˜¸ë§Œ ì¶”ê°€\n        if (c.sales_order_number) poNumbers.add(c.sales_order_number);\n      } else {\n        // ë°œì£¼ë²ˆí˜¸ë§Œ ì¶”ê°€ (ê¸°ë³¸ê°’)\n        if (c.purchase_order_number) poNumbers.add(c.purchase_order_number);\n      }\n    });\n    const result = Array.from(poNumbers);\n    return result;\n  }, [statementWithItems]);\n\n  // OCR í’ˆëª© í¸ì§‘ í•¨ìˆ˜\n  const handleEditOCRItem = (itemId: string, field: keyof EditedOCRItem, value: string | number) => {\n    setEditedOCRItems(prev => {\n      const newMap = new Map(prev);\n      const existing = newMap.get(itemId) || {};\n      newMap.set(itemId, { ...existing, [field]: value });\n      return newMap;\n    });\n  };\n\n  // OCR í’ˆëª©ì˜ í˜„ì¬ ê°’ ê°€ì ¸ì˜¤ê¸° (ìˆ˜ì •ëœ ê°’ ìš°ì„ )\n  function getOCRItemValue(\n    ocrItem: TransactionStatementItemWithMatch,\n    field: 'item_name' | 'quantity' | 'unit_price' | 'amount' | 'po_number'\n  ) {\n    const edited = editedOCRItems.get(ocrItem.id);\n    if (edited && edited[field] !== undefined) {\n      return edited[field];\n    }\n\n    switch (field) {\n      case 'item_name':\n        return ocrItem.extracted_item_name || '';\n      case 'quantity':\n        return ocrItem.extracted_quantity ?? '';\n      case 'unit_price':\n        return ocrItem.extracted_unit_price ?? '';\n      case 'amount':\n        return ocrItem.extracted_amount ?? '';\n      case 'po_number':\n        return itemPONumbers.get(ocrItem.id) ||\n          (ocrItem.extracted_po_number ? normalizeOrderNumber(ocrItem.extracted_po_number) : '');\n      default:\n        return '';\n    }\n  }\n\n  // ìˆ˜ì • ì—¬ë¶€ í™•ì¸ (ì›ë³¸ê³¼ ë‹¤ë¥¸ì§€)\n  const isOCRItemEdited = (ocrItem: TransactionStatementItemWithMatch, field: 'item_name' | 'quantity' | 'unit_price' | 'amount' | 'po_number'): boolean => {\n    const edited = editedOCRItems.get(ocrItem.id);\n    if (!edited || edited[field] === undefined) return false;\n    \n    switch (field) {\n      case 'item_name': return edited.item_name !== ocrItem.extracted_item_name;\n      case 'quantity': return edited.quantity !== ocrItem.extracted_quantity;\n      case 'unit_price': return edited.unit_price !== ocrItem.extracted_unit_price;\n      case 'amount': return edited.amount !== ocrItem.extracted_amount;\n      case 'po_number': {\n        const original = ocrItem.extracted_po_number ? normalizeOrderNumber(ocrItem.extracted_po_number) : '';\n        return edited.po_number !== original;\n      }\n      default: return false;\n    }\n  };\n\n  // í•™ìŠµ ë°ì´í„° ì €ì¥ (í™•ì • ì‹œ í˜¸ì¶œ)\n  const saveOCRCorrections = async () => {\n    if (!statementWithItems) return;\n    \n    const corrections: Array<{\n      statement_id: string;\n      statement_item_id: string;\n      original_text: string;\n      corrected_text: string;\n      field_type: OCRFieldType;\n    }> = [];\n    \n    statementWithItems.items.forEach(ocrItem => {\n      const edited = editedOCRItems.get(ocrItem.id);\n      if (!edited) return;\n      \n      // ê° í•„ë“œë³„ë¡œ ìˆ˜ì • ì‚¬í•­ í™•ì¸\n      if (edited.item_name !== undefined && edited.item_name !== ocrItem.extracted_item_name) {\n        corrections.push({\n          statement_id: statementWithItems.id,\n          statement_item_id: ocrItem.id,\n          original_text: ocrItem.extracted_item_name || '',\n          corrected_text: edited.item_name,\n          field_type: 'item_name'\n        });\n      }\n      \n      if (edited.quantity !== undefined && edited.quantity !== ocrItem.extracted_quantity) {\n        corrections.push({\n          statement_id: statementWithItems.id,\n          statement_item_id: ocrItem.id,\n          original_text: String(ocrItem.extracted_quantity ?? ''),\n          corrected_text: String(edited.quantity),\n          field_type: 'quantity'\n        });\n      }\n      \n      if (edited.unit_price !== undefined && edited.unit_price !== ocrItem.extracted_unit_price) {\n        corrections.push({\n          statement_id: statementWithItems.id,\n          statement_item_id: ocrItem.id,\n          original_text: String(ocrItem.extracted_unit_price ?? ''),\n          corrected_text: String(edited.unit_price),\n          field_type: 'unit_price'\n        });\n      }\n      \n      if (edited.amount !== undefined && edited.amount !== ocrItem.extracted_amount) {\n        corrections.push({\n          statement_id: statementWithItems.id,\n          statement_item_id: ocrItem.id,\n          original_text: String(ocrItem.extracted_amount ?? ''),\n          corrected_text: String(edited.amount),\n          field_type: 'amount'\n        });\n      }\n      \n      if (edited.po_number !== undefined) {\n        const original = ocrItem.extracted_po_number ? normalizeOrderNumber(ocrItem.extracted_po_number) : '';\n        if (edited.po_number !== original) {\n          corrections.push({\n            statement_id: statementWithItems.id,\n            statement_item_id: ocrItem.id,\n            original_text: original,\n            corrected_text: edited.po_number,\n            field_type: 'po_number'\n          });\n        }\n      }\n    });\n    \n    // í•™ìŠµ ë°ì´í„° ì €ì¥\n    if (corrections.length > 0) {\n      console.log(`ğŸ“š í•™ìŠµ ë°ì´í„° ì €ì¥: ${corrections.length}ê±´ì˜ ìˆ˜ì •ì‚¬í•­`);\n      for (const correction of corrections) {\n        await transactionStatementService.saveCorrection(correction);\n      }\n      toast.success(`${corrections.length}ê±´ì˜ OCR ìˆ˜ì •ì‚¬í•­ì´ í•™ìŠµ ë°ì´í„°ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.`);\n    }\n  };\n\n  // ë§¤ì¹­ ìƒíƒœ ê³„ì‚° (item_nameê³¼ specification êµì°¨ ë¹„êµ)\n  // itemMatchesì— ì—†ì–´ë„ í˜„ì¬ í‘œì‹œëœ ì‹œìŠ¤í…œ í’ˆëª©ìœ¼ë¡œ fallback\n  const getMatchStatus = (ocrItem: TransactionStatementItemWithMatch): 'high' | 'med' | 'low' | 'unmatched' => {\n    // 1. ë¨¼ì € itemMatchesì—ì„œ í™•ì¸\n    const matched = itemMatches.get(ocrItem.id);\n    \n    // 2. itemMatchesì— ì—†ìœ¼ë©´ í˜„ì¬ í‘œì‹œëœ ì‹œìŠ¤í…œ í’ˆëª©ì—ì„œ ì°¾ê¸°\n    let effectiveMatch: SystemPurchaseItem | null = matched || null;\n    let hasSystemItems = false;\n    \n    if (!effectiveMatch) {\n      const poNumber = isSamePONumber \n        ? selectedPONumber \n        : (itemPONumbers.get(ocrItem.id) || (ocrItem.extracted_po_number ? normalizeOrderNumber(ocrItem.extracted_po_number) : ''));\n      \n      if (poNumber) {\n        const systemItems = getSystemItemsForPO(poNumber);\n        hasSystemItems = systemItems.length > 0;\n        \n        // ê°€ì¥ ìœ ì‚¬í•œ í’ˆëª© ì°¾ê¸°\n        let bestScore = 0;\n        systemItems.forEach(sysItem => {\n          const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', sysItem.item_name, sysItem.specification);\n          if (score > bestScore) {\n            bestScore = score;\n            effectiveMatch = sysItem;\n          }\n        });\n      }\n    }\n    \n    if (!effectiveMatch) return 'unmatched';\n    \n    const similarity = calculateItemSimilarity(ocrItem.extracted_item_name || '', effectiveMatch.item_name || '', effectiveMatch.specification);\n    \n    // ë” ì—„ê²©í•œ ì„ê³„ê°’ ì ìš©\n    if (similarity >= 85) return 'high';   // ë†’ìŒ: 85% ì´ìƒ (ê¸°ì¡´ 80%)\n    if (similarity >= 60) return 'med';    // ë³´í†µ: 60% ì´ìƒ (ê¸°ì¡´ 50%)\n    if (similarity >= 40) return 'low';    // ë‚®ìŒ: 40% ì´ìƒ (ê¸°ì¡´ 30%)\n    \n    // 40% ë¯¸ë§Œì´ë©´ ë§¤ì¹­ ì•ˆë¨ìœ¼ë¡œ í‘œì‹œ (ê¸°ì¡´: ì‹œìŠ¤í…œ í’ˆëª© ìˆìœ¼ë©´ ë¬´ì¡°ê±´ 'low')\n    return 'unmatched';\n  };\n\n  // ë°œì£¼ë²ˆí˜¸ ì„ íƒ ì‹œ (Case 1: ì „ì²´ ì ìš©)\n  const handleSelectGlobalPO = async (poNumber: string, vendorNameFromSearch?: string, soNumberFromSearch?: string) => {\n    setSelectedPONumber(poNumber);\n\n    // ê²€ìƒ‰ì—ì„œ ìˆ˜ì£¼ë²ˆí˜¸ê°€ ì „ë‹¬ëœ ê²½ìš° í˜ì–´ ìºì‹œì— ì €ì¥\n    if (soNumberFromSearch) {\n      const normalizedPO = normalizeOrderNumber(poNumber);\n      setPoPairOverrides(prev => {\n        const next = new Map(prev);\n        next.set(normalizedPO, soNumberFromSearch);\n        return next;\n      });\n    }\n\n    // í•´ë‹¹ ë°œì£¼ë²ˆí˜¸ì˜ ì‹œìŠ¤í…œ í’ˆëª©ë“¤ ê°€ì ¸ì˜¤ê¸°\n    // 1. allPONumberCandidatesì—ì„œ í•´ë‹¹ ë°œì£¼ì˜ itemsì™€ purchaseId ì°¾ê¸°\n    const poCandidate = allPONumberCandidates.find(\n      c => c.poNumber === poNumber || c.salesOrderNumber === poNumber\n    );\n\n    // 2. items ë°°ì—´ì„ SystemPurchaseItem í˜•íƒœë¡œ ë³€í™˜\n    let systemItems: SystemPurchaseItem[] = [];\n    let vendorName = vendorNameFromSearch || '';\n\n    if (poCandidate && poCandidate.items.length > 0) {\n      systemItems = poCandidate.items.map(item => ({\n        purchase_id: item.purchase_id,\n        item_id: item.item_id,\n        purchase_order_number: item.purchase_order_number || '',\n        sales_order_number: item.sales_order_number,\n        item_name: item.item_name,\n        specification: item.specification,\n        quantity: item.quantity,\n        unit_price: item.unit_price,\n        amount: (item as any).amount,\n        vendor_name: item.vendor_name\n      }));\n\n      // ì¤‘ë³µ ì œê±°\n      systemItems = systemItems.filter((item, index, self) =>\n        index === self.findIndex(t => t.item_id === item.item_id)\n      );\n\n      // ê±°ë˜ì²˜ëª… ì¶”ì¶œ\n      if (!vendorName && systemItems[0]?.vendor_name) {\n        vendorName = systemItems[0].vendor_name;\n      }\n    }\n\n    // 3. ì—†ìœ¼ë©´ ê¸°ì¡´ ë°©ì‹ìœ¼ë¡œ fallback\n    if (systemItems.length === 0) {\n      systemItems = getSystemItemsForPO(poNumber);\n      if (!vendorName && systemItems[0]?.vendor_name) {\n        vendorName = systemItems[0].vendor_name;\n      }\n    }\n\n    // 4. ì—¬ì „íˆ ì—†ìœ¼ë©´ DBì—ì„œ ì§ì ‘ ì¡°íšŒ (ê²€ìƒ‰ì—ì„œ ì„ íƒí•œ ê²½ìš° í¬í•¨)\n    if (systemItems.length === 0) {\n      try {\n        // ë°œì£¼ë²ˆí˜¸ë¡œ purchase_request ë¨¼ì € ì°¾ê¸°\n        const { data: purchaseRequest } = await supabase\n          .from('purchase_requests')\n          .select(`\n            id,\n            purchase_order_number,\n            sales_order_number,\n            vendor:vendors(vendor_name)\n          `)\n          .or(`purchase_order_number.eq.${poNumber},sales_order_number.eq.${poNumber}`)\n          .limit(1)\n          .single();\n\n        if (purchaseRequest) {\n          // ê±°ë˜ì²˜ëª… ì„¤ì •\n          if (!vendorName && (purchaseRequest.vendor as any)?.vendor_name) {\n            vendorName = (purchaseRequest.vendor as any).vendor_name;\n          }\n\n          // ìˆ˜ì£¼ë²ˆí˜¸/ë°œì£¼ë²ˆí˜¸ í˜ì–´ ì €ì¥\n          const normalizedPO = normalizeOrderNumber(poNumber);\n          const pairedNumber = poNumber.startsWith('F')\n            ? purchaseRequest.sales_order_number\n            : purchaseRequest.purchase_order_number;\n          if (pairedNumber) {\n            setPoPairOverrides(prev => {\n              const next = new Map(prev);\n              next.set(normalizedPO, pairedNumber);\n              return next;\n            });\n          }\n\n          // í’ˆëª© ì¡°íšŒ\n          const { data: purchaseItems } = await supabase\n            .from('purchase_request_items')\n            .select(`\n              id,\n              item_name,\n              specification,\n              quantity,\n              received_quantity,\n              unit_price_value,\n              amount_value\n            `)\n            .eq('purchase_request_id', purchaseRequest.id);\n\n          if (purchaseItems && purchaseItems.length > 0) {\n            systemItems = purchaseItems.map((item: any) => ({\n              purchase_id: purchaseRequest.id,\n              item_id: item.id,\n              purchase_order_number: purchaseRequest.purchase_order_number || '',\n              sales_order_number: purchaseRequest.sales_order_number,\n              item_name: item.item_name || '',\n              specification: item.specification,\n              quantity: item.quantity,\n              received_quantity: item.received_quantity,\n              unit_price: item.unit_price_value,\n              amount: item.amount_value,\n              vendor_name: vendorName\n            }));\n            console.log('[handleSelectGlobalPO] DBì—ì„œ í’ˆëª© ì¡°íšŒ ì„±ê³µ:', systemItems.length);\n          }\n        }\n      } catch (error) {\n        console.error('[handleSelectGlobalPO] DB ì¡°íšŒ ì‹¤íŒ¨:', error);\n      }\n    }\n\n    console.log('[handleSelectGlobalPO] poNumber:', poNumber, 'systemItems:', systemItems.length, 'vendor:', vendorName);\n\n    // poItemsMapì— í’ˆëª© ì¶”ê°€ (UIì—ì„œ í›„ë³´ í‘œì‹œìš©)\n    if (systemItems.length > 0) {\n      setPoItemsMap(prev => {\n        const next = new Map(prev);\n        next.set(poNumber, systemItems);\n        // ìˆ˜ì£¼ë²ˆí˜¸ë¡œë„ ì €ì¥ (ì–‘ë°©í–¥ ì¡°íšŒ ê°€ëŠ¥í•˜ë„ë¡)\n        const salesOrderNumber = systemItems[0]?.sales_order_number;\n        if (salesOrderNumber && salesOrderNumber !== poNumber) {\n          next.set(salesOrderNumber, systemItems);\n        }\n        return next;\n      });\n    }\n\n    // ê±°ë˜ì²˜ëª… ì—…ë°ì´íŠ¸\n    if (vendorName) {\n      setVendorInputValue(vendorName);\n    }\n\n    // ìë™ ë§¤ì¹­ ìˆ˜í–‰\n    if (statementWithItems) {\n      const newMatches = new Map<string, SystemPurchaseItem | null>();\n\n      statementWithItems.items.forEach(ocrItem => {\n        // ê°€ì¥ ìœ ì‚¬í•œ ì‹œìŠ¤í…œ í’ˆëª© ì°¾ê¸° (item_nameê³¼ specification êµì°¨ ë¹„êµ)\n        let bestMatch: SystemPurchaseItem | null = null;\n        let bestScore = 0;\n\n        systemItems.forEach(sysItem => {\n          const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', sysItem.item_name, sysItem.specification);\n          if (score > bestScore && score >= 40) { // ìµœì†Œ 40ì  ì´ìƒ\n            bestScore = score;\n            bestMatch = sysItem;\n          }\n        });\n\n        newMatches.set(ocrItem.id, bestMatch);\n      });\n\n      setItemMatches(newMatches);\n    }\n  };\n\n  // ê±°ë˜ì²˜ ì¸ë¼ì¸ ê²€ìƒ‰ (debounce ì²˜ë¦¬ìš©)\n  const handleVendorSearch = async (searchValue: string) => {\n    if (!searchValue.trim()) {\n      setVendorSearchResults([]);\n      setVendorDropdownOpen(false);\n      return;\n    }\n    \n    setVendorSearchLoading(true);\n    setVendorDropdownOpen(true);\n    \n    try {\n      const { data: vendors, error } = await supabase\n        .from('vendors')\n        .select('id, vendor_name')\n        .ilike('vendor_name', `%${searchValue}%`)\n        .limit(10);\n      \n      if (error) throw error;\n      \n      setVendorSearchResults((vendors || []).map((vendor: VendorSearchRow) => ({\n        id: vendor.id,\n        name: vendor.vendor_name\n      })));\n    } catch (err) {\n      console.error('ê±°ë˜ì²˜ ê²€ìƒ‰ ì˜¤ë¥˜:', err);\n      setVendorSearchResults([]);\n    } finally {\n      setVendorSearchLoading(false);\n    }\n  };\n  \n  // ë°œì£¼ë²ˆí˜¸ ì¸ë¼ì¸ ê²€ìƒ‰\n  const handlePOSearch = async (searchValue: string) => {\n    if (!searchValue.trim()) {\n      setPOSearchResults([]);\n      setPODropdownOpen(false);\n      return;\n    }\n    \n    setPOSearchLoading(true);\n    setPODropdownOpen(true);\n    \n    try {\n      const normalized = normalizeOrderNumber(searchValue.trim());\n      \n      const { data: purchases, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          id,\n          purchase_order_number,\n          sales_order_number,\n          vendor:vendors(vendor_name)\n        `)\n        .or(`purchase_order_number.ilike.%${normalized}%,sales_order_number.ilike.%${normalized}%`)\n        .order('created_at', { ascending: false })\n        .limit(10);\n      \n      if (error) throw error;\n      \n      setPOSearchResults((purchases || []).map((p: any) => ({\n        id: p.id,\n        poNumber: p.purchase_order_number || '',\n        soNumber: p.sales_order_number,\n        vendorName: p.vendor?.vendor_name\n      })));\n    } catch (err) {\n      console.error('ë°œì£¼ë²ˆí˜¸ ê²€ìƒ‰ ì˜¤ë¥˜:', err);\n      setPOSearchResults([]);\n    } finally {\n      setPOSearchLoading(false);\n    }\n  };\n\n  // OCR ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ ì…ë ¥ ì‹œ ì‹¤ì‹œê°„ í˜ì–´ ì¡°íšŒ\n  const lookupPairedOrderNumber = useCallback(async (rawValue: string) => {\n    const trimmed = rawValue.trim();\n    if (!trimmed) return;\n    const normalized = normalizeOrderNumber(trimmed);\n    if (!normalized) return;\n    if (poPairOverrides.has(normalized)) return;\n    if (pendingPairLookupsRef.current.has(normalized)) return;\n    pendingPairLookupsRef.current.add(normalized);\n    try {\n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select('purchase_order_number,sales_order_number')\n        .or(`purchase_order_number.eq.${normalized},sales_order_number.eq.${normalized}`)\n        .limit(1);\n      if (error) throw error;\n      const match = data?.[0];\n      const pairedNumber = match\n        ? (normalized.startsWith('F')\n            ? match.sales_order_number\n            : normalized.startsWith('HS')\n              ? match.purchase_order_number\n              : (match.sales_order_number || match.purchase_order_number))\n        : null;\n      setPoPairOverrides(prev => {\n        const next = new Map(prev);\n        next.set(normalized, pairedNumber ?? null);\n        return next;\n      });\n    } catch (err) {\n      setPoPairOverrides(prev => {\n        const next = new Map(prev);\n        next.set(normalized, null);\n        return next;\n      });\n    } finally {\n      pendingPairLookupsRef.current.delete(normalized);\n    }\n  }, [poPairOverrides, supabase]);\n\n  // OCR ë°œì£¼ë²ˆí˜¸ ìˆ˜ì • ì‹œ ì‹œìŠ¤í…œ ë°œì£¼í’ˆëª©ì—ë„ ë°˜ì˜\n  const handleOCRPONumberChange = useCallback(async (newValue: string) => {\n    lookupPairedOrderNumber(newValue);\n    \n    // ì „ì²´ OCR í’ˆëª©ì— ìƒˆ ë°œì£¼ë²ˆí˜¸ ì ìš©\n    if (statementWithItems) {\n      statementWithItems.items.forEach(item => {\n        handleEditOCRItem(item.id, 'po_number', newValue);\n      });\n    }\n    \n    // ì‹œìŠ¤í…œ ë°œì£¼í’ˆëª©ì—ë„ ìë™ ë°˜ì˜\n    const normalizedValue = normalizeOrderNumber(newValue);\n    if (!normalizedValue) return;\n    \n    \n    // í›„ë³´ ëª©ë¡ì—ì„œ í•´ë‹¹ ë°œì£¼ë²ˆí˜¸ ì°¾ê¸°\n    const matchingCandidate = allPONumberCandidates.find(\n      c => c.poNumber === normalizedValue || c.salesOrderNumber === normalizedValue\n    );\n    \n    if (matchingCandidate) {\n      const newPO = matchingCandidate.poNumber || matchingCandidate.salesOrderNumber || '';\n      if (newPO && newPO !== selectedPONumber) {\n        setSelectedPONumber(newPO);\n      }\n      if (matchingCandidate.vendorName) {\n        setVendorInputValue(matchingCandidate.vendorName);\n        setOverrideVendorName(matchingCandidate.vendorName);\n      }\n    } else {\n      // í›„ë³´ ëª©ë¡ì— ì—†ìœ¼ë©´ DBì—ì„œ ì§ì ‘ ì¡°íšŒí•˜ì—¬ í’ˆëª© ë¡œë“œ\n      setSelectedPONumber(normalizedValue);\n      \n      try {\n        const { data: purchaseData } = await supabase\n          .from('purchase_requests')\n          .select(`\n            id,\n            purchase_order_number,\n            sales_order_number,\n            vendor:vendors(vendor_name),\n            purchase_request_items (\n              id,\n              item_name,\n              specification,\n              quantity,\n              received_quantity,\n              unit_price_value,\n              amount_value\n            )\n          `)\n          .or(`purchase_order_number.eq.${normalizedValue},sales_order_number.eq.${normalizedValue}`)\n          .limit(1);\n        \n        if (purchaseData && purchaseData.length > 0) {\n          const purchase = purchaseData[0];\n          const items = purchase.purchase_request_items || [];\n          const vendorName = (purchase.vendor as { vendor_name?: string } | null)?.vendor_name || '';\n          \n          // poItemsMapì— ì¶”ê°€\n          const newItems = items.map((item: any) => ({\n            purchase_id: purchase.id,\n            item_id: item.id,\n            purchase_order_number: purchase.purchase_order_number || '',\n            sales_order_number: purchase.sales_order_number,\n            item_name: item.item_name,\n            specification: item.specification,\n            quantity: item.quantity ?? 0,\n            received_quantity: item.received_quantity,\n            unit_price: item.unit_price_value,\n            amount: item.amount_value,\n            vendor_name: vendorName\n          }));\n          \n          setPoItemsMap(prev => {\n            const next = new Map(prev);\n            next.set(normalizedValue, newItems);\n            // ë°œì£¼ë²ˆí˜¸ì™€ ìˆ˜ì£¼ë²ˆí˜¸ ëª¨ë‘ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡\n            if (purchase.purchase_order_number) {\n              next.set(purchase.purchase_order_number, newItems);\n            }\n            if (purchase.sales_order_number) {\n              next.set(purchase.sales_order_number, newItems);\n            }\n            return next;\n          });\n\n          if (vendorName) {\n            setVendorInputValue(vendorName);\n            setOverrideVendorName(vendorName);\n          }\n          \n        }\n      } catch (err) {\n        console.error('ë°œì£¼ í’ˆëª© ì¡°íšŒ ì˜¤ë¥˜:', err);\n      }\n    }\n  }, [statementWithItems, allPONumberCandidates, selectedPONumber, lookupPairedOrderNumber, handleEditOCRItem, supabase]);\n\n  // ê±°ë˜ì²˜ ì„ íƒ ì‹œ - ë°œì£¼ í›„ë³´ ì¬ê²€ìƒ‰ ë° ë§¤ì¹­ ì¬ì‹¤í–‰\n  const handleSelectVendor = async (vendorName: string, options?: { silent?: boolean }) => {\n    const shouldNotify = !options?.silent;\n    setOverrideVendorName(vendorName);\n    setVendorInputValue(vendorName);\n    setVendorDropdownOpen(false);\n    setVendorSearchResults([]);\n    \n    if (shouldNotify) {\n      toast.success(`ê±°ë˜ì²˜ê°€ \"${vendorName}\"(ìœ¼)ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ë°œì£¼ í›„ë³´ë¥¼ ë‹¤ì‹œ ê²€ìƒ‰í•©ë‹ˆë‹¤.`);\n    }\n    \n    // ìƒˆ ê±°ë˜ì²˜ë¡œ ë°œì£¼ í›„ë³´ ì¬ê²€ìƒ‰\n    try {\n      const { data: purchases, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          id,\n          purchase_order_number,\n          sales_order_number,\n          vendor:vendors!inner(vendor_name),\n          items:purchase_request_items(\n            id,\n            item_name,\n            specification,\n            quantity,\n            received_quantity,\n            unit_price_value,\n            amount_value\n          )\n        `)\n        .eq('vendor.vendor_name', vendorName)\n        .order('created_at', { ascending: false })\n        .limit(50);\n      \n      if (error) throw error;\n      \n      if (!purchases || purchases.length === 0) {\n        if (shouldNotify) {\n          toast.error(`\"${vendorName}\" ê±°ë˜ì²˜ì˜ ë°œì£¼ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.`);\n        }\n        return;\n      }\n      \n      const itemsMap = new Map<string, SystemPurchaseItem[]>();\n      let totalMapItems = 0;\n      purchases.forEach((purchase: any) => {\n        const mappedItems: SystemPurchaseItem[] = (purchase.items || []).map((item: any) => ({\n          purchase_id: purchase.id,\n          item_id: item.id,\n          purchase_order_number: purchase.purchase_order_number || '',\n          sales_order_number: purchase.sales_order_number,\n          item_name: item.item_name || '',\n          specification: item.specification,\n          quantity: item.quantity,\n          received_quantity: item.received_quantity,\n          unit_price: item.unit_price_value,\n          amount: item.amount_value,\n          vendor_name: vendorName\n        }));\n        if (mappedItems.length === 0) return;\n        totalMapItems += mappedItems.length;\n        if (purchase.purchase_order_number) {\n          itemsMap.set(purchase.purchase_order_number, mappedItems);\n        }\n        if (purchase.sales_order_number) {\n          itemsMap.set(purchase.sales_order_number, mappedItems);\n        }\n      });\n      setPoItemsMap(itemsMap);\n      \n      // ìƒˆ ë°œì£¼ í›„ë³´ë¡œ ì¬ë§¤ì¹­\n      const newCandidates = new Map<string, MatchCandidate[]>();\n      const firstPO = purchases[0]?.purchase_order_number || purchases[0]?.sales_order_number || '';\n      \n      // í’ˆëª©ë³„ í›„ë³´ ì—…ë°ì´íŠ¸\n      if (statementWithItems) {\n        statementWithItems.items.forEach((ocrItem, index) => {\n          const candidates: MatchCandidate[] = [];\n          let maxSimilarity = 0;\n          let comparedCount = 0;\n          \n          purchases.forEach((purchase: any) => {\n            (purchase.items || []).forEach((item: any) => {\n              const similarity = calculateItemSimilarity(ocrItem.extracted_item_name || '', item.item_name, item.specification);\n              comparedCount += 1;\n              if (similarity > maxSimilarity) {\n                maxSimilarity = similarity;\n              }\n              if (similarity >= 40) { // ìµœì†Œ 40ì  ì´ìƒ\n                candidates.push({\n                  purchase_id: purchase.id,\n                  item_id: item.id,\n                  purchase_order_number: purchase.purchase_order_number || '',\n                  sales_order_number: purchase.sales_order_number,\n                  item_name: item.item_name || '',\n                  specification: item.specification,\n                  quantity: item.quantity,\n                  unit_price: item.unit_price_value,\n                  score: similarity,\n                  match_reasons: ['ê±°ë˜ì²˜ ë§¤ì¹­'],\n                  vendor_name: vendorName\n                });\n              }\n            });\n          });\n          \n          if (index === 0) {\n          }\n          \n          candidates.sort((a, b) => b.score - a.score);\n          newCandidates.set(ocrItem.id, candidates.slice(0, 5));\n        });\n        \n        // ì²« ë²ˆì§¸ ë°œì£¼ë¡œ ìë™ ë§¤ì¹­\n        setSelectedPONumber(firstPO);\n        \n        const newMatches = new Map<string, SystemPurchaseItem | null>();\n        const systemItems: SystemPurchaseItem[] = (purchases[0]?.items || []).map((item: any) => ({\n          purchase_id: purchases[0].id,\n          item_id: item.id,\n          purchase_order_number: purchases[0].purchase_order_number || '',\n          sales_order_number: purchases[0].sales_order_number,\n          item_name: item.item_name || '',\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price: item.unit_price_value,\n          amount: item.amount_value,\n          vendor_name: vendorName\n        }));\n        \n        statementWithItems.items.forEach(ocrItem => {\n          let bestMatch: SystemPurchaseItem | null = null;\n          let bestScore = 0;\n          \n          systemItems.forEach(sysItem => {\n            const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', sysItem.item_name, sysItem.specification);\n            if (score > bestScore && score >= 30) {\n              bestScore = score;\n              bestMatch = sysItem;\n            }\n          });\n          \n          newMatches.set(ocrItem.id, bestMatch);\n        });\n        \n        setItemMatches(newMatches);\n        \n        // ì„¸íŠ¸ ë§¤ì¹­ ê²°ê³¼ ì—…ë°ì´íŠ¸ (allPONumberCandidates ê°±ì‹ ìš©)\n        setSetMatchResult({\n          bestMatch: {\n            purchase_id: purchases[0].id,\n            purchase_order_number: purchases[0].purchase_order_number || '',\n            sales_order_number: purchases[0].sales_order_number,\n            vendor_name: vendorName,\n            matchScore: 100,\n            matchedItemCount: newMatches.size,\n            totalItemCount: statementWithItems.items.length,\n            confidence: 'high',\n            itemMatches: []\n          },\n          candidates: purchases.map((p: any) => ({\n            purchase_id: p.id,\n            purchase_order_number: p.purchase_order_number || '',\n            sales_order_number: p.sales_order_number,\n            vendor_name: vendorName,\n            matchScore: p.id === purchases[0].id ? 100 : 50,\n            matchedItemCount: (p.items || []).length\n          }))\n        });\n        \n        if (shouldNotify) {\n          toast.success(`${purchases.length}ê°œ ë°œì£¼ í›„ë³´ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤. ìë™ ë§¤ì¹­ ì™„ë£Œ.`);\n        }\n      }\n      \n    } catch (err) {\n      console.error('ê±°ë˜ì²˜ ë°œì£¼ ê²€ìƒ‰ ì˜¤ë¥˜:', err);\n      toast.error('ë°œì£¼ í›„ë³´ ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ë°œì£¼ë²ˆí˜¸ ì„ íƒ ì‹œ (Case 2: ê°œë³„ í’ˆëª©ìš©)\n  const handleSelectItemPO = (ocrItemId: string, poNumber: string) => {\n    setItemPONumbers(prev => {\n      const newMap = new Map(prev);\n      newMap.set(ocrItemId, poNumber);\n      return newMap;\n    });\n    \n    const ocrItem = statementWithItems?.items.find(i => i.id === ocrItemId);\n    \n    if (ocrItem) {\n      // 1. match_candidatesì—ì„œ í•´ë‹¹ ë°œì£¼ë²ˆí˜¸ í›„ë³´ ì°¾ê¸°\n      const matchingCandidates = ocrItem.match_candidates?.filter(c => \n        c.purchase_order_number === poNumber || c.sales_order_number === poNumber\n      ) || [];\n      \n      let bestMatch: SystemPurchaseItem | null = null;\n      let bestScore = -1;\n      \n      if (matchingCandidates.length > 0) {\n        // match_candidatesì—ì„œ ê°€ì¥ ìœ ì‚¬í•œ ê²ƒ ì„ íƒ\n        matchingCandidates.forEach(c => {\n          const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', c.item_name, c.specification);\n          if (score > bestScore) {\n            bestScore = score;\n            bestMatch = {\n              purchase_id: c.purchase_id,\n              item_id: c.item_id,\n              purchase_order_number: c.purchase_order_number || '',\n              sales_order_number: c.sales_order_number,\n              item_name: c.item_name,\n              specification: c.specification,\n              quantity: c.quantity,\n              unit_price: c.unit_price,\n              amount: (c as any).amount,\n              vendor_name: c.vendor_name\n            };\n          }\n        });\n      }\n      \n      // 2. match_candidatesì—ì„œ ëª» ì°¾ìœ¼ë©´ getSystemItemsForPOë¡œ ì§ì ‘ ê²€ìƒ‰\n      if (!bestMatch) {\n        const systemItems = getSystemItemsForPO(poNumber);\n        systemItems.forEach(sysItem => {\n          const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', sysItem.item_name, sysItem.specification);\n          if (score > bestScore) {\n            bestScore = score;\n            bestMatch = sysItem;\n          }\n        });\n      }\n      \n      // íƒ€ì… ì²´í¬ë¥¼ ìœ„í•´ final ë³€ìˆ˜ ì‚¬ìš©\n      const finalMatch = bestMatch as SystemPurchaseItem | null;\n      const matchedName = finalMatch?.item_name || 'ì—†ìŒ';\n      console.log(`ğŸ”„ ë°œì£¼ë²ˆí˜¸ ì„ íƒ: ${poNumber} â†’ ë§¤ì¹­: ${matchedName} (ì ìˆ˜: ${bestScore})`);\n      \n      setItemMatches(prev => {\n        const newMap = new Map(prev);\n        newMap.set(ocrItemId, bestMatch);\n        return newMap;\n      });\n    }\n    \n    setOpenDropdowns(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(`po-${ocrItemId}`);\n      return newSet;\n    });\n  };\n\n  const getPurchaseIdByNumber = useCallback((poNumber: string) => {\n    const candidate = allPONumberCandidates.find(\n      c => c.poNumber === poNumber || c.salesOrderNumber === poNumber\n    );\n    return candidate?.purchaseId || candidate?.items?.[0]?.purchase_id;\n  }, [allPONumberCandidates]);\n\n  const handleItemPOSearch = useCallback(async (ocrItemId: string, searchValue: string) => {\n    setItemPOSearchInputs(prev => ({ ...prev, [ocrItemId]: searchValue }));\n\n    if (!searchValue || searchValue.trim().length < 2) {\n      setItemPOSearchResults(prev => ({ ...prev, [ocrItemId]: [] }));\n      return;\n    }\n\n    setItemPOSearchLoading(prev => ({ ...prev, [ocrItemId]: true }));\n\n    try {\n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          id,\n          purchase_order_number,\n          sales_order_number,\n          vendor:vendors(vendor_name)\n        `)\n        .or(`purchase_order_number.ilike.%${searchValue}%,sales_order_number.ilike.%${searchValue}%`)\n        .order('created_at', { ascending: false })\n        .limit(20);\n\n      if (error) throw error;\n\n      const results = (data || []).map((row: any) => ({\n        id: row.id,\n        poNumber: row.purchase_order_number || '',\n        soNumber: row.sales_order_number || undefined,\n        vendorName: row.vendor?.vendor_name\n      }));\n      setItemPOSearchResults(prev => ({ ...prev, [ocrItemId]: results }));\n    } catch (err) {\n      setItemPOSearchResults(prev => ({ ...prev, [ocrItemId]: [] }));\n    } finally {\n      setItemPOSearchLoading(prev => ({ ...prev, [ocrItemId]: false }));\n    }\n  }, [supabase]);\n\n  // ì‹œìŠ¤í…œ í’ˆëª© ì§ì ‘ ì„ íƒ\n  const handleSelectSystemItem = (ocrItemId: string, systemItem: SystemPurchaseItem | null) => {\n    lastSelectedSystemItemRef.current = ocrItemId;\n    setItemMatches(prev => {\n      const newMap = new Map(prev);\n      newMap.set(ocrItemId, systemItem);\n      return newMap;\n    });\n    \n    setOpenDropdowns(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(`item-${ocrItemId}`);\n      return newSet;\n    });\n  };\n\n  useEffect(() => {\n    if (!lastSelectedSystemItemRef.current) return;\n    const itemId = lastSelectedSystemItemRef.current;\n    const matched = itemMatches.get(itemId);\n  }, [itemMatches]);\n\n  useEffect(() => {\n    if (!statementWithItems || itemMatches.size === 0) return;\n\n    let didUpdate = false;\n    const nextMap = new Map(itemMatches);\n\n    statementWithItems.items.forEach((ocrItem) => {\n      const current = itemMatches.get(ocrItem.id);\n      if (!current || current.received_quantity != null) return;\n\n      const itemPO = isSamePONumber\n        ? selectedPONumber\n        : (itemPONumbers.get(ocrItem.id) || (ocrItem.extracted_po_number ? normalizeOrderNumber(ocrItem.extracted_po_number) : ''));\n      const systemItems = itemPO ? getSystemItemsForPO(itemPO) : [];\n      if (systemItems.length === 0) return;\n\n      const enriched = systemItems.find((sys) => sys.item_id === current.item_id);\n      if (enriched && enriched.received_quantity != null) {\n        nextMap.set(ocrItem.id, { ...current, received_quantity: enriched.received_quantity });\n        didUpdate = true;\n      }\n    });\n\n    if (didUpdate) {\n      setItemMatches(nextMap);\n    }\n  }, [statementWithItems, itemMatches, isSamePONumber, selectedPONumber, itemPONumbers, getSystemItemsForPO]);\n\n  // í™•ì •\n  const handleConfirm = async () => {\n    if (!statementWithItems) return;\n\n    try {\n      setSaving(true);\n\n      // 1. OCR ìˆ˜ì •ì‚¬í•­ í•™ìŠµ ë°ì´í„°ë¡œ ì €ì¥\n      await saveOCRCorrections();\n\n      // 1.5 ê±°ë˜ì¼ ìˆ˜ì • ë°˜ì˜\n      const normalizedOriginalDate = normalizeStatementDate(statementWithItems.statement_date);\n      const normalizedInputDate = normalizeStatementDate(statementDateInput);\n      if (normalizedInputDate !== normalizedOriginalDate) {\n        const { error: dateError } = await supabase\n          .from('transaction_statements')\n          .update({ statement_date: normalizedInputDate || null })\n          .eq('id', statement.id);\n\n        if (dateError) {\n          throw new Error(dateError.message);\n        }\n      }\n\n      // 2. í™•ì • ë°ì´í„° ìƒì„± (ìˆ˜ì •ëœ ê°’ ìš°ì„  ì‚¬ìš©)\n      const confirmItems: ConfirmItemRequest[] = statementWithItems.items.map(item => {\n        const matched = itemMatches.get(item.id);\n        const edited = editedOCRItems.get(item.id);\n        \n        // ìˆ˜ì •ëœ ê°’ì´ ìˆìœ¼ë©´ ìˆ˜ì •ëœ ê°’ ì‚¬ìš©, ì—†ìœ¼ë©´ ì›ë³¸ ì‚¬ìš©\n        const confirmedQuantity = edited?.quantity !== undefined \n          ? edited.quantity \n          : item.extracted_quantity;\n        const confirmedUnitPrice = edited?.unit_price !== undefined \n          ? edited.unit_price \n          : item.extracted_unit_price;\n        const confirmedAmount = edited?.amount !== undefined \n          ? edited.amount \n          : item.extracted_amount;\n        \n        \n        return {\n          itemId: item.id,\n          matched_purchase_id: matched?.purchase_id,\n          matched_item_id: matched?.item_id,\n          confirmed_quantity: confirmedQuantity,\n          confirmed_unit_price: confirmedUnitPrice,\n          confirmed_amount: confirmedAmount\n        };\n      });\n\n      const result = await transactionStatementService.confirmStatement(\n        {\n          statementId: statement.id,\n          items: confirmItems\n        },\n        confirmerName\n      );\n\n      if (result.success) {\n        toast.success('ê±°ë˜ëª…ì„¸ì„œê°€ í™•ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');\n        onConfirm();\n      } else {\n        toast.error(result.error || 'í™•ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      toast.error('í™•ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // ê±°ë¶€\n  const handleReject = async () => {\n    if (!confirm('ì´ ê±°ë˜ëª…ì„¸ì„œë¥¼ ê±°ë¶€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;\n\n    try {\n      setSaving(true);\n      \n      const result = await transactionStatementService.rejectStatement(statement.id);\n      \n      if (result.success) {\n        toast.success('ê±°ë˜ëª…ì„¸ì„œê°€ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.');\n        onClose();\n      } else {\n        toast.error(result.error || 'ê±°ë¶€ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      toast.error('ê±°ë¶€ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const formatAmount = (amount?: number) => {\n    if (amount === undefined || amount === null) return '-';\n    return amount.toLocaleString('ko-KR');\n  };\n\n  const getSystemItemLabel = (item?: SystemPurchaseItem | null) => {\n    if (!item) return '';\n    const name = item.item_name?.trim();\n    if (name) return name;\n    const spec = item.specification?.trim();\n    if (spec) return spec;\n    return `í’ˆëª© #${item.item_id}`;\n  };\n\n  const handleOpenOriginalImage = () => {\n    const imageUrl = statementWithItems?.image_url || statement.image_url;\n    if (!imageUrl) return;\n\n    const width = 1000;\n    const height = 800;\n    const left = Math.max(0, window.screenX + (window.outerWidth - width) / 2);\n    const top = Math.max(0, window.screenY + (window.outerHeight - height) / 2);\n    window.open(imageUrl, 'transaction-statement-image', `width=${width},height=${height},left=${left},top=${top}`);\n  };\n\n  // ë§¤ì¹­ ìƒì„¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°\n  const getMatchDetails = (ocrItem: TransactionStatementItemWithMatch) => {\n    const matched = itemMatches.get(ocrItem.id);\n    let effectiveMatch: SystemPurchaseItem | null = matched || null;\n    let hasSystemItems = false;\n    \n    if (!effectiveMatch) {\n      const poNumber = isSamePONumber \n        ? selectedPONumber \n        : (itemPONumbers.get(ocrItem.id) || (ocrItem.extracted_po_number ? normalizeOrderNumber(ocrItem.extracted_po_number) : ''));\n      \n      if (poNumber) {\n        const systemItems = getSystemItemsForPO(poNumber);\n        hasSystemItems = systemItems.length > 0;\n        \n        let bestScore = 0;\n        systemItems.forEach(sysItem => {\n          const score = calculateItemSimilarity(ocrItem.extracted_item_name || '', sysItem.item_name, sysItem.specification);\n          if (score > bestScore) {\n            bestScore = score;\n            effectiveMatch = sysItem;\n          }\n        });\n      }\n    }\n    \n    if (!effectiveMatch) {\n      return {\n        ocrItemName: ocrItem.extracted_item_name || '-',\n        systemItemName: '-',\n        systemSpec: '-',\n        similarity: 0,\n        status: 'unmatched' as const,\n        reasons: ['ì‹œìŠ¤í…œì—ì„œ ë§¤ì¹­í•  ë°œì£¼ í’ˆëª©ì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.']\n      };\n    }\n    \n    const similarity = calculateItemSimilarity(ocrItem.extracted_item_name || '', effectiveMatch.item_name || '', effectiveMatch.specification);\n    \n    // ë” ì—„ê²©í•œ ì„ê³„ê°’ ì ìš© (getMatchStatusì™€ ë™ì¼)\n    let status: 'high' | 'med' | 'low' | 'unmatched' = 'unmatched';\n    if (similarity >= 85) status = 'high';       // ë†’ìŒ: 85% ì´ìƒ\n    else if (similarity >= 60) status = 'med';   // ë³´í†µ: 60% ì´ìƒ\n    else if (similarity >= 40) status = 'low';   // ë‚®ìŒ: 40% ì´ìƒ\n    // 40% ë¯¸ë§Œì´ë©´ unmatched ìœ ì§€\n    \n    const reasons: string[] = [];\n    \n    // ìœ ì‚¬ë„ ì„¤ëª… (ì„ê³„ê°’ì— ë§ê²Œ ì¡°ì •)\n    if (similarity >= 85) {\n      reasons.push(`âœ… í’ˆëª©ëª…/ê·œê²© ìœ ì‚¬ë„ ${similarity.toFixed(0)}% (ë†’ìŒ)`);\n    } else if (similarity >= 60) {\n      reasons.push(`âš ï¸ í’ˆëª©ëª…/ê·œê²© ìœ ì‚¬ë„ ${similarity.toFixed(0)}% (ë³´í†µ)`);\n    } else if (similarity >= 40) {\n      reasons.push(`âš ï¸ í’ˆëª©ëª…/ê·œê²© ìœ ì‚¬ë„ ${similarity.toFixed(0)}% (ë‚®ìŒ)`);\n    } else {\n      reasons.push(`âŒ í’ˆëª©ëª…/ê·œê²© ìœ ì‚¬ë„ ${similarity.toFixed(0)}% (ë§¤ìš° ë‚®ìŒ - ë¶ˆì¼ì¹˜)`);\n    }\n    \n    // í’ˆëª©ëª… vs ê·œê²© ìƒì„¸ ë¹„êµ (ìœ ì‚¬ë„ì™€ ì¼ê´€ë˜ê²Œ)\n    const ocrName = (ocrItem.extracted_item_name || '').toLowerCase().replace(/\\s+/g, '');\n    const sysName = (effectiveMatch.item_name || '').toLowerCase().replace(/\\s+/g, '');\n    const sysSpec = (effectiveMatch.specification || '').toLowerCase().replace(/\\s+/g, '');\n    \n    // ê·œê²© ì¼ì¹˜ ì—¬ë¶€ ë¨¼ì € í™•ì¸\n    const specMatch = sysSpec && (ocrName === sysSpec || ocrName.includes(sysSpec) || sysSpec.includes(ocrName));\n    const nameMatch = ocrName === sysName || ocrName.includes(sysName) || sysName.includes(ocrName);\n    \n    if (similarity >= 85) {\n      // ìœ ì‚¬ë„ ë†’ìœ¼ë©´ ë¬´ì—‡ì´ ì¼ì¹˜í–ˆëŠ”ì§€ ì„¤ëª…\n      if (nameMatch && specMatch) {\n        reasons.push('âœ… í’ˆëª©ëª…ê³¼ ê·œê²© ëª¨ë‘ ì¼ì¹˜');\n      } else if (specMatch) {\n        reasons.push('âœ… ê·œê²©ìœ¼ë¡œ ë§¤ì¹­ë¨');\n      } else if (nameMatch) {\n        reasons.push('âœ… í’ˆëª©ëª…ìœ¼ë¡œ ë§¤ì¹­ë¨');\n      } else {\n        reasons.push('âœ… ë¬¸ìì—´ ìœ ì‚¬ë„ë¡œ ë§¤ì¹­ë¨');\n      }\n    } else if (similarity >= 60) {\n      if (specMatch) {\n        reasons.push('âš ï¸ ê·œê²© ë¶€ë¶„ ì¼ì¹˜');\n      } else if (nameMatch) {\n        reasons.push('âš ï¸ í’ˆëª©ëª… ë¶€ë¶„ ì¼ì¹˜');\n      } else {\n        reasons.push('âš ï¸ ë¶€ë¶„ì ìœ¼ë¡œ ìœ ì‚¬');\n      }\n    } else {\n      // ìœ ì‚¬ë„ ë‚®ì€ ê²½ìš° ë¶ˆì¼ì¹˜ í‘œì‹œ\n      reasons.push('âŒ í’ˆëª©ëª…/ê·œê²© ë¶ˆì¼ì¹˜ - ë‹¤ë¥¸ í’ˆëª©ì¼ ê°€ëŠ¥ì„± ë†’ìŒ');\n    }\n    \n    // ë°œì£¼ë²ˆí˜¸ ì„¤ëª…\n    reasons.push(`ğŸ“¦ ë°œì£¼ë²ˆí˜¸: ${effectiveMatch.purchase_order_number || effectiveMatch.sales_order_number || '-'}`);\n    \n    // ì‹œìŠ¤í…œ í’ˆëª© ìƒì„¸\n    if (effectiveMatch.specification) {\n      reasons.push(`ğŸ“‹ ì‹œìŠ¤í…œ ê·œê²©: ${effectiveMatch.specification}`);\n    }\n    \n    return {\n      ocrItemName: ocrItem.extracted_item_name || '-',\n      systemItemName: effectiveMatch.item_name || '-',\n      systemSpec: effectiveMatch.specification || '-',\n      similarity,\n      status,\n      reasons\n    };\n  };\n  \n  // ë§¤ì¹­ ìƒíƒœ ë±ƒì§€ í´ë¦­ í•¸ë“¤ëŸ¬\n  const handleMatchStatusClick = (ocrItem: TransactionStatementItemWithMatch) => {\n    const details = getMatchDetails(ocrItem);\n    setMatchDetailPopup({\n      isOpen: true,\n      ocrItemId: ocrItem.id,\n      ...details\n    });\n  };\n\n  const renderMatchStatusBadge = (status: 'high' | 'med' | 'low' | 'unmatched', ocrItem?: TransactionStatementItemWithMatch) => {\n    const onClick = ocrItem ? () => handleMatchStatusClick(ocrItem) : undefined;\n    const clickableClass = ocrItem ? \"cursor-pointer hover:opacity-80 transition-opacity\" : \"\";\n    \n    switch (status) {\n      case 'high':\n        return <span className={`badge-stats bg-green-500 text-white ${clickableClass}`} onClick={onClick} title=\"í´ë¦­í•˜ì—¬ ìƒì„¸ ë³´ê¸°\"><Check className=\"w-3 h-3\" />ë†’ìŒ</span>;\n      case 'med':\n        return <span className={`badge-stats bg-yellow-500 text-white ${clickableClass}`} onClick={onClick} title=\"í´ë¦­í•˜ì—¬ ìƒì„¸ ë³´ê¸°\">ë³´í†µ</span>;\n      case 'low':\n        return <span className={`badge-stats bg-orange-500 text-white ${clickableClass}`} onClick={onClick} title=\"í´ë¦­í•˜ì—¬ ìƒì„¸ ë³´ê¸°\">ë‚®ìŒ</span>;\n      case 'unmatched':\n        return <span className={`badge-stats bg-gray-500 text-white ${clickableClass}`} onClick={onClick} title=\"í´ë¦­í•˜ì—¬ ìƒì„¸ ë³´ê¸°\">ë¯¸ë§¤ì¹­</span>;\n    }\n  };\n\n  const toggleDropdown = (key: string, event?: React.MouseEvent) => {\n    if (key.startsWith('item-')) {\n    }\n    if (event && key === 'global-po') {\n      const rect = (event.currentTarget as HTMLElement).getBoundingClientRect();\n      setDropdownPosition({\n        top: rect.bottom + 4,\n        left: rect.left\n      });\n    }\n    \n    setOpenDropdowns(prev => {\n      const newSet = new Set(prev);\n      if (newSet.has(key)) {\n        newSet.delete(key);\n      } else {\n        newSet.clear(); // ë‹¤ë¥¸ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°\n        newSet.add(key);\n      }\n      return newSet;\n    });\n  };\n\n  if (!statement) return null;\n\n  return (\n    <>\n      <Dialog open={isOpen} onOpenChange={onClose}>\n        <DialogContent \n          className=\"max-w-[95vw] md:max-w-[1200px] max-h-[90vh] overflow-hidden flex flex-col business-radius-modal\" \n          showCloseButton={false}\n          onInteractOutside={(e) => {\n            // ë“œë¡­ë‹¤ìš´ì´ ì—´ë ¤ìˆì„ ë•ŒëŠ” ì™¸ë¶€ í´ë¦­ìœ¼ë¡œ ëª¨ë‹¬ ë‹«ê¸° ë°©ì§€\n            if (openDropdowns.size > 0) {\n              e.preventDefault();\n            }\n          }}\n        >\n          <DialogHeader className=\"border-b border-gray-100 pb-3 px-4\">\n            <DialogTitle className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2 modal-title\">\n                <CheckCircle className=\"w-4 h-4 text-hansl-600\" />\n                ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ë° í™•ì •\n              </div>\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={handleOpenOriginalImage}\n                className=\"button-base h-7 text-[10px]\"\n              >\n                <ImageIcon className=\"w-3.5 h-3.5 mr-1\" />\n                ì›ë³¸ ë³´ê¸°\n              </Button>\n            </DialogTitle>\n          </DialogHeader>\n\n          {loading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"w-6 h-6 animate-spin text-hansl-600\" />\n              <span className=\"ml-3 modal-subtitle\">ë¡œë”© ì¤‘...</span>\n            </div>\n          ) : statementWithItems ? (\n            <div className=\"flex-1 overflow-hidden flex flex-col py-3 px-4\">\n              {/* ìš”ì•½ ì •ë³´ */}\n              <div className=\"flex items-center gap-6 p-3 bg-gray-50 business-radius-card mb-4\">\n                <div className=\"relative\">\n                  <p className=\"modal-label\">ê±°ë˜ì²˜</p>\n                  <div className=\"relative\">\n                    <input\n                      type=\"text\"\n                      value={vendorInputValue}\n                      onChange={(e) => {\n                        setVendorInputValue(e.target.value);\n                        handleVendorSearch(e.target.value);\n                      }}\n                      onFocus={() => {\n                        if (vendorSearchResults.length > 0) setVendorDropdownOpen(true);\n                      }}\n                      onBlur={() => {\n                        // delay to allow click on dropdown\n                        setTimeout(() => setVendorDropdownOpen(false), 200);\n                      }}\n                      placeholder=\"ê±°ë˜ì²˜ ê²€ìƒ‰...\"\n                      className={`w-[120px] h-5 px-1.5 bg-white border business-radius focus:outline-none focus:ring-1 focus:ring-hansl-400 ${\n                        overrideVendorName ? 'border-green-400 text-green-700' : 'border-gray-300 text-gray-900'\n                      }`}\n                      style={{ fontSize: '11px', fontWeight: 700 }}\n                    />\n                    {vendorSearchLoading && (\n                      <Loader2 className=\"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 animate-spin text-gray-400\" />\n                    )}\n                    {/* ì¸ë¼ì¸ ë“œë¡­ë‹¤ìš´ */}\n                    {vendorDropdownOpen && vendorSearchResults.length > 0 && (\n                      <div className=\"absolute top-full left-0 mt-1 w-[200px] bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-[180px] overflow-y-auto\">\n                        {vendorSearchResults.map((vendor) => (\n                          <button\n                            key={vendor.id}\n                            onMouseDown={(e) => e.preventDefault()}\n                            onClick={() => {\n                              setVendorInputValue(vendor.name);\n                              setVendorDropdownOpen(false);\n                              handleSelectVendor(vendor.name);\n                            }}\n                            className=\"w-full px-2 py-1.5 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0\"\n                          >\n                            <div className=\"text-[10px] font-medium text-gray-900\">{vendor.name}</div>\n                          </button>\n                        ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div>\n                  <p className=\"modal-label\">ê±°ë˜ì¼</p>\n                  <input\n                    type=\"date\"\n                    value={statementDateInput}\n                    onChange={(e) => setStatementDateInput(e.target.value)}\n                    className=\"w-[120px] h-5 px-1.5 bg-white border border-gray-300 business-radius-input focus:outline-none focus:ring-1 focus:ring-hansl-400 text-gray-900\"\n                    style={{ fontSize: '11px', fontWeight: 600 }}\n                  />\n                </div>\n                <div>\n                  <p className=\"modal-label\">í•©ê³„ê¸ˆì•¡</p>\n                  <p className=\"modal-value-large\">\n                    {formatAmount(statementWithItems.grand_total)}ì›\n                  </p>\n                </div>\n                <div>\n                  <p className=\"modal-label\">í’ˆëª© ìˆ˜</p>\n                  <p className=\"modal-value\">{statementWithItems.items.length}ê±´</p>\n                </div>\n              </div>\n\n              {/* 3ë‹¨ ë¹„êµ í…Œì´ë¸” */}\n              <div className=\"flex-1 overflow-auto border border-gray-200 business-radius-card bg-gray-100\" ref={tableContainerRef}>\n                <table\n                  className=\"modal-value table-auto min-w-full\"\n                  ref={tableRef}\n                  style={{ borderCollapse: 'collapse', borderSpacing: 0 }}\n                >\n                  <thead className=\"bg-gray-100 sticky top-0 z-10\">\n                    <tr className=\"border-b border-gray-200\">\n                      {/* ì¢Œì¸¡: ì‹œìŠ¤í…œ ë°œì£¼í’ˆëª© í—¤ë” */}\n                      <th colSpan={isSamePONumber ? 4 : 5} className=\"border-r-2 border-gray-300 p-2 text-left w-[45%]\">\n                        <div className=\"flex items-center gap-2 flex-wrap\">\n                          <span className=\"modal-section-title text-gray-700\">ì‹œìŠ¤í…œ ë°œì£¼í’ˆëª©</span>\n                          {isSamePONumber && allPONumberCandidates.length > 0 && (\n                            <div className=\"relative flex items-center gap-1\">\n                              <button\n                                onClick={(e) => toggleDropdown('global-po', e)}\n                                className=\"inline-flex items-center gap-1 px-1.5 h-5 text-[10px] font-medium bg-white border border-gray-300 rounded-md hover:bg-gray-50 text-gray-700\"\n                              >\n                                {(() => {\n                                  if (!selectedPONumber) return 'ë°œì£¼ë²ˆí˜¸ ì„ íƒ';\n                                  const candidate = allPONumberCandidates.find(c => c.poNumber === selectedPONumber || c.salesOrderNumber === selectedPONumber);\n                                  if (candidate?.poNumber && candidate?.salesOrderNumber) {\n                                    return <>{candidate.poNumber} <span className=\"text-gray-400\">({candidate.salesOrderNumber})</span></>;\n                                  }\n                                  // ì„ íƒëœ ë°œì£¼ë²ˆí˜¸ë¥¼ ê·¸ëŒ€ë¡œ í‘œì‹œ (ìˆ˜ë™ ê²€ìƒ‰ìœ¼ë¡œ ì„ íƒí•œ ê²½ìš° í¬í•¨)\n                                  const pairedNumber = getPairedOrderNumber(selectedPONumber);\n                                  if (pairedNumber) {\n                                    return <>{selectedPONumber} <span className=\"text-gray-400\">({pairedNumber})</span></>;\n                                  }\n                                  return selectedPONumber;\n                                })()}\n                                <ChevronDown className=\"w-3 h-3\" />\n                              </button>\n                              {/* OCR ì¶”ì¶œ ë°œì£¼ë²ˆí˜¸ì™€ ë‹¤ë¥´ë©´ ê²½ê³  */}\n                              {commonPONumber && selectedPONumber && commonPONumber !== selectedPONumber && (\n                                <span className=\"text-[9px] text-orange-500\" title=\"OCR ì¶”ì¶œ ë°œì£¼ë²ˆí˜¸ì™€ ë‹¤ë¥¸ ë°œì£¼ê°€ ë§¤ì¹­ë¨\">\n                                  âš ï¸\n                                </span>\n                              )}\n                              {/* ìˆ˜ë™ ê²€ìƒ‰ - ì¸ë¼ì¸ input */}\n                              <div className=\"relative flex items-center\">\n                                {poSearchInputOpen ? (\n                                  <>\n                                    <input\n                                      type=\"text\"\n                                      value={poSearchInput}\n                                      onChange={(e) => {\n                                        setPOSearchInput(e.target.value);\n                                        handlePOSearch(e.target.value);\n                                      }}\n                                      onBlur={() => {\n                                        if (keepPODropdownOpenRef.current) {\n                                          keepPODropdownOpenRef.current = false;\n                                          return;\n                                        }\n                                        setTimeout(() => {\n                                          setPOSearchInputOpen(false);\n                                          setPODropdownOpen(false);\n                                        }, 200);\n                                      }}\n                                      placeholder=\"F... ë˜ëŠ” HS...\"\n                                      className=\"w-[150px] h-5 px-1.5 bg-white border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-hansl-400\"\n                                      style={{ fontSize: '10px', fontWeight: 500 }}\n                                      autoFocus\n                                      onClick={(e) => e.stopPropagation()}\n                                    />\n                                    {poSearchLoading && (\n                                      <Loader2 className=\"absolute right-1 w-3 h-3 animate-spin text-gray-400\" />\n                                    )}\n                                    {/* ì¸ë¼ì¸ ë“œë¡­ë‹¤ìš´ */}\n                                    {poDropdownOpen && poSearchResults.length > 0 && (\n                                      <div className=\"absolute top-full left-0 mt-1 w-[280px] bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-[180px] overflow-y-auto\">\n                                        {poSearchResults.map((po) => (\n                                          <div\n                                            key={po.id}\n                                            className=\"w-full px-2 py-1.5 hover:bg-gray-50 border-b border-gray-100 last:border-b-0\"\n                                          >\n                                            <button\n                                              onMouseDown={(e) => e.preventDefault()}\n                                              onClick={(e) => {\n                                                e.stopPropagation();\n                                                keepPODropdownOpenRef.current = false;\n                                                // ê²€ìƒ‰ì–´ì— ë§ëŠ” ë²ˆí˜¸ ì„ íƒ: HSë¡œ ê²€ìƒ‰í–ˆìœ¼ë©´ soNumber, Fë¡œ ê²€ìƒ‰í–ˆìœ¼ë©´ poNumber\n                                                const searchUpper = poSearchInput.trim().toUpperCase();\n                                                let selectedNumber: string;\n                                                if (searchUpper.startsWith('HS') && po.soNumber) {\n                                                  selectedNumber = po.soNumber;\n                                                } else if (searchUpper.startsWith('F') && po.poNumber) {\n                                                  selectedNumber = po.poNumber;\n                                                } else {\n                                                  selectedNumber = po.poNumber || po.soNumber || '';\n                                                }\n                                                setPOSearchInput('');\n                                                setPOSearchInputOpen(false);\n                                                setPODropdownOpen(false);\n                                                // ìˆ˜ë™ ì„ íƒ í”Œë˜ê·¸ ì„¤ì • (ìë™ êµì • ë°©ì§€)\n                                                setManuallySelectedPO(true);\n                                                // ë°œì£¼ë²ˆí˜¸ ì„ íƒ ë° í’ˆëª© ë§¤ì¹­ ì—…ë°ì´íŠ¸ (ê±°ë˜ì²˜ëª…, ìˆ˜ì£¼ë²ˆí˜¸ í¬í•¨)\n                                                handleSelectGlobalPO(selectedNumber, po.vendorName, po.soNumber);\n                                                toast.success(`${selectedNumber} ë°œì£¼ê°€ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤`);\n                                              }}\n                                              className=\"w-full text-left\"\n                                            >\n                                              <div className=\"flex items-center justify-between gap-2\">\n                                                <div className=\"text-[10px] font-medium text-gray-900\">\n                                                  {po.poNumber}\n                                                  {po.soNumber && <span className=\"text-gray-400 ml-1\">({po.soNumber})</span>}\n                                                </div>\n                                                <button\n                                                  type=\"button\"\n                                                  onMouseDown={(e) => {\n                                                    keepPODropdownOpenRef.current = true;\n                                                    e.preventDefault();\n                                                  }}\n                                                  onClick={(e) => {\n                                                    e.stopPropagation();\n                                                    setSelectedPurchaseIdForDetail(po.id);\n                                                    setIsPurchaseDetailModalOpen(true);\n                                                  }}\n                                                  className=\"text-[9px] font-medium text-blue-600 hover:text-blue-800\"\n                                                >\n                                                  ìƒì„¸\n                                                </button>\n                                              </div>\n                                            </button>\n                                            {po.vendorName && (\n                                              <div className=\"text-[9px] text-gray-500\">{po.vendorName}</div>\n                                            )}\n                                          </div>\n                                        ))}\n                                      </div>\n                                    )}\n                                  </>\n                                ) : (\n                                  <button\n                                    onClick={(e) => {\n                                      e.stopPropagation();\n                                      setPOSearchInputOpen(true);\n                                    }}\n                                    className=\"inline-flex items-center gap-0.5 px-1 h-5 text-[9px] font-medium text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded\"\n                                    title=\"ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ ì§ì ‘ ê²€ìƒ‰\"\n                                  >\n                                    <Search className=\"w-3 h-3\" />\n                                  </button>\n                                )}\n                              </div>\n                              {/* ë°œì£¼ ìƒì„¸ë³´ê¸° ë²„íŠ¼ */}\n                              {selectedPONumber && (() => {\n                                const selectedCandidate = allPONumberCandidates.find(\n                                  c => c.poNumber === selectedPONumber || c.salesOrderNumber === selectedPONumber\n                                );\n                                const purchaseId = selectedCandidate?.purchaseId || selectedCandidate?.items[0]?.purchase_id;\n                                if (!purchaseId) return null;\n                                return (\n                                  <button\n                                    onClick={(e) => {\n                                      e.stopPropagation();\n                                      setSelectedPurchaseIdForDetail(purchaseId);\n                                      setIsPurchaseDetailModalOpen(true);\n                                    }}\n                                    className=\"inline-flex items-center gap-0.5 px-1 h-5 text-[9px] font-medium text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded\"\n                                    title=\"ë°œì£¼ ìƒì„¸ ë³´ê¸°\"\n                                  >\n                                    <ExternalLink className=\"w-3 h-3\" />\n                                  </button>\n                                );\n                              })()}\n                              {/* ë“œë¡­ë‹¤ìš´ì€ fixed positionìœ¼ë¡œ ëª¨ë‹¬ ë°”ê¹¥ì— ë Œë”ë§ */}\n                            </div>\n                          )}\n                        </div>\n                      </th>\n                      \n                      {/* ì¤‘ì•™: ë§¤ì¹­ ìƒíƒœ (ë¹ˆ ì…€) */}\n                      <th className=\"border-r-2 border-gray-300 p-2 text-center bg-blue-50/30 w-[10%]\">\n                      </th>\n                      \n                      {/* ìš°ì¸¡: OCR ì¶”ì¶œ í’ˆëª© í—¤ë” */}\n                      <th colSpan={isSamePONumber ? 4 : 5} className=\"p-2 text-left w-[45%]\">\n                        <div className=\"flex items-center gap-2\">\n                          <span className=\"modal-section-title text-gray-700\">\n                            OCR ì¶”ì¶œ í’ˆëª©\n                          </span>\n                          {isSamePONumber && commonPONumber && (\n                            <div className=\"flex items-center gap-1\">\n                              <input\n                                type=\"text\"\n                                value={(() => {\n                                  // í¸ì§‘ëœ ê°’ì´ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ ì›ë³¸ ì‚¬ìš©\n                                  const firstItem = statementWithItems?.items[0];\n                                  if (firstItem) {\n                                    return getOCRItemValue(firstItem, 'po_number') as string;\n                                  }\n                                  return commonPONumber;\n                                })()}\n                                onChange={(e) => handleOCRPONumberChange(e.target.value)}\n                                className=\"px-1.5 h-5 bg-white border border-gray-300 text-gray-700 text-[10px] font-medium business-radius focus:outline-none focus:ring-1 focus:ring-gray-400\"\n                                style={{ fontSize: '11px', fontWeight: 500 }}\n                                title=\"OCR ì¶”ì¶œ ë°œì£¼ë²ˆí˜¸ (ìˆ˜ì • ê°€ëŠ¥)\"\n                              />\n                              {(() => {\n                                // í˜„ì¬ ì…ë ¥ëœ ê°’ ê°€ì ¸ì˜¤ê¸°\n                                const firstItem = statementWithItems?.items[0];\n                                const currentValue = firstItem ? (getOCRItemValue(firstItem, 'po_number') as string) : commonPONumber;\n                                const pairedNumber = getPairedOrderNumberWithOverrides(currentValue);\n                                if (pairedNumber) {\n                                  return <span className=\"text-gray-400 text-[10px] font-normal\" style={{ fontSize: '11px' }}>{pairedNumber}</span>;\n                                }\n                                return null;\n                              })()}\n                            </div>\n                          )}\n                          {isSamePONumber && !commonPONumber && (\n                            <div className=\"flex items-center gap-1\">\n                              <input\n                                type=\"text\"\n                                placeholder=\"ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ ì…ë ¥\"\n                                onChange={(e) => handleOCRPONumberChange(e.target.value)}\n                                className=\"px-1.5 h-5 bg-white border border-gray-300 text-gray-700 text-[10px] font-medium business-radius focus:outline-none focus:ring-1 focus:ring-gray-400\"\n                                style={{ fontSize: '11px', fontWeight: 500 }}\n                                title=\"ë°œì£¼ë²ˆí˜¸ ì§ì ‘ ì…ë ¥\"\n                              />\n                              {(() => {\n                                const firstItem = statementWithItems?.items[0];\n                                const currentValue = firstItem\n                                  ? (getOCRItemValue(firstItem, 'po_number') as string)\n                                  : '';\n                                const pairedNumber = getPairedOrderNumberWithOverrides(currentValue);\n                                if (!pairedNumber) return null;\n                                return (\n                                  <span className=\"text-gray-400 text-[10px] font-normal\" style={{ fontSize: '11px' }}>\n                                    {pairedNumber}\n                                  </span>\n                                );\n                              })()}\n                            </div>\n                          )}\n                        </div>\n                      </th>\n                    </tr>\n                    <tr className=\"modal-label\">\n                      {/* ì¢Œì¸¡ ì»¬ëŸ¼ */}\n                      {!isSamePONumber && (\n                        <th className=\"p-1 text-left whitespace-nowrap modal-label\">ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸</th>\n                      )}\n                      <th className=\"p-1 text-left modal-label\">í’ˆëª©ëª…</th>\n                      <th className=\"p-1 text-right modal-label\">ìˆ˜ëŸ‰</th>\n                      <th className=\"p-1 text-right modal-label\">ë‹¨ê°€</th>\n                      <th className=\"border-r-2 border-gray-300 p-1 text-right modal-label\">í•©ê³„</th>\n                      \n                      {/* ì¤‘ì•™ */}\n                      <th className=\"border-r-2 border-gray-300 p-1 text-center bg-blue-50/30\">\n                        <span className=\"text-gray-400 text-sm\">â‡„</span>\n                      </th>\n                      \n                      {/* ìš°ì¸¡ ì»¬ëŸ¼ */}\n                      <th className=\"p-1 text-left whitespace-nowrap modal-label\">í’ˆëª©ëª…</th>\n                      <th className=\"p-1 text-right whitespace-nowrap w-16 modal-label\">ìˆ˜ëŸ‰</th>\n                      <th className=\"p-1 text-right whitespace-nowrap w-20 modal-label\">ë‹¨ê°€</th>\n                      <th className=\"p-1 text-right whitespace-nowrap w-24 modal-label\">í•©ê³„</th>\n                      {!isSamePONumber && (\n                        <th className=\"p-1 text-left whitespace-nowrap modal-label\">ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸</th>\n                      )}\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white\">\n                    {statementWithItems.items.map((ocrItem, rowIndex) => {\n                      const getDisplayPOForItem = (item: TransactionStatementItemWithMatch) => {\n                        const normalizedExtracted = item.extracted_po_number\n                          ? normalizeOrderNumber(item.extracted_po_number)\n                          : undefined;\n                        const candidates = getPOCandidatesForItem(item.id);\n                        const candidateSet = new Set(candidates.map(candidate => normalizeOrderNumber(candidate)));\n                        const selected = itemPONumbers.get(item.id);\n                        const normalizedSelected = selected ? normalizeOrderNumber(selected) : '';\n                        const extractedInDb = normalizedExtracted && candidateSet.has(normalizedExtracted)\n                          ? normalizedExtracted\n                          : '';\n                        return normalizedSelected && candidateSet.has(normalizedSelected)\n                          ? normalizedSelected\n                          : extractedInDb;\n                      };\n                      const matchedSystem = itemMatches.get(ocrItem.id);\n                      const matchStatus = getMatchStatus(ocrItem);\n                      // OCR ì¶”ì¶œ ë²ˆí˜¸ë¥¼ ì‹œìŠ¤í…œ í˜•ì‹ìœ¼ë¡œ ì •ê·œí™” (ì˜ˆ: _01 â†’ _001, -1 â†’ -01)\n                      const normalizedExtractedPO = ocrItem.extracted_po_number \n                        ? normalizeOrderNumber(ocrItem.extracted_po_number) \n                        : undefined;\n                      const poCandidates = getPOCandidatesForItem(ocrItem.id);\n                      const normalizedCandidates = poCandidates.map(candidate => normalizeOrderNumber(candidate));\n                      const candidateSet = new Set(normalizedCandidates);\n                      const selectedPO = itemPONumbers.get(ocrItem.id);\n                      const normalizedSelectedPO = selectedPO ? normalizeOrderNumber(selectedPO) : '';\n                      const extractedInDb = normalizedExtractedPO && candidateSet.has(normalizedExtractedPO)\n                        ? normalizedExtractedPO\n                        : '';\n                      const itemPO = normalizedSelectedPO && candidateSet.has(normalizedSelectedPO)\n                        ? normalizedSelectedPO\n                        : extractedInDb;\n                      if (rowIndex < 5) {\n                        // #region agent log\n                        fetch('http://127.0.0.1:7242/ingest/b22edbac-a44c-4882-a88d-47f6cafc7628',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'StatementConfirmModal.tsx:render:grouping',message:'grouping_inputs',data:{rowIndex,ocrItemId:ocrItem.id,normalizedExtractedPO,selectedPO,normalizedSelectedPO,itemPO,candidateCount:poCandidates.length},timestamp:Date.now(),sessionId:'debug-session',runId:'run3',hypothesisId:'H1'})}).catch(()=>{});\n                        // #endregion\n                      }\n                      const orderedPOs = Array.from(new Set(poCandidates));\n                      const nextItem = statementWithItems.items[rowIndex + 1];\n                      const nextItemPO = nextItem ? getDisplayPOForItem(nextItem) : '';\n                      const isGroupEnd = rowIndex < statementWithItems.items.length - 1 && itemPO !== nextItemPO;\n                      const rowClassName = isGroupEnd\n                        ? 'hover:bg-gray-50 border-b-2 border-gray-500'\n                        : 'hover:bg-gray-50';\n                      if (rowIndex <= 1) {\n                        // #region agent log\n                        fetch('http://127.0.0.1:7242/ingest/b22edbac-a44c-4882-a88d-47f6cafc7628',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'StatementConfirmModal.tsx:render:headerDivider',message:'row_class_state',data:{rowIndex,isGroupEnd,rowClassName,itemPO,nextItemPO},timestamp:Date.now(),sessionId:'debug-session',runId:'run4',hypothesisId:'H1'})}).catch(()=>{});\n                        // #endregion\n                      }\n                      const itemSearchValue = itemPOSearchInputs[ocrItem.id] || '';\n                      const itemSearchResults = itemPOSearchResults[ocrItem.id] || [];\n                      const itemSearchLoading = itemPOSearchLoading[ocrItem.id] || false;\n                      const activePONumber = isSamePONumber ? selectedPONumber : (itemPO || '');\n                      const systemCandidates = getSystemItemsForPO(activePONumber);\n                      const fallbackCandidates = systemCandidates.length === 0 && activePONumber\n                        ? (ocrItem.match_candidates || [])\n                          .filter(candidate =>\n                            candidate.purchase_order_number === activePONumber ||\n                            candidate.sales_order_number === activePONumber\n                          )\n                          .map((candidate): SystemPurchaseItem => ({\n                            purchase_id: candidate.purchase_id,\n                            item_id: candidate.item_id,\n                            purchase_order_number: candidate.purchase_order_number || '',\n                            sales_order_number: candidate.sales_order_number,\n                            item_name: candidate.item_name || 'í’ˆëª©ëª… ì—†ìŒ',\n                            specification: candidate.specification,\n                            quantity: candidate.quantity,\n                            unit_price: candidate.unit_price,\n                            amount: (candidate as any).amount,\n                            vendor_name: candidate.vendor_name\n                          }))\n                        : [];\n                      const displaySystemCandidates = systemCandidates.length > 0 ? systemCandidates : fallbackCandidates;\n                      const scoredSystemCandidates = displaySystemCandidates\n                        .map((candidate) => ({\n                          candidate,\n                          score: calculateItemSimilarity(ocrItem.extracted_item_name || '', candidate.item_name, candidate.specification)\n                        }))\n                        .sort((a, b) => b.score - a.score);\n                      if (rowIndex === 0) {\n                        const logKey = `${ocrItem.id}|${isSamePONumber ? 'same' : 'multi'}|${activePONumber}|${systemCandidates.length}`;\n                        if (systemCandidateLogKeyRef.current !== logKey) {\n                          systemCandidateLogKeyRef.current = logKey;\n                          const firstCandidate = systemCandidates[0];\n                          if (firstCandidate) {\n                          }\n                        }\n                      }\n                      \n                      // ë°œì£¼/ìˆ˜ì£¼ ë²ˆí˜¸ ì¼ì¹˜ ì—¬ë¶€ ê³„ì‚° (ì²« í–‰ì—ì„œë§Œ ì‚¬ìš©)\n                      const normalizedSelectedPONumber = selectedPONumber\n                        ? normalizeOrderNumber(selectedPONumber)\n                        : '';\n                      const pairedOrderNumber = selectedPONumber\n                        ? getPairedOrderNumber(selectedPONumber)\n                        : undefined;\n                      const normalizedPairedOrderNumber = pairedOrderNumber\n                        ? normalizeOrderNumber(pairedOrderNumber)\n                        : '';\n                      const totalItemCount = statementWithItems.items.length;\n                      const extractedOrderNumbers = statementWithItems.items\n                        .map(item => getOCRItemValue(item, 'po_number') as string)\n                        .filter(Boolean)\n                        .map(value => normalizeOrderNumber(value));\n                      const hasOrderNumberMatch =\n                        !!normalizedSelectedPONumber &&\n                        extractedOrderNumbers.some(\n                          value =>\n                            value === normalizedSelectedPONumber ||\n                            (normalizedPairedOrderNumber && value === normalizedPairedOrderNumber)\n                        );\n                      const isFirstRow = rowIndex === 0;\n                      \n                      return (\n                        <tr key={ocrItem.id} className={rowClassName}>\n                          {/* Case 2: ë°œì£¼ë²ˆí˜¸ ì»¬ëŸ¼ */}\n                          {!isSamePONumber && (\n                            <td className=\"p-1 whitespace-nowrap\">\n                              <div className=\"relative\">\n                                <button\n                                  onClick={() => toggleDropdown(`po-${ocrItem.id}`)}\n                                  className=\"inline-flex items-center gap-1 px-1.5 h-5 text-[10px] font-medium bg-white border border-gray-300 business-radius hover:bg-gray-50 text-gray-700 whitespace-nowrap\"\n                                  style={{ fontSize: '11px' }}\n                                >\n                                  <span>{itemPO || 'ì„ íƒ'}</span>\n                                  <ChevronDown className=\"w-3 h-3 flex-shrink-0\" />\n                                </button>\n                                {openDropdowns.has(`po-${ocrItem.id}`) && (\n                                  <div className=\"absolute left-0 top-full mt-1 z-20 bg-white border border-gray-200 rounded-md shadow-lg w-[280px] max-h-[200px] overflow-auto\">\n                                    <div className=\"p-2 border-b border-gray-100\">\n                                      <div className=\"relative\">\n                                        <input\n                                          type=\"text\"\n                                          value={itemSearchValue}\n                                          onChange={(e) => handleItemPOSearch(ocrItem.id, e.target.value)}\n                                          placeholder=\"ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ ê²€ìƒ‰...\"\n                                          className=\"w-full h-6 px-2 pr-6 text-[10px] bg-white border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-hansl-400\"\n                                        />\n                                        {itemSearchLoading && (\n                                          <Loader2 className=\"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 animate-spin text-gray-400\" />\n                                        )}\n                                      </div>\n                                    </div>\n                                    {itemSearchValue && itemSearchResults.length > 0 && (\n                                      <div className=\"border-b border-gray-100\">\n                                        {itemSearchResults.map((po) => {\n                                          const searchUpper = itemSearchValue.trim().toUpperCase();\n                                          let selectedNumber: string;\n                                          if (searchUpper.startsWith('HS') && po.soNumber) {\n                                            selectedNumber = po.soNumber;\n                                          } else if (searchUpper.startsWith('F') && po.poNumber) {\n                                            selectedNumber = po.poNumber;\n                                          } else {\n                                            selectedNumber = po.poNumber || po.soNumber || '';\n                                          }\n                                          return (\n                                            <div\n                                              key={po.id}\n                                              className=\"px-2 py-1.5 hover:bg-gray-50 cursor-pointer text-[11px]\"\n                                              onClick={() => handleSelectItemPO(ocrItem.id, selectedNumber)}\n                                            >\n                                              <div className=\"flex items-center justify-between gap-2\">\n                                                <div className=\"font-medium text-gray-900\">\n                                                  {po.poNumber}\n                                                  {po.soNumber && <span className=\"text-gray-400 ml-1\">({po.soNumber})</span>}\n                                                </div>\n                                                <button\n                                                  type=\"button\"\n                                                  onMouseDown={(e) => e.preventDefault()}\n                                                  onClick={(e) => {\n                                                    e.stopPropagation();\n                                                    setSelectedPurchaseIdForDetail(po.id);\n                                                    setIsPurchaseDetailModalOpen(true);\n                                                  }}\n                                                  className=\"text-[9px] font-medium text-blue-600 hover:text-blue-800\"\n                                                >\n                                                  ìƒì„¸\n                                                </button>\n                                              </div>\n                                              {po.vendorName && (\n                                                <div className=\"text-[9px] text-gray-500\">{po.vendorName}</div>\n                                              )}\n                                            </div>\n                                          );\n                                        })}\n                                      </div>\n                                    )}\n                                    {orderedPOs.length > 0 && (\n                                      <div>\n                                        {orderedPOs.map((po, idx) => {\n                                          const paired = getPairedOrderNumber(po);\n                                          const purchaseId = getPurchaseIdByNumber(po);\n                                          const isPreferred = po === itemPO;\n                                          return (\n                                            <div\n                                              key={`${po}-${idx}`}\n                                              onClick={() => handleSelectItemPO(ocrItem.id, po)}\n                                              className={`px-2 py-1.5 hover:bg-gray-100 cursor-pointer text-[11px] font-medium ${isPreferred ? 'bg-gray-100 text-gray-900 font-semibold' : 'text-gray-700'}`}\n                                              style={{ fontSize: '11px' }}\n                                            >\n                                              <div className=\"flex items-center justify-between gap-2\">\n                                                <div>\n                                                  {po}\n                                                  {paired && <span className=\"text-gray-400 ml-1\">({paired})</span>}\n                                                  {isPreferred && <span className=\"text-orange-500 ml-1\">ì¶”ì²œ</span>}\n                                                </div>\n                                                {purchaseId && (\n                                                  <button\n                                                    type=\"button\"\n                                                    onMouseDown={(e) => e.preventDefault()}\n                                                    onClick={(e) => {\n                                                      e.stopPropagation();\n                                                      setSelectedPurchaseIdForDetail(purchaseId);\n                                                      setIsPurchaseDetailModalOpen(true);\n                                                    }}\n                                                    className=\"text-[9px] font-medium text-blue-600 hover:text-blue-800\"\n                                                  >\n                                                    ìƒì„¸\n                                                  </button>\n                                                )}\n                                              </div>\n                                            </div>\n                                          );\n                                        })}\n                                      </div>\n                                    )}\n                                  </div>\n                                )}\n                              </div>\n                            </td>\n                          )}\n                          \n                          {/* ì¢Œì¸¡: ì‹œìŠ¤í…œ í’ˆëª© */}\n                          <td className=\"p-1\">\n                            {displaySystemCandidates.length > 0 ? (\n                              <div className=\"relative\">\n                                <div className=\"flex items-center gap-1\">\n                                  <button\n                                    onClick={() => {\n                                      toggleDropdown(`item-${ocrItem.id}`);\n                                    }}\n                                    className=\"inline-flex items-center gap-1 px-1.5 h-5 text-[10px] font-normal bg-white border border-gray-300 business-radius hover:bg-gray-50 text-gray-700 whitespace-nowrap\"\n                                    style={{ fontSize: '11px' }}\n                                  >\n                                    <span>{getSystemItemLabel(matchedSystem) || 'ì„ íƒ'}</span>\n                                    <ChevronDown className=\"w-3 h-3 flex-shrink-0\" />\n                                  </button>\n                                  {matchedSystem && (\n                                    <button\n                                      onClick={() => handleSelectSystemItem(ocrItem.id, null)}\n                                      className=\"text-gray-400 hover:text-red-500 flex-shrink-0\"\n                                      title=\"ë§¤ì¹­ í•´ì œ\"\n                                    >\n                                      <XCircle className=\"w-3 h-3\" />\n                                    </button>\n                                  )}\n                                </div>\n                                {openDropdowns.has(`item-${ocrItem.id}`) && (\n                                  <div className=\"absolute left-0 top-full mt-1 z-20 bg-white border border-gray-200 rounded-md shadow-lg w-[280px] max-h-[200px] overflow-auto\">\n                                    {scoredSystemCandidates.map(({ candidate, score }, cidx) => {\n                                      return (\n                                        <div\n                                          key={cidx}\n                                          onClick={() => {\n                                            handleSelectSystemItem(ocrItem.id, candidate);\n                                          }}\n                                          className=\"px-2 py-1.5 hover:bg-gray-100 cursor-pointer\"\n                                        >\n                                          <div className=\"flex items-center justify-between\">\n                                            <p className=\"text-[11px] font-normal text-gray-900\" style={{ fontSize: '11px' }}>{getSystemItemLabel(candidate)}</p>\n                                            <span className={`text-[10px] px-1.5 py-0.5 rounded ${\n                                              score >= 80 ? 'bg-green-100 text-green-700' :\n                                              score >= 50 ? 'bg-yellow-100 text-yellow-700' :\n                                              'bg-gray-100 text-gray-600'\n                                            }`}>\n                                              {Math.round(score)}%\n                                            </span>\n                                          </div>\n                                          <p className=\"text-[10px] text-gray-500\">\n                                            ìš”ì²­/ì‹¤ì œ: {candidate.quantity ?? '-'} / {candidate.received_quantity ?? '-'}\n                                          </p>\n                                        </div>\n                                      );\n                                    })}\n                                  </div>\n                                )}\n                              </div>\n                            ) : (\n                              <span className=\"text-[11px] text-gray-400\" style={{ fontSize: '11px' }}>í›„ë³´ ì—†ìŒ</span>\n                            )}\n                          </td>\n                          <td className=\"p-1 text-right\">\n                            <span className=\"text-[11px] text-gray-700\" style={{ fontSize: '11px' }}>\n                              {matchedSystem?.quantity ?? '-'} / {matchedSystem?.received_quantity ?? '-'}\n                            </span>\n                          </td>\n                          <td className=\"p-1 text-right\">\n                            <span className=\"text-[11px] text-gray-700\" style={{ fontSize: '11px' }}>{matchedSystem ? formatAmount(matchedSystem.unit_price) : '-'}</span>\n                          </td>\n                          <td className=\"border-r-2 border-gray-300 p-1 text-right\">\n                            <span className=\"text-[11px] font-bold text-gray-900\" style={{ fontSize: '11px', fontWeight: 700 }}>{matchedSystem ? formatAmount(matchedSystem.amount) : '-'}</span>\n                          </td>\n                          \n                          {/* ì¤‘ì•™: ë°œì£¼/ìˆ˜ì£¼ ë²ˆí˜¸ ì¼ì¹˜ ìƒíƒœ (ì²« í–‰ì—ë§Œ rowSpanìœ¼ë¡œ ì„¸ë¡œ ì¤‘ì•™ í‘œì‹œ) */}\n                          {isFirstRow && (\n                            <td \n                              className=\"border-r-2 border-gray-300 px-2 py-1 text-center bg-blue-50/30 cursor-pointer hover:bg-blue-100/50 transition-colors\"\n                              rowSpan={totalItemCount}\n                              style={{ verticalAlign: 'middle' }}\n                              onClick={() => setIsIntegratedMatchDetailOpen(true)}\n                              title=\"í´ë¦­í•˜ì—¬ ìƒì„¸ ë‚´ì—­ ë³´ê¸°\"\n                            >\n                              <div className=\"flex flex-col items-center justify-center\">\n                                <span className={`text-[11px] font-bold ${\n                                  hasOrderNumberMatch ? 'text-green-600' : 'text-gray-500'\n                                }`}>\n                                  {hasOrderNumberMatch ? 'ë°œì£¼/ìˆ˜ì£¼ ë²ˆí˜¸ ì¼ì¹˜' : 'ë°œì£¼/ìˆ˜ì£¼ ë²ˆí˜¸ ë¶ˆì¼ì¹˜'}\n                                </span>\n                                <span className=\"text-[8px] text-blue-500 underline mt-0.5\">\n                                  ìƒì„¸ë³´ê¸°\n                                </span>\n                              </div>\n                            </td>\n                          )}\n                          \n                          {/* ìš°ì¸¡: OCR í’ˆëª© (í¸ì§‘ ê°€ëŠ¥) */}\n                          <td className=\"p-1 whitespace-nowrap\">\n                            <input\n                              type=\"text\"\n                              value={getOCRItemValue(ocrItem, 'item_name') as string}\n                              onChange={(e) => handleEditOCRItem(ocrItem.id, 'item_name', e.target.value)}\n                              className={`min-w-[180px] w-auto px-1 h-5 !text-[10px] !font-medium text-gray-900 border business-radius focus:outline-none focus:ring-1 focus:ring-blue-400 ${\n                                isOCRItemEdited(ocrItem, 'item_name') \n                                  ? 'border-orange-400 bg-orange-50' \n                                  : 'border-gray-200 bg-white'\n                              }`}\n                              style={{ fontSize: '11px', fontWeight: 500, width: `${Math.max(180, (getOCRItemValue(ocrItem, 'item_name') as string).length * 8)}px` }}\n                              title={isOCRItemEdited(ocrItem, 'item_name') ? `ì›ë³¸: ${ocrItem.extracted_item_name}` : undefined}\n                            />\n                          </td>\n                          <td className=\"p-1 text-right w-16\">\n                            <input\n                              type=\"number\"\n                              value={getOCRItemValue(ocrItem, 'quantity') as number}\n                              onChange={(e) => handleEditOCRItem(ocrItem.id, 'quantity', e.target.value ? Number(e.target.value) : 0)}\n                              className={`w-14 px-1 h-5 !text-[10px] !font-medium text-gray-900 text-right border business-radius focus:outline-none focus:ring-1 focus:ring-blue-400 ${\n                                isOCRItemEdited(ocrItem, 'quantity') \n                                  ? 'border-orange-400 bg-orange-50' \n                                  : 'border-gray-200 bg-white'\n                              }`}\n                              style={{ fontSize: '11px', fontWeight: 500 }}\n                              title={isOCRItemEdited(ocrItem, 'quantity') ? `ì›ë³¸: ${ocrItem.extracted_quantity}` : undefined}\n                            />\n                          </td>\n                          <td className=\"p-1 text-right w-20\">\n                            <input\n                              type=\"number\"\n                              value={getOCRItemValue(ocrItem, 'unit_price') as number}\n                              onChange={(e) => handleEditOCRItem(ocrItem.id, 'unit_price', e.target.value ? Number(e.target.value) : 0)}\n                              className={`w-16 px-1 h-5 !text-[10px] !font-medium text-gray-900 text-right border business-radius focus:outline-none focus:ring-1 focus:ring-blue-400 ${\n                                isOCRItemEdited(ocrItem, 'unit_price') \n                                  ? 'border-orange-400 bg-orange-50' \n                                  : 'border-gray-200 bg-white'\n                              }`}\n                              style={{ fontSize: '11px', fontWeight: 500 }}\n                              title={isOCRItemEdited(ocrItem, 'unit_price') ? `ì›ë³¸: ${ocrItem.extracted_unit_price}` : undefined}\n                            />\n                          </td>\n                          <td className=\"p-1 text-right w-24\">\n                            <input\n                              type=\"number\"\n                              value={getOCRItemValue(ocrItem, 'amount') as number}\n                              onChange={(e) => handleEditOCRItem(ocrItem.id, 'amount', e.target.value ? Number(e.target.value) : 0)}\n                              className={`w-20 px-1 h-5 !text-[10px] !font-bold text-gray-900 text-right border business-radius focus:outline-none focus:ring-1 focus:ring-blue-400 ${\n                                isOCRItemEdited(ocrItem, 'amount') \n                                  ? 'border-orange-400 bg-orange-50' \n                                  : 'border-gray-200 bg-white'\n                              }`}\n                              style={{ fontSize: '11px', fontWeight: 700 }}\n                              title={isOCRItemEdited(ocrItem, 'amount') ? `ì›ë³¸: ${ocrItem.extracted_amount}` : undefined}\n                            />\n                          </td>\n                          \n                          {/* Case 2: OCR ë°œì£¼ë²ˆí˜¸ í‘œì‹œ (í¸ì§‘ ê°€ëŠ¥) */}\n                          {!isSamePONumber && (\n                            <td className=\"p-1 whitespace-nowrap\">\n                              <div className=\"flex items-center gap-1\">\n                                <input\n                                  type=\"text\"\n                                  value={getOCRItemValue(ocrItem, 'po_number') as string}\n                                  onChange={(e) => {\n                                    const newValue = e.target.value;\n                                    lookupPairedOrderNumber(newValue);\n                                    handleEditOCRItem(ocrItem.id, 'po_number', newValue);\n                                  }}\n                                  className={`px-1.5 h-5 text-[10px] font-medium bg-white border business-radius focus:outline-none focus:ring-1 focus:ring-gray-400 text-gray-700 ${\n                                    isOCRItemEdited(ocrItem, 'po_number') \n                                      ? 'border-orange-400 bg-orange-50' \n                                      : 'border-gray-300'\n                                  }`}\n                                  style={{ fontSize: '11px', fontWeight: 500 }}\n                                  title={isOCRItemEdited(ocrItem, 'po_number') ? `ì›ë³¸: ${ocrItem.extracted_po_number}` : undefined}\n                                />\n                                {(() => {\n                                  const currentValue = getOCRItemValue(ocrItem, 'po_number') as string;\n                                  const pairedNumber = getPairedOrderNumberWithOverrides(currentValue);\n                                  if (!pairedNumber) return null;\n                                  return (\n                                    <span className=\"text-gray-400 text-[10px] font-normal\" style={{ fontSize: '11px' }}>\n                                      {pairedNumber}\n                                    </span>\n                                  );\n                                })()}\n                              </div>\n                            </td>\n                          )}\n                        </tr>\n                      );\n                    })}\n                    \n                    {/* í•©ê³„ í–‰ */}\n                    <tr className=\"bg-gray-50 font-medium border-t border-gray-100\">\n                      <td colSpan={isSamePONumber ? 3 : 4} className=\"p-1 text-right text-gray-600\">\n                        ì‹œìŠ¤í…œ í•©ê³„\n                      </td>\n                      <td className=\"border-r-2 border-gray-300 p-1 text-right text-gray-900\">\n                        {formatAmount(\n                          Array.from(itemMatches.values())\n                            .filter(Boolean)\n                            .reduce((sum, item) => sum + (item?.amount || 0), 0)\n                        )}\n                      </td>\n                      <td className=\"border-r-2 border-gray-300 p-1 bg-blue-50/50\"></td>\n                      <td colSpan={isSamePONumber ? 3 : 4} className=\"p-1 text-right text-gray-600\">\n                        OCR í•©ê³„\n                        {editedOCRItems.size > 0 && (\n                          <span className=\"ml-1 text-[9px] text-orange-600\">(ìˆ˜ì •ë¨)</span>\n                        )}\n                      </td>\n                      <td className=\"p-1 text-right text-gray-900\">\n                        {formatAmount(\n                          statementWithItems.items.reduce((sum, item) => {\n                            const edited = editedOCRItems.get(item.id);\n                            const amount = edited?.amount !== undefined ? edited.amount : (item.extracted_amount || 0);\n                            return sum + amount;\n                          }, 0)\n                        )}\n                      </td>\n                      {!isSamePONumber && <td className=\"p-1\"></td>}\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-center py-12\">\n              <p className=\"modal-subtitle\">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>\n            </div>\n          )}\n\n          <DialogFooter className=\"border-t border-gray-100 pt-3 px-4 gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={handleReject}\n              disabled={saving}\n              className=\"button-base h-8 text-[11px] text-red-500 border-red-200 hover:bg-red-50\"\n            >\n              <XCircle className=\"w-3.5 h-3.5 mr-1\" />\n              ê±°ë¶€\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={onClose}\n              disabled={saving}\n              className=\"button-base h-8 text-[11px]\"\n            >\n              ë‹«ê¸°\n            </Button>\n            <Button\n              onClick={handleConfirm}\n              disabled={saving || !statementWithItems}\n              className=\"button-base h-8 text-[11px] bg-hansl-600 hover:bg-hansl-700 text-white\"\n            >\n              {saving ? (\n                <>\n                  <Loader2 className=\"w-3.5 h-3.5 mr-1 animate-spin\" />\n                  ì²˜ë¦¬ ì¤‘...\n                </>\n              ) : (\n                <>\n                  <CheckCircle className=\"w-3.5 h-3.5 mr-1\" />\n                  í™•ì •\n                </>\n              )}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* ë§¤ì¹­ ìƒì„¸ ì •ë³´ íŒì—… */}\n      {matchDetailPopup && (\n        <Dialog open={matchDetailPopup.isOpen} onOpenChange={() => setMatchDetailPopup(null)}>\n          <DialogContent className=\"max-w-md\">\n            <DialogHeader>\n              <DialogTitle className=\"text-[14px] font-semibold text-gray-800\">\n                ë§¤ì¹­ ìƒì„¸ ì •ë³´\n              </DialogTitle>\n            </DialogHeader>\n            \n            <div className=\"space-y-4 py-2\">\n              {/* ë§¤ì¹­ ìƒíƒœ ë±ƒì§€ */}\n              <div className=\"flex items-center justify-center\">\n                {renderMatchStatusBadge(matchDetailPopup.status)}\n                <span className=\"ml-2 text-[12px] text-gray-600\">\n                  ìœ ì‚¬ë„: {matchDetailPopup.similarity.toFixed(1)}%\n                </span>\n              </div>\n              \n              {/* ë¹„êµ í…Œì´ë¸” */}\n              <div className=\"bg-gray-50 rounded-lg p-3 space-y-2\">\n                <div className=\"flex items-start gap-2\">\n                  <span className=\"text-[11px] font-medium text-gray-500 w-20 shrink-0\">OCR í’ˆëª©:</span>\n                  <span className=\"text-[11px] text-gray-800 break-all\">{matchDetailPopup.ocrItemName}</span>\n                </div>\n                <div className=\"flex items-start gap-2\">\n                  <span className=\"text-[11px] font-medium text-gray-500 w-20 shrink-0\">ì‹œìŠ¤í…œ í’ˆëª©:</span>\n                  <span className=\"text-[11px] text-gray-800 break-all\">{matchDetailPopup.systemItemName}</span>\n                </div>\n                {matchDetailPopup.systemSpec && matchDetailPopup.systemSpec !== '-' && (\n                  <div className=\"flex items-start gap-2\">\n                    <span className=\"text-[11px] font-medium text-gray-500 w-20 shrink-0\">ì‹œìŠ¤í…œ ê·œê²©:</span>\n                    <span className=\"text-[11px] text-gray-800 break-all\">{matchDetailPopup.systemSpec}</span>\n                  </div>\n                )}\n              </div>\n              \n              {/* ë§¤ì¹­ ì´ìœ  */}\n              <div className=\"space-y-1\">\n                <span className=\"text-[11px] font-medium text-gray-600\">ë§¤ì¹­ íŒì • ì´ìœ :</span>\n                <ul className=\"space-y-1\">\n                  {matchDetailPopup.reasons.map((reason, idx) => (\n                    <li key={idx} className=\"text-[11px] text-gray-700 pl-2\">\n                      {reason}\n                    </li>\n                  ))}\n                </ul>\n              </div>\n            </div>\n            \n            <DialogFooter>\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                onClick={() => setMatchDetailPopup(null)}\n                className=\"text-[11px]\"\n              >\n                ë‹«ê¸°\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      )}\n\n      {/* í†µí•© ë§¤ì¹­ ìƒì„¸ íŒì—… (ë°œì£¼ë²ˆí˜¸ ì „ì²´ ë§¤ì¹­ ë‚´ì—­) */}\n      <Dialog open={isIntegratedMatchDetailOpen} onOpenChange={setIsIntegratedMatchDetailOpen}>\n        <DialogContent className=\"max-w-lg\">\n          <DialogHeader>\n            <DialogTitle className=\"text-[14px] font-semibold text-gray-800\">\n              ë§¤ì¹­ ìƒì„¸ ë‚´ì—­\n            </DialogTitle>\n          </DialogHeader>\n          \n          <div className=\"space-y-4 py-2\">\n            {/* í†µí•© ë§¤ì¹­ë¥  í‘œì‹œ */}\n            {(() => {\n              const selectedCandidate = allPONumberCandidates.find(\n                c => c.poNumber === selectedPONumber || c.salesOrderNumber === selectedPONumber\n              );\n              // í‘œì‹œìš© ì ìˆ˜ ì‚¬ìš© (ì‹¤ì œ í’ˆëª© ìœ ì‚¬ë„, ìµœëŒ€ 100%)\n              const totalMatchScore = Math.min(100, selectedCandidate?.displayScore ?? selectedCandidate?.setMatchScore ?? 0);\n              const matchedCount = selectedCandidate?.matchedItemCount ?? 0;\n              const totalCount = statementWithItems?.items.length ?? 0;\n              const normalizedSelectedPONumber = selectedPONumber\n                ? normalizeOrderNumber(selectedPONumber)\n                : '';\n              const pairedOrderNumber = selectedPONumber\n                ? getPairedOrderNumber(selectedPONumber)\n                : undefined;\n              const normalizedPairedOrderNumber = pairedOrderNumber\n                ? normalizeOrderNumber(pairedOrderNumber)\n                : '';\n              const extractedOrderNumbers = (statementWithItems?.items ?? [])\n                .map(item => getOCRItemValue(item, 'po_number') as string)\n                .filter(Boolean)\n                .map(value => normalizeOrderNumber(value));\n              const isOrderNumberMatched =\n                !!normalizedSelectedPONumber &&\n                extractedOrderNumbers.some(\n                  value =>\n                    value === normalizedSelectedPONumber ||\n                    (normalizedPairedOrderNumber && value === normalizedPairedOrderNumber)\n                );\n              const matchedNameCount = (statementWithItems?.items ?? []).filter(ocrItem => {\n                const matchedSystem = itemMatches.get(ocrItem.id);\n                if (!matchedSystem) return false;\n                const similarity = calculateItemSimilarity(\n                  (getOCRItemValue(ocrItem, 'item_name') as string) || '',\n                  matchedSystem.item_name,\n                  matchedSystem.specification\n                );\n                return similarity >= 40; // ìµœì†Œ 40ì  ì´ìƒ\n              }).length;\n              const quantityMatchedCount = (statementWithItems?.items ?? []).filter(ocrItem => {\n                const matchedSystem = itemMatches.get(ocrItem.id);\n                if (!matchedSystem) return false;\n                const ocrQty = getOCRItemValue(ocrItem, 'quantity') as number | string;\n                const normalizedQty = typeof ocrQty === 'number'\n                  ? ocrQty\n                  : (ocrQty !== '' ? Number(ocrQty) : undefined);\n                return isQuantityMatched(normalizedQty, matchedSystem.quantity);\n              }).length;\n              const isItemNameAllMatched = totalCount > 0 && matchedNameCount === totalCount;\n              const isQuantityAllMatched = totalCount > 0 && quantityMatchedCount === totalCount;\n              \n              return (\n                <>\n                  <div className=\"flex items-center justify-center gap-3 p-4 bg-gray-50 rounded-lg\">\n                    <span className={`text-3xl font-bold ${\n                      totalMatchScore >= 80 ? 'text-green-600' :\n                      totalMatchScore >= 50 ? 'text-yellow-600' :\n                      'text-gray-500'\n                    }`}>\n                      {totalMatchScore}%\n                    </span>\n                    <div className=\"text-left\">\n                      <p className=\"text-[12px] font-medium text-gray-700\">\n                        ë°œì£¼ë²ˆí˜¸: {selectedPONumber || 'ë¯¸ì„ íƒ'}\n                      </p>\n                      <p className=\"text-[11px] text-gray-500\">\n                        {matchedCount}/{totalCount}ê°œ í’ˆëª© ë§¤ì¹­ë¨\n                      </p>\n                    </div>\n                  </div>\n\n                  {/* ë§¤ì¹­ ì²´í¬ ìš”ì•½ */}\n                  <div className=\"grid grid-cols-1 gap-2 rounded-lg border border-gray-200 p-3\">\n                    <div className=\"flex items-center justify-between text-[11px]\">\n                      <span className=\"text-gray-600\">ë°œì£¼/ìˆ˜ì£¼ë²ˆí˜¸ ë§¤ì¹­</span>\n                      <span className={`font-medium ${isOrderNumberMatched ? 'text-green-600' : 'text-red-600'}`}>\n                        {isOrderNumberMatched ? 'âœ… ì¼ì¹˜' : 'âŒ ë¶ˆì¼ì¹˜'}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center justify-between text-[11px]\">\n                      <span className=\"text-gray-600\">í’ˆëª©ëª… ë§¤ì¹­</span>\n                      <span className={`font-medium ${isItemNameAllMatched ? 'text-green-600' : 'text-red-600'}`}>\n                        {isItemNameAllMatched ? `âœ… ëª¨ë‘ ì¼ì¹˜ (${matchedNameCount}/${totalCount})` : `âŒ ë¶ˆì¼ì¹˜ (${matchedNameCount}/${totalCount})`}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center justify-between text-[11px]\">\n                      <span className=\"text-gray-600\">ìˆ˜ëŸ‰ ë§¤ì¹­</span>\n                      <span className={`font-medium ${isQuantityAllMatched ? 'text-green-600' : 'text-red-600'}`}>\n                        {isQuantityAllMatched ? `âœ… ëª¨ë‘ ì¼ì¹˜ (${quantityMatchedCount}/${totalCount})` : `âŒ ë¶ˆì¼ì¹˜ (${quantityMatchedCount}/${totalCount})`}\n                      </span>\n                    </div>\n                  </div>\n\n                  {/* í’ˆëª©ë³„ ë§¤ì¹­ ìƒì„¸ */}\n                  <div className=\"space-y-2\">\n                    <p className=\"text-[11px] font-semibold text-gray-600\">í’ˆëª©ë³„ ë§¤ì¹­ ìƒì„¸:</p>\n                    <div className=\"max-h-[250px] overflow-y-auto space-y-2\">\n                      {statementWithItems?.items.map((ocrItem) => {\n                        const matchedSystem = itemMatches.get(ocrItem.id);\n                        const similarity = matchedSystem \n                          ? calculateItemSimilarity(\n                              (getOCRItemValue(ocrItem, 'item_name') as string) || '', \n                              matchedSystem.item_name, \n                              matchedSystem.specification\n                            )\n                          : 0;\n                        const isMatched = similarity >= 40; // ìµœì†Œ 40ì  ì´ìƒ\n                        \n                        // ìˆ˜ëŸ‰ ì¼ì¹˜ ì—¬ë¶€\n                        const ocrQtyRaw = getOCRItemValue(ocrItem, 'quantity') as number | string;\n                        const ocrQty = typeof ocrQtyRaw === 'number'\n                          ? ocrQtyRaw\n                          : (ocrQtyRaw !== '' ? Number(ocrQtyRaw) : undefined);\n                        const sysQty = matchedSystem?.quantity;\n                        const qtyMatched = isQuantityMatched(ocrQty, sysQty);\n                        const qtyLevel = getQuantityMatchLevel(ocrQty, sysQty);\n                        \n                        return (\n                          <div \n                            key={ocrItem.id} \n                            className={`p-2 rounded-lg border ${\n                              isMatched && qtyMatched ? 'bg-green-50 border-green-200' : \n                              isMatched ? 'bg-yellow-50 border-yellow-200' :\n                              'bg-gray-50 border-gray-200'\n                            }`}\n                          >\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex-1 min-w-0\">\n                                <p className=\"text-[11px] font-medium text-gray-800 truncate\">\n                                  {ocrItem.extracted_item_name || '-'}\n                                </p>\n                                <p className=\"text-[10px] text-gray-500\">\n                                  â†’ {matchedSystem?.item_name || 'ë¯¸ë§¤ì¹­'}\n                                </p>\n                              </div>\n                              <span className={`text-[10px] px-2 py-0.5 rounded font-medium ml-2 ${\n                                similarity >= 85 ? 'bg-green-100 text-green-700' :\n                                similarity >= 60 ? 'bg-yellow-100 text-yellow-700' :\n                                similarity >= 40 ? 'bg-orange-100 text-orange-700' :\n                                'bg-red-100 text-red-600'\n                              }`}>\n                                {isMatched ? `${Math.round(similarity)}%` : 'ë¯¸ë§¤ì¹­'}\n                              </span>\n                            </div>\n                            {/* ìˆ˜ëŸ‰ ë¹„êµ */}\n                            {isMatched && (\n                              <div className=\"flex items-center gap-2 mt-1.5 pt-1.5 border-t border-gray-100\">\n                                <span className=\"text-[10px] text-gray-500\">ìˆ˜ëŸ‰:</span>\n                                <span className=\"text-[10px] font-medium text-gray-700\">\n                                  OCR {ocrQty ?? '-'}ê°œ\n                                </span>\n                                <span className=\"text-[10px] text-gray-400\">vs</span>\n                                <span className=\"text-[10px] font-medium text-gray-700\">\n                                  ì‹œìŠ¤í…œ {sysQty ?? '-'}ê°œ\n                                </span>\n                                <span className={`text-[9px] px-1.5 py-0.5 rounded ${\n                                  qtyMatched ? 'bg-green-100 text-green-700' :\n                                  qtyLevel === 'partial' ? 'bg-yellow-100 text-yellow-700' :\n                                  'bg-red-100 text-red-700'\n                                }`}>\n                                  {qtyMatched ? 'âœ… ì¼ì¹˜' : \n                                   qtyLevel === 'partial' ? 'âš ï¸ ë¶€ë¶„ì…ê³ ' : \n                                   'âŒ ë¶ˆì¼ì¹˜'}\n                                </span>\n                              </div>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  </div>\n                </>\n              );\n            })()}\n          </div>\n          \n          <DialogFooter>\n            <Button \n              variant=\"outline\" \n              size=\"sm\" \n              onClick={() => setIsIntegratedMatchDetailOpen(false)}\n              className=\"text-[11px]\"\n            >\n              ë‹«ê¸°\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      {/* ì´ë¯¸ì§€ ë·°ì–´ */}\n      <StatementImageViewer\n        isOpen={isImageViewerOpen}\n        imageUrl={statement.image_url}\n        onClose={() => setIsImageViewerOpen(false)}\n      />\n\n      {/* ë°œì£¼ë²ˆí˜¸ ì„ íƒ ë“œë¡­ë‹¤ìš´ (Portalë¡œ document.bodyì— ë Œë”ë§í•˜ì—¬ Dialog ì´ë²¤íŠ¸ ì°¨ë‹¨ ìš°íšŒ) */}\n      {openDropdowns.has('global-po') && createPortal(\n        <>\n          {/* ì˜¤ë²„ë ˆì´ */}\n          <div \n            className=\"fixed inset-0 z-[100]\" \n            style={{ pointerEvents: 'auto' }}\n            onClick={() => toggleDropdown('global-po')}\n          />\n          {/* ë“œë¡­ë‹¤ìš´ */}\n          <div \n            className=\"fixed z-[101] bg-white border border-gray-200 rounded-lg shadow-xl min-w-[280px] max-h-[350px] overflow-y-auto\"\n            style={{\n              top: dropdownPosition.top,\n              left: dropdownPosition.left,\n              pointerEvents: 'auto'\n            }}\n            onClick={(e) => e.stopPropagation()}\n          >\n            <div className=\"sticky top-0 bg-gray-50 px-3 py-2 border-b border-gray-100 rounded-t-lg\">\n              <span className=\"text-[10px] font-semibold text-gray-600\">ë°œì£¼ë²ˆí˜¸ ì„ íƒ</span>\n            </div>\n            {/* allPONumberCandidatesëŠ” ì´ë¯¸ ë°œì£¼ë²ˆí˜¸ ì¼ì¹˜ â†’ ì ìˆ˜ìˆœìœ¼ë¡œ ì •ë ¬ë¨ */}\n            {allPONumberCandidates.map((c, idx) => {\n              const displayNumber = c.poNumber || c.salesOrderNumber || '';\n              const isSelected = selectedPONumber === displayNumber;\n              const isBestMatch = setMatchResult?.bestMatch?.purchase_order_number === c.poNumber ||\n                                 setMatchResult?.bestMatch?.sales_order_number === c.salesOrderNumber;\n              \n              return (\n                <div\n                  key={idx}\n                  onClick={(e) => {\n                    e.stopPropagation();\n                    handleSelectGlobalPO(displayNumber);\n                    toggleDropdown('global-po');\n                  }}\n                  className={`p-2.5 cursor-pointer border-b border-gray-50 last:border-0 transition-colors ${\n                    isSelected ? 'bg-blue-50' : 'hover:bg-gray-50'\n                  } ${isBestMatch ? 'ring-1 ring-inset ring-green-400' : ''}`}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <p className=\"text-[12px] font-medium text-gray-900\">\n                      {c.poNumber || c.salesOrderNumber}\n                      {c.poNumber && c.salesOrderNumber && (\n                        <span className=\"text-gray-500 font-normal\"> ({c.salesOrderNumber})</span>\n                      )}\n                    </p>\n                    {(c.displayScore !== undefined || c.setMatchScore !== undefined) && (\n                      <span className={`text-[10px] px-1.5 py-0.5 rounded font-medium ${\n                        (c.displayScore ?? c.setMatchScore ?? 0) >= 80 ? 'bg-green-100 text-green-700' :\n                        (c.displayScore ?? c.setMatchScore ?? 0) >= 50 ? 'bg-yellow-100 text-yellow-700' :\n                        'bg-gray-100 text-gray-600'\n                      }`}>\n                        {Math.min(100, c.displayScore ?? c.setMatchScore ?? 0)}%\n                      </span>\n                    )}\n                  </div>\n                  <p className=\"text-[10px] text-gray-500 mt-0.5\">\n                    {c.matchedItemCount !== undefined \n                      ? `${c.matchedItemCount}/${statementWithItems?.items.length || 0}ê°œ ë§¤ì¹­`\n                      : `${c.itemCount}ê°œ í’ˆëª©`\n                    } Â· {c.vendorName || 'ê±°ë˜ì²˜ ë¯¸ìƒ'}\n                  </p>\n                  {/* ìˆ˜ëŸ‰ ì¼ì¹˜ ì •ë³´ */}\n                  {c.quantityMatchedCount !== undefined && c.matchedItemCount !== undefined && c.matchedItemCount > 0 && (\n                    <p className={`text-[9px] mt-0.5 ${\n                      c.quantityMismatchedCount === 0 ? 'text-green-600' : 'text-orange-600'\n                    }`}>\n                      {c.quantityMismatchedCount === 0 \n                        ? `âœ… ìˆ˜ëŸ‰ ëª¨ë‘ ì¼ì¹˜`\n                        : `âš ï¸ ìˆ˜ëŸ‰ ${c.quantityMismatchedCount}ê°œ ë¶ˆì¼ì¹˜`\n                      }\n                    </p>\n                  )}\n                  {isBestMatch && (\n                    <p className=\"text-[9px] text-green-600 font-medium mt-0.5\">\n                      âœ… ì„¸íŠ¸ ë§¤ì¹­ ì¶”ì²œ\n                    </p>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n        </>,\n        document.body\n      )}\n\n      {/* ë°œì£¼ ìƒì„¸ ëª¨ë‹¬ */}\n      {selectedPurchaseIdForDetail && (\n        <PurchaseDetailModal\n          purchaseId={selectedPurchaseIdForDetail}\n          isOpen={isPurchaseDetailModalOpen}\n          onClose={() => {\n            setIsPurchaseDetailModalOpen(false);\n            setSelectedPurchaseIdForDetail(null);\n          }}\n          activeTab=\"receipt\"\n        />\n      )}\n    </>\n  );\n}\n","import { useState, useEffect, useCallback, useRef } from \"react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { \n  Search, \n  FileCheck, \n  Plus, \n  Trash2, \n  Eye,\n  CheckCircle,\n  Clock,\n  AlertCircle,\n  XCircle,\n  Loader2,\n  RefreshCw,\n  Image as ImageIcon,\n  SlidersHorizontal,\n  ChevronRight,\n  ExternalLink,\n  X\n} from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport transactionStatementService from \"@/services/transactionStatementService\";\nimport type { \n  TransactionStatement, \n  TransactionStatementStatus \n} from \"@/types/transactionStatement\";\nimport StatementUploadModal from \"./StatementUploadModal\";\nimport StatementConfirmModal from \"./StatementConfirmModal\";\nimport StatementImageViewer from \"./StatementImageViewer\";\nimport PurchaseDetailModal from \"@/components/purchase/PurchaseDetailModal\";\n\n/**\n * ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ë©”ì¸ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸\n * \n * ê±°ë˜ëª…ì„¸ì„œ ëª©ë¡ ì¡°íšŒ, ì—…ë¡œë“œ, OCR ì¶”ì¶œ, ë°œì£¼ ë§¤ì¹­, í™•ì • ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.\n */\nexport default function TransactionStatementMain() {\n  const [statements, setStatements] = useState<TransactionStatement[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [statusFilter, setStatusFilter] = useState<string>(\"all\");\n  const [dateFilter, setDateFilter] = useState(\"\");\n  const [totalCount, setTotalCount] = useState(0);\n  const [showFilters, setShowFilters] = useState(false);\n  \n  // ëª¨ë‹¬ ìƒíƒœ\n  const [isUploadModalOpen, setIsUploadModalOpen] = useState(false);\n  const [selectedStatement, setSelectedStatement] = useState<TransactionStatement | null>(null);\n  const [isConfirmModalOpen, setIsConfirmModalOpen] = useState(false);\n  const [isImageViewerOpen, setIsImageViewerOpen] = useState(false);\n  const [viewerImageUrl, setViewerImageUrl] = useState<string>(\"\");\n  \n  // OCR ì¶”ì¶œ ì§„í–‰ ì¤‘ì¸ IDë“¤\n  const [extractingIds, setExtractingIds] = useState<Set<string>>(new Set());\n  \n  // ë°œì£¼ ìƒì„¸ ëª¨ë‹¬ ìƒíƒœ\n  const [isPurchaseModalOpen, setIsPurchaseModalOpen] = useState(false);\n  const [selectedPurchaseId, setSelectedPurchaseId] = useState<number | null>(null);\n  \n  // ë°œì£¼ ëª©ë¡ ë“œë¡­ë‹¤ìš´ ìƒíƒœ\n  const [purchaseDropdown, setPurchaseDropdown] = useState<{\n    isOpen: boolean;\n    statement: TransactionStatement | null;\n    position: { top: number; left: number };\n  }>({ isOpen: false, statement: null, position: { top: 0, left: 0 } });\n\n  // ë°ì´í„° ë¡œë“œ\n  const loadStatements = useCallback(async () => {\n    try {\n      setLoading(true);\n      const result = await transactionStatementService.getStatements({\n        status: statusFilter !== 'all' ? statusFilter : undefined,\n        dateFrom: dateFilter || undefined,\n        search: searchTerm || undefined,\n        limit: 50\n      });\n\n      if (result.success) {\n        setStatements(result.data || []);\n        setTotalCount(result.count || 0);\n      } else {\n        toast.error(result.error || 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      toast.error('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    } finally {\n      setLoading(false);\n    }\n  }, [statusFilter, dateFilter, searchTerm]);\n\n  useEffect(() => {\n    loadStatements();\n  }, [loadStatements]);\n\n  // Supabase Realtime êµ¬ë… - ìƒíƒœ ë³€ê²½ ì‹œ ìë™ ê°±ì‹ \n  const supabaseRef = useRef(createClient());\n  \n  useEffect(() => {\n    const supabase = supabaseRef.current;\n    \n    // transaction_statements í…Œì´ë¸”ì˜ ë³€ê²½ì‚¬í•­ êµ¬ë…\n    const channel = supabase\n      .channel('transaction-statements-changes')\n      .on(\n        'postgres_changes',\n        {\n          event: '*', // INSERT, UPDATE, DELETE ëª¨ë‘ êµ¬ë…\n          schema: 'public',\n          table: 'transaction_statements'\n        },\n        (payload: any) => {\n          console.log('[Realtime] Statement changed:', payload);\n          \n          // ìƒíƒœê°€ ë³€ê²½ë˜ë©´ ëª©ë¡ ê°±ì‹ \n          if (payload.eventType === 'UPDATE') {\n            const newStatus = payload.new?.status;\n            const oldStatus = payload.old?.status;\n            \n            // ìƒíƒœê°€ processing â†’ extracted ë˜ëŠ” ë‹¤ë¥¸ ìƒíƒœë¡œ ë³€ê²½ëì„ ë•Œ\n            if (newStatus !== oldStatus) {\n              console.log(`[Realtime] Status changed: ${oldStatus} â†’ ${newStatus}`);\n              loadStatements();\n            }\n          } else if (payload.eventType === 'INSERT' || payload.eventType === 'DELETE') {\n            loadStatements();\n          }\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [loadStatements]);\n\n  // ìƒíƒœ ë°°ì§€ ë Œë”ë§\n  const renderStatusBadge = (status: TransactionStatementStatus) => {\n    const baseClass = \"inline-flex items-center gap-1 business-radius-badge px-2 py-0.5 text-[10px] font-medium leading-tight\";\n    \n    switch (status) {\n      case 'pending':\n        return (\n          <span className={`${baseClass} bg-gray-100 text-gray-600 border border-gray-200`}>\n            <Clock className=\"w-3 h-3\" />\n            ëŒ€ê¸°ì¤‘\n          </span>\n        );\n      case 'processing':\n        return (\n          <span className={`${baseClass} bg-blue-50 text-blue-600 border border-blue-200`}>\n            <Loader2 className=\"w-3 h-3 animate-spin\" />\n            ì²˜ë¦¬ì¤‘\n          </span>\n        );\n      case 'extracted':\n        return (\n          <span className={`${baseClass} bg-yellow-50 text-yellow-600 border border-yellow-200`}>\n            <AlertCircle className=\"w-3 h-3\" />\n            í™•ì¸í•„ìš”\n          </span>\n        );\n      case 'confirmed':\n        return (\n          <span className={`${baseClass} bg-green-50 text-green-600 border border-green-200`}>\n            <CheckCircle className=\"w-3 h-3\" />\n            í™•ì •ë¨\n          </span>\n        );\n      case 'rejected':\n        return (\n          <span className={`${baseClass} bg-red-50 text-red-600 border border-red-200`}>\n            <XCircle className=\"w-3 h-3\" />\n            ê±°ë¶€ë¨\n          </span>\n        );\n      default:\n        return <span className={`${baseClass} bg-gray-100 text-gray-600`}>{status}</span>;\n    }\n  };\n\n  // ìƒì„¸ ëª¨ë‹¬ ì—´ê¸°\n  const handleViewStatement = (statement: TransactionStatement, event?: React.MouseEvent) => {\n    setSelectedStatement(statement);\n    \n    if (statement.status === 'extracted') {\n      // í™•ì¸í•„ìš” ìƒíƒœ - í™•ì¸ ëª¨ë‹¬ ì—´ê¸°\n      setIsConfirmModalOpen(true);\n    } else if (statement.status === 'confirmed' && statement.matched_purchases && statement.matched_purchases.length > 0) {\n      // í™•ì •ë¨ + ë°œì£¼ ë§¤ì¹­ë¨\n      if (statement.matched_purchases.length === 1) {\n        // ë°œì£¼ê°€ 1ê°œë©´ ë°”ë¡œ ìƒì„¸ ëª¨ë‹¬ ì—´ê¸°\n        setSelectedPurchaseId(statement.matched_purchases[0].purchase_id);\n        setIsPurchaseModalOpen(true);\n      } else {\n        // ë°œì£¼ê°€ ì—¬ëŸ¬ ê°œë©´ ë“œë¡­ë‹¤ìš´ í‘œì‹œ\n        const rect = (event?.currentTarget as HTMLElement)?.getBoundingClientRect();\n        setPurchaseDropdown({\n          isOpen: true,\n          statement,\n          position: {\n            top: rect ? rect.bottom + window.scrollY : 0,\n            left: rect ? rect.left + window.scrollX : 0\n          }\n        });\n      }\n    } else if (statement.status === 'confirmed' || statement.status === 'pending') {\n      // ê·¸ ì™¸ - ì´ë¯¸ì§€ ë·°ì–´ ì—´ê¸°\n      setViewerImageUrl(statement.image_url);\n      setIsImageViewerOpen(true);\n    }\n  };\n  \n  // ë°œì£¼ ì„ íƒí•˜ì—¬ ìƒì„¸ ëª¨ë‹¬ ì—´ê¸°\n  const handleSelectPurchase = (purchaseId: number) => {\n    setPurchaseDropdown({ isOpen: false, statement: null, position: { top: 0, left: 0 } });\n    setSelectedPurchaseId(purchaseId);\n    setIsPurchaseModalOpen(true);\n  };\n  \n  // ë“œë¡­ë‹¤ìš´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°\n  const handleClosePurchaseDropdown = () => {\n    setPurchaseDropdown({ isOpen: false, statement: null, position: { top: 0, left: 0 } });\n  };\n\n  // ì´ë¯¸ì§€ ë·°ì–´ ì—´ê¸°\n  const handleViewImage = (e: React.MouseEvent, imageUrl: string) => {\n    e.stopPropagation();\n    setViewerImageUrl(imageUrl);\n    setIsImageViewerOpen(true);\n  };\n\n  // OCR ì¶”ì¶œ ì‹œì‘\n  const handleStartExtraction = async (e: React.MouseEvent, statement: TransactionStatement) => {\n    e.stopPropagation();\n    console.log('[OCR] Button clicked, statement:', statement);\n    \n    if (statement.status !== 'pending' || extractingIds.has(statement.id)) {\n      console.log('[OCR] Status is not pending or already extracting:', statement.status);\n      toast.info('ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì´ê±°ë‚˜ ì™„ë£Œëœ ê±´ì…ë‹ˆë‹¤.');\n      return;\n    }\n\n    // ì¶”ì¶œ ì‹œì‘ - ID ì¶”ê°€\n    setExtractingIds(prev => new Set(prev).add(statement.id));\n\n    try {\n      console.log('[OCR] Starting extraction...');\n      toast.loading('OCR ì¶”ì¶œ ì¤‘... (ì•½ 10~30ì´ˆ ì†Œìš”)', { id: `extraction-${statement.id}` });\n      \n      const result = await transactionStatementService.extractStatementData(\n        statement.id,\n        statement.image_url\n      );\n      console.log('[OCR] Result:', result);\n\n      if (result.success) {\n        toast.success('OCR ì¶”ì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', { id: `extraction-${statement.id}` });\n        loadStatements();\n        \n        if (result.data) {\n          setSelectedStatement(result.data);\n          setIsConfirmModalOpen(true);\n        }\n      } else {\n        console.error('[OCR] Failed:', result.error);\n        toast.error(result.error || 'OCR ì¶”ì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', { id: `extraction-${statement.id}` });\n      }\n    } catch (error) {\n      console.error('[OCR] Error:', error);\n      toast.error('OCR ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', { id: `extraction-${statement.id}` });\n    } finally {\n      // ì¶”ì¶œ ì™„ë£Œ - ID ì œê±°\n      setExtractingIds(prev => {\n        const next = new Set(prev);\n        next.delete(statement.id);\n        return next;\n      });\n    }\n  };\n\n  // ì‚­ì œ\n  const handleDelete = async (e: React.MouseEvent, statement: TransactionStatement) => {\n    e.stopPropagation();\n    \n    if (!confirm(`\"${statement.file_name || 'ì´ ê±°ë˜ëª…ì„¸ì„œ'}\"ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {\n      return;\n    }\n\n    try {\n      const result = await transactionStatementService.deleteStatement(statement.id);\n      \n      if (result.success) {\n        toast.success('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');\n        loadStatements();\n      } else {\n        toast.error(result.error || 'ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n      }\n    } catch (error) {\n      toast.error('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ì—…ë¡œë“œ ì„±ê³µ í›„ ì²˜ë¦¬ - ìë™ìœ¼ë¡œ OCR ì‹œì‘\n  const handleUploadSuccess = async (statementId: string, imageUrl: string) => {\n    setIsUploadModalOpen(false);\n    \n    // 1. ì—…ë¡œë“œ ì§í›„ ë°”ë¡œ ëª©ë¡ ê°±ì‹  (ëª©ë¡ì— ì¦‰ì‹œ í‘œì‹œ)\n    await loadStatements();\n    \n    // 2. ì²˜ë¦¬ì¤‘ í‘œì‹œë¥¼ ìœ„í•´ extractingIdsì— ì¶”ê°€\n    setExtractingIds(prev => new Set(prev).add(statementId));\n    \n    // 3. OCR ì¶”ì¶œ ì‹œì‘\n    try {\n      toast.loading('OCR ì¶”ì¶œ ì¤‘... (ì•½ 10~30ì´ˆ ì†Œìš”)', { id: `extraction-${statementId}` });\n      \n      const result = await transactionStatementService.extractStatementData(statementId, imageUrl);\n      \n      if (result.success) {\n        toast.success('OCR ì¶”ì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê²°ê³¼ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.', { id: `extraction-${statementId}` });\n        loadStatements();\n        \n        // ì¶”ì¶œ ì™„ë£Œ í›„ ë°”ë¡œ í™•ì¸ ëª¨ë‹¬ ì—´ê¸°\n        if (result.data) {\n          setSelectedStatement(result.data);\n          setIsConfirmModalOpen(true);\n        }\n      } else {\n        toast.error(result.error || 'OCR ì¶”ì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', { id: `extraction-${statementId}` });\n        loadStatements();\n      }\n    } catch (error) {\n      toast.error('OCR ì¶”ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', { id: `extraction-${statementId}` });\n      loadStatements();\n    } finally {\n      // ì¶”ì¶œ ì™„ë£Œ - extractingIdsì—ì„œ ì œê±°\n      setExtractingIds(prev => {\n        const next = new Set(prev);\n        next.delete(statementId);\n        return next;\n      });\n    }\n  };\n\n  // í™•ì • ëª¨ë‹¬ ë‹«ê¸°\n  const handleConfirmModalClose = () => {\n    setIsConfirmModalOpen(false);\n    setSelectedStatement(null);\n    loadStatements();\n  };\n\n  // ë‚ ì§œ í¬ë§·\n  const formatDate = (dateString: string) => {\n    if (!dateString) return '-';\n    return new Date(dateString).toLocaleDateString('ko-KR', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit'\n    });\n  };\n\n  // ê¸ˆì•¡ í¬ë§·\n  const formatAmount = (amount?: number) => {\n    if (amount === undefined || amount === null) return '-';\n    return amount.toLocaleString('ko-KR') + 'ì›';\n  };\n\n  return (\n    <div className=\"w-full\">\n      {/* Header - ë°œì£¼ìš”ì²­ ê´€ë¦¬ì™€ ë™ì¼ */}\n      <div className=\"mb-4\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"page-title\">ê±°ë˜ëª…ì„¸ì„œ í™•ì¸</h1>\n            <p className=\"page-subtitle\" style={{ marginTop: '-2px', marginBottom: '-4px' }}>\n              Transaction Statement Verification\n            </p>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            <Button\n              onClick={() => setIsUploadModalOpen(true)}\n              className=\"!h-auto button-base bg-hansl-600 hover:bg-hansl-700 text-white\"\n            >\n              <Plus className=\"w-3.5 h-3.5\" />\n              <span className=\"hidden sm:inline\">ì—…ë¡œë“œ</span>\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={loadStatements}\n              disabled={loading}\n              className=\"!h-auto button-base\"\n            >\n              <RefreshCw className={`w-3.5 h-3.5 ${loading ? 'animate-spin' : ''}`} />\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* í•„í„° íˆ´ë°” - ë°œì£¼ìš”ì²­ ê´€ë¦¬ì™€ ë™ì¼í•œ ìŠ¤íƒ€ì¼ */}\n      <div className=\"mb-3\">\n        <div className=\"flex flex-wrap items-center gap-2\">\n          {/* ê²€ìƒ‰ */}\n          <div className=\"relative min-w-[140px] max-w-[200px]\">\n            <Search className=\"absolute left-1.5 top-1/2 transform -translate-y-1/2 w-2.5 h-2.5 text-gray-400\" />\n            <Input\n              placeholder=\"ê±°ë˜ì²˜ëª…, íŒŒì¼ëª… ê²€ìƒ‰...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"!h-auto !py-px !pr-1.5 !pl-5 !text-[11px] !min-h-[20px] business-radius-input border border-gray-300 bg-white text-gray-700\"\n            />\n          </div>\n          \n          {/* ìƒíƒœ í•„í„° */}\n          <Select value={statusFilter} onValueChange={setStatusFilter}>\n            <SelectTrigger className=\"!h-auto !py-[1px] !px-2 !text-[12px] !min-h-[22px] w-[100px] business-radius-input border border-gray-300 bg-white text-gray-700 [&>svg]:h-3 [&>svg]:w-3\">\n              <SelectValue placeholder=\"ìƒíƒœ\" />\n            </SelectTrigger>\n            <SelectContent className=\"min-w-[100px]\">\n              <SelectItem value=\"all\" className=\"text-[12px] py-1.5\">ì „ì²´ ìƒíƒœ</SelectItem>\n              <SelectItem value=\"pending\" className=\"text-[12px] py-1.5\">ëŒ€ê¸°ì¤‘</SelectItem>\n              <SelectItem value=\"extracted\" className=\"text-[12px] py-1.5\">í™•ì¸í•„ìš”</SelectItem>\n              <SelectItem value=\"confirmed\" className=\"text-[12px] py-1.5\">í™•ì •ë¨</SelectItem>\n              <SelectItem value=\"rejected\" className=\"text-[12px] py-1.5\">ê±°ë¶€ë¨</SelectItem>\n            </SelectContent>\n          </Select>\n          \n          {/* ë‚ ì§œ í•„í„° í† ê¸€ */}\n          <Button\n            variant=\"outline\"\n            onClick={() => setShowFilters(!showFilters)}\n            className={`!h-auto button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 ${showFilters ? 'bg-hansl-50 border-hansl-300 text-hansl-700' : ''}`}\n          >\n            <SlidersHorizontal className=\"w-3.5 h-3.5 mr-1\" />\n            <span className=\"button-text\">í•„í„°</span>\n          </Button>\n          \n          {/* ê±´ìˆ˜ í‘œì‹œ */}\n          <span className=\"badge-stats bg-gray-100 text-gray-600\">\n            ì´ {totalCount}ê±´\n          </span>\n        </div>\n        \n        {/* í™•ì¥ í•„í„° */}\n        {showFilters && (\n          <div className=\"mt-2 p-3 bg-gray-50 business-radius-card border border-gray-200\">\n            <div className=\"flex flex-wrap items-center gap-3\">\n              <div className=\"flex items-center gap-2\">\n                <label className=\"text-[12px] font-medium text-gray-500\">ì—…ë¡œë“œ ë‚ ì§œ</label>\n                <Input\n                  type=\"date\"\n                  value={dateFilter}\n                  onChange={(e) => setDateFilter(e.target.value)}\n                  className=\"!h-auto !py-[2px] !px-2.5 !text-[12px] !min-h-[24px] w-[140px] business-radius-input border border-gray-300 bg-white text-gray-700\"\n                />\n              </div>\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setSearchTerm(\"\");\n                  setStatusFilter(\"all\");\n                  setDateFilter(\"\");\n                }}\n                className=\"!h-auto button-base border border-gray-300 bg-white text-blue-600 hover:bg-blue-50 hover:border-blue-300\"\n              >\n                â†» <span className=\"button-text text-blue-600\">ì´ˆê¸°í™”</span>\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* ëª©ë¡ ì¹´ë“œ */}\n      <Card className=\"overflow-hidden border border-gray-200 business-radius-card\">\n        <CardContent className=\"p-0\">\n          {loading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <div className=\"w-6 h-6 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin\" />\n              <span className=\"ml-3 text-[11px] text-gray-500\">ë¡œë”© ì¤‘...</span>\n            </div>\n          ) : statements.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <FileCheck className=\"w-10 h-10 text-gray-300 mx-auto mb-3\" />\n              <h3 className=\"text-[12px] font-medium text-gray-700 mb-1\">ê±°ë˜ëª…ì„¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤</h3>\n              <p className=\"text-[11px] text-gray-500\">ì—…ë¡œë“œëœ ê±°ë˜ëª…ì„¸ì„œê°€ ì—†ê±°ë‚˜ ê²€ìƒ‰ ì¡°ê±´ì— ë§ëŠ” ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>\n            </div>\n          ) : (\n            <>\n              {/* ë°ìŠ¤í¬í†± í…Œì´ë¸” ë·° */}\n              <div className=\"hidden md:block overflow-x-auto\">\n                <table className=\"w-full min-w-fit\">\n                  <thead className=\"bg-gray-50 border-b border-gray-200\">\n                    <tr>\n                      <th className=\"px-3 py-2.5 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">ìƒíƒœ</th>\n                      <th className=\"px-3 py-2.5 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">ì—…ë¡œë“œì¼</th>\n                      <th className=\"px-3 py-2.5 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">ëª…ì„¸ì„œì¼</th>\n                      <th className=\"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">ê±°ë˜ì²˜ëª…</th>\n                      <th className=\"px-3 py-2.5 text-left text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">íŒŒì¼ëª…</th>\n                      <th className=\"px-3 py-2.5 text-right text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">í•©ê³„ê¸ˆì•¡</th>\n                      <th className=\"px-3 py-2.5 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">ë“±ë¡ì</th>\n                      <th className=\"px-3 py-2.5 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">í™•ì •ì</th>\n                      <th className=\"px-3 py-2.5 text-center text-[10px] font-semibold text-gray-500 uppercase tracking-wider\">ì•¡ì…˜</th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white divide-y divide-gray-100\">\n                    {statements.map((statement) => (\n                      <tr\n                        key={statement.id}\n                        className=\"hover:bg-gray-50 transition-colors cursor-pointer\"\n                        onClick={(e) => handleViewStatement(statement, e)}\n                      >\n                        <td className=\"px-3 py-2.5 text-center\">\n                          {extractingIds.has(statement.id) \n                            ? renderStatusBadge('processing') \n                            : renderStatusBadge(statement.status)}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-[11px] text-center text-gray-600\">\n                          {formatDate(statement.uploaded_at)}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-[11px] text-center text-gray-600\">\n                          {statement.statement_date ? formatDate(statement.statement_date) : '-'}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-[11px] font-medium text-gray-900\">\n                          {statement.vendor_name || '-'}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-[11px] text-gray-700 max-w-[180px] truncate\">\n                          {statement.file_name || '-'}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-[11px] font-medium text-right text-gray-900\">\n                          {formatAmount(statement.grand_total)}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-[11px] text-center text-gray-600\">\n                          {statement.uploaded_by_name || '-'}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-[11px] text-center text-gray-600\">\n                          {statement.confirmed_by_name || '-'}\n                        </td>\n                        <td className=\"px-3 py-2.5 text-center\">\n                          <div className=\"flex items-center justify-center gap-1\">\n                            <button\n                              onClick={(e) => handleViewImage(e, statement.image_url)}\n                              className=\"p-1.5 rounded-md hover:bg-gray-100 text-gray-500 hover:text-gray-700 transition-colors\"\n                              title=\"ì´ë¯¸ì§€ ë³´ê¸°\"\n                            >\n                              <ImageIcon className=\"w-3.5 h-3.5\" />\n                            </button>\n                            <button\n                              onClick={(e) => handleDelete(e, statement)}\n                              className=\"p-1.5 rounded-md hover:bg-red-50 text-red-400 hover:text-red-600 transition-colors\"\n                              title=\"ì‚­ì œ\"\n                            >\n                              <Trash2 className=\"w-3.5 h-3.5\" />\n                            </button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n\n              {/* ëª¨ë°”ì¼ ì¹´ë“œ ë·° */}\n              <div className=\"md:hidden divide-y divide-gray-100\">\n                {statements.map((statement) => (\n                  <div\n                    key={statement.id}\n                    className=\"p-3 hover:bg-gray-50 transition-colors cursor-pointer\"\n                    onClick={(e) => handleViewStatement(statement, e)}\n                  >\n                    <div className=\"flex items-start justify-between mb-2\">\n                      {extractingIds.has(statement.id) \n                        ? renderStatusBadge('processing') \n                        : renderStatusBadge(statement.status)}\n                      <span className=\"text-[10px] text-gray-400\">\n                        {formatDate(statement.uploaded_at)}\n                      </span>\n                    </div>\n                    <div className=\"mb-2\">\n                      <p className=\"text-[11px] font-medium text-gray-900\">\n                        {statement.vendor_name || 'ê±°ë˜ì²˜ ë¯¸í™•ì¸'}\n                      </p>\n                      <p className=\"text-[10px] text-gray-500 truncate\">\n                        {statement.file_name}\n                      </p>\n                    </div>\n                    {statement.grand_total && (\n                      <p className=\"text-[12px] font-bold text-gray-900\">\n                        {formatAmount(statement.grand_total)}\n                      </p>\n                    )}\n                    <div className=\"flex items-center justify-end gap-2 mt-2 pt-2 border-t border-gray-100\">\n                      <button\n                        onClick={(e) => handleViewImage(e, statement.image_url)}\n                        className=\"button-base px-2 py-1 text-[10px] border border-gray-200 text-gray-600 hover:bg-gray-50\"\n                      >\n                        <ImageIcon className=\"w-3 h-3 mr-1\" />\n                        ë³´ê¸°\n                      </button>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* ì—…ë¡œë“œ ëª¨ë‹¬ */}\n      <StatementUploadModal\n        isOpen={isUploadModalOpen}\n        onClose={() => setIsUploadModalOpen(false)}\n        onSuccess={handleUploadSuccess}\n      />\n\n      {/* í™•ì¸/ìˆ˜ì •/í™•ì • ëª¨ë‹¬ */}\n      {selectedStatement && (\n        <StatementConfirmModal\n          isOpen={isConfirmModalOpen}\n          statement={selectedStatement}\n          onClose={handleConfirmModalClose}\n          onConfirm={handleConfirmModalClose}\n        />\n      )}\n\n      {/* ì´ë¯¸ì§€ ë·°ì–´ */}\n      <StatementImageViewer\n        isOpen={isImageViewerOpen}\n        imageUrl={viewerImageUrl}\n        onClose={() => {\n          setIsImageViewerOpen(false);\n          setViewerImageUrl(\"\");\n        }}\n      />\n\n      {/* ë°œì£¼ ëª©ë¡ ë“œë¡­ë‹¤ìš´ */}\n      {purchaseDropdown.isOpen && purchaseDropdown.statement && (\n        <>\n          {/* ì˜¤ë²„ë ˆì´ */}\n          <div \n            className=\"fixed inset-0 z-40\" \n            onClick={handleClosePurchaseDropdown}\n          />\n          {/* ë“œë¡­ë‹¤ìš´ */}\n          <div \n            className=\"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg min-w-[280px] max-w-[360px]\"\n            style={{\n              top: purchaseDropdown.position.top + 4,\n              left: purchaseDropdown.position.left\n            }}\n          >\n            <div className=\"flex items-center justify-between px-3 py-2 border-b border-gray-100 bg-gray-50 rounded-t-lg\">\n              <span className=\"text-[11px] font-semibold text-gray-700\">\n                ì—°ê²°ëœ ë°œì£¼ ({purchaseDropdown.statement.matched_purchases?.length || 0}ê±´)\n              </span>\n              <button\n                onClick={handleClosePurchaseDropdown}\n                className=\"p-0.5 hover:bg-gray-200 rounded\"\n              >\n                <X className=\"w-3.5 h-3.5 text-gray-500\" />\n              </button>\n            </div>\n            <div className=\"max-h-[300px] overflow-auto\">\n              {purchaseDropdown.statement.matched_purchases?.map((purchase, idx) => (\n                <div\n                  key={purchase.purchase_id}\n                  onClick={() => handleSelectPurchase(purchase.purchase_id)}\n                  className=\"flex items-center justify-between px-3 py-2.5 hover:bg-blue-50 cursor-pointer border-b border-gray-50 last:border-0 transition-colors\"\n                >\n                  <div className=\"flex-1\">\n                    <p className=\"text-[12px] font-medium text-gray-900\">\n                      {purchase.purchase_order_number || purchase.sales_order_number || `ë°œì£¼ #${purchase.purchase_id}`}\n                    </p>\n                    {purchase.sales_order_number && purchase.purchase_order_number && (\n                      <p className=\"text-[10px] text-gray-500\">\n                        ìˆ˜ì£¼: {purchase.sales_order_number}\n                      </p>\n                    )}\n                  </div>\n                  <div className=\"flex items-center gap-1 text-blue-600\">\n                    <span className=\"text-[10px]\">ìƒì„¸ë³´ê¸°</span>\n                    <ChevronRight className=\"w-3.5 h-3.5\" />\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        </>\n      )}\n\n      {/* ë°œì£¼ ìƒì„¸ ëª¨ë‹¬ */}\n      {selectedPurchaseId && (\n        <PurchaseDetailModal\n          purchaseId={selectedPurchaseId}\n          isOpen={isPurchaseModalOpen}\n          onClose={() => {\n            setIsPurchaseModalOpen(false);\n            setSelectedPurchaseId(null);\n          }}\n          activeTab=\"all\"\n        />\n      )}\n    </div>\n  );\n}\n"],"names":["CircleX","createLucideIcon","cx","cy","r","key","d","ExternalLink","RefreshCw","RotateCw","SlidersHorizontal","x1","x2","y1","y2","StatementUploadModal","isOpen","onClose","onSuccess","file","setFile","useState","preview","setPreview","uploading","setUploading","uploaderName","setUploaderName","fileInputRef","useRef","supabase","createClient","useEffect","async","data","user","auth","getUser","email","employee","from","select","eq","single","name","e","loadUserName","handleFileSelect","selectedFile","type","startsWith","toast","error","size","reader","FileReader","onloadend","result","readAsDataURL","handleClose","current","value","jsx","Dialog","open","onOpenChange","children","jsxs","DialogContent","className","DialogHeader","DialogTitle","Upload","onDrop","preventDefault","stopPropagation","droppedFile","dataTransfer","files","onDragOver","onClick","click","ref","accept","onChange","target","src","alt","X","Fragment","ImageIcon","DialogFooter","Button","variant","disabled","transactionStatementService","uploadStatement","success","statementId","imageUrl","Loader2","StatementImageViewer","scale","setScale","rotation","setRotation","prev","Math","max","ZoomOut","round","min","ZoomIn","response","fetch","blob","url","window","URL","createObjectURL","a","document","createElement","href","download","Date","toISOString","split","body","appendChild","removeChild","revokeObjectURL","Download","style","transform","calculateStringSimilarity","ocrName","targetName","ocr","toLowerCase","replace","minLen","length","maxLen","lengthRatio","includes","similarity","str1","str2","s1","s2","matrix","i","j","cost","levenshteinDistance","ocrWords","filter","w","targetWords","wordMatchBonus","some","tw","wLower","twLower","calculateItemSimilarity","systemItemName","systemSpec","itemNameScore","specScore","isQuantityMatched","ocrQuantity","systemQuantity","StatementConfirmModal","statement","onConfirm","loading","setLoading","saving","setSaving","statementWithItems","setStatementWithItems","isImageViewerOpen","setIsImageViewerOpen","confirmerName","setConfirmerName","selectedPONumber","setSelectedPONumber","itemPONumbers","setItemPONumbers","Map","itemMatches","setItemMatches","openDropdowns","setOpenDropdowns","Set","dropdownPosition","setDropdownPosition","top","left","isPurchaseDetailModalOpen","setIsPurchaseDetailModalOpen","selectedPurchaseIdForDetail","setSelectedPurchaseIdForDetail","editedOCRItems","setEditedOCRItems","matchDetailPopup","setMatchDetailPopup","isIntegratedMatchDetailOpen","setIsIntegratedMatchDetailOpen","vendorInputValue","setVendorInputValue","vendorSearchResults","setVendorSearchResults","vendorSearchLoading","setVendorSearchLoading","vendorDropdownOpen","setVendorDropdownOpen","overrideVendorName","setOverrideVendorName","poItemsMap","setPoItemsMap","autoVendorSelectionRef","systemCandidateLogKeyRef","poSearchInputOpen","setPOSearchInputOpen","poSearchInput","setPOSearchInput","poSearchResults","setPOSearchResults","poSearchLoading","setPOSearchLoading","poDropdownOpen","setPODropdownOpen","manuallySelectedPO","setManuallySelectedPO","keepPODropdownOpenRef","itemPOSearchInputs","setItemPOSearchInputs","itemPOSearchResults","setItemPOSearchResults","itemPOSearchLoading","setItemPOSearchLoading","lastSelectedSystemItemRef","tableContainerRef","tableRef","statementDateInput","setStatementDateInput","poPairOverrides","setPoPairOverrides","pendingPairLookupsRef","setMatchResult","setSetMatchResult","isSamePONumber","useMemo","items","poNumbers","map","item","extracted_po_number","normalizeOrderNumber","Boolean","every","po","commonPONumber","poNumber","find","initialVendor","vendor_name","handleSelectVendor","silent","normalizeStatementDate","trimmed","trim","test","parsed","Number","isNaN","getTime","slice","statement_date","container","table","containerRect","getBoundingClientRect","tableRect","scrollbarWidth","offsetWidth","clientWidth","method","headers","JSON","stringify","location","message","containerClientWidth","containerScrollWidth","scrollWidth","containerOffsetWidth","tableWidth","tableScrollWidth","containerRectWidth","width","tableRectWidth","timestamp","now","sessionId","runId","hypothesisId","catch","containerPaddingRight","getComputedStyle","paddingRight","containerPaddingLeft","paddingLeft","containerBg","backgroundColor","tableBg","tableWidthStyle","tableMinWidth","minWidth","tbodyBg","tBodies","theadBg","tHead","firstRow","rows","firstCell","cells","firstCellRect","firstCellLeftGap","tableBorderSpacing","borderSpacing","tablePaddingLeft","tbodyPaddingLeft","firstCellPaddingLeft","loadData","useCallback","getStatementWithItems","id","initialPONumbers","initialMatches","forEach","hasCandidateMatch","match_candidates","c","purchase_order_number","sales_order_number","set","matched_purchase","matched_item_id","matchedPO","purchase_id","matched_purchase_id","item_id","item_name","matched_item_name","quantity","matched_item_quantity","unit_price","matched_item_unit_price","amount","matched_item_amount","bestMatch","bestScore","matchingCandidates","score","extracted_item_name","specification","has","bestCandidate","reduce","best","recommendedPO","candidatesForPO","bestItem","bestItemScore","firstPO","setMatchResponse","findBestMatchingPurchaseOrderSet","bestPO","autoMatchedItems","match","candidate","systemItemId","ocrItemId","mergedMatches","confidence","confText","matchedItemCount","newMatches","newPONumbers","hasMatchChanges","hasPOChanges","ocrItem","currentMatch","get","currentDisplayPO","allPONumberCandidates","firstExtracted","useSONumber","toUpperCase","candidateMap","candidates","salesOrderNumber","itemCount","vendorName","setMatchScore","matchScore","purchaseId","existing","push","normalizedKey","isSO","match_reasons","totalScore","matchedCount","quantityMatchedCount","quantityMismatchedCount","hasOrderNumberMatch","getOCRItemValue","num","candidateItems","bestMatchItem","ocrItemName","sysItem","ocrQtyRaw","ocrQty","sysQty","baseScore","quantityBonus","actualScore","orderNumberBonus","displayScore","Array","values","sort","b","aHasMatch","bHasMatch","scoreA","scoreB","getPairedOrderNumber","normalizedValue","getPairedOrderNumberWithOverrides","normalized","override","matchingCandidate","matchingPO","firstCandidate","newPO","getSystemItemsForPO","mappedItems","index","self","findIndex","t","getPOCandidatesForItem","add","handleEditOCRItem","itemId","field","newMap","edited","extracted_quantity","extracted_unit_price","extracted_amount","isOCRItemEdited","original","po_number","handleSelectGlobalPO","vendorNameFromSearch","soNumberFromSearch","normalizedPO","next","poCandidate","systemItems","purchaseRequest","or","limit","vendor","pairedNumber","purchaseItems","received_quantity","unit_price_value","amount_value","lookupPairedOrderNumber","rawValue","err","delete","handleOCRPONumberChange","newValue","purchaseData","purchase","purchase_request_items","newItems","options","shouldNotify","purchases","order","ascending","itemsMap","totalMapItems","newCandidates","maxSimilarity","comparedCount","totalItemCount","p","handleSelectItemPO","newSet","getPurchaseIdByNumber","handleItemPOSearch","searchValue","results","row","soNumber","handleSelectSystemItem","systemItem","didUpdate","nextMap","itemPO","enriched","sys","formatAmount","toLocaleString","getSystemItemLabel","spec","toggleDropdown","event","rect","currentTarget","bottom","clear","showCloseButton","onInteractOutside","CheckCircle","image_url","screenX","outerWidth","screenY","outerHeight","vendors","ilike","handleVendorSearch","onFocus","onBlur","setTimeout","placeholder","fontSize","fontWeight","onMouseDown","grand_total","borderCollapse","colSpan","ChevronDown","title","handlePOSearch","autoFocus","searchUpper","selectedNumber","Search","selectedCandidate","firstItem","currentValue","rowIndex","matchedSystem","effectiveMatch","getMatchStatus","normalizedExtractedPO","poCandidates","normalizedCandidates","candidateSet","selectedPO","normalizedSelectedPO","extractedInDb","candidateCount","orderedPOs","nextItem","nextItemPO","normalizedExtracted","selected","normalizedSelected","getDisplayPOForItem","isGroupEnd","rowClassName","itemSearchValue","itemSearchResults","itemSearchLoading","activePONumber","systemCandidates","fallbackCandidates","displaySystemCandidates","scoredSystemCandidates","logKey","normalizedSelectedPONumber","pairedOrderNumber","normalizedPairedOrderNumber","extractedOrderNumbers","isFirstRow","idx","paired","isPreferred","XCircle","cidx","rowSpan","verticalAlign","sum","confirm","rejectStatement","corrections","statement_id","statement_item_id","original_text","corrected_text","field_type","String","correction","saveCorrection","saveOCRCorrections","normalizedOriginalDate","normalizedInputDate","dateError","update","Error","confirmItems","matched","confirmedQuantity","confirmedUnitPrice","confirmedAmount","confirmed_quantity","confirmed_unit_price","confirmed_amount","confirmStatement","status","Check","renderMatchStatusBadge","toFixed","reasons","reason","totalMatchScore","totalCount","isOrderNumberMatched","matchedNameCount","isItemNameAllMatched","isQuantityAllMatched","isMatched","qtyMatched","qtyLevel","createPortal","pointerEvents","displayNumber","isSelected","isBestMatch","PurchaseDetailModal","activeTab","TransactionStatementMain","statements","setStatements","searchTerm","setSearchTerm","statusFilter","setStatusFilter","dateFilter","setDateFilter","setTotalCount","showFilters","setShowFilters","isUploadModalOpen","setIsUploadModalOpen","selectedStatement","setSelectedStatement","isConfirmModalOpen","setIsConfirmModalOpen","viewerImageUrl","setViewerImageUrl","extractingIds","setExtractingIds","isPurchaseModalOpen","setIsPurchaseModalOpen","selectedPurchaseId","setSelectedPurchaseId","purchaseDropdown","setPurchaseDropdown","position","loadStatements","getStatements","dateFrom","search","count","supabaseRef","channel","on","schema","payload","eventType","newStatus","new","oldStatus","old","subscribe","removeChannel","renderStatusBadge","baseClass","Clock","AlertCircle","handleViewStatement","matched_purchases","scrollY","scrollX","handleClosePurchaseDropdown","handleViewImage","handleConfirmModalClose","formatDate","dateString","toLocaleDateString","year","month","day","marginTop","marginBottom","Plus","Input","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","Card","CardContent","FileCheck","uploaded_at","file_name","uploaded_by_name","confirmed_by_name","deleteStatement","handleDelete","Trash2","extractStatementData","handleSelectPurchase","ChevronRight"],"mappings":";;;;;;GASA,MAKMA,EAAUC,EAAiB,WALd,CACjB,CAAC,SAAU,CAAEC,GAAI,KAAMC,GAAI,KAAMC,EAAG,KAAMC,IAAK,WAC/C,CAAC,OAAQ,CAAEC,EAAG,YAAaD,IAAK,WAChC,CAAC,OAAQ,CAAEC,EAAG,WAAYD,IAAK,aCE3BE,EAAeN,EAAiB,gBALnB,CACjB,CAAC,OAAQ,CAAEK,EAAG,YAAaD,IAAK,WAChC,CAAC,OAAQ,CAAEC,EAAG,cAAeD,IAAK,WAClC,CAAC,OAAQ,CAAEC,EAAG,2DAA4DD,IAAK,aCG3EG,EAAYP,EAAiB,aANhB,CACjB,CAAC,OAAQ,CAAEK,EAAG,qDAAsDD,IAAK,WACzE,CAAC,OAAQ,CAAEC,EAAG,aAAcD,IAAK,WACjC,CAAC,OAAQ,CAAEC,EAAG,sDAAuDD,IAAK,WAC1E,CAAC,OAAQ,CAAEC,EAAG,YAAaD,IAAK,aCA5BI,EAAWR,EAAiB,YAJf,CACjB,CAAC,OAAQ,CAAEK,EAAG,oDAAqDD,IAAK,WACxE,CAAC,OAAQ,CAAEC,EAAG,aAAcD,IAAK,aCS7BK,EAAoBT,EAAiB,qBAXxB,CACjB,CAAC,OAAQ,CAAEU,GAAI,KAAMC,GAAI,KAAMC,GAAI,IAAKC,GAAI,IAAKT,IAAK,WACtD,CAAC,OAAQ,CAAEM,GAAI,KAAMC,GAAI,IAAKC,GAAI,IAAKC,GAAI,IAAKT,IAAK,WACrD,CAAC,OAAQ,CAAEM,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMT,IAAK,WACxD,CAAC,OAAQ,CAAEM,GAAI,IAAKC,GAAI,IAAKC,GAAI,KAAMC,GAAI,KAAMT,IAAK,WACtD,CAAC,OAAQ,CAAEM,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMT,IAAK,WACxD,CAAC,OAAQ,CAAEM,GAAI,KAAMC,GAAI,IAAKC,GAAI,KAAMC,GAAI,KAAMT,IAAK,WACvD,CAAC,OAAQ,CAAEM,GAAI,KAAMC,GAAI,KAAMC,GAAI,IAAKC,GAAI,IAAKT,IAAK,WACtD,CAAC,OAAQ,CAAEM,GAAI,IAAKC,GAAI,IAAKC,GAAI,KAAMC,GAAI,KAAMT,IAAK,WACtD,CAAC,OAAQ,CAAEM,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMC,GAAI,KAAMT,IAAK,aCK1D,SAAwBU,GAAqBC,OAC3CA,EAAAC,QACAA,EAAAC,UACAA,IAEA,MAAOC,EAAMC,GAAWC,EAAAA,SAAsB,OACvCC,EAASC,GAAcF,EAAAA,SAAwB,OAC/CG,EAAWC,GAAgBJ,EAAAA,UAAS,IACpCK,EAAcC,GAAmBN,EAAAA,SAAiB,IACnDO,EAAeC,EAAAA,OAAyB,MACxCC,EAAWC,IAuBjBC,EAAAA,UAAU,KACJhB,GArBeiB,WACnB,IACE,MAAQC,MAAMC,KAAEA,UAAiBL,EAASM,KAAKC,UAC/C,GAAIF,GAAMG,MAAO,CACf,MAAQJ,KAAMK,SAAmBT,EAC9BU,KAAK,aACLC,OAAO,QACPC,GAAG,QAASP,EAAKG,OACjBK,SAECJ,GAAUK,MACZjB,EAAgBY,EAASK,KAE7B,CACF,OAASC,GAET,GAMEC,IAED,CAAC9B,IAGJ,MAAM+B,EAAoBC,IACxB,IAAKA,EAAaC,KAAKC,WAAW,UAEhC,YADAC,EAAMC,MAAM,wBAId,GAAIJ,EAAaK,KAAO,SAEtB,YADAF,EAAMC,MAAM,yBAIdhC,EAAQ4B,GAER,MAAMM,EAAS,IAAIC,WACnBD,EAAOE,UAAY,KACjBjC,EAAW+B,EAAOG,SAEpBH,EAAOI,cAAcV,IAmEjBW,EAAc,KACdnC,IAEJJ,EAAQ,MACRG,EAAW,MACPK,EAAagC,UACfhC,EAAagC,QAAQC,MAAQ,IAE/B5C,MAGF,OACE6C,EAAAA,IAACC,GAAOC,KAAMhD,EAAQiD,aAAcN,EAClCO,WAAAC,KAACC,EAAA,CAAcC,UAAU,yCACvBH,SAAA,CAAAJ,EAAAA,IAACQ,GAAaD,UAAU,gCACtBH,SAAAC,EAAAA,KAACI,EAAA,CAAYF,UAAU,8DACrBH,SAAA,GAAAJ,IAACU,EAAA,CAAOH,UAAU,2BAA2B,mBAKjDF,KAAC,MAAA,CAAIE,UAAU,OAEbH,SAAA,CAAAC,EAAAA,KAAC,MAAA,CACCE,UAAW,+HAEP/C,EACE,+BACA,0EAGNmD,OA9FU5B,IAClBA,EAAE6B,iBACF7B,EAAE8B,kBAEF,MAAMC,EAAc/B,EAAEgC,aAAaC,MAAM,GACrCF,GACF7B,EAAiB6B,IAyFXG,WArFclC,IACtBA,EAAE6B,iBACF7B,EAAE8B,mBAoFMK,QAjFU,KAClBpD,EAAagC,SAASqB,SAkFdf,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACCoB,IAAKtD,EACLqB,KAAK,OACLkC,OAAO,UACPC,SAnFevC,IACzB,MAAMG,EAAeH,EAAEwC,OAAOP,QAAQ,GAClC9B,GACFD,EAAiBC,IAiFTqB,UAAU,WAGX/C,EACC6C,EAAAA,KAAC,MAAA,CAAIE,UAAU,WACbH,SAAA,CAAAJ,EAAAA,IAAC,MAAA,CACCwB,IAAKhE,EACLiE,IAAI,OACJlB,UAAU,oDAEZP,EAAAA,IAAC,SAAA,CACCO,UAAU,qGACVW,QAAUnC,IACRA,EAAE8B,kBAzFlBvD,EAAQ,MACRG,EAAW,MACPK,EAAagC,UACfhC,EAAagC,QAAQC,MAAQ,KA0FjBK,SAAAJ,EAAAA,IAAC0B,EAAA,CAAEnB,UAAU,kBAEfP,EAAAA,IAAC,IAAA,CAAEO,UAAU,+CACVH,YAAMtB,UAIXuB,EAAAA,KAAAsB,EAAAA,SAAA,CACEvB,SAAA,GAAAJ,IAAC4B,EAAA,CAAUrB,UAAU,yCACrBP,EAAAA,IAAC,IAAA,CAAEO,UAAU,iCAAiCH,SAAA,iCAG9CJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,4BAA4BH,SAAA,iDAQ/CJ,IAAC,OAAIO,UAAU,oEACbH,eAAC,IAAA,CAAEG,UAAU,4CAA4CH,SAAA,uFAO7DC,KAACwB,EAAA,CAAatB,UAAU,sCACtBH,SAAA,CAAAJ,EAAAA,IAAC8B,EAAA,CACCC,QAAQ,UACRb,QAASrB,EACTmC,SAAUtE,EACV6C,UAAU,8BACXH,SAAA,OAGDJ,EAAAA,IAAC8B,EAAA,CACCZ,QA5HW/C,UACnB,GAAKd,EAML,IACEM,GAAa,GAEb,MAAMgC,QAAesC,EAA4BC,gBAC/C7E,EACAO,GAAgB,UAGd+B,EAAOwC,SAAWxC,EAAOvB,MAC3BiB,EAAM8C,QAAQ,iBACd/E,EAAUuC,EAAOvB,KAAKgE,YAAazC,EAAOvB,KAAKiE,UAC/CxC,KAEAR,EAAMC,MAAMK,EAAOL,OAAS,eAEhC,OAASA,GACPD,EAAMC,MAAM,oBACd,CAAA,QACE3B,GAAa,EACf,MAxBE0B,EAAMC,MAAM,gBA2HN0C,UAAW3E,GAAQK,EACnB6C,UAAU,yEAETH,WACCC,EAAAA,KAAAsB,EAAAA,SAAA,CACEvB,SAAA,GAAAJ,IAACsC,EAAA,CAAQ/B,UAAU,oCAAoC,cAIzDF,EAAAA,KAAAsB,EAAAA,SAAA,CACEvB,SAAA,GAAAJ,IAACU,EAAA,CAAOH,UAAU,uBAAuB,kBASzD,CCpPA,SAAwBgC,GAAqBrF,OAC3CA,EAAAmF,SACAA,EAAAlF,QACAA,IAEA,MAAOqF,EAAOC,GAAYlF,EAAAA,SAAS,IAC5BmF,EAAUC,GAAepF,EAAAA,SAAS,GAgCnCsC,EAAc,KAClB4C,EAAS,GACTE,EAAY,GACZxF,KAGF,OAAKkF,EAGHrC,EAAAA,IAACC,GAAOC,KAAMhD,EAAQiD,aAAcN,EAClCO,WAAAC,KAACC,EAAA,CAAcC,UAAU,wDAEvBH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,+HACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,4BACbH,SAAA,CAAAJ,EAAAA,IAAC,SAAA,CACCkB,QAzCU,KACpBuB,EAAUG,GAASC,KAAKC,IAAIF,EAAO,IAAM,MAyC/BZ,SAAUQ,GAAS,GACnBjC,UAAU,gGAEVH,SAAAJ,EAAAA,IAAC+C,EAAA,CAAQxC,UAAU,gBAErBF,KAAC,OAAA,CAAKE,UAAU,8DACbH,SAAA,CAAAyC,KAAKG,MAAc,IAARR,GAAa,OAE3BxC,EAAAA,IAAC,SAAA,CACCkB,QAvDS,KACnBuB,EAAUG,GAASC,KAAKI,IAAIL,EAAO,IAAM,KAuD/BZ,SAAUQ,GAAS,EACnBjC,UAAU,gGAEVH,SAAAJ,EAAAA,IAACkD,EAAA,CAAO3C,UAAU,gBAEpBP,IAAC,MAAA,CAAIO,UAAU,gCACfP,EAAAA,IAAC,SAAA,CACCkB,QAvDS,KACnByB,EAAaC,IAAUA,EAAO,IAAM,MAuD1BrC,UAAU,4EAEVH,SAAAJ,EAAAA,IAACrD,EAAA,CAAS4D,UAAU,cAEtBP,EAAAA,IAAC,SAAA,CACCkB,QAzDW/C,UACrB,IACE,MAAMgF,QAAiBC,MAAMf,GACvBgB,QAAaF,EAASE,OACtBC,EAAMC,OAAOC,IAAIC,gBAAgBJ,GACjCK,EAAIC,SAASC,cAAc,KACjCF,EAAEG,KAAOP,EACTI,EAAEI,SAAW,UAAA,IAAaC,MAAOC,cAAcC,MAAM,KAAK,SAC1DN,SAASO,KAAKC,YAAYT,GAC1BA,EAAEvC,QACFwC,SAASO,KAAKE,YAAYV,GAC1BH,OAAOC,IAAIa,gBAAgBf,GAC3BjE,EAAM8C,QAAQ,aAChB,OAAS7C,GACPD,EAAMC,MAAM,gBACd,GA2CUiB,UAAU,4EAEVH,SAAAJ,EAAAA,IAACsE,EAAA,CAAS/D,UAAU,iBAGxBP,EAAAA,IAAC,SAAA,CACCkB,QAASrB,EACTU,UAAU,4EAEVH,SAAAJ,EAAAA,IAAC0B,EAAA,CAAEnB,UAAU,mBAKjBP,IAAC,MAAA,CAAIO,UAAU,2EACbH,SAAAJ,EAAAA,IAAC,MAAA,CACCwB,IAAKa,EACLZ,IAAI,QACJlB,UAAU,yEACVgE,MAAO,CACLC,UAAW,SAAShC,aAAiBE,kBAtD3B,IA6DxB,CCjCA,SAAS+B,EAA0BC,EAAiBC,GAClD,MAAMC,EAAMF,GAASG,cAAcC,QAAQ,OAAQ,KAAO,GACpDvD,EAASoD,GAAYE,cAAcC,QAAQ,OAAQ,KAAO,GAEhE,IAAKF,IAAQrD,EAAQ,OAAO,EAG5B,GAAIqD,IAAQrD,EAAQ,OAAO,IAG3B,MAAMwD,EAASlC,KAAKI,IAAI2B,EAAII,OAAQzD,EAAOyD,QACrCC,EAASpC,KAAKC,IAAI8B,EAAII,OAAQzD,EAAOyD,QACrCE,EAAcH,EAASE,EAE7B,GAAIL,EAAIO,SAAS5D,IAAWA,EAAO4D,SAASP,GAE1C,OAAIM,GAAe,GAAY,GAC3BA,GAAe,GAAY,GAC3BA,GAAe,GAAY,GACxB,GAIT,MACME,GAAeH,EAxDvB,SAA6BI,EAAcC,GACzC,MAAMC,EAAKF,EAAKR,cAAcC,QAAQ,OAAQ,IACxCU,EAAKF,EAAKT,cAAcC,QAAQ,OAAQ,IAE9C,GAAIS,IAAOC,EAAI,OAAO,EACtB,GAAkB,IAAdD,EAAGP,OAAc,OAAOQ,EAAGR,OAC/B,GAAkB,IAAdQ,EAAGR,OAAc,OAAOO,EAAGP,OAE/B,MAAMS,EAAqB,GAE3B,IAAA,IAASC,EAAI,EAAGA,GAAKH,EAAGP,OAAQU,IAC9BD,EAAOC,GAAK,CAACA,GAEf,IAAA,IAASC,EAAI,EAAGA,GAAKH,EAAGR,OAAQW,IAC9BF,EAAO,GAAGE,GAAKA,EAGjB,IAAA,IAASD,EAAI,EAAGA,GAAKH,EAAGP,OAAQU,IAC9B,IAAA,IAASC,EAAI,EAAGA,GAAKH,EAAGR,OAAQW,IAAK,CACnC,MAAMC,EAAOL,EAAGG,EAAI,KAAOF,EAAGG,EAAI,GAAK,EAAI,EAC3CF,EAAOC,GAAGC,GAAK9C,KAAKI,IAClBwC,EAAOC,EAAI,GAAGC,GAAK,EACnBF,EAAOC,GAAGC,EAAI,GAAK,EACnBF,EAAOC,EAAI,GAAGC,EAAI,GAAKC,EAE3B,CAGF,OAAOH,EAAOF,EAAGP,QAAQQ,EAAGR,OAC9B,CA0BmBa,CAAoBjB,EAAKrD,IACA0D,EAAU,IAG9Ca,EAAWpB,GAAST,MAAM,OAAO8B,OAAOC,GAAKA,EAAEhB,QAAU,IAAM,GAC/DiB,EAActB,GAAYV,MAAM,OAAO8B,OAAOC,GAAKA,EAAEhB,QAAU,IAAM,GAE3E,GAAwB,IAApBc,EAASd,QAAuC,IAAvBiB,EAAYjB,OACvC,OAAOI,EAGT,MAUMc,EAVcJ,EAASC,OAAOC,GAClCC,EAAYE,KAAKC,IACf,MAAMC,EAASL,EAAEnB,cACXyB,EAAUF,EAAGvB,cAEnB,OAAOwB,IAAWC,GACfD,EAAOrB,QAAU,GAAKsB,EAAQnB,SAASkB,IACvCC,EAAQtB,QAAU,GAAKqB,EAAOlB,SAASmB,MAGVtB,OAASnC,KAAKC,IAAIgD,EAASd,OAAQiB,EAAYjB,QAAW,GAE9F,OAAOnC,KAAKI,IAAI,IAAKmC,EAAac,EACpC,CAGA,SAASK,EAAwB7B,EAAiB8B,EAAwBC,GAExE,MAAMC,EAAgBjC,EAA0BC,EAAS8B,GAGnDG,EAAYF,EAAahC,EAA0BC,EAAS+B,GAAc,EAGhF,OAAIC,GAAiB,GACZA,EAKLC,GAAa,IAAMD,EAAgB,GAG9B7D,KAAKI,IAAI,GAAgB,GAAZ0D,GAIf9D,KAAKC,IAAI4D,EAA2B,GAAZC,EACjC,CAGA,SAASC,EAAkBC,EAAwCC,GACjE,OAAID,UACAC,SACGD,IAAgBC,EACzB,CAkBA,SAAwBC,GAAsB7J,OAC5CA,EAAA8J,UACAA,EAAA7J,QACAA,EAAA8J,UACAA,IAEA,MAAOC,EAASC,GAAc5J,EAAAA,UAAS,IAChC6J,EAAQC,GAAa9J,EAAAA,UAAS,IAC9B+J,EAAoBC,GAAyBhK,EAAAA,SAA+C,OAC5FiK,EAAmBC,GAAwBlK,EAAAA,UAAS,IACpDmK,EAAeC,GAAoBpK,EAAAA,SAAS,KAG5CqK,EAAkBC,GAAuBtK,EAAAA,SAAiB,KAG1DuK,EAAeC,GAAoBxK,EAAAA,SAA8B,IAAIyK,MAGrEC,EAAaC,GAAkB3K,EAAAA,SAAiD,IAAIyK,MAGpFG,EAAeC,GAAoB7K,EAAAA,SAAsB,IAAI8K,MAG7DC,EAAkBC,GAAuBhL,EAAAA,SAAwC,CAAEiL,IAAK,EAAGC,KAAM,KAGjGC,EAA2BC,GAAgCpL,EAAAA,UAAS,IACpEqL,EAA6BC,GAAkCtL,EAAAA,SAAwB,OAWvFuL,EAAgBC,IAAqBxL,EAAAA,SAAqC,IAAIyK,MAG9EgB,GAAkBC,IAAuB1L,EAAAA,SAStC,OAGH2L,GAA6BC,IAAkC5L,EAAAA,UAAS,IAGxE6L,GAAkBC,IAAuB9L,EAAAA,SAAS,KAClD+L,GAAqBC,IAA0BhM,EAAAA,SAAqE,KACpHiM,GAAqBC,IAA0BlM,EAAAA,UAAS,IACxDmM,GAAoBC,IAAyBpM,EAAAA,UAAS,IACtDqM,GAAoBC,IAAyBtM,EAAAA,SAAwB,OAErEuM,GAAYC,IAAiBxM,EAAAA,SAA4C,IAAIyK,KAC9EgC,GAAyBjM,EAAAA,QAAO,GAChCkM,GAA2BlM,EAAAA,OAAsB,OAGhDmM,GAAmBC,IAAwB5M,EAAAA,UAAS,IACpD6M,GAAeC,IAAoB9M,EAAAA,SAAS,KAC5C+M,GAAiBC,IAAsBhN,EAAAA,SAA0F,KACjIiN,GAAiBC,IAAsBlN,EAAAA,UAAS,IAChDmN,GAAgBC,IAAqBpN,EAAAA,UAAS,IAC9CqN,GAAoBC,IAAyBtN,EAAAA,UAAS,GACvDuN,GAAwB/M,EAAAA,QAAO,IAC9BgN,GAAoBC,IAAyBzN,EAAAA,SAAiC,CAAA,IAC9E0N,GAAqBC,IAA0B3N,EAAAA,SAA0G,CAAA,IACzJ4N,GAAqBC,IAA0B7N,EAAAA,SAAkC,CAAA,GAClF8N,GAA4BtN,EAAAA,OAAsB,MAClDuN,GAAoBvN,EAAAA,OAA8B,MAClDwN,GAAWxN,EAAAA,OAAgC,OAC1CyN,GAAoBC,IAAyBlO,EAAAA,SAAS,KAGtDmO,GAAiBC,IAAsBpO,EAAAA,SAAqC,IAAIyK,KACjF4D,GAAwB7N,EAAAA,OAAoB,IAAIsK,MAG/CwD,GAAgBC,IAAqBvO,EAAAA,SAyBlC,MAEJS,GAAWC,IAGX8N,GAAiBC,EAAAA,QAAQ,KAC7B,IAAK1E,GAAoB2E,MAAMjH,OAAQ,OAAO,EAE9C,MAAMkH,EAAY5E,EAAmB2E,MAClCE,OAAYC,EAAKC,oBAAsBC,EAAqBF,EAAKC,qBAAuB,MACxFtG,OAAOwG,SAEV,OAAyB,IAArBL,EAAUlH,QAEPkH,EAAUM,MAAMC,GAAMA,IAAOP,EAAU,KAC7C,CAAC5E,IAGEoF,GAAiBV,EAAAA,QAAQ,KAC7B,IAAK1E,GAAoB2E,MAAMjH,OAAQ,OAAO,KAE9C,MAAM2H,EAAWrF,EAAmB2E,MAAMW,KAAKR,GAAQA,EAAKC,sBAAsBA,oBAClF,OAAOM,EAAWL,EAAqBK,GAAY,MAClD,CAACrF,IAGJpJ,EAAAA,UAAU,KACR,IAAKoJ,EAAoB,OACzB,MAAMuF,EAAgBvF,EAAmBwF,aAAe,GACpDD,IAAkBzD,IACpBC,GAAoBwD,GAElBA,IAAkB7C,GAAuBlK,UAC3CkK,GAAuBlK,SAAU,EACjCiN,GAAmBF,EAAe,CAAEG,QAAQ,MAE7C,CAAC1F,EAAoB8B,KAExB,MAAM6D,GAA0BlN,IAC9B,IAAKA,EAAO,MAAO,GACnB,MAAMmN,EAAUnN,EAAMoN,OACtB,IAAKD,EAAS,MAAO,GACrB,GAAI,sBAAsBE,KAAKF,GAAU,OAAOA,EAChD,MAAMG,EAAS,IAAItJ,KAAKmJ,GACxB,OAAKI,OAAOC,MAAMF,EAAOG,WAGlBN,EAAQO,MAAM,EAAG,IAFfJ,EAAOrJ,cAAcyJ,MAAM,EAAG,KAMzCvP,EAAAA,UAAU,KACHoJ,GACLmE,GAAsBwB,GAAuB3F,EAAmBoG,kBAC/D,CAACpG,IAEJpJ,EAAAA,UAAU,KACR,IAAKhB,EAAQ,OACb,MAAMyQ,EAAYrC,GAAkBxL,QAC9B8N,EAAQrC,GAASzL,QACvB,IAAK6N,IAAcC,EAAO,OAE1B,MAAMC,EAAgBF,EAAUG,wBAC1BC,EAAYH,EAAME,wBAClBE,EAAiBL,EAAUM,YAAcN,EAAUO,YAEzD9K,MAAM,oEAAoE,CAAC+K,OAAO,OAAOC,QAAQ,CAAC,eAAe,oBAAoBlK,KAAKmK,KAAKC,UAAU,CAACC,SAAS,6CAA6CC,QAAQ,uBAAuBpQ,KAAK,CAACqQ,qBAAqBd,EAAUO,YAAYQ,qBAAqBf,EAAUgB,YAAYC,qBAAqBjB,EAAUM,YAAYY,WAAWjB,EAAMK,YAAYa,iBAAiBlB,EAAMe,YAAYX,iBAAee,mBAAmBlB,EAAcmB,MAAMC,eAAelB,EAAUiB,OAAOE,UAAUnL,KAAKoL,MAAMC,UAAU,gBAAgBC,MAAM,OAAOC,aAAa,SAASC,MAAM,QAIpmBnM,MAAM,oEAAoE,CAAC+K,OAAO,OAAOC,QAAQ,CAAC,eAAe,oBAAoBlK,KAAKmK,KAAKC,UAAU,CAACC,SAAS,2CAA2CC,QAAQ,oBAAoBpQ,KAAK,CAACoR,sBAAsBjM,OAAOkM,iBAAiB9B,GAAW+B,aAAaC,qBAAqBpM,OAAOkM,iBAAiB9B,GAAWiC,YAAYC,YAAYtM,OAAOkM,iBAAiB9B,GAAWmC,iBAAiBZ,UAAUnL,KAAKoL,MAAMC,UAAU,gBAAgBC,MAAM,OAAOC,aAAa,SAASC,MAAM,QAIlhBnM,MAAM,oEAAoE,CAAC+K,OAAO,OAAOC,QAAQ,CAAC,eAAe,oBAAoBlK,KAAKmK,KAAKC,UAAU,CAACC,SAAS,+CAA+CC,QAAQ,eAAepQ,KAAK,CAAC2R,QAAQxM,OAAOkM,iBAAiB7B,GAAOkC,gBAAgBE,gBAAgBzM,OAAOkM,iBAAiB7B,GAAOoB,MAAMiB,cAAc1M,OAAOkM,iBAAiB7B,GAAOsC,SAASC,QAAQ5M,OAAOkM,iBAAiB7B,EAAMwC,QAAQ,IAAIN,gBAAgBO,QAAQ9M,OAAOkM,iBAAiB7B,EAAM0C,OAAOR,iBAAiBZ,UAAUnL,KAAKoL,MAAMC,UAAU,gBAAgBC,MAAM,OAAOC,aAAa,SAASC,MAAM,QAGzmB,MAAMgB,EAAW3C,EAAMwC,QAAQ,IAAII,OAAO,GACpCC,EAAYF,GAAUG,QAAQ,GAC9BC,EAAgBF,GAAW3C,wBAC3B8C,EAAmBD,EAAgBA,EAAclI,KAAOsF,EAAUtF,KAAO,KAE/ErF,MAAM,oEAAoE,CAAC+K,OAAO,OAAOC,QAAQ,CAAC,eAAe,oBAAoBlK,KAAKmK,KAAKC,UAAU,CAACC,SAAS,2CAA2CC,QAAQ,iBAAiBpQ,KAAK,CAACwS,mBAAiBC,mBAAmBtN,OAAOkM,iBAAiB7B,GAAOkD,cAAcC,iBAAiBxN,OAAOkM,iBAAiB7B,GAAOgC,YAAYoB,iBAAiBzN,OAAOkM,iBAAiB7B,EAAMwC,QAAQ,IAAIR,YAAYqB,qBAAqBR,EAAYlN,OAAOkM,iBAAiBgB,GAAWb,YAAc,MAAMV,UAAUnL,KAAKoL,MAAMC,UAAU,gBAAgBC,MAAM,OAAOC,aAAa,SAASC,MAAM,SAEhnB,CAACrS,EAAQoK,IAGZ,MAAM4J,GAAWC,EAAAA,YAAYhT,UAC3B,IACEgJ,GAAW,GAEX,MAAQ/I,MAAMC,KAAEA,UAAiBL,GAASM,KAAKC,UAC/C,GAAIF,GAAMG,MAAO,CACf,MAAQJ,KAAMK,SAAmBT,GAC9BU,KAAK,aACLC,OAAO,QACPC,GAAG,QAASP,EAAKG,OACjBK,SAECJ,GAAUK,MACZ6I,EAAiBlJ,EAASK,KAE9B,CAEA,MAAMa,QAAesC,EAA4BmP,sBAAsBpK,EAAUqK,IAEjF,GAAI1R,EAAOwC,SAAWxC,EAAOvB,KAAM,CACjCmJ,EAAsB5H,EAAOvB,MAG7B,MAAMkT,MAAuBtJ,IACvBuJ,MAAqBvJ,IAE3BrI,EAAOvB,KAAK6N,MAAMuF,QAAQpF,IAExB,IAAIO,EAAW,GACf,GAAIP,EAAKC,oBAAqB,CAC5BM,EAAWL,EAAqBF,EAAKC,qBACrC,MAAMoF,EAAoBrF,EAAKsF,kBAAkBvL,KAAKwL,GACpDA,EAAEC,wBAA0BjF,GAAYgF,EAAEE,qBAAuBlF,GAE/D8E,GACFH,EAAiBQ,IAAI1F,EAAKiF,GAAI1E,EAElC,CAGA,GAAIP,EAAK2F,kBAAoB3F,EAAK4F,gBAAiB,CACjD,MAAMC,EAAY7F,EAAK2F,iBAAiBH,uBACtCxF,EAAK2F,iBAAiBF,oBACtB,GACEI,GACFX,EAAiBQ,IAAI1F,EAAKiF,GAAIY,GAEhCV,EAAeO,IAAI1F,EAAKiF,GAAI,CAC1Ba,YAAa9F,EAAK+F,oBAClBC,QAAShG,EAAK4F,gBACdJ,sBAAuBxF,EAAK2F,iBAAiBH,uBAAyB,GACtEC,mBAAoBzF,EAAK2F,iBAAiBF,mBAC1CQ,UAAYjG,EAAakG,mBAAqB,GAC9CC,SAAWnG,EAAaoG,sBACxBC,WAAarG,EAAasG,wBAC1BC,OAASvG,EAAawG,oBACtB9F,YAAaV,EAAK2F,iBAAiBjF,aAEvC,KAAO,CAEL,IAAI+F,EAAuC,KACvCC,GAAY,EAGhB,MAAMC,EAAqB3G,EAAKsF,kBAAkB3L,OAAO4L,GACvDA,EAAEC,wBAA0BjF,GAAYgF,EAAEE,qBAAuBlF,IAC9D,GAEL,IAAA,MAAWgF,KAAKoB,EAAoB,CAClC,MAAMC,EAAQzM,EAAwB6F,EAAK6G,qBAAuB,GAAItB,EAAEU,UAAWV,EAAEuB,eACjFF,EAAQF,IACVA,EAAYE,EACZH,EAAY,CACVX,YAAaP,EAAEO,YACfE,QAAST,EAAES,QACXR,sBAAuBD,EAAEC,uBAAyB,GAClDC,mBAAoBF,EAAEE,mBACtBQ,UAAWV,EAAEU,UACba,cAAevB,EAAEuB,cACjBX,SAAUZ,EAAEY,SACZE,WAAYd,EAAEc,WACdE,OAAShB,EAAUgB,OACnB7F,YAAa6E,EAAE7E,aAGrB,CAGA,IAAK+F,GAAazG,EAAKsF,kBAAoBtF,EAAKsF,iBAAiB1M,OAAS,EAAG,CAC3E,IAAA,MAAW2M,KAAKvF,EAAKsF,iBAAkB,CACrC,MAAMsB,EAAQzM,EAAwB6F,EAAK6G,qBAAuB,GAAItB,EAAEU,UAAWV,EAAEuB,eACjFF,EAAQF,GAAaE,GAAS,KAChCF,EAAYE,EACZH,EAAY,CACVX,YAAaP,EAAEO,YACfE,QAAST,EAAES,QACXR,sBAAuBD,EAAEC,uBAAyB,GAClDC,mBAAoBF,EAAEE,mBACtBQ,UAAWV,EAAEU,UACba,cAAevB,EAAEuB,cACjBX,SAAUZ,EAAEY,SACZE,WAAYd,EAAEc,WACdE,OAAShB,EAAUgB,OACnB7F,YAAa6E,EAAE7E,aAGrB,CAGA,GAAI+F,EAAW,CACb,MAAMZ,EAAYY,EAAUjB,uBAAyBiB,EAAUhB,oBAAsB,GACjFI,GACFX,EAAiBQ,IAAI1F,EAAKiF,GAAIY,EAElC,CACF,CAEA,IAAKX,EAAiB6B,IAAI/G,EAAKiF,KAAOjF,EAAKsF,kBAAoBtF,EAAKsF,iBAAiB1M,OAAS,EAAG,CAC/F,MAAMoO,EAAgBhH,EAAKsF,iBAAiB2B,OAAO,CAACC,EAAMxT,IACnDwT,GACGxT,EAAQkT,QAAS,IAAOM,EAAKN,WAAelT,EAAUwT,EAD5CxT,EAEjBsM,EAAKsF,iBAAiB,IACnB6B,EAAgBH,EAAcxB,uBAAyBwB,EAAcvB,oBAAsB,GAKjG,GAJI0B,GACFjC,EAAiBQ,IAAI1F,EAAKiF,GAAIkC,IAG3BV,GAAaU,EAAe,CAC/B,MAAMC,EAAkBpH,EAAKsF,iBAAiB3L,OAAO4L,GACnDA,EAAEC,wBAA0B2B,GAAiB5B,EAAEE,qBAAuB0B,GAExE,IAAIE,EAAsC,KACtCC,GAAgB,EACpB,IAAA,MAAW/B,KAAK6B,EAAiB,CAC/B,MAAMR,EAAQzM,EAAwB6F,EAAK6G,qBAAuB,GAAItB,EAAEU,UAAWV,EAAEuB,eACjFF,EAAQU,IACVA,EAAgBV,EAChBS,EAAW,CACTvB,YAAaP,EAAEO,YACfE,QAAST,EAAES,QACXR,sBAAuBD,EAAEC,uBAAyB,GAClDC,mBAAoBF,EAAEE,mBACtBQ,UAAWV,EAAEU,UACba,cAAevB,EAAEuB,cACjBX,SAAUZ,EAAEY,SACZE,WAAYd,EAAEc,WACdE,OAAShB,EAAUgB,OACnB7F,YAAa6E,EAAE7E,aAGrB,CACI2G,GACFlC,EAAeO,IAAI1F,EAAKiF,GAAIoC,EAEhC,CACF,CAEKlC,EAAe4B,IAAI/G,EAAKiF,KAC3BE,EAAeO,IAAI1F,EAAKiF,GAAIwB,EAEhC,IAGF9K,EAAiBuJ,GACjBpJ,EAAeqJ,GAGf,MAAMoC,EAAUhU,EAAOvB,KAAK6N,MAAMW,KAAKlH,GAAKA,EAAE2G,sBAAsBA,oBAChEsH,GACF9L,EAAoByE,EAAqBqH,IAK3C,MAAMzH,EAAYvM,EAAOvB,KAAK6N,MAC3BE,IAAIC,GAAQA,EAAKC,oBAAsBC,EAAqBF,EAAKC,qBAAuB,MACxFtG,OAAOwG,SAGV,GAFuC,IAArBL,EAAUlH,QAAgBkH,EAAUM,MAAMC,GAAMA,IAAOP,EAAU,IAEpE,CAEb,MAAM0H,QAAyB3R,EAA4B4R,iCACzDlU,EAAOvB,KAAK6N,MACZ0H,EACAhU,EAAOvB,KAAK0O,aAGd,GAAI8G,EAAiBzR,SAAWyR,EAAiBxV,OAC/C0N,GAAkB8H,EAAiBxV,MAG/BwV,EAAiBxV,KAAKyU,WAAW,CACnC,MAAMiB,EAASF,EAAiBxV,KAAKyU,UAAUjB,uBACjCgC,EAAiBxV,KAAKyU,UAAUhB,oBAAsB,GACpEhK,EAAoBiM,GAGpB,MAAMC,MAAuB/L,IAE7B4L,EAAiBxV,KAAKyU,UAAU5K,YAAYuJ,QAAQwC,IAElD,IAAA,MAAW5H,KAAQzM,EAAOvB,KAAM6N,MAAO,CACrC,MAAMgI,EAAY7H,EAAKsF,kBAAkB9E,QAAU+E,EAAES,UAAY4B,EAAME,cACvE,GAAID,EAAW,CACbF,EAAiBjC,IAAIkC,EAAMG,UAAW,CACpCjC,YAAa+B,EAAU/B,YACvBE,QAAS6B,EAAU7B,QACnBR,sBAAuBqC,EAAUrC,uBAAyB,GAC1DC,mBAAoBoC,EAAUpC,mBAC9BQ,UAAW4B,EAAU5B,UACrBa,cAAee,EAAUf,cACzBX,SAAU0B,EAAU1B,SACpBE,WAAYwB,EAAUxB,WACtBE,OAASsB,EAAkBtB,OAC3B7F,YAAamH,EAAUnH,cAEzB,KACF,CACF,IAIF,MAAMsH,EAAgB,IAAIpM,IAAIuJ,GAC9BwC,EAAiBvC,QAAQ,CAACzR,EAAOxD,KAC3BwD,GAAOqU,EAActC,IAAIvV,EAAKwD,KAEpCmI,EAAekM,GAGf,MAAMC,EAAaT,EAAiBxV,KAAKyU,UAAUwB,WAC7CC,EAA0B,SAAfD,EAAwB,KAAsB,WAAfA,EAA0B,KAAO,KACjFhV,EAAM8C,QACJ,aAAayR,EAAiBxV,KAAKyU,UAAU0B,oBAAoB5U,EAAOvB,KAAK6N,MAAMjH,uBAAuBsP,KAE9G,CAEJ,CACF,MACEjV,EAAMC,MAAMK,EAAOL,OAAS,qBAEhC,OAASA,GACPD,EAAMC,MAAM,qBACd,CAAA,QACE6H,GAAW,EACb,GACC,CAACH,EAAUqK,GAAIrT,KAElBE,EAAAA,UAAU,KACJhB,GAAU8J,IACZ6D,IAAsB,GACtBqG,OAED,CAAChU,EAAQ8J,EAAWkK,KAGvBhT,EAAAA,UAAU,KACR,IAAKoJ,IAAuBpK,EAAQ,OAGpC,GAAIgK,EAAS,OAEb,MAAMsN,MAAiBxM,IACjByM,EAAe,IAAIzM,IAAoBF,GAC7C,IAAI4M,GAAkB,EAClBC,GAAe,EAEnBrN,EAAmB2E,MAAMuF,QAAQoD,IAC/B,MAAMC,EAAe5M,EAAY6M,IAAIF,EAAQvD,IAGvC1E,EAAWZ,GACbnE,EACCE,EAAcgN,IAAIF,EAAQvD,MAAQuD,EAAQvI,oBAAsBC,EAAqBsI,EAAQvI,qBAAuB,IAGzH,GAAIwI,IAAiBA,EAAajD,wBAA0BjF,GAAYkI,EAAahD,qBAAuBlF,GAE1G,YADA6H,EAAW1C,IAAI8C,EAAQvD,GAAIwD,GAK7B,IAAIhC,EAAuC,KACvCC,GAAY,EAGhB,MAAMC,EAAqBpG,GACvBiI,EAAQlD,kBAAkB3L,OAAO4L,GAC/BA,EAAEC,wBAA0BjF,GAAYgF,EAAEE,qBAAuBlF,IAEnE,GAEJ,IAAA,MAAWgF,KAAKoB,EAAoB,CAClC,MAAMC,EAAQzM,EAAwBqO,EAAQ3B,qBAAuB,GAAItB,EAAEU,UAAWV,EAAEuB,eACpFF,EAAQF,IACVA,EAAYE,EACZH,EAAY,CACVX,YAAaP,EAAEO,YACfE,QAAST,EAAES,QACXR,sBAAuBD,EAAEC,uBAAyB,GAClDC,mBAAoBF,EAAEE,mBACtBQ,UAAWV,EAAEU,UACba,cAAevB,EAAEuB,cACjBX,SAAUZ,EAAEY,SACZE,WAAYd,EAAEc,WACdE,OAAShB,EAAUgB,OACnB7F,YAAa6E,EAAE7E,aAGrB,CAGA,IAAK+F,GAAa+B,EAAQlD,iBACxB,IAAA,MAAWC,KAAKiD,EAAQlD,iBAAkB,CACxC,MAAMsB,EAAQzM,EAAwBqO,EAAQ3B,qBAAuB,GAAItB,EAAEU,UAAWV,EAAEuB,eACpFF,EAAQF,GAAaE,GAAS,KAChCF,EAAYE,EACZH,EAAY,CACVX,YAAaP,EAAEO,YACfE,QAAST,EAAES,QACXR,sBAAuBD,EAAEC,uBAAyB,GAClDC,mBAAoBF,EAAEE,mBACtBQ,UAAWV,EAAEU,UACba,cAAevB,EAAEuB,cACjBX,SAAUZ,EAAEY,SACZE,WAAYd,EAAEc,WACdE,OAAShB,EAAUgB,OACnB7F,YAAa6E,EAAE7E,aAGrB,CAMF,GAHA0H,EAAW1C,IAAI8C,EAAQvD,GAAIwB,GAGvBA,EAAW,CACb,MAAMZ,EAAYY,EAAUjB,uBAAyBiB,EAAUhB,oBAAsB,GAC/EkD,EAAmBjN,EAAcgN,IAAIF,EAAQvD,KAAO,GAGtDY,GAAaA,IAAc8C,IAC7BN,EAAa3C,IAAI8C,EAAQvD,GAAIY,GAC7B0C,GAAe,EAEnB,CAGIE,IAAiBhC,IACnB6B,GAAkB,KAKlBA,GACFxM,EAAesM,GAIbG,GACF5M,EAAiB0M,IAElB,CAAC7M,EAAkBmE,GAAgBzE,EAAoBpK,EAAQgK,IAOlE,MAAM8N,GAAwBhJ,EAAAA,QAAQ,KACpC,IAAK1E,EAAoB,MAAO,GAGhC,MAAM2N,EAAiB3N,EAAmB2E,MAAMW,QAAUlH,EAAE2G,sBAAsBA,qBAAuB,GAEnG6I,GADkBD,EAAiB3I,EAAqB2I,GAAgBE,cAAgB,IAC1D/V,WAAW,MAgBzCgW,MAAmBpN,IAGrB6D,IAAgBwJ,YAClBxJ,GAAewJ,WAAW7D,QAAQyC,IAChC,MAAM1X,EAAM2Y,GACPjB,EAAUpC,oBACXoC,EAAUrC,sBAEVrV,GACF6Y,EAAatD,IAAIvV,EAAK,CACpBoQ,SAAUsH,EAAUrC,uBAAyB,GAC7C0D,iBAAkBrB,EAAUpC,mBAC5B0D,UAAWtB,EAAUM,iBACrBtI,MAAO,GACPuJ,WAAYvB,EAAUnH,YACtB2I,cAAexB,EAAUyB,WACzBnB,iBAAkBN,EAAUM,iBAC5BoB,WAAY1B,EAAU/B,gBAO9B5K,EAAmB2E,MAAMuF,QAAQpF,IAC/BA,EAAKsF,kBAAkBF,QAAQyC,IAC7B,MAAM1X,EAAM2Y,EACPjB,EAAUpC,oBAAsB,GAChCoC,EAAUrC,uBAAyB,GAaxC,GAXIrV,IAAQ6Y,EAAajC,IAAI5W,IAC3B6Y,EAAatD,IAAIvV,EAAK,CACpBoQ,SAAUsH,EAAUrC,uBAAyB,GAC7C0D,iBAAkBrB,EAAUpC,mBAC5B0D,UAAW,EACXtJ,MAAO,GACPuJ,WAAYvB,EAAUnH,YACtB6I,WAAY1B,EAAU/B,cAItB3V,GAAO6Y,EAAajC,IAAI5W,GAAM,CAChC,MAAMqZ,EAAWR,EAAaN,IAAIvY,GAClCqZ,EAAS3J,MAAM4J,KAAK5B,GACf2B,EAASH,gBACZG,EAASL,UAAYK,EAAS3J,MAAMjH,OAExC,MAKA8E,GAAWvK,KAAO,GACpBuK,GAAW0H,QAAQ,CAACvF,EAAO1P,KACzB,MAAMuZ,EAAgBxJ,EAAqB/P,GACrCwZ,EAAOD,EAAc1W,WAAW,MAClC8V,IAAgBa,IACfb,GAAea,GAEfX,EAAajC,IAAI2C,IACpBV,EAAatD,IAAIgE,EAAe,CAC9BnJ,SAAUoJ,EAAO,GAAKD,EACtBR,iBAAkBS,EAAOD,OAAgB,EACzCP,UAAWtJ,EAAMjH,OACjBiH,MAAOA,EAAME,IAAKC,IAAA,CAChB8F,YAAa9F,EAAK8F,YAClBN,sBAAuBxF,EAAKwF,uBAAyB,GACrDC,mBAAoBzF,EAAKyF,mBACzBO,QAAShG,EAAKgG,QACdC,UAAWjG,EAAKiG,UAChBa,cAAe9G,EAAK8G,cACpBX,SAAUnG,EAAKmG,UAAY,EAC3BE,WAAYrG,EAAKqG,WACjB3F,YAAaV,EAAKU,YAClBkG,MAAO,EACPgD,cAAe,CAAC,mBAElBR,WAAYvJ,EAAM,IAAIa,YACtB6I,WAAY1J,EAAM,IAAIiG,gBAO9BkD,EAAa5D,QAAQ,CAACyC,EAA8B1X,KAElD,IAAI0Z,EAAa,EACbC,EAAe,EACfC,EAAuB,EACvBC,EAA0B,EAC9B,MAAMN,EAAgBxJ,EAAqB/P,GAAK4Y,cAO1CkB,EANwB/O,EAAmB2E,MAC9CE,IAAIC,IACH,MAAMrM,EAAQuW,GAAgBlK,EAAM,aACpC,OAAOrM,EAAQuM,EAAqBvM,GAAOoV,cAAgB,OAE5DpP,OAAOwG,SACwCpG,KAAKoQ,GAAOA,IAAQT,GAEhEU,EAAiBvC,EAAUhI,MAEjC3E,EAAmB2E,MAAMuF,QAAQoD,IAE/B,IAAI9B,EAAY,EACZ2D,EAAuC,KAC3C,MAAMC,EAAcJ,GAAgB1B,EAAS,aAE7C,IAAA,MAAW+B,KAAWH,EAAgB,CACpC,MAAMpK,EAAuBuK,EACvB3D,EAAQzM,EACZmQ,GAAe,GACftK,EAAKiG,UACLjG,EAAK8G,eAEHF,EAAQF,IACVA,EAAYE,EACZyD,EAAgBrK,EAEpB,CAEA,GAAI0G,GAAa,IAAwB,OAAlB2D,EAAwB,CAC7CP,IAGA,MAAMU,EAAYN,GAAgB1B,EAAS,YACrCiC,EAA8B,iBAAdD,EAClBA,EACe,KAAdA,EAAmBtJ,OAAOsJ,QAAa,EAEtCE,EAD4BL,EACDlE,cAClB,IAAXsE,IAAyBvJ,OAAOC,MAAMsJ,IAAWjQ,EAAkBiQ,EAAQC,GAC7EX,IAEAC,GAEJ,CACAH,GAAcnD,IAIhB,MAAMiE,EAAYzP,EAAmB2E,MAAMjH,OAAS,EAChDnC,KAAKG,MAAMiT,EAAa3O,EAAmB2E,MAAMjH,QACjD,EAGEgS,EAAiBd,EAAe,GAAKC,IAAyBD,EAAgB,GAAK,EAGnFe,EAAcpU,KAAKI,IAAI,IAAK8T,EAAYC,GAGxCE,EAAmBb,EAAsB,IAAM,OAErB,IAA5BpC,EAAUwB,eACZxB,EAAUwB,cAAgBwB,EAAcC,EACxCjD,EAAUkD,aAAeF,EACzBhD,EAAUM,iBAAmB2B,GACpBG,IAETpC,EAAUwB,eAAiBxB,EAAUwB,eAAiB,GAAKyB,OAE5B,IAA3BjD,EAAUkD,eACZlD,EAAUkD,aAAelD,EAAUwB,cAAgByB,IAIvDjD,EAAUkC,qBAAuBA,EACjClC,EAAUmC,wBAA0BA,EACnCnC,EAAkBoC,oBAAsBA,IAI3C,MAAM1W,EAASyX,MAAM1Y,KAAK0W,EAAaiC,UAoBvC,OAjBA1X,EAAO2X,KAAK,CAAC5T,EAAG6T,KAEd,MAAMC,EAAa9T,EAAU2S,oBAAsB,EAAI,EACjDoB,EAAaF,EAAUlB,oBAAsB,EAAI,EACvD,GAAImB,IAAcC,EAChB,OAAOA,EAAYD,EAIrB,MAAME,EAAShU,EAAE+R,eAAiB,EAC5BkC,EAASJ,EAAE9B,eAAiB,EAClC,OAAIiC,IAAWC,EACNA,EAASD,EAEXH,EAAEhC,UAAY7R,EAAE6R,YAGlB5V,GACN,CAAC2H,EAAoBuE,GAAgB/B,GAAYhB,IAE9C8O,GAAuBzG,cAAapR,IACxC,IAAKA,EAAO,OACZ,MAAM8X,EAAkBvL,EAAqBvM,GACvCkU,EAAYe,GAAsBpI,KACtC+E,GACEA,EAAEhF,WAAakL,GACflG,EAAE2D,mBAAqBuC,GACvBlG,EAAEhF,WAAa5M,GACf4R,EAAE2D,mBAAqBvV,GAE3B,GAAIkU,EACF,OAAI4D,EAAgBzY,WAAW,KAAa6U,EAAUqB,iBAClDuC,EAAgBzY,WAAW,MAAc6U,EAAUtH,SAChDsH,EAAUqB,kBAAoBrB,EAAUtH,SAEjD,MAAMV,EAAQnC,GAAWgL,IAAI+C,IAAoB/N,GAAWgL,IAAI/U,IAAU,GAC1E,GAAIkM,EAAMjH,OAAS,EAAG,CACpB,MAAMoH,EAAOH,EAAM,GACnB,OAAI4L,EAAgBzY,WAAW,KAAagN,EAAKyF,mBAC7CgG,EAAgBzY,WAAW,MAAcgN,EAAKwF,uBAAyBxF,EAAKwF,sBACzExF,EAAKyF,oBAAsBzF,EAAKwF,qBACzC,GAEC,CAACoD,GAAuBlL,KAErBgO,GAAqC/X,IACzC,IAAKA,EAAO,OACZ,MAAMgY,EAAazL,EAAqBvM,GAClCiY,EAAWtM,GAAgBoJ,IAAIiD,GACrC,YAAiB,IAAbC,EACKA,QAAY,EAEdJ,GAAqB7X,IAK9B7B,EAAAA,UAAU,KACR,IAAK8W,GAAsBhQ,SAAW+G,GAAgB,OAGtD,GAAInB,GAAoB,OAGxB,MAAMqN,EAAoBjD,GAAsBpI,KAC9C+E,IAAwC,IAAlCA,EAAU0E,qBAGlB,GAAI4B,EAAmB,CACrB,MAAMC,EAAaD,EAAkBtL,UAAYsL,EAAkB3C,kBAAoB,GAEvF,GAAI4C,GAAcA,IAAetQ,EAG/B,YADAC,EAAoBqQ,EAGxB,CAQA,IALuBlD,GAAsB7O,KAC3CwL,GAAKA,EAAEhF,WAAa/E,GAAoB+J,EAAE2D,mBAAqB1N,IAI1CoN,GAAsB,GAAI,CAC/C,MAAMmD,EAAiBnD,GAAsB,GACvCoD,EAAQD,EAAexL,UAAYwL,EAAe7C,kBAAoB,GACxE8C,GAEFvQ,EAAoBuQ,EAExB,GACC,CAACpD,GAAuBpN,EAAkBmE,GAAgBnB,KAG7D,MAAMyN,GAAsBlH,cAAaxE,IACvC,IAAKrF,IAAuBqF,QAAiB,GAC7C,MAAM2L,EAAcxO,GAAWgL,IAAInI,IAAa,GAChD,GAAI2L,EAAYtT,OAAS,EAAG,CAI1B,OAHgBsT,EAAYvS,OAAO,CAACqG,EAAMmM,EAAOC,IAC/CD,IAAUC,EAAKC,UAAUC,GAAKA,EAAEtG,UAAYhG,EAAKgG,SAGrD,CAEA,MAAMnG,EAA8B,GAEpC3E,EAAmB2E,MAAMuF,QAAQpF,IAC/BA,EAAKsF,kBAAkBF,QAAQyC,IACzBA,EAAUrC,wBAA0BjF,GACpCsH,EAAUpC,qBAAuBlF,GACnCV,EAAM4J,KAAK,CACT3D,YAAa+B,EAAU/B,YACvBE,QAAS6B,EAAU7B,QACnBR,sBAAuBqC,EAAUrC,uBAAyB,GAC1DC,mBAAoBoC,EAAUpC,mBAC9BQ,UAAW4B,EAAU5B,UACrBa,cAAee,EAAUf,cACzBX,SAAU0B,EAAU1B,SACpBE,WAAYwB,EAAUxB,WACtBE,OAASsB,EAAkBtB,OAC3B7F,YAAamH,EAAUnH,kBAU/B,OAHgBb,EAAMlG,OAAO,CAACqG,EAAMmM,EAAOC,IACzCD,IAAUC,EAAKC,UAAUC,GAAKA,EAAEtG,UAAYhG,EAAKgG,WAGlD,CAAC9K,EAAoBwC,KAMlB6O,GAAyBxH,cAAagD,IAC1C,IAAK7M,EAAoB,MAAO,GAEhC,MAAM8E,EAAO9E,EAAmB2E,MAAMW,KAAKlH,GAAKA,EAAE2L,KAAO8C,GACzD,IAAK/H,EAAM,MAAO,GAElB,MAAMF,MAAgB7D,IAQhB6M,GALkB9I,EAAKC,oBACzBC,EAAqBF,EAAKC,qBAAqB8I,cAC/C,IAGgC/V,WAAW,MAG/CgN,EAAKsF,kBAAkBF,QAAQG,IACzBuD,EAEEvD,EAAEE,oBAAoB3F,EAAU0M,IAAIjH,EAAEE,oBAGtCF,EAAEC,uBAAuB1F,EAAU0M,IAAIjH,EAAEC,yBAIjD,OADewF,MAAM1Y,KAAKwN,IAEzB,CAAC5E,IAGEuR,GAAoB,CAACC,EAAgBC,EAA4BhZ,KACrEgJ,GAAkBnG,IAChB,MAAMoW,EAAS,IAAIhR,IAAIpF,GACjBgT,EAAWoD,EAAOlE,IAAIgE,IAAW,CAAA,EAEvC,OADAE,EAAOlH,IAAIgH,EAAQ,IAAKlD,EAAUmD,CAACA,GAAQhZ,IACpCiZ,KAKX,SAAS1C,GACP1B,EACAmE,GAEA,MAAME,EAASnQ,EAAegM,IAAIF,EAAQvD,IAC1C,GAAI4H,QAA4B,IAAlBA,EAAOF,GACnB,OAAOE,EAAOF,GAGhB,OAAQA,GACN,IAAK,YACH,OAAOnE,EAAQ3B,qBAAuB,GACxC,IAAK,WACH,OAAO2B,EAAQsE,oBAAsB,GACvC,IAAK,aACH,OAAOtE,EAAQuE,sBAAwB,GACzC,IAAK,SACH,OAAOvE,EAAQwE,kBAAoB,GACrC,IAAK,YACH,OAAOtR,EAAcgN,IAAIF,EAAQvD,MAC9BuD,EAAQvI,oBAAsBC,EAAqBsI,EAAQvI,qBAAuB,IACvF,QACE,MAAO,GAEb,CAGA,MAAMgN,GAAkB,CAACzE,EAA4CmE,KACnE,MAAME,EAASnQ,EAAegM,IAAIF,EAAQvD,IAC1C,IAAK4H,QAA4B,IAAlBA,EAAOF,GAAsB,OAAO,EAEnD,OAAQA,GACN,IAAK,YAAa,OAAOE,EAAO5G,YAAcuC,EAAQ3B,oBACtD,IAAK,WAAY,OAAOgG,EAAO1G,WAAaqC,EAAQsE,mBACpD,IAAK,aAAc,OAAOD,EAAOxG,aAAemC,EAAQuE,qBACxD,IAAK,SAAU,OAAOF,EAAOtG,SAAWiC,EAAQwE,iBAChD,IAAK,YAAa,CAChB,MAAME,EAAW1E,EAAQvI,oBAAsBC,EAAqBsI,EAAQvI,qBAAuB,GACnG,OAAO4M,EAAOM,YAAcD,CAC9B,CACA,QAAS,OAAO,IAkIdE,GAAuBrb,MAAOwO,EAAkB8M,EAA+BC,KAInF,GAHA7R,EAAoB8E,GAGhB+M,EAAoB,CACtB,MAAMC,EAAerN,EAAqBK,GAC1ChB,GAAmB/I,IACjB,MAAMgX,EAAO,IAAI5R,IAAIpF,GAErB,OADAgX,EAAK9H,IAAI6H,EAAcD,GAChBE,GAEX,CAIA,MAAMC,EAAc7E,GAAsBpI,KACxC+E,GAAKA,EAAEhF,WAAaA,GAAYgF,EAAE2D,mBAAqB3I,GAIzD,IAAImN,EAAoC,GACpCtE,EAAaiE,GAAwB,GAoCzC,GAlCII,GAAeA,EAAY5N,MAAMjH,OAAS,IAC5C8U,EAAcD,EAAY5N,MAAME,IAAIC,IAAA,CAClC8F,YAAa9F,EAAK8F,YAClBE,QAAShG,EAAKgG,QACdR,sBAAuBxF,EAAKwF,uBAAyB,GACrDC,mBAAoBzF,EAAKyF,mBACzBQ,UAAWjG,EAAKiG,UAChBa,cAAe9G,EAAK8G,cACpBX,SAAUnG,EAAKmG,SACfE,WAAYrG,EAAKqG,WACjBE,OAASvG,EAAauG,OACtB7F,YAAaV,EAAKU,eAIpBgN,EAAcA,EAAY/T,OAAO,CAACqG,EAAMmM,EAAOC,IAC7CD,IAAUC,EAAKC,UAAUC,GAAKA,EAAEtG,UAAYhG,EAAKgG,WAI9CoD,GAAcsE,EAAY,IAAIhN,cACjC0I,EAAasE,EAAY,GAAGhN,cAKL,IAAvBgN,EAAY9U,SACd8U,EAAczB,GAAoB1L,IAC7B6I,GAAcsE,EAAY,IAAIhN,cACjC0I,EAAasE,EAAY,GAAGhN,cAKL,IAAvBgN,EAAY9U,OACd,IAEE,MAAQ5G,KAAM2b,SAA0B/b,GACrCU,KAAK,qBACLC,OAAO,+IAMPqb,GAAG,4BAA4BrN,2BAAkCA,KACjEsN,MAAM,GACNpb,SAEH,GAAIkb,EAAiB,EAEdvE,GAAeuE,EAAgBG,QAAgBpN,cAClD0I,EAAcuE,EAAgBG,OAAepN,aAI/C,MAAM6M,EAAerN,EAAqBK,GACpCwN,EAAexN,EAASvN,WAAW,KACrC2a,EAAgBlI,mBAChBkI,EAAgBnI,sBAChBuI,GACFxO,GAAmB/I,IACjB,MAAMgX,EAAO,IAAI5R,IAAIpF,GAErB,OADAgX,EAAK9H,IAAI6H,EAAcQ,GAChBP,IAKX,MAAQxb,KAAMgc,SAAwBpc,GACnCU,KAAK,0BACLC,OAAO,qNASPC,GAAG,sBAAuBmb,EAAgB1I,IAEzC+I,GAAiBA,EAAcpV,OAAS,IAC1C8U,EAAcM,EAAcjO,IAAKC,IAAA,CAC/B8F,YAAa6H,EAAgB1I,GAC7Be,QAAShG,EAAKiF,GACdO,sBAAuBmI,EAAgBnI,uBAAyB,GAChEC,mBAAoBkI,EAAgBlI,mBACpCQ,UAAWjG,EAAKiG,WAAa,GAC7Ba,cAAe9G,EAAK8G,cACpBX,SAAUnG,EAAKmG,SACf8H,kBAAmBjO,EAAKiO,kBACxB5H,WAAYrG,EAAKkO,iBACjB3H,OAAQvG,EAAKmO,aACbzN,YAAa0I,KAInB,CACF,OAASlW,GAET,CAyBF,GAnBIwa,EAAY9U,OAAS,GACvB+E,GAAcnH,IACZ,MAAMgX,EAAO,IAAI5R,IAAIpF,GACrBgX,EAAK9H,IAAInF,EAAUmN,GAEnB,MAAMxE,EAAmBwE,EAAY,IAAIjI,mBAIzC,OAHIyD,GAAoBA,IAAqB3I,GAC3CiN,EAAK9H,IAAIwD,EAAkBwE,GAEtBF,IAKPpE,GACFnM,GAAoBmM,GAIlBlO,EAAoB,CACtB,MAAMkN,MAAiBxM,IAEvBV,EAAmB2E,MAAMuF,QAAQoD,IAE/B,IAAI/B,EAAuC,KACvCC,EAAY,EAEhBgH,EAAYtI,QAAQmF,IAClB,MAAM3D,EAAQzM,EAAwBqO,EAAQ3B,qBAAuB,GAAI0D,EAAQtE,UAAWsE,EAAQzD,eAChGF,EAAQF,GAAaE,GAAS,KAChCF,EAAYE,EACZH,EAAY8D,KAIhBnC,EAAW1C,IAAI8C,EAAQvD,GAAIwB,KAG7B3K,EAAesM,EACjB,GA8EIgG,GAA0BrJ,cAAYhT,MAAOsc,IACjD,MAAMvN,EAAUuN,EAAStN,OACzB,IAAKD,EAAS,OACd,MAAM6K,EAAazL,EAAqBY,GACxC,GAAK6K,IACDrM,GAAgByH,IAAI4E,KACpBnM,GAAsB9L,QAAQqT,IAAI4E,GAAtC,CACAnM,GAAsB9L,QAAQ8Y,IAAIb,GAClC,IACE,MAAM3Z,KAAEA,QAAMkB,SAAgBtB,GAC3BU,KAAK,qBACLC,OAAO,4CACPqb,GAAG,4BAA4BjC,2BAAoCA,KACnEkC,MAAM,GACT,GAAI3a,EAAO,MAAMA,EACjB,MAAM0U,EAAQ5V,IAAO,GACf+b,EAAenG,EAChB+D,EAAW3Y,WAAW,KACnB4U,EAAMnC,mBACNkG,EAAW3Y,WAAW,MACpB4U,EAAMpC,sBACLoC,EAAMnC,oBAAsBmC,EAAMpC,sBACzC,KACJjG,GAAmB/I,IACjB,MAAMgX,EAAO,IAAI5R,IAAIpF,GAErB,OADAgX,EAAK9H,IAAIiG,EAAYoC,GAAgB,MAC9BP,GAEX,OAASc,GACP/O,GAAmB/I,IACjB,MAAMgX,EAAO,IAAI5R,IAAIpF,GAErB,OADAgX,EAAK9H,IAAIiG,EAAY,MACd6B,GAEX,CAAA,QACEhO,GAAsB9L,QAAQ6a,OAAO5C,EACvC,CA9BmD,GA+BlD,CAACrM,GAAiB1N,KAGf4c,GAA0BzJ,cAAYhT,MAAO0c,IACjDL,GAAwBK,GAGpBvT,GACFA,EAAmB2E,MAAMuF,QAAQpF,IAC/ByM,GAAkBzM,EAAKiF,GAAI,YAAawJ,KAK5C,MAAMhD,EAAkBvL,EAAqBuO,GAC7C,IAAKhD,EAAiB,OAItB,MAAMI,EAAoBjD,GAAsBpI,KAC9C+E,GAAKA,EAAEhF,WAAakL,GAAmBlG,EAAE2D,mBAAqBuC,GAGhE,GAAII,EAAmB,CACrB,MAAMG,EAAQH,EAAkBtL,UAAYsL,EAAkB3C,kBAAoB,GAC9E8C,GAASA,IAAUxQ,GACrBC,EAAoBuQ,GAElBH,EAAkBzC,aACpBnM,GAAoB4O,EAAkBzC,YACtC3L,GAAsBoO,EAAkBzC,YAE5C,KAAO,CAEL3N,EAAoBgQ,GAEpB,IACE,MAAQzZ,KAAM0c,SAAuB9c,GAClCU,KAAK,qBACLC,OAAO,wYAePqb,GAAG,4BAA4BnC,2BAAyCA,KACxEoC,MAAM,GAET,GAAIa,GAAgBA,EAAa9V,OAAS,EAAG,CAC3C,MAAM+V,EAAWD,EAAa,GACxB7O,EAAQ8O,EAASC,wBAA0B,GAC3CxF,EAAcuF,EAASb,QAA4CpN,aAAe,GAGlFmO,EAAWhP,EAAME,IAAKC,IAAA,CAC1B8F,YAAa6I,EAAS1J,GACtBe,QAAShG,EAAKiF,GACdO,sBAAuBmJ,EAASnJ,uBAAyB,GACzDC,mBAAoBkJ,EAASlJ,mBAC7BQ,UAAWjG,EAAKiG,UAChBa,cAAe9G,EAAK8G,cACpBX,SAAUnG,EAAKmG,UAAY,EAC3B8H,kBAAmBjO,EAAKiO,kBACxB5H,WAAYrG,EAAKkO,iBACjB3H,OAAQvG,EAAKmO,aACbzN,YAAa0I,KAGfzL,GAAcnH,IACZ,MAAMgX,EAAO,IAAI5R,IAAIpF,GASrB,OARAgX,EAAK9H,IAAI+F,EAAiBoD,GAEtBF,EAASnJ,uBACXgI,EAAK9H,IAAIiJ,EAASnJ,sBAAuBqJ,GAEvCF,EAASlJ,oBACX+H,EAAK9H,IAAIiJ,EAASlJ,mBAAoBoJ,GAEjCrB,IAGLpE,IACFnM,GAAoBmM,GACpB3L,GAAsB2L,GAG1B,CACF,OAASkF,GAET,CACF,GACC,CAACpT,EAAoB0N,GAAuBpN,EAAkB4S,GAAyB3B,GAAmB7a,KAGvG+O,GAAqB5O,MAAOqX,EAAoB0F,KACpD,MAAMC,GAAgBD,GAASlO,OAC/BnD,GAAsB2L,GACtBnM,GAAoBmM,GACpB7L,IAAsB,GACtBJ,GAAuB,IAEnB4R,GACF9b,EAAM8C,QAAQ,SAASqT,oCAIzB,IACE,MAAQpX,KAAMgd,EAAA9b,MAAWA,SAAgBtB,GACtCU,KAAK,qBACLC,OAAO,uXAePC,GAAG,qBAAsB4W,GACzB6F,MAAM,aAAc,CAAEC,WAAW,IACjCrB,MAAM,IAET,GAAI3a,EAAO,MAAMA,EAEjB,IAAK8b,GAAkC,IAArBA,EAAUpW,OAI1B,YAHImW,GACF9b,EAAMC,MAAM,IAAIkW,yBAKpB,MAAM+F,MAAevT,IACrB,IAAIwT,EAAgB,EACpBJ,EAAU5J,QAASuJ,IACjB,MAAMzC,GAAqCyC,EAAS9O,OAAS,IAAIE,IAAKC,IAAA,CACpE8F,YAAa6I,EAAS1J,GACtBe,QAAShG,EAAKiF,GACdO,sBAAuBmJ,EAASnJ,uBAAyB,GACzDC,mBAAoBkJ,EAASlJ,mBAC7BQ,UAAWjG,EAAKiG,WAAa,GAC7Ba,cAAe9G,EAAK8G,cACpBX,SAAUnG,EAAKmG,SACf8H,kBAAmBjO,EAAKiO,kBACxB5H,WAAYrG,EAAKkO,iBACjB3H,OAAQvG,EAAKmO,aACbzN,YAAa0I,KAEY,IAAvB8C,EAAYtT,SAChBwW,GAAiBlD,EAAYtT,OACzB+V,EAASnJ,uBACX2J,EAASzJ,IAAIiJ,EAASnJ,sBAAuB0G,GAE3CyC,EAASlJ,oBACX0J,EAASzJ,IAAIiJ,EAASlJ,mBAAoByG,MAG9CvO,GAAcwR,GAGd,MAAME,MAAoBzT,IACpB2L,EAAUyH,EAAU,IAAIxJ,uBAAyBwJ,EAAU,IAAIvJ,oBAAsB,GAG3F,GAAIvK,EAAoB,CACtBA,EAAmB2E,MAAMuF,QAAQ,CAACoD,EAAS2D,KACzC,MAAMlD,EAA+B,GACrC,IAAIqG,EAAgB,EAChBC,EAAgB,EAEpBP,EAAU5J,QAASuJ,KAChBA,EAAS9O,OAAS,IAAIuF,QAASpF,IAC9B,MAAMhH,EAAamB,EAAwBqO,EAAQ3B,qBAAuB,GAAI7G,EAAKiG,UAAWjG,EAAK8G,eACnGyI,GAAiB,EACbvW,EAAasW,IACfA,EAAgBtW,GAEdA,GAAc,IAChBiQ,EAAWQ,KAAK,CACd3D,YAAa6I,EAAS1J,GACtBe,QAAShG,EAAKiF,GACdO,sBAAuBmJ,EAASnJ,uBAAyB,GACzDC,mBAAoBkJ,EAASlJ,mBAC7BQ,UAAWjG,EAAKiG,WAAa,GAC7Ba,cAAe9G,EAAK8G,cACpBX,SAAUnG,EAAKmG,SACfE,WAAYrG,EAAKkO,iBACjBtH,MAAO5N,EACP4Q,cAAe,CAAC,UAChBlJ,YAAa0I,QASrBH,EAAWiC,KAAK,CAAC5T,EAAG6T,IAAMA,EAAEvE,MAAQtP,EAAEsP,OACtCyI,EAAc3J,IAAI8C,EAAQvD,GAAIgE,EAAW5H,MAAM,EAAG,MAIpD5F,EAAoB8L,GAEpB,MAAMa,MAAiBxM,IACjB8R,GAAqCsB,EAAU,IAAInP,OAAS,IAAIE,IAAKC,IAAA,CACzE8F,YAAakJ,EAAU,GAAG/J,GAC1Be,QAAShG,EAAKiF,GACdO,sBAAuBwJ,EAAU,GAAGxJ,uBAAyB,GAC7DC,mBAAoBuJ,EAAU,GAAGvJ,mBACjCQ,UAAWjG,EAAKiG,WAAa,GAC7Ba,cAAe9G,EAAK8G,cACpBX,SAAUnG,EAAKmG,SACfE,WAAYrG,EAAKkO,iBACjB3H,OAAQvG,EAAKmO,aACbzN,YAAa0I,KAGflO,EAAmB2E,MAAMuF,QAAQoD,IAC/B,IAAI/B,EAAuC,KACvCC,EAAY,EAEhBgH,EAAYtI,QAAQmF,IAClB,MAAM3D,EAAQzM,EAAwBqO,EAAQ3B,qBAAuB,GAAI0D,EAAQtE,UAAWsE,EAAQzD,eAChGF,EAAQF,GAAaE,GAAS,KAChCF,EAAYE,EACZH,EAAY8D,KAIhBnC,EAAW1C,IAAI8C,EAAQvD,GAAIwB,KAG7B3K,EAAesM,GAGf1I,GAAkB,CAChB+G,UAAW,CACTX,YAAakJ,EAAU,GAAG/J,GAC1BO,sBAAuBwJ,EAAU,GAAGxJ,uBAAyB,GAC7DC,mBAAoBuJ,EAAU,GAAGvJ,mBACjC/E,YAAa0I,EACbE,WAAY,IACZnB,iBAAkBC,EAAWjV,KAC7Bqc,eAAgBtU,EAAmB2E,MAAMjH,OACzCqP,WAAY,OACZpM,YAAa,IAEfoN,WAAY+F,EAAUjP,IAAK0P,IAAA,CACzB3J,YAAa2J,EAAExK,GACfO,sBAAuBiK,EAAEjK,uBAAyB,GAClDC,mBAAoBgK,EAAEhK,mBACtB/E,YAAa0I,EACbE,WAAYmG,EAAExK,KAAO+J,EAAU,GAAG/J,GAAK,IAAM,GAC7CkD,kBAAmBsH,EAAE5P,OAAS,IAAIjH,YAIlCmW,GACF9b,EAAM8C,QAAQ,GAAGiZ,EAAUpW,kCAE/B,CAEF,OAAS0V,GAEPrb,EAAMC,MAAM,yBACd,GAIIwc,GAAqB,CAAC3H,EAAmBxH,KAC7C5E,EAAiBnF,IACf,MAAMoW,EAAS,IAAIhR,IAAIpF,GAEvB,OADAoW,EAAOlH,IAAIqC,EAAWxH,GACfqM,IAGT,MAAMpE,EAAUtN,GAAoB2E,MAAMW,KAAKlH,GAAKA,EAAE2L,KAAO8C,GAE7D,GAAIS,EAAS,CAEX,MAAM7B,EAAqB6B,EAAQlD,kBAAkB3L,OAAO4L,GAC1DA,EAAEC,wBAA0BjF,GAAYgF,EAAEE,qBAAuBlF,IAC9D,GAEL,IAAIkG,EAAuC,KACvCC,GAAY,EAyBhB,GAvBIC,EAAmB/N,OAAS,GAE9B+N,EAAmBvB,QAAQG,IACzB,MAAMqB,EAAQzM,EAAwBqO,EAAQ3B,qBAAuB,GAAItB,EAAEU,UAAWV,EAAEuB,eACpFF,EAAQF,IACVA,EAAYE,EACZH,EAAY,CACVX,YAAaP,EAAEO,YACfE,QAAST,EAAES,QACXR,sBAAuBD,EAAEC,uBAAyB,GAClDC,mBAAoBF,EAAEE,mBACtBQ,UAAWV,EAAEU,UACba,cAAevB,EAAEuB,cACjBX,SAAUZ,EAAEY,SACZE,WAAYd,EAAEc,WACdE,OAAShB,EAAUgB,OACnB7F,YAAa6E,EAAE7E,iBAOlB+F,EAAW,CACMwF,GAAoB1L,GAC5B6E,QAAQmF,IAClB,MAAM3D,EAAQzM,EAAwBqO,EAAQ3B,qBAAuB,GAAI0D,EAAQtE,UAAWsE,EAAQzD,eAChGF,EAAQF,IACVA,EAAYE,EACZH,EAAY8D,IAGlB,CAOAzO,EAAetF,IACb,MAAMoW,EAAS,IAAIhR,IAAIpF,GAEvB,OADAoW,EAAOlH,IAAIqC,EAAWtB,GACfmG,GAEX,CAEA5Q,EAAiBxF,IACf,MAAMmZ,EAAS,IAAI1T,IAAIzF,GAEvB,OADAmZ,EAAOpB,OAAO,MAAMxG,KACb4H,KAILC,GAAwB7K,cAAaxE,IACzC,MAAMsH,EAAYe,GAAsBpI,KACtC+E,GAAKA,EAAEhF,WAAaA,GAAYgF,EAAE2D,mBAAqB3I,GAEzD,OAAOsH,GAAW0B,YAAc1B,GAAWhI,QAAQ,IAAIiG,aACtD,CAAC8C,KAEEiH,GAAqB9K,EAAAA,YAAYhT,MAAOgW,EAAmB+H,KAG/D,GAFAlR,GAAsBpI,QAAcA,EAAMuR,CAACA,GAAY+H,MAElDA,GAAeA,EAAY/O,OAAOnI,OAAS,EAC9CkG,GAAuBtI,IAAA,IAAcA,EAAMuR,CAACA,GAAY,UAD1D,CAKA/I,GAAuBxI,QAAcA,EAAMuR,CAACA,IAAY,KAExD,IACE,MAAM/V,KAAEA,QAAMkB,SAAgBtB,GAC3BU,KAAK,qBACLC,OAAO,qIAMPqb,GAAG,gCAAgCkC,gCAA0CA,MAC7Eb,MAAM,aAAc,CAAEC,WAAW,IACjCrB,MAAM,IAET,GAAI3a,EAAO,MAAMA,EAEjB,MAAM6c,GAAW/d,GAAQ,IAAI+N,IAAKiQ,IAAA,CAChC/K,GAAI+K,EAAI/K,GACR1E,SAAUyP,EAAIxK,uBAAyB,GACvCyK,SAAUD,EAAIvK,yBAAsB,EACpC2D,WAAY4G,EAAIlC,QAAQpN,eAE1B5B,GAAuBtI,QAAcA,EAAMuR,CAACA,GAAYgI,IAC1D,OAASzB,GACPxP,GAAuBtI,IAAA,IAAcA,EAAMuR,CAACA,GAAY,KAC1D,CAAA,QACE/I,GAAuBxI,QAAcA,EAAMuR,CAACA,IAAY,IAC1D,CA9BA,GA+BC,CAACnW,KAGEse,GAAyB,CAACnI,EAAmBoI,KACjDlR,GAA0BvL,QAAUqU,EACpCjM,EAAetF,IACb,MAAMoW,EAAS,IAAIhR,IAAIpF,GAEvB,OADAoW,EAAOlH,IAAIqC,EAAWoI,GACfvD,IAGT5Q,EAAiBxF,IACf,MAAMmZ,EAAS,IAAI1T,IAAIzF,GAEvB,OADAmZ,EAAOpB,OAAO,QAAQxG,KACf4H,KAIX7d,EAAAA,UAAU,KACR,IAAKmN,GAA0BvL,QAAS,OACxC,MAAMgZ,EAASzN,GAA0BvL,QACzBmI,EAAY6M,IAAIgE,IAC/B,CAAC7Q,IAEJ/J,EAAAA,UAAU,KACR,IAAKoJ,GAA2C,IAArBW,EAAY1I,KAAY,OAEnD,IAAIid,GAAY,EAChB,MAAMC,EAAU,IAAIzU,IAAIC,GAExBX,EAAmB2E,MAAMuF,QAASoD,IAChC,MAAM9U,EAAUmI,EAAY6M,IAAIF,EAAQvD,IACxC,IAAKvR,GAAwC,MAA7BA,EAAQua,kBAA2B,OAEnD,MAAMqC,EAAS3Q,GACXnE,EACCE,EAAcgN,IAAIF,EAAQvD,MAAQuD,EAAQvI,oBAAsBC,EAAqBsI,EAAQvI,qBAAuB,IACnHyN,EAAc4C,EAASrE,GAAoBqE,GAAU,GAC3D,GAA2B,IAAvB5C,EAAY9U,OAAc,OAE9B,MAAM2X,EAAW7C,EAAYlN,KAAMgQ,GAAQA,EAAIxK,UAAYtS,EAAQsS,SAC/DuK,GAA0C,MAA9BA,EAAStC,oBACvBoC,EAAQ3K,IAAI8C,EAAQvD,GAAI,IAAKvR,EAASua,kBAAmBsC,EAAStC,oBAClEmC,GAAY,KAIZA,GACFtU,EAAeuU,IAEhB,CAACnV,EAAoBW,EAAa8D,GAAgBnE,EAAkBE,EAAeuQ,KAGtF,MA6FMwE,GAAgBlK,GAChBA,QAAgD,IAC7CA,EAAOmK,eAAe,SAGzBC,GAAsB3Q,IAC1B,IAAKA,EAAM,MAAO,GAClB,MAAMtN,EAAOsN,EAAKiG,WAAWlF,OAC7B,GAAIrO,EAAM,OAAOA,EACjB,MAAMke,EAAO5Q,EAAK8G,eAAe/F,OACjC,OAAI6P,GACG,OAAO5Q,EAAKgG,WAsJf6K,GAAiB,CAAC1gB,EAAa2gB,KAGnC,GAFI3gB,EAAI6C,WAAW,SAEf8d,GAAiB,cAAR3gB,EAAqB,CAChC,MAAM4gB,EAAQD,EAAME,cAA8BtP,wBAClDvF,EAAoB,CAClBC,IAAK2U,EAAKE,OAAS,EACnB5U,KAAM0U,EAAK1U,MAEf,CAEAL,EAAiBxF,IACf,MAAMmZ,EAAS,IAAI1T,IAAIzF,GAOvB,OANImZ,EAAO5I,IAAI5W,GACbwf,EAAOpB,OAAOpe,IAEdwf,EAAOuB,QACPvB,EAAOnD,IAAIrc,IAENwf,KAIX,OAAK/U,EAGH3G,EAAAA,KAAAsB,WAAA,CACEvB,SAAA,CAAAJ,EAAAA,IAACC,EAAA,CAAOC,KAAMhD,EAAQiD,aAAchD,EAClCiD,SAAAC,EAAAA,KAACC,EAAA,CACCC,UAAU,kGACVgd,iBAAiB,EACjBC,kBAAoBze,IAEdoJ,EAAc5I,KAAO,GACvBR,EAAE6B,kBAINR,SAAA,CAAAJ,EAAAA,IAACQ,GAAaD,UAAU,qCACtBH,SAAAC,EAAAA,KAACI,EAAA,CAAYF,UAAU,oCACrBH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,sCACbH,SAAA,GAAAJ,IAACyd,EAAA,CAAYld,UAAU,2BAA2B,mBAGpDF,EAAAA,KAACyB,EAAA,CACCC,QAAQ,UACRxC,KAAK,KACL2B,QAlMkB,KAC9B,MAAMmB,EAAWiF,GAAoBoW,WAAa1W,EAAU0W,UAC5D,IAAKrb,EAAU,OAEf,MAEMoG,EAAO5F,KAAKC,IAAI,EAAGS,OAAOoa,SAAWpa,OAAOqa,WAFpC,KAE0D,GAClEpV,EAAM3F,KAAKC,IAAI,EAAGS,OAAOsa,SAAWta,OAAOua,YAFlC,KAE0D,GACzEva,OAAOrD,KAAKmC,EAAU,8BAA+B,8BAAwCoG,SAAYD,MA2L7FjI,UAAU,8BAEVH,SAAA,GAAAJ,IAAC4B,EAAA,CAAUrB,UAAU,qBAAqB,gBAM/C2G,EACC7G,EAAAA,KAAC,MAAA,CAAIE,UAAU,yCACbH,SAAA,GAAAJ,IAACsC,EAAA,CAAQ/B,UAAU,wCACnBP,EAAAA,IAAC,OAAA,CAAKO,UAAU,sBAAsBH,SAAA,eAEtCkH,EACFjH,EAAAA,KAAC,MAAA,CAAIE,UAAU,iDAEbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,mEACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,WACbH,SAAA,CAAAJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,cAAcH,SAAA,UAC3BC,KAAC,MAAA,CAAIE,UAAU,WACbH,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLY,MAAOqJ,GACP9H,SAAWvC,IACTsK,GAAoBtK,EAAEwC,OAAOxB,OA13BxB5B,OAAO+d,IAChC,IAAKA,EAAY/O,OAGf,OAFA5D,GAAuB,SACvBI,IAAsB,GAIxBF,IAAuB,GACvBE,IAAsB,GAEtB,IACE,MAAQvL,KAAM2f,EAAAze,MAASA,SAAgBtB,GACpCU,KAAK,WACLC,OAAO,mBACPqf,MAAM,cAAe,IAAI9B,MACzBjC,MAAM,IAET,GAAI3a,EAAO,MAAMA,EAEjBiK,IAAwBwU,GAAW,IAAI5R,IAAK+N,IAAA,CAC1C7I,GAAI6I,EAAO7I,GACXvS,KAAMob,EAAOpN,eAEjB,OAAS4N,GAEPnR,GAAuB,GACzB,CAAA,QACEE,IAAuB,EACzB,GA+1BoBwU,CAAmBlf,EAAEwC,OAAOxB,QAE9Bme,QAAS,KACH5U,GAAoBtE,OAAS,GAAG2E,IAAsB,IAE5DwU,OAAQ,KAENC,WAAW,IAAMzU,IAAsB,GAAQ,MAEjD0U,YAAY,YACZ9d,UAAW,8GACTqJ,GAAqB,kCAAoC,iCAE3DrF,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,OAExC/U,IACCxJ,EAAAA,IAACsC,EAAA,CAAQ/B,UAAU,iFAGpBmJ,IAAsBJ,GAAoBtE,OAAS,KAClDhF,IAAC,MAAA,CAAIO,UAAU,kIACZH,SAAAkJ,GAAoB6C,IAAK+N,GACxBla,EAAAA,IAAC,SAAA,CAECwe,YAAczf,GAAMA,EAAE6B,iBACtBM,QAAS,KACPmI,GAAoB6Q,EAAOpb,MAC3B6K,IAAsB,GACtBoD,GAAmBmN,EAAOpb,OAE5ByB,UAAU,yFAEVH,SAAAJ,EAAAA,IAAC,MAAA,CAAIO,UAAU,wCAAyCH,WAAOtB,QAT1Dob,EAAO7I,oBAgBvB,MAAA,CACCjR,SAAA,CAAAJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,cAAcH,SAAA,QAC3BJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLY,MAAOyL,GACPlK,SAAWvC,GAAM0M,GAAsB1M,EAAEwC,OAAOxB,OAChDQ,UAAU,gJACVgE,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,iBAG1C,MAAA,CACCne,SAAA,CAAAJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,cAAcH,SAAA,WAC3BC,KAAC,IAAA,CAAEE,UAAU,oBACVH,SAAA,CAAAyc,GAAavV,EAAmBmX,aAAa,iBAGjD,MAAA,CACCre,SAAA,CAAAJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,cAAcH,SAAA,WAC3BC,KAAC,IAAA,CAAEE,UAAU,cAAeH,SAAA,CAAAkH,EAAmB2E,MAAMjH,OAAO,aAKhEhF,EAAAA,IAAC,MAAA,CAAIO,UAAU,+EAA+Ea,IAAKkK,GACjGlL,SAAAC,EAAAA,KAAC,QAAA,CACCE,UAAU,oCACVa,IAAKmK,GACLhH,MAAO,CAAEma,eAAgB,WAAY5N,cAAe,GAEpD1Q,SAAA,GAAAC,KAAC,QAAA,CAAME,UAAU,gCACfH,SAAA,GAAAC,KAAC,KAAA,CAAGE,UAAU,2BAEZH,SAAA,GAAAJ,IAAC,KAAA,CAAG2e,QAAS5S,GAAiB,EAAI,EAAGxL,UAAU,mDAC7CH,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,oCACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,oCAAoCH,SAAA,aACnD2L,IAAkBiJ,GAAsBhQ,OAAS,GAChD3E,EAAAA,KAAC,MAAA,CAAIE,UAAU,mCACbH,SAAA,CAAAC,EAAAA,KAAC,SAAA,CACCa,QAAUnC,GAAMke,GAAe,YAAale,GAC5CwB,UAAU,8IAERH,SAAA,CAAA,MACA,IAAKwH,EAAkB,MAAO,UAC9B,MAAMqM,EAAYe,GAAsBpI,KAAK+E,GAAKA,EAAEhF,WAAa/E,GAAoB+J,EAAE2D,mBAAqB1N,GAC5G,GAAIqM,GAAWtH,UAAYsH,GAAWqB,iBACpC,OAAOjV,EAAAA,KAAAsB,WAAA,CAAGvB,SAAA,CAAA6T,EAAUtH,SAAS,MAACtM,KAAC,OAAA,CAAKE,UAAU,gBAAgBH,SAAA,CAAA,IAAE6T,EAAUqB,iBAAiB,UAG7F,MAAM6E,EAAevC,GAAqBhQ,GAC1C,OAAIuS,EACK9Z,EAAAA,KAAAsB,WAAA,CAAGvB,SAAA,CAAAwH,EAAiB,MAACvH,KAAC,OAAA,CAAKE,UAAU,gBAAgBH,SAAA,CAAA,IAAE+Z,EAAa,UAEtEvS,CACT,EAZE,KAaF5H,IAAC4e,EAAA,CAAYre,UAAU,eAGxBmM,IAAkB9E,GAAoB8E,KAAmB9E,KACxD5H,IAAC,QAAKO,UAAU,6BAA6Bse,MAAM,0BAA0Bze,SAAA,OAK/EJ,MAAC,MAAA,CAAIO,UAAU,6BACZH,YACCC,EAAAA,KAAAsB,WAAA,CACEvB,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLY,MAAOqK,GACP9I,SAAWvC,IACTsL,GAAiBtL,EAAEwC,OAAOxB,OAx8BzC5B,OAAO+d,IAC5B,IAAKA,EAAY/O,OAGf,OAFA5C,GAAmB,SACnBI,IAAkB,GAIpBF,IAAmB,GACnBE,IAAkB,GAElB,IACE,MAAMoN,EAAazL,EAAqB4P,EAAY/O,SAE5C/O,KAAMgd,EAAA9b,MAAWA,SAAgBtB,GACtCU,KAAK,qBACLC,OAAO,qIAMPqb,GAAG,gCAAgCjC,gCAAyCA,MAC5EsD,MAAM,aAAc,CAAEC,WAAW,IACjCrB,MAAM,IAET,GAAI3a,EAAO,MAAMA,EAEjBiL,IAAoB6Q,GAAa,IAAIjP,IAAK0P,IAAA,CACxCxK,GAAIwK,EAAExK,GACN1E,SAAUkP,EAAEjK,uBAAyB,GACrCyK,SAAUR,EAAEhK,mBACZ2D,WAAYqG,EAAE3B,QAAQpN,eAE1B,OAAS4N,GAEPnQ,GAAmB,GACrB,CAAA,QACEE,IAAmB,EACrB,GAm6BoCqU,CAAe/f,EAAEwC,OAAOxB,QAE1Boe,OAAQ,KACFrT,GAAsBhL,QACxBgL,GAAsBhL,SAAU,EAGlCse,WAAW,KACTjU,IAAqB,GACrBQ,IAAkB,IACjB,MAEL0T,YAAY,gBACZ9d,UAAU,oHACVgE,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KACvCQ,WAAS,EACT7d,QAAUnC,GAAMA,EAAE8B,oBAEnB2J,IACCxK,EAAAA,IAACsC,EAAA,CAAQ/B,UAAU,wDAGpBmK,IAAkBJ,GAAgBtF,OAAS,KAC1ChF,IAAC,MAAA,CAAIO,UAAU,kIACZH,SAAAkK,GAAgB6B,IAAKM,GACpBpM,EAAAA,KAAC,MAAA,CAECE,UAAU,+EAEVH,SAAA,CAAAJ,EAAAA,IAAC,SAAA,CACCwe,YAAczf,GAAMA,EAAE6B,iBACtBM,QAAUnC,IACRA,EAAE8B,kBACFiK,GAAsBhL,SAAU,EAEhC,MAAMkf,EAAc5U,GAAc+C,OAAOgI,cACzC,IAAI8J,EAEFA,EADED,EAAY5f,WAAW,OAASqN,EAAG4P,SACpB5P,EAAG4P,SACX2C,EAAY5f,WAAW,MAAQqN,EAAGE,SAC1BF,EAAGE,SAEHF,EAAGE,UAAYF,EAAG4P,UAAY,GAEjDhS,GAAiB,IACjBF,IAAqB,GACrBQ,IAAkB,GAElBE,IAAsB,GAEtB2O,GAAqByF,EAAgBxS,EAAG+I,WAAY/I,EAAG4P,UACvDhd,EAAM8C,QAAQ,GAAG8c,kBAEnB1e,UAAU,mBAEVH,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,0CACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,wCACZH,SAAA,CAAAqM,EAAGE,SACHF,EAAG4P,UAAYhc,OAAC,OAAA,CAAKE,UAAU,qBAAqBH,SAAA,CAAA,IAAEqM,EAAG4P,SAAS,UAErErc,EAAAA,IAAC,SAAA,CACCb,KAAK,SACLqf,YAAczf,IACZ+L,GAAsBhL,SAAU,EAChCf,EAAE6B,kBAEJM,QAAUnC,IACRA,EAAE8B,kBACFgI,EAA+B4D,EAAG4E,IAClC1I,GAA6B,IAE/BpI,UAAU,2DACXH,SAAA,YAKJqM,EAAG+I,YACFxV,EAAAA,IAAC,OAAIO,UAAU,2BAA4BH,WAAGoV,eApD3C/I,EAAG4E,UA4DlBrR,EAAAA,IAAC,SAAA,CACCkB,QAAUnC,IACRA,EAAE8B,kBACFsJ,IAAqB,IAEvB5J,UAAU,+HACVse,MAAM,gBAENze,SAAAJ,EAAAA,IAACkf,EAAA,CAAO3e,UAAU,gBAKvBqH,SACC,MAAMuX,EAAoBnK,GAAsBpI,KAC9C+E,GAAKA,EAAEhF,WAAa/E,GAAoB+J,EAAE2D,mBAAqB1N,GAE3D+N,EAAawJ,GAAmBxJ,YAAcwJ,GAAmBlT,MAAM,IAAIiG,YACjF,OAAKyD,EAEH3V,EAAAA,IAAC,SAAA,CACCkB,QAAUnC,IACRA,EAAE8B,kBACFgI,EAA+B8M,GAC/BhN,GAA6B,IAE/BpI,UAAU,8HACVse,MAAM,WAENze,SAAAJ,EAAAA,IAACvD,EAAA,CAAa8D,UAAU,cAXJ,IAc1B,eAQRP,IAAC,KAAA,CAAGO,UAAU,uEAIdP,IAAC,KAAA,CAAG2e,QAAS5S,GAAiB,EAAI,EAAGxL,UAAU,wBAC7CH,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,0BACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,oCAAoCH,SAAA,cAGnD2L,IAAkBW,IACjBrM,OAAC,MAAA,CAAIE,UAAU,0BACbH,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLY,YAEE,MAAMqf,EAAY9X,GAAoB2E,MAAM,GAC5C,OAAImT,EACK9I,GAAgB8I,EAAW,aAE7B1S,EACT,KACApL,SAAWvC,GAAM6b,GAAwB7b,EAAEwC,OAAOxB,OAClDQ,UAAU,uJACVgE,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KACvCM,MAAM,wBAAA,MAIN,MAAMO,EAAY9X,GAAoB2E,MAAM,GACtCoT,EAAeD,EAAa9I,GAAgB8I,EAAW,aAA0B1S,GACjFyN,EAAerC,GAAkCuH,GACvD,OAAIlF,EACKna,MAAC,QAAKO,UAAU,wCAAwCgE,MAAO,CAAE+Z,SAAU,QAAWle,SAAA+Z,IAExF,IACT,EAXQ,MAcXpO,KAAmBW,IAClBrM,EAAAA,KAAC,MAAA,CAAIE,UAAU,0BACbH,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLkf,YAAY,aACZ/c,SAAWvC,GAAM6b,GAAwB7b,EAAEwC,OAAOxB,OAClDQ,UAAU,uJACVgE,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KACvCM,MAAM,eAAA,MAGN,MAAMO,EAAY9X,GAAoB2E,MAAM,GACtCoT,EAAeD,EAChB9I,GAAgB8I,EAAW,aAC5B,GACEjF,EAAerC,GAAkCuH,GACvD,OAAKlF,EAEHna,MAAC,QAAKO,UAAU,wCAAwCgE,MAAO,CAAE+Z,SAAU,QACxEle,SAAA+Z,IAHqB,IAM5B,EAdQ,gBAoBlB9Z,KAAC,KAAA,CAAGE,UAAU,cAEXH,SAAA,EAAC2L,IACA/L,EAAAA,IAAC,KAAA,CAAGO,UAAU,8CAA8CH,SAAA,YAE9DJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,4BAA4BH,SAAA,QAC1CJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,6BAA6BH,SAAA,OAC3CJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,6BAA6BH,SAAA,OAC3CJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,wDAAwDH,SAAA,SAGtEJ,IAAC,MAAGO,UAAU,2DACZH,eAAC,OAAA,CAAKG,UAAU,wBAAwBH,SAAA,QAI1CJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,8CAA8CH,SAAA,QAC5DJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,oDAAoDH,SAAA,OAClEJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,oDAAoDH,SAAA,OAClEJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,oDAAoDH,SAAA,QAChE2L,IACA/L,EAAAA,IAAC,KAAA,CAAGO,UAAU,8CAA8CH,SAAA,oBAIlEC,KAAC,QAAA,CAAME,UAAU,WACdH,SAAA,CAAAkH,EAAmB2E,MAAME,IAAI,CAACyI,EAAS0K,KACtC,MAeMC,EAAgBtX,EAAY6M,IAAIF,EAAQvD,IA36C3C,CAACuD,IAKtB,IAAI4K,EAHYvX,EAAY6M,IAAIF,EAAQvD,KAGmB,KAG3D,IAAKmO,EAAgB,CACnB,MAAM7S,EAAWZ,GACbnE,EACCE,EAAcgN,IAAIF,EAAQvD,MAAQuD,EAAQvI,oBAAsBC,EAAqBsI,EAAQvI,qBAAuB,IAEzH,GAAIM,EAAU,CACZ,MAAMmN,EAAczB,GAAoB1L,GACvBmN,EAAY9U,OAG7B,IAAI8N,EAAY,EAChBgH,EAAYtI,QAAQmF,IAClB,MAAM3D,EAAQzM,EAAwBqO,EAAQ3B,qBAAuB,GAAI0D,EAAQtE,UAAWsE,EAAQzD,eAChGF,EAAQF,IACVA,EAAYE,EACZwM,EAAiB7I,IAGvB,CACF,CAEA,IAAK6I,EAAgB,MAAO,YAE5B,MAAMpa,EAAamB,EAAwBqO,EAAQ3B,qBAAuB,GAAIuM,EAAenN,WAAa,GAAImN,EAAetM,gBA64CvFuM,CAAe7K,GAEnC,MAAM8K,EAAwB9K,EAAQvI,oBAClCC,EAAqBsI,EAAQvI,0BAC7B,EACEsT,EAAehH,GAAuB/D,EAAQvD,IAC9CuO,EAAuBD,EAAaxT,IAAI8H,GAAa3H,EAAqB2H,IAC1E4L,EAAe,IAAIxX,IAAIuX,GACvBE,EAAahY,EAAcgN,IAAIF,EAAQvD,IACvC0O,EAAuBD,EAAaxT,EAAqBwT,GAAc,GACvEE,EAAgBN,GAAyBG,EAAa1M,IAAIuM,GAC5DA,EACA,GACEhD,EAASqD,GAAwBF,EAAa1M,IAAI4M,GACpDA,EACAC,EACAV,EAAW,GAEblc,MAAM,oEAAoE,CAAC+K,OAAO,OAAOC,QAAQ,CAAC,eAAe,oBAAoBlK,KAAKmK,KAAKC,UAAU,CAACC,SAAS,4CAA4CC,QAAQ,kBAAkBpQ,KAAK,CAACkhB,WAASnL,UAAUS,EAAQvD,GAAGqO,wBAAsBI,aAAWC,uBAAqBrD,SAAOuD,eAAeN,EAAa3a,QAAQkK,UAAUnL,KAAKoL,MAAMC,UAAU,gBAAgBC,MAAM,OAAOC,aAAa,SAASC,MAAM,QAGxc,MAAM2Q,EAAa9I,MAAM1Y,KAAK,IAAI2J,IAAIsX,IAChCQ,EAAW7Y,EAAmB2E,MAAMqT,EAAW,GAC/Cc,EAAaD,EAvCS,CAAC/T,IAC3B,MAAMiU,EAAsBjU,EAAKC,oBAC7BC,EAAqBF,EAAKC,0BAC1B,EACEgJ,EAAasD,GAAuBvM,EAAKiF,IACzCwO,EAAe,IAAIxX,IAAIgN,EAAWlJ,IAAI8H,GAAa3H,EAAqB2H,KACxEqM,EAAWxY,EAAcgN,IAAI1I,EAAKiF,IAClCkP,EAAqBD,EAAWhU,EAAqBgU,GAAY,GACjEN,EAAgBK,GAAuBR,EAAa1M,IAAIkN,GAC1DA,EACA,GACJ,OAAOE,GAAsBV,EAAa1M,IAAIoN,GAC1CA,EACAP,GA0BwBQ,CAAoBL,GAAY,GACxDM,EAAanB,EAAWhY,EAAmB2E,MAAMjH,OAAS,GAAK0X,IAAW0D,EAC1EM,EAAeD,EACjB,8CACA,mBACAnB,GAAY,GAEdlc,MAAM,oEAAoE,CAAC+K,OAAO,OAAOC,QAAQ,CAAC,eAAe,oBAAoBlK,KAAKmK,KAAKC,UAAU,CAACC,SAAS,iDAAiDC,QAAQ,kBAAkBpQ,KAAK,CAACkhB,WAASmB,aAAWC,eAAahE,SAAO0D,cAAYlR,UAAUnL,KAAKoL,MAAMC,UAAU,gBAAgBC,MAAM,OAAOC,aAAa,SAASC,MAAM,QAGlY,MAAMoR,EAAkB5V,GAAmB6J,EAAQvD,KAAO,GACpDuP,EAAoB3V,GAAoB2J,EAAQvD,KAAO,GACvDwP,EAAoB1V,GAAoByJ,EAAQvD,MAAO,EACvDyP,EAAiB/U,GAAiBnE,EAAoB8U,GAAU,GAChEqE,EAAmB1I,GAAoByI,GACvCE,EAAiD,IAA5BD,EAAiB/b,QAAgB8b,GACvDlM,EAAQlD,kBAAoB,IAC5B3L,OAAOkO,GACNA,EAAUrC,wBAA0BkP,GACpC7M,EAAUpC,qBAAuBiP,GAElC3U,IAAK8H,IAAA,CACJ/B,YAAa+B,EAAU/B,YACvBE,QAAS6B,EAAU7B,QACnBR,sBAAuBqC,EAAUrC,uBAAyB,GAC1DC,mBAAoBoC,EAAUpC,mBAC9BQ,UAAW4B,EAAU5B,WAAa,SAClCa,cAAee,EAAUf,cACzBX,SAAU0B,EAAU1B,SACpBE,WAAYwB,EAAUxB,WACtBE,OAASsB,EAAkBtB,OAC3B7F,YAAamH,EAAUnH,eAEzB,GACEmU,EAA0BF,EAAiB/b,OAAS,EAAI+b,EAAmBC,EAC3EE,EAAyBD,EAC5B9U,IAAK8H,IAAA,CACJA,YACAjB,MAAOzM,EAAwBqO,EAAQ3B,qBAAuB,GAAIgB,EAAU5B,UAAW4B,EAAUf,kBAElGoE,KAAK,CAAC5T,EAAG6T,IAAMA,EAAEvE,MAAQtP,EAAEsP,OAC9B,GAAiB,IAAbsM,EAAgB,CAClB,MAAM6B,EAAS,GAAGvM,EAAQvD,MAAMtF,GAAiB,OAAS,WAAW+U,KAAkBC,EAAiB/b,SACpGiF,GAAyBnK,UAAYqhB,IACvClX,GAAyBnK,QAAUqhB,EACZJ,EAAiB,GAI5C,CAGA,MAAMK,EAA6BxZ,EAC/B0E,EAAqB1E,GACrB,GACEyZ,EAAoBzZ,EACtBgQ,GAAqBhQ,QACrB,EACE0Z,EAA8BD,EAChC/U,EAAqB+U,GACrB,GACEzF,EAAiBtU,EAAmB2E,MAAMjH,OAC1Cuc,EAAwBja,EAAmB2E,MAC9CE,IAAIC,GAAQkK,GAAgBlK,EAAM,cAClCrG,OAAOwG,SACPJ,IAAIpM,GAASuM,EAAqBvM,IAC/BsW,IACF+K,GACFG,EAAsBpb,KACpBpG,GACEA,IAAUqhB,GACTE,GAA+BvhB,IAAUuhB,GAE1CE,EAA0B,IAAblC,EAEnB,SACEjf,KAAC,KAAA,CAAoBE,UAAWmgB,EAE7BtgB,SAAA,EAAC2L,UACC,KAAA,CAAGxL,UAAU,wBACZH,WAAAC,KAAC,MAAA,CAAIE,UAAU,WACbH,SAAA,CAAAC,EAAAA,KAAC,SAAA,CACCa,QAAS,IAAM+b,GAAe,MAAMrI,EAAQvD,MAC5C9Q,UAAU,qKACVgE,MAAO,CAAE+Z,SAAU,QAEnBle,SAAA,GAAAJ,IAAC,OAAA,CAAMI,YAAU,SACjBJ,IAAC4e,EAAA,CAAYre,UAAU,6BAExB4H,EAAcgL,IAAI,MAAMyB,EAAQvD,OAC/BhR,EAAAA,KAAC,MAAA,CAAIE,UAAU,gIACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAIO,UAAU,+BACbH,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,WACbH,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLY,MAAO4gB,EACPrf,SAAWvC,GAAMkd,GAAmBrH,EAAQvD,GAAItS,EAAEwC,OAAOxB,OACzDse,YAAY,gBACZ9d,UAAU,kIAEXsgB,GACC7gB,EAAAA,IAACsC,EAAA,CAAQ/B,UAAU,sFAIxBogB,GAAmBC,EAAkB5b,OAAS,KAC7ChF,IAAC,MAAA,CAAIO,UAAU,2BACZH,SAAAwgB,EAAkBzU,IAAKM,IACtB,MAAMuS,EAAc2B,EAAgBxT,OAAOgI,cAC3C,IAAI8J,EAQJ,OANEA,EADED,EAAY5f,WAAW,OAASqN,EAAG4P,SACpB5P,EAAG4P,SACX2C,EAAY5f,WAAW,MAAQqN,EAAGE,SAC1BF,EAAGE,SAEHF,EAAGE,UAAYF,EAAG4P,UAAY,GAG/Chc,EAAAA,KAAC,MAAA,CAECE,UAAU,0DACVW,QAAS,IAAM4a,GAAmBlH,EAAQvD,GAAI4N,GAE9C7e,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,0CACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,4BACZH,SAAA,CAAAqM,EAAGE,SACHF,EAAG4P,UAAYhc,OAAC,OAAA,CAAKE,UAAU,qBAAqBH,SAAA,CAAA,IAAEqM,EAAG4P,SAAS,UAErErc,EAAAA,IAAC,SAAA,CACCb,KAAK,SACLqf,YAAczf,GAAMA,EAAE6B,iBACtBM,QAAUnC,IACRA,EAAE8B,kBACFgI,EAA+B4D,EAAG4E,IAClC1I,GAA6B,IAE/BpI,UAAU,2DACXH,SAAA,UAIFqM,EAAG+I,YACFxV,EAAAA,IAAC,OAAIO,UAAU,2BAA4BH,WAAGoV,eAvB3C/I,EAAG4E,QA8BjB6O,EAAWlb,OAAS,GACnBhF,EAAAA,IAAC,OACEI,SAAA8f,EAAW/T,IAAI,CAACM,EAAIgV,KACnB,MAAMC,EAAS9J,GAAqBnL,GAC9BkJ,EAAaqG,GAAsBvP,GACnCkV,EAAclV,IAAOiQ,EAC3B,OACE1c,EAAAA,IAAC,MAAA,CAECkB,QAAS,IAAM4a,GAAmBlH,EAAQvD,GAAI5E,GAC9ClM,UAAW,yEAAwEohB,EAAc,0CAA4C,iBAC7Ipd,MAAO,CAAE+Z,SAAU,QAEnBle,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,0CACbH,SAAA,CAAAC,OAAC,MAAA,CACED,SAAA,CAAAqM,EACAiV,GAAUrhB,EAAAA,KAAC,OAAA,CAAKE,UAAU,qBAAqBH,SAAA,CAAA,IAAEshB,EAAO,OACxDC,KAAe3hB,IAAC,OAAA,CAAKO,UAAU,uBAAuBH,SAAA,UAExDuV,GACC3V,EAAAA,IAAC,SAAA,CACCb,KAAK,SACLqf,YAAczf,GAAMA,EAAE6B,iBACtBM,QAAUnC,IACRA,EAAE8B,kBACFgI,EAA+B8M,GAC/BhN,GAA6B,IAE/BpI,UAAU,2DACXH,SAAA,WArBA,GAAGqM,KAAMgV,mBAsClCzhB,IAAC,KAAA,CAAGO,UAAU,MACXH,SAAA6gB,EAAwBjc,OAAS,IAChC3E,KAAC,MAAA,CAAIE,UAAU,WACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,0BACbH,SAAA,CAAAC,EAAAA,KAAC,SAAA,CACCa,QAAS,KACP+b,GAAe,QAAQrI,EAAQvD,OAEjC9Q,UAAU,qKACVgE,MAAO,CAAE+Z,SAAU,QAEnBle,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAMI,SAAA2c,GAAmBwC,IAAkB,SAC5Cvf,IAAC4e,EAAA,CAAYre,UAAU,6BAExBgf,GACCvf,EAAAA,IAAC,SAAA,CACCkB,QAAS,IAAMob,GAAuB1H,EAAQvD,GAAI,MAClD9Q,UAAU,iDACVse,MAAM,QAENze,SAAAJ,EAAAA,IAAC4hB,EAAA,CAAQrhB,UAAU,iBAIxB4H,EAAcgL,IAAI,QAAQyB,EAAQvD,SACjCrR,IAAC,MAAA,CAAIO,UAAU,gIACZH,WAAuB+L,IAAI,EAAG8H,YAAWjB,SAAS6O,IAE/CxhB,EAAAA,KAAC,MAAA,CAECa,QAAS,KACPob,GAAuB1H,EAAQvD,GAAI4C,IAErC1T,UAAU,+CAEVH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,oCACbH,SAAA,CAAAJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,wCAAwCgE,MAAO,CAAE+Z,SAAU,QAAWle,SAAA2c,GAAmB9I,KACtG5T,EAAAA,KAAC,OAAA,CAAKE,UAAW,sCACfyS,GAAS,GAAK,8BACdA,GAAS,GAAK,gCACd,6BAEC5S,SAAA,CAAAyC,KAAKG,MAAMgQ,GAAO,YAGvB3S,KAAC,IAAA,CAAEE,UAAU,4BAA4BH,SAAA,CAAA,UAC/B6T,EAAU1B,UAAY,IAAI,MAAI0B,EAAUoG,mBAAqB,SAjBlEwH,WA0BjB7hB,IAAC,OAAA,CAAKO,UAAU,4BAA4BgE,MAAO,CAAE+Z,SAAU,QAAUle,SAAA,cAG7EJ,IAAC,KAAA,CAAGO,UAAU,iBACZH,SAAAC,EAAAA,KAAC,OAAA,CAAKE,UAAU,4BAA4BgE,MAAO,CAAE+Z,SAAU,QAC5Dle,SAAA,CAAAmf,GAAehN,UAAY,IAAI,MAAIgN,GAAelF,mBAAqB,eAG3E,KAAA,CAAG9Z,UAAU,iBACZH,SAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,4BAA4BgE,MAAO,CAAE+Z,SAAU,QAAWle,SAAAmf,EAAgB1C,GAAa0C,EAAc9M,YAAc,QAErIzS,EAAAA,IAAC,MAAGO,UAAU,4CACZH,eAAC,OAAA,CAAKG,UAAU,sCAAsCgE,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KAAQne,SAAAmf,EAAgB1C,GAAa0C,EAAc5M,QAAU,QAI3J6O,GACCxhB,EAAAA,IAAC,KAAA,CACCO,UAAU,uHACVuhB,QAASlG,EACTrX,MAAO,CAAEwd,cAAe,UACxB7gB,QAAS,IAAMiI,IAA+B,GAC9C0V,MAAM,gBAENze,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,4CACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAW,0BACf8V,EAAsB,iBAAmB,iBAExCjW,SAAAiW,EAAsB,cAAgB,iBAEzCrW,EAAAA,IAAC,OAAA,CAAKO,UAAU,4CAA4CH,SAAA,gBAQlEJ,IAAC,KAAA,CAAGO,UAAU,wBACZH,SAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLY,MAAOuW,GAAgB1B,EAAS,aAChCtT,SAAWvC,GAAM8Z,GAAkBjE,EAAQvD,GAAI,YAAatS,EAAEwC,OAAOxB,OACrEQ,UAAW,qJACT8Y,GAAgBzE,EAAS,aACrB,iCACA,4BAENrQ,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,IAAKvP,MAAO,GAAGnM,KAAKC,IAAI,IAAgE,EAA1DwT,GAAgB1B,EAAS,aAAwB5P,aACtH6Z,MAAOxF,GAAgBzE,EAAS,aAAe,OAAOA,EAAQ3B,2BAAwB,QAG1FjT,IAAC,KAAA,CAAGO,UAAU,sBACZH,SAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,SACLY,MAAOuW,GAAgB1B,EAAS,YAChCtT,SAAWvC,GAAM8Z,GAAkBjE,EAAQvD,GAAI,WAAYtS,EAAEwC,OAAOxB,MAAQuN,OAAOvO,EAAEwC,OAAOxB,OAAS,GACrGQ,UAAW,gJACT8Y,GAAgBzE,EAAS,YACrB,iCACA,4BAENrQ,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KACvCM,MAAOxF,GAAgBzE,EAAS,YAAc,OAAOA,EAAQsE,0BAAuB,QAGxFlZ,IAAC,KAAA,CAAGO,UAAU,sBACZH,SAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,SACLY,MAAOuW,GAAgB1B,EAAS,cAChCtT,SAAWvC,GAAM8Z,GAAkBjE,EAAQvD,GAAI,aAActS,EAAEwC,OAAOxB,MAAQuN,OAAOvO,EAAEwC,OAAOxB,OAAS,GACvGQ,UAAW,gJACT8Y,GAAgBzE,EAAS,cACrB,iCACA,4BAENrQ,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KACvCM,MAAOxF,GAAgBzE,EAAS,cAAgB,OAAOA,EAAQuE,4BAAyB,QAG5FnZ,IAAC,KAAA,CAAGO,UAAU,sBACZH,SAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,SACLY,MAAOuW,GAAgB1B,EAAS,UAChCtT,SAAWvC,GAAM8Z,GAAkBjE,EAAQvD,GAAI,SAAUtS,EAAEwC,OAAOxB,MAAQuN,OAAOvO,EAAEwC,OAAOxB,OAAS,GACnGQ,UAAW,8IACT8Y,GAAgBzE,EAAS,UACrB,iCACA,4BAENrQ,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KACvCM,MAAOxF,GAAgBzE,EAAS,UAAY,OAAOA,EAAQwE,wBAAqB,OAKlFrN,IACA/L,EAAAA,IAAC,KAAA,CAAGO,UAAU,wBACZH,WAAAC,KAAC,MAAA,CAAIE,UAAU,0BACbH,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CACCb,KAAK,OACLY,MAAOuW,GAAgB1B,EAAS,aAChCtT,SAAWvC,IACT,MAAM8b,EAAW9b,EAAEwC,OAAOxB,MAC1Bya,GAAwBK,GACxBhC,GAAkBjE,EAAQvD,GAAI,YAAawJ,IAE7Cta,UAAW,yIACT8Y,GAAgBzE,EAAS,aACrB,iCACA,mBAENrQ,MAAO,CAAE+Z,SAAU,OAAQC,WAAY,KACvCM,MAAOxF,GAAgBzE,EAAS,aAAe,OAAOA,EAAQvI,2BAAwB,IAAA,MAGtF,MAAMgT,EAAe/I,GAAgB1B,EAAS,aACxCuF,EAAerC,GAAkCuH,GACvD,OAAKlF,EAEHna,MAAC,QAAKO,UAAU,wCAAwCgE,MAAO,CAAE+Z,SAAU,QACxEle,SAAA+Z,IAHqB,IAM5B,EAXwF,UA/RvFvF,EAAQvD,QAmTrBhR,KAAC,KAAA,CAAGE,UAAU,kDACZH,SAAA,CAAAJ,EAAAA,IAAC,MAAG2e,QAAS5S,GAAiB,EAAI,EAAGxL,UAAU,+BAA+BH,SAAA,aAG9EJ,IAAC,KAAA,CAAGO,UAAU,0DACXH,SAAAyc,GACCzF,MAAM1Y,KAAKuJ,EAAYoP,UACpBtR,OAAOwG,SACP8G,OAAO,CAAC2O,EAAK5V,IAAS4V,GAAO5V,GAAMuG,QAAU,GAAI,QAGxD3S,IAAC,KAAA,CAAGO,UAAU,wDACb,KAAA,CAAGoe,QAAS5S,GAAiB,EAAI,EAAGxL,UAAU,+BAA+BH,SAAA,CAAA,SAE3E0I,EAAevJ,KAAO,SACpB,OAAA,CAAKgB,UAAU,kCAAkCH,SAAA,eAGtDJ,IAAC,KAAA,CAAGO,UAAU,+BACXH,SAAAyc,GACCvV,EAAmB2E,MAAMoH,OAAO,CAAC2O,EAAK5V,KACpC,MAAM6M,EAASnQ,EAAegM,IAAI1I,EAAKiF,IAEvC,OAAO2Q,QAD2B,IAAnB/I,GAAQtG,OAAuBsG,EAAOtG,OAAUvG,EAAKgN,kBAAoB,IAEvF,OAGLrN,IAAkB/L,EAAAA,IAAC,KAAA,CAAGO,UAAU,sBAO5CP,EAAAA,IAAC,MAAA,CAAIO,UAAU,oBACbH,eAAC,IAAA,CAAEG,UAAU,iBAAiBH,SAAA,yBAIlCC,KAACwB,EAAA,CAAatB,UAAU,2CACtBH,SAAA,CAAAC,EAAAA,KAACyB,EAAA,CACCC,QAAQ,UACRb,QAxhCS/C,UACnB,GAAK8jB,QAAQ,sBAEb,IACE5a,GAAU,GAEV,MAAM1H,QAAesC,EAA4BigB,gBAAgBlb,EAAUqK,IAEvE1R,EAAOwC,SACT9C,EAAM8C,QAAQ,mBACdhF,KAEAkC,EAAMC,MAAMK,EAAOL,OAAS,iBAEhC,OAASA,GACPD,EAAMC,MAAM,sBACd,CAAA,QACE+H,GAAU,EACZ,GAugCUrF,SAAUoF,EACV7G,UAAU,0EAEVH,SAAA,GAAAJ,IAAC4hB,EAAA,CAAQrhB,UAAU,qBAAqB,QAG1CP,EAAAA,IAAC8B,EAAA,CACCC,QAAQ,UACRb,QAAS/D,EACT6E,SAAUoF,EACV7G,UAAU,8BACXH,SAAA,OAGDJ,EAAAA,IAAC8B,EAAA,CACCZ,QAhnCU/C,UACpB,GAAKmJ,EAEL,IACED,GAAU,QAl2BalJ,WACzB,IAAKmJ,EAAoB,OAEzB,MAAM6a,EAMD,GA8DL,GA5DA7a,EAAmB2E,MAAMuF,QAAQoD,IAC/B,MAAMqE,EAASnQ,EAAegM,IAAIF,EAAQvD,IAC1C,GAAK4H,SAGoB,IAArBA,EAAO5G,WAA2B4G,EAAO5G,YAAcuC,EAAQ3B,qBACjEkP,EAAYtM,KAAK,CACfuM,aAAc9a,EAAmB+J,GACjCgR,kBAAmBzN,EAAQvD,GAC3BiR,cAAe1N,EAAQ3B,qBAAuB,GAC9CsP,eAAgBtJ,EAAO5G,UACvBmQ,WAAY,mBAIQ,IAApBvJ,EAAO1G,UAA0B0G,EAAO1G,WAAaqC,EAAQsE,oBAC/DiJ,EAAYtM,KAAK,CACfuM,aAAc9a,EAAmB+J,GACjCgR,kBAAmBzN,EAAQvD,GAC3BiR,cAAeG,OAAO7N,EAAQsE,oBAAsB,IACpDqJ,eAAgBE,OAAOxJ,EAAO1G,UAC9BiQ,WAAY,kBAIU,IAAtBvJ,EAAOxG,YAA4BwG,EAAOxG,aAAemC,EAAQuE,sBACnEgJ,EAAYtM,KAAK,CACfuM,aAAc9a,EAAmB+J,GACjCgR,kBAAmBzN,EAAQvD,GAC3BiR,cAAeG,OAAO7N,EAAQuE,sBAAwB,IACtDoJ,eAAgBE,OAAOxJ,EAAOxG,YAC9B+P,WAAY,oBAIM,IAAlBvJ,EAAOtG,QAAwBsG,EAAOtG,SAAWiC,EAAQwE,kBAC3D+I,EAAYtM,KAAK,CACfuM,aAAc9a,EAAmB+J,GACjCgR,kBAAmBzN,EAAQvD,GAC3BiR,cAAeG,OAAO7N,EAAQwE,kBAAoB,IAClDmJ,eAAgBE,OAAOxJ,EAAOtG,QAC9B6P,WAAY,gBAIS,IAArBvJ,EAAOM,WAAyB,CAClC,MAAMD,EAAW1E,EAAQvI,oBAAsBC,EAAqBsI,EAAQvI,qBAAuB,GAC/F4M,EAAOM,YAAcD,GACvB6I,EAAYtM,KAAK,CACfuM,aAAc9a,EAAmB+J,GACjCgR,kBAAmBzN,EAAQvD,GAC3BiR,cAAehJ,EACfiJ,eAAgBtJ,EAAOM,UACvBiJ,WAAY,aAGlB,IAIEL,EAAYnd,OAAS,EAAG,CAE1B,IAAA,MAAW0d,KAAcP,QACjBlgB,EAA4B0gB,eAAeD,GAEnDrjB,EAAM8C,QAAQ,GAAGggB,EAAYnd,sCAC/B,GAwxBQ4d,GAGN,MAAMC,EAAyB5V,GAAuB3F,EAAmBoG,gBACnEoV,EAAsB7V,GAAuBzB,IACnD,GAAIsX,IAAwBD,EAAwB,CAClD,MAAQvjB,MAAOyjB,SAAoB/kB,GAChCU,KAAK,0BACLskB,OAAO,CAAEtV,eAAgBoV,GAAuB,OAChDlkB,GAAG,KAAMoI,EAAUqK,IAEtB,GAAI0R,EACF,MAAM,IAAIE,MAAMF,EAAUvU,QAE9B,CAGA,MAAM0U,EAAqC5b,EAAmB2E,MAAME,IAAIC,IACtE,MAAM+W,EAAUlb,EAAY6M,IAAI1I,EAAKiF,IAC/B4H,EAASnQ,EAAegM,IAAI1I,EAAKiF,IAGjC+R,OAAyC,IAArBnK,GAAQ1G,SAC9B0G,EAAO1G,SACPnG,EAAK8M,mBACHmK,OAA4C,IAAvBpK,GAAQxG,WAC/BwG,EAAOxG,WACPrG,EAAK+M,qBACHmK,OAAqC,IAAnBrK,GAAQtG,OAC5BsG,EAAOtG,OACPvG,EAAKgN,iBAGT,MAAO,CACLN,OAAQ1M,EAAKiF,GACbc,oBAAqBgR,GAASjR,YAC9BF,gBAAiBmR,GAAS/Q,QAC1BmR,mBAAoBH,EACpBI,qBAAsBH,EACtBI,iBAAkBH,KAIhB3jB,QAAesC,EAA4ByhB,iBAC/C,CACEthB,YAAa4E,EAAUqK,GACvBpF,MAAOiX,GAETxb,GAGE/H,EAAOwC,SACT9C,EAAM8C,QAAQ,mBACd8E,KAEA5H,EAAMC,MAAMK,EAAOL,OAAS,cAEhC,OAASA,GACPD,EAAMC,MAAM,mBACd,CAAA,QACE+H,GAAU,EACZ,GA6iCUrF,SAAUoF,IAAWE,EACrB/G,UAAU,yEAETH,WACCC,EAAAA,KAAAsB,EAAAA,SAAA,CACEvB,SAAA,GAAAJ,IAACsC,EAAA,CAAQ/B,UAAU,kCAAkC,aAIvDF,EAAAA,KAAAsB,EAAAA,SAAA,CACEvB,SAAA,GAAAJ,IAACyd,EAAA,CAAYld,UAAU,qBAAqB,kBAUvDyI,MACChJ,IAACC,EAAA,CAAOC,KAAM8I,GAAiB9L,OAAQiD,aAAc,IAAM8I,GAAoB,MAC7E7I,SAAAC,EAAAA,KAACC,EAAA,CAAcC,UAAU,WACvBH,SAAA,CAAAJ,EAAAA,IAACQ,GACCJ,SAAAJ,EAAAA,IAACS,EAAA,CAAYF,UAAU,0CAA0CH,0BAKnEC,KAAC,MAAA,CAAIE,UAAU,iBAEbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,mCACZH,SAAA,CAn6BgB,CAACujB,IAC9B,MAAMziB,OAA4D,EAGlE,OAAQyiB,GACN,IAAK,OACH,OAAOtjB,OAAC,QAAKE,UAAW,uCAAyDW,UAAkB2d,MAAM,aAAaze,SAAA,GAAAJ,IAAC4jB,EAAA,CAAMrjB,UAAU,YAAY,QACrJ,IAAK,MACH,OAAOP,EAAAA,IAAC,QAAKO,UAAW,wCAA0DW,UAAkB2d,MAAM,aAAaze,SAAA,OACzH,IAAK,MACH,OAAOJ,EAAAA,IAAC,QAAKO,UAAW,wCAA0DW,UAAkB2d,MAAM,aAAaze,SAAA,OACzH,IAAK,YACH,OAAOJ,EAAAA,IAAC,QAAKO,UAAW,sCAAwDW,UAAkB2d,MAAM,aAAaze,SAAA,UAu5B5GyjB,CAAuB7a,GAAiB2a,UACzCtjB,KAAC,OAAA,CAAKE,UAAU,iCAAiCH,SAAA,CAAA,QACzC4I,GAAiB5D,WAAW0e,QAAQ,GAAG,YAKjDzjB,KAAC,MAAA,CAAIE,UAAU,sCACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,yBACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,sDAAsDH,SAAA,YACtEJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,sCAAuCH,YAAiBsW,mBAE1ErW,KAAC,MAAA,CAAIE,UAAU,yBACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,sDAAsDH,SAAA,YACtEJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,sCAAuCH,YAAiBoG,oBAEzEwC,GAAiBvC,YAA8C,MAAhCuC,GAAiBvC,YAC/CpG,OAAC,MAAA,CAAIE,UAAU,yBACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,sDAAsDH,SAAA,YACtEJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,sCAAuCH,YAAiBqG,qBAM9EpG,KAAC,MAAA,CAAIE,UAAU,YACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,wCAAwCH,SAAA,oBACvD,KAAA,CAAGG,UAAU,YACXH,SAAA4I,GAAiB+a,QAAQ5X,IAAI,CAAC6X,EAAQvC,UACpC,KAAA,CAAalhB,UAAU,iCACrBH,SAAA4jB,GADMvC,kBAQhB5f,EAAA,CACCzB,SAAAJ,EAAAA,IAAC8B,EAAA,CACCC,QAAQ,UACRxC,KAAK,KACL2B,QAAS,IAAM+H,GAAoB,MACnC1I,UAAU,cACXH,SAAA,cASTJ,EAAAA,IAACC,GAAOC,KAAMgJ,GAA6B/I,aAAcgJ,GACvD/I,WAAAC,KAACC,EAAA,CAAcC,UAAU,WACvBH,SAAA,CAAAJ,EAAAA,IAACQ,GACCJ,SAAAJ,EAAAA,IAACS,EAAA,CAAYF,UAAU,0CAA0CH,0BAKnEJ,IAAC,MAAA,CAAIO,UAAU,iBAEXH,eACA,MAAM+e,EAAoBnK,GAAsBpI,KAC9C+E,GAAKA,EAAEhF,WAAa/E,GAAoB+J,EAAE2D,mBAAqB1N,GAG3Dqc,EAAkBphB,KAAKI,IAAI,IAAKkc,GAAmBhI,cAAgBgI,GAAmB1J,eAAiB,GACvGS,EAAeiJ,GAAmB5K,kBAAoB,EACtD2P,EAAa5c,GAAoB2E,MAAMjH,QAAU,EACjDoc,EAA6BxZ,EAC/B0E,EAAqB1E,GACrB,GACEyZ,EAAoBzZ,EACtBgQ,GAAqBhQ,QACrB,EACE0Z,EAA8BD,EAChC/U,EAAqB+U,GACrB,GACEE,GAAyBja,GAAoB2E,OAAS,IACzDE,OAAYmK,GAAgBlK,EAAM,cAClCrG,OAAOwG,SACPJ,IAAIpM,GAASuM,EAAqBvM,IAC/BokB,IACF/C,GACFG,EAAsBpb,KACpBpG,GACEA,IAAUqhB,GACTE,GAA+BvhB,IAAUuhB,GAE1C8C,GAAoB9c,GAAoB2E,OAAS,IAAIlG,OAAO6O,IAChE,MAAM2K,EAAgBtX,EAAY6M,IAAIF,EAAQvD,IAC9C,IAAKkO,EAAe,OAAO,EAM3B,OALmBhZ,EAChB+P,GAAgB1B,EAAS,cAA2B,GACrD2K,EAAclN,UACdkN,EAAcrM,gBAEK,KACpBlO,OACGmR,GAAwB7O,GAAoB2E,OAAS,IAAIlG,OAAO6O,IACpE,MAAM2K,EAAgBtX,EAAY6M,IAAIF,EAAQvD,IAC9C,IAAKkO,EAAe,OAAO,EAC3B,MAAM1I,EAASP,GAAgB1B,EAAS,YAIxC,OAAOhO,EAHiC,iBAAXiQ,EACzBA,EACY,KAAXA,EAAgBvJ,OAAOuJ,QAAU,EACE0I,EAAchN,YACrDvN,OACGqf,EAAuBH,EAAa,GAAKE,IAAqBF,EAC9DI,EAAuBJ,EAAa,GAAK/N,IAAyB+N,EAExE,OACE7jB,EAAAA,KAAAsB,WAAA,CACEvB,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,mEACbH,SAAA,CAAAC,EAAAA,KAAC,OAAA,CAAKE,UAAW,uBACf0jB,GAAmB,GAAK,iBACxBA,GAAmB,GAAK,kBACxB,iBAEC7jB,SAAA,CAAA6jB,EAAgB,SAEnB5jB,KAAC,MAAA,CAAIE,UAAU,YACbH,SAAA,GAAAC,KAAC,IAAA,CAAEE,UAAU,wCAAwCH,SAAA,CAAA,SAC5CwH,GAAoB,WAE7BvH,KAAC,IAAA,CAAEE,UAAU,4BACVH,SAAA,CAAA8V,EAAa,IAAEgO,EAAW,sBAMjC7jB,KAAC,MAAA,CAAIE,UAAU,+DACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,gDACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,gBAAgBH,SAAA,eAChCJ,EAAAA,IAAC,OAAA,CAAKO,UAAW,gBAAe4jB,EAAuB,iBAAmB,gBACvE/jB,SAAA+jB,EAAuB,OAAS,eAGrC9jB,KAAC,MAAA,CAAIE,UAAU,gDACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,gBAAgBH,SAAA,iBAC/B,OAAA,CAAKG,UAAW,gBAAe8jB,EAAuB,iBAAmB,gBACvEjkB,SAAAikB,EAAuB,YAAYD,KAAoBF,KAAgB,UAAUE,KAAoBF,YAG1G7jB,KAAC,MAAA,CAAIE,UAAU,gDACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,gBAAgBH,SAAA,gBAC/B,OAAA,CAAKG,UAAW,gBAAe+jB,EAAuB,iBAAmB,gBACvElkB,SAAAkkB,EAAuB,YAAYnO,KAAwB+N,KAAgB,UAAU/N,KAAwB+N,eAMpH7jB,KAAC,MAAA,CAAIE,UAAU,YACbH,SAAA,CAAAJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,0CAA0CH,SAAA,eACvDJ,MAAC,OAAIO,UAAU,0CACZH,YAAoB6L,MAAME,IAAKyI,IAC9B,MAAM2K,EAAgBtX,EAAY6M,IAAIF,EAAQvD,IACxCjM,EAAama,EACfhZ,EACG+P,GAAgB1B,EAAS,cAA2B,GACrD2K,EAAclN,UACdkN,EAAcrM,eAEhB,EACEqR,EAAYnf,GAAc,GAG1BwR,EAAYN,GAAgB1B,EAAS,YACrCiC,EAA8B,iBAAdD,EAClBA,EACe,KAAdA,EAAmBtJ,OAAOsJ,QAAa,EACtCE,EAASyI,GAAehN,SACxBiS,EAAa5d,EAAkBiQ,EAAQC,GACvC2N,GA9oGyC3d,EA8oGAgQ,EA7oGjEjQ,OADyBA,EA8oGgCgQ,IA5oGzD/P,QAD0D,WAG1DD,IAAgBC,EAAuB,QAGvCD,GAAeC,EAAuB,UAEnC,YATT,IAA+BD,EAAwCC,EAgpG/C,OACEzG,EAAAA,KAAC,MAAA,CAECE,UAAW,0BACTgkB,GAAaC,EAAa,+BAC1BD,EAAY,iCACZ,8BAGFnkB,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,oCACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,iBACbH,SAAA,CAAAJ,MAAC,IAAA,CAAEO,UAAU,iDACVH,SAAAwU,EAAQ3B,qBAAuB,QAElC5S,KAAC,IAAA,CAAEE,UAAU,4BAA4BH,SAAA,CAAA,KACpCmf,GAAelN,WAAa,YAGnCrS,EAAAA,IAAC,QAAKO,UAAW,qDACf6E,GAAc,GAAK,8BACnBA,GAAc,GAAK,gCACnBA,GAAc,GAAK,gCACnB,2BAEChF,SAAAmkB,EAAY,GAAG1hB,KAAKG,MAAMoC,MAAiB,WAI/Cmf,GACClkB,EAAAA,KAAC,MAAA,CAAIE,UAAU,iEACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,4BAA4BH,SAAA,UAC5CC,KAAC,OAAA,CAAKE,UAAU,wCAAwCH,SAAA,CAAA,OACjDyW,GAAU,IAAI,OAErB7W,EAAAA,IAAC,OAAA,CAAKO,UAAU,4BAA4BH,SAAA,SAC5CC,KAAC,OAAA,CAAKE,UAAU,wCAAwCH,SAAA,CAAA,OACjD0W,GAAU,IAAI,aAEpB,OAAA,CAAKvW,UAAW,qCACfikB,EAAa,8BACA,YAAbC,EAAyB,gCACzB,2BAECrkB,SAAAokB,EAAa,OACA,YAAbC,EAAyB,UACzB,eA3CF7P,EAAQvD,aAsD7B,aAGDxP,EAAA,CACCzB,SAAAJ,EAAAA,IAAC8B,EAAA,CACCC,QAAQ,UACRxC,KAAK,KACL2B,QAAS,IAAMiI,IAA+B,GAC9C5I,UAAU,cACXH,SAAA,cAQPJ,EAAAA,IAACuC,EAAA,CACCrF,OAAQsK,EACRnF,SAAU2E,EAAU0W,UACpBvgB,QAAS,IAAMsK,GAAqB,KAIrCU,EAAcgL,IAAI,cAAgBuR,EAAAA,aACjCrkB,OAAAsB,EAAAA,SAAA,CAEEvB,SAAA,CAAAJ,EAAAA,IAAC,MAAA,CACCO,UAAU,wBACVgE,MAAO,CAAEogB,cAAe,QACxBzjB,QAAS,IAAM+b,GAAe,eAGhC5c,EAAAA,KAAC,MAAA,CACCE,UAAU,iHACVgE,MAAO,CACLiE,IAAKF,EAAiBE,IACtBC,KAAMH,EAAiBG,KACvBkc,cAAe,QAEjBzjB,QAAUnC,GAAMA,EAAE8B,kBAElBT,SAAA,GAAAJ,IAAC,MAAA,CAAIO,UAAU,0EACbH,SAAAJ,EAAAA,IAAC,QAAKO,UAAU,0CAA0CH,uBAG3D4U,GAAsB7I,IAAI,CAACwF,EAAG8P,KAC7B,MAAMmD,EAAgBjT,EAAEhF,UAAYgF,EAAE2D,kBAAoB,GACpDuP,EAAajd,IAAqBgd,EAClCE,EAAcjZ,IAAgBgH,WAAWjB,wBAA0BD,EAAEhF,UACxDd,IAAgBgH,WAAWhB,qBAAuBF,EAAE2D,iBAEvE,OACEjV,EAAAA,KAAC,MAAA,CAECa,QAAUnC,IACRA,EAAE8B,kBACF2Y,GAAqBoL,GACrB3H,GAAe,cAEjB1c,UAAW,gFACTskB,EAAa,aAAe,sBAC1BC,EAAc,mCAAqC,KAEvD1kB,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,oCACbH,SAAA,GAAAC,KAAC,IAAA,CAAEE,UAAU,wCACVH,SAAA,CAAAuR,EAAEhF,UAAYgF,EAAE2D,iBAChB3D,EAAEhF,UAAYgF,EAAE2D,kBACfjV,EAAAA,KAAC,OAAA,CAAKE,UAAU,4BAA4BH,SAAA,CAAA,KAAGuR,EAAE2D,iBAAiB,gBAGjD,IAAnB3D,EAAEwF,mBAAkD,IAApBxF,EAAE8D,gBAClCpV,EAAAA,KAAC,OAAA,CAAKE,UAAW,mDACdoR,EAAEwF,cAAgBxF,EAAE8D,eAAiB,IAAM,GAAK,+BAChD9D,EAAEwF,cAAgBxF,EAAE8D,eAAiB,IAAM,GAAK,gCACjD,6BAECrV,SAAA,CAAAyC,KAAKI,IAAI,IAAK0O,EAAEwF,cAAgBxF,EAAE8D,eAAiB,GAAG,YAI7DpV,KAAC,IAAA,CAAEE,UAAU,mCACVH,SAAA,MAAuB,IAAvBuR,EAAE4C,iBACC,GAAG5C,EAAE4C,oBAAoBjN,GAAoB2E,MAAMjH,QAAU,QAC7D,GAAG2M,EAAE4D,gBACR,MAAI5D,EAAE6D,YAAc,iBAGK,IAA3B7D,EAAEwE,2BAA6D,IAAvBxE,EAAE4C,kBAAkC5C,EAAE4C,iBAAmB,GAChGvU,EAAAA,IAAC,IAAA,CAAEO,UAAW,sBACkB,IAA9BoR,EAAEyE,wBAAgC,iBAAmB,mBAEpDhW,SAA8B,IAA9BuR,EAAEyE,wBACC,aACA,SAASzE,EAAEyE,iCAIlB0O,KACC9kB,IAAC,IAAA,CAAEO,UAAU,+CAA+CH,SAAA,iBA7CzDqhB,WAsDf9d,SAASO,MAIV0E,GACC5I,EAAAA,IAAC+kB,EAAA,CACCpP,WAAY/M,EACZ1L,OAAQwL,EACRvL,QAAS,KACPwL,GAA6B,GAC7BE,EAA+B,OAEjCmc,UAAU,eA9tCK,IAmuCzB,CCn8GA,SAAwBC,IACtB,MAAOC,EAAYC,GAAiB5nB,EAAAA,SAAiC,KAC9D2J,EAASC,GAAc5J,EAAAA,UAAS,IAChC6nB,EAAYC,GAAiB9nB,EAAAA,SAAS,KACtC+nB,EAAcC,GAAmBhoB,EAAAA,SAAiB,QAClDioB,EAAYC,GAAiBloB,EAAAA,SAAS,KACtC2mB,EAAYwB,GAAiBnoB,EAAAA,SAAS,IACtCooB,EAAaC,GAAkBroB,EAAAA,UAAS,IAGxCsoB,EAAmBC,GAAwBvoB,EAAAA,UAAS,IACpDwoB,EAAmBC,GAAwBzoB,EAAAA,SAAsC,OACjF0oB,EAAoBC,GAAyB3oB,EAAAA,UAAS,IACtDiK,EAAmBC,GAAwBlK,EAAAA,UAAS,IACpD4oB,GAAgBC,IAAqB7oB,EAAAA,SAAiB,KAGtD8oB,GAAeC,IAAoB/oB,EAAAA,SAAsB,IAAI8K,MAG7Dke,GAAqBC,IAA0BjpB,EAAAA,UAAS,IACxDkpB,GAAoBC,IAAyBnpB,EAAAA,SAAwB,OAGrEopB,GAAkBC,IAAuBrpB,EAAAA,SAI7C,CAAEL,QAAQ,EAAO8J,UAAW,KAAM6f,SAAU,CAAEre,IAAK,EAAGC,KAAM,KAGzDqe,GAAiB3V,EAAAA,YAAYhT,UACjC,IACEgJ,GAAW,GACX,MAAMxH,QAAesC,EAA4B8kB,cAAc,CAC7DpD,OAAyB,QAAjB2B,EAAyBA,OAAe,EAChD0B,SAAUxB,QAAc,EACxByB,OAAQ7B,QAAc,EACtBnL,MAAO,KAGLta,EAAOwC,SACTgjB,EAAcxlB,EAAOvB,MAAQ,IAC7BsnB,EAAc/lB,EAAOunB,OAAS,IAE9B7nB,EAAMC,MAAMK,EAAOL,OAAS,qBAEhC,OAASA,GACPD,EAAMC,MAAM,qBACd,CAAA,QACE6H,GAAW,EACb,GACC,CAACme,EAAcE,EAAYJ,IAE9BlnB,EAAAA,UAAU,KACR4oB,MACC,CAACA,KAGJ,MAAMK,GAAcppB,SAAOE,KAE3BC,EAAAA,UAAU,KACR,MAAMF,EAAWmpB,GAAYrnB,QAGvBsnB,EAAUppB,EACbopB,QAAQ,kCACRC,GACC,mBACA,CACEnK,MAAO,IACPoK,OAAQ,SACR1Z,MAAO,0BAER2Z,IAIC,GAA0B,WAAtBA,EAAQC,UAAwB,CAClC,MAAMC,EAAYF,EAAQG,KAAK/D,OACzBgE,EAAYJ,EAAQK,KAAKjE,OAG3B8D,IAAcE,GAEhBb,IAEJ,KAAiC,WAAtBS,EAAQC,WAAgD,WAAtBD,EAAQC,WACnDV,OAILe,YAEH,MAAO,KACL7pB,EAAS8pB,cAAcV,KAExB,CAACN,KAGJ,MAAMiB,GAAqBpE,IACzB,MAAMqE,EAAY,yGAElB,OAAQrE,GACN,IAAK,UACH,OACEtjB,EAAAA,KAAC,OAAA,CAAKE,UAAW,GAAGynB,qDAClB5nB,SAAA,GAAAJ,IAACioB,EAAA,CAAM1nB,UAAU,YAAY,SAInC,IAAK,aACH,OACEF,EAAAA,KAAC,OAAA,CAAKE,UAAW,GAAGynB,oDAClB5nB,SAAA,GAAAJ,IAACsC,EAAA,CAAQ/B,UAAU,yBAAyB,SAIlD,IAAK,YACH,OACEF,EAAAA,KAAC,OAAA,CAAKE,UAAW,GAAGynB,0DAClB5nB,SAAA,GAAAJ,IAACkoB,EAAA,CAAY3nB,UAAU,YAAY,UAIzC,IAAK,YACH,OACEF,EAAAA,KAAC,OAAA,CAAKE,UAAW,GAAGynB,uDAClB5nB,SAAA,GAAAJ,IAACyd,EAAA,CAAYld,UAAU,YAAY,SAIzC,IAAK,WACH,OACEF,EAAAA,KAAC,OAAA,CAAKE,UAAW,GAAGynB,iDAClB5nB,SAAA,GAAAJ,IAAC4hB,EAAA,CAAQrhB,UAAU,YAAY,SAIrC,QACE,aAAQ,OAAA,CAAKA,UAAW,GAAGynB,8BAAwC5nB,SAAAujB,MAKnEwE,GAAsB,CAACnhB,EAAiCkW,KAG5D,GAFA8I,EAAqBhf,GAEI,cAArBA,EAAU2c,OAEZuC,GAAsB,QACxB,GAAgC,cAArBlf,EAAU2c,QAA0B3c,EAAUohB,mBAAqBphB,EAAUohB,kBAAkBpjB,OAAS,EAEjH,GAA2C,IAAvCgC,EAAUohB,kBAAkBpjB,OAE9B0hB,GAAsB1f,EAAUohB,kBAAkB,GAAGlW,aACrDsU,IAAuB,OAClB,CAEL,MAAMrJ,EAAQD,GAAOE,eAA+BtP,wBACpD8Y,GAAoB,CAClB1pB,QAAQ,EACR8J,YACA6f,SAAU,CACRre,IAAK2U,EAAOA,EAAKE,OAAS9Z,OAAO8kB,QAAU,EAC3C5f,KAAM0U,EAAOA,EAAK1U,KAAOlF,OAAO+kB,QAAU,IAGhD,KAC8B,cAArBthB,EAAU2c,QAA+C,YAArB3c,EAAU2c,SAEvDyC,GAAkBpf,EAAU0W,WAC5BjW,GAAqB,KAYnB8gB,GAA8B,KAClC3B,GAAoB,CAAE1pB,QAAQ,EAAO8J,UAAW,KAAM6f,SAAU,CAAEre,IAAK,EAAGC,KAAM,MAI5E+f,GAAkB,CAACzpB,EAAqBsD,KAC5CtD,EAAE8B,kBACFulB,GAAkB/jB,GAClBoF,GAAqB,IAqHjBghB,GAA0B,KAC9BvC,GAAsB,GACtBF,EAAqB,MACrBc,MAII4B,GAAcC,GACbA,EACE,IAAI5kB,KAAK4kB,GAAYC,mBAAmB,QAAS,CACtDC,KAAM,UACNC,MAAO,UACPC,IAAK,YAJiB,IASpBlM,GAAgBlK,GAChBA,QAAgD,IAC7CA,EAAOmK,eAAe,SAAW,IAG1C,SACEzc,KAAC,MAAA,CAAIE,UAAU,SAEbH,SAAA,CAAAJ,EAAAA,IAAC,OAAIO,UAAU,OACbH,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,oCACbH,SAAA,CAAAC,OAAC,MAAA,CACCD,SAAA,CAAAJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,aAAaH,SAAA,aAC3BJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,gBAAgBgE,MAAO,CAAEykB,UAAW,OAAQC,aAAc,QAAU7oB,SAAA,4CAKnFC,KAAC,MAAA,CAAIE,UAAU,0BACbH,SAAA,CAAAC,EAAAA,KAACyB,EAAA,CACCZ,QAAS,IAAM4kB,GAAqB,GACpCvlB,UAAU,iEAEVH,SAAA,GAAAJ,IAACkpB,EAAA,CAAK3oB,UAAU,gBAChBP,EAAAA,IAAC,OAAA,CAAKO,UAAU,mBAAmBH,SAAA,WAErCJ,EAAAA,IAAC8B,EAAA,CACCC,QAAQ,UACRb,QAAS4lB,GACT9kB,SAAUkF,EACV3G,UAAU,sBAEVH,eAAC1D,EAAA,CAAU6D,UAAW,gBAAe2G,EAAU,eAAiB,kBAOxE7G,KAAC,MAAA,CAAIE,UAAU,OACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,oCAEbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,uCACbH,SAAA,GAAAJ,IAACkf,EAAA,CAAO3e,UAAU,mFAClBP,EAAAA,IAACmpB,EAAA,CACC9K,YAAY,kBACZte,MAAOqlB,EACP9jB,SAAWvC,GAAMsmB,EAActmB,EAAEwC,OAAOxB,OACxCQ,UAAU,mIAKdF,EAAAA,KAAC+oB,EAAA,CAAOrpB,MAAOulB,EAAc+D,cAAe9D,EAC1CnlB,SAAA,CAAAJ,EAAAA,IAACspB,GAAc/oB,UAAU,2JACvBH,eAACmpB,EAAA,CAAYlL,YAAY,WAE3Bhe,KAACmpB,EAAA,CAAcjpB,UAAU,gBACvBH,SAAA,CAAAJ,MAACypB,EAAA,CAAW1pB,MAAM,MAAMQ,UAAU,qBAAqBH,SAAA,gBACtDqpB,EAAA,CAAW1pB,MAAM,UAAUQ,UAAU,qBAAqBH,SAAA,cAC1DqpB,EAAA,CAAW1pB,MAAM,YAAYQ,UAAU,qBAAqBH,SAAA,eAC5DqpB,EAAA,CAAW1pB,MAAM,YAAYQ,UAAU,qBAAqBH,SAAA,cAC5DqpB,EAAA,CAAW1pB,MAAM,WAAWQ,UAAU,qBAAqBH,SAAA,cAKhEC,EAAAA,KAACyB,EAAA,CACCC,QAAQ,UACRb,QAAS,IAAM0kB,GAAgBD,GAC/BplB,UAAW,uFAAsFolB,EAAc,8CAAgD,IAE/JvlB,SAAA,GAAAJ,IAACpD,EAAA,CAAkB2D,UAAU,qBAC7BP,EAAAA,IAAC,OAAA,CAAKO,UAAU,cAAcH,SAAA,YAIhCC,KAAC,OAAA,CAAKE,UAAU,wCAAwCH,SAAA,CAAA,KACnD8jB,EAAW,UAKjByB,SACE,MAAA,CAAIplB,UAAU,kEACbH,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,oCACbH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,0BACbH,SAAA,CAAAJ,EAAAA,IAAC,QAAA,CAAMO,UAAU,wCAAwCH,SAAA,WACzDJ,EAAAA,IAACmpB,EAAA,CACChqB,KAAK,OACLY,MAAOylB,EACPlkB,SAAWvC,GAAM0mB,EAAc1mB,EAAEwC,OAAOxB,OACxCQ,UAAU,0IAGdF,EAAAA,KAACyB,EAAA,CACCC,QAAQ,UACRb,QAAS,KACPmkB,EAAc,IACdE,EAAgB,OAChBE,EAAc,KAEhBllB,UAAU,2GACXH,SAAA,CAAA,KACGJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,4BAA4BH,SAAA,mBAQxDJ,EAAAA,IAAC0pB,EAAA,CAAKnpB,UAAU,8DACdH,WAAAJ,IAAC2pB,EAAA,CAAYppB,UAAU,MACpBH,SAAA8G,EACC7G,EAAAA,KAAC,MAAA,CAAIE,UAAU,yCACbH,SAAA,GAAAJ,IAAC,MAAA,CAAIO,UAAU,qFACfP,EAAAA,IAAC,OAAA,CAAKO,UAAU,iCAAiCH,SAAA,eAE3B,IAAtB8kB,EAAWlgB,OACb3E,OAAC,MAAA,CAAIE,UAAU,oBACbH,SAAA,GAAAJ,IAAC4pB,EAAA,CAAUrpB,UAAU,yCACrBP,EAAAA,IAAC,KAAA,CAAGO,UAAU,6CAA6CH,SAAA,gBAC3DJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,4BAA4BH,SAAA,2CAG3CC,EAAAA,KAAAsB,EAAAA,SAAA,CAEEvB,SAAA,CAAAJ,EAAAA,IAAC,OAAIO,UAAU,kCACbH,SAAAC,EAAAA,KAAC,QAAA,CAAME,UAAU,mBACfH,SAAA,CAAAJ,MAAC,QAAA,CAAMO,UAAU,sCACfH,SAAAC,EAAAA,KAAC,KAAA,CACCD,SAAA,CAAAJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,2FAA2FH,SAAA,OACzGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,2FAA2FH,SAAA,SACzGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,2FAA2FH,SAAA,SACzGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,yFAAyFH,SAAA,SACvGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,yFAAyFH,SAAA,QACvGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,0FAA0FH,SAAA,SACxGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,2FAA2FH,SAAA,QACzGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,2FAA2FH,SAAA,QACzGJ,EAAAA,IAAC,KAAA,CAAGO,UAAU,2FAA2FH,SAAA,kBAG5G,QAAA,CAAMG,UAAU,oCACdH,SAAA8kB,EAAW/Y,IAAKnF,GACf3G,EAAAA,KAAC,KAAA,CAECE,UAAU,oDACVW,QAAUnC,GAAMopB,GAAoBnhB,EAAWjI,GAE/CqB,SAAA,GAAAJ,IAAC,KAAA,CAAGO,UAAU,0BACXH,SAAAimB,GAAclT,IAAInM,EAAUqK,IACzB0W,GAAkB,cAClBA,GAAkB/gB,EAAU2c,gBAEjC,KAAA,CAAGpjB,UAAU,oDACXH,SAAAsoB,GAAW1hB,EAAU6iB,eAExB7pB,EAAAA,IAAC,KAAA,CAAGO,UAAU,oDACXH,SAAA4G,EAAU0G,eAAiBgb,GAAW1hB,EAAU0G,gBAAkB,YAEpE,KAAA,CAAGnN,UAAU,oDACXH,SAAA4G,EAAU8F,aAAe,YAE3B,KAAA,CAAGvM,UAAU,+DACXH,SAAA4G,EAAU8iB,WAAa,YAEzB,KAAA,CAAGvpB,UAAU,+DACXH,SAAAyc,GAAa7V,EAAUyX,qBAEzB,KAAA,CAAGle,UAAU,oDACXH,SAAA4G,EAAU+iB,kBAAoB,YAEhC,KAAA,CAAGxpB,UAAU,oDACXH,SAAA4G,EAAUgjB,mBAAqB,YAEjC,KAAA,CAAGzpB,UAAU,0BACZH,SAAAC,EAAAA,KAAC,MAAA,CAAIE,UAAU,yCACbH,SAAA,CAAAJ,EAAAA,IAAC,SAAA,CACCkB,QAAUnC,GAAMypB,GAAgBzpB,EAAGiI,EAAU0W,WAC7Cnd,UAAU,yFACVse,MAAM,SAENze,SAAAJ,EAAAA,IAAC4B,EAAA,CAAUrB,UAAU,kBAEvBP,EAAAA,IAAC,SAAA,CACCkB,QAAUnC,GA1QjBZ,OAAOY,EAAqBiI,KAG/C,GAFAjI,EAAE8B,kBAEGohB,QAAQ,IAAIjb,EAAU8iB,WAAa,yBAIxC,IACE,MAAMnqB,QAAesC,EAA4BgoB,gBAAgBjjB,EAAUqK,IAEvE1R,EAAOwC,SACT9C,EAAM8C,QAAQ,YACd2kB,MAEAznB,EAAMC,MAAMK,EAAOL,OAAS,cAEhC,OAASA,GACPD,EAAMC,MAAM,mBACd,GAwP0C4qB,CAAanrB,EAAGiI,GAChCzG,UAAU,qFACVse,MAAM,KAENze,SAAAJ,EAAAA,IAACmqB,EAAA,CAAO5pB,UAAU,yBA5CnByG,EAAUqK,kBAuDxB,MAAA,CAAI9Q,UAAU,qCACZH,SAAA8kB,EAAW/Y,IAAKnF,GACf3G,EAAAA,KAAC,MAAA,CAECE,UAAU,wDACVW,QAAUnC,GAAMopB,GAAoBnhB,EAAWjI,GAE/CqB,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,wCACZH,SAAA,CAAAimB,GAAclT,IAAInM,EAAUqK,IACzB0W,GAAkB,cAClBA,GAAkB/gB,EAAU2c,cAC/B,OAAA,CAAKpjB,UAAU,4BACbH,SAAAsoB,GAAW1hB,EAAU6iB,oBAG1BxpB,KAAC,MAAA,CAAIE,UAAU,OACbH,SAAA,CAAAJ,MAAC,IAAA,CAAEO,UAAU,wCACVH,SAAA4G,EAAU8F,aAAe,YAE5B9M,EAAAA,IAAC,IAAA,CAAEO,UAAU,qCACVH,WAAU0pB,eAGd9iB,EAAUyX,aACTze,MAAC,IAAA,CAAEO,UAAU,sCACVH,SAAAyc,GAAa7V,EAAUyX,iBAG5Bze,IAAC,MAAA,CAAIO,UAAU,yEACbH,SAAAC,EAAAA,KAAC,SAAA,CACCa,QAAUnC,GAAMypB,GAAgBzpB,EAAGiI,EAAU0W,WAC7Cnd,UAAU,0FAEVH,SAAA,GAAAJ,IAAC4B,EAAA,CAAUrB,UAAU,iBAAiB,YA9BrCyG,EAAUqK,cA2C7BrR,EAAAA,IAAC/C,EAAA,CACCC,OAAQ2oB,EACR1oB,QAAS,IAAM2oB,GAAqB,GACpC1oB,UApTsBe,MAAOiE,EAAqBC,KACtDyjB,GAAqB,SAGfgB,KAGNR,MAAyB,IAAIje,IAAIzF,GAAMgW,IAAIxW,IAG3C,IACE/C,EAAM6H,QAAQ,4BAA6B,CAAEmK,GAAI,cAAcjP,MAE/D,MAAMzC,QAAesC,EAA4BmoB,qBAAqBhoB,EAAaC,GAE/E1C,EAAOwC,SACT9C,EAAM8C,QAAQ,+BAAgC,CAAEkP,GAAI,cAAcjP,MAClE0kB,KAGInnB,EAAOvB,OACT4nB,EAAqBrmB,EAAOvB,MAC5B8nB,GAAsB,MAGxB7mB,EAAMC,MAAMK,EAAOL,OAAS,kBAAmB,CAAE+R,GAAI,cAAcjP,MACnE0kB,KAEJ,OAASxnB,GACPD,EAAMC,MAAM,uBAAwB,CAAE+R,GAAI,cAAcjP,MACxD0kB,IACF,CAAA,QAEER,GAAiB1jB,IACf,MAAMgX,EAAO,IAAIvR,IAAIzF,GAErB,OADAgX,EAAKe,OAAOvY,GACLwX,GAEX,KAkRGmM,GACC/lB,EAAAA,IAAC+G,EAAA,CACC7J,OAAQ+oB,EACRjf,UAAW+e,EACX5oB,QAASsrB,GACTxhB,UAAWwhB,KAKfzoB,EAAAA,IAACuC,EAAA,CACCrF,OAAQsK,EACRnF,SAAU8jB,GACVhpB,QAAS,KACPsK,GAAqB,GACrB2e,GAAkB,OAKrBO,GAAiBzpB,QAAUypB,GAAiB3f,aAC3C3G,KAAAsB,EAAAA,SAAA,CAEEvB,SAAA,CAAAJ,EAAAA,IAAC,MAAA,CACCO,UAAU,qBACVW,QAASqnB,KAGXloB,EAAAA,KAAC,MAAA,CACCE,UAAU,8FACVgE,MAAO,CACLiE,IAAKme,GAAiBE,SAASre,IAAM,EACrCC,KAAMke,GAAiBE,SAASpe,MAGlCrI,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,+FACbH,SAAA,GAAAC,KAAC,OAAA,CAAKE,UAAU,0CAA0CH,SAAA,CAAA,WAC/CumB,GAAiB3f,UAAUohB,mBAAmBpjB,QAAU,EAAE,QAErEhF,EAAAA,IAAC,SAAA,CACCkB,QAASqnB,GACThoB,UAAU,kCAEVH,SAAAJ,EAAAA,IAAC0B,EAAA,CAAEnB,UAAU,mCAGjBP,EAAAA,IAAC,MAAA,CAAIO,UAAU,8BACZH,SAAAumB,GAAiB3f,UAAUohB,mBAAmBjc,IAAI,CAAC4O,EAAU0G,IAC5DphB,EAAAA,KAAC,MAAA,CAECa,QAAS,KAAMmpB,OApcD1U,EAocsBoF,EAAS7I,YAnc3D0U,GAAoB,CAAE1pB,QAAQ,EAAO8J,UAAW,KAAM6f,SAAU,CAAEre,IAAK,EAAGC,KAAM,KAChFie,GAAsB/Q,QACtB6Q,IAAuB,GAHI,IAAC7Q,GAqcdpV,UAAU,wIAEVH,SAAA,GAAAC,KAAC,MAAA,CAAIE,UAAU,SACbH,SAAA,CAAAJ,EAAAA,IAAC,IAAA,CAAEO,UAAU,wCACVH,SAAA2a,EAASnJ,uBAAyBmJ,EAASlJ,oBAAsB,OAAOkJ,EAAS7I,gBAEnF6I,EAASlJ,oBAAsBkJ,EAASnJ,uBACvCvR,EAAAA,KAAC,IAAA,CAAEE,UAAU,4BAA4BH,SAAA,CAAA,OAClC2a,EAASlJ,2BAIpBxR,KAAC,MAAA,CAAIE,UAAU,wCACbH,SAAA,CAAAJ,EAAAA,IAAC,OAAA,CAAKO,UAAU,cAAcH,SAAA,WAC9BJ,IAACsqB,EAAA,CAAa/pB,UAAU,qBAhBrBwa,EAAS7I,sBA0BzBuU,IACCzmB,EAAAA,IAAC+kB,EAAA,CACCpP,WAAY8Q,GACZvpB,OAAQqpB,GACRppB,QAAS,KACPqpB,IAAuB,GACvBE,GAAsB,OAExB1B,UAAU,UAKpB","x_google_ignoreList":[0,1,2,3,4]}