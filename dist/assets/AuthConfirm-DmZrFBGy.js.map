{"version":3,"file":"AuthConfirm-DmZrFBGy.js","sources":["../../src/components/auth/AuthConfirm.tsx"],"sourcesContent":["import { useEffect, useState } from 'react'\nimport { useNavigate, useSearchParams } from 'react-router-dom'\nimport { createClient } from '@/lib/supabase/client'\nimport type { EmailOtpType } from '@supabase/supabase-js'\n\n/**\n * 비밀번호 재설정 및 이메일 확인을 처리하는 컴포넌트\n * Supabase Auth의 token_hash를 세션으로 교환\n */\nexport default function AuthConfirm() {\n  const [searchParams] = useSearchParams()\n  const navigate = useNavigate()\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n\n  useEffect(() => {\n    const handleAuthConfirm = async () => {\n      const token_hash = searchParams.get('token_hash')\n      const type = searchParams.get('type') as EmailOtpType | null\n      const next = searchParams.get('next') || '/dashboard'\n\n      if (!token_hash || !type) {\n        setError('유효하지 않은 링크입니다.')\n        setLoading(false)\n        setTimeout(() => navigate('/'), 3000)\n        return\n      }\n\n      const supabase = createClient()\n\n      try {\n        // token_hash를 세션으로 교환\n        const { error: verifyError } = await supabase.auth.verifyOtp({\n          type,\n          token_hash,\n        })\n\n        if (verifyError) {\n          setError(`인증 실패: ${verifyError.message}`)\n          setLoading(false)\n          setTimeout(() => navigate('/'), 3000)\n          return\n        }\n\n        // 비밀번호 재설정인 경우 비밀번호 변경 페이지로 리다이렉트\n        if (type === 'recovery') {\n          navigate('/auth/reset-password')\n        } else {\n          // 다른 타입(이메일 확인 등)은 지정된 페이지로 리다이렉트\n          navigate(next)\n        }\n      } catch (err) {\n        setError(`오류가 발생했습니다: ${err instanceof Error ? err.message : '알 수 없는 오류'}`)\n        setLoading(false)\n        setTimeout(() => navigate('/'), 3000)\n      }\n    }\n\n    handleAuthConfirm()\n  }, [searchParams, navigate])\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"w-8 h-8 border-2 border-hansl-600 border-t-transparent rounded-full animate-spin mx-auto\" />\n          <p className=\"mt-4 text-gray-600\">인증 처리 중...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full\">\n          <div className=\"text-center\">\n            <div className=\"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <span className=\"text-2xl\">⚠️</span>\n            </div>\n            <h2 className=\"text-xl font-semibold text-gray-800 mb-2\">인증 실패</h2>\n            <p className=\"text-gray-600 mb-6\">{error}</p>\n            <p className=\"text-sm text-gray-500\">잠시 후 메인 페이지로 이동합니다...</p>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return null\n}\n\n\n\n\n\n"],"names":["AuthConfirm","searchParams","useSearchParams","navigate","useNavigate","loading","setLoading","useState","error","setError","useEffect","async","token_hash","get","type","next","setTimeout","supabase","createClient","verifyError","auth","verifyOtp","message","err","Error","handleAuthConfirm","className","children","jsxs","jsx"],"mappings":"qEASA,SAAwBA,IACtB,MAAOC,GAAgBC,IACjBC,EAAWC,KACVC,EAASC,GAAcC,EAAAA,UAAS,IAChCC,EAAOC,GAAYF,EAAAA,SAAwB,MAgDlD,OA9CAG,EAAAA,UAAU,KACkBC,WACxB,MAAMC,EAAaX,EAAaY,IAAI,cAC9BC,EAAOb,EAAaY,IAAI,QACxBE,EAAOd,EAAaY,IAAI,SAAW,aAEzC,IAAKD,IAAeE,EAIlB,OAHAL,EAAS,kBACTH,GAAW,QACXU,WAAW,IAAMb,EAAS,KAAM,KAIlC,MAAMc,EAAWC,IAEjB,IAEE,MAAQV,MAAOW,SAAsBF,EAASG,KAAKC,UAAU,CAC3DP,OACAF,eAGF,GAAIO,EAIF,OAHAV,EAAS,UAAUU,EAAYG,WAC/BhB,GAAW,QACXU,WAAW,IAAMb,EAAS,KAAM,KAMhCA,EADW,aAATW,EACO,uBAGAC,EAEb,OAASQ,GACPd,EAAS,eAAec,aAAeC,MAAQD,EAAID,QAAU,eAC7DhB,GAAW,GACXU,WAAW,IAAMb,EAAS,KAAM,IAClC,GAGFsB,IACC,CAACxB,EAAcE,IAEdE,QAEC,MAAA,CAAIqB,UAAU,2DACbC,SAAAC,EAAAA,KAAC,MAAA,CAAIF,UAAU,cACbC,SAAA,GAAAE,IAAC,MAAA,CAAIH,UAAU,6FACfG,EAAAA,IAAC,IAAA,CAAEH,UAAU,qBAAqBC,SAAA,oBAMtCnB,EAEAqB,EAAAA,IAAC,MAAA,CAAIH,UAAU,2DACbC,WAAAE,IAAC,MAAA,CAAIH,UAAU,qDACbC,SAAAC,EAAAA,KAAC,MAAA,CAAIF,UAAU,cACbC,SAAA,GAAAE,IAAC,MAAA,CAAIH,UAAU,kFACbC,SAAAE,EAAAA,IAAC,QAAKH,UAAU,WAAWC,kBAE7BE,EAAAA,IAAC,KAAA,CAAGH,UAAU,2CAA2CC,SAAA,UACzDE,EAAAA,IAAC,IAAA,CAAEH,UAAU,qBAAsBC,SAAAnB,IACnCqB,EAAAA,IAAC,IAAA,CAAEH,UAAU,wBAAwBC,SAAA,iCAOxC,IACT"}