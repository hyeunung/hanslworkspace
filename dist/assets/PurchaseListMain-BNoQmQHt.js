const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-C8vExLsi.js","assets/index-C0FAzD3m.js","assets/index-DbvJ_Lqx.css","assets/PurchaseItemsModal-Bnb5Uy9L.js","assets/input-DaTkxl0w.js","assets/table-Bl9tevC9.js","assets/index-BxJnWAhi.js","assets/pen-BGLtDehW.js","assets/plus-CqeW5uEq.js","assets/save-DYJzTmaz.js","assets/card-uOpkqlwt.js","assets/format-CSQe5d3I.js"])))=>i.map(i=>d[i]);
import{c as Qe,r as n,a as Se,l as Ee,j as e,_ as et,b as ke,d as tt,e as ge,f as yr,g as J,h as rt,i as de,P as re,k as je,m as at,n as _r,R as wr,A as st,o as nt,p as jr,D as br,C as Nr,q as Cr,B as lt,u as Sr,s as kr}from"./index-C0FAzD3m.js";import{t as te,B as Y}from"./index-BxJnWAhi.js";import{a as Pr,P as Ar}from"./PurchaseDetailModal-DVHyq9uz.js";import{E as Dr,C as ze,a as $r,b as Er,c as Ve}from"./card-uOpkqlwt.js";import{g as ot,R as it,P as ct,W as Rr,C as dt,T as Fr,h as Ir,i as mt,O as ut,j as Or,k as qr,l as Mr,m as Tr,u as Lr,F as Br,I as _e}from"./input-DaTkxl0w.js";import{C as zr,S as Ge,a as We,b as He,c as Je,d as ue}from"./select-gr-jwd71.js";import{S as pt}from"./search-CPiTUZ2D.js";import{P as Vr}from"./plus-CqeW5uEq.js";import"./pen-BGLtDehW.js";import"./save-DYJzTmaz.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Wr=Qe("chevrons-up-down",Gr);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Jr=Qe("funnel",Hr),Kr=()=>{const[t,s]=n.useState([]),[r,a]=n.useState([]),[l,d]=n.useState([]),[u,p]=n.useState(!0),[j,i]=n.useState([]),[N,k]=n.useState(""),[C,E]=n.useState(""),[F,U]=n.useState(""),o=Se();n.useEffect(()=>{(async()=>{try{const[I,R,f]=await Promise.all([o.from("vendors").select("*"),o.from("employees").select("*"),o.auth.getUser()]);if(I.error)throw I.error;if(a(I.data||[]),R.error)throw R.error;if(d(R.data||[]),f.data.user&&!f.error){let g=null;if(f.data.user.email&&(g=(await o.from("employees").select("*").eq("email",f.data.user.email).maybeSingle()).data),g){let D=[];g.purchase_role&&(Array.isArray(g.purchase_role)?D=g.purchase_role.map(y=>String(y).trim()):D=String(g.purchase_role).split(",").map(L=>L.trim()).filter(L=>L.length>0)),i(D),k(g.name||g.full_name||""),E(g.email||""),U(g.id||"")}}}catch(I){Ee.error("초기 데이터 로드 실패",I)}})()},[]);const h=n.useCallback(async()=>{p(!0);try{let S=l;if(S.length===0){const{data:y}=await o.from("employees").select("*");S=y||[]}const{data:{user:I},error:R}=await o.auth.getUser();if(R||!I){Ee.error("사용자 인증 실패",R),te.error("로그인이 필요합니다."),p(!1);return}const{data:f,error:g}=await o.from("purchase_requests").select("*,vendors(vendor_name,vendor_payment_schedule),vendor_contacts(contact_name),purchase_request_items(item_name,specification,quantity,unit_price_value,amount_value,remark,line_number,link)").order("request_date",{ascending:!1}).limit(2e3);if(g)throw g;const D=(f||[]).map(y=>{const L=y.purchase_request_items?.[0]||{},q=S.find(M=>M.id===y.requester_id);return{id:Number(y.id),purchase_order_number:y.purchase_order_number,request_date:y.request_date,delivery_request_date:y.delivery_request_date,progress_type:y.progress_type,payment_completed_at:y.payment_completed_at,payment_category:y.payment_category,currency:y.currency,request_type:y.request_type,vendor:y.vendors||null,vendor_name:y.vendors?.vendor_name||"",vendor_payment_schedule:y.vendors?.vendor_payment_schedule||"",vendor_contacts:y.vendor_contacts||[],requester_id:y.requester_id,requester_name:y.requester_name,requester_email:q?.email||"",requester_full_name:q?.full_name||q?.name||y.requester_name||"",item_name:L.item_name||"",specification:L.specification||"",quantity:Number(L.quantity)||0,unit_price_value:Number(L.unit_price_value)||0,amount_value:Number(L.amount_value)||0,remark:L.remark||"",project_vendor:y.project_vendor,sales_order_number:y.sales_order_number,project_item:y.project_item,line_number:Number(L.line_number)||1,contact_name:y.vendor_contacts?.contact_name||"",middle_manager_status:y.middle_manager_status,final_manager_status:y.final_manager_status,is_received:!!y.is_received,received_at:y.received_at,is_payment_completed:!!y.is_payment_completed,is_po_download:!!y.is_po_download,link:L.link,items:y.purchase_request_items||[],total_amount:y.purchase_request_items?.reduce((M,ee)=>M+(Number(ee.amount_value)||0),0)||0,purchase_status:y.purchase_status||"pending"}});s(D)}catch(S){Ee.error("발주 목록 로드 실패",S),te.error("발주 목록을 불러올 수 없습니다.")}finally{p(!1)}},[l]);return n.useEffect(()=>{h()},[h]),{purchases:t,vendors:r,employees:l,loading:u,currentUserRoles:j,currentUserName:N,currentUserEmail:C,currentUserId:F,refreshPurchases:h}};function Yr(t,s=500){const[r,a]=n.useState(t);return n.useEffect(()=>{const l=setTimeout(()=>{a(t)},s);return()=>{clearTimeout(l)}},[t,s]),r}const Xr=["정희웅"],Ur=(t,s,r,a,l)=>{const d=Se(),[u,p]=n.useState("pending"),[j,i]=n.useState(""),[N,k]=n.useState(""),[C,E]=n.useState(""),[F,U]=n.useState(""),[o,h]=n.useState(""),[S,I]=n.useState(""),[R,f]=n.useState(""),[g,D]=n.useState(""),y=new Date().getFullYear(),L=new Date(y,0,1).toISOString().split("T")[0],q=new Date().toISOString().split("T")[0],[M,ee]=n.useState(L),[V,K]=n.useState(q),G=Yr(j,300),T=s?.includes("app_admin");s?.includes("final_approver"),s?.includes("middle_manager");const Z=s?.includes("purchase_manager"),W=s?.includes("raw_material_manager")||s?.includes("consumable_manager")||s?.includes("purchase_manager"),ae=n.useMemo(()=>!s||s.length===0?1:Z?2:s.some(w=>["middle_manager","final_approver","app_admin","ceo"].includes(w))?3:1,[s,Z]),se=n.useCallback(w=>{if(!r)return"all";if(w==="purchase")return W||T?"all":r;switch(ae){case 1:return w==="done"?"all":r;case 2:return w==="done"?"all":r;case 3:return"all";default:return r}},[r,ae,W,T]);n.useEffect(()=>{if(!r)return;const w=se(u);E(w)},[u,r,ae,se]);const ne=n.useMemo(()=>s.includes("purchase_manager")||s.includes("app_admin")?t:t.filter(w=>!Xr.includes(w.requester_name)),[t,s]),c=n.useMemo(()=>ne.filter(w=>{const _=w.request_date?w.request_date.split("T")[0]:"",P=!M||_>=M,B=!V||_<=V;return P&&B}),[ne,M,V]),b=n.useMemo(()=>c.filter(_=>{let P=!1;switch(u){case"pending":return P=["pending","대기","",null].includes(_.final_manager_status),P;case"purchase":{const B=_.payment_category==="구매 요청",ve=!_.is_payment_completed,ye=(_.progress_type||"").includes("선진행"),Ce=(_.progress_type||"").includes("일반"),De=_.final_manager_status==="approved";return!B||!ve?P=!1:P=ye||Ce&&De,P}case"receipt":{const B=!_.is_received,ve=(_.progress_type||"").includes("선진행"),ye=_.final_manager_status==="approved";return P=B&&(ve||ye),P}case"done":return P=!0,P;default:return!0}}),[c,u]),A=n.useMemo(()=>C&&C!=="all"&&C!=="전체"?b.filter(_=>_.requester_name===C):b,[b,C]),v=n.useMemo(()=>N?A.filter(w=>w.vendor_name===N):A,[A,N]),$=n.useMemo(()=>{let w=v;if(F){const _=F.trim().toLowerCase();w=w.filter(P=>P.purchase_order_number?.toLowerCase().includes(_))}if(o){const _=o.trim().toLowerCase();w=w.filter(P=>P.items&&P.items.length>0?P.items.some(B=>B.item_name?.toLowerCase().includes(_)):!1)}if(S){const _=S.trim().toLowerCase();w=w.filter(P=>P.items&&P.items.length>0?P.items.some(B=>B.specification?.toLowerCase().includes(_)):!1)}if(R&&R!=="all"&&(w=w.filter(_=>{switch(R){case"pending":return!_.final_manager_status||_.final_manager_status==="pending"||_.final_manager_status==="대기";case"approved":return _.final_manager_status==="approved";case"rejected":return _.final_manager_status==="rejected"||_.middle_manager_status==="rejected";default:return!0}})),g){const _=g.trim().toLowerCase();w=w.filter(P=>P.items&&P.items.length>0?P.items.some(B=>B.remark?.toLowerCase().includes(_)):!1)}return w},[v,F,o,S,R,g]),x=n.useMemo(()=>{if(!G)return $;const w=G.trim().toLowerCase();return $.filter(_=>_.purchase_order_number?.toLowerCase().includes(w)||_.vendor_name?.toLowerCase().includes(w)||_.requester_name?.toLowerCase().includes(w)||_.project_vendor?.toLowerCase().includes(w)?!0:_.items&&_.items.length>0?_.items.some(P=>P.item_name&&P.item_name.toLowerCase().includes(w)||P.specification&&P.specification.toLowerCase().includes(w)):!1)},[$,G]),O=n.useMemo(()=>[...x].sort((w,_)=>{const P=w.request_date?new Date(w.request_date).getTime():0;return(_.request_date?new Date(_.request_date).getTime():0)-P}),[x]),H=n.useMemo(()=>{const _=ne.filter(z=>{const Q=z.request_date?z.request_date.split("T")[0]:"",le=!M||Q>=M,$e=!V||Q<=V;return le&&$e}),P=z=>new Set(z.map(Q=>Q.purchase_order_number)).size,B=z=>{if(z==="purchase")return W||T?_:_.filter(le=>le.requester_name===r);const Q=se(z);return Q==="all"||Q==="전체"?_:_.filter(le=>le.requester_name===Q)},ve=B("pending"),ye=B("purchase"),Ce=B("receipt"),De=B("done"),xr=ve.filter(z=>["pending","대기","",null].includes(z.final_manager_status)),gr=ye.filter(z=>{const Q=z.payment_category==="구매 요청",le=!z.is_payment_completed;if(!Q||!le)return!1;const $e=(z.progress_type||"").includes("선진행"),hr=(z.progress_type||"").includes("일반"),vr=z.final_manager_status==="approved";return $e||hr&&vr}),fr=Ce.filter(z=>{const Q=!z.is_received,le=(z.progress_type||"").includes("선진행")||z.final_manager_status==="approved";return Q&&le});return{pending:P(xr),purchase:P(gr),receipt:P(fr),done:P(De)}},[ne,M,V,ae,r,se,W,T]);return n.useEffect(()=>{(async()=>{const{data:{user:w}}=await d.auth.getUser();if(!w)return;const{data:_}=await d.from("user_preferences").select("period_start, period_end").eq("user_id",w.id).single();if(_){const P=_.period_start?new Date(_.period_start).toISOString().split("T")[0]:L,B=_.period_end?new Date(_.period_end).toISOString().split("T")[0]:q;ee(P),K(B)}})()},[]),n.useEffect(()=>{(async()=>{const{data:{user:w}}=await d.auth.getUser();w&&(!M||!V||await d.from("user_preferences").upsert({user_id:w.id,period_start:M,period_end:V,updated_at:new Date().toISOString()}))})()},[M,V]),{activeTab:u,searchTerm:j,vendorFilter:N,dateFromFilter:M,dateToFilter:V,selectedEmployee:C,purchaseNumberFilter:F,itemNameFilter:o,specificationFilter:S,approvalStatusFilter:R,remarkFilter:g,setActiveTab:p,setSearchTerm:i,setVendorFilter:k,setDateFromFilter:ee,setDateToFilter:K,setSelectedEmployee:E,setPurchaseNumberFilter:U,setItemNameFilter:h,setSpecificationFilter:I,setApprovalStatusFilter:f,setRemarkFilter:D,filteredPurchases:O,tabCounts:H}},Zr=t=>{if(!t)return"-";const s=new Date(t);return`${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`},Qr=t=>{if(!t.items||t.items.length===0)return{received:0,total:0,percentage:0};const s=t.items.length,r=t.items.filter(l=>l.is_received||l.delivery_status==="received").length,a=s>0?Math.round(r/s*100):0;return{received:r,total:s,percentage:a}},xt=n.memo(({purchase:t})=>{const s=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",r={completed:{text:"입고완료",className:"bg-green-100 text-green-800"},inProgress:{text:"구매진행",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"반려",className:"bg-red-100 text-red-800"},pending:{text:"승인대기",className:"bg-yellow-100 text-yellow-800"}},{text:a,className:l}=r[s];return e.jsx(Y,{className:`${l} text-xs`,children:a})});xt.displayName="StatusBadge";const gt=n.memo(({purchase:t,onClick:s})=>{const r=Qr(t),a=t.progress_type==="선진행"||t.progress_type?.includes("선진행");return e.jsxs("div",{className:`bg-white rounded-lg border p-4 space-y-3 cursor-pointer transition-all hover:shadow-md ${a?"border-red-400 bg-red-50 hover:bg-red-100":"hover:bg-gray-50"}`,onClick:()=>s(t),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a?e.jsx(Y,{className:"bg-red-500 text-white font-bold text-xs px-2 py-0.5",children:"선진행"}):e.jsx(Y,{className:"bg-gray-200 text-gray-700 text-xs px-2 py-0.5",children:"일반"}),e.jsx("span",{className:"font-semibold text-sm text-gray-900",children:t.purchase_order_number||"-"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Zr(t.request_date)," 요청"]})]}),e.jsx(xt,{purchase:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"요청자"}),e.jsx("span",{className:"font-medium",children:t.requester_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"업체"}),e.jsx("span",{className:"font-medium",children:t.vendor_name})]}),t.project_vendor&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJ업체"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_vendor})]}),t.project_item&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJ ITEM"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_item})]}),t.sales_order_number&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"수주번호"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.sales_order_number})]}),t.item_name&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"품목"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.item_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"금액"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[(t.amount_value||t.total_amount)?.toLocaleString()," ",t.currency]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"입고현황"}),e.jsxs("span",{className:"text-gray-700",children:[r.received,"/",r.total," (",r.percentage,"%)"]})]}),e.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${r.percentage===100?"bg-green-500":r.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${r.percentage}%`}})})]}),t.is_payment_completed!==void 0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"결제"}),t.is_payment_completed?e.jsx(Y,{className:"bg-green-100 text-green-800 text-xs",children:"완료"}):e.jsx(Y,{className:"bg-gray-100 text-gray-800 text-xs",children:"대기"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex items-center justify-center text-xs text-gray-500",children:[e.jsx(Dr,{className:"w-3 h-3 mr-1"}),"클릭하여 상세보기"]})})]})});gt.displayName="MobilePurchaseCard";function Ke(t){if(!t)return"";const s=new Date(t);return isNaN(s.getTime())?t:`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`}function Re(t){return t?["KRW","원","₩"].includes(t)?"₩":["USD","$","달러"].includes(t)?"$":["EUR","€"].includes(t)?"€":["JPY","엔","¥"].includes(t)||["CNY","위안","元"].includes(t)?"¥":t:""}async function ea(t){const s=await et(()=>import("./exceljs.min-C8vExLsi.js").then(o=>o.e),__vite__mapDeps([0,1,2])),r=new s.default.Workbook,a=r.addWorksheet("발주서",{pageSetup:{paperSize:9,orientation:"portrait",fitToPage:!0,fitToWidth:1,fitToHeight:1,horizontalCentered:!0,verticalCentered:!0,margins:{left:.3,right:.3,top:.5,bottom:.5,header:.2,footer:.2}}});a.getRow(1).height=29.8;for(let o=2;o<=60;o++)a.getRow(o).height=15.75;a.getRow(1).eachCell(o=>{o.font={...o.font||{},name:"맑은 고딕",size:20}});for(let o=2;o<=60;o++)a.getRow(o).eachCell(h=>{h.font={...h.font||{},name:"맑은 고딕",size:11}});a.mergeCells("A1:G1"),a.mergeCells("A2:B2"),a.mergeCells("C2:D2"),a.mergeCells("F2:G2"),a.mergeCells("A3:B3"),a.mergeCells("C3:D3"),a.mergeCells("F3:G3"),a.mergeCells("A4:B4"),a.mergeCells("C4:D4"),a.mergeCells("F4:G4"),a.mergeCells("A5:B5"),a.mergeCells("C5:D5"),a.mergeCells("F5:G5"),a.mergeCells("A6:B6"),a.mergeCells("C6:D6"),a.mergeCells("F6:G6"),a.mergeCells("A7:B7"),a.mergeCells("C7:D7"),a.mergeCells("F7:G7");try{const h=await(await fetch("/logo_KOR.png")).arrayBuffer(),S=r.addImage({buffer:h,extension:"png"}),I=a.getColumn("D").width||22,R=Math.max(1,I*7.2*.58)+4,f=34,g=3.5-.5,D=.5-.2;a.addImage(S,{tl:{col:g,row:D},ext:{width:R,height:f}})}catch(o){console.warn("Excel 생성 중 경고:",o)}a.getCell("D1").value="                발 주 서",a.getCell("D1").alignment={horizontal:"left",vertical:"middle",indent:1},a.getCell("D1").font={bold:!0,size:20},a.getCell("A2").value="업   체   명",a.getCell("A2").font={bold:!0},a.getCell("A3").value="담   당   자",a.getCell("A3").font={bold:!0},a.getCell("A4").value="청   구   일",a.getCell("A4").font={bold:!0},a.getCell("A5").value="TEL.",a.getCell("A5").font={bold:!0},a.getCell("A6").value="FAX.",a.getCell("A6").font={bold:!0},a.getCell("A7").value="입고요청일",a.getCell("A7").font={bold:!0},a.getCell("E2").value="구매요청자",a.getCell("E2").font={bold:!0},a.getCell("E3").value="주         소",a.getCell("E3").font={bold:!0},a.getCell("E4").value="발 주 번 호",a.getCell("E4").font={bold:!0},a.getCell("E5").value="TEL.",a.getCell("E5").font={bold:!0},a.getCell("E6").value="FAX.",a.getCell("E6").font={bold:!0},a.getCell("E7").value="지출 예정일",a.getCell("E7").font={bold:!0},a.getCell("F7").value=t.vendor_payment_schedule||"",a.getCell("C2").value=t.vendor_name,a.getCell("C3").value=t.vendor_contact_name||"",a.getCell("C4").value=Ke(t.request_date),a.getCell("C5").value=t.vendor_phone||"",a.getCell("C6").value=t.vendor_fax||"",a.getCell("C7").value=Ke(t.delivery_request_date),a.getCell("F2").value=t.requester_name,a.getCell("F3").value="대구광역시 달서구 성서공단북로305",a.getCell("F4").value=t.purchase_order_number,a.getCell("F5").value="(053) 626-7805",a.getCell("F6").value="(053) 657-7905",a.getCell("F5").alignment={horizontal:"center",vertical:"middle"},a.getCell("F6").alignment={horizontal:"center",vertical:"middle"};const l=["No","품명","규격","수량","단가","금액","비고"];for(let o=0;o<l.length;o++)a.getCell(String.fromCharCode(65+o)+"8").value=l[o],a.getCell(String.fromCharCode(65+o)+"8").font={bold:!0},o===6&&(a.getCell("G8").alignment={horizontal:"center",vertical:"middle"});const d=9,u=45,p=[...t.items].sort((o,h)=>o.line_number-h.line_number),j=p.length,i=d+Math.max(j,u);for(let o=0;o<p.length;o++){const h=p[o],S=d+o;a.getCell("A"+S).value=h.line_number;const I=a.getCell("B"+S);I.value=h.item_name,I.alignment={horizontal:"left",vertical:"middle"},a.getCell("C"+S).value=h.specification,a.getCell("C"+S).alignment={horizontal:"left",vertical:"middle"},a.getCell("D"+S).value=h.quantity;const R=Re(h.currency),f=h.unit_price_value!==void 0&&h.unit_price_value!==null?`${h.unit_price_value.toLocaleString()} ${R}`.trim():"";a.getCell("E"+S).value=f,a.getCell("E"+S).alignment={horizontal:"right",vertical:"middle"};const g=Re(h.currency),D=h.amount_value!==void 0&&h.amount_value!==null?`${h.amount_value.toLocaleString()} ${g}`.trim():"";a.getCell("F"+S).value=D,a.getCell("F"+S).alignment={horizontal:"right",vertical:"middle"};const y=a.getCell("G"+S);y.value=h.remark!==void 0&&h.remark!==null?String(h.remark):"",y.alignment={horizontal:"left",vertical:"middle",wrapText:!1,shrinkToFit:!0}}for(let o=j;o<u;o++){const h=d+o;for(let S=0;S<7;S++)a.getCell(String.fromCharCode(65+S)+h).value=""}a.mergeCells(`A${i}:E${i}`),a.getCell("A"+i).value="합계",a.getCell("A"+i).font={bold:!0};const N=Re(t.items[0]?.currency),k=t.items.reduce((o,h)=>o+(h.amount_value||0),0);a.getCell("F"+i).value=`${k.toLocaleString()} ${N}`.trim(),a.getCell("F"+i).alignment={horizontal:"right",vertical:"middle"};const C=i;for(let o=1;o<=C;o++)for(let h=1;h<=7;h++){const I=String.fromCharCode(64+h)+o,R=a.getCell(I),f=h===5||h===6,g=h===3,D=o>=d&&o<i;f&&(D||o===i)||g&&D||(R.alignment={horizontal:"center",vertical:"middle"}),R.border={top:{style:o===1||o===2||o===8||o===i?"medium":"thin"},left:{style:h===1?"medium":"thin"},right:{style:h===7?"medium":"thin"},bottom:{style:o===8||o===i||o===C?"medium":"thin"}}}for(let o=0;o<j;o++){const h=d+o;a.getCell("C"+h).alignment={horizontal:"left",vertical:"middle"}}for(let o=2;o<=7;o++)a.getCell("B"+o).border={...a.getCell("B"+o).border,right:{style:"medium"}},a.getCell("D"+o).border={...a.getCell("D"+o).border,right:{style:"medium"}},o<=6&&(a.getCell("E"+o).border={...a.getCell("E"+o).border,right:{style:"medium"}});a.getCell("E7").border={...a.getCell("E7").border,top:{style:"thin"},right:{style:"medium"}},a.getCell("G7").border={...a.getCell("G7").border,top:{style:"thin"}};for(let o=1;o<=7;o++){const h=a.getCell("A"+o).border||{};a.getCell("A"+o).border={...h,left:{style:"medium"}}}const E=a.getCell("A"+i).border||{};a.getCell("A"+i).border={...E,left:{style:"medium"}},Object.entries({A:4.7,B:23,C:30,D:11,E:15,F:16,G:37}).forEach(([o,h])=>{a.getColumn(o).width=h}),a.getRow(1).height=29.8,a.getRow(1).eachCell(o=>{o.font={...o.font||{},name:"맑은 고딕",size:20}});for(let o=2;o<=C;o++){const h=a.getRow(o);h.height=15.75,h.eachCell(S=>{S.font={...S.font||{},name:"맑은 고딕",size:11}})}for(let o=9;o<=C;o++)a.getCell("G"+o).alignment={horizontal:"left",vertical:"middle",wrapText:!1,shrinkToFit:!0},a.getCell("B"+o).alignment={horizontal:"left",vertical:"middle"};const U=await r.xlsx.writeBuffer();return new Blob([U],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}var ft="AlertDialog",[ta,ws]=tt(ft,[ot]),oe=ot(),ht=t=>{const{__scopeAlertDialog:s,...r}=t,a=oe(s);return e.jsx(it,{...a,...r,modal:!0})};ht.displayName=ft;var ra="AlertDialogTrigger",aa=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,l=oe(r);return e.jsx(Or,{...l,...a,ref:s})});aa.displayName=ra;var sa="AlertDialogPortal",vt=t=>{const{__scopeAlertDialog:s,...r}=t,a=oe(s);return e.jsx(ct,{...a,...r})};vt.displayName=sa;var na="AlertDialogOverlay",yt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,l=oe(r);return e.jsx(ut,{...l,...a,ref:s})});yt.displayName=na;var fe="AlertDialogContent",[la,oa]=ta(fe),ia=yr("AlertDialogContent"),_t=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,children:a,...l}=t,d=oe(r),u=n.useRef(null),p=ke(s,u),j=n.useRef(null);return e.jsx(Rr,{contentName:fe,titleName:wt,docsSlug:"alert-dialog",children:e.jsx(la,{scope:r,cancelRef:j,children:e.jsxs(dt,{role:"alertdialog",...d,...l,ref:p,onOpenAutoFocus:ge(l.onOpenAutoFocus,i=>{i.preventDefault(),j.current?.focus({preventScroll:!0})}),onPointerDownOutside:i=>i.preventDefault(),onInteractOutside:i=>i.preventDefault(),children:[e.jsx(ia,{children:a}),e.jsx(da,{contentRef:u})]})})})});_t.displayName=fe;var wt="AlertDialogTitle",jt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,l=oe(r);return e.jsx(Fr,{...l,...a,ref:s})});jt.displayName=wt;var bt="AlertDialogDescription",Nt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,l=oe(r);return e.jsx(Ir,{...l,...a,ref:s})});Nt.displayName=bt;var ca="AlertDialogAction",Ct=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,l=oe(r);return e.jsx(mt,{...l,...a,ref:s})});Ct.displayName=ca;var St="AlertDialogCancel",kt=n.forwardRef((t,s)=>{const{__scopeAlertDialog:r,...a}=t,{cancelRef:l}=oa(St,r),d=oe(r),u=ke(s,l);return e.jsx(mt,{...d,...a,ref:u})});kt.displayName=St;var da=({contentRef:t})=>{const s=`\`${fe}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${fe}\` by passing a \`${bt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${fe}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return n.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(s)},[s,t]),null},ma=ht,ua=vt,Pt=yt,At=_t,Dt=Ct,$t=kt,Et=jt,Rt=Nt;const pa=ma,xa=ua,Ft=n.forwardRef(({className:t,...s},r)=>e.jsx(Pt,{className:J("fixed inset-0 z-50 bg-black/40 backdrop-blur-sm","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s,ref:r}));Ft.displayName=Pt.displayName;const It=n.forwardRef(({className:t,...s},r)=>e.jsxs(xa,{children:[e.jsx(Ft,{}),e.jsx(At,{ref:r,className:J("fixed left-[50%] top-[50%] z-50","w-full max-w-md translate-x-[-50%] translate-y-[-50%]","grid gap-4 bg-white border border-gray-200","rounded-lg p-6 shadow-professional-xl","duration-200","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]","data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",t),...s})]}));It.displayName=At.displayName;const Ot=({className:t,...s})=>e.jsx("div",{className:J("flex flex-col space-y-2 text-left",t),...s});Ot.displayName="AlertDialogHeader";const qt=({className:t,...s})=>e.jsx("div",{className:J("flex flex-col-reverse sm:flex-row sm:justify-end gap-3",t),...s});qt.displayName="AlertDialogFooter";const Mt=n.forwardRef(({className:t,...s},r)=>e.jsx(Et,{ref:r,className:J("text-lg font-semibold text-gray-800 tracking-tight",t),...s}));Mt.displayName=Et.displayName;const Tt=n.forwardRef(({className:t,...s},r)=>e.jsx(Rt,{ref:r,className:J("text-sm text-gray-600",t),...s}));Tt.displayName=Rt.displayName;const Lt=n.forwardRef(({className:t,...s},r)=>e.jsx(Dt,{ref:r,className:J(rt(),t),...s}));Lt.displayName=Dt.displayName;const Bt=n.forwardRef(({className:t,...s},r)=>e.jsx($t,{ref:r,className:J(rt({variant:"outline"}),"mt-2 sm:mt-0",t),...s}));Bt.displayName=$t.displayName;const Te=n.memo(({purchase:t})=>{const s=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",r={completed:{text:"입고완료",className:"bg-green-100 text-green-800"},inProgress:{text:"구매진행",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"반려",className:"bg-red-100 text-red-800"},pending:{text:"승인대기",className:"bg-yellow-100 text-yellow-800"}},{text:a,className:l}=r[s];return e.jsx(Y,{className:l,children:a})});Te.displayName="StatusBadge";const m={approvalStatus:"text-center w-20 min-w-[70px]",purchaseOrderNumber:"pl-2 w-32 min-w-[110px] sm:w-36 lg:w-40 xl:w-44",paymentCategory:"text-center w-20 min-w-[70px]",requesterName:"w-20 min-w-[60px]",requestDate:"w-20 min-w-[70px] lg:w-24",vendorName:"w-28 min-w-[90px] lg:w-32",contactName:"w-20 min-w-[60px]",deliveryRequestDate:"w-20 min-w-[70px] lg:w-24",itemName:"w-36 min-w-[120px] lg:w-44 xl:w-48",specification:"w-40 min-w-[140px] lg:w-48 xl:w-52",quantity:"text-center w-14 min-w-[45px]",unitPrice:"text-right w-20 min-w-[70px]",amount:"text-right w-24 min-w-[80px]",remark:"min-w-[150px] lg:min-w-[200px]",paymentSchedule:"w-20 min-w-[70px]",projectVendor:"w-28 min-w-[90px] lg:w-32",salesOrderNumber:"w-24 min-w-[80px] lg:w-28",projectItem:"w-28 min-w-[90px] lg:w-32",receiptProgress:"text-center w-20 min-w-[70px]",status:"text-center w-20 min-w-[70px]",receipt:"text-center w-20 min-w-[70px]",paymentStatus:"text-center w-16 min-w-[60px]",link:"w-20 min-w-[70px]"},zt=n.memo(({purchase:t})=>{const s=t.middle_manager_status==="approved",r=t.middle_manager_status==="rejected",a=t.final_manager_status==="approved",l=t.final_manager_status==="rejected";return r||l?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"})}),e.jsx(Y,{className:"bg-red-100 text-red-800 text-[11px] font-medium px-1.5 py-0",children:"반려"})]}):s&&a?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})}),e.jsx(Y,{className:"bg-green-100 text-green-800 text-[11px] font-medium px-1.5 py-0",children:"승인완료"})]}):s&&!a&&!l?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(Y,{className:"bg-yellow-100 text-yellow-800 text-[11px] font-medium px-1.5 py-0",children:"1차 승인"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(Y,{className:"bg-gray-100 text-gray-600 text-[11px] font-medium px-1.5 py-0",children:"승인대기"})]})});zt.displayName="ApprovalStatusBadge";const ga=t=>{if(t.is_received)return{received:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{received:0,total:1,percentage:0};const s=t.items.length,r=t.items.filter(l=>l.is_received===!0||l.delivery_status==="received"||l.delivery_status==="completed").length,a=s>0?Math.round(r/s*100):0;return{received:r,total:s,percentage:a}},fa=t=>{if(t.is_payment_completed)return{completed:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{completed:0,total:1,percentage:0};const s=t.items.length,r=t.items.filter(l=>l.is_payment_completed===!0).length,a=s>0?Math.round(r/s*100):0;return{completed:r,total:s,percentage:a}},Ye=t=>{if(!t)return"-";const s=new Date(t);return`${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`},ha=n.memo(({type:t})=>t==="선진행"||t?.includes("선진행")?e.jsx(Y,{className:"bg-red-500 text-white font-bold text-[11px] px-2 py-0.5",children:"선진행"}):e.jsx(Y,{className:"bg-gray-200 text-gray-700 text-[11px] px-2 py-0.5",children:"일반"}));ha.displayName="ProgressTypeBadge";const Vt=n.memo(({purchase:t,onClick:s,activeTab:r,isLeadBuyer:a,onPaymentComplete:l,onReceiptComplete:d,onExcelDownload:u})=>{const p=ga(t),j=fa(t),i=t.progress_type==="선진행"||t.progress_type?.includes("선진행");return e.jsxs("tr",{className:`border-b hover:bg-gray-100 cursor-pointer transition-colors ${i?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>s(t),children:[r==="pending"&&e.jsx("td",{className:`px-2 py-1.5 whitespace-nowrap ${m.approvalStatus}`,children:e.jsx(zt,{purchase:t})}),r==="purchase"&&e.jsx("td",{className:`px-2 py-1.5 ${m.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${j.percentage===100?"bg-blue-500":j.percentage>0?"bg-blue-400":"bg-gray-300"}`,style:{width:`${j.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[j.percentage,"%"]})]})}),r==="receipt"&&e.jsx("td",{className:`px-2 py-1.5 ${m.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${p.percentage===100?"bg-green-500":p.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${p.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[p.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 font-medium text-[11px] whitespace-nowrap ${m.purchaseOrderNumber}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[u&&e.jsx("img",{src:"/excels-icon.svg",alt:"엑셀 다운로드",width:"16",height:"16",className:`inline-block align-middle transition-transform p-0.5 rounded
                ${t.is_po_download?"border border-gray-400":""}
                ${t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?t.is_po_download?"cursor-pointer":"cursor-pointer hover:scale-110":"opacity-40 grayscale cursor-not-allowed"}`,onClick:async N=>{(t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved")&&(N.stopPropagation(),await u(t))},style:{pointerEvents:t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"auto":"none"},title:t.is_po_download?"다운로드 완료":"엑셀 발주서 다운로드"}),e.jsx("span",{className:"block truncate",title:t.purchase_order_number||"",children:t.purchase_order_number||"-"})]})}),(r==="pending"||r==="receipt"||r==="done"||!r)&&e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.paymentCategory}`,children:e.jsx(Y,{className:`text-[11px] ${t.payment_category==="구매 요청"?"bg-blue-100 text-blue-800":t.payment_category==="발주"?"bg-green-100 text-green-800":t.payment_category==="경비 청구"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.payment_category==="구매 요청"?"구매요청":t.payment_category==="발주"?"발주요청":t.payment_category||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.requesterName}`,children:e.jsx("span",{className:"block truncate",title:t.requester_name||"",children:t.requester_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.requestDate}`,children:Ye(t.request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.vendorName}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_name||"",children:t.vendor_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.contactName}`,children:e.jsx("span",{className:"block truncate",title:t.contact_name||"",children:t.contact_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.deliveryRequestDate}`,children:Ye(t.delivery_request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.itemName}`,children:e.jsx("span",{className:"block truncate",title:t.item_name||"",children:t.item_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.specification}`,children:e.jsx("span",{className:"block truncate",title:t.specification||"",children:t.specification||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.quantity}`,children:t.quantity||0}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.unitPrice}`,children:t.unit_price_value?.toLocaleString()||0}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] font-medium whitespace-nowrap ${m.amount}`,children:t.amount_value?.toLocaleString()||t.total_amount?.toLocaleString()||0}),r==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})})]}),r==="purchase"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"링크 보기"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),r==="receipt"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),(r==="done"||!r)&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"링크 보기"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${m.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${m.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})}),e.jsx("td",{className:`px-2 py-1.5 ${m.status}`,children:e.jsx(Te,{purchase:t})}),e.jsx("td",{className:`px-2 py-1.5 ${m.receipt}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${p.percentage===100?"bg-green-500":p.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${p.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[p.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 ${m.paymentStatus}`,children:t.is_payment_completed?e.jsx(Y,{className:"bg-green-100 text-green-800 text-[11px]",children:"완료"}):e.jsx(Y,{className:"bg-gray-100 text-gray-800 text-[11px]",children:"대기"})})]})]})});Vt.displayName="TableRow";const Gt=n.memo(({purchases:t,activeTab:s="done",currentUserRoles:r=[],onRefresh:a,onPaymentComplete:l,onReceiptComplete:d})=>{const[u,p]=n.useState(null),[j,i]=n.useState(!1),[N,k]=n.useState(!1),[C,E]=n.useState(null),F=Se(),U=r&&(r.includes("raw_material_manager")||r.includes("consumable_manager")||r.includes("purchase_manager")||r.includes("app_admin"));r.includes("final_approver")||r.includes("app_admin")||r.includes("ceo");const o=f=>{p(f.id),i(!0)},h=()=>{i(!1),p(null)},S=async f=>{try{const{data:g,error:D}=await F.from("purchase_requests").select("*").eq("purchase_order_number",f.purchase_order_number).single();if(D||!g){te.error("해당 발주요청번호의 데이터를 찾을 수 없습니다.");return}const{data:y,error:L}=await F.from("purchase_request_items").select("*").eq("purchase_order_number",f.purchase_order_number).order("line_number");if(L||!y||y.length===0){te.error("해당 발주요청번호의 품목 데이터를 찾을 수 없습니다.");return}const q={vendor_name:f.vendor_name,vendor_phone:"",vendor_fax:"",vendor_contact_name:"",vendor_payment_schedule:""};try{const T=g.vendor_id||f.vendor_id,Z=g.contact_id||f.contact_id;if(T){const{data:W}=await F.from("vendors").select("vendor_phone, vendor_fax, vendor_payment_schedule").eq("id",T).single();W&&(q.vendor_phone=W.vendor_phone||"",q.vendor_fax=W.vendor_fax||"",q.vendor_payment_schedule=W.vendor_payment_schedule||"")}if(Z){const{data:W}=await F.from("vendor_contacts").select("contact_name, contact_phone, contact_email").eq("id",Z).single();W&&(q.vendor_contact_name=W.contact_name||"")}}catch{}const M={purchase_order_number:g.purchase_order_number||"",request_date:g.request_date,delivery_request_date:g.delivery_request_date,requester_name:g.requester_name,vendor_name:q.vendor_name||"",vendor_contact_name:q.vendor_contact_name,vendor_phone:q.vendor_phone,vendor_fax:q.vendor_fax,project_vendor:g.project_vendor,sales_order_number:g.sales_order_number,project_item:g.project_item,vendor_payment_schedule:q.vendor_payment_schedule,items:y.map(T=>({line_number:T.line_number,item_name:T.item_name,specification:T.specification,quantity:T.quantity,unit_price_value:T.unit_price_value,amount_value:T.amount_value,remark:T.remark,currency:g.currency||"KRW"}))},ee=await ea(M),V=`발주서_${M.vendor_name}_${M.purchase_order_number}.xlsx`,K=window.URL.createObjectURL(ee),G=document.createElement("a");G.href=K,G.download=V,document.body.appendChild(G),G.click(),document.body.removeChild(G),window.URL.revokeObjectURL(K),te.success("엑셀 파일이 다운로드되었습니다.");try{if(r&&r.includes("lead_buyer")){const{error:Z}=await F.from("purchase_requests").update({is_po_download:!0}).eq("purchase_order_number",f.purchase_order_number);Z||a?.()}}catch{}}catch{te.error("엑셀 다운로드에 실패했습니다.")}},I=async()=>{if(C){try{const{error:f}=await F.from("purchase_request_items").delete().eq("purchase_request_id",C.id);if(f)throw f;const{error:g}=await F.from("purchase_requests").delete().eq("id",C.id);if(g)throw g;te.success("발주요청 내역이 삭제되었습니다."),a?.()}catch{te.error("삭제 중 오류가 발생했습니다.")}k(!1),E(null)}},R=n.useMemo(()=>{if(s==="pending")return e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.approvalStatus}`,children:"승인상태"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.purchaseOrderNumber}`,children:"발주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.paymentCategory}`,children:"결제종류"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.requesterName}`,children:"요청자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.requestDate}`,children:"청구일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${m.vendorName}`,children:"업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.contactName}`,children:"담당자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.deliveryRequestDate}`,children:"입고요청일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${m.itemName}`,children:"품명"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${m.specification}`,children:"규격"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.quantity}`,children:"수량"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.unitPrice}`,children:"단가"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.amount}`,children:"금액"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.salesOrderNumber}`,children:"수주번호"})]})});const f=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.purchaseOrderNumber}`,children:"발주번호"}),(s==="receipt"||s==="done"||!s)&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.paymentCategory}`,children:"결제종류"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.requesterName}`,children:"요청자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.requestDate}`,children:"청구일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.vendorName}`,children:"업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.contactName}`,children:"담당자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.deliveryRequestDate}`,children:"입고요청일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${m.itemName}`,children:"품명"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${m.specification}`,children:"규격"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.quantity}`,children:"수량"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.unitPrice}`,children:"단가"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.amount}`,children:"금액"})]});let g=null;return s==="purchase"?g=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.link}`,children:"링크"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.paymentSchedule}`,children:"지출예정일"})]}):s==="receipt"?g=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.salesOrderNumber}`,children:"수주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.paymentSchedule}`,children:"지출예정일"})]}):g=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.link}`,children:"링크"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.salesOrderNumber}`,children:"수주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${m.paymentSchedule}`,children:"지출예정일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.status}`,children:"상태"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.receipt}`,children:"입고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.paymentStatus}`,children:"결제"})]}),e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[s==="purchase"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.receiptProgress}`,children:"구매진행"}),s==="receipt"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${m.receiptProgress}`,children:"입고진행"}),f,g]})})},[s]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-fit",children:[R,e.jsx("tbody",{children:t.map(f=>e.jsx(Vt,{purchase:f,onClick:o,activeTab:s,isLeadBuyer:U,onPaymentComplete:l,onReceiptComplete:d,onExcelDownload:S},f.id))})]})})}),e.jsx("div",{className:"hidden sm:block md:hidden w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-[640px] text-[11px]",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-20 sm:w-24",children:"발주번호"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-16 sm:w-20",children:"요청자"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-24 sm:w-28",children:"업체"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 min-w-[100px]",children:"품명"}),e.jsx("th",{className:"text-right p-2 font-medium text-gray-900 w-20 sm:w-24",children:"금액"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-900 w-16 sm:w-20",children:"상태"})]})}),e.jsx("tbody",{children:t.map(f=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 cursor-pointer",onClick:()=>o(f),children:[e.jsx("td",{className:"p-2 font-medium",children:f.purchase_order_number||"-"}),e.jsx("td",{className:"p-2",children:f.requester_name}),e.jsx("td",{className:"p-2 truncate",title:f.vendor_name,children:f.vendor_name}),e.jsx("td",{className:"p-2 truncate",title:f.item_name,children:f.item_name||"-"}),e.jsx("td",{className:"p-2 text-right font-medium",children:f.amount_value?.toLocaleString()||f.total_amount?.toLocaleString()||0}),e.jsx("td",{className:"p-2 text-center",children:e.jsx(Te,{purchase:f})})]},f.id))})]})})}),e.jsx("div",{className:"sm:hidden space-y-3",children:t.map(f=>e.jsx(gt,{purchase:f,onClick:()=>o(f)},f.id))}),e.jsx(Pr,{purchaseId:u,isOpen:j,onClose:h,currentUserRoles:r,activeTab:s,onRefresh:a,onDelete:f=>{E(f),k(!0)}}),e.jsx(pa,{open:N,onOpenChange:k,children:e.jsxs(It,{children:[e.jsxs(Ot,{children:[e.jsx(Mt,{children:"발주요청 내역 삭제"}),e.jsxs(Tt,{children:["발주요청번호 ",C?.purchase_order_number,"를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."]})]}),e.jsxs(qt,{children:[e.jsx(Bt,{children:"취소"}),e.jsx(Lt,{onClick:I,className:"bg-red-600 hover:bg-red-700",children:"삭제"})]})]})})]})});Gt.displayName="FastPurchaseTable";var Xe=1,va=.9,ya=.8,_a=.17,Fe=.1,Ie=.999,wa=.9999,ja=.99,ba=/[\\\/_+.#"@\[\(\{&]/,Na=/[\\\/_+.#"@\[\(\{&]/g,Ca=/[\s-]/,Wt=/[\s-]/g;function qe(t,s,r,a,l,d,u){if(d===s.length)return l===t.length?Xe:ja;var p=`${l},${d}`;if(u[p]!==void 0)return u[p];for(var j=a.charAt(d),i=r.indexOf(j,l),N=0,k,C,E,F;i>=0;)k=qe(t,s,r,a,i+1,d+1,u),k>N&&(i===l?k*=Xe:ba.test(t.charAt(i-1))?(k*=ya,E=t.slice(l,i-1).match(Na),E&&l>0&&(k*=Math.pow(Ie,E.length))):Ca.test(t.charAt(i-1))?(k*=va,F=t.slice(l,i-1).match(Wt),F&&l>0&&(k*=Math.pow(Ie,F.length))):(k*=_a,l>0&&(k*=Math.pow(Ie,i-l))),t.charAt(i)!==s.charAt(d)&&(k*=wa)),(k<Fe&&r.charAt(i-1)===a.charAt(d+1)||a.charAt(d+1)===a.charAt(d)&&r.charAt(i-1)!==a.charAt(d))&&(C=qe(t,s,r,a,i+1,d+2,u),C*Fe>k&&(k=C*Fe)),k>N&&(N=k),i=r.indexOf(j,i+1);return u[p]=N,N}function Ue(t){return t.toLowerCase().replace(Wt," ")}function Sa(t,s,r){return t=r&&r.length>0?`${t+" "+r.join(" ")}`:t,qe(t,s,Ue(t),Ue(s),0,0,{})}var we='[cmdk-group=""]',Oe='[cmdk-group-items=""]',ka='[cmdk-group-heading=""]',Ht='[cmdk-item=""]',Ze=`${Ht}:not([aria-disabled="true"])`,Me="cmdk-item-select",pe="data-value",Pa=(t,s,r)=>Sa(t,s,r),Jt=n.createContext(void 0),be=()=>n.useContext(Jt),Kt=n.createContext(void 0),Le=()=>n.useContext(Kt),Yt=n.createContext(void 0),Xt=n.forwardRef((t,s)=>{let r=xe(()=>{var c,b;return{search:"",value:(b=(c=t.value)!=null?c:t.defaultValue)!=null?b:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),a=xe(()=>new Set),l=xe(()=>new Map),d=xe(()=>new Map),u=xe(()=>new Set),p=Ut(t),{label:j,children:i,value:N,onValueChange:k,filter:C,shouldFilter:E,loop:F,disablePointerSelection:U=!1,vimBindings:o=!0,...h}=t,S=de(),I=de(),R=de(),f=n.useRef(null),g=Ta();me(()=>{if(N!==void 0){let c=N.trim();r.current.value=c,D.emit()}},[N]),me(()=>{g(6,V)},[]);let D=n.useMemo(()=>({subscribe:c=>(u.current.add(c),()=>u.current.delete(c)),snapshot:()=>r.current,setState:(c,b,A)=>{var v,$,x,O;if(!Object.is(r.current[c],b)){if(r.current[c]=b,c==="search")ee(),q(),g(1,M);else if(c==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let H=document.getElementById(R);H?H.focus():(v=document.getElementById(S))==null||v.focus()}if(g(7,()=>{var H;r.current.selectedItemId=(H=K())==null?void 0:H.id,D.emit()}),A||g(5,V),(($=p.current)==null?void 0:$.value)!==void 0){let H=b??"";(O=(x=p.current).onValueChange)==null||O.call(x,H);return}}D.emit()}},emit:()=>{u.current.forEach(c=>c())}}),[]),y=n.useMemo(()=>({value:(c,b,A)=>{var v;b!==((v=d.current.get(c))==null?void 0:v.value)&&(d.current.set(c,{value:b,keywords:A}),r.current.filtered.items.set(c,L(b,A)),g(2,()=>{q(),D.emit()}))},item:(c,b)=>(a.current.add(c),b&&(l.current.has(b)?l.current.get(b).add(c):l.current.set(b,new Set([c]))),g(3,()=>{ee(),q(),r.current.value||M(),D.emit()}),()=>{d.current.delete(c),a.current.delete(c),r.current.filtered.items.delete(c);let A=K();g(4,()=>{ee(),A?.getAttribute("id")===c&&M(),D.emit()})}),group:c=>(l.current.has(c)||l.current.set(c,new Set),()=>{d.current.delete(c),l.current.delete(c)}),filter:()=>p.current.shouldFilter,label:j||t["aria-label"],getDisablePointerSelection:()=>p.current.disablePointerSelection,listId:S,inputId:R,labelId:I,listInnerRef:f}),[]);function L(c,b){var A,v;let $=(v=(A=p.current)==null?void 0:A.filter)!=null?v:Pa;return c?$(c,r.current.search,b):0}function q(){if(!r.current.search||p.current.shouldFilter===!1)return;let c=r.current.filtered.items,b=[];r.current.filtered.groups.forEach(v=>{let $=l.current.get(v),x=0;$.forEach(O=>{let H=c.get(O);x=Math.max(H,x)}),b.push([v,x])});let A=f.current;G().sort((v,$)=>{var x,O;let H=v.getAttribute("id"),w=$.getAttribute("id");return((x=c.get(w))!=null?x:0)-((O=c.get(H))!=null?O:0)}).forEach(v=>{let $=v.closest(Oe);$?$.appendChild(v.parentElement===$?v:v.closest(`${Oe} > *`)):A.appendChild(v.parentElement===A?v:v.closest(`${Oe} > *`))}),b.sort((v,$)=>$[1]-v[1]).forEach(v=>{var $;let x=($=f.current)==null?void 0:$.querySelector(`${we}[${pe}="${encodeURIComponent(v[0])}"]`);x?.parentElement.appendChild(x)})}function M(){let c=G().find(A=>A.getAttribute("aria-disabled")!=="true"),b=c?.getAttribute(pe);D.setState("value",b||void 0)}function ee(){var c,b,A,v;if(!r.current.search||p.current.shouldFilter===!1){r.current.filtered.count=a.current.size;return}r.current.filtered.groups=new Set;let $=0;for(let x of a.current){let O=(b=(c=d.current.get(x))==null?void 0:c.value)!=null?b:"",H=(v=(A=d.current.get(x))==null?void 0:A.keywords)!=null?v:[],w=L(O,H);r.current.filtered.items.set(x,w),w>0&&$++}for(let[x,O]of l.current)for(let H of O)if(r.current.filtered.items.get(H)>0){r.current.filtered.groups.add(x);break}r.current.filtered.count=$}function V(){var c,b,A;let v=K();v&&(((c=v.parentElement)==null?void 0:c.firstChild)===v&&((A=(b=v.closest(we))==null?void 0:b.querySelector(ka))==null||A.scrollIntoView({block:"nearest"})),v.scrollIntoView({block:"nearest"}))}function K(){var c;return(c=f.current)==null?void 0:c.querySelector(`${Ht}[aria-selected="true"]`)}function G(){var c;return Array.from(((c=f.current)==null?void 0:c.querySelectorAll(Ze))||[])}function T(c){let b=G()[c];b&&D.setState("value",b.getAttribute(pe))}function Z(c){var b;let A=K(),v=G(),$=v.findIndex(O=>O===A),x=v[$+c];(b=p.current)!=null&&b.loop&&(x=$+c<0?v[v.length-1]:$+c===v.length?v[0]:v[$+c]),x&&D.setState("value",x.getAttribute(pe))}function W(c){let b=K(),A=b?.closest(we),v;for(;A&&!v;)A=c>0?qa(A,we):Ma(A,we),v=A?.querySelector(Ze);v?D.setState("value",v.getAttribute(pe)):Z(c)}let ae=()=>T(G().length-1),se=c=>{c.preventDefault(),c.metaKey?ae():c.altKey?W(1):Z(1)},ne=c=>{c.preventDefault(),c.metaKey?T(0):c.altKey?W(-1):Z(-1)};return n.createElement(re.div,{ref:s,tabIndex:-1,...h,"cmdk-root":"",onKeyDown:c=>{var b;(b=h.onKeyDown)==null||b.call(h,c);let A=c.nativeEvent.isComposing||c.keyCode===229;if(!(c.defaultPrevented||A))switch(c.key){case"n":case"j":{o&&c.ctrlKey&&se(c);break}case"ArrowDown":{se(c);break}case"p":case"k":{o&&c.ctrlKey&&ne(c);break}case"ArrowUp":{ne(c);break}case"Home":{c.preventDefault(),T(0);break}case"End":{c.preventDefault(),ae();break}case"Enter":{c.preventDefault();let v=K();if(v){let $=new Event(Me);v.dispatchEvent($)}}}}},n.createElement("label",{"cmdk-label":"",htmlFor:y.inputId,id:y.labelId,style:Ba},j),Pe(t,c=>n.createElement(Kt.Provider,{value:D},n.createElement(Jt.Provider,{value:y},c))))}),Aa=n.forwardRef((t,s)=>{var r,a;let l=de(),d=n.useRef(null),u=n.useContext(Yt),p=be(),j=Ut(t),i=(a=(r=j.current)==null?void 0:r.forceMount)!=null?a:u?.forceMount;me(()=>{if(!i)return p.item(l,u?.id)},[i]);let N=Zt(l,d,[t.value,t.children,d],t.keywords),k=Le(),C=ie(g=>g.value&&g.value===N.current),E=ie(g=>i||p.filter()===!1?!0:g.search?g.filtered.items.get(l)>0:!0);n.useEffect(()=>{let g=d.current;if(!(!g||t.disabled))return g.addEventListener(Me,F),()=>g.removeEventListener(Me,F)},[E,t.onSelect,t.disabled]);function F(){var g,D;U(),(D=(g=j.current).onSelect)==null||D.call(g,N.current)}function U(){k.setState("value",N.current,!0)}if(!E)return null;let{disabled:o,value:h,onSelect:S,forceMount:I,keywords:R,...f}=t;return n.createElement(re.div,{ref:je(d,s),...f,id:l,"cmdk-item":"",role:"option","aria-disabled":!!o,"aria-selected":!!C,"data-disabled":!!o,"data-selected":!!C,onPointerMove:o||p.getDisablePointerSelection()?void 0:U,onClick:o?void 0:F},t.children)}),Da=n.forwardRef((t,s)=>{let{heading:r,children:a,forceMount:l,...d}=t,u=de(),p=n.useRef(null),j=n.useRef(null),i=de(),N=be(),k=ie(E=>l||N.filter()===!1?!0:E.search?E.filtered.groups.has(u):!0);me(()=>N.group(u),[]),Zt(u,p,[t.value,t.heading,j]);let C=n.useMemo(()=>({id:u,forceMount:l}),[l]);return n.createElement(re.div,{ref:je(p,s),...d,"cmdk-group":"",role:"presentation",hidden:k?void 0:!0},r&&n.createElement("div",{ref:j,"cmdk-group-heading":"","aria-hidden":!0,id:i},r),Pe(t,E=>n.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?i:void 0},n.createElement(Yt.Provider,{value:C},E))))}),$a=n.forwardRef((t,s)=>{let{alwaysRender:r,...a}=t,l=n.useRef(null),d=ie(u=>!u.search);return!r&&!d?null:n.createElement(re.div,{ref:je(l,s),...a,"cmdk-separator":"",role:"separator"})}),Ea=n.forwardRef((t,s)=>{let{onValueChange:r,...a}=t,l=t.value!=null,d=Le(),u=ie(i=>i.search),p=ie(i=>i.selectedItemId),j=be();return n.useEffect(()=>{t.value!=null&&d.setState("search",t.value)},[t.value]),n.createElement(re.input,{ref:s,...a,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":j.listId,"aria-labelledby":j.labelId,"aria-activedescendant":p,id:j.inputId,type:"text",value:l?t.value:u,onChange:i=>{l||d.setState("search",i.target.value),r?.(i.target.value)}})}),Ra=n.forwardRef((t,s)=>{let{children:r,label:a="Suggestions",...l}=t,d=n.useRef(null),u=n.useRef(null),p=ie(i=>i.selectedItemId),j=be();return n.useEffect(()=>{if(u.current&&d.current){let i=u.current,N=d.current,k,C=new ResizeObserver(()=>{k=requestAnimationFrame(()=>{let E=i.offsetHeight;N.style.setProperty("--cmdk-list-height",E.toFixed(1)+"px")})});return C.observe(i),()=>{cancelAnimationFrame(k),C.unobserve(i)}}},[]),n.createElement(re.div,{ref:je(d,s),...l,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":p,"aria-label":a,id:j.listId},Pe(t,i=>n.createElement("div",{ref:je(u,j.listInnerRef),"cmdk-list-sizer":""},i)))}),Fa=n.forwardRef((t,s)=>{let{open:r,onOpenChange:a,overlayClassName:l,contentClassName:d,container:u,...p}=t;return n.createElement(it,{open:r,onOpenChange:a},n.createElement(ct,{container:u},n.createElement(ut,{"cmdk-overlay":"",className:l}),n.createElement(dt,{"aria-label":t.label,"cmdk-dialog":"",className:d},n.createElement(Xt,{ref:s,...p}))))}),Ia=n.forwardRef((t,s)=>ie(r=>r.filtered.count===0)?n.createElement(re.div,{ref:s,...t,"cmdk-empty":"",role:"presentation"}):null),Oa=n.forwardRef((t,s)=>{let{progress:r,children:a,label:l="Loading...",...d}=t;return n.createElement(re.div,{ref:s,...d,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":l},Pe(t,u=>n.createElement("div",{"aria-hidden":!0},u)))}),X=Object.assign(Xt,{List:Ra,Item:Aa,Input:Ea,Group:Da,Separator:$a,Dialog:Fa,Empty:Ia,Loading:Oa});function qa(t,s){let r=t.nextElementSibling;for(;r;){if(r.matches(s))return r;r=r.nextElementSibling}}function Ma(t,s){let r=t.previousElementSibling;for(;r;){if(r.matches(s))return r;r=r.previousElementSibling}}function Ut(t){let s=n.useRef(t);return me(()=>{s.current=t}),s}var me=typeof window>"u"?n.useEffect:n.useLayoutEffect;function xe(t){let s=n.useRef();return s.current===void 0&&(s.current=t()),s}function ie(t){let s=Le(),r=()=>t(s.snapshot());return n.useSyncExternalStore(s.subscribe,r,r)}function Zt(t,s,r,a=[]){let l=n.useRef(),d=be();return me(()=>{var u;let p=(()=>{var i;for(let N of r){if(typeof N=="string")return N.trim();if(typeof N=="object"&&"current"in N)return N.current?(i=N.current.textContent)==null?void 0:i.trim():l.current}})(),j=a.map(i=>i.trim());d.value(t,p,j),(u=s.current)==null||u.setAttribute(pe,p),l.current=p}),l}var Ta=()=>{let[t,s]=n.useState(),r=xe(()=>new Map);return me(()=>{r.current.forEach(a=>a()),r.current=new Map},[t]),(a,l)=>{r.current.set(a,l),s({})}};function La(t){let s=t.type;return typeof s=="function"?s(t.props):"render"in s?s.render(t.props):t}function Pe({asChild:t,children:s},r){return t&&n.isValidElement(s)?n.cloneElement(La(s),{ref:s.ref},r(s.props.children)):r(s)}var Ba={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Qt=n.forwardRef(({className:t,...s},r)=>e.jsx(X,{ref:r,className:J("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...s}));Qt.displayName=X.displayName;const er=n.forwardRef(({className:t,...s},r)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(pt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(X.Input,{ref:r,className:J("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...s})]}));er.displayName=X.Input.displayName;const za=n.forwardRef(({className:t,...s},r)=>e.jsx(X.List,{ref:r,className:J("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...s}));za.displayName=X.List.displayName;const tr=n.forwardRef((t,s)=>e.jsx(X.Empty,{ref:s,className:"py-6 text-center text-sm",...t}));tr.displayName=X.Empty.displayName;const rr=n.forwardRef(({className:t,...s},r)=>e.jsx(X.Group,{ref:r,className:J("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...s}));rr.displayName=X.Group.displayName;const Va=n.forwardRef(({className:t,...s},r)=>e.jsx(X.Separator,{ref:r,className:J("-mx-1 h-px bg-border",t),...s}));Va.displayName=X.Separator.displayName;const ar=n.forwardRef(({className:t,...s},r)=>e.jsx(X.Item,{ref:r,className:J("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...s}));ar.displayName=X.Item.displayName;var Ae="Popover",[sr,js]=tt(Ae,[at]),Ne=at(),[Ga,ce]=sr(Ae),nr=t=>{const{__scopePopover:s,children:r,open:a,defaultOpen:l,onOpenChange:d,modal:u=!1}=t,p=Ne(s),j=n.useRef(null),[i,N]=n.useState(!1),[k,C]=_r({prop:a,defaultProp:l??!1,onChange:d,caller:Ae});return e.jsx(wr,{...p,children:e.jsx(Ga,{scope:s,contentId:de(),triggerRef:j,open:k,onOpenChange:C,onOpenToggle:n.useCallback(()=>C(E=>!E),[C]),hasCustomAnchor:i,onCustomAnchorAdd:n.useCallback(()=>N(!0),[]),onCustomAnchorRemove:n.useCallback(()=>N(!1),[]),modal:u,children:r})})};nr.displayName=Ae;var lr="PopoverAnchor",Wa=n.forwardRef((t,s)=>{const{__scopePopover:r,...a}=t,l=ce(lr,r),d=Ne(r),{onCustomAnchorAdd:u,onCustomAnchorRemove:p}=l;return n.useEffect(()=>(u(),()=>p()),[u,p]),e.jsx(st,{...d,...a,ref:s})});Wa.displayName=lr;var or="PopoverTrigger",ir=n.forwardRef((t,s)=>{const{__scopePopover:r,...a}=t,l=ce(or,r),d=Ne(r),u=ke(s,l.triggerRef),p=e.jsx(re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":pr(l.open),...a,ref:u,onClick:ge(t.onClick,l.onOpenToggle)});return l.hasCustomAnchor?p:e.jsx(st,{asChild:!0,...d,children:p})});ir.displayName=or;var Be="PopoverPortal",[Ha,Ja]=sr(Be,{forceMount:void 0}),cr=t=>{const{__scopePopover:s,forceMount:r,children:a,container:l}=t,d=ce(Be,s);return e.jsx(Ha,{scope:s,forceMount:r,children:e.jsx(nt,{present:r||d.open,children:e.jsx(qr,{asChild:!0,container:l,children:a})})})};cr.displayName=Be;var he="PopoverContent",dr=n.forwardRef((t,s)=>{const r=Ja(he,t.__scopePopover),{forceMount:a=r.forceMount,...l}=t,d=ce(he,t.__scopePopover);return e.jsx(nt,{present:a||d.open,children:d.modal?e.jsx(Ya,{...l,ref:s}):e.jsx(Xa,{...l,ref:s})})});dr.displayName=he;var Ka=jr("PopoverContent.RemoveScroll"),Ya=n.forwardRef((t,s)=>{const r=ce(he,t.__scopePopover),a=n.useRef(null),l=ke(s,a),d=n.useRef(!1);return n.useEffect(()=>{const u=a.current;if(u)return Mr(u)},[]),e.jsx(Tr,{as:Ka,allowPinchZoom:!0,children:e.jsx(mr,{...t,ref:l,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(t.onCloseAutoFocus,u=>{u.preventDefault(),d.current||r.triggerRef.current?.focus()}),onPointerDownOutside:ge(t.onPointerDownOutside,u=>{const p=u.detail.originalEvent,j=p.button===0&&p.ctrlKey===!0,i=p.button===2||j;d.current=i},{checkForDefaultPrevented:!1}),onFocusOutside:ge(t.onFocusOutside,u=>u.preventDefault(),{checkForDefaultPrevented:!1})})})}),Xa=n.forwardRef((t,s)=>{const r=ce(he,t.__scopePopover),a=n.useRef(!1),l=n.useRef(!1);return e.jsx(mr,{...t,ref:s,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:d=>{t.onCloseAutoFocus?.(d),d.defaultPrevented||(a.current||r.triggerRef.current?.focus(),d.preventDefault()),a.current=!1,l.current=!1},onInteractOutside:d=>{t.onInteractOutside?.(d),d.defaultPrevented||(a.current=!0,d.detail.originalEvent.type==="pointerdown"&&(l.current=!0));const u=d.target;r.triggerRef.current?.contains(u)&&d.preventDefault(),d.detail.originalEvent.type==="focusin"&&l.current&&d.preventDefault()}})}),mr=n.forwardRef((t,s)=>{const{__scopePopover:r,trapFocus:a,onOpenAutoFocus:l,onCloseAutoFocus:d,disableOutsidePointerEvents:u,onEscapeKeyDown:p,onPointerDownOutside:j,onFocusOutside:i,onInteractOutside:N,...k}=t,C=ce(he,r),E=Ne(r);return Lr(),e.jsx(Br,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:l,onUnmountAutoFocus:d,children:e.jsx(br,{asChild:!0,disableOutsidePointerEvents:u,onInteractOutside:N,onEscapeKeyDown:p,onPointerDownOutside:j,onFocusOutside:i,onDismiss:()=>C.onOpenChange(!1),children:e.jsx(Nr,{"data-state":pr(C.open),role:"dialog",id:C.contentId,...E,...k,ref:s,style:{...k.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ur="PopoverClose",Ua=n.forwardRef((t,s)=>{const{__scopePopover:r,...a}=t,l=ce(ur,r);return e.jsx(re.button,{type:"button",...a,ref:s,onClick:ge(t.onClick,()=>l.onOpenChange(!1))})});Ua.displayName=ur;var Za="PopoverArrow",Qa=n.forwardRef((t,s)=>{const{__scopePopover:r,...a}=t,l=Ne(r);return e.jsx(Cr,{...l,...a,ref:s})});Qa.displayName=Za;function pr(t){return t?"open":"closed"}var es=nr,ts=ir,rs=cr,as=dr;function ss({...t}){return e.jsx(es,{"data-slot":"popover",...t})}function ns({...t}){return e.jsx(ts,{"data-slot":"popover-trigger",...t})}function ls({className:t,align:s="center",sideOffset:r=4,...a}){return e.jsx(rs,{children:e.jsx(as,{"data-slot":"popover-content",align:s,sideOffset:r,className:J("z-50 w-72","bg-white text-gray-800 rounded-professional","border border-gray-200 p-4","shadow-professional-lg outline-hidden","origin-(--radix-popover-content-transform-origin)","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2","data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})})}function os({options:t,value:s,onValueChange:r,placeholder:a="선택...",searchPlaceholder:l="검색...",emptyText:d="결과가 없습니다.",className:u}){const[p,j]=n.useState(!1);return e.jsxs(ss,{open:p,onOpenChange:j,children:[e.jsx(ns,{asChild:!0,children:e.jsxs(lt,{variant:"outline",role:"combobox","aria-expanded":p,className:J("w-full justify-between h-9 text-sm font-normal",u),children:[s?t.find(i=>i.value===s)?.label:a,e.jsx(Wr,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ls,{className:"w-full p-0",align:"start",children:e.jsxs(Qt,{children:[e.jsx(er,{placeholder:l,className:"h-9"}),e.jsx(tr,{children:d}),e.jsx(rr,{className:"max-h-[300px] overflow-auto",children:t.map(i=>e.jsxs(ar,{value:i.label,onSelect:()=>{r(i.value===s?"":i.value),j(!1)},children:[e.jsx(zr,{className:J("mr-2 h-4 w-4",s===i.value?"opacity-100":"opacity-0")}),i.label]},i.value))})]})})]})}const is=n.lazy(()=>et(()=>import("./PurchaseItemsModal-Bnb5Uy9L.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),cs=[{key:"pending",label:"승인대기"},{key:"purchase",label:"구매 현황"},{key:"receipt",label:"입고 현황"},{key:"done",label:"전체 항목"}];function bs({onEmailToggle:t,showEmailButton:s=!0}){const r=Sr(),a=kr(),l=Se(),[d,u]=n.useState(null),[p,j]=n.useState({}),[i,N]=n.useState(null),[k,C]=n.useState(!1),{purchases:E,vendors:F,employees:U,loading:o,currentUserRoles:h,currentUserName:S,refreshPurchases:I}=Kr(),R=h?.includes("app_admin"),{activeTab:f,searchTerm:g,vendorFilter:D,dateFromFilter:y,dateToFilter:L,selectedEmployee:q,purchaseNumberFilter:M,itemNameFilter:ee,approvalStatusFilter:V,setActiveTab:K,setSearchTerm:G,setVendorFilter:T,setDateFromFilter:Z,setDateToFilter:W,setSelectedEmployee:ae,setPurchaseNumberFilter:se,setItemNameFilter:ne,setApprovalStatusFilter:c,filteredPurchases:b,tabCounts:A}=Ur(E,h,S);n.useEffect(()=>{new URLSearchParams(a.search).get("tab")==="purchase"&&K("purchase")},[a.search,K]);const v=async x=>{try{const{error:O}=await l.from("purchase_requests").update({is_received:!0,received_at:new Date().toISOString()}).eq("id",x);if(O)throw O;await l.from("purchase_request_items").update({is_received:!0,delivery_status:"received"}).eq("purchase_request_id",x),te.success("입고완료 처리되었습니다."),await I()}catch{te.error("처리 중 오류가 발생했습니다.")}},$=async x=>{try{const{error:O}=await l.from("purchase_requests").update({is_payment_completed:!0,payment_completed_at:new Date().toISOString()}).eq("id",x);if(O)throw O;te.success("구매완료 처리되었습니다."),await I()}catch{te.error("처리 중 오류가 발생했습니다.")}};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"발주요청 관리"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"발주요청서를 관리하고 승인 처리를 할 수 있습니다"})]}),e.jsxs(lt,{onClick:()=>r("/purchase/new"),className:"mt-4 sm:mt-0 bg-hansl-500 hover:bg-hansl-600",children:[e.jsx(Vr,{className:"w-4 h-4 mr-2"}),"새 발주요청 작성"]})]}),e.jsxs(ze,{className:"mb-4 border border-gray-200",children:[e.jsx($r,{className:"bg-white border-b border-gray-200 py-3",children:e.jsxs(Er,{className:"flex items-center text-gray-900 text-sm font-medium",children:[e.jsx(Jr,{className:"w-4 h-4 mr-2"}),"검색 필터"]})}),e.jsx(Ve,{className:"py-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"시작일"}),e.jsx(_e,{type:"date",value:y,onChange:x=>Z(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"종료일"}),e.jsx(_e,{type:"date",value:L,onChange:x=>W(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"요청자"}),e.jsx(os,{value:q||"all",onValueChange:x=>{ae(x)},options:[{value:"all",label:"전체"},...U.filter(x=>x.name&&x.name.trim()!=="").sort((x,O)=>(x.name||"").localeCompare(O.name||"")).map(x=>({value:x.name||"",label:`${x.name}${x.name===S?" (나)":""}`}))],placeholder:q==="all"?"전체":q||"선택",searchPlaceholder:"직원 이름 검색...",emptyText:"일치하는 직원이 없습니다",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"업체"}),e.jsxs(Ge,{value:D||"all",onValueChange:x=>T(x==="all"?"":x),children:[e.jsx(We,{className:"h-9 text-sm",children:e.jsx(He,{placeholder:"전체"})}),e.jsxs(Je,{children:[e.jsx(ue,{value:"all",children:"전체"}),F.map(x=>e.jsx(ue,{value:x.vendor_name,children:x.vendor_name},x.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"발주번호"}),e.jsx(_e,{placeholder:"번호",value:M,onChange:x=>se(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"품명"}),e.jsx(_e,{placeholder:"품명",value:ee,onChange:x=>ne(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"승인상태"}),e.jsxs(Ge,{value:V||"all",onValueChange:x=>c(x==="all"?"":x),children:[e.jsx(We,{className:"h-9 text-sm",children:e.jsx(He,{placeholder:"전체"})}),e.jsxs(Je,{children:[e.jsx(ue,{value:"all",children:"전체"}),e.jsx(ue,{value:"pending",children:"대기"}),e.jsx(ue,{value:"approved",children:"승인"}),e.jsx(ue,{value:"rejected",children:"반려"})]})]})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"통합검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(pt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx(_e,{placeholder:"검색...",value:g,onChange:x=>G(x.target.value),className:"pl-7 text-sm h-9"})]})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 rounded-lg border border-gray-200",children:cs.map(x=>e.jsxs("button",{onClick:()=>K(x.key),className:`flex-1 flex items-center justify-center space-x-2 py-2.5 px-3 sm:px-4 rounded-md text-xs sm:text-sm font-medium transition-colors ${f===x.key?"text-hansl-600 bg-white shadow-sm border border-gray-200":"text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50"}`,children:[e.jsx("span",{className:"whitespace-nowrap",children:x.label}),e.jsx(Y,{variant:"secondary",className:`text-[10px] sm:text-xs ${f===x.key?"bg-hansl-50 text-hansl-700":"bg-gray-100 text-gray-600"}`,children:A[x.key]})]},x.key))}),e.jsx(ze,{className:"overflow-hidden border border-gray-200",children:e.jsx(Ve,{className:"p-0",children:o?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"로딩 중..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ar,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주요청서가 없습니다"}),e.jsx("p",{className:"text-gray-600",children:"새로운 발주요청서를 작성해보세요."})]}):e.jsx(Gt,{purchases:b,activeTab:f,currentUserRoles:h,onRefresh:I,onPaymentComplete:$,onReceiptComplete:v})})})]}),i&&e.jsx(n.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:e.jsx(is,{isOpen:k,onClose:()=>{C(!1),N(null)},purchase:{...i,vendor_name:i.vendor_name||"",project_vendor:i.project_vendor||"",sales_order_number:i.sales_order_number||"",project_item:i.project_item||""},isAdmin:R||!1,onUpdate:I})})]})}export{bs as default};
//# sourceMappingURL=PurchaseListMain-BNoQmQHt.js.map
