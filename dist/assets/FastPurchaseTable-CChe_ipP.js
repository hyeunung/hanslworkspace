const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-BrYFFAnx.js","assets/index-DURjiRtV.js","assets/index-CRgX5jue.css"])))=>i.map(i=>d[i]);
import{_ as ke,r as x,j as e,q as H,p as Se,s as Re,N as Pe,k as O,O as Y,a as Ee}from"./index-DURjiRtV.js";import{B as _,t as k}from"./index-DgYLmkP3.js";import{P as qe}from"./PurchaseDetailModal-BvNLZqrd.js";import{a as T}from"./helpers-CWDchwQL.js";import{E as Oe}from"./eye-Dp6JYudF.js";import{c as U,R as Fe,P as Ie,W as Me,C as Be,T as ze,D as Le,d as X,O as We,e as Te}from"./input-DR32zq7D.js";import"./dialog-BOugK96I.js";import"./format-NvEY_HGk.js";import"./circle-check-big-BuVt1Qd6.js";import"./chevron-down-Diu47hfg.js";import"./popover-D9IINcEu.js";import"./calendar-DMR6LWZU.js";import"./package-BOBhWn-U.js";import"./credit-card-XsL0DUkR.js";import"./trash-2-CdcJ6l8T.js";import"./plus-W5OE0DJN.js";import"./save-CLakp-ew.js";function V(t){if(!t)return"";const n=new Date(t);return isNaN(n.getTime())?t:`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function K(t){return t?["KRW","ì›","â‚©"].includes(t)?"â‚©":["USD","$","ë‹¬ëŸ¬"].includes(t)?"$":["EUR","â‚¬"].includes(t)?"â‚¬":["JPY","ì—”","Â¥"].includes(t)||["CNY","ìœ„ì•ˆ","å…ƒ"].includes(t)?"Â¥":t:""}async function Ge(t){const n=await ke(()=>import("./exceljs.min-BrYFFAnx.js").then(l=>l.e),__vite__mapDeps([0,1,2])),s=new n.Workbook,a=s.addWorksheet("ë°œì£¼ì„œ",{pageSetup:{paperSize:9,orientation:"portrait",fitToPage:!0,fitToWidth:1,fitToHeight:1,horizontalCentered:!0,verticalCentered:!0,margins:{left:.3,right:.3,top:.5,bottom:.5,header:.2,footer:.2}}});a.getRow(1).height=29.8;for(let l=2;l<=60;l++)a.getRow(l).height=15.75;a.getRow(1).eachCell(l=>{l.font={...l.font||{},name:"ë§‘ì€ ê³ ë”•",size:20}});for(let l=2;l<=60;l++)a.getRow(l).eachCell(i=>{i.font={...i.font||{},name:"ë§‘ì€ ê³ ë”•",size:11}});a.mergeCells("A1:G1"),a.mergeCells("A2:B2"),a.mergeCells("C2:D2"),a.mergeCells("F2:G2"),a.mergeCells("A3:B3"),a.mergeCells("C3:D3"),a.mergeCells("F3:G3"),a.mergeCells("A4:B4"),a.mergeCells("C4:D4"),a.mergeCells("F4:G4"),a.mergeCells("A5:B5"),a.mergeCells("C5:D5"),a.mergeCells("F5:G5"),a.mergeCells("A6:B6"),a.mergeCells("C6:D6"),a.mergeCells("F6:G6"),a.mergeCells("A7:B7"),a.mergeCells("C7:D7"),a.mergeCells("F7:G7");try{const i=await(await fetch("/logo_KOR.png")).arrayBuffer(),g=s.addImage({buffer:i,extension:"png"}),R=a.getColumn("D").width||22,P=Math.max(1,R*7.2*.58)+4,o=34,d=3.5-.5,f=.5-.2;a.addImage(g,{tl:{col:d,row:f},ext:{width:P,height:o}})}catch{}a.getCell("D1").value="                ë°œ ì£¼ ì„œ",a.getCell("D1").alignment={horizontal:"left",vertical:"middle",indent:1},a.getCell("D1").font={bold:!0,size:20},a.getCell("A2").value="ì—…   ì²´   ëª…",a.getCell("A2").font={bold:!0},a.getCell("A3").value="ë‹´   ë‹¹   ì",a.getCell("A3").font={bold:!0},a.getCell("A4").value="ì²­   êµ¬   ì¼",a.getCell("A4").font={bold:!0},a.getCell("A5").value="TEL.",a.getCell("A5").font={bold:!0},a.getCell("A6").value="FAX.",a.getCell("A6").font={bold:!0},a.getCell("A7").value="ì…ê³ ìš”ì²­ì¼",a.getCell("A7").font={bold:!0},a.getCell("E2").value="êµ¬ë§¤ìš”ì²­ì",a.getCell("E2").font={bold:!0},a.getCell("E3").value="ì£¼         ì†Œ",a.getCell("E3").font={bold:!0},a.getCell("E4").value="ë°œ ì£¼ ë²ˆ í˜¸",a.getCell("E4").font={bold:!0},a.getCell("E5").value="TEL.",a.getCell("E5").font={bold:!0},a.getCell("E6").value="FAX.",a.getCell("E6").font={bold:!0},a.getCell("E7").value="ì§€ì¶œ ì˜ˆì •ì¼",a.getCell("E7").font={bold:!0},a.getCell("F7").value=t.vendor_payment_schedule||"",a.getCell("C2").value=t.vendor_name,a.getCell("C3").value=t.vendor_contact_name||"",a.getCell("C4").value=V(t.request_date),a.getCell("C5").value=t.vendor_phone||"",a.getCell("C6").value=t.vendor_fax||"",a.getCell("C7").value=V(t.delivery_request_date),a.getCell("F2").value=t.requester_name,a.getCell("F3").value="ëŒ€êµ¬ê´‘ì—­ì‹œ ë‹¬ì„œêµ¬ ì„±ì„œê³µë‹¨ë¶ë¡œ305",a.getCell("F4").value=t.purchase_order_number,a.getCell("F5").value="(053) 626-7805",a.getCell("F6").value="(053) 657-7905",a.getCell("F5").alignment={horizontal:"center",vertical:"middle"},a.getCell("F6").alignment={horizontal:"center",vertical:"middle"};const c=["No","í’ˆëª…","ê·œê²©","ìˆ˜ëŸ‰","ë‹¨ê°€","ê¸ˆì•¡","ë¹„ê³ "];for(let l=0;l<c.length;l++)a.getCell(String.fromCharCode(65+l)+"8").value=c[l],a.getCell(String.fromCharCode(65+l)+"8").font={bold:!0},l===6&&(a.getCell("G8").alignment={horizontal:"center",vertical:"middle"});const j=9,w=45,u=[...t.items].sort((l,i)=>l.line_number-i.line_number),p=u.length,m=j+Math.max(p,w);for(let l=0;l<u.length;l++){const i=u[l],g=j+l;a.getCell("A"+g).value=i.line_number;const R=a.getCell("B"+g);R.value=i.item_name,R.alignment={horizontal:"left",vertical:"middle"},a.getCell("C"+g).value=i.specification,a.getCell("C"+g).alignment={horizontal:"left",vertical:"middle"},a.getCell("D"+g).value=i.quantity;const P=K(i.currency),o=i.unit_price_value!==void 0&&i.unit_price_value!==null?`${i.unit_price_value.toLocaleString()} ${P}`.trim():"";a.getCell("E"+g).value=o,a.getCell("E"+g).alignment={horizontal:"right",vertical:"middle"};const d=K(i.currency),f=i.amount_value!==void 0&&i.amount_value!==null?`${i.amount_value.toLocaleString()} ${d}`.trim():"";a.getCell("F"+g).value=f,a.getCell("F"+g).alignment={horizontal:"right",vertical:"middle"};const $=a.getCell("G"+g);$.value=i.remark!==void 0&&i.remark!==null?String(i.remark):"",$.alignment={horizontal:"left",vertical:"middle",wrapText:!1,shrinkToFit:!0}}for(let l=p;l<w;l++){const i=j+l;for(let g=0;g<7;g++)a.getCell(String.fromCharCode(65+g)+i).value=""}a.mergeCells(`A${m}:E${m}`),a.getCell("A"+m).value="í•©ê³„",a.getCell("A"+m).font={bold:!0};const F=K(t.items[0]?.currency),D=t.items.reduce((l,i)=>l+(i.amount_value||0),0);a.getCell("F"+m).value=`${D.toLocaleString()} ${F}`.trim(),a.getCell("F"+m).alignment={horizontal:"right",vertical:"middle"};const h=m;for(let l=1;l<=h;l++)for(let i=1;i<=7;i++){const R=String.fromCharCode(64+i)+l,P=a.getCell(R),o=i===5||i===6,d=i===3,f=l>=j&&l<m;o&&(f||l===m)||d&&f||(P.alignment={horizontal:"center",vertical:"middle"}),P.border={top:{style:l===1||l===2||l===8||l===m?"medium":"thin"},left:{style:i===1?"medium":"thin"},right:{style:i===7?"medium":"thin"},bottom:{style:l===8||l===m||l===h?"medium":"thin"}}}for(let l=0;l<p;l++){const i=j+l;a.getCell("C"+i).alignment={horizontal:"left",vertical:"middle"}}for(let l=2;l<=7;l++)a.getCell("B"+l).border={...a.getCell("B"+l).border,right:{style:"medium"}},a.getCell("D"+l).border={...a.getCell("D"+l).border,right:{style:"medium"}},l<=6&&(a.getCell("E"+l).border={...a.getCell("E"+l).border,right:{style:"medium"}});a.getCell("E7").border={...a.getCell("E7").border,top:{style:"thin"},right:{style:"medium"}},a.getCell("G7").border={...a.getCell("G7").border,top:{style:"thin"}};for(let l=1;l<=7;l++){const i=a.getCell("A"+l).border||{};a.getCell("A"+l).border={...i,left:{style:"medium"}}}const z=a.getCell("A"+m).border||{};a.getCell("A"+m).border={...z,left:{style:"medium"}},Object.entries({A:4.7,B:23,C:30,D:11,E:15,F:16,G:37}).forEach(([l,i])=>{a.getColumn(l).width=i}),a.getRow(1).height=29.8,a.getRow(1).eachCell(l=>{l.font={...l.font||{},name:"ë§‘ì€ ê³ ë”•",size:20}});for(let l=2;l<=h;l++){const i=a.getRow(l);i.height=15.75,i.eachCell(g=>{g.font={...g.font||{},name:"ë§‘ì€ ê³ ë”•",size:11}})}for(let l=9;l<=h;l++)a.getCell("G"+l).alignment={horizontal:"left",vertical:"middle",wrapText:!1,shrinkToFit:!0},a.getCell("B"+l).alignment={horizontal:"left",vertical:"middle"};const G=await s.xlsx.writeBuffer();return new Blob([G],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}const Je=t=>{if(!t.items||t.items.length===0)return{received:0,total:0,percentage:0};const n=t.items.length,s=t.items.filter(c=>c.is_received||c.delivery_status==="received").length,a=n>0?Math.round(s/n*100):0;return{received:s,total:n,percentage:a}},Q=x.memo(({purchase:t})=>{const n=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",s={completed:{text:"ì…ê³ ì™„ë£Œ",className:"bg-green-100 text-green-800"},inProgress:{text:"êµ¬ë§¤ì§„í–‰",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"ë°˜ë ¤",className:"bg-red-100 text-red-800"},pending:{text:"ìŠ¹ì¸ëŒ€ê¸°",className:"bg-yellow-100 text-yellow-800"}},{text:a,className:c}=s[n];return e.jsx(_,{className:`${c} text-xs`,children:a})});Q.displayName="StatusBadge";const Z=x.memo(({purchase:t,onClick:n})=>{const s=Je(t),a=t.progress_type==="ì„ ì§„í–‰"||t.progress_type?.includes("ì„ ì§„í–‰");return e.jsxs("div",{className:`bg-white rounded-lg border p-4 space-y-3 cursor-pointer transition-all hover:shadow-md ${a?"border-red-400 bg-red-50 hover:bg-red-100":"hover:bg-gray-50"}`,onClick:()=>n(t),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a?e.jsx(_,{className:"bg-red-500 text-white font-bold text-xs px-2 py-0.5",children:"ì„ ì§„í–‰"}):e.jsx(_,{className:"bg-gray-200 text-gray-700 text-xs px-2 py-0.5",children:"ì¼ë°˜"}),e.jsx("span",{className:"font-semibold text-sm text-gray-900",children:t.purchase_order_number||"-"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[T(t.request_date)," ìš”ì²­"]})]}),e.jsx(Q,{purchase:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"ìš”ì²­ì"}),e.jsx("span",{className:"font-medium",children:t.requester_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"ì—…ì²´"}),e.jsx("span",{className:"font-medium",children:t.vendor_name})]}),t.project_vendor&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJì—…ì²´"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_vendor})]}),t.project_item&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJ ITEM"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_item})]}),t.sales_order_number&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"ìˆ˜ì£¼ë²ˆí˜¸"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.sales_order_number})]}),t.item_name&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"í’ˆëª©"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.item_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"ê¸ˆì•¡"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[(t.amount_value||t.total_amount)?.toLocaleString()," ",t.currency]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"ì…ê³ í˜„í™©"}),e.jsxs("span",{className:"text-gray-700",children:[s.received,"/",s.total," (",s.percentage,"%)"]})]}),e.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${s.percentage===100?"bg-green-500":s.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${s.percentage}%`}})})]}),t.is_payment_completed!==void 0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"ê²°ì œ"}),t.is_payment_completed?e.jsx(_,{className:"bg-green-100 text-green-800 text-xs",children:"ì™„ë£Œ"}):e.jsx(_,{className:"bg-gray-100 text-gray-800 text-xs",children:"ëŒ€ê¸°"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex items-center justify-center text-xs text-gray-500",children:[e.jsx(Oe,{className:"w-3 h-3 mr-1"}),"í´ë¦­í•˜ì—¬ ìƒì„¸ë³´ê¸°"]})})]})});Z.displayName="MobilePurchaseCard";var ee="AlertDialog",[Ke,Dt]=Se(ee,[U]),S=U(),te=t=>{const{__scopeAlertDialog:n,...s}=t,a=S(n);return e.jsx(Fe,{...a,...s,modal:!0})};te.displayName=ee;var Ve="AlertDialogTrigger",He=x.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...a}=t,c=S(s);return e.jsx(Te,{...c,...a,ref:n})});He.displayName=Ve;var Ye="AlertDialogPortal",ae=t=>{const{__scopeAlertDialog:n,...s}=t,a=S(n);return e.jsx(Ie,{...a,...s})};ae.displayName=Ye;var Ue="AlertDialogOverlay",re=x.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...a}=t,c=S(s);return e.jsx(We,{...c,...a,ref:n})});re.displayName=Ue;var M="AlertDialogContent",[Xe,Qe]=Ke(M),Ze=Pe("AlertDialogContent"),se=x.forwardRef((t,n)=>{const{__scopeAlertDialog:s,children:a,...c}=t,j=S(s),w=x.useRef(null),u=H(n,w),p=x.useRef(null);return e.jsx(Me,{contentName:M,titleName:le,docsSlug:"alert-dialog",children:e.jsx(Xe,{scope:s,cancelRef:p,children:e.jsxs(Be,{role:"alertdialog",...j,...c,ref:u,onOpenAutoFocus:Re(c.onOpenAutoFocus,m=>{m.preventDefault(),p.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(Ze,{children:a}),e.jsx(tt,{contentRef:w})]})})})});se.displayName=M;var le="AlertDialogTitle",ne=x.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...a}=t,c=S(s);return e.jsx(ze,{...c,...a,ref:n})});ne.displayName=le;var oe="AlertDialogDescription",ie=x.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...a}=t,c=S(s);return e.jsx(Le,{...c,...a,ref:n})});ie.displayName=oe;var et="AlertDialogAction",ce=x.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...a}=t,c=S(s);return e.jsx(X,{...c,...a,ref:n})});ce.displayName=et;var de="AlertDialogCancel",me=x.forwardRef((t,n)=>{const{__scopeAlertDialog:s,...a}=t,{cancelRef:c}=Qe(de,s),j=S(s),w=H(n,c);return e.jsx(X,{...j,...a,ref:w})});me.displayName=de;var tt=({contentRef:t})=>{const n=`\`${M}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${M}\` by passing a \`${oe}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${M}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return x.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(n)},[n,t]),null},at=te,rt=ae,xe=re,pe=se,ge=ce,ue=me,fe=ne,he=ie;const st=at,lt=rt,ye=x.forwardRef(({className:t,...n},s)=>e.jsx(xe,{className:O("fixed inset-0 z-50 bg-black/40 backdrop-blur-sm","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:s}));ye.displayName=xe.displayName;const _e=x.forwardRef(({className:t,...n},s)=>e.jsxs(lt,{children:[e.jsx(ye,{}),e.jsx(pe,{ref:s,className:O("fixed left-[50%] top-[50%] z-50","w-full max-w-md translate-x-[-50%] translate-y-[-50%]","grid gap-4 bg-white border border-gray-200","rounded-lg p-6 shadow-professional-xl","duration-200","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]","data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",t),...n})]}));_e.displayName=pe.displayName;const je=({className:t,...n})=>e.jsx("div",{className:O("flex flex-col space-y-2 text-left",t),...n});je.displayName="AlertDialogHeader";const we=({className:t,...n})=>e.jsx("div",{className:O("flex flex-col-reverse sm:flex-row sm:justify-end gap-3",t),...n});we.displayName="AlertDialogFooter";const Ne=x.forwardRef(({className:t,...n},s)=>e.jsx(fe,{ref:s,className:O("text-lg font-semibold text-gray-800 tracking-tight",t),...n}));Ne.displayName=fe.displayName;const ve=x.forwardRef(({className:t,...n},s)=>e.jsx(he,{ref:s,className:O("text-sm text-gray-600",t),...n}));ve.displayName=he.displayName;const be=x.forwardRef(({className:t,...n},s)=>e.jsx(ge,{ref:s,className:O(Y(),t),...n}));be.displayName=ge.displayName;const Ce=x.forwardRef(({className:t,...n},s)=>e.jsx(ue,{ref:s,className:O(Y({variant:"outline"}),"mt-2 sm:mt-0",t),...n}));Ce.displayName=ue.displayName;const $e=x.memo(({purchase:t})=>{const n=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",s={completed:{text:"ì…ê³ ì™„ë£Œ",className:"bg-green-100 text-green-800"},inProgress:{text:"êµ¬ë§¤ì§„í–‰",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"ë°˜ë ¤",className:"bg-red-100 text-red-800"},pending:{text:"ìŠ¹ì¸ëŒ€ê¸°",className:"bg-yellow-100 text-yellow-800"}},{text:a,className:c}=s[n];return e.jsx(_,{className:c,children:a})});$e.displayName="StatusBadge";const q=t=>!t||["KRW","ì›","â‚©"].includes(t)?"â‚©":["USD","$","ë‹¬ëŸ¬"].includes(t)?"$":["EUR","â‚¬"].includes(t)?"â‚¬":["JPY","ì—”","Â¥"].includes(t)||["CNY","ìœ„ì•ˆ","å…ƒ"].includes(t)?"Â¥":t,r={approvalStatus:"text-center w-20 min-w-[85px] max-w-[85px]",purchaseOrderNumber:"pl-2 w-36 min-w-[145px] max-w-[145px]",paymentCategory:"text-center w-20 min-w-[85px] max-w-[85px]",requesterName:"w-16 min-w-[68px] max-w-[68px]",requestDate:"w-20 min-w-[85px] max-w-[85px]",vendorName:"w-28 min-w-[115px] max-w-[115px]",contactName:"w-16 min-w-[68px] max-w-[68px]",deliveryRequestDate:"w-20 min-w-[85px] max-w-[85px]",revisedDeliveryRequestDate:"w-20 min-w-[85px] max-w-[85px]",itemName:"w-28 min-w-[120px] max-w-[120px]",specification:"w-64 min-w-[260px] max-w-[260px]",quantity:"text-center w-14 min-w-[60px] max-w-[60px]",unitPrice:"text-right w-24 min-w-[100px] max-w-[100px]",amount:"text-right w-24 min-w-[100px] max-w-[100px]",remark:"w-28 min-w-[115px] max-w-[115px]",paymentSchedule:"w-24 min-w-[100px] max-w-[100px]",projectVendor:"w-24 min-w-[105px] max-w-[105px]",salesOrderNumber:"w-28 min-w-[115px] max-w-[115px]",projectItem:"w-44 min-w-[180px] max-w-[180px]",receiptProgress:"text-center w-20 min-w-[85px] max-w-[85px]",status:"text-center w-20 min-w-[85px] max-w-[85px]",receipt:"text-center w-16 min-w-[70px] max-w-[70px]",paymentStatus:"text-center w-16 min-w-[70px] max-w-[70px]",link:"w-20 min-w-[85px] max-w-[85px]"},Ae=x.memo(({purchase:t})=>{const n=t.middle_manager_status==="approved",s=t.middle_manager_status==="rejected",a=t.final_manager_status==="approved",c=t.final_manager_status==="rejected";return s||c?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"})}),e.jsx(_,{className:"bg-red-100 text-red-800 text-[11px] font-medium px-1.5 py-0",children:"ë°˜ë ¤"})]}):n&&a?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})}),e.jsx(_,{className:"bg-green-100 text-green-800 text-[11px] font-medium px-1.5 py-0",children:"ìŠ¹ì¸ì™„ë£Œ"})]}):n&&!a&&!c?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(_,{className:"bg-yellow-100 text-yellow-800 text-[11px] font-medium px-1.5 py-0",children:"1ì°¨ ìŠ¹ì¸"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(_,{className:"bg-gray-100 text-gray-600 text-[11px] font-medium px-1.5 py-0",children:"ìŠ¹ì¸ëŒ€ê¸°"})]})});Ae.displayName="ApprovalStatusBadge";const nt=t=>{if(t.is_received)return{received:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{received:0,total:1,percentage:0};const n=t.items.length,s=t.items.filter(c=>c.is_received===!0).length,a=n>0?Math.round(s/n*100):0;return{received:s,total:n,percentage:a}},ot=t=>{if(t.is_payment_completed)return{completed:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{completed:0,total:1,percentage:0};const n=t.items.length,s=t.items.filter(c=>c.is_payment_completed===!0).length,a=n>0?Math.round(s/n*100):0;return{completed:s,total:n,percentage:a}},it=t=>{if(!t.items||t.items.length===0){if(t.is_received)return{percentage:100};if(t.is_payment_completed)return{percentage:80};const p=t.middle_manager_status==="rejected",m=t.final_manager_status==="rejected";if(p||m)return{percentage:0};const F=t.middle_manager_status==="approved",D=t.final_manager_status==="approved";return F&&D?{percentage:40}:{percentage:20}}const n=t.items.length,s=t.items.filter(p=>p.is_received===!0).length,a=t.items.filter(p=>p.is_payment_completed===!0).length;if(s===n)return{percentage:100};if(s>0){const p=Math.round(s/n*100);return{percentage:Math.min(80+Math.round(p*.2),99)}}if(a===n)return{percentage:80};if(a>0){const p=Math.round(a/n*100);return{percentage:Math.min(40+Math.round(p*.4),79)}}const c=t.middle_manager_status==="rejected",j=t.final_manager_status==="rejected";if(c||j)return{percentage:0};const w=t.middle_manager_status==="approved",u=t.final_manager_status==="approved";return w&&u?{percentage:40}:{percentage:20}},ct=x.memo(({type:t})=>t==="ì„ ì§„í–‰"||t?.includes("ì„ ì§„í–‰")?e.jsx(_,{className:"bg-red-500 text-white font-bold text-[11px] px-2 py-0.5",children:"ì„ ì§„í–‰"}):e.jsx(_,{className:"bg-gray-200 text-gray-700 text-[11px] px-2 py-0.5",children:"ì¼ë°˜"}));ct.displayName="ProgressTypeBadge";const De=x.memo(({purchase:t,onClick:n,activeTab:s,isLeadBuyer:a,onPaymentComplete:c,onReceiptComplete:j,onExcelDownload:w})=>{const u=nt(t),p=ot(t),m=it(t),F=t.progress_type==="ì„ ì§„í–‰"||t.progress_type?.includes("ì„ ì§„í–‰");return e.jsxs("tr",{className:`border-b hover:bg-gray-100 cursor-pointer transition-colors ${F?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>n(t),children:[s==="pending"&&e.jsx("td",{className:`px-2 py-1.5 whitespace-nowrap ${r.approvalStatus}`,children:e.jsx(Ae,{purchase:t})}),s==="purchase"&&e.jsx("td",{className:`px-2 py-1.5 ${r.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${p.percentage===100?"bg-blue-500":p.percentage>0?"bg-blue-400":"bg-gray-300"}`,style:{width:`${p.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[p.percentage,"%"]})]})}),s==="receipt"&&e.jsx("td",{className:`px-2 py-1.5 ${r.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${u.percentage===100?"bg-green-500":u.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${u.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[u.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 font-medium text-[11px] whitespace-nowrap ${r.purchaseOrderNumber}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[w&&e.jsx("img",{src:"/excels-icon.svg",alt:"ì—‘ì…€ ë‹¤ìš´ë¡œë“œ",width:"16",height:"16",className:`inline-block align-middle transition-transform p-0.5 rounded
                ${t.is_po_download?"border border-gray-400":""}
                ${t.progress_type==="ì„ ì§„í–‰"||t.progress_type?.includes("ì„ ì§„í–‰")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?t.is_po_download?"cursor-pointer":"cursor-pointer hover:scale-110":"opacity-40 grayscale cursor-not-allowed"}`,onClick:async D=>{(t.progress_type==="ì„ ì§„í–‰"||t.progress_type?.includes("ì„ ì§„í–‰")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved")&&(D.stopPropagation(),await w(t))},style:{pointerEvents:t.progress_type==="ì„ ì§„í–‰"||t.progress_type?.includes("ì„ ì§„í–‰")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"auto":"none"},title:t.is_po_download?"ë‹¤ìš´ë¡œë“œ ì™„ë£Œ":"ì—‘ì…€ ë°œì£¼ì„œ ë‹¤ìš´ë¡œë“œ"}),e.jsxs("span",{className:"block truncate",title:t.purchase_order_number||"",children:[t.purchase_order_number||"-",t.items&&t.items.length>1&&e.jsxs("span",{className:"text-gray-500 ml-0.5",children:["(",t.items.length,")"]})]})]})}),(s==="pending"||s==="receipt"||s==="done"||!s)&&e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.paymentCategory}`,children:e.jsx(_,{className:`text-[11px] ${t.payment_category==="êµ¬ë§¤ ìš”ì²­"?"bg-blue-100 text-blue-800":t.payment_category==="ë°œì£¼"?"bg-green-100 text-green-800":t.payment_category==="ê²½ë¹„ ì²­êµ¬"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.payment_category==="êµ¬ë§¤ ìš”ì²­"?"êµ¬ë§¤ìš”ì²­":t.payment_category==="ë°œì£¼"?"ë°œì£¼ìš”ì²­":t.payment_category||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.requesterName}`,children:e.jsx("span",{className:"block truncate",title:t.requester_name||"",children:t.requester_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.requestDate}`,children:T(t.request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.vendorName}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_name||"",children:t.vendor_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.contactName}`,children:e.jsx("span",{className:"block truncate",title:t.contact_name||"",children:t.contact_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.deliveryRequestDate}`,children:T(t.delivery_request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.revisedDeliveryRequestDate}`,children:T(t.revised_delivery_request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.itemName}`,children:e.jsx("span",{className:"block truncate",title:t.item_name||"",children:t.item_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.specification}`,children:e.jsx("span",{className:"block truncate",title:t.specification||"",children:t.specification||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.quantity}`,children:t.quantity||0}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.unitPrice}`,children:t.unit_price_value?`${t.unit_price_value.toLocaleString()} ${q(t.currency||"KRW")}`:`0 ${q(t.currency||"KRW")}`}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] font-medium whitespace-nowrap ${r.amount}`,children:t.amount_value?`${t.amount_value.toLocaleString()} ${q(t.currency||"KRW")}`:t.total_amount?`${t.total_amount.toLocaleString()} ${q(t.currency||"KRW")}`:`0 ${q(t.currency||"KRW")}`}),s==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})})]}),s==="purchase"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"ë§í¬ ë³´ê¸°"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),s==="receipt"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),(s==="done"||!s)&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"ë§í¬ ë³´ê¸°"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${r.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${r.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})}),e.jsx("td",{className:`px-2 py-1.5 ${r.status}`,children:t.payment_category==="êµ¬ë§¤ ìš”ì²­"?e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${m.percentage===100?"bg-green-500":m.percentage>=80?"bg-blue-500":m.percentage>=40?"bg-hansl-500":m.percentage>0?"bg-gray-400":"bg-red-500"}`,style:{width:`${m.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[m.percentage,"%"]})]}):e.jsx("span",{className:"text-gray-400 text-[11px]",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 ${r.receipt}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${u.percentage===100?"bg-green-500":u.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${u.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[u.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 ${r.paymentStatus}`,children:t.is_payment_completed?e.jsx(_,{className:"bg-green-100 text-green-800 text-[11px]",children:"ì™„ë£Œ"}):e.jsx(_,{className:"bg-gray-100 text-gray-800 text-[11px]",children:"ëŒ€ê¸°"})})]})]})});De.displayName="TableRow";const dt=x.memo(({purchases:t,activeTab:n="done",currentUserRoles:s=[],onRefresh:a,onPaymentComplete:c,onReceiptComplete:j})=>{const[w,u]=x.useState(null),[p,m]=x.useState(!1),[F,D]=x.useState(!1),[h,z]=x.useState(null),C=Ee(),G=s&&(s.includes("lead buyer")||s.includes("app_admin"));s.includes("final_approver")||s.includes("app_admin")||s.includes("ceo");const l=o=>{u(o.id),m(!0)},i=()=>{m(!1),u(null)},g=async o=>{try{const{data:d,error:f}=await C.from("purchase_requests").select("*").eq("purchase_order_number",o.purchase_order_number).single();if(f||!d){k.error("í•´ë‹¹ ë°œì£¼ìš”ì²­ë²ˆí˜¸ì˜ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}const{data:$,error:E}=await C.from("purchase_request_items").select("*").eq("purchase_order_number",o.purchase_order_number).order("line_number");if(E||!$||$.length===0){k.error("í•´ë‹¹ ë°œì£¼ìš”ì²­ë²ˆí˜¸ì˜ í’ˆëª© ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}const N={vendor_name:o.vendor_name,vendor_phone:"",vendor_fax:"",vendor_contact_name:"",vendor_payment_schedule:""};try{const y=d.vendor_id||o.vendor_id,b=d.contact_id||o.contact_id;if(y){const{data:A}=await C.from("vendors").select("vendor_phone, vendor_fax, vendor_payment_schedule").eq("id",y).single();A&&(N.vendor_phone=A.vendor_phone||"",N.vendor_fax=A.vendor_fax||"",N.vendor_payment_schedule=A.vendor_payment_schedule||"")}if(b){const{data:A}=await C.from("vendor_contacts").select("contact_name, contact_phone, contact_email").eq("id",b).single();A&&(N.vendor_contact_name=A.contact_name||"")}}catch{}const I={purchase_order_number:d.purchase_order_number||"",request_date:d.request_date,delivery_request_date:d.delivery_request_date,requester_name:d.requester_name,vendor_name:N.vendor_name||"",vendor_contact_name:N.vendor_contact_name,vendor_phone:N.vendor_phone,vendor_fax:N.vendor_fax,project_vendor:d.project_vendor,sales_order_number:d.sales_order_number,project_item:d.project_item,vendor_payment_schedule:N.vendor_payment_schedule,items:$.map(y=>({line_number:y.line_number,item_name:y.item_name,specification:y.specification,quantity:y.quantity,unit_price_value:y.unit_price_value,amount_value:y.amount_value,remark:y.remark,currency:d.currency||"KRW"}))},L=await Ge(I),W=`ë°œì£¼ì„œ_${I.vendor_name}_${I.purchase_order_number}.xlsx`,B=window.URL.createObjectURL(L),v=document.createElement("a");v.href=B,v.download=W,document.body.appendChild(v),v.click(),document.body.removeChild(v),window.URL.revokeObjectURL(B),k.success("ì—‘ì…€ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.");try{if(s&&s.includes("lead buyer")){const{error:b}=await C.from("purchase_requests").update({is_po_download:!0}).eq("purchase_order_number",o.purchase_order_number);b||a?.()}}catch{}}catch{k.error("ì—‘ì…€ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}},R=async()=>{if(h){console.log("ğŸ—‘ï¸ === ì‚­ì œ í”„ë¡œì„¸ìŠ¤ ì‹œì‘ ==="),console.log("ì‚­ì œí•  ë°œì£¼ìš”ì²­:",{id:h.id,purchase_order_number:h.purchase_order_number,requester_name:h.requester_name,final_manager_status:h.final_manager_status});try{const{data:{user:o},error:d}=await C.auth.getUser();if(console.log("í˜„ì¬ ì‚¬ìš©ì:",o?.email||"ë¡œê·¸ì¸ ì•ˆë¨"),d||!o){console.error("âŒ ì¸ì¦ ì˜¤ë¥˜:",d),k.error("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");return}const{data:f,error:$}=await C.from("employees").select("name, email, purchase_role").eq("email",o.email).single();if(console.log("ì‚¬ìš©ì ê¶Œí•œ ì •ë³´:",{employee:f?.name,roles:f?.purchase_role,email:f?.email}),$||!f){console.error("âŒ ì§ì› ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:",$),k.error("ì‚¬ìš©ì ê¶Œí•œì„ í™•ì¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");return}let E=[];f.purchase_role&&(Array.isArray(f.purchase_role)?E=f.purchase_role.map(A=>String(A).trim()):E=String(f.purchase_role).split(",").map(J=>J.trim()).filter(J=>J.length>0));const N=E.includes("final_approver")||E.includes("app_admin")||E.includes("ceo"),I=h.final_manager_status==="approved",L=h.requester_name===f.name,W=I?N:N||L;if(console.log("ì‚­ì œ ê¶Œí•œ ë¶„ì„:",{canEdit:N,isApproved:I,isRequester:L,canDeleteThis:W,userRoles:E}),!W){console.error("âŒ ì‚­ì œ ê¶Œí•œ ì—†ìŒ"),k.error("ì‚­ì œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.");return}console.log("âœ… ì‚­ì œ ê¶Œí•œ í™•ì¸ë¨ - ì•„ì´í…œ ì‚­ì œ ì‹œì‘");const{data:B,error:v}=await C.from("purchase_request_items").delete().eq("purchase_request_id",h.id).select();if(v)throw console.error("âŒ ì•„ì´í…œ ì‚­ì œ ì‹¤íŒ¨:",v),console.error("ì•„ì´í…œ ì‚­ì œ ì˜¤ë¥˜ ìƒì„¸:",{code:v.code,message:v.message,details:v.details,hint:v.hint}),v;console.log("âœ… ì•„ì´í…œ ì‚­ì œ ì„±ê³µ:",B?.length||0,"ê°œ ì‚­ì œë¨"),console.log("ì‚­ì œëœ ì•„ì´í…œ:",B),console.log("ğŸ“ ë°œì£¼ìš”ì²­ ì‚­ì œ ì‹œì‘");const{data:y,error:b}=await C.from("purchase_requests").delete().eq("id",h.id).select();if(b)throw console.error("âŒ ë°œì£¼ìš”ì²­ ì‚­ì œ ì‹¤íŒ¨:",b),console.error("ë°œì£¼ìš”ì²­ ì‚­ì œ ì˜¤ë¥˜ ìƒì„¸:",{code:b.code,message:b.message,details:b.details,hint:b.hint}),b;console.log("âœ… ë°œì£¼ìš”ì²­ ì‚­ì œ ì„±ê³µ:",y),console.log("ğŸ‰ === ì‚­ì œ í”„ë¡œì„¸ìŠ¤ ì™„ë£Œ ==="),k.success("ë°œì£¼ìš”ì²­ ë‚´ì—­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤."),a?.()}catch(o){console.error("ğŸ’¥ ì‚­ì œ ì¤‘ ì „ì²´ ì˜¤ë¥˜:",o);const d=o;console.error("ì˜¤ë¥˜ ìƒì„¸ ì •ë³´:",{name:d?.name,message:d?.message,code:d?.code,details:d?.details,hint:d?.hint,stack:d?.stack}),k.error(`ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${d?.message||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}D(!1),z(null)}},P=x.useMemo(()=>{if(n==="pending")return e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.approvalStatus}`,children:"ìŠ¹ì¸ìƒíƒœ"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.purchaseOrderNumber}`,children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.paymentCategory}`,children:"ê²°ì œì¢…ë¥˜"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.requesterName}`,children:"ìš”ì²­ì"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.requestDate}`,children:"ì²­êµ¬ì¼"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${r.vendorName}`,children:"ì—…ì²´"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.contactName}`,children:"ë‹´ë‹¹ì"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.deliveryRequestDate}`,children:"ì…ê³ ìš”ì²­ì¼"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.revisedDeliveryRequestDate}`,children:"ë³€ê²½ ì…ê³ ì¼"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${r.itemName}`,children:"í’ˆëª…"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${r.specification}`,children:"ê·œê²©"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.quantity}`,children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.unitPrice}`,children:"ë‹¨ê°€"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.amount}`,children:"í•©ê³„"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.remark}`,children:"ë¹„ê³ "}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.projectVendor}`,children:"PJì—…ì²´"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.salesOrderNumber}`,children:"ìˆ˜ì£¼ë²ˆí˜¸"})]})});const o=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.purchaseOrderNumber}`,children:"ë°œì£¼ë²ˆí˜¸"}),(n==="receipt"||n==="done"||!n)&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.paymentCategory}`,children:"ê²°ì œì¢…ë¥˜"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.requesterName}`,children:"ìš”ì²­ì"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.requestDate}`,children:"ì²­êµ¬ì¼"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.vendorName}`,children:"ì—…ì²´"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.contactName}`,children:"ë‹´ë‹¹ì"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.deliveryRequestDate}`,children:"ì…ê³ ìš”ì²­ì¼"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.revisedDeliveryRequestDate}`,children:"ë³€ê²½ ì…ê³ ì¼"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${r.itemName}`,children:"í’ˆëª…"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${r.specification}`,children:"ê·œê²©"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.quantity}`,children:"ìˆ˜ëŸ‰"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.unitPrice}`,children:"ë‹¨ê°€"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.amount}`,children:"í•©ê³„"})]});let d=null;return n==="purchase"?d=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.remark}`,children:"ë¹„ê³ "}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.link}`,children:"ë§í¬"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.paymentSchedule}`,children:"ì§€ì¶œì˜ˆì •ì¼"})]}):n==="receipt"?d=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.remark}`,children:"ë¹„ê³ "}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.projectVendor}`,children:"PJì—…ì²´"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.salesOrderNumber}`,children:"ìˆ˜ì£¼ë²ˆí˜¸"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.paymentSchedule}`,children:"ì§€ì¶œì˜ˆì •ì¼"})]}):d=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.remark}`,children:"ë¹„ê³ "}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.link}`,children:"ë§í¬"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.projectVendor}`,children:"PJì—…ì²´"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.salesOrderNumber}`,children:"ìˆ˜ì£¼ë²ˆí˜¸"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${r.paymentSchedule}`,children:"ì§€ì¶œì˜ˆì •ì¼"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.status}`,children:"êµ¬ë§¤ì§„í–‰"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.receipt}`,children:"ì…ê³ ì§„í–‰"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.paymentStatus}`,children:"ê²°ì œ"})]}),e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[n==="purchase"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.receiptProgress}`,children:"êµ¬ë§¤ì§„í–‰"}),n==="receipt"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${r.receiptProgress}`,children:"ì…ê³ ì§„í–‰"}),o,d]})})},[n]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-[1760px]",children:[P,e.jsx("tbody",{children:t.map(o=>e.jsx(De,{purchase:o,onClick:l,activeTab:n,isLeadBuyer:G,onPaymentComplete:c,onReceiptComplete:j,onExcelDownload:g},o.id))})]})})}),e.jsx("div",{className:"hidden sm:block md:hidden w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-[600px] text-[11px]",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-24",children:"ë°œì£¼ë²ˆí˜¸"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-16",children:"ìš”ì²­ì"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-20",children:"ì—…ì²´"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-32",children:"í’ˆëª…"}),e.jsx("th",{className:"text-right p-2 font-medium text-gray-900 w-20",children:"ê¸ˆì•¡"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-900 w-16",children:"ìƒíƒœ"})]})}),e.jsx("tbody",{children:t.map(o=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 cursor-pointer",onClick:()=>l(o),children:[e.jsx("td",{className:"p-2 font-medium",children:o.purchase_order_number||"-"}),e.jsx("td",{className:"p-2",children:o.requester_name}),e.jsx("td",{className:"p-2 truncate",title:o.vendor_name,children:o.vendor_name}),e.jsx("td",{className:"p-2 truncate",title:o.item_name,children:o.item_name||"-"}),e.jsx("td",{className:"p-2 text-right font-medium",children:o.amount_value?`${o.amount_value.toLocaleString()} ${q(o.currency||"KRW")}`:o.total_amount?`${o.total_amount.toLocaleString()} ${q(o.currency||"KRW")}`:`0 ${q(o.currency||"KRW")}`}),e.jsx("td",{className:"p-2 text-center",children:e.jsx($e,{purchase:o})})]},o.id))})]})})}),e.jsx("div",{className:"sm:hidden space-y-3",children:t.map(o=>e.jsx(Z,{purchase:o,onClick:()=>l(o)},o.id))}),e.jsx(qe,{purchaseId:w,isOpen:p,onClose:i,currentUserRoles:s,activeTab:n,onRefresh:a,onDelete:o=>{z(o),D(!0)}}),e.jsx(st,{open:F,onOpenChange:D,children:e.jsxs(_e,{children:[e.jsxs(je,{children:[e.jsx(Ne,{children:"ë°œì£¼ìš”ì²­ ë‚´ì—­ ì‚­ì œ"}),e.jsxs(ve,{children:["ë°œì£¼ìš”ì²­ë²ˆí˜¸ ",h?.purchase_order_number,"ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."]})]}),e.jsxs(we,{children:[e.jsx(Ce,{children:"ì·¨ì†Œ"}),e.jsx(be,{onClick:R,className:"bg-red-600 hover:bg-red-700",children:"ì‚­ì œ"})]})]})})]})});dt.displayName="FastPurchaseTable";export{dt as default};
//# sourceMappingURL=FastPurchaseTable-CChe_ipP.js.map
