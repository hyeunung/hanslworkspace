import{_ as e}from"./supabase-BBTAdlcZ.js";import{r as s,j as a}from"./ui-components-CWOoty1N.js";import{a as r,l as t,B as n,D as c,P as l,S as i,I as d,f as o,g as x,h as m,i as h,j,X as u,d as p,t as v,k as g,m as N,n as b,o as _,p as f}from"./index-BoCLkSMB.js";import{f as w}from"./helpers-Buk9LCEc.js";import{u as y,T as k,a as S,b as C,c as E,S as V,d as q,e as D,D as F,f as $,E as K,g as z,h as O,i as R,j as T,k as I,M as L,l as B,m as M,n as P,F as A,o as G,p as H,q as J,r as Q,s as U}from"./form-J2uPhmpj.js";import{E as W}from"./eye-Cs1ATNJq.js";import{T as X}from"./trash-2-DArXqw6O.js";import{T as Y}from"./textarea-_JP0YxTe.js";import{u as Z}from"./form-libs-8xLfcy6Q.js";import"./react-vendor-DlOlWAvO.js";import"./excel-libs-CEylypxp.js";import"./date-utils-DDl0vnal.js";import"./label-dl7Y4Hku.js";const ee=new class{constructor(){this.supabase=r()}async getVendors(e){try{let s=this.supabase.from("vendors").select("*,vendor_contacts(*)").order("vendor_name");e?.search&&(s=s.or(`\n          vendor_name.ilike.%${e.search}%,\n          business_number.ilike.%${e.search}%,\n          representative.ilike.%${e.search}%,\n          contact_phone.ilike.%${e.search}%,\n          email.ilike.%${e.search}%\n        `)),void 0!==e?.is_active&&(s=s.eq("is_active",e.is_active));const{data:a,error:r}=await s;if(r)throw r;return{success:!0,data:a||[]}}catch(s){return t.error("업체 목록 조회 실패",s),{success:!1,error:s instanceof Error?s.message:"알 수 없는 오류가 발생했습니다."}}}async getVendor(e){try{const{data:s,error:a}=await this.supabase.from("vendors").select("*").eq("id",e).single();if(a)throw a;return{success:!0,data:s}}catch(s){return t.error("업체 조회 실패",s),{success:!1,error:s instanceof Error?s.message:"알 수 없는 오류가 발생했습니다."}}}async createVendor(e){try{if(e.business_number){const{data:s}=await this.supabase.from("vendors").select("id").eq("business_number",e.business_number).single();if(s)return{success:!1,error:"이미 등록된 사업자번호입니다."}}const{data:s}=await this.supabase.from("vendors").select("id").eq("vendor_name",e.vendor_name).single();if(s)return{success:!1,error:"이미 등록된 업체명입니다."};const{data:a,error:r}=await this.supabase.from("vendors").insert({...e,is_active:!0}).select().single();if(r)throw r;return{success:!0,data:a}}catch(s){return t.error("업체 생성 실패",s),{success:!1,error:s instanceof Error?s.message:"알 수 없는 오류가 발생했습니다."}}}async updateVendor(e,s){try{if(s.business_number){const{data:a}=await this.supabase.from("vendors").select("id").eq("business_number",s.business_number).neq("id",e).single();if(a)return{success:!1,error:"이미 등록된 사업자번호입니다."}}if(s.vendor_name){const{data:a}=await this.supabase.from("vendors").select("id").eq("vendor_name",s.vendor_name).neq("id",e).single();if(a)return{success:!1,error:"이미 등록된 업체명입니다."}}const{data:a,error:r}=await this.supabase.from("vendors").update(s).eq("id",e).select().single();if(r)throw r;return{success:!0,data:a}}catch(a){return t.error("업체 수정 실패",a),{success:!1,error:a instanceof Error?a.message:"알 수 없는 오류가 발생했습니다."}}}async deleteVendor(e){try{const{data:s}=await this.supabase.from("purchase_requests").select("id").eq("vendor_id",e).limit(1);if(s&&s.length>0){const{error:s}=await this.supabase.from("vendors").update({is_active:!1}).eq("id",e);if(s)throw s;return{success:!0}}{const{error:s}=await this.supabase.from("vendors").delete().eq("id",e);if(s)throw s;return{success:!0}}}catch(s){return t.error("업체 삭제 실패",s),{success:!1,error:s instanceof Error?s.message:"알 수 없는 오류가 발생했습니다."}}}async toggleVendorStatus(e){try{const{data:s,error:a}=await this.supabase.from("vendors").select("is_active").eq("id",e).single();if(a)throw a;const{data:r,error:t}=await this.supabase.from("vendors").update({is_active:!s.is_active}).eq("id",e).select().single();if(t)throw t;return{success:!0,data:r}}catch(s){return t.error("업체 상태 변경 실패",s),{success:!1,error:s instanceof Error?s.message:"알 수 없는 오류가 발생했습니다."}}}async getVendorContacts(e){try{const{data:s,error:a}=await this.supabase.from("vendor_contacts").select("*").eq("vendor_id",e).order("contact_name");if(a)throw a;return{success:!0,data:s||[]}}catch(s){return t.error("업체 연락처 조회 실패",s),{success:!1,error:s instanceof Error?s.message:"알 수 없는 오류가 발생했습니다."}}}async getVendorsForExport(){try{const{data:e,error:s}=await this.supabase.from("vendors").select("*").order("vendor_name");if(s)throw s;return{success:!0,data:(e||[]).map(e=>({"업체명":e.vendor_name,"사업자번호":e.business_number||"","대표자":e.representative||"","연락처":e.contact_phone||"","주소":e.address||"","이메일":e.email||"","상태":e.is_active?"활성":"비활성","등록일":e.created_at?new Date(e.created_at).toLocaleDateString("ko-KR"):""}))}}catch(e){return t.error("업체 Excel 내보내기 실패",e),{success:!1,error:e instanceof Error?e.message:"알 수 없는 오류가 발생했습니다."}}}};function se({filters:e,onFiltersChange:r,onExport:t,onCreateNew:p}){const[v,g]=s.useState(e.search||""),N=e.search||void 0!==e.is_active;return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"page-title",children:"업체 관리"}),a.jsx("p",{className:"page-subtitle",style:{marginTop:"-2px",marginBottom:"-4px"},children:"Vendors Management"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(n,{variant:"outline",onClick:t,className:"flex items-center gap-1 sm:gap-2 badge-text",children:[a.jsx(c,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{className:"hidden sm:inline badge-text",children:"Excel 내보내기"}),a.jsx("span",{className:"sm:hidden badge-text",children:"Excel"})]}),a.jsxs(n,{onClick:p,className:"flex items-center gap-1 sm:gap-2 badge-text",children:[a.jsx(l,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{className:"badge-text",children:"업체 등록"})]})]})]}),a.jsx("div",{className:"bg-white p-3 sm:p-4 rounded-lg border space-y-4",children:a.jsxs("form",{onSubmit:s=>{s.preventDefault(),r({...e,search:v.trim()||void 0})},className:"flex flex-col sm:flex-row gap-3 sm:gap-4 sm:items-end",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block modal-label mb-1",children:"검색"}),a.jsxs("div",{className:"relative",children:[a.jsx(i,{className:"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3 sm:w-4 sm:h-4"}),a.jsx(d,{type:"text",placeholder:"업체명, 사업자번호, 연락처 검색",value:v,onChange:e=>g(e.target.value),className:"pl-8 sm:pl-10 modal-value h-9"})]})]}),a.jsxs("div",{className:"w-full sm:w-auto sm:min-w-[120px]",children:[a.jsx("label",{className:"block modal-label mb-1",children:"상태"}),a.jsxs(o,{value:void 0===e.is_active?"all":e.is_active?"active":"inactive",onValueChange:s=>{r({...e,is_active:"all"===s?void 0:"active"===s})},children:[a.jsx(x,{className:"h-9",children:a.jsx(m,{})}),a.jsxs(h,{children:[a.jsx(j,{value:"all",children:"전체"}),a.jsx(j,{value:"active",children:"활성"}),a.jsx(j,{value:"inactive",children:"비활성"})]})]})]}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[a.jsx(n,{type:"submit",className:"flex-1 sm:flex-none h-9 badge-text",children:a.jsx("span",{className:"badge-text",children:"검색"})}),N&&a.jsxs(n,{type:"button",variant:"outline",onClick:()=>{g(""),r({})},className:"flex items-center gap-1 h-9 badge-text",children:[a.jsx(u,{className:"w-3 h-3 sm:w-4 sm:h-4"}),a.jsx("span",{className:"hidden sm:inline badge-text",children:"초기화"}),a.jsx("span",{className:"sm:hidden badge-text",children:"초기"})]})]})]})})]})}function ae({vendors:e,onEdit:r,onView:t,onRefresh:c}){const[l,i]=s.useState(null),{sortedData:d,sortConfig:o,handleSort:x}=y(e,"vendor_name","asc"),m=async e=>{i(e.id);try{const s=await ee.toggleVendorStatus(e.id);s.success?(v.success(`업체가 ${e.is_active?"비활성화":"활성화"}되었습니다.`),c()):v.error(s.error||"상태 변경에 실패했습니다.")}catch(s){v.error("상태 변경 중 오류가 발생했습니다.")}finally{i(null)}},h=async e=>{if(confirm(`정말로 '${e.vendor_name}' 업체를 삭제하시겠습니까?`)){i(e.id);try{const s=await ee.deleteVendor(e.id);s.success?(v.success("업체가 삭제되었습니다."),c()):v.error(s.error||"삭제에 실패했습니다.")}catch(s){v.error("삭제 중 오류가 발생했습니다.")}finally{i(null)}}};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"hidden lg:block border rounded-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(k,{children:[a.jsx(S,{children:a.jsxs(C,{children:[a.jsx(E,{className:"w-24 min-w-[80px] lg:w-32",children:a.jsx(V,{sortKey:"vendor_name",currentSortKey:o.key,sortDirection:o.direction,onSort:()=>x("vendor_name"),children:"업체명"})}),a.jsx(E,{className:"w-16 min-w-[50px] text-center",children:"담당자"}),a.jsx(E,{className:"min-w-[200px]",children:"담당자 정보"}),a.jsx(E,{className:"w-28 min-w-[110px]",children:"전화번호"}),a.jsx(E,{className:"w-28 min-w-[110px]",children:"팩스번호"}),a.jsx(E,{className:"w-24 min-w-[100px]",children:"지출예정일"}),a.jsx(E,{className:"w-20 min-w-[60px]",children:a.jsx(V,{sortKey:"created_at",currentSortKey:o.key,sortDirection:o.direction,onSort:()=>x("created_at"),children:"등록일"})}),a.jsx(E,{className:"w-14 min-w-[45px] text-center",children:"작업"})]})}),a.jsx(q,{children:0===e.length?a.jsx(C,{children:a.jsx(D,{colSpan:8,className:"text-center py-8 text-gray-500",children:"등록된 업체가 없습니다."})}):d.map(e=>a.jsxs(C,{children:[a.jsx(D,{className:"modal-value px-2 py-1.5",children:e.vendor_name}),a.jsx(D,{className:"text-center text-[11px] px-1 py-1.5",children:a.jsxs(p,{variant:"outline",className:"text-[10px] px-1 py-0",children:[e.vendor_contacts?.length||0,"명"]})}),a.jsx(D,{className:"px-2 py-1.5",children:a.jsxs("div",{className:"space-y-0.5",children:[e.vendor_contacts&&e.vendor_contacts.length>0?e.vendor_contacts.slice(0,2).map((e,s)=>a.jsxs("div",{className:"text-[10px]",children:[a.jsx("span",{className:"modal-value",children:e.contact_name}),a.jsx("span",{className:"text-gray-500 ml-1",children:e.contact_phone}),e.contact_email&&a.jsx("span",{className:"text-gray-500 ml-1 truncate inline-block max-w-[180px]",children:e.contact_email})]},s)):a.jsx("span",{className:"text-gray-400 text-[10px]",children:"담당자 없음"}),e.vendor_contacts&&e.vendor_contacts.length>2&&a.jsxs("span",{className:"text-[10px] text-gray-500",children:["외 ",e.vendor_contacts.length-2,"명"]})]})}),a.jsx(D,{className:"text-[11px] px-2 py-1.5",children:a.jsx("span",{className:"block truncate",title:e.vendor_phone||"",children:e.vendor_phone||"-"})}),a.jsx(D,{className:"text-[11px] px-2 py-1.5",children:a.jsx("span",{className:"block truncate",title:e.vendor_fax||"",children:e.vendor_fax||"-"})}),a.jsx(D,{className:"text-[11px] px-2 py-1.5",children:a.jsx("span",{className:"block truncate",title:e.vendor_payment_schedule||"",children:e.vendor_payment_schedule||"-"})}),a.jsx(D,{className:"text-[11px] px-2 py-1.5",children:w(e.created_at)}),a.jsx(D,{className:"px-1 py-1.5 text-center",children:a.jsxs(F,{children:[a.jsx($,{asChild:!0,children:a.jsx(n,{variant:"ghost",className:"h-7 w-7 p-0",disabled:l===e.id,children:a.jsx(K,{className:"h-3 w-3"})})}),a.jsxs(z,{align:"end",children:[a.jsxs(O,{onClick:()=>t(e),children:[a.jsx(W,{className:"mr-2 h-4 w-4"}),"상세 보기"]}),a.jsxs(O,{onClick:()=>r(e),children:[a.jsx(R,{className:"mr-2 h-4 w-4"}),"수정"]}),a.jsx(O,{onClick:()=>m(e),children:e.is_active?a.jsxs(a.Fragment,{children:[a.jsx(T,{className:"mr-2 h-4 w-4"}),"비활성화"]}):a.jsxs(a.Fragment,{children:[a.jsx(I,{className:"mr-2 h-4 w-4"}),"활성화"]})}),a.jsxs(O,{onClick:()=>h(e),className:"text-red-600",children:[a.jsx(X,{className:"mr-2 h-4 w-4"}),"삭제"]})]})]})})]},e.id))})]})})}),a.jsx("div",{className:"hidden md:block lg:hidden",children:a.jsx("div",{className:"overflow-x-auto border rounded-lg",children:a.jsxs("table",{className:"w-full min-w-[900px]",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left p-3 header-title text-gray-900",children:"업체명"}),a.jsx("th",{className:"text-center p-3 header-title text-gray-900 w-20",children:"담당자"}),a.jsx("th",{className:"text-left p-3 header-title text-gray-900",children:"연락처"}),a.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-28",children:"전화번호"}),a.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-28",children:"팩스번호"}),a.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-24",children:"지출예정일"}),a.jsx("th",{className:"text-left p-3 header-title text-gray-900 w-24",children:"등록일"}),a.jsx("th",{className:"text-center p-3 header-title text-gray-900 w-16",children:"작업"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===d.length?a.jsx("tr",{children:a.jsx("td",{colSpan:8,className:"text-center py-8 text-gray-500",children:"등록된 업체가 없습니다."})}):d.map(e=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"p-3 modal-value",children:e.vendor_name}),a.jsx("td",{className:"p-3 text-center",children:a.jsxs(p,{variant:"outline",className:"badge-text",children:[e.vendor_contacts?.length||0,"명"]})}),a.jsx("td",{className:"p-3 modal-subtitle",children:e.vendor_contacts&&e.vendor_contacts.length>0?a.jsxs("div",{children:[a.jsx("div",{className:"modal-value",children:e.vendor_contacts[0].contact_name}),a.jsx("div",{className:"text-gray-500 badge-text",children:e.vendor_contacts[0].contact_phone})]}):a.jsx("span",{className:"text-gray-400",children:"담당자 없음"})}),a.jsx("td",{className:"p-3 modal-subtitle",children:a.jsx("span",{className:"block truncate",title:e.vendor_phone||"",children:e.vendor_phone||"-"})}),a.jsx("td",{className:"p-3 modal-subtitle",children:a.jsx("span",{className:"block truncate",title:e.vendor_fax||"",children:e.vendor_fax||"-"})}),a.jsx("td",{className:"p-3 modal-subtitle",children:a.jsx("span",{className:"block truncate",title:e.vendor_payment_schedule||"",children:e.vendor_payment_schedule||"-"})}),a.jsx("td",{className:"p-3 modal-subtitle",children:w(e.created_at)}),a.jsx("td",{className:"p-3 text-center",children:a.jsxs(F,{children:[a.jsx($,{asChild:!0,children:a.jsx(n,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:a.jsx(K,{className:"h-4 w-4"})})}),a.jsxs(z,{align:"end",children:[a.jsxs(O,{onClick:()=>t(e),children:[a.jsx(W,{className:"mr-2 h-4 w-4"}),"상세 보기"]}),a.jsxs(O,{onClick:()=>r(e),children:[a.jsx(R,{className:"mr-2 h-4 w-4"}),"수정"]}),a.jsx(O,{onClick:()=>m(e),children:e.is_active?a.jsxs(a.Fragment,{children:[a.jsx(T,{className:"mr-2 h-4 w-4"}),"비활성화"]}):a.jsxs(a.Fragment,{children:[a.jsx(I,{className:"mr-2 h-4 w-4"}),"활성화"]})}),a.jsxs(O,{onClick:()=>h(e),className:"text-red-600",children:[a.jsx(X,{className:"mr-2 h-4 w-4"}),"삭제"]})]})]})})]},e.id))})]})})}),a.jsx("div",{className:"block md:hidden space-y-3",children:0===d.length?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"등록된 업체가 없습니다."}):d.map(e=>a.jsxs(L,{children:[a.jsx(B,{children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{children:e.vendor_name}),a.jsxs(p,{variant:"outline",children:[e.vendor_contacts?.length||0,"명"]})]})}),a.jsx(M,{label:"담당자",value:a.jsxs("div",{className:"space-y-1",children:[e.vendor_contacts&&e.vendor_contacts.length>0?e.vendor_contacts.slice(0,2).map((e,s)=>a.jsxs("div",{className:"modal-subtitle",children:[a.jsx("div",{className:"modal-value",children:e.contact_name}),a.jsx("div",{className:"text-gray-500 badge-text",children:e.contact_phone}),e.contact_email&&a.jsx("div",{className:"text-gray-500 badge-text",children:e.contact_email})]},s)):a.jsx("span",{className:"text-gray-400",children:"담당자 없음"}),e.vendor_contacts&&e.vendor_contacts.length>2&&a.jsxs("span",{className:"modal-subtitle text-gray-500",children:["외 ",e.vendor_contacts.length-2,"명"]})]})}),a.jsx(M,{label:"전화번호",value:e.vendor_phone||"-"}),a.jsx(M,{label:"팩스번호",value:e.vendor_fax||"-"}),a.jsx(M,{label:"지출예정일",value:e.vendor_payment_schedule||"-"}),a.jsx(M,{label:"등록일",value:w(e.created_at)}),a.jsxs(P,{children:[a.jsx(n,{size:"sm",variant:"outline",onClick:()=>t(e),children:a.jsx(W,{className:"w-4 h-4"})}),a.jsx(n,{size:"sm",variant:"outline",onClick:()=>r(e),children:a.jsx(R,{className:"w-4 h-4"})}),a.jsx(n,{size:"sm",variant:"outline",onClick:()=>m(e),disabled:l===e.id,children:e.is_active?a.jsx(T,{className:"w-4 h-4"}):a.jsx(I,{className:"w-4 h-4"})}),a.jsx(n,{size:"sm",variant:"outline",className:"text-red-600",onClick:()=>h(e),disabled:l===e.id,children:a.jsx(X,{className:"w-4 h-4"})})]})]},e.id))})]})}function re({isOpen:e,onClose:r,vendor:t,onSave:c,mode:l}){const[i,o]=s.useState(!1),x=Z({defaultValues:{vendor_name:"",business_number:"",representative:"",contact_phone:"",address:"",email:""}});s.useEffect(()=>{t&&e?x.reset({vendor_name:t.vendor_name||"",business_number:t.business_number||"",representative:t.representative||"",contact_phone:t.contact_phone||"",address:t.address||"",email:t.email||""}):!t&&e&&x.reset({vendor_name:"",business_number:"",representative:"",contact_phone:"",address:"",email:""})},[t,e,x]);const m="view"===l;return a.jsx(g,{open:e,onOpenChange:r,children:a.jsxs(N,{className:"w-full max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[a.jsx(b,{children:a.jsx(_,{children:(()=>{switch(l){case"create":return"업체 등록";case"edit":return"업체 수정";case"view":return"업체 상세";default:return"업체"}})()})}),a.jsx(A,{...x,children:a.jsxs("form",{onSubmit:x.handleSubmit(async e=>{o(!0);try{let s;"create"===l?s=await ee.createVendor(e):"edit"===l&&t&&(s=await ee.updateVendor(t.id,e)),s?.success?(v.success("create"===l?"업체가 등록되었습니다.":"업체 정보가 수정되었습니다."),c(),r()):v.error(s?.error||"처리 중 오류가 발생했습니다.")}catch(s){v.error("처리 중 오류가 발생했습니다.")}finally{o(!1)}}),className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(G,{control:x.control,name:"vendor_name",rules:{required:"업체명을 입력해주세요."},render:({field:e})=>a.jsxs(H,{children:[a.jsx(J,{children:"업체명 *"}),a.jsx(Q,{children:a.jsx(d,{...e,placeholder:"업체명을 입력하세요",disabled:m})}),a.jsx(U,{})]})}),a.jsx(G,{control:x.control,name:"business_number",render:({field:e})=>a.jsxs(H,{children:[a.jsx(J,{children:"사업자번호"}),a.jsx(Q,{children:a.jsx(d,{...e,placeholder:"000-00-00000",disabled:m})}),a.jsx(U,{})]})}),a.jsx(G,{control:x.control,name:"representative",render:({field:e})=>a.jsxs(H,{children:[a.jsx(J,{children:"대표자"}),a.jsx(Q,{children:a.jsx(d,{...e,placeholder:"대표자명을 입력하세요",disabled:m})}),a.jsx(U,{})]})}),a.jsx(G,{control:x.control,name:"contact_phone",render:({field:e})=>a.jsxs(H,{children:[a.jsx(J,{children:"연락처"}),a.jsx(Q,{children:a.jsx(d,{...e,placeholder:"010-0000-0000",disabled:m})}),a.jsx(U,{})]})}),a.jsx(G,{control:x.control,name:"email",render:({field:e})=>a.jsxs(H,{children:[a.jsx(J,{children:"이메일"}),a.jsx(Q,{children:a.jsx(d,{...e,type:"email",placeholder:"company@example.com",disabled:m})}),a.jsx(U,{})]})})]}),a.jsx(G,{control:x.control,name:"address",render:({field:e})=>a.jsxs(H,{children:[a.jsx(J,{children:"주소"}),a.jsx(Q,{children:a.jsx(Y,{...e,placeholder:"주소를 입력하세요",className:"min-h-[80px]",disabled:m})}),a.jsx(U,{})]})}),"view"===l&&t&&a.jsx("div",{className:"pt-4 border-t",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4 modal-subtitle",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"상태:"}),a.jsx("span",{className:"ml-2 px-2 py-1 business-radius-badge badge-text "+(t.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:t.is_active?"활성":"비활성"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"등록일:"}),a.jsx("span",{className:"ml-2",children:t.created_at?new Date(t.created_at).toLocaleDateString("ko-KR"):"-"})]})]})}),a.jsxs(f,{className:"gap-2",children:[a.jsx(n,{type:"button",variant:"outline",onClick:r,children:"view"===l?"닫기":"취소"}),!m&&a.jsx(n,{type:"submit",disabled:i,children:i?"create"===l?"등록 중...":"수정 중...":"create"===l?"등록":"수정"})]})]})})]})})}function te(){const[r,t]=s.useState([]),[n,c]=s.useState([]),[l,i]=s.useState(!0),[d,o]=s.useState({}),[x,m]=s.useState(!1),[h,j]=s.useState(null),[u,p]=s.useState("create"),g=async()=>{i(!0);try{const e=await ee.getVendors(d);e.success&&e.data?(t(e.data),c(e.data)):v.error(e.error||"업체 목록을 불러오는데 실패했습니다.")}catch(e){v.error("업체 목록을 불러오는 중 오류가 발생했습니다.")}finally{i(!1)}};s.useEffect(()=>{g()},[d]);return l&&0===r.length?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),a.jsx("p",{className:"mt-2 card-subtitle",children:"업체 목록을 불러오는 중..."})]})}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-6",children:[a.jsx(se,{filters:d,onFiltersChange:o,onExport:async()=>{try{const s=await ee.getVendorsForExport();if(s.success&&s.data){const a=await e(()=>import("./excel-libs-CEylypxp.js").then(e=>e.x),[]),r=a.utils.json_to_sheet(s.data),t=a.utils.book_new();a.utils.book_append_sheet(t,r,"업체 목록");const n=`업체_목록_${(new Date).toISOString().slice(0,10)}.xlsx`;a.writeFile(t,n),v.success("Excel 파일이 다운로드되었습니다.")}else v.error(s.error||"Excel 내보내기에 실패했습니다.")}catch(s){v.error("Excel 내보내기 중 오류가 발생했습니다.")}},onCreateNew:()=>{j(null),p("create"),m(!0)}}),a.jsxs("div",{className:"bg-white rounded-lg border",children:[a.jsx("div",{className:"p-4 border-b",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("h3",{className:"modal-title",children:"업체 목록"}),a.jsxs("span",{className:"badge-base bg-blue-50 text-blue-600",children:["총 ",n.length,"개"]})]}),a.jsx("div",{className:"card-description",children:l&&"업데이트 중..."})]})}),a.jsx(ae,{vendors:n,onEdit:e=>{j(e),p("edit"),m(!0)},onView:e=>{j(e),p("view"),m(!0)},onRefresh:g})]}),a.jsx(re,{isOpen:x,onClose:()=>{m(!1),j(null)},vendor:h,onSave:()=>{g()},mode:u})]})})}export{te as default};
//# sourceMappingURL=VendorMain-B3g4oGqS.js.map
