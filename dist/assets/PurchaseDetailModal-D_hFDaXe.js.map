{"version":3,"file":"PurchaseDetailModal-D_hFDaXe.js","sources":["../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/grip-vertical.js","../../node_modules/lucide-react/dist/esm/icons/message-square-plus.js","../../node_modules/lucide-react/dist/esm/icons/pen.js","../../node_modules/lucide-react/dist/esm/icons/truck.js","../../node_modules/@radix-ui/react-alert-dialog/dist/index.mjs","../../src/components/ui/alert-dialog.tsx","../../node_modules/@dnd-kit/utilities/dist/utilities.esm.js","../../node_modules/@dnd-kit/accessibility/dist/accessibility.esm.js","../../node_modules/@dnd-kit/core/dist/core.esm.js","../../node_modules/@dnd-kit/sortable/dist/sortable.esm.js","../../src/components/ui/date-amount-picker-popover.tsx","../../src/components/ui/date-quantity-picker-popover.tsx","../../src/hooks/useConfirmDateAction.ts","../../src/constants/columnSettings.ts","../../src/components/purchase/PurchaseDetailModal.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"9\", cy: \"12\", r: \"1\", key: \"1vctgf\" }],\n  [\"circle\", { cx: \"9\", cy: \"5\", r: \"1\", key: \"hp0tcf\" }],\n  [\"circle\", { cx: \"9\", cy: \"19\", r: \"1\", key: \"fkjjf6\" }],\n  [\"circle\", { cx: \"15\", cy: \"12\", r: \"1\", key: \"1tmaij\" }],\n  [\"circle\", { cx: \"15\", cy: \"5\", r: \"1\", key: \"19l28e\" }],\n  [\"circle\", { cx: \"15\", cy: \"19\", r: \"1\", key: \"f4zoj3\" }]\n];\nconst GripVertical = createLucideIcon(\"grip-vertical\", __iconNode);\n\nexport { __iconNode, GripVertical as default };\n//# sourceMappingURL=grip-vertical.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z\",\n      key: \"18887p\"\n    }\n  ],\n  [\"path\", { d: \"M12 8v6\", key: \"1ib9pf\" }],\n  [\"path\", { d: \"M9 11h6\", key: \"1fldmi\" }]\n];\nconst MessageSquarePlus = createLucideIcon(\"message-square-plus\", __iconNode);\n\nexport { __iconNode, MessageSquarePlus as default };\n//# sourceMappingURL=message-square-plus.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ]\n];\nconst Pen = createLucideIcon(\"pen\", __iconNode);\n\nexport { __iconNode, Pen as default };\n//# sourceMappingURL=pen.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2\", key: \"wrbu53\" }],\n  [\"path\", { d: \"M15 18H9\", key: \"1lyqi6\" }],\n  [\n    \"path\",\n    {\n      d: \"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14\",\n      key: \"lysw3i\"\n    }\n  ],\n  [\"circle\", { cx: \"17\", cy: \"18\", r: \"2\", key: \"332jqn\" }],\n  [\"circle\", { cx: \"7\", cy: \"18\", r: \"2\", key: \"19iecd\" }]\n];\nconst Truck = createLucideIcon(\"truck\", __iconNode);\n\nexport { __iconNode, Truck as default };\n//# sourceMappingURL=truck.js.map\n","\"use client\";\n\n// src/alert-dialog.tsx\nimport * as React from \"react\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\nimport { createDialogScope } from \"@radix-ui/react-dialog\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { createSlottable } from \"@radix-ui/react-slot\";\nimport { jsx, jsxs } from \"react/jsx-runtime\";\nvar ROOT_NAME = \"AlertDialog\";\nvar [createAlertDialogContext, createAlertDialogScope] = createContextScope(ROOT_NAME, [\n  createDialogScope\n]);\nvar useDialogScope = createDialogScope();\nvar AlertDialog = (props) => {\n  const { __scopeAlertDialog, ...alertDialogProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Root, { ...dialogScope, ...alertDialogProps, modal: true });\n};\nAlertDialog.displayName = ROOT_NAME;\nvar TRIGGER_NAME = \"AlertDialogTrigger\";\nvar AlertDialogTrigger = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...triggerProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Trigger, { ...dialogScope, ...triggerProps, ref: forwardedRef });\n  }\n);\nAlertDialogTrigger.displayName = TRIGGER_NAME;\nvar PORTAL_NAME = \"AlertDialogPortal\";\nvar AlertDialogPortal = (props) => {\n  const { __scopeAlertDialog, ...portalProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Portal, { ...dialogScope, ...portalProps });\n};\nAlertDialogPortal.displayName = PORTAL_NAME;\nvar OVERLAY_NAME = \"AlertDialogOverlay\";\nvar AlertDialogOverlay = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...overlayProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Overlay, { ...dialogScope, ...overlayProps, ref: forwardedRef });\n  }\n);\nAlertDialogOverlay.displayName = OVERLAY_NAME;\nvar CONTENT_NAME = \"AlertDialogContent\";\nvar [AlertDialogContentProvider, useAlertDialogContentContext] = createAlertDialogContext(CONTENT_NAME);\nvar Slottable = createSlottable(\"AlertDialogContent\");\nvar AlertDialogContent = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, children, ...contentProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    const contentRef = React.useRef(null);\n    const composedRefs = useComposedRefs(forwardedRef, contentRef);\n    const cancelRef = React.useRef(null);\n    return /* @__PURE__ */ jsx(\n      DialogPrimitive.WarningProvider,\n      {\n        contentName: CONTENT_NAME,\n        titleName: TITLE_NAME,\n        docsSlug: \"alert-dialog\",\n        children: /* @__PURE__ */ jsx(AlertDialogContentProvider, { scope: __scopeAlertDialog, cancelRef, children: /* @__PURE__ */ jsxs(\n          DialogPrimitive.Content,\n          {\n            role: \"alertdialog\",\n            ...dialogScope,\n            ...contentProps,\n            ref: composedRefs,\n            onOpenAutoFocus: composeEventHandlers(contentProps.onOpenAutoFocus, (event) => {\n              event.preventDefault();\n              cancelRef.current?.focus({ preventScroll: true });\n            }),\n            onPointerDownOutside: (event) => event.preventDefault(),\n            onInteractOutside: (event) => event.preventDefault(),\n            children: [\n              /* @__PURE__ */ jsx(Slottable, { children }),\n              /* @__PURE__ */ jsx(DescriptionWarning, { contentRef })\n            ]\n          }\n        ) })\n      }\n    );\n  }\n);\nAlertDialogContent.displayName = CONTENT_NAME;\nvar TITLE_NAME = \"AlertDialogTitle\";\nvar AlertDialogTitle = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...titleProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Title, { ...dialogScope, ...titleProps, ref: forwardedRef });\n  }\n);\nAlertDialogTitle.displayName = TITLE_NAME;\nvar DESCRIPTION_NAME = \"AlertDialogDescription\";\nvar AlertDialogDescription = React.forwardRef((props, forwardedRef) => {\n  const { __scopeAlertDialog, ...descriptionProps } = props;\n  const dialogScope = useDialogScope(__scopeAlertDialog);\n  return /* @__PURE__ */ jsx(DialogPrimitive.Description, { ...dialogScope, ...descriptionProps, ref: forwardedRef });\n});\nAlertDialogDescription.displayName = DESCRIPTION_NAME;\nvar ACTION_NAME = \"AlertDialogAction\";\nvar AlertDialogAction = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...actionProps } = props;\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Close, { ...dialogScope, ...actionProps, ref: forwardedRef });\n  }\n);\nAlertDialogAction.displayName = ACTION_NAME;\nvar CANCEL_NAME = \"AlertDialogCancel\";\nvar AlertDialogCancel = React.forwardRef(\n  (props, forwardedRef) => {\n    const { __scopeAlertDialog, ...cancelProps } = props;\n    const { cancelRef } = useAlertDialogContentContext(CANCEL_NAME, __scopeAlertDialog);\n    const dialogScope = useDialogScope(__scopeAlertDialog);\n    const ref = useComposedRefs(forwardedRef, cancelRef);\n    return /* @__PURE__ */ jsx(DialogPrimitive.Close, { ...dialogScope, ...cancelProps, ref });\n  }\n);\nAlertDialogCancel.displayName = CANCEL_NAME;\nvar DescriptionWarning = ({ contentRef }) => {\n  const MESSAGE = `\\`${CONTENT_NAME}\\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \\`${CONTENT_NAME}\\` by passing a \\`${DESCRIPTION_NAME}\\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \\`id\\` and passing the same value to the \\`aria-describedby\\` prop in \\`${CONTENT_NAME}\\`. If the description is confusing or duplicative for sighted users, you can use the \\`@radix-ui/react-visually-hidden\\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;\n  React.useEffect(() => {\n    const hasDescription = document.getElementById(\n      contentRef.current?.getAttribute(\"aria-describedby\")\n    );\n    if (!hasDescription) console.warn(MESSAGE);\n  }, [MESSAGE, contentRef]);\n  return null;\n};\nvar Root2 = AlertDialog;\nvar Trigger2 = AlertDialogTrigger;\nvar Portal2 = AlertDialogPortal;\nvar Overlay2 = AlertDialogOverlay;\nvar Content2 = AlertDialogContent;\nvar Action = AlertDialogAction;\nvar Cancel = AlertDialogCancel;\nvar Title2 = AlertDialogTitle;\nvar Description2 = AlertDialogDescription;\nexport {\n  Action,\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogOverlay,\n  AlertDialogPortal,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n  Cancel,\n  Content2 as Content,\n  Description2 as Description,\n  Overlay2 as Overlay,\n  Portal2 as Portal,\n  Root2 as Root,\n  Title2 as Title,\n  Trigger2 as Trigger,\n  createAlertDialogScope\n};\n//# sourceMappingURL=index.mjs.map\n","import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm\",\n      \"data-[state=open]:animate-in data-[state=closed]:animate-out\",\n      \"data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50\",\n        \"w-full max-w-md translate-x-[-50%] translate-y-[-50%]\",\n        \"grid gap-4 bg-white border border-gray-200\",\n        \"rounded-lg p-6 shadow-professional-xl\",\n        \"duration-200\",\n        \"data-[state=open]:animate-in data-[state=closed]:animate-out\",\n        \"data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n        \"data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95\",\n        \"data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]\",\n        \"data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end gap-3\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-gray-800 tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-gray-600\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}","import { useMemo, useLayoutEffect, useEffect, useRef, useCallback } from 'react';\n\nfunction useCombinedRefs() {\n  for (var _len = arguments.length, refs = new Array(_len), _key = 0; _key < _len; _key++) {\n    refs[_key] = arguments[_key];\n  }\n\n  return useMemo(() => node => {\n    refs.forEach(ref => ref(node));\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  refs);\n}\n\n// https://github.com/facebook/react/blob/master/packages/shared/ExecutionEnvironment.js\nconst canUseDOM = typeof window !== 'undefined' && typeof window.document !== 'undefined' && typeof window.document.createElement !== 'undefined';\n\nfunction isWindow(element) {\n  const elementString = Object.prototype.toString.call(element);\n  return elementString === '[object Window]' || // In Electron context the Window object serializes to [object global]\n  elementString === '[object global]';\n}\n\nfunction isNode(node) {\n  return 'nodeType' in node;\n}\n\nfunction getWindow(target) {\n  var _target$ownerDocument, _target$ownerDocument2;\n\n  if (!target) {\n    return window;\n  }\n\n  if (isWindow(target)) {\n    return target;\n  }\n\n  if (!isNode(target)) {\n    return window;\n  }\n\n  return (_target$ownerDocument = (_target$ownerDocument2 = target.ownerDocument) == null ? void 0 : _target$ownerDocument2.defaultView) != null ? _target$ownerDocument : window;\n}\n\nfunction isDocument(node) {\n  const {\n    Document\n  } = getWindow(node);\n  return node instanceof Document;\n}\n\nfunction isHTMLElement(node) {\n  if (isWindow(node)) {\n    return false;\n  }\n\n  return node instanceof getWindow(node).HTMLElement;\n}\n\nfunction isSVGElement(node) {\n  return node instanceof getWindow(node).SVGElement;\n}\n\nfunction getOwnerDocument(target) {\n  if (!target) {\n    return document;\n  }\n\n  if (isWindow(target)) {\n    return target.document;\n  }\n\n  if (!isNode(target)) {\n    return document;\n  }\n\n  if (isDocument(target)) {\n    return target;\n  }\n\n  if (isHTMLElement(target) || isSVGElement(target)) {\n    return target.ownerDocument;\n  }\n\n  return document;\n}\n\n/**\r\n * A hook that resolves to useEffect on the server and useLayoutEffect on the client\r\n * @param callback {function} Callback function that is invoked when the dependencies of the hook change\r\n */\n\nconst useIsomorphicLayoutEffect = canUseDOM ? useLayoutEffect : useEffect;\n\nfunction useEvent(handler) {\n  const handlerRef = useRef(handler);\n  useIsomorphicLayoutEffect(() => {\n    handlerRef.current = handler;\n  });\n  return useCallback(function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return handlerRef.current == null ? void 0 : handlerRef.current(...args);\n  }, []);\n}\n\nfunction useInterval() {\n  const intervalRef = useRef(null);\n  const set = useCallback((listener, duration) => {\n    intervalRef.current = setInterval(listener, duration);\n  }, []);\n  const clear = useCallback(() => {\n    if (intervalRef.current !== null) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n  }, []);\n  return [set, clear];\n}\n\nfunction useLatestValue(value, dependencies) {\n  if (dependencies === void 0) {\n    dependencies = [value];\n  }\n\n  const valueRef = useRef(value);\n  useIsomorphicLayoutEffect(() => {\n    if (valueRef.current !== value) {\n      valueRef.current = value;\n    }\n  }, dependencies);\n  return valueRef;\n}\n\nfunction useLazyMemo(callback, dependencies) {\n  const valueRef = useRef();\n  return useMemo(() => {\n    const newValue = callback(valueRef.current);\n    valueRef.current = newValue;\n    return newValue;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [...dependencies]);\n}\n\nfunction useNodeRef(onChange) {\n  const onChangeHandler = useEvent(onChange);\n  const node = useRef(null);\n  const setNodeRef = useCallback(element => {\n    if (element !== node.current) {\n      onChangeHandler == null ? void 0 : onChangeHandler(element, node.current);\n    }\n\n    node.current = element;\n  }, //eslint-disable-next-line\n  []);\n  return [node, setNodeRef];\n}\n\nfunction usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n  return ref.current;\n}\n\nlet ids = {};\nfunction useUniqueId(prefix, value) {\n  return useMemo(() => {\n    if (value) {\n      return value;\n    }\n\n    const id = ids[prefix] == null ? 0 : ids[prefix] + 1;\n    ids[prefix] = id;\n    return prefix + \"-\" + id;\n  }, [prefix, value]);\n}\n\nfunction createAdjustmentFn(modifier) {\n  return function (object) {\n    for (var _len = arguments.length, adjustments = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      adjustments[_key - 1] = arguments[_key];\n    }\n\n    return adjustments.reduce((accumulator, adjustment) => {\n      const entries = Object.entries(adjustment);\n\n      for (const [key, valueAdjustment] of entries) {\n        const value = accumulator[key];\n\n        if (value != null) {\n          accumulator[key] = value + modifier * valueAdjustment;\n        }\n      }\n\n      return accumulator;\n    }, { ...object\n    });\n  };\n}\n\nconst add = /*#__PURE__*/createAdjustmentFn(1);\nconst subtract = /*#__PURE__*/createAdjustmentFn(-1);\n\nfunction hasViewportRelativeCoordinates(event) {\n  return 'clientX' in event && 'clientY' in event;\n}\n\nfunction isKeyboardEvent(event) {\n  if (!event) {\n    return false;\n  }\n\n  const {\n    KeyboardEvent\n  } = getWindow(event.target);\n  return KeyboardEvent && event instanceof KeyboardEvent;\n}\n\nfunction isTouchEvent(event) {\n  if (!event) {\n    return false;\n  }\n\n  const {\n    TouchEvent\n  } = getWindow(event.target);\n  return TouchEvent && event instanceof TouchEvent;\n}\n\n/**\r\n * Returns the normalized x and y coordinates for mouse and touch events.\r\n */\n\nfunction getEventCoordinates(event) {\n  if (isTouchEvent(event)) {\n    if (event.touches && event.touches.length) {\n      const {\n        clientX: x,\n        clientY: y\n      } = event.touches[0];\n      return {\n        x,\n        y\n      };\n    } else if (event.changedTouches && event.changedTouches.length) {\n      const {\n        clientX: x,\n        clientY: y\n      } = event.changedTouches[0];\n      return {\n        x,\n        y\n      };\n    }\n  }\n\n  if (hasViewportRelativeCoordinates(event)) {\n    return {\n      x: event.clientX,\n      y: event.clientY\n    };\n  }\n\n  return null;\n}\n\nconst CSS = /*#__PURE__*/Object.freeze({\n  Translate: {\n    toString(transform) {\n      if (!transform) {\n        return;\n      }\n\n      const {\n        x,\n        y\n      } = transform;\n      return \"translate3d(\" + (x ? Math.round(x) : 0) + \"px, \" + (y ? Math.round(y) : 0) + \"px, 0)\";\n    }\n\n  },\n  Scale: {\n    toString(transform) {\n      if (!transform) {\n        return;\n      }\n\n      const {\n        scaleX,\n        scaleY\n      } = transform;\n      return \"scaleX(\" + scaleX + \") scaleY(\" + scaleY + \")\";\n    }\n\n  },\n  Transform: {\n    toString(transform) {\n      if (!transform) {\n        return;\n      }\n\n      return [CSS.Translate.toString(transform), CSS.Scale.toString(transform)].join(' ');\n    }\n\n  },\n  Transition: {\n    toString(_ref) {\n      let {\n        property,\n        duration,\n        easing\n      } = _ref;\n      return property + \" \" + duration + \"ms \" + easing;\n    }\n\n  }\n});\n\nconst SELECTOR = 'a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]';\nfunction findFirstFocusableNode(element) {\n  if (element.matches(SELECTOR)) {\n    return element;\n  }\n\n  return element.querySelector(SELECTOR);\n}\n\nexport { CSS, add, canUseDOM, findFirstFocusableNode, getEventCoordinates, getOwnerDocument, getWindow, hasViewportRelativeCoordinates, isDocument, isHTMLElement, isKeyboardEvent, isNode, isSVGElement, isTouchEvent, isWindow, subtract, useCombinedRefs, useEvent, useInterval, useIsomorphicLayoutEffect, useLatestValue, useLazyMemo, useNodeRef, usePrevious, useUniqueId };\n//# sourceMappingURL=utilities.esm.js.map\n","import React, { useState, useCallback } from 'react';\n\nconst hiddenStyles = {\n  display: 'none'\n};\nfunction HiddenText(_ref) {\n  let {\n    id,\n    value\n  } = _ref;\n  return React.createElement(\"div\", {\n    id: id,\n    style: hiddenStyles\n  }, value);\n}\n\nfunction LiveRegion(_ref) {\n  let {\n    id,\n    announcement,\n    ariaLiveType = \"assertive\"\n  } = _ref;\n  // Hide element visually but keep it readable by screen readers\n  const visuallyHidden = {\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    width: 1,\n    height: 1,\n    margin: -1,\n    border: 0,\n    padding: 0,\n    overflow: 'hidden',\n    clip: 'rect(0 0 0 0)',\n    clipPath: 'inset(100%)',\n    whiteSpace: 'nowrap'\n  };\n  return React.createElement(\"div\", {\n    id: id,\n    style: visuallyHidden,\n    role: \"status\",\n    \"aria-live\": ariaLiveType,\n    \"aria-atomic\": true\n  }, announcement);\n}\n\nfunction useAnnouncement() {\n  const [announcement, setAnnouncement] = useState('');\n  const announce = useCallback(value => {\n    if (value != null) {\n      setAnnouncement(value);\n    }\n  }, []);\n  return {\n    announce,\n    announcement\n  };\n}\n\nexport { HiddenText, LiveRegion, useAnnouncement };\n//# sourceMappingURL=accessibility.esm.js.map\n","import React, { createContext, useContext, useEffect, useState, useCallback, useMemo, useRef, memo, useReducer, cloneElement, forwardRef } from 'react';\nimport { createPortal, unstable_batchedUpdates } from 'react-dom';\nimport { useUniqueId, getEventCoordinates, getWindow, isDocument, isHTMLElement, isSVGElement, canUseDOM, isWindow, isNode, getOwnerDocument, add, isKeyboardEvent, subtract, useLazyMemo, useInterval, usePrevious, useLatestValue, useEvent, useIsomorphicLayoutEffect, useNodeRef, findFirstFocusableNode, CSS } from '@dnd-kit/utilities';\nimport { useAnnouncement, HiddenText, LiveRegion } from '@dnd-kit/accessibility';\n\nconst DndMonitorContext = /*#__PURE__*/createContext(null);\n\nfunction useDndMonitor(listener) {\n  const registerListener = useContext(DndMonitorContext);\n  useEffect(() => {\n    if (!registerListener) {\n      throw new Error('useDndMonitor must be used within a children of <DndContext>');\n    }\n\n    const unsubscribe = registerListener(listener);\n    return unsubscribe;\n  }, [listener, registerListener]);\n}\n\nfunction useDndMonitorProvider() {\n  const [listeners] = useState(() => new Set());\n  const registerListener = useCallback(listener => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  }, [listeners]);\n  const dispatch = useCallback(_ref => {\n    let {\n      type,\n      event\n    } = _ref;\n    listeners.forEach(listener => {\n      var _listener$type;\n\n      return (_listener$type = listener[type]) == null ? void 0 : _listener$type.call(listener, event);\n    });\n  }, [listeners]);\n  return [dispatch, registerListener];\n}\n\nconst defaultScreenReaderInstructions = {\n  draggable: \"\\n    To pick up a draggable item, press the space bar.\\n    While dragging, use the arrow keys to move the item.\\n    Press space again to drop the item in its new position, or press escape to cancel.\\n  \"\n};\nconst defaultAnnouncements = {\n  onDragStart(_ref) {\n    let {\n      active\n    } = _ref;\n    return \"Picked up draggable item \" + active.id + \".\";\n  },\n\n  onDragOver(_ref2) {\n    let {\n      active,\n      over\n    } = _ref2;\n\n    if (over) {\n      return \"Draggable item \" + active.id + \" was moved over droppable area \" + over.id + \".\";\n    }\n\n    return \"Draggable item \" + active.id + \" is no longer over a droppable area.\";\n  },\n\n  onDragEnd(_ref3) {\n    let {\n      active,\n      over\n    } = _ref3;\n\n    if (over) {\n      return \"Draggable item \" + active.id + \" was dropped over droppable area \" + over.id;\n    }\n\n    return \"Draggable item \" + active.id + \" was dropped.\";\n  },\n\n  onDragCancel(_ref4) {\n    let {\n      active\n    } = _ref4;\n    return \"Dragging was cancelled. Draggable item \" + active.id + \" was dropped.\";\n  }\n\n};\n\nfunction Accessibility(_ref) {\n  let {\n    announcements = defaultAnnouncements,\n    container,\n    hiddenTextDescribedById,\n    screenReaderInstructions = defaultScreenReaderInstructions\n  } = _ref;\n  const {\n    announce,\n    announcement\n  } = useAnnouncement();\n  const liveRegionId = useUniqueId(\"DndLiveRegion\");\n  const [mounted, setMounted] = useState(false);\n  useEffect(() => {\n    setMounted(true);\n  }, []);\n  useDndMonitor(useMemo(() => ({\n    onDragStart(_ref2) {\n      let {\n        active\n      } = _ref2;\n      announce(announcements.onDragStart({\n        active\n      }));\n    },\n\n    onDragMove(_ref3) {\n      let {\n        active,\n        over\n      } = _ref3;\n\n      if (announcements.onDragMove) {\n        announce(announcements.onDragMove({\n          active,\n          over\n        }));\n      }\n    },\n\n    onDragOver(_ref4) {\n      let {\n        active,\n        over\n      } = _ref4;\n      announce(announcements.onDragOver({\n        active,\n        over\n      }));\n    },\n\n    onDragEnd(_ref5) {\n      let {\n        active,\n        over\n      } = _ref5;\n      announce(announcements.onDragEnd({\n        active,\n        over\n      }));\n    },\n\n    onDragCancel(_ref6) {\n      let {\n        active,\n        over\n      } = _ref6;\n      announce(announcements.onDragCancel({\n        active,\n        over\n      }));\n    }\n\n  }), [announce, announcements]));\n\n  if (!mounted) {\n    return null;\n  }\n\n  const markup = React.createElement(React.Fragment, null, React.createElement(HiddenText, {\n    id: hiddenTextDescribedById,\n    value: screenReaderInstructions.draggable\n  }), React.createElement(LiveRegion, {\n    id: liveRegionId,\n    announcement: announcement\n  }));\n  return container ? createPortal(markup, container) : markup;\n}\n\nvar Action;\n\n(function (Action) {\n  Action[\"DragStart\"] = \"dragStart\";\n  Action[\"DragMove\"] = \"dragMove\";\n  Action[\"DragEnd\"] = \"dragEnd\";\n  Action[\"DragCancel\"] = \"dragCancel\";\n  Action[\"DragOver\"] = \"dragOver\";\n  Action[\"RegisterDroppable\"] = \"registerDroppable\";\n  Action[\"SetDroppableDisabled\"] = \"setDroppableDisabled\";\n  Action[\"UnregisterDroppable\"] = \"unregisterDroppable\";\n})(Action || (Action = {}));\n\nfunction noop() {}\n\nfunction useSensor(sensor, options) {\n  return useMemo(() => ({\n    sensor,\n    options: options != null ? options : {}\n  }), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [sensor, options]);\n}\n\nfunction useSensors() {\n  for (var _len = arguments.length, sensors = new Array(_len), _key = 0; _key < _len; _key++) {\n    sensors[_key] = arguments[_key];\n  }\n\n  return useMemo(() => [...sensors].filter(sensor => sensor != null), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [...sensors]);\n}\n\nconst defaultCoordinates = /*#__PURE__*/Object.freeze({\n  x: 0,\n  y: 0\n});\n\n/**\r\n * Returns the distance between two points\r\n */\nfunction distanceBetween(p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}\n\nfunction getRelativeTransformOrigin(event, rect) {\n  const eventCoordinates = getEventCoordinates(event);\n\n  if (!eventCoordinates) {\n    return '0 0';\n  }\n\n  const transformOrigin = {\n    x: (eventCoordinates.x - rect.left) / rect.width * 100,\n    y: (eventCoordinates.y - rect.top) / rect.height * 100\n  };\n  return transformOrigin.x + \"% \" + transformOrigin.y + \"%\";\n}\n\n/**\r\n * Sort collisions from smallest to greatest value\r\n */\nfunction sortCollisionsAsc(_ref, _ref2) {\n  let {\n    data: {\n      value: a\n    }\n  } = _ref;\n  let {\n    data: {\n      value: b\n    }\n  } = _ref2;\n  return a - b;\n}\n/**\r\n * Sort collisions from greatest to smallest value\r\n */\n\nfunction sortCollisionsDesc(_ref3, _ref4) {\n  let {\n    data: {\n      value: a\n    }\n  } = _ref3;\n  let {\n    data: {\n      value: b\n    }\n  } = _ref4;\n  return b - a;\n}\n/**\r\n * Returns the coordinates of the corners of a given rectangle:\r\n * [TopLeft {x, y}, TopRight {x, y}, BottomLeft {x, y}, BottomRight {x, y}]\r\n */\n\nfunction cornersOfRectangle(_ref5) {\n  let {\n    left,\n    top,\n    height,\n    width\n  } = _ref5;\n  return [{\n    x: left,\n    y: top\n  }, {\n    x: left + width,\n    y: top\n  }, {\n    x: left,\n    y: top + height\n  }, {\n    x: left + width,\n    y: top + height\n  }];\n}\nfunction getFirstCollision(collisions, property) {\n  if (!collisions || collisions.length === 0) {\n    return null;\n  }\n\n  const [firstCollision] = collisions;\n  return property ? firstCollision[property] : firstCollision;\n}\n\n/**\r\n * Returns the coordinates of the center of a given ClientRect\r\n */\n\nfunction centerOfRectangle(rect, left, top) {\n  if (left === void 0) {\n    left = rect.left;\n  }\n\n  if (top === void 0) {\n    top = rect.top;\n  }\n\n  return {\n    x: left + rect.width * 0.5,\n    y: top + rect.height * 0.5\n  };\n}\n/**\r\n * Returns the closest rectangles from an array of rectangles to the center of a given\r\n * rectangle.\r\n */\n\n\nconst closestCenter = _ref => {\n  let {\n    collisionRect,\n    droppableRects,\n    droppableContainers\n  } = _ref;\n  const centerRect = centerOfRectangle(collisionRect, collisionRect.left, collisionRect.top);\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect) {\n      const distBetween = distanceBetween(centerOfRectangle(rect), centerRect);\n      collisions.push({\n        id,\n        data: {\n          droppableContainer,\n          value: distBetween\n        }\n      });\n    }\n  }\n\n  return collisions.sort(sortCollisionsAsc);\n};\n\n/**\r\n * Returns the closest rectangles from an array of rectangles to the corners of\r\n * another rectangle.\r\n */\n\nconst closestCorners = _ref => {\n  let {\n    collisionRect,\n    droppableRects,\n    droppableContainers\n  } = _ref;\n  const corners = cornersOfRectangle(collisionRect);\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect) {\n      const rectCorners = cornersOfRectangle(rect);\n      const distances = corners.reduce((accumulator, corner, index) => {\n        return accumulator + distanceBetween(rectCorners[index], corner);\n      }, 0);\n      const effectiveDistance = Number((distances / 4).toFixed(4));\n      collisions.push({\n        id,\n        data: {\n          droppableContainer,\n          value: effectiveDistance\n        }\n      });\n    }\n  }\n\n  return collisions.sort(sortCollisionsAsc);\n};\n\n/**\r\n * Returns the intersecting rectangle area between two rectangles\r\n */\n\nfunction getIntersectionRatio(entry, target) {\n  const top = Math.max(target.top, entry.top);\n  const left = Math.max(target.left, entry.left);\n  const right = Math.min(target.left + target.width, entry.left + entry.width);\n  const bottom = Math.min(target.top + target.height, entry.top + entry.height);\n  const width = right - left;\n  const height = bottom - top;\n\n  if (left < right && top < bottom) {\n    const targetArea = target.width * target.height;\n    const entryArea = entry.width * entry.height;\n    const intersectionArea = width * height;\n    const intersectionRatio = intersectionArea / (targetArea + entryArea - intersectionArea);\n    return Number(intersectionRatio.toFixed(4));\n  } // Rectangles do not overlap, or overlap has an area of zero (edge/corner overlap)\n\n\n  return 0;\n}\n/**\r\n * Returns the rectangles that has the greatest intersection area with a given\r\n * rectangle in an array of rectangles.\r\n */\n\nconst rectIntersection = _ref => {\n  let {\n    collisionRect,\n    droppableRects,\n    droppableContainers\n  } = _ref;\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect) {\n      const intersectionRatio = getIntersectionRatio(rect, collisionRect);\n\n      if (intersectionRatio > 0) {\n        collisions.push({\n          id,\n          data: {\n            droppableContainer,\n            value: intersectionRatio\n          }\n        });\n      }\n    }\n  }\n\n  return collisions.sort(sortCollisionsDesc);\n};\n\n/**\r\n * Check if a given point is contained within a bounding rectangle\r\n */\n\nfunction isPointWithinRect(point, rect) {\n  const {\n    top,\n    left,\n    bottom,\n    right\n  } = rect;\n  return top <= point.y && point.y <= bottom && left <= point.x && point.x <= right;\n}\n/**\r\n * Returns the rectangles that the pointer is hovering over\r\n */\n\n\nconst pointerWithin = _ref => {\n  let {\n    droppableContainers,\n    droppableRects,\n    pointerCoordinates\n  } = _ref;\n\n  if (!pointerCoordinates) {\n    return [];\n  }\n\n  const collisions = [];\n\n  for (const droppableContainer of droppableContainers) {\n    const {\n      id\n    } = droppableContainer;\n    const rect = droppableRects.get(id);\n\n    if (rect && isPointWithinRect(pointerCoordinates, rect)) {\n      /* There may be more than a single rectangle intersecting\r\n       * with the pointer coordinates. In order to sort the\r\n       * colliding rectangles, we measure the distance between\r\n       * the pointer and the corners of the intersecting rectangle\r\n       */\n      const corners = cornersOfRectangle(rect);\n      const distances = corners.reduce((accumulator, corner) => {\n        return accumulator + distanceBetween(pointerCoordinates, corner);\n      }, 0);\n      const effectiveDistance = Number((distances / 4).toFixed(4));\n      collisions.push({\n        id,\n        data: {\n          droppableContainer,\n          value: effectiveDistance\n        }\n      });\n    }\n  }\n\n  return collisions.sort(sortCollisionsAsc);\n};\n\nfunction adjustScale(transform, rect1, rect2) {\n  return { ...transform,\n    scaleX: rect1 && rect2 ? rect1.width / rect2.width : 1,\n    scaleY: rect1 && rect2 ? rect1.height / rect2.height : 1\n  };\n}\n\nfunction getRectDelta(rect1, rect2) {\n  return rect1 && rect2 ? {\n    x: rect1.left - rect2.left,\n    y: rect1.top - rect2.top\n  } : defaultCoordinates;\n}\n\nfunction createRectAdjustmentFn(modifier) {\n  return function adjustClientRect(rect) {\n    for (var _len = arguments.length, adjustments = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      adjustments[_key - 1] = arguments[_key];\n    }\n\n    return adjustments.reduce((acc, adjustment) => ({ ...acc,\n      top: acc.top + modifier * adjustment.y,\n      bottom: acc.bottom + modifier * adjustment.y,\n      left: acc.left + modifier * adjustment.x,\n      right: acc.right + modifier * adjustment.x\n    }), { ...rect\n    });\n  };\n}\nconst getAdjustedRect = /*#__PURE__*/createRectAdjustmentFn(1);\n\nfunction parseTransform(transform) {\n  if (transform.startsWith('matrix3d(')) {\n    const transformArray = transform.slice(9, -1).split(/, /);\n    return {\n      x: +transformArray[12],\n      y: +transformArray[13],\n      scaleX: +transformArray[0],\n      scaleY: +transformArray[5]\n    };\n  } else if (transform.startsWith('matrix(')) {\n    const transformArray = transform.slice(7, -1).split(/, /);\n    return {\n      x: +transformArray[4],\n      y: +transformArray[5],\n      scaleX: +transformArray[0],\n      scaleY: +transformArray[3]\n    };\n  }\n\n  return null;\n}\n\nfunction inverseTransform(rect, transform, transformOrigin) {\n  const parsedTransform = parseTransform(transform);\n\n  if (!parsedTransform) {\n    return rect;\n  }\n\n  const {\n    scaleX,\n    scaleY,\n    x: translateX,\n    y: translateY\n  } = parsedTransform;\n  const x = rect.left - translateX - (1 - scaleX) * parseFloat(transformOrigin);\n  const y = rect.top - translateY - (1 - scaleY) * parseFloat(transformOrigin.slice(transformOrigin.indexOf(' ') + 1));\n  const w = scaleX ? rect.width / scaleX : rect.width;\n  const h = scaleY ? rect.height / scaleY : rect.height;\n  return {\n    width: w,\n    height: h,\n    top: y,\n    right: x + w,\n    bottom: y + h,\n    left: x\n  };\n}\n\nconst defaultOptions = {\n  ignoreTransform: false\n};\n/**\r\n * Returns the bounding client rect of an element relative to the viewport.\r\n */\n\nfunction getClientRect(element, options) {\n  if (options === void 0) {\n    options = defaultOptions;\n  }\n\n  let rect = element.getBoundingClientRect();\n\n  if (options.ignoreTransform) {\n    const {\n      transform,\n      transformOrigin\n    } = getWindow(element).getComputedStyle(element);\n\n    if (transform) {\n      rect = inverseTransform(rect, transform, transformOrigin);\n    }\n  }\n\n  const {\n    top,\n    left,\n    width,\n    height,\n    bottom,\n    right\n  } = rect;\n  return {\n    top,\n    left,\n    width,\n    height,\n    bottom,\n    right\n  };\n}\n/**\r\n * Returns the bounding client rect of an element relative to the viewport.\r\n *\r\n * @remarks\r\n * The ClientRect returned by this method does not take into account transforms\r\n * applied to the element it measures.\r\n *\r\n */\n\nfunction getTransformAgnosticClientRect(element) {\n  return getClientRect(element, {\n    ignoreTransform: true\n  });\n}\n\nfunction getWindowClientRect(element) {\n  const width = element.innerWidth;\n  const height = element.innerHeight;\n  return {\n    top: 0,\n    left: 0,\n    right: width,\n    bottom: height,\n    width,\n    height\n  };\n}\n\nfunction isFixed(node, computedStyle) {\n  if (computedStyle === void 0) {\n    computedStyle = getWindow(node).getComputedStyle(node);\n  }\n\n  return computedStyle.position === 'fixed';\n}\n\nfunction isScrollable(element, computedStyle) {\n  if (computedStyle === void 0) {\n    computedStyle = getWindow(element).getComputedStyle(element);\n  }\n\n  const overflowRegex = /(auto|scroll|overlay)/;\n  const properties = ['overflow', 'overflowX', 'overflowY'];\n  return properties.some(property => {\n    const value = computedStyle[property];\n    return typeof value === 'string' ? overflowRegex.test(value) : false;\n  });\n}\n\nfunction getScrollableAncestors(element, limit) {\n  const scrollParents = [];\n\n  function findScrollableAncestors(node) {\n    if (limit != null && scrollParents.length >= limit) {\n      return scrollParents;\n    }\n\n    if (!node) {\n      return scrollParents;\n    }\n\n    if (isDocument(node) && node.scrollingElement != null && !scrollParents.includes(node.scrollingElement)) {\n      scrollParents.push(node.scrollingElement);\n      return scrollParents;\n    }\n\n    if (!isHTMLElement(node) || isSVGElement(node)) {\n      return scrollParents;\n    }\n\n    if (scrollParents.includes(node)) {\n      return scrollParents;\n    }\n\n    const computedStyle = getWindow(element).getComputedStyle(node);\n\n    if (node !== element) {\n      if (isScrollable(node, computedStyle)) {\n        scrollParents.push(node);\n      }\n    }\n\n    if (isFixed(node, computedStyle)) {\n      return scrollParents;\n    }\n\n    return findScrollableAncestors(node.parentNode);\n  }\n\n  if (!element) {\n    return scrollParents;\n  }\n\n  return findScrollableAncestors(element);\n}\nfunction getFirstScrollableAncestor(node) {\n  const [firstScrollableAncestor] = getScrollableAncestors(node, 1);\n  return firstScrollableAncestor != null ? firstScrollableAncestor : null;\n}\n\nfunction getScrollableElement(element) {\n  if (!canUseDOM || !element) {\n    return null;\n  }\n\n  if (isWindow(element)) {\n    return element;\n  }\n\n  if (!isNode(element)) {\n    return null;\n  }\n\n  if (isDocument(element) || element === getOwnerDocument(element).scrollingElement) {\n    return window;\n  }\n\n  if (isHTMLElement(element)) {\n    return element;\n  }\n\n  return null;\n}\n\nfunction getScrollXCoordinate(element) {\n  if (isWindow(element)) {\n    return element.scrollX;\n  }\n\n  return element.scrollLeft;\n}\nfunction getScrollYCoordinate(element) {\n  if (isWindow(element)) {\n    return element.scrollY;\n  }\n\n  return element.scrollTop;\n}\nfunction getScrollCoordinates(element) {\n  return {\n    x: getScrollXCoordinate(element),\n    y: getScrollYCoordinate(element)\n  };\n}\n\nvar Direction;\n\n(function (Direction) {\n  Direction[Direction[\"Forward\"] = 1] = \"Forward\";\n  Direction[Direction[\"Backward\"] = -1] = \"Backward\";\n})(Direction || (Direction = {}));\n\nfunction isDocumentScrollingElement(element) {\n  if (!canUseDOM || !element) {\n    return false;\n  }\n\n  return element === document.scrollingElement;\n}\n\nfunction getScrollPosition(scrollingContainer) {\n  const minScroll = {\n    x: 0,\n    y: 0\n  };\n  const dimensions = isDocumentScrollingElement(scrollingContainer) ? {\n    height: window.innerHeight,\n    width: window.innerWidth\n  } : {\n    height: scrollingContainer.clientHeight,\n    width: scrollingContainer.clientWidth\n  };\n  const maxScroll = {\n    x: scrollingContainer.scrollWidth - dimensions.width,\n    y: scrollingContainer.scrollHeight - dimensions.height\n  };\n  const isTop = scrollingContainer.scrollTop <= minScroll.y;\n  const isLeft = scrollingContainer.scrollLeft <= minScroll.x;\n  const isBottom = scrollingContainer.scrollTop >= maxScroll.y;\n  const isRight = scrollingContainer.scrollLeft >= maxScroll.x;\n  return {\n    isTop,\n    isLeft,\n    isBottom,\n    isRight,\n    maxScroll,\n    minScroll\n  };\n}\n\nconst defaultThreshold = {\n  x: 0.2,\n  y: 0.2\n};\nfunction getScrollDirectionAndSpeed(scrollContainer, scrollContainerRect, _ref, acceleration, thresholdPercentage) {\n  let {\n    top,\n    left,\n    right,\n    bottom\n  } = _ref;\n\n  if (acceleration === void 0) {\n    acceleration = 10;\n  }\n\n  if (thresholdPercentage === void 0) {\n    thresholdPercentage = defaultThreshold;\n  }\n\n  const {\n    isTop,\n    isBottom,\n    isLeft,\n    isRight\n  } = getScrollPosition(scrollContainer);\n  const direction = {\n    x: 0,\n    y: 0\n  };\n  const speed = {\n    x: 0,\n    y: 0\n  };\n  const threshold = {\n    height: scrollContainerRect.height * thresholdPercentage.y,\n    width: scrollContainerRect.width * thresholdPercentage.x\n  };\n\n  if (!isTop && top <= scrollContainerRect.top + threshold.height) {\n    // Scroll Up\n    direction.y = Direction.Backward;\n    speed.y = acceleration * Math.abs((scrollContainerRect.top + threshold.height - top) / threshold.height);\n  } else if (!isBottom && bottom >= scrollContainerRect.bottom - threshold.height) {\n    // Scroll Down\n    direction.y = Direction.Forward;\n    speed.y = acceleration * Math.abs((scrollContainerRect.bottom - threshold.height - bottom) / threshold.height);\n  }\n\n  if (!isRight && right >= scrollContainerRect.right - threshold.width) {\n    // Scroll Right\n    direction.x = Direction.Forward;\n    speed.x = acceleration * Math.abs((scrollContainerRect.right - threshold.width - right) / threshold.width);\n  } else if (!isLeft && left <= scrollContainerRect.left + threshold.width) {\n    // Scroll Left\n    direction.x = Direction.Backward;\n    speed.x = acceleration * Math.abs((scrollContainerRect.left + threshold.width - left) / threshold.width);\n  }\n\n  return {\n    direction,\n    speed\n  };\n}\n\nfunction getScrollElementRect(element) {\n  if (element === document.scrollingElement) {\n    const {\n      innerWidth,\n      innerHeight\n    } = window;\n    return {\n      top: 0,\n      left: 0,\n      right: innerWidth,\n      bottom: innerHeight,\n      width: innerWidth,\n      height: innerHeight\n    };\n  }\n\n  const {\n    top,\n    left,\n    right,\n    bottom\n  } = element.getBoundingClientRect();\n  return {\n    top,\n    left,\n    right,\n    bottom,\n    width: element.clientWidth,\n    height: element.clientHeight\n  };\n}\n\nfunction getScrollOffsets(scrollableAncestors) {\n  return scrollableAncestors.reduce((acc, node) => {\n    return add(acc, getScrollCoordinates(node));\n  }, defaultCoordinates);\n}\nfunction getScrollXOffset(scrollableAncestors) {\n  return scrollableAncestors.reduce((acc, node) => {\n    return acc + getScrollXCoordinate(node);\n  }, 0);\n}\nfunction getScrollYOffset(scrollableAncestors) {\n  return scrollableAncestors.reduce((acc, node) => {\n    return acc + getScrollYCoordinate(node);\n  }, 0);\n}\n\nfunction scrollIntoViewIfNeeded(element, measure) {\n  if (measure === void 0) {\n    measure = getClientRect;\n  }\n\n  if (!element) {\n    return;\n  }\n\n  const {\n    top,\n    left,\n    bottom,\n    right\n  } = measure(element);\n  const firstScrollableAncestor = getFirstScrollableAncestor(element);\n\n  if (!firstScrollableAncestor) {\n    return;\n  }\n\n  if (bottom <= 0 || right <= 0 || top >= window.innerHeight || left >= window.innerWidth) {\n    element.scrollIntoView({\n      block: 'center',\n      inline: 'center'\n    });\n  }\n}\n\nconst properties = [['x', ['left', 'right'], getScrollXOffset], ['y', ['top', 'bottom'], getScrollYOffset]];\nclass Rect {\n  constructor(rect, element) {\n    this.rect = void 0;\n    this.width = void 0;\n    this.height = void 0;\n    this.top = void 0;\n    this.bottom = void 0;\n    this.right = void 0;\n    this.left = void 0;\n    const scrollableAncestors = getScrollableAncestors(element);\n    const scrollOffsets = getScrollOffsets(scrollableAncestors);\n    this.rect = { ...rect\n    };\n    this.width = rect.width;\n    this.height = rect.height;\n\n    for (const [axis, keys, getScrollOffset] of properties) {\n      for (const key of keys) {\n        Object.defineProperty(this, key, {\n          get: () => {\n            const currentOffsets = getScrollOffset(scrollableAncestors);\n            const scrollOffsetsDeltla = scrollOffsets[axis] - currentOffsets;\n            return this.rect[key] + scrollOffsetsDeltla;\n          },\n          enumerable: true\n        });\n      }\n    }\n\n    Object.defineProperty(this, 'rect', {\n      enumerable: false\n    });\n  }\n\n}\n\nclass Listeners {\n  constructor(target) {\n    this.target = void 0;\n    this.listeners = [];\n\n    this.removeAll = () => {\n      this.listeners.forEach(listener => {\n        var _this$target;\n\n        return (_this$target = this.target) == null ? void 0 : _this$target.removeEventListener(...listener);\n      });\n    };\n\n    this.target = target;\n  }\n\n  add(eventName, handler, options) {\n    var _this$target2;\n\n    (_this$target2 = this.target) == null ? void 0 : _this$target2.addEventListener(eventName, handler, options);\n    this.listeners.push([eventName, handler, options]);\n  }\n\n}\n\nfunction getEventListenerTarget(target) {\n  // If the `event.target` element is removed from the document events will still be targeted\n  // at it, and hence won't always bubble up to the window or document anymore.\n  // If there is any risk of an element being removed while it is being dragged,\n  // the best practice is to attach the event listeners directly to the target.\n  // https://developer.mozilla.org/en-US/docs/Web/API/EventTarget\n  const {\n    EventTarget\n  } = getWindow(target);\n  return target instanceof EventTarget ? target : getOwnerDocument(target);\n}\n\nfunction hasExceededDistance(delta, measurement) {\n  const dx = Math.abs(delta.x);\n  const dy = Math.abs(delta.y);\n\n  if (typeof measurement === 'number') {\n    return Math.sqrt(dx ** 2 + dy ** 2) > measurement;\n  }\n\n  if ('x' in measurement && 'y' in measurement) {\n    return dx > measurement.x && dy > measurement.y;\n  }\n\n  if ('x' in measurement) {\n    return dx > measurement.x;\n  }\n\n  if ('y' in measurement) {\n    return dy > measurement.y;\n  }\n\n  return false;\n}\n\nvar EventName;\n\n(function (EventName) {\n  EventName[\"Click\"] = \"click\";\n  EventName[\"DragStart\"] = \"dragstart\";\n  EventName[\"Keydown\"] = \"keydown\";\n  EventName[\"ContextMenu\"] = \"contextmenu\";\n  EventName[\"Resize\"] = \"resize\";\n  EventName[\"SelectionChange\"] = \"selectionchange\";\n  EventName[\"VisibilityChange\"] = \"visibilitychange\";\n})(EventName || (EventName = {}));\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\nfunction stopPropagation(event) {\n  event.stopPropagation();\n}\n\nvar KeyboardCode;\n\n(function (KeyboardCode) {\n  KeyboardCode[\"Space\"] = \"Space\";\n  KeyboardCode[\"Down\"] = \"ArrowDown\";\n  KeyboardCode[\"Right\"] = \"ArrowRight\";\n  KeyboardCode[\"Left\"] = \"ArrowLeft\";\n  KeyboardCode[\"Up\"] = \"ArrowUp\";\n  KeyboardCode[\"Esc\"] = \"Escape\";\n  KeyboardCode[\"Enter\"] = \"Enter\";\n  KeyboardCode[\"Tab\"] = \"Tab\";\n})(KeyboardCode || (KeyboardCode = {}));\n\nconst defaultKeyboardCodes = {\n  start: [KeyboardCode.Space, KeyboardCode.Enter],\n  cancel: [KeyboardCode.Esc],\n  end: [KeyboardCode.Space, KeyboardCode.Enter, KeyboardCode.Tab]\n};\nconst defaultKeyboardCoordinateGetter = (event, _ref) => {\n  let {\n    currentCoordinates\n  } = _ref;\n\n  switch (event.code) {\n    case KeyboardCode.Right:\n      return { ...currentCoordinates,\n        x: currentCoordinates.x + 25\n      };\n\n    case KeyboardCode.Left:\n      return { ...currentCoordinates,\n        x: currentCoordinates.x - 25\n      };\n\n    case KeyboardCode.Down:\n      return { ...currentCoordinates,\n        y: currentCoordinates.y + 25\n      };\n\n    case KeyboardCode.Up:\n      return { ...currentCoordinates,\n        y: currentCoordinates.y - 25\n      };\n  }\n\n  return undefined;\n};\n\nclass KeyboardSensor {\n  constructor(props) {\n    this.props = void 0;\n    this.autoScrollEnabled = false;\n    this.referenceCoordinates = void 0;\n    this.listeners = void 0;\n    this.windowListeners = void 0;\n    this.props = props;\n    const {\n      event: {\n        target\n      }\n    } = props;\n    this.props = props;\n    this.listeners = new Listeners(getOwnerDocument(target));\n    this.windowListeners = new Listeners(getWindow(target));\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.attach();\n  }\n\n  attach() {\n    this.handleStart();\n    this.windowListeners.add(EventName.Resize, this.handleCancel);\n    this.windowListeners.add(EventName.VisibilityChange, this.handleCancel);\n    setTimeout(() => this.listeners.add(EventName.Keydown, this.handleKeyDown));\n  }\n\n  handleStart() {\n    const {\n      activeNode,\n      onStart\n    } = this.props;\n    const node = activeNode.node.current;\n\n    if (node) {\n      scrollIntoViewIfNeeded(node);\n    }\n\n    onStart(defaultCoordinates);\n  }\n\n  handleKeyDown(event) {\n    if (isKeyboardEvent(event)) {\n      const {\n        active,\n        context,\n        options\n      } = this.props;\n      const {\n        keyboardCodes = defaultKeyboardCodes,\n        coordinateGetter = defaultKeyboardCoordinateGetter,\n        scrollBehavior = 'smooth'\n      } = options;\n      const {\n        code\n      } = event;\n\n      if (keyboardCodes.end.includes(code)) {\n        this.handleEnd(event);\n        return;\n      }\n\n      if (keyboardCodes.cancel.includes(code)) {\n        this.handleCancel(event);\n        return;\n      }\n\n      const {\n        collisionRect\n      } = context.current;\n      const currentCoordinates = collisionRect ? {\n        x: collisionRect.left,\n        y: collisionRect.top\n      } : defaultCoordinates;\n\n      if (!this.referenceCoordinates) {\n        this.referenceCoordinates = currentCoordinates;\n      }\n\n      const newCoordinates = coordinateGetter(event, {\n        active,\n        context: context.current,\n        currentCoordinates\n      });\n\n      if (newCoordinates) {\n        const coordinatesDelta = subtract(newCoordinates, currentCoordinates);\n        const scrollDelta = {\n          x: 0,\n          y: 0\n        };\n        const {\n          scrollableAncestors\n        } = context.current;\n\n        for (const scrollContainer of scrollableAncestors) {\n          const direction = event.code;\n          const {\n            isTop,\n            isRight,\n            isLeft,\n            isBottom,\n            maxScroll,\n            minScroll\n          } = getScrollPosition(scrollContainer);\n          const scrollElementRect = getScrollElementRect(scrollContainer);\n          const clampedCoordinates = {\n            x: Math.min(direction === KeyboardCode.Right ? scrollElementRect.right - scrollElementRect.width / 2 : scrollElementRect.right, Math.max(direction === KeyboardCode.Right ? scrollElementRect.left : scrollElementRect.left + scrollElementRect.width / 2, newCoordinates.x)),\n            y: Math.min(direction === KeyboardCode.Down ? scrollElementRect.bottom - scrollElementRect.height / 2 : scrollElementRect.bottom, Math.max(direction === KeyboardCode.Down ? scrollElementRect.top : scrollElementRect.top + scrollElementRect.height / 2, newCoordinates.y))\n          };\n          const canScrollX = direction === KeyboardCode.Right && !isRight || direction === KeyboardCode.Left && !isLeft;\n          const canScrollY = direction === KeyboardCode.Down && !isBottom || direction === KeyboardCode.Up && !isTop;\n\n          if (canScrollX && clampedCoordinates.x !== newCoordinates.x) {\n            const newScrollCoordinates = scrollContainer.scrollLeft + coordinatesDelta.x;\n            const canScrollToNewCoordinates = direction === KeyboardCode.Right && newScrollCoordinates <= maxScroll.x || direction === KeyboardCode.Left && newScrollCoordinates >= minScroll.x;\n\n            if (canScrollToNewCoordinates && !coordinatesDelta.y) {\n              // We don't need to update coordinates, the scroll adjustment alone will trigger\n              // logic to auto-detect the new container we are over\n              scrollContainer.scrollTo({\n                left: newScrollCoordinates,\n                behavior: scrollBehavior\n              });\n              return;\n            }\n\n            if (canScrollToNewCoordinates) {\n              scrollDelta.x = scrollContainer.scrollLeft - newScrollCoordinates;\n            } else {\n              scrollDelta.x = direction === KeyboardCode.Right ? scrollContainer.scrollLeft - maxScroll.x : scrollContainer.scrollLeft - minScroll.x;\n            }\n\n            if (scrollDelta.x) {\n              scrollContainer.scrollBy({\n                left: -scrollDelta.x,\n                behavior: scrollBehavior\n              });\n            }\n\n            break;\n          } else if (canScrollY && clampedCoordinates.y !== newCoordinates.y) {\n            const newScrollCoordinates = scrollContainer.scrollTop + coordinatesDelta.y;\n            const canScrollToNewCoordinates = direction === KeyboardCode.Down && newScrollCoordinates <= maxScroll.y || direction === KeyboardCode.Up && newScrollCoordinates >= minScroll.y;\n\n            if (canScrollToNewCoordinates && !coordinatesDelta.x) {\n              // We don't need to update coordinates, the scroll adjustment alone will trigger\n              // logic to auto-detect the new container we are over\n              scrollContainer.scrollTo({\n                top: newScrollCoordinates,\n                behavior: scrollBehavior\n              });\n              return;\n            }\n\n            if (canScrollToNewCoordinates) {\n              scrollDelta.y = scrollContainer.scrollTop - newScrollCoordinates;\n            } else {\n              scrollDelta.y = direction === KeyboardCode.Down ? scrollContainer.scrollTop - maxScroll.y : scrollContainer.scrollTop - minScroll.y;\n            }\n\n            if (scrollDelta.y) {\n              scrollContainer.scrollBy({\n                top: -scrollDelta.y,\n                behavior: scrollBehavior\n              });\n            }\n\n            break;\n          }\n        }\n\n        this.handleMove(event, add(subtract(newCoordinates, this.referenceCoordinates), scrollDelta));\n      }\n    }\n  }\n\n  handleMove(event, coordinates) {\n    const {\n      onMove\n    } = this.props;\n    event.preventDefault();\n    onMove(coordinates);\n  }\n\n  handleEnd(event) {\n    const {\n      onEnd\n    } = this.props;\n    event.preventDefault();\n    this.detach();\n    onEnd();\n  }\n\n  handleCancel(event) {\n    const {\n      onCancel\n    } = this.props;\n    event.preventDefault();\n    this.detach();\n    onCancel();\n  }\n\n  detach() {\n    this.listeners.removeAll();\n    this.windowListeners.removeAll();\n  }\n\n}\nKeyboardSensor.activators = [{\n  eventName: 'onKeyDown',\n  handler: (event, _ref, _ref2) => {\n    let {\n      keyboardCodes = defaultKeyboardCodes,\n      onActivation\n    } = _ref;\n    let {\n      active\n    } = _ref2;\n    const {\n      code\n    } = event.nativeEvent;\n\n    if (keyboardCodes.start.includes(code)) {\n      const activator = active.activatorNode.current;\n\n      if (activator && event.target !== activator) {\n        return false;\n      }\n\n      event.preventDefault();\n      onActivation == null ? void 0 : onActivation({\n        event: event.nativeEvent\n      });\n      return true;\n    }\n\n    return false;\n  }\n}];\n\nfunction isDistanceConstraint(constraint) {\n  return Boolean(constraint && 'distance' in constraint);\n}\n\nfunction isDelayConstraint(constraint) {\n  return Boolean(constraint && 'delay' in constraint);\n}\n\nclass AbstractPointerSensor {\n  constructor(props, events, listenerTarget) {\n    var _getEventCoordinates;\n\n    if (listenerTarget === void 0) {\n      listenerTarget = getEventListenerTarget(props.event.target);\n    }\n\n    this.props = void 0;\n    this.events = void 0;\n    this.autoScrollEnabled = true;\n    this.document = void 0;\n    this.activated = false;\n    this.initialCoordinates = void 0;\n    this.timeoutId = null;\n    this.listeners = void 0;\n    this.documentListeners = void 0;\n    this.windowListeners = void 0;\n    this.props = props;\n    this.events = events;\n    const {\n      event\n    } = props;\n    const {\n      target\n    } = event;\n    this.props = props;\n    this.events = events;\n    this.document = getOwnerDocument(target);\n    this.documentListeners = new Listeners(this.document);\n    this.listeners = new Listeners(listenerTarget);\n    this.windowListeners = new Listeners(getWindow(target));\n    this.initialCoordinates = (_getEventCoordinates = getEventCoordinates(event)) != null ? _getEventCoordinates : defaultCoordinates;\n    this.handleStart = this.handleStart.bind(this);\n    this.handleMove = this.handleMove.bind(this);\n    this.handleEnd = this.handleEnd.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleKeydown = this.handleKeydown.bind(this);\n    this.removeTextSelection = this.removeTextSelection.bind(this);\n    this.attach();\n  }\n\n  attach() {\n    const {\n      events,\n      props: {\n        options: {\n          activationConstraint,\n          bypassActivationConstraint\n        }\n      }\n    } = this;\n    this.listeners.add(events.move.name, this.handleMove, {\n      passive: false\n    });\n    this.listeners.add(events.end.name, this.handleEnd);\n\n    if (events.cancel) {\n      this.listeners.add(events.cancel.name, this.handleCancel);\n    }\n\n    this.windowListeners.add(EventName.Resize, this.handleCancel);\n    this.windowListeners.add(EventName.DragStart, preventDefault);\n    this.windowListeners.add(EventName.VisibilityChange, this.handleCancel);\n    this.windowListeners.add(EventName.ContextMenu, preventDefault);\n    this.documentListeners.add(EventName.Keydown, this.handleKeydown);\n\n    if (activationConstraint) {\n      if (bypassActivationConstraint != null && bypassActivationConstraint({\n        event: this.props.event,\n        activeNode: this.props.activeNode,\n        options: this.props.options\n      })) {\n        return this.handleStart();\n      }\n\n      if (isDelayConstraint(activationConstraint)) {\n        this.timeoutId = setTimeout(this.handleStart, activationConstraint.delay);\n        this.handlePending(activationConstraint);\n        return;\n      }\n\n      if (isDistanceConstraint(activationConstraint)) {\n        this.handlePending(activationConstraint);\n        return;\n      }\n    }\n\n    this.handleStart();\n  }\n\n  detach() {\n    this.listeners.removeAll();\n    this.windowListeners.removeAll(); // Wait until the next event loop before removing document listeners\n    // This is necessary because we listen for `click` and `selection` events on the document\n\n    setTimeout(this.documentListeners.removeAll, 50);\n\n    if (this.timeoutId !== null) {\n      clearTimeout(this.timeoutId);\n      this.timeoutId = null;\n    }\n  }\n\n  handlePending(constraint, offset) {\n    const {\n      active,\n      onPending\n    } = this.props;\n    onPending(active, constraint, this.initialCoordinates, offset);\n  }\n\n  handleStart() {\n    const {\n      initialCoordinates\n    } = this;\n    const {\n      onStart\n    } = this.props;\n\n    if (initialCoordinates) {\n      this.activated = true; // Stop propagation of click events once activation constraints are met\n\n      this.documentListeners.add(EventName.Click, stopPropagation, {\n        capture: true\n      }); // Remove any text selection from the document\n\n      this.removeTextSelection(); // Prevent further text selection while dragging\n\n      this.documentListeners.add(EventName.SelectionChange, this.removeTextSelection);\n      onStart(initialCoordinates);\n    }\n  }\n\n  handleMove(event) {\n    var _getEventCoordinates2;\n\n    const {\n      activated,\n      initialCoordinates,\n      props\n    } = this;\n    const {\n      onMove,\n      options: {\n        activationConstraint\n      }\n    } = props;\n\n    if (!initialCoordinates) {\n      return;\n    }\n\n    const coordinates = (_getEventCoordinates2 = getEventCoordinates(event)) != null ? _getEventCoordinates2 : defaultCoordinates;\n    const delta = subtract(initialCoordinates, coordinates); // Constraint validation\n\n    if (!activated && activationConstraint) {\n      if (isDistanceConstraint(activationConstraint)) {\n        if (activationConstraint.tolerance != null && hasExceededDistance(delta, activationConstraint.tolerance)) {\n          return this.handleCancel();\n        }\n\n        if (hasExceededDistance(delta, activationConstraint.distance)) {\n          return this.handleStart();\n        }\n      }\n\n      if (isDelayConstraint(activationConstraint)) {\n        if (hasExceededDistance(delta, activationConstraint.tolerance)) {\n          return this.handleCancel();\n        }\n      }\n\n      this.handlePending(activationConstraint, delta);\n      return;\n    }\n\n    if (event.cancelable) {\n      event.preventDefault();\n    }\n\n    onMove(coordinates);\n  }\n\n  handleEnd() {\n    const {\n      onAbort,\n      onEnd\n    } = this.props;\n    this.detach();\n\n    if (!this.activated) {\n      onAbort(this.props.active);\n    }\n\n    onEnd();\n  }\n\n  handleCancel() {\n    const {\n      onAbort,\n      onCancel\n    } = this.props;\n    this.detach();\n\n    if (!this.activated) {\n      onAbort(this.props.active);\n    }\n\n    onCancel();\n  }\n\n  handleKeydown(event) {\n    if (event.code === KeyboardCode.Esc) {\n      this.handleCancel();\n    }\n  }\n\n  removeTextSelection() {\n    var _this$document$getSel;\n\n    (_this$document$getSel = this.document.getSelection()) == null ? void 0 : _this$document$getSel.removeAllRanges();\n  }\n\n}\n\nconst events = {\n  cancel: {\n    name: 'pointercancel'\n  },\n  move: {\n    name: 'pointermove'\n  },\n  end: {\n    name: 'pointerup'\n  }\n};\nclass PointerSensor extends AbstractPointerSensor {\n  constructor(props) {\n    const {\n      event\n    } = props; // Pointer events stop firing if the target is unmounted while dragging\n    // Therefore we attach listeners to the owner document instead\n\n    const listenerTarget = getOwnerDocument(event.target);\n    super(props, events, listenerTarget);\n  }\n\n}\nPointerSensor.activators = [{\n  eventName: 'onPointerDown',\n  handler: (_ref, _ref2) => {\n    let {\n      nativeEvent: event\n    } = _ref;\n    let {\n      onActivation\n    } = _ref2;\n\n    if (!event.isPrimary || event.button !== 0) {\n      return false;\n    }\n\n    onActivation == null ? void 0 : onActivation({\n      event\n    });\n    return true;\n  }\n}];\n\nconst events$1 = {\n  move: {\n    name: 'mousemove'\n  },\n  end: {\n    name: 'mouseup'\n  }\n};\nvar MouseButton;\n\n(function (MouseButton) {\n  MouseButton[MouseButton[\"RightClick\"] = 2] = \"RightClick\";\n})(MouseButton || (MouseButton = {}));\n\nclass MouseSensor extends AbstractPointerSensor {\n  constructor(props) {\n    super(props, events$1, getOwnerDocument(props.event.target));\n  }\n\n}\nMouseSensor.activators = [{\n  eventName: 'onMouseDown',\n  handler: (_ref, _ref2) => {\n    let {\n      nativeEvent: event\n    } = _ref;\n    let {\n      onActivation\n    } = _ref2;\n\n    if (event.button === MouseButton.RightClick) {\n      return false;\n    }\n\n    onActivation == null ? void 0 : onActivation({\n      event\n    });\n    return true;\n  }\n}];\n\nconst events$2 = {\n  cancel: {\n    name: 'touchcancel'\n  },\n  move: {\n    name: 'touchmove'\n  },\n  end: {\n    name: 'touchend'\n  }\n};\nclass TouchSensor extends AbstractPointerSensor {\n  constructor(props) {\n    super(props, events$2);\n  }\n\n  static setup() {\n    // Adding a non-capture and non-passive `touchmove` listener in order\n    // to force `event.preventDefault()` calls to work in dynamically added\n    // touchmove event handlers. This is required for iOS Safari.\n    window.addEventListener(events$2.move.name, noop, {\n      capture: false,\n      passive: false\n    });\n    return function teardown() {\n      window.removeEventListener(events$2.move.name, noop);\n    }; // We create a new handler because the teardown function of another sensor\n    // could remove our event listener if we use a referentially equal listener.\n\n    function noop() {}\n  }\n\n}\nTouchSensor.activators = [{\n  eventName: 'onTouchStart',\n  handler: (_ref, _ref2) => {\n    let {\n      nativeEvent: event\n    } = _ref;\n    let {\n      onActivation\n    } = _ref2;\n    const {\n      touches\n    } = event;\n\n    if (touches.length > 1) {\n      return false;\n    }\n\n    onActivation == null ? void 0 : onActivation({\n      event\n    });\n    return true;\n  }\n}];\n\nvar AutoScrollActivator;\n\n(function (AutoScrollActivator) {\n  AutoScrollActivator[AutoScrollActivator[\"Pointer\"] = 0] = \"Pointer\";\n  AutoScrollActivator[AutoScrollActivator[\"DraggableRect\"] = 1] = \"DraggableRect\";\n})(AutoScrollActivator || (AutoScrollActivator = {}));\n\nvar TraversalOrder;\n\n(function (TraversalOrder) {\n  TraversalOrder[TraversalOrder[\"TreeOrder\"] = 0] = \"TreeOrder\";\n  TraversalOrder[TraversalOrder[\"ReversedTreeOrder\"] = 1] = \"ReversedTreeOrder\";\n})(TraversalOrder || (TraversalOrder = {}));\n\nfunction useAutoScroller(_ref) {\n  let {\n    acceleration,\n    activator = AutoScrollActivator.Pointer,\n    canScroll,\n    draggingRect,\n    enabled,\n    interval = 5,\n    order = TraversalOrder.TreeOrder,\n    pointerCoordinates,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    delta,\n    threshold\n  } = _ref;\n  const scrollIntent = useScrollIntent({\n    delta,\n    disabled: !enabled\n  });\n  const [setAutoScrollInterval, clearAutoScrollInterval] = useInterval();\n  const scrollSpeed = useRef({\n    x: 0,\n    y: 0\n  });\n  const scrollDirection = useRef({\n    x: 0,\n    y: 0\n  });\n  const rect = useMemo(() => {\n    switch (activator) {\n      case AutoScrollActivator.Pointer:\n        return pointerCoordinates ? {\n          top: pointerCoordinates.y,\n          bottom: pointerCoordinates.y,\n          left: pointerCoordinates.x,\n          right: pointerCoordinates.x\n        } : null;\n\n      case AutoScrollActivator.DraggableRect:\n        return draggingRect;\n    }\n  }, [activator, draggingRect, pointerCoordinates]);\n  const scrollContainerRef = useRef(null);\n  const autoScroll = useCallback(() => {\n    const scrollContainer = scrollContainerRef.current;\n\n    if (!scrollContainer) {\n      return;\n    }\n\n    const scrollLeft = scrollSpeed.current.x * scrollDirection.current.x;\n    const scrollTop = scrollSpeed.current.y * scrollDirection.current.y;\n    scrollContainer.scrollBy(scrollLeft, scrollTop);\n  }, []);\n  const sortedScrollableAncestors = useMemo(() => order === TraversalOrder.TreeOrder ? [...scrollableAncestors].reverse() : scrollableAncestors, [order, scrollableAncestors]);\n  useEffect(() => {\n    if (!enabled || !scrollableAncestors.length || !rect) {\n      clearAutoScrollInterval();\n      return;\n    }\n\n    for (const scrollContainer of sortedScrollableAncestors) {\n      if ((canScroll == null ? void 0 : canScroll(scrollContainer)) === false) {\n        continue;\n      }\n\n      const index = scrollableAncestors.indexOf(scrollContainer);\n      const scrollContainerRect = scrollableAncestorRects[index];\n\n      if (!scrollContainerRect) {\n        continue;\n      }\n\n      const {\n        direction,\n        speed\n      } = getScrollDirectionAndSpeed(scrollContainer, scrollContainerRect, rect, acceleration, threshold);\n\n      for (const axis of ['x', 'y']) {\n        if (!scrollIntent[axis][direction[axis]]) {\n          speed[axis] = 0;\n          direction[axis] = 0;\n        }\n      }\n\n      if (speed.x > 0 || speed.y > 0) {\n        clearAutoScrollInterval();\n        scrollContainerRef.current = scrollContainer;\n        setAutoScrollInterval(autoScroll, interval);\n        scrollSpeed.current = speed;\n        scrollDirection.current = direction;\n        return;\n      }\n    }\n\n    scrollSpeed.current = {\n      x: 0,\n      y: 0\n    };\n    scrollDirection.current = {\n      x: 0,\n      y: 0\n    };\n    clearAutoScrollInterval();\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [acceleration, autoScroll, canScroll, clearAutoScrollInterval, enabled, interval, // eslint-disable-next-line react-hooks/exhaustive-deps\n  JSON.stringify(rect), // eslint-disable-next-line react-hooks/exhaustive-deps\n  JSON.stringify(scrollIntent), setAutoScrollInterval, scrollableAncestors, sortedScrollableAncestors, scrollableAncestorRects, // eslint-disable-next-line react-hooks/exhaustive-deps\n  JSON.stringify(threshold)]);\n}\nconst defaultScrollIntent = {\n  x: {\n    [Direction.Backward]: false,\n    [Direction.Forward]: false\n  },\n  y: {\n    [Direction.Backward]: false,\n    [Direction.Forward]: false\n  }\n};\n\nfunction useScrollIntent(_ref2) {\n  let {\n    delta,\n    disabled\n  } = _ref2;\n  const previousDelta = usePrevious(delta);\n  return useLazyMemo(previousIntent => {\n    if (disabled || !previousDelta || !previousIntent) {\n      // Reset scroll intent tracking when auto-scrolling is disabled\n      return defaultScrollIntent;\n    }\n\n    const direction = {\n      x: Math.sign(delta.x - previousDelta.x),\n      y: Math.sign(delta.y - previousDelta.y)\n    }; // Keep track of the user intent to scroll in each direction for both axis\n\n    return {\n      x: {\n        [Direction.Backward]: previousIntent.x[Direction.Backward] || direction.x === -1,\n        [Direction.Forward]: previousIntent.x[Direction.Forward] || direction.x === 1\n      },\n      y: {\n        [Direction.Backward]: previousIntent.y[Direction.Backward] || direction.y === -1,\n        [Direction.Forward]: previousIntent.y[Direction.Forward] || direction.y === 1\n      }\n    };\n  }, [disabled, delta, previousDelta]);\n}\n\nfunction useCachedNode(draggableNodes, id) {\n  const draggableNode = id != null ? draggableNodes.get(id) : undefined;\n  const node = draggableNode ? draggableNode.node.current : null;\n  return useLazyMemo(cachedNode => {\n    var _ref;\n\n    if (id == null) {\n      return null;\n    } // In some cases, the draggable node can unmount while dragging\n    // This is the case for virtualized lists. In those situations,\n    // we fall back to the last known value for that node.\n\n\n    return (_ref = node != null ? node : cachedNode) != null ? _ref : null;\n  }, [node, id]);\n}\n\nfunction useCombineActivators(sensors, getSyntheticHandler) {\n  return useMemo(() => sensors.reduce((accumulator, sensor) => {\n    const {\n      sensor: Sensor\n    } = sensor;\n    const sensorActivators = Sensor.activators.map(activator => ({\n      eventName: activator.eventName,\n      handler: getSyntheticHandler(activator.handler, sensor)\n    }));\n    return [...accumulator, ...sensorActivators];\n  }, []), [sensors, getSyntheticHandler]);\n}\n\nvar MeasuringStrategy;\n\n(function (MeasuringStrategy) {\n  MeasuringStrategy[MeasuringStrategy[\"Always\"] = 0] = \"Always\";\n  MeasuringStrategy[MeasuringStrategy[\"BeforeDragging\"] = 1] = \"BeforeDragging\";\n  MeasuringStrategy[MeasuringStrategy[\"WhileDragging\"] = 2] = \"WhileDragging\";\n})(MeasuringStrategy || (MeasuringStrategy = {}));\n\nvar MeasuringFrequency;\n\n(function (MeasuringFrequency) {\n  MeasuringFrequency[\"Optimized\"] = \"optimized\";\n})(MeasuringFrequency || (MeasuringFrequency = {}));\n\nconst defaultValue = /*#__PURE__*/new Map();\nfunction useDroppableMeasuring(containers, _ref) {\n  let {\n    dragging,\n    dependencies,\n    config\n  } = _ref;\n  const [queue, setQueue] = useState(null);\n  const {\n    frequency,\n    measure,\n    strategy\n  } = config;\n  const containersRef = useRef(containers);\n  const disabled = isDisabled();\n  const disabledRef = useLatestValue(disabled);\n  const measureDroppableContainers = useCallback(function (ids) {\n    if (ids === void 0) {\n      ids = [];\n    }\n\n    if (disabledRef.current) {\n      return;\n    }\n\n    setQueue(value => {\n      if (value === null) {\n        return ids;\n      }\n\n      return value.concat(ids.filter(id => !value.includes(id)));\n    });\n  }, [disabledRef]);\n  const timeoutId = useRef(null);\n  const droppableRects = useLazyMemo(previousValue => {\n    if (disabled && !dragging) {\n      return defaultValue;\n    }\n\n    if (!previousValue || previousValue === defaultValue || containersRef.current !== containers || queue != null) {\n      const map = new Map();\n\n      for (let container of containers) {\n        if (!container) {\n          continue;\n        }\n\n        if (queue && queue.length > 0 && !queue.includes(container.id) && container.rect.current) {\n          // This container does not need to be re-measured\n          map.set(container.id, container.rect.current);\n          continue;\n        }\n\n        const node = container.node.current;\n        const rect = node ? new Rect(measure(node), node) : null;\n        container.rect.current = rect;\n\n        if (rect) {\n          map.set(container.id, rect);\n        }\n      }\n\n      return map;\n    }\n\n    return previousValue;\n  }, [containers, queue, dragging, disabled, measure]);\n  useEffect(() => {\n    containersRef.current = containers;\n  }, [containers]);\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n\n    measureDroppableContainers();\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [dragging, disabled]);\n  useEffect(() => {\n    if (queue && queue.length > 0) {\n      setQueue(null);\n    }\n  }, //eslint-disable-next-line react-hooks/exhaustive-deps\n  [JSON.stringify(queue)]);\n  useEffect(() => {\n    if (disabled || typeof frequency !== 'number' || timeoutId.current !== null) {\n      return;\n    }\n\n    timeoutId.current = setTimeout(() => {\n      measureDroppableContainers();\n      timeoutId.current = null;\n    }, frequency);\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [frequency, disabled, measureDroppableContainers, ...dependencies]);\n  return {\n    droppableRects,\n    measureDroppableContainers,\n    measuringScheduled: queue != null\n  };\n\n  function isDisabled() {\n    switch (strategy) {\n      case MeasuringStrategy.Always:\n        return false;\n\n      case MeasuringStrategy.BeforeDragging:\n        return dragging;\n\n      default:\n        return !dragging;\n    }\n  }\n}\n\nfunction useInitialValue(value, computeFn) {\n  return useLazyMemo(previousValue => {\n    if (!value) {\n      return null;\n    }\n\n    if (previousValue) {\n      return previousValue;\n    }\n\n    return typeof computeFn === 'function' ? computeFn(value) : value;\n  }, [computeFn, value]);\n}\n\nfunction useInitialRect(node, measure) {\n  return useInitialValue(node, measure);\n}\n\n/**\r\n * Returns a new MutationObserver instance.\r\n * If `MutationObserver` is undefined in the execution environment, returns `undefined`.\r\n */\n\nfunction useMutationObserver(_ref) {\n  let {\n    callback,\n    disabled\n  } = _ref;\n  const handleMutations = useEvent(callback);\n  const mutationObserver = useMemo(() => {\n    if (disabled || typeof window === 'undefined' || typeof window.MutationObserver === 'undefined') {\n      return undefined;\n    }\n\n    const {\n      MutationObserver\n    } = window;\n    return new MutationObserver(handleMutations);\n  }, [handleMutations, disabled]);\n  useEffect(() => {\n    return () => mutationObserver == null ? void 0 : mutationObserver.disconnect();\n  }, [mutationObserver]);\n  return mutationObserver;\n}\n\n/**\r\n * Returns a new ResizeObserver instance bound to the `onResize` callback.\r\n * If `ResizeObserver` is undefined in the execution environment, returns `undefined`.\r\n */\n\nfunction useResizeObserver(_ref) {\n  let {\n    callback,\n    disabled\n  } = _ref;\n  const handleResize = useEvent(callback);\n  const resizeObserver = useMemo(() => {\n    if (disabled || typeof window === 'undefined' || typeof window.ResizeObserver === 'undefined') {\n      return undefined;\n    }\n\n    const {\n      ResizeObserver\n    } = window;\n    return new ResizeObserver(handleResize);\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [disabled]);\n  useEffect(() => {\n    return () => resizeObserver == null ? void 0 : resizeObserver.disconnect();\n  }, [resizeObserver]);\n  return resizeObserver;\n}\n\nfunction defaultMeasure(element) {\n  return new Rect(getClientRect(element), element);\n}\n\nfunction useRect(element, measure, fallbackRect) {\n  if (measure === void 0) {\n    measure = defaultMeasure;\n  }\n\n  const [rect, setRect] = useState(null);\n\n  function measureRect() {\n    setRect(currentRect => {\n      if (!element) {\n        return null;\n      }\n\n      if (element.isConnected === false) {\n        var _ref;\n\n        // Fall back to last rect we measured if the element is\n        // no longer connected to the DOM.\n        return (_ref = currentRect != null ? currentRect : fallbackRect) != null ? _ref : null;\n      }\n\n      const newRect = measure(element);\n\n      if (JSON.stringify(currentRect) === JSON.stringify(newRect)) {\n        return currentRect;\n      }\n\n      return newRect;\n    });\n  }\n\n  const mutationObserver = useMutationObserver({\n    callback(records) {\n      if (!element) {\n        return;\n      }\n\n      for (const record of records) {\n        const {\n          type,\n          target\n        } = record;\n\n        if (type === 'childList' && target instanceof HTMLElement && target.contains(element)) {\n          measureRect();\n          break;\n        }\n      }\n    }\n\n  });\n  const resizeObserver = useResizeObserver({\n    callback: measureRect\n  });\n  useIsomorphicLayoutEffect(() => {\n    measureRect();\n\n    if (element) {\n      resizeObserver == null ? void 0 : resizeObserver.observe(element);\n      mutationObserver == null ? void 0 : mutationObserver.observe(document.body, {\n        childList: true,\n        subtree: true\n      });\n    } else {\n      resizeObserver == null ? void 0 : resizeObserver.disconnect();\n      mutationObserver == null ? void 0 : mutationObserver.disconnect();\n    }\n  }, [element]);\n  return rect;\n}\n\nfunction useRectDelta(rect) {\n  const initialRect = useInitialValue(rect);\n  return getRectDelta(rect, initialRect);\n}\n\nconst defaultValue$1 = [];\nfunction useScrollableAncestors(node) {\n  const previousNode = useRef(node);\n  const ancestors = useLazyMemo(previousValue => {\n    if (!node) {\n      return defaultValue$1;\n    }\n\n    if (previousValue && previousValue !== defaultValue$1 && node && previousNode.current && node.parentNode === previousNode.current.parentNode) {\n      return previousValue;\n    }\n\n    return getScrollableAncestors(node);\n  }, [node]);\n  useEffect(() => {\n    previousNode.current = node;\n  }, [node]);\n  return ancestors;\n}\n\nfunction useScrollOffsets(elements) {\n  const [scrollCoordinates, setScrollCoordinates] = useState(null);\n  const prevElements = useRef(elements); // To-do: Throttle the handleScroll callback\n\n  const handleScroll = useCallback(event => {\n    const scrollingElement = getScrollableElement(event.target);\n\n    if (!scrollingElement) {\n      return;\n    }\n\n    setScrollCoordinates(scrollCoordinates => {\n      if (!scrollCoordinates) {\n        return null;\n      }\n\n      scrollCoordinates.set(scrollingElement, getScrollCoordinates(scrollingElement));\n      return new Map(scrollCoordinates);\n    });\n  }, []);\n  useEffect(() => {\n    const previousElements = prevElements.current;\n\n    if (elements !== previousElements) {\n      cleanup(previousElements);\n      const entries = elements.map(element => {\n        const scrollableElement = getScrollableElement(element);\n\n        if (scrollableElement) {\n          scrollableElement.addEventListener('scroll', handleScroll, {\n            passive: true\n          });\n          return [scrollableElement, getScrollCoordinates(scrollableElement)];\n        }\n\n        return null;\n      }).filter(entry => entry != null);\n      setScrollCoordinates(entries.length ? new Map(entries) : null);\n      prevElements.current = elements;\n    }\n\n    return () => {\n      cleanup(elements);\n      cleanup(previousElements);\n    };\n\n    function cleanup(elements) {\n      elements.forEach(element => {\n        const scrollableElement = getScrollableElement(element);\n        scrollableElement == null ? void 0 : scrollableElement.removeEventListener('scroll', handleScroll);\n      });\n    }\n  }, [handleScroll, elements]);\n  return useMemo(() => {\n    if (elements.length) {\n      return scrollCoordinates ? Array.from(scrollCoordinates.values()).reduce((acc, coordinates) => add(acc, coordinates), defaultCoordinates) : getScrollOffsets(elements);\n    }\n\n    return defaultCoordinates;\n  }, [elements, scrollCoordinates]);\n}\n\nfunction useScrollOffsetsDelta(scrollOffsets, dependencies) {\n  if (dependencies === void 0) {\n    dependencies = [];\n  }\n\n  const initialScrollOffsets = useRef(null);\n  useEffect(() => {\n    initialScrollOffsets.current = null;\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  dependencies);\n  useEffect(() => {\n    const hasScrollOffsets = scrollOffsets !== defaultCoordinates;\n\n    if (hasScrollOffsets && !initialScrollOffsets.current) {\n      initialScrollOffsets.current = scrollOffsets;\n    }\n\n    if (!hasScrollOffsets && initialScrollOffsets.current) {\n      initialScrollOffsets.current = null;\n    }\n  }, [scrollOffsets]);\n  return initialScrollOffsets.current ? subtract(scrollOffsets, initialScrollOffsets.current) : defaultCoordinates;\n}\n\nfunction useSensorSetup(sensors) {\n  useEffect(() => {\n    if (!canUseDOM) {\n      return;\n    }\n\n    const teardownFns = sensors.map(_ref => {\n      let {\n        sensor\n      } = _ref;\n      return sensor.setup == null ? void 0 : sensor.setup();\n    });\n    return () => {\n      for (const teardown of teardownFns) {\n        teardown == null ? void 0 : teardown();\n      }\n    };\n  }, // TO-DO: Sensors length could theoretically change which would not be a valid dependency\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  sensors.map(_ref2 => {\n    let {\n      sensor\n    } = _ref2;\n    return sensor;\n  }));\n}\n\nfunction useSyntheticListeners(listeners, id) {\n  return useMemo(() => {\n    return listeners.reduce((acc, _ref) => {\n      let {\n        eventName,\n        handler\n      } = _ref;\n\n      acc[eventName] = event => {\n        handler(event, id);\n      };\n\n      return acc;\n    }, {});\n  }, [listeners, id]);\n}\n\nfunction useWindowRect(element) {\n  return useMemo(() => element ? getWindowClientRect(element) : null, [element]);\n}\n\nconst defaultValue$2 = [];\nfunction useRects(elements, measure) {\n  if (measure === void 0) {\n    measure = getClientRect;\n  }\n\n  const [firstElement] = elements;\n  const windowRect = useWindowRect(firstElement ? getWindow(firstElement) : null);\n  const [rects, setRects] = useState(defaultValue$2);\n\n  function measureRects() {\n    setRects(() => {\n      if (!elements.length) {\n        return defaultValue$2;\n      }\n\n      return elements.map(element => isDocumentScrollingElement(element) ? windowRect : new Rect(measure(element), element));\n    });\n  }\n\n  const resizeObserver = useResizeObserver({\n    callback: measureRects\n  });\n  useIsomorphicLayoutEffect(() => {\n    resizeObserver == null ? void 0 : resizeObserver.disconnect();\n    measureRects();\n    elements.forEach(element => resizeObserver == null ? void 0 : resizeObserver.observe(element));\n  }, [elements]);\n  return rects;\n}\n\nfunction getMeasurableNode(node) {\n  if (!node) {\n    return null;\n  }\n\n  if (node.children.length > 1) {\n    return node;\n  }\n\n  const firstChild = node.children[0];\n  return isHTMLElement(firstChild) ? firstChild : node;\n}\n\nfunction useDragOverlayMeasuring(_ref) {\n  let {\n    measure\n  } = _ref;\n  const [rect, setRect] = useState(null);\n  const handleResize = useCallback(entries => {\n    for (const {\n      target\n    } of entries) {\n      if (isHTMLElement(target)) {\n        setRect(rect => {\n          const newRect = measure(target);\n          return rect ? { ...rect,\n            width: newRect.width,\n            height: newRect.height\n          } : newRect;\n        });\n        break;\n      }\n    }\n  }, [measure]);\n  const resizeObserver = useResizeObserver({\n    callback: handleResize\n  });\n  const handleNodeChange = useCallback(element => {\n    const node = getMeasurableNode(element);\n    resizeObserver == null ? void 0 : resizeObserver.disconnect();\n\n    if (node) {\n      resizeObserver == null ? void 0 : resizeObserver.observe(node);\n    }\n\n    setRect(node ? measure(node) : null);\n  }, [measure, resizeObserver]);\n  const [nodeRef, setRef] = useNodeRef(handleNodeChange);\n  return useMemo(() => ({\n    nodeRef,\n    rect,\n    setRef\n  }), [rect, nodeRef, setRef]);\n}\n\nconst defaultSensors = [{\n  sensor: PointerSensor,\n  options: {}\n}, {\n  sensor: KeyboardSensor,\n  options: {}\n}];\nconst defaultData = {\n  current: {}\n};\nconst defaultMeasuringConfiguration = {\n  draggable: {\n    measure: getTransformAgnosticClientRect\n  },\n  droppable: {\n    measure: getTransformAgnosticClientRect,\n    strategy: MeasuringStrategy.WhileDragging,\n    frequency: MeasuringFrequency.Optimized\n  },\n  dragOverlay: {\n    measure: getClientRect\n  }\n};\n\nclass DroppableContainersMap extends Map {\n  get(id) {\n    var _super$get;\n\n    return id != null ? (_super$get = super.get(id)) != null ? _super$get : undefined : undefined;\n  }\n\n  toArray() {\n    return Array.from(this.values());\n  }\n\n  getEnabled() {\n    return this.toArray().filter(_ref => {\n      let {\n        disabled\n      } = _ref;\n      return !disabled;\n    });\n  }\n\n  getNodeFor(id) {\n    var _this$get$node$curren, _this$get;\n\n    return (_this$get$node$curren = (_this$get = this.get(id)) == null ? void 0 : _this$get.node.current) != null ? _this$get$node$curren : undefined;\n  }\n\n}\n\nconst defaultPublicContext = {\n  activatorEvent: null,\n  active: null,\n  activeNode: null,\n  activeNodeRect: null,\n  collisions: null,\n  containerNodeRect: null,\n  draggableNodes: /*#__PURE__*/new Map(),\n  droppableRects: /*#__PURE__*/new Map(),\n  droppableContainers: /*#__PURE__*/new DroppableContainersMap(),\n  over: null,\n  dragOverlay: {\n    nodeRef: {\n      current: null\n    },\n    rect: null,\n    setRef: noop\n  },\n  scrollableAncestors: [],\n  scrollableAncestorRects: [],\n  measuringConfiguration: defaultMeasuringConfiguration,\n  measureDroppableContainers: noop,\n  windowRect: null,\n  measuringScheduled: false\n};\nconst defaultInternalContext = {\n  activatorEvent: null,\n  activators: [],\n  active: null,\n  activeNodeRect: null,\n  ariaDescribedById: {\n    draggable: ''\n  },\n  dispatch: noop,\n  draggableNodes: /*#__PURE__*/new Map(),\n  over: null,\n  measureDroppableContainers: noop\n};\nconst InternalContext = /*#__PURE__*/createContext(defaultInternalContext);\nconst PublicContext = /*#__PURE__*/createContext(defaultPublicContext);\n\nfunction getInitialState() {\n  return {\n    draggable: {\n      active: null,\n      initialCoordinates: {\n        x: 0,\n        y: 0\n      },\n      nodes: new Map(),\n      translate: {\n        x: 0,\n        y: 0\n      }\n    },\n    droppable: {\n      containers: new DroppableContainersMap()\n    }\n  };\n}\nfunction reducer(state, action) {\n  switch (action.type) {\n    case Action.DragStart:\n      return { ...state,\n        draggable: { ...state.draggable,\n          initialCoordinates: action.initialCoordinates,\n          active: action.active\n        }\n      };\n\n    case Action.DragMove:\n      if (state.draggable.active == null) {\n        return state;\n      }\n\n      return { ...state,\n        draggable: { ...state.draggable,\n          translate: {\n            x: action.coordinates.x - state.draggable.initialCoordinates.x,\n            y: action.coordinates.y - state.draggable.initialCoordinates.y\n          }\n        }\n      };\n\n    case Action.DragEnd:\n    case Action.DragCancel:\n      return { ...state,\n        draggable: { ...state.draggable,\n          active: null,\n          initialCoordinates: {\n            x: 0,\n            y: 0\n          },\n          translate: {\n            x: 0,\n            y: 0\n          }\n        }\n      };\n\n    case Action.RegisterDroppable:\n      {\n        const {\n          element\n        } = action;\n        const {\n          id\n        } = element;\n        const containers = new DroppableContainersMap(state.droppable.containers);\n        containers.set(id, element);\n        return { ...state,\n          droppable: { ...state.droppable,\n            containers\n          }\n        };\n      }\n\n    case Action.SetDroppableDisabled:\n      {\n        const {\n          id,\n          key,\n          disabled\n        } = action;\n        const element = state.droppable.containers.get(id);\n\n        if (!element || key !== element.key) {\n          return state;\n        }\n\n        const containers = new DroppableContainersMap(state.droppable.containers);\n        containers.set(id, { ...element,\n          disabled\n        });\n        return { ...state,\n          droppable: { ...state.droppable,\n            containers\n          }\n        };\n      }\n\n    case Action.UnregisterDroppable:\n      {\n        const {\n          id,\n          key\n        } = action;\n        const element = state.droppable.containers.get(id);\n\n        if (!element || key !== element.key) {\n          return state;\n        }\n\n        const containers = new DroppableContainersMap(state.droppable.containers);\n        containers.delete(id);\n        return { ...state,\n          droppable: { ...state.droppable,\n            containers\n          }\n        };\n      }\n\n    default:\n      {\n        return state;\n      }\n  }\n}\n\nfunction RestoreFocus(_ref) {\n  let {\n    disabled\n  } = _ref;\n  const {\n    active,\n    activatorEvent,\n    draggableNodes\n  } = useContext(InternalContext);\n  const previousActivatorEvent = usePrevious(activatorEvent);\n  const previousActiveId = usePrevious(active == null ? void 0 : active.id); // Restore keyboard focus on the activator node\n\n  useEffect(() => {\n    if (disabled) {\n      return;\n    }\n\n    if (!activatorEvent && previousActivatorEvent && previousActiveId != null) {\n      if (!isKeyboardEvent(previousActivatorEvent)) {\n        return;\n      }\n\n      if (document.activeElement === previousActivatorEvent.target) {\n        // No need to restore focus\n        return;\n      }\n\n      const draggableNode = draggableNodes.get(previousActiveId);\n\n      if (!draggableNode) {\n        return;\n      }\n\n      const {\n        activatorNode,\n        node\n      } = draggableNode;\n\n      if (!activatorNode.current && !node.current) {\n        return;\n      }\n\n      requestAnimationFrame(() => {\n        for (const element of [activatorNode.current, node.current]) {\n          if (!element) {\n            continue;\n          }\n\n          const focusableNode = findFirstFocusableNode(element);\n\n          if (focusableNode) {\n            focusableNode.focus();\n            break;\n          }\n        }\n      });\n    }\n  }, [activatorEvent, disabled, draggableNodes, previousActiveId, previousActivatorEvent]);\n  return null;\n}\n\nfunction applyModifiers(modifiers, _ref) {\n  let {\n    transform,\n    ...args\n  } = _ref;\n  return modifiers != null && modifiers.length ? modifiers.reduce((accumulator, modifier) => {\n    return modifier({\n      transform: accumulator,\n      ...args\n    });\n  }, transform) : transform;\n}\n\nfunction useMeasuringConfiguration(config) {\n  return useMemo(() => ({\n    draggable: { ...defaultMeasuringConfiguration.draggable,\n      ...(config == null ? void 0 : config.draggable)\n    },\n    droppable: { ...defaultMeasuringConfiguration.droppable,\n      ...(config == null ? void 0 : config.droppable)\n    },\n    dragOverlay: { ...defaultMeasuringConfiguration.dragOverlay,\n      ...(config == null ? void 0 : config.dragOverlay)\n    }\n  }), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [config == null ? void 0 : config.draggable, config == null ? void 0 : config.droppable, config == null ? void 0 : config.dragOverlay]);\n}\n\nfunction useLayoutShiftScrollCompensation(_ref) {\n  let {\n    activeNode,\n    measure,\n    initialRect,\n    config = true\n  } = _ref;\n  const initialized = useRef(false);\n  const {\n    x,\n    y\n  } = typeof config === 'boolean' ? {\n    x: config,\n    y: config\n  } : config;\n  useIsomorphicLayoutEffect(() => {\n    const disabled = !x && !y;\n\n    if (disabled || !activeNode) {\n      initialized.current = false;\n      return;\n    }\n\n    if (initialized.current || !initialRect) {\n      // Return early if layout shift scroll compensation was already attempted\n      // or if there is no initialRect to compare to.\n      return;\n    } // Get the most up to date node ref for the active draggable\n\n\n    const node = activeNode == null ? void 0 : activeNode.node.current;\n\n    if (!node || node.isConnected === false) {\n      // Return early if there is no attached node ref or if the node is\n      // disconnected from the document.\n      return;\n    }\n\n    const rect = measure(node);\n    const rectDelta = getRectDelta(rect, initialRect);\n\n    if (!x) {\n      rectDelta.x = 0;\n    }\n\n    if (!y) {\n      rectDelta.y = 0;\n    } // Only perform layout shift scroll compensation once\n\n\n    initialized.current = true;\n\n    if (Math.abs(rectDelta.x) > 0 || Math.abs(rectDelta.y) > 0) {\n      const firstScrollableAncestor = getFirstScrollableAncestor(node);\n\n      if (firstScrollableAncestor) {\n        firstScrollableAncestor.scrollBy({\n          top: rectDelta.y,\n          left: rectDelta.x\n        });\n      }\n    }\n  }, [activeNode, x, y, initialRect, measure]);\n}\n\nconst ActiveDraggableContext = /*#__PURE__*/createContext({ ...defaultCoordinates,\n  scaleX: 1,\n  scaleY: 1\n});\nvar Status;\n\n(function (Status) {\n  Status[Status[\"Uninitialized\"] = 0] = \"Uninitialized\";\n  Status[Status[\"Initializing\"] = 1] = \"Initializing\";\n  Status[Status[\"Initialized\"] = 2] = \"Initialized\";\n})(Status || (Status = {}));\n\nconst DndContext = /*#__PURE__*/memo(function DndContext(_ref) {\n  var _sensorContext$curren, _dragOverlay$nodeRef$, _dragOverlay$rect, _over$rect;\n\n  let {\n    id,\n    accessibility,\n    autoScroll = true,\n    children,\n    sensors = defaultSensors,\n    collisionDetection = rectIntersection,\n    measuring,\n    modifiers,\n    ...props\n  } = _ref;\n  const store = useReducer(reducer, undefined, getInitialState);\n  const [state, dispatch] = store;\n  const [dispatchMonitorEvent, registerMonitorListener] = useDndMonitorProvider();\n  const [status, setStatus] = useState(Status.Uninitialized);\n  const isInitialized = status === Status.Initialized;\n  const {\n    draggable: {\n      active: activeId,\n      nodes: draggableNodes,\n      translate\n    },\n    droppable: {\n      containers: droppableContainers\n    }\n  } = state;\n  const node = activeId != null ? draggableNodes.get(activeId) : null;\n  const activeRects = useRef({\n    initial: null,\n    translated: null\n  });\n  const active = useMemo(() => {\n    var _node$data;\n\n    return activeId != null ? {\n      id: activeId,\n      // It's possible for the active node to unmount while dragging\n      data: (_node$data = node == null ? void 0 : node.data) != null ? _node$data : defaultData,\n      rect: activeRects\n    } : null;\n  }, [activeId, node]);\n  const activeRef = useRef(null);\n  const [activeSensor, setActiveSensor] = useState(null);\n  const [activatorEvent, setActivatorEvent] = useState(null);\n  const latestProps = useLatestValue(props, Object.values(props));\n  const draggableDescribedById = useUniqueId(\"DndDescribedBy\", id);\n  const enabledDroppableContainers = useMemo(() => droppableContainers.getEnabled(), [droppableContainers]);\n  const measuringConfiguration = useMeasuringConfiguration(measuring);\n  const {\n    droppableRects,\n    measureDroppableContainers,\n    measuringScheduled\n  } = useDroppableMeasuring(enabledDroppableContainers, {\n    dragging: isInitialized,\n    dependencies: [translate.x, translate.y],\n    config: measuringConfiguration.droppable\n  });\n  const activeNode = useCachedNode(draggableNodes, activeId);\n  const activationCoordinates = useMemo(() => activatorEvent ? getEventCoordinates(activatorEvent) : null, [activatorEvent]);\n  const autoScrollOptions = getAutoScrollerOptions();\n  const initialActiveNodeRect = useInitialRect(activeNode, measuringConfiguration.draggable.measure);\n  useLayoutShiftScrollCompensation({\n    activeNode: activeId != null ? draggableNodes.get(activeId) : null,\n    config: autoScrollOptions.layoutShiftCompensation,\n    initialRect: initialActiveNodeRect,\n    measure: measuringConfiguration.draggable.measure\n  });\n  const activeNodeRect = useRect(activeNode, measuringConfiguration.draggable.measure, initialActiveNodeRect);\n  const containerNodeRect = useRect(activeNode ? activeNode.parentElement : null);\n  const sensorContext = useRef({\n    activatorEvent: null,\n    active: null,\n    activeNode,\n    collisionRect: null,\n    collisions: null,\n    droppableRects,\n    draggableNodes,\n    draggingNode: null,\n    draggingNodeRect: null,\n    droppableContainers,\n    over: null,\n    scrollableAncestors: [],\n    scrollAdjustedTranslate: null\n  });\n  const overNode = droppableContainers.getNodeFor((_sensorContext$curren = sensorContext.current.over) == null ? void 0 : _sensorContext$curren.id);\n  const dragOverlay = useDragOverlayMeasuring({\n    measure: measuringConfiguration.dragOverlay.measure\n  }); // Use the rect of the drag overlay if it is mounted\n\n  const draggingNode = (_dragOverlay$nodeRef$ = dragOverlay.nodeRef.current) != null ? _dragOverlay$nodeRef$ : activeNode;\n  const draggingNodeRect = isInitialized ? (_dragOverlay$rect = dragOverlay.rect) != null ? _dragOverlay$rect : activeNodeRect : null;\n  const usesDragOverlay = Boolean(dragOverlay.nodeRef.current && dragOverlay.rect); // The delta between the previous and new position of the draggable node\n  // is only relevant when there is no drag overlay\n\n  const nodeRectDelta = useRectDelta(usesDragOverlay ? null : activeNodeRect); // Get the window rect of the dragging node\n\n  const windowRect = useWindowRect(draggingNode ? getWindow(draggingNode) : null); // Get scrollable ancestors of the dragging node\n\n  const scrollableAncestors = useScrollableAncestors(isInitialized ? overNode != null ? overNode : activeNode : null);\n  const scrollableAncestorRects = useRects(scrollableAncestors); // Apply modifiers\n\n  const modifiedTranslate = applyModifiers(modifiers, {\n    transform: {\n      x: translate.x - nodeRectDelta.x,\n      y: translate.y - nodeRectDelta.y,\n      scaleX: 1,\n      scaleY: 1\n    },\n    activatorEvent,\n    active,\n    activeNodeRect,\n    containerNodeRect,\n    draggingNodeRect,\n    over: sensorContext.current.over,\n    overlayNodeRect: dragOverlay.rect,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    windowRect\n  });\n  const pointerCoordinates = activationCoordinates ? add(activationCoordinates, translate) : null;\n  const scrollOffsets = useScrollOffsets(scrollableAncestors); // Represents the scroll delta since dragging was initiated\n\n  const scrollAdjustment = useScrollOffsetsDelta(scrollOffsets); // Represents the scroll delta since the last time the active node rect was measured\n\n  const activeNodeScrollDelta = useScrollOffsetsDelta(scrollOffsets, [activeNodeRect]);\n  const scrollAdjustedTranslate = add(modifiedTranslate, scrollAdjustment);\n  const collisionRect = draggingNodeRect ? getAdjustedRect(draggingNodeRect, modifiedTranslate) : null;\n  const collisions = active && collisionRect ? collisionDetection({\n    active,\n    collisionRect,\n    droppableRects,\n    droppableContainers: enabledDroppableContainers,\n    pointerCoordinates\n  }) : null;\n  const overId = getFirstCollision(collisions, 'id');\n  const [over, setOver] = useState(null); // When there is no drag overlay used, we need to account for the\n  // window scroll delta\n\n  const appliedTranslate = usesDragOverlay ? modifiedTranslate : add(modifiedTranslate, activeNodeScrollDelta);\n  const transform = adjustScale(appliedTranslate, (_over$rect = over == null ? void 0 : over.rect) != null ? _over$rect : null, activeNodeRect);\n  const activeSensorRef = useRef(null);\n  const instantiateSensor = useCallback((event, _ref2) => {\n    let {\n      sensor: Sensor,\n      options\n    } = _ref2;\n\n    if (activeRef.current == null) {\n      return;\n    }\n\n    const activeNode = draggableNodes.get(activeRef.current);\n\n    if (!activeNode) {\n      return;\n    }\n\n    const activatorEvent = event.nativeEvent;\n    const sensorInstance = new Sensor({\n      active: activeRef.current,\n      activeNode,\n      event: activatorEvent,\n      options,\n      // Sensors need to be instantiated with refs for arguments that change over time\n      // otherwise they are frozen in time with the stale arguments\n      context: sensorContext,\n\n      onAbort(id) {\n        const draggableNode = draggableNodes.get(id);\n\n        if (!draggableNode) {\n          return;\n        }\n\n        const {\n          onDragAbort\n        } = latestProps.current;\n        const event = {\n          id\n        };\n        onDragAbort == null ? void 0 : onDragAbort(event);\n        dispatchMonitorEvent({\n          type: 'onDragAbort',\n          event\n        });\n      },\n\n      onPending(id, constraint, initialCoordinates, offset) {\n        const draggableNode = draggableNodes.get(id);\n\n        if (!draggableNode) {\n          return;\n        }\n\n        const {\n          onDragPending\n        } = latestProps.current;\n        const event = {\n          id,\n          constraint,\n          initialCoordinates,\n          offset\n        };\n        onDragPending == null ? void 0 : onDragPending(event);\n        dispatchMonitorEvent({\n          type: 'onDragPending',\n          event\n        });\n      },\n\n      onStart(initialCoordinates) {\n        const id = activeRef.current;\n\n        if (id == null) {\n          return;\n        }\n\n        const draggableNode = draggableNodes.get(id);\n\n        if (!draggableNode) {\n          return;\n        }\n\n        const {\n          onDragStart\n        } = latestProps.current;\n        const event = {\n          activatorEvent,\n          active: {\n            id,\n            data: draggableNode.data,\n            rect: activeRects\n          }\n        };\n        unstable_batchedUpdates(() => {\n          onDragStart == null ? void 0 : onDragStart(event);\n          setStatus(Status.Initializing);\n          dispatch({\n            type: Action.DragStart,\n            initialCoordinates,\n            active: id\n          });\n          dispatchMonitorEvent({\n            type: 'onDragStart',\n            event\n          });\n          setActiveSensor(activeSensorRef.current);\n          setActivatorEvent(activatorEvent);\n        });\n      },\n\n      onMove(coordinates) {\n        dispatch({\n          type: Action.DragMove,\n          coordinates\n        });\n      },\n\n      onEnd: createHandler(Action.DragEnd),\n      onCancel: createHandler(Action.DragCancel)\n    });\n    activeSensorRef.current = sensorInstance;\n\n    function createHandler(type) {\n      return async function handler() {\n        const {\n          active,\n          collisions,\n          over,\n          scrollAdjustedTranslate\n        } = sensorContext.current;\n        let event = null;\n\n        if (active && scrollAdjustedTranslate) {\n          const {\n            cancelDrop\n          } = latestProps.current;\n          event = {\n            activatorEvent,\n            active: active,\n            collisions,\n            delta: scrollAdjustedTranslate,\n            over\n          };\n\n          if (type === Action.DragEnd && typeof cancelDrop === 'function') {\n            const shouldCancel = await Promise.resolve(cancelDrop(event));\n\n            if (shouldCancel) {\n              type = Action.DragCancel;\n            }\n          }\n        }\n\n        activeRef.current = null;\n        unstable_batchedUpdates(() => {\n          dispatch({\n            type\n          });\n          setStatus(Status.Uninitialized);\n          setOver(null);\n          setActiveSensor(null);\n          setActivatorEvent(null);\n          activeSensorRef.current = null;\n          const eventName = type === Action.DragEnd ? 'onDragEnd' : 'onDragCancel';\n\n          if (event) {\n            const handler = latestProps.current[eventName];\n            handler == null ? void 0 : handler(event);\n            dispatchMonitorEvent({\n              type: eventName,\n              event\n            });\n          }\n        });\n      };\n    }\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [draggableNodes]);\n  const bindActivatorToSensorInstantiator = useCallback((handler, sensor) => {\n    return (event, active) => {\n      const nativeEvent = event.nativeEvent;\n      const activeDraggableNode = draggableNodes.get(active);\n\n      if ( // Another sensor is already instantiating\n      activeRef.current !== null || // No active draggable\n      !activeDraggableNode || // Event has already been captured\n      nativeEvent.dndKit || nativeEvent.defaultPrevented) {\n        return;\n      }\n\n      const activationContext = {\n        active: activeDraggableNode\n      };\n      const shouldActivate = handler(event, sensor.options, activationContext);\n\n      if (shouldActivate === true) {\n        nativeEvent.dndKit = {\n          capturedBy: sensor.sensor\n        };\n        activeRef.current = active;\n        instantiateSensor(event, sensor);\n      }\n    };\n  }, [draggableNodes, instantiateSensor]);\n  const activators = useCombineActivators(sensors, bindActivatorToSensorInstantiator);\n  useSensorSetup(sensors);\n  useIsomorphicLayoutEffect(() => {\n    if (activeNodeRect && status === Status.Initializing) {\n      setStatus(Status.Initialized);\n    }\n  }, [activeNodeRect, status]);\n  useEffect(() => {\n    const {\n      onDragMove\n    } = latestProps.current;\n    const {\n      active,\n      activatorEvent,\n      collisions,\n      over\n    } = sensorContext.current;\n\n    if (!active || !activatorEvent) {\n      return;\n    }\n\n    const event = {\n      active,\n      activatorEvent,\n      collisions,\n      delta: {\n        x: scrollAdjustedTranslate.x,\n        y: scrollAdjustedTranslate.y\n      },\n      over\n    };\n    unstable_batchedUpdates(() => {\n      onDragMove == null ? void 0 : onDragMove(event);\n      dispatchMonitorEvent({\n        type: 'onDragMove',\n        event\n      });\n    });\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [scrollAdjustedTranslate.x, scrollAdjustedTranslate.y]);\n  useEffect(() => {\n    const {\n      active,\n      activatorEvent,\n      collisions,\n      droppableContainers,\n      scrollAdjustedTranslate\n    } = sensorContext.current;\n\n    if (!active || activeRef.current == null || !activatorEvent || !scrollAdjustedTranslate) {\n      return;\n    }\n\n    const {\n      onDragOver\n    } = latestProps.current;\n    const overContainer = droppableContainers.get(overId);\n    const over = overContainer && overContainer.rect.current ? {\n      id: overContainer.id,\n      rect: overContainer.rect.current,\n      data: overContainer.data,\n      disabled: overContainer.disabled\n    } : null;\n    const event = {\n      active,\n      activatorEvent,\n      collisions,\n      delta: {\n        x: scrollAdjustedTranslate.x,\n        y: scrollAdjustedTranslate.y\n      },\n      over\n    };\n    unstable_batchedUpdates(() => {\n      setOver(over);\n      onDragOver == null ? void 0 : onDragOver(event);\n      dispatchMonitorEvent({\n        type: 'onDragOver',\n        event\n      });\n    });\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [overId]);\n  useIsomorphicLayoutEffect(() => {\n    sensorContext.current = {\n      activatorEvent,\n      active,\n      activeNode,\n      collisionRect,\n      collisions,\n      droppableRects,\n      draggableNodes,\n      draggingNode,\n      draggingNodeRect,\n      droppableContainers,\n      over,\n      scrollableAncestors,\n      scrollAdjustedTranslate\n    };\n    activeRects.current = {\n      initial: draggingNodeRect,\n      translated: collisionRect\n    };\n  }, [active, activeNode, collisions, collisionRect, draggableNodes, draggingNode, draggingNodeRect, droppableRects, droppableContainers, over, scrollableAncestors, scrollAdjustedTranslate]);\n  useAutoScroller({ ...autoScrollOptions,\n    delta: translate,\n    draggingRect: collisionRect,\n    pointerCoordinates,\n    scrollableAncestors,\n    scrollableAncestorRects\n  });\n  const publicContext = useMemo(() => {\n    const context = {\n      active,\n      activeNode,\n      activeNodeRect,\n      activatorEvent,\n      collisions,\n      containerNodeRect,\n      dragOverlay,\n      draggableNodes,\n      droppableContainers,\n      droppableRects,\n      over,\n      measureDroppableContainers,\n      scrollableAncestors,\n      scrollableAncestorRects,\n      measuringConfiguration,\n      measuringScheduled,\n      windowRect\n    };\n    return context;\n  }, [active, activeNode, activeNodeRect, activatorEvent, collisions, containerNodeRect, dragOverlay, draggableNodes, droppableContainers, droppableRects, over, measureDroppableContainers, scrollableAncestors, scrollableAncestorRects, measuringConfiguration, measuringScheduled, windowRect]);\n  const internalContext = useMemo(() => {\n    const context = {\n      activatorEvent,\n      activators,\n      active,\n      activeNodeRect,\n      ariaDescribedById: {\n        draggable: draggableDescribedById\n      },\n      dispatch,\n      draggableNodes,\n      over,\n      measureDroppableContainers\n    };\n    return context;\n  }, [activatorEvent, activators, active, activeNodeRect, dispatch, draggableDescribedById, draggableNodes, over, measureDroppableContainers]);\n  return React.createElement(DndMonitorContext.Provider, {\n    value: registerMonitorListener\n  }, React.createElement(InternalContext.Provider, {\n    value: internalContext\n  }, React.createElement(PublicContext.Provider, {\n    value: publicContext\n  }, React.createElement(ActiveDraggableContext.Provider, {\n    value: transform\n  }, children)), React.createElement(RestoreFocus, {\n    disabled: (accessibility == null ? void 0 : accessibility.restoreFocus) === false\n  })), React.createElement(Accessibility, { ...accessibility,\n    hiddenTextDescribedById: draggableDescribedById\n  }));\n\n  function getAutoScrollerOptions() {\n    const activeSensorDisablesAutoscroll = (activeSensor == null ? void 0 : activeSensor.autoScrollEnabled) === false;\n    const autoScrollGloballyDisabled = typeof autoScroll === 'object' ? autoScroll.enabled === false : autoScroll === false;\n    const enabled = isInitialized && !activeSensorDisablesAutoscroll && !autoScrollGloballyDisabled;\n\n    if (typeof autoScroll === 'object') {\n      return { ...autoScroll,\n        enabled\n      };\n    }\n\n    return {\n      enabled\n    };\n  }\n});\n\nconst NullContext = /*#__PURE__*/createContext(null);\nconst defaultRole = 'button';\nconst ID_PREFIX = 'Draggable';\nfunction useDraggable(_ref) {\n  let {\n    id,\n    data,\n    disabled = false,\n    attributes\n  } = _ref;\n  const key = useUniqueId(ID_PREFIX);\n  const {\n    activators,\n    activatorEvent,\n    active,\n    activeNodeRect,\n    ariaDescribedById,\n    draggableNodes,\n    over\n  } = useContext(InternalContext);\n  const {\n    role = defaultRole,\n    roleDescription = 'draggable',\n    tabIndex = 0\n  } = attributes != null ? attributes : {};\n  const isDragging = (active == null ? void 0 : active.id) === id;\n  const transform = useContext(isDragging ? ActiveDraggableContext : NullContext);\n  const [node, setNodeRef] = useNodeRef();\n  const [activatorNode, setActivatorNodeRef] = useNodeRef();\n  const listeners = useSyntheticListeners(activators, id);\n  const dataRef = useLatestValue(data);\n  useIsomorphicLayoutEffect(() => {\n    draggableNodes.set(id, {\n      id,\n      key,\n      node,\n      activatorNode,\n      data: dataRef\n    });\n    return () => {\n      const node = draggableNodes.get(id);\n\n      if (node && node.key === key) {\n        draggableNodes.delete(id);\n      }\n    };\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [draggableNodes, id]);\n  const memoizedAttributes = useMemo(() => ({\n    role,\n    tabIndex,\n    'aria-disabled': disabled,\n    'aria-pressed': isDragging && role === defaultRole ? true : undefined,\n    'aria-roledescription': roleDescription,\n    'aria-describedby': ariaDescribedById.draggable\n  }), [disabled, role, tabIndex, isDragging, roleDescription, ariaDescribedById.draggable]);\n  return {\n    active,\n    activatorEvent,\n    activeNodeRect,\n    attributes: memoizedAttributes,\n    isDragging,\n    listeners: disabled ? undefined : listeners,\n    node,\n    over,\n    setNodeRef,\n    setActivatorNodeRef,\n    transform\n  };\n}\n\nfunction useDndContext() {\n  return useContext(PublicContext);\n}\n\nconst ID_PREFIX$1 = 'Droppable';\nconst defaultResizeObserverConfig = {\n  timeout: 25\n};\nfunction useDroppable(_ref) {\n  let {\n    data,\n    disabled = false,\n    id,\n    resizeObserverConfig\n  } = _ref;\n  const key = useUniqueId(ID_PREFIX$1);\n  const {\n    active,\n    dispatch,\n    over,\n    measureDroppableContainers\n  } = useContext(InternalContext);\n  const previous = useRef({\n    disabled\n  });\n  const resizeObserverConnected = useRef(false);\n  const rect = useRef(null);\n  const callbackId = useRef(null);\n  const {\n    disabled: resizeObserverDisabled,\n    updateMeasurementsFor,\n    timeout: resizeObserverTimeout\n  } = { ...defaultResizeObserverConfig,\n    ...resizeObserverConfig\n  };\n  const ids = useLatestValue(updateMeasurementsFor != null ? updateMeasurementsFor : id);\n  const handleResize = useCallback(() => {\n    if (!resizeObserverConnected.current) {\n      // ResizeObserver invokes the `handleResize` callback as soon as `observe` is called,\n      // assuming the element is rendered and displayed.\n      resizeObserverConnected.current = true;\n      return;\n    }\n\n    if (callbackId.current != null) {\n      clearTimeout(callbackId.current);\n    }\n\n    callbackId.current = setTimeout(() => {\n      measureDroppableContainers(Array.isArray(ids.current) ? ids.current : [ids.current]);\n      callbackId.current = null;\n    }, resizeObserverTimeout);\n  }, //eslint-disable-next-line react-hooks/exhaustive-deps\n  [resizeObserverTimeout]);\n  const resizeObserver = useResizeObserver({\n    callback: handleResize,\n    disabled: resizeObserverDisabled || !active\n  });\n  const handleNodeChange = useCallback((newElement, previousElement) => {\n    if (!resizeObserver) {\n      return;\n    }\n\n    if (previousElement) {\n      resizeObserver.unobserve(previousElement);\n      resizeObserverConnected.current = false;\n    }\n\n    if (newElement) {\n      resizeObserver.observe(newElement);\n    }\n  }, [resizeObserver]);\n  const [nodeRef, setNodeRef] = useNodeRef(handleNodeChange);\n  const dataRef = useLatestValue(data);\n  useEffect(() => {\n    if (!resizeObserver || !nodeRef.current) {\n      return;\n    }\n\n    resizeObserver.disconnect();\n    resizeObserverConnected.current = false;\n    resizeObserver.observe(nodeRef.current);\n  }, [nodeRef, resizeObserver]);\n  useEffect(() => {\n    dispatch({\n      type: Action.RegisterDroppable,\n      element: {\n        id,\n        key,\n        disabled,\n        node: nodeRef,\n        rect,\n        data: dataRef\n      }\n    });\n    return () => dispatch({\n      type: Action.UnregisterDroppable,\n      key,\n      id\n    });\n  }, // eslint-disable-next-line react-hooks/exhaustive-deps\n  [id]);\n  useEffect(() => {\n    if (disabled !== previous.current.disabled) {\n      dispatch({\n        type: Action.SetDroppableDisabled,\n        id,\n        key,\n        disabled\n      });\n      previous.current.disabled = disabled;\n    }\n  }, [id, key, disabled, dispatch]);\n  return {\n    active,\n    rect,\n    isOver: (over == null ? void 0 : over.id) === id,\n    node: nodeRef,\n    over,\n    setNodeRef\n  };\n}\n\nfunction AnimationManager(_ref) {\n  let {\n    animation,\n    children\n  } = _ref;\n  const [clonedChildren, setClonedChildren] = useState(null);\n  const [element, setElement] = useState(null);\n  const previousChildren = usePrevious(children);\n\n  if (!children && !clonedChildren && previousChildren) {\n    setClonedChildren(previousChildren);\n  }\n\n  useIsomorphicLayoutEffect(() => {\n    if (!element) {\n      return;\n    }\n\n    const key = clonedChildren == null ? void 0 : clonedChildren.key;\n    const id = clonedChildren == null ? void 0 : clonedChildren.props.id;\n\n    if (key == null || id == null) {\n      setClonedChildren(null);\n      return;\n    }\n\n    Promise.resolve(animation(id, element)).then(() => {\n      setClonedChildren(null);\n    });\n  }, [animation, clonedChildren, element]);\n  return React.createElement(React.Fragment, null, children, clonedChildren ? cloneElement(clonedChildren, {\n    ref: setElement\n  }) : null);\n}\n\nconst defaultTransform = {\n  x: 0,\n  y: 0,\n  scaleX: 1,\n  scaleY: 1\n};\nfunction NullifiedContextProvider(_ref) {\n  let {\n    children\n  } = _ref;\n  return React.createElement(InternalContext.Provider, {\n    value: defaultInternalContext\n  }, React.createElement(ActiveDraggableContext.Provider, {\n    value: defaultTransform\n  }, children));\n}\n\nconst baseStyles = {\n  position: 'fixed',\n  touchAction: 'none'\n};\n\nconst defaultTransition = activatorEvent => {\n  const isKeyboardActivator = isKeyboardEvent(activatorEvent);\n  return isKeyboardActivator ? 'transform 250ms ease' : undefined;\n};\n\nconst PositionedOverlay = /*#__PURE__*/forwardRef((_ref, ref) => {\n  let {\n    as,\n    activatorEvent,\n    adjustScale,\n    children,\n    className,\n    rect,\n    style,\n    transform,\n    transition = defaultTransition\n  } = _ref;\n\n  if (!rect) {\n    return null;\n  }\n\n  const scaleAdjustedTransform = adjustScale ? transform : { ...transform,\n    scaleX: 1,\n    scaleY: 1\n  };\n  const styles = { ...baseStyles,\n    width: rect.width,\n    height: rect.height,\n    top: rect.top,\n    left: rect.left,\n    transform: CSS.Transform.toString(scaleAdjustedTransform),\n    transformOrigin: adjustScale && activatorEvent ? getRelativeTransformOrigin(activatorEvent, rect) : undefined,\n    transition: typeof transition === 'function' ? transition(activatorEvent) : transition,\n    ...style\n  };\n  return React.createElement(as, {\n    className,\n    style: styles,\n    ref\n  }, children);\n});\n\nconst defaultDropAnimationSideEffects = options => _ref => {\n  let {\n    active,\n    dragOverlay\n  } = _ref;\n  const originalStyles = {};\n  const {\n    styles,\n    className\n  } = options;\n\n  if (styles != null && styles.active) {\n    for (const [key, value] of Object.entries(styles.active)) {\n      if (value === undefined) {\n        continue;\n      }\n\n      originalStyles[key] = active.node.style.getPropertyValue(key);\n      active.node.style.setProperty(key, value);\n    }\n  }\n\n  if (styles != null && styles.dragOverlay) {\n    for (const [key, value] of Object.entries(styles.dragOverlay)) {\n      if (value === undefined) {\n        continue;\n      }\n\n      dragOverlay.node.style.setProperty(key, value);\n    }\n  }\n\n  if (className != null && className.active) {\n    active.node.classList.add(className.active);\n  }\n\n  if (className != null && className.dragOverlay) {\n    dragOverlay.node.classList.add(className.dragOverlay);\n  }\n\n  return function cleanup() {\n    for (const [key, value] of Object.entries(originalStyles)) {\n      active.node.style.setProperty(key, value);\n    }\n\n    if (className != null && className.active) {\n      active.node.classList.remove(className.active);\n    }\n  };\n};\n\nconst defaultKeyframeResolver = _ref2 => {\n  let {\n    transform: {\n      initial,\n      final\n    }\n  } = _ref2;\n  return [{\n    transform: CSS.Transform.toString(initial)\n  }, {\n    transform: CSS.Transform.toString(final)\n  }];\n};\n\nconst defaultDropAnimationConfiguration = {\n  duration: 250,\n  easing: 'ease',\n  keyframes: defaultKeyframeResolver,\n  sideEffects: /*#__PURE__*/defaultDropAnimationSideEffects({\n    styles: {\n      active: {\n        opacity: '0'\n      }\n    }\n  })\n};\nfunction useDropAnimation(_ref3) {\n  let {\n    config,\n    draggableNodes,\n    droppableContainers,\n    measuringConfiguration\n  } = _ref3;\n  return useEvent((id, node) => {\n    if (config === null) {\n      return;\n    }\n\n    const activeDraggable = draggableNodes.get(id);\n\n    if (!activeDraggable) {\n      return;\n    }\n\n    const activeNode = activeDraggable.node.current;\n\n    if (!activeNode) {\n      return;\n    }\n\n    const measurableNode = getMeasurableNode(node);\n\n    if (!measurableNode) {\n      return;\n    }\n\n    const {\n      transform\n    } = getWindow(node).getComputedStyle(node);\n    const parsedTransform = parseTransform(transform);\n\n    if (!parsedTransform) {\n      return;\n    }\n\n    const animation = typeof config === 'function' ? config : createDefaultDropAnimation(config);\n    scrollIntoViewIfNeeded(activeNode, measuringConfiguration.draggable.measure);\n    return animation({\n      active: {\n        id,\n        data: activeDraggable.data,\n        node: activeNode,\n        rect: measuringConfiguration.draggable.measure(activeNode)\n      },\n      draggableNodes,\n      dragOverlay: {\n        node,\n        rect: measuringConfiguration.dragOverlay.measure(measurableNode)\n      },\n      droppableContainers,\n      measuringConfiguration,\n      transform: parsedTransform\n    });\n  });\n}\n\nfunction createDefaultDropAnimation(options) {\n  const {\n    duration,\n    easing,\n    sideEffects,\n    keyframes\n  } = { ...defaultDropAnimationConfiguration,\n    ...options\n  };\n  return _ref4 => {\n    let {\n      active,\n      dragOverlay,\n      transform,\n      ...rest\n    } = _ref4;\n\n    if (!duration) {\n      // Do not animate if animation duration is zero.\n      return;\n    }\n\n    const delta = {\n      x: dragOverlay.rect.left - active.rect.left,\n      y: dragOverlay.rect.top - active.rect.top\n    };\n    const scale = {\n      scaleX: transform.scaleX !== 1 ? active.rect.width * transform.scaleX / dragOverlay.rect.width : 1,\n      scaleY: transform.scaleY !== 1 ? active.rect.height * transform.scaleY / dragOverlay.rect.height : 1\n    };\n    const finalTransform = {\n      x: transform.x - delta.x,\n      y: transform.y - delta.y,\n      ...scale\n    };\n    const animationKeyframes = keyframes({ ...rest,\n      active,\n      dragOverlay,\n      transform: {\n        initial: transform,\n        final: finalTransform\n      }\n    });\n    const [firstKeyframe] = animationKeyframes;\n    const lastKeyframe = animationKeyframes[animationKeyframes.length - 1];\n\n    if (JSON.stringify(firstKeyframe) === JSON.stringify(lastKeyframe)) {\n      // The start and end keyframes are the same, infer that there is no animation needed.\n      return;\n    }\n\n    const cleanup = sideEffects == null ? void 0 : sideEffects({\n      active,\n      dragOverlay,\n      ...rest\n    });\n    const animation = dragOverlay.node.animate(animationKeyframes, {\n      duration,\n      easing,\n      fill: 'forwards'\n    });\n    return new Promise(resolve => {\n      animation.onfinish = () => {\n        cleanup == null ? void 0 : cleanup();\n        resolve();\n      };\n    });\n  };\n}\n\nlet key = 0;\nfunction useKey(id) {\n  return useMemo(() => {\n    if (id == null) {\n      return;\n    }\n\n    key++;\n    return key;\n  }, [id]);\n}\n\nconst DragOverlay = /*#__PURE__*/React.memo(_ref => {\n  let {\n    adjustScale = false,\n    children,\n    dropAnimation: dropAnimationConfig,\n    style,\n    transition,\n    modifiers,\n    wrapperElement = 'div',\n    className,\n    zIndex = 999\n  } = _ref;\n  const {\n    activatorEvent,\n    active,\n    activeNodeRect,\n    containerNodeRect,\n    draggableNodes,\n    droppableContainers,\n    dragOverlay,\n    over,\n    measuringConfiguration,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    windowRect\n  } = useDndContext();\n  const transform = useContext(ActiveDraggableContext);\n  const key = useKey(active == null ? void 0 : active.id);\n  const modifiedTransform = applyModifiers(modifiers, {\n    activatorEvent,\n    active,\n    activeNodeRect,\n    containerNodeRect,\n    draggingNodeRect: dragOverlay.rect,\n    over,\n    overlayNodeRect: dragOverlay.rect,\n    scrollableAncestors,\n    scrollableAncestorRects,\n    transform,\n    windowRect\n  });\n  const initialRect = useInitialValue(activeNodeRect);\n  const dropAnimation = useDropAnimation({\n    config: dropAnimationConfig,\n    draggableNodes,\n    droppableContainers,\n    measuringConfiguration\n  }); // We need to wait for the active node to be measured before connecting the drag overlay ref\n  // otherwise collisions can be computed against a mispositioned drag overlay\n\n  const ref = initialRect ? dragOverlay.setRef : undefined;\n  return React.createElement(NullifiedContextProvider, null, React.createElement(AnimationManager, {\n    animation: dropAnimation\n  }, active && key ? React.createElement(PositionedOverlay, {\n    key: key,\n    id: active.id,\n    ref: ref,\n    as: wrapperElement,\n    activatorEvent: activatorEvent,\n    adjustScale: adjustScale,\n    className: className,\n    transition: transition,\n    rect: initialRect,\n    style: {\n      zIndex,\n      ...style\n    },\n    transform: modifiedTransform\n  }, children) : null));\n});\n\nexport { AutoScrollActivator, DndContext, DragOverlay, KeyboardCode, KeyboardSensor, MeasuringFrequency, MeasuringStrategy, MouseSensor, PointerSensor, TouchSensor, TraversalOrder, applyModifiers, closestCenter, closestCorners, defaultAnnouncements, defaultCoordinates, defaultDropAnimationConfiguration as defaultDropAnimation, defaultDropAnimationSideEffects, defaultKeyboardCoordinateGetter, defaultScreenReaderInstructions, getClientRect, getFirstCollision, getScrollableAncestors, pointerWithin, rectIntersection, useDndContext, useDndMonitor, useDraggable, useDroppable, useSensor, useSensors };\n//# sourceMappingURL=core.esm.js.map\n","import React, { useMemo, useRef, useEffect, useState, useContext } from 'react';\nimport { useDndContext, getClientRect, useDroppable, useDraggable, closestCorners, getFirstCollision, getScrollableAncestors, KeyboardCode } from '@dnd-kit/core';\nimport { useUniqueId, useIsomorphicLayoutEffect, CSS, useCombinedRefs, isKeyboardEvent, subtract } from '@dnd-kit/utilities';\n\n/**\r\n * Move an array item to a different position. Returns a new array with the item moved to the new position.\r\n */\nfunction arrayMove(array, from, to) {\n  const newArray = array.slice();\n  newArray.splice(to < 0 ? newArray.length + to : to, 0, newArray.splice(from, 1)[0]);\n  return newArray;\n}\n\n/**\r\n * Swap an array item to a different position. Returns a new array with the item swapped to the new position.\r\n */\nfunction arraySwap(array, from, to) {\n  const newArray = array.slice();\n  newArray[from] = array[to];\n  newArray[to] = array[from];\n  return newArray;\n}\n\nfunction getSortedRects(items, rects) {\n  return items.reduce((accumulator, id, index) => {\n    const rect = rects.get(id);\n\n    if (rect) {\n      accumulator[index] = rect;\n    }\n\n    return accumulator;\n  }, Array(items.length));\n}\n\nfunction isValidIndex(index) {\n  return index !== null && index >= 0;\n}\n\nfunction itemsEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  for (let i = 0; i < a.length; i++) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction normalizeDisabled(disabled) {\n  if (typeof disabled === 'boolean') {\n    return {\n      draggable: disabled,\n      droppable: disabled\n    };\n  }\n\n  return disabled;\n}\n\n// To-do: We should be calculating scale transformation\nconst defaultScale = {\n  scaleX: 1,\n  scaleY: 1\n};\nconst horizontalListSortingStrategy = _ref => {\n  var _rects$activeIndex;\n\n  let {\n    rects,\n    activeNodeRect: fallbackActiveRect,\n    activeIndex,\n    overIndex,\n    index\n  } = _ref;\n  const activeNodeRect = (_rects$activeIndex = rects[activeIndex]) != null ? _rects$activeIndex : fallbackActiveRect;\n\n  if (!activeNodeRect) {\n    return null;\n  }\n\n  const itemGap = getItemGap(rects, index, activeIndex);\n\n  if (index === activeIndex) {\n    const newIndexRect = rects[overIndex];\n\n    if (!newIndexRect) {\n      return null;\n    }\n\n    return {\n      x: activeIndex < overIndex ? newIndexRect.left + newIndexRect.width - (activeNodeRect.left + activeNodeRect.width) : newIndexRect.left - activeNodeRect.left,\n      y: 0,\n      ...defaultScale\n    };\n  }\n\n  if (index > activeIndex && index <= overIndex) {\n    return {\n      x: -activeNodeRect.width - itemGap,\n      y: 0,\n      ...defaultScale\n    };\n  }\n\n  if (index < activeIndex && index >= overIndex) {\n    return {\n      x: activeNodeRect.width + itemGap,\n      y: 0,\n      ...defaultScale\n    };\n  }\n\n  return {\n    x: 0,\n    y: 0,\n    ...defaultScale\n  };\n};\n\nfunction getItemGap(rects, index, activeIndex) {\n  const currentRect = rects[index];\n  const previousRect = rects[index - 1];\n  const nextRect = rects[index + 1];\n\n  if (!currentRect || !previousRect && !nextRect) {\n    return 0;\n  }\n\n  if (activeIndex < index) {\n    return previousRect ? currentRect.left - (previousRect.left + previousRect.width) : nextRect.left - (currentRect.left + currentRect.width);\n  }\n\n  return nextRect ? nextRect.left - (currentRect.left + currentRect.width) : currentRect.left - (previousRect.left + previousRect.width);\n}\n\nconst rectSortingStrategy = _ref => {\n  let {\n    rects,\n    activeIndex,\n    overIndex,\n    index\n  } = _ref;\n  const newRects = arrayMove(rects, overIndex, activeIndex);\n  const oldRect = rects[index];\n  const newRect = newRects[index];\n\n  if (!newRect || !oldRect) {\n    return null;\n  }\n\n  return {\n    x: newRect.left - oldRect.left,\n    y: newRect.top - oldRect.top,\n    scaleX: newRect.width / oldRect.width,\n    scaleY: newRect.height / oldRect.height\n  };\n};\n\nconst rectSwappingStrategy = _ref => {\n  let {\n    activeIndex,\n    index,\n    rects,\n    overIndex\n  } = _ref;\n  let oldRect;\n  let newRect;\n\n  if (index === activeIndex) {\n    oldRect = rects[index];\n    newRect = rects[overIndex];\n  }\n\n  if (index === overIndex) {\n    oldRect = rects[index];\n    newRect = rects[activeIndex];\n  }\n\n  if (!newRect || !oldRect) {\n    return null;\n  }\n\n  return {\n    x: newRect.left - oldRect.left,\n    y: newRect.top - oldRect.top,\n    scaleX: newRect.width / oldRect.width,\n    scaleY: newRect.height / oldRect.height\n  };\n};\n\n// To-do: We should be calculating scale transformation\nconst defaultScale$1 = {\n  scaleX: 1,\n  scaleY: 1\n};\nconst verticalListSortingStrategy = _ref => {\n  var _rects$activeIndex;\n\n  let {\n    activeIndex,\n    activeNodeRect: fallbackActiveRect,\n    index,\n    rects,\n    overIndex\n  } = _ref;\n  const activeNodeRect = (_rects$activeIndex = rects[activeIndex]) != null ? _rects$activeIndex : fallbackActiveRect;\n\n  if (!activeNodeRect) {\n    return null;\n  }\n\n  if (index === activeIndex) {\n    const overIndexRect = rects[overIndex];\n\n    if (!overIndexRect) {\n      return null;\n    }\n\n    return {\n      x: 0,\n      y: activeIndex < overIndex ? overIndexRect.top + overIndexRect.height - (activeNodeRect.top + activeNodeRect.height) : overIndexRect.top - activeNodeRect.top,\n      ...defaultScale$1\n    };\n  }\n\n  const itemGap = getItemGap$1(rects, index, activeIndex);\n\n  if (index > activeIndex && index <= overIndex) {\n    return {\n      x: 0,\n      y: -activeNodeRect.height - itemGap,\n      ...defaultScale$1\n    };\n  }\n\n  if (index < activeIndex && index >= overIndex) {\n    return {\n      x: 0,\n      y: activeNodeRect.height + itemGap,\n      ...defaultScale$1\n    };\n  }\n\n  return {\n    x: 0,\n    y: 0,\n    ...defaultScale$1\n  };\n};\n\nfunction getItemGap$1(clientRects, index, activeIndex) {\n  const currentRect = clientRects[index];\n  const previousRect = clientRects[index - 1];\n  const nextRect = clientRects[index + 1];\n\n  if (!currentRect) {\n    return 0;\n  }\n\n  if (activeIndex < index) {\n    return previousRect ? currentRect.top - (previousRect.top + previousRect.height) : nextRect ? nextRect.top - (currentRect.top + currentRect.height) : 0;\n  }\n\n  return nextRect ? nextRect.top - (currentRect.top + currentRect.height) : previousRect ? currentRect.top - (previousRect.top + previousRect.height) : 0;\n}\n\nconst ID_PREFIX = 'Sortable';\nconst Context = /*#__PURE__*/React.createContext({\n  activeIndex: -1,\n  containerId: ID_PREFIX,\n  disableTransforms: false,\n  items: [],\n  overIndex: -1,\n  useDragOverlay: false,\n  sortedRects: [],\n  strategy: rectSortingStrategy,\n  disabled: {\n    draggable: false,\n    droppable: false\n  }\n});\nfunction SortableContext(_ref) {\n  let {\n    children,\n    id,\n    items: userDefinedItems,\n    strategy = rectSortingStrategy,\n    disabled: disabledProp = false\n  } = _ref;\n  const {\n    active,\n    dragOverlay,\n    droppableRects,\n    over,\n    measureDroppableContainers\n  } = useDndContext();\n  const containerId = useUniqueId(ID_PREFIX, id);\n  const useDragOverlay = Boolean(dragOverlay.rect !== null);\n  const items = useMemo(() => userDefinedItems.map(item => typeof item === 'object' && 'id' in item ? item.id : item), [userDefinedItems]);\n  const isDragging = active != null;\n  const activeIndex = active ? items.indexOf(active.id) : -1;\n  const overIndex = over ? items.indexOf(over.id) : -1;\n  const previousItemsRef = useRef(items);\n  const itemsHaveChanged = !itemsEqual(items, previousItemsRef.current);\n  const disableTransforms = overIndex !== -1 && activeIndex === -1 || itemsHaveChanged;\n  const disabled = normalizeDisabled(disabledProp);\n  useIsomorphicLayoutEffect(() => {\n    if (itemsHaveChanged && isDragging) {\n      measureDroppableContainers(items);\n    }\n  }, [itemsHaveChanged, items, isDragging, measureDroppableContainers]);\n  useEffect(() => {\n    previousItemsRef.current = items;\n  }, [items]);\n  const contextValue = useMemo(() => ({\n    activeIndex,\n    containerId,\n    disabled,\n    disableTransforms,\n    items,\n    overIndex,\n    useDragOverlay,\n    sortedRects: getSortedRects(items, droppableRects),\n    strategy\n  }), // eslint-disable-next-line react-hooks/exhaustive-deps\n  [activeIndex, containerId, disabled.draggable, disabled.droppable, disableTransforms, items, overIndex, droppableRects, useDragOverlay, strategy]);\n  return React.createElement(Context.Provider, {\n    value: contextValue\n  }, children);\n}\n\nconst defaultNewIndexGetter = _ref => {\n  let {\n    id,\n    items,\n    activeIndex,\n    overIndex\n  } = _ref;\n  return arrayMove(items, activeIndex, overIndex).indexOf(id);\n};\nconst defaultAnimateLayoutChanges = _ref2 => {\n  let {\n    containerId,\n    isSorting,\n    wasDragging,\n    index,\n    items,\n    newIndex,\n    previousItems,\n    previousContainerId,\n    transition\n  } = _ref2;\n\n  if (!transition || !wasDragging) {\n    return false;\n  }\n\n  if (previousItems !== items && index === newIndex) {\n    return false;\n  }\n\n  if (isSorting) {\n    return true;\n  }\n\n  return newIndex !== index && containerId === previousContainerId;\n};\nconst defaultTransition = {\n  duration: 200,\n  easing: 'ease'\n};\nconst transitionProperty = 'transform';\nconst disabledTransition = /*#__PURE__*/CSS.Transition.toString({\n  property: transitionProperty,\n  duration: 0,\n  easing: 'linear'\n});\nconst defaultAttributes = {\n  roleDescription: 'sortable'\n};\n\n/*\r\n * When the index of an item changes while sorting,\r\n * we need to temporarily disable the transforms\r\n */\n\nfunction useDerivedTransform(_ref) {\n  let {\n    disabled,\n    index,\n    node,\n    rect\n  } = _ref;\n  const [derivedTransform, setDerivedtransform] = useState(null);\n  const previousIndex = useRef(index);\n  useIsomorphicLayoutEffect(() => {\n    if (!disabled && index !== previousIndex.current && node.current) {\n      const initial = rect.current;\n\n      if (initial) {\n        const current = getClientRect(node.current, {\n          ignoreTransform: true\n        });\n        const delta = {\n          x: initial.left - current.left,\n          y: initial.top - current.top,\n          scaleX: initial.width / current.width,\n          scaleY: initial.height / current.height\n        };\n\n        if (delta.x || delta.y) {\n          setDerivedtransform(delta);\n        }\n      }\n    }\n\n    if (index !== previousIndex.current) {\n      previousIndex.current = index;\n    }\n  }, [disabled, index, node, rect]);\n  useEffect(() => {\n    if (derivedTransform) {\n      setDerivedtransform(null);\n    }\n  }, [derivedTransform]);\n  return derivedTransform;\n}\n\nfunction useSortable(_ref) {\n  let {\n    animateLayoutChanges = defaultAnimateLayoutChanges,\n    attributes: userDefinedAttributes,\n    disabled: localDisabled,\n    data: customData,\n    getNewIndex = defaultNewIndexGetter,\n    id,\n    strategy: localStrategy,\n    resizeObserverConfig,\n    transition = defaultTransition\n  } = _ref;\n  const {\n    items,\n    containerId,\n    activeIndex,\n    disabled: globalDisabled,\n    disableTransforms,\n    sortedRects,\n    overIndex,\n    useDragOverlay,\n    strategy: globalStrategy\n  } = useContext(Context);\n  const disabled = normalizeLocalDisabled(localDisabled, globalDisabled);\n  const index = items.indexOf(id);\n  const data = useMemo(() => ({\n    sortable: {\n      containerId,\n      index,\n      items\n    },\n    ...customData\n  }), [containerId, customData, index, items]);\n  const itemsAfterCurrentSortable = useMemo(() => items.slice(items.indexOf(id)), [items, id]);\n  const {\n    rect,\n    node,\n    isOver,\n    setNodeRef: setDroppableNodeRef\n  } = useDroppable({\n    id,\n    data,\n    disabled: disabled.droppable,\n    resizeObserverConfig: {\n      updateMeasurementsFor: itemsAfterCurrentSortable,\n      ...resizeObserverConfig\n    }\n  });\n  const {\n    active,\n    activatorEvent,\n    activeNodeRect,\n    attributes,\n    setNodeRef: setDraggableNodeRef,\n    listeners,\n    isDragging,\n    over,\n    setActivatorNodeRef,\n    transform\n  } = useDraggable({\n    id,\n    data,\n    attributes: { ...defaultAttributes,\n      ...userDefinedAttributes\n    },\n    disabled: disabled.draggable\n  });\n  const setNodeRef = useCombinedRefs(setDroppableNodeRef, setDraggableNodeRef);\n  const isSorting = Boolean(active);\n  const displaceItem = isSorting && !disableTransforms && isValidIndex(activeIndex) && isValidIndex(overIndex);\n  const shouldDisplaceDragSource = !useDragOverlay && isDragging;\n  const dragSourceDisplacement = shouldDisplaceDragSource && displaceItem ? transform : null;\n  const strategy = localStrategy != null ? localStrategy : globalStrategy;\n  const finalTransform = displaceItem ? dragSourceDisplacement != null ? dragSourceDisplacement : strategy({\n    rects: sortedRects,\n    activeNodeRect,\n    activeIndex,\n    overIndex,\n    index\n  }) : null;\n  const newIndex = isValidIndex(activeIndex) && isValidIndex(overIndex) ? getNewIndex({\n    id,\n    items,\n    activeIndex,\n    overIndex\n  }) : index;\n  const activeId = active == null ? void 0 : active.id;\n  const previous = useRef({\n    activeId,\n    items,\n    newIndex,\n    containerId\n  });\n  const itemsHaveChanged = items !== previous.current.items;\n  const shouldAnimateLayoutChanges = animateLayoutChanges({\n    active,\n    containerId,\n    isDragging,\n    isSorting,\n    id,\n    index,\n    items,\n    newIndex: previous.current.newIndex,\n    previousItems: previous.current.items,\n    previousContainerId: previous.current.containerId,\n    transition,\n    wasDragging: previous.current.activeId != null\n  });\n  const derivedTransform = useDerivedTransform({\n    disabled: !shouldAnimateLayoutChanges,\n    index,\n    node,\n    rect\n  });\n  useEffect(() => {\n    if (isSorting && previous.current.newIndex !== newIndex) {\n      previous.current.newIndex = newIndex;\n    }\n\n    if (containerId !== previous.current.containerId) {\n      previous.current.containerId = containerId;\n    }\n\n    if (items !== previous.current.items) {\n      previous.current.items = items;\n    }\n  }, [isSorting, newIndex, containerId, items]);\n  useEffect(() => {\n    if (activeId === previous.current.activeId) {\n      return;\n    }\n\n    if (activeId != null && previous.current.activeId == null) {\n      previous.current.activeId = activeId;\n      return;\n    }\n\n    const timeoutId = setTimeout(() => {\n      previous.current.activeId = activeId;\n    }, 50);\n    return () => clearTimeout(timeoutId);\n  }, [activeId]);\n  return {\n    active,\n    activeIndex,\n    attributes,\n    data,\n    rect,\n    index,\n    newIndex,\n    items,\n    isOver,\n    isSorting,\n    isDragging,\n    listeners,\n    node,\n    overIndex,\n    over,\n    setNodeRef,\n    setActivatorNodeRef,\n    setDroppableNodeRef,\n    setDraggableNodeRef,\n    transform: derivedTransform != null ? derivedTransform : finalTransform,\n    transition: getTransition()\n  };\n\n  function getTransition() {\n    if ( // Temporarily disable transitions for a single frame to set up derived transforms\n    derivedTransform || // Or to prevent items jumping to back to their \"new\" position when items change\n    itemsHaveChanged && previous.current.newIndex === index) {\n      return disabledTransition;\n    }\n\n    if (shouldDisplaceDragSource && !isKeyboardEvent(activatorEvent) || !transition) {\n      return undefined;\n    }\n\n    if (isSorting || shouldAnimateLayoutChanges) {\n      return CSS.Transition.toString({ ...transition,\n        property: transitionProperty\n      });\n    }\n\n    return undefined;\n  }\n}\n\nfunction normalizeLocalDisabled(localDisabled, globalDisabled) {\n  var _localDisabled$dragga, _localDisabled$droppa;\n\n  if (typeof localDisabled === 'boolean') {\n    return {\n      draggable: localDisabled,\n      // Backwards compatibility\n      droppable: false\n    };\n  }\n\n  return {\n    draggable: (_localDisabled$dragga = localDisabled == null ? void 0 : localDisabled.draggable) != null ? _localDisabled$dragga : globalDisabled.draggable,\n    droppable: (_localDisabled$droppa = localDisabled == null ? void 0 : localDisabled.droppable) != null ? _localDisabled$droppa : globalDisabled.droppable\n  };\n}\n\nfunction hasSortableData(entry) {\n  if (!entry) {\n    return false;\n  }\n\n  const data = entry.data.current;\n\n  if (data && 'sortable' in data && typeof data.sortable === 'object' && 'containerId' in data.sortable && 'items' in data.sortable && 'index' in data.sortable) {\n    return true;\n  }\n\n  return false;\n}\n\nconst directions = [KeyboardCode.Down, KeyboardCode.Right, KeyboardCode.Up, KeyboardCode.Left];\nconst sortableKeyboardCoordinates = (event, _ref) => {\n  let {\n    context: {\n      active,\n      collisionRect,\n      droppableRects,\n      droppableContainers,\n      over,\n      scrollableAncestors\n    }\n  } = _ref;\n\n  if (directions.includes(event.code)) {\n    event.preventDefault();\n\n    if (!active || !collisionRect) {\n      return;\n    }\n\n    const filteredContainers = [];\n    droppableContainers.getEnabled().forEach(entry => {\n      if (!entry || entry != null && entry.disabled) {\n        return;\n      }\n\n      const rect = droppableRects.get(entry.id);\n\n      if (!rect) {\n        return;\n      }\n\n      switch (event.code) {\n        case KeyboardCode.Down:\n          if (collisionRect.top < rect.top) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n\n        case KeyboardCode.Up:\n          if (collisionRect.top > rect.top) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n\n        case KeyboardCode.Left:\n          if (collisionRect.left > rect.left) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n\n        case KeyboardCode.Right:\n          if (collisionRect.left < rect.left) {\n            filteredContainers.push(entry);\n          }\n\n          break;\n      }\n    });\n    const collisions = closestCorners({\n      active,\n      collisionRect: collisionRect,\n      droppableRects,\n      droppableContainers: filteredContainers,\n      pointerCoordinates: null\n    });\n    let closestId = getFirstCollision(collisions, 'id');\n\n    if (closestId === (over == null ? void 0 : over.id) && collisions.length > 1) {\n      closestId = collisions[1].id;\n    }\n\n    if (closestId != null) {\n      const activeDroppable = droppableContainers.get(active.id);\n      const newDroppable = droppableContainers.get(closestId);\n      const newRect = newDroppable ? droppableRects.get(newDroppable.id) : null;\n      const newNode = newDroppable == null ? void 0 : newDroppable.node.current;\n\n      if (newNode && newRect && activeDroppable && newDroppable) {\n        const newScrollAncestors = getScrollableAncestors(newNode);\n        const hasDifferentScrollAncestors = newScrollAncestors.some((element, index) => scrollableAncestors[index] !== element);\n        const hasSameContainer = isSameContainer(activeDroppable, newDroppable);\n        const isAfterActive = isAfter(activeDroppable, newDroppable);\n        const offset = hasDifferentScrollAncestors || !hasSameContainer ? {\n          x: 0,\n          y: 0\n        } : {\n          x: isAfterActive ? collisionRect.width - newRect.width : 0,\n          y: isAfterActive ? collisionRect.height - newRect.height : 0\n        };\n        const rectCoordinates = {\n          x: newRect.left,\n          y: newRect.top\n        };\n        const newCoordinates = offset.x && offset.y ? rectCoordinates : subtract(rectCoordinates, offset);\n        return newCoordinates;\n      }\n    }\n  }\n\n  return undefined;\n};\n\nfunction isSameContainer(a, b) {\n  if (!hasSortableData(a) || !hasSortableData(b)) {\n    return false;\n  }\n\n  return a.data.current.sortable.containerId === b.data.current.sortable.containerId;\n}\n\nfunction isAfter(a, b) {\n  if (!hasSortableData(a) || !hasSortableData(b)) {\n    return false;\n  }\n\n  if (!isSameContainer(a, b)) {\n    return false;\n  }\n\n  return a.data.current.sortable.index < b.data.current.sortable.index;\n}\n\nexport { SortableContext, arrayMove, arraySwap, defaultAnimateLayoutChanges, defaultNewIndexGetter, hasSortableData, horizontalListSortingStrategy, rectSortingStrategy, rectSwappingStrategy, sortableKeyboardCoordinates, useSortable, verticalListSortingStrategy };\n//# sourceMappingURL=sortable.esm.js.map\n","import { useState } from 'react'\nimport { Calendar } from '@/components/ui/calendar'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport { Calendar as CalendarIcon } from 'lucide-react'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\nimport { cn } from '@/lib/utils'\nimport { logger } from '@/lib/logger'\n\ninterface DateAmountPickerPopoverProps {\n  children: React.ReactNode\n  onConfirm: (date: Date, amount: number) => void\n  disabled?: boolean\n  placeholder?: string\n  align?: \"center\" | \"start\" | \"end\"\n  side?: \"top\" | \"right\" | \"bottom\" | \"left\"\n  defaultDate?: Date\n  defaultAmount?: number\n}\n\nexport function DateAmountPickerPopover({\n  children,\n  onConfirm,\n  disabled = false,\n  placeholder = \"  \",\n  align = \"center\",\n  side = \"bottom\",\n  defaultDate,\n  defaultAmount\n}: DateAmountPickerPopoverProps) {\n  const [open, setOpen] = useState(false)\n  const [selectedDate, setSelectedDate] = useState<Date | undefined>(defaultDate)\n  const [amount, setAmount] = useState<string>(defaultAmount?.toString() || '')\n\n  const handleConfirm = () => {\n    if (!selectedDate) {\n      return\n    }\n    \n    const amountNum = parseFloat(amount.replace(/,/g, ''))\n    if (isNaN(amountNum) || amountNum <= 0) {\n      return\n    }\n\n    onConfirm(selectedDate, amountNum)\n    setOpen(false)\n    // Reset after close\n    setSelectedDate(defaultDate)\n    setAmount(defaultAmount?.toString() || '')\n  }\n\n  const handleAmountChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value.replace(/[^0-9]/g, '')\n    if (value) {\n      const numValue = parseInt(value, 10)\n      setAmount(numValue.toLocaleString())\n    } else {\n      setAmount('')\n    }\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild disabled={disabled}>\n        {children}\n      </PopoverTrigger>\n      <PopoverContent \n        className=\"w-auto p-0 border-gray-200 shadow-lg\" \n        align={align}\n        side={side}\n        sideOffset={8}\n      >\n        <div className=\"bg-white business-radius-card p-3\">\n          <div className=\"mb-2 px-1\">\n            <div className=\"modal-label text-gray-600 text-center\">\n              {placeholder}\n            </div>\n          </div>\n          <Calendar\n            mode=\"single\"\n            selected={selectedDate}\n            onSelect={setSelectedDate}\n            locale={ko}\n            initialFocus\n            className=\"compact-calendar\"\n            disabled={false}\n            fromDate={new Date('2020-01-01')}\n            toDate={new Date('2030-12-31')}\n            defaultMonth={selectedDate || new Date()}\n            modifiers={{\n              today: new Date()\n            }}\n            modifiersClassNames={{\n              today: \"bg-blue-500 text-white font-semibold cursor-pointer hover:bg-blue-600 rounded-md\"\n            }}\n          />\n          <div className=\"mt-3 px-1\">\n            <label className=\"block text-xs font-medium text-gray-700 mb-1\">\n              \n            </label>\n            <Input\n              type=\"text\"\n              value={amount}\n              onChange={handleAmountChange}\n              placeholder=\" \"\n              className=\"w-full\"\n            />\n          </div>\n          <div className=\"mt-3 flex justify-end gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setOpen(false)}\n            >\n              \n            </Button>\n            <Button\n              size=\"sm\"\n              onClick={handleConfirm}\n              disabled={!selectedDate || !amount || parseFloat(amount.replace(/,/g, '')) <= 0}\n              className=\"button-base button-action-primary\"\n            >\n              \n            </Button>\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\n","import { useState } from 'react'\nimport { Calendar } from '@/components/ui/calendar'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport { Calendar as CalendarIcon } from 'lucide-react'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\nimport { cn } from '@/lib/utils'\nimport { logger } from '@/lib/logger'\n\ninterface DateQuantityPickerPopoverProps {\n  children: React.ReactNode\n  onConfirm: (date: Date, quantity?: number) => void\n  disabled?: boolean\n  placeholder?: string\n  align?: \"center\" | \"start\" | \"end\"\n  side?: \"top\" | \"right\" | \"bottom\" | \"left\"\n  defaultDate?: Date\n  defaultQuantity?: number\n  maxQuantity?: number\n  hideQuantityInput?: boolean\n  quantityInfoText?: string\n}\n\nexport function DateQuantityPickerPopover({\n  children,\n  onConfirm,\n  disabled = false,\n  placeholder = \"  \",\n  align = \"center\",\n  side = \"bottom\",\n  defaultDate,\n  defaultQuantity,\n  maxQuantity,\n  hideQuantityInput = false,\n  quantityInfoText = \"   \"\n}: DateQuantityPickerPopoverProps) {\n  const [open, setOpen] = useState(false)\n  const [selectedDate, setSelectedDate] = useState<Date | undefined>(defaultDate)\n  const [quantity, setQuantity] = useState<string>(defaultQuantity?.toString() || '')\n\n  const handleFillRequestedQuantity = () => {\n    if (maxQuantity !== undefined) {\n      setQuantity(maxQuantity.toString())\n    }\n  }\n\n  const handleConfirm = () => {\n    if (!selectedDate) {\n      return\n    }\n    \n    if (hideQuantityInput) {\n      //     ( ), quantity undefined \n      onConfirm(selectedDate, undefined)\n      setOpen(false)\n      // Reset after close\n      setSelectedDate(defaultDate)\n      setQuantity(defaultQuantity?.toString() || '')\n      return\n    }\n    \n    const quantityNum = parseFloat(quantity.replace(/,/g, ''))\n    if (isNaN(quantityNum) || quantityNum < 0) {\n      return\n    }\n\n    if (maxQuantity && quantityNum > maxQuantity) {\n      return\n    }\n\n    onConfirm(selectedDate, quantityNum)\n    setOpen(false)\n    // Reset after close\n    setSelectedDate(defaultDate)\n    setQuantity(defaultQuantity?.toString() || '')\n  }\n\n  const handleQuantityChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value.replace(/[^0-9]/g, '')\n    setQuantity(value)\n  }\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild disabled={disabled}>\n        {children}\n      </PopoverTrigger>\n      <PopoverContent \n        className=\"w-auto p-0 border-gray-200 shadow-lg\" \n        align={align}\n        side={side}\n        sideOffset={8}\n      >\n        <div className=\"bg-white business-radius-card p-3\">\n          <div className=\"mb-2 px-1\">\n            <div className=\"modal-label text-gray-600 text-center\">\n              {placeholder}\n            </div>\n          </div>\n          {hideQuantityInput && (\n            <div className=\"mb-2 px-1\">\n              <div className=\"text-[10px] text-gray-500 text-center leading-tight\">\n                <div> </div>\n                <div> </div>\n              </div>\n            </div>\n          )}\n          <Calendar\n            mode=\"single\"\n            selected={selectedDate}\n            onSelect={setSelectedDate}\n            locale={ko}\n            initialFocus\n            className=\"compact-calendar\"\n            disabled={false}\n            fromDate={new Date('2020-01-01')}\n            toDate={new Date('2030-12-31')}\n            defaultMonth={selectedDate || new Date()}\n            modifiers={{\n              today: new Date()\n            }}\n            modifiersClassNames={{\n              today: \"bg-blue-500 text-white font-semibold cursor-pointer hover:bg-blue-600 rounded-md\"\n            }}\n          />\n          {!hideQuantityInput && (\n            <div className=\"mt-3 px-1\">\n              <div className=\"flex items-center justify-between mb-1 gap-2\">\n                <label className=\"block text-xs font-medium text-gray-700\">\n                  {quantityInfoText?.includes('') ? '' : ''}\n                </label>\n                {maxQuantity !== undefined && (\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleFillRequestedQuantity}\n                    className=\"h-6 px-2 text-[10px] border-gray-200 text-hansl-600\"\n                  >\n                    {quantityInfoText?.includes('') ? '  ' : ' '}\n                  </Button>\n                )}\n              </div>\n              <Input\n                type=\"number\"\n                value={quantity}\n                onChange={handleQuantityChange}\n                placeholder=\" \"\n                className=\"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                min=\"0\"\n                max={maxQuantity}\n              />\n              {maxQuantity && (\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  {quantityInfoText?.includes('') ? quantityInfoText : `: ${maxQuantity.toLocaleString()}`}\n                </p>\n              )}\n            </div>\n          )}\n          <div className=\"mt-3 flex justify-end gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => setOpen(false)}\n              className=\"button-base\"\n            >\n              \n            </Button>\n            <Button\n              size=\"sm\"\n              onClick={handleConfirm}\n              disabled={!selectedDate || (!hideQuantityInput && (!quantity || parseFloat(quantity.replace(/,/g, '')) < 0 || (maxQuantity !== undefined && parseFloat(quantity.replace(/,/g, '')) > maxQuantity)))}\n              className=\"button-base button-action-primary\"\n            >\n              \n            </Button>\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\n","import { useCallback } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { toast } from 'sonner'\nimport { logger } from '@/lib/logger'\nimport { markItemAsReceived, markItemAsReceiptCanceled, markItemAsStatementReceived, markItemAsStatementCanceled } from '@/stores/purchaseMemoryStore'\n\nexport interface ConfirmDateActionConfig {\n  field: 'statement_received' | 'actual_received'\n  confirmMessage: {\n    confirm: string\n    cancel: string\n  }\n  successMessage: {\n    confirm: string\n    cancel: string\n  }\n  completedText: string\n  waitingText: string\n}\n\nexport interface UseConfirmDateActionProps {\n  config: ConfirmDateActionConfig\n  currentUserName: string | null\n  canPerformAction: boolean\n  purchaseId?: number | string  //     purchase ID\n  onUpdate?: () => void\n  onOptimisticUpdate?: (params: {\n    itemId: number\n    selectedDate?: Date\n    action: 'confirm' | 'cancel'\n    receivedQuantity?: number\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n      received_quantity?: number\n    }\n  }) => void\n}\n\nexport function useConfirmDateAction({\n  config,\n  currentUserName,\n  canPerformAction,\n  purchaseId,\n  onUpdate,\n  onOptimisticUpdate\n}: UseConfirmDateActionProps) {\n  const supabase = createClient()\n\n  const handleConfirm = useCallback(async (\n    itemId: number | string,\n    selectedDate: Date,\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n      received_quantity?: number\n    },\n    receivedQuantity?: number\n  ) => {\n    \n    if (!canPerformAction) {\n      logger.warn(`  `, { canPerformAction, currentUserName })\n      toast.error(`${config.field === 'statement_received' ? '' : ''}   .`)\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      logger.error('  ID', { itemId, numericId })\n      toast.error('   ID .')\n      return\n    }\n\n    //   \n    if (itemInfo) {\n      const confirmMessage = `: ${itemInfo.item_name || '-'}\n: ${itemInfo.specification || '-'}\n: ${itemInfo.quantity?.toLocaleString() || 0}\n: ${itemInfo.unit_price_value?.toLocaleString() || 0}\n: ${itemInfo.amount_value?.toLocaleString() || 0}\n: ${itemInfo.remark || '-'}\n\n${config.confirmMessage.confirm}`\n      \n      if (!window.confirm(confirmMessage)) {\n        return\n      }\n    }\n\n    try {\n      let updateData: any\n\n      if (config.field === 'statement_received') {\n        updateData = {\n          is_statement_received: true,\n          statement_received_date: selectedDate.toISOString(),\n          statement_received_by_name: currentUserName\n        }\n      } else if (config.field === 'actual_received') {\n        //   : receipt_history  \n        const requestedQuantity = itemInfo?.quantity || 0\n        const currentReceivedQuantity = itemInfo?.received_quantity || 0\n        const newReceivedQuantity = receivedQuantity !== undefined ? receivedQuantity : requestedQuantity\n        const totalReceivedQuantity = currentReceivedQuantity + newReceivedQuantity\n        \n        //      \n        const { data: existingItem } = await supabase\n          .from('purchase_request_items')\n          .select('receipt_history')\n          .eq('id', numericId)\n          .single()\n        \n        const existingHistory = (existingItem?.receipt_history as any[]) || []\n        const nextSeq = existingHistory.length + 1\n        \n        //    \n        const newHistoryItem = {\n          seq: nextSeq,\n          qty: newReceivedQuantity,\n          date: selectedDate.toISOString(),\n          by: currentUserName || ''\n        }\n        \n        const updatedHistory = [...existingHistory, newHistoryItem]\n        \n        //    :   >=  \n        const isFullyReceived = totalReceivedQuantity >= requestedQuantity\n        \n        updateData = {\n          actual_received_date: selectedDate.toISOString(),\n          is_received: isFullyReceived,\n          received_quantity: totalReceivedQuantity,\n          delivery_status: totalReceivedQuantity === 0 ? 'pending' : (isFullyReceived ? 'received' : 'partial'),\n          receipt_history: updatedHistory\n        }\n        \n        logger.debug('   :', {\n          requestedQuantity,\n          currentReceivedQuantity,\n          newReceivedQuantity,\n          totalReceivedQuantity,\n          isFullyReceived,\n          historyCount: updatedHistory.length\n        })\n      }\n\n      logger.debug('  :', updateData)\n\n      const { data, error } = await supabase\n        .from('purchase_request_items')\n        .update(updateData)\n        .eq('id', numericId)\n        .select()\n\n      logger.debug(' DB  :', { data, error })\n\n      if (error) {\n        logger.error(' DB  ', error)\n        throw error\n      }\n\n      logger.info(' DB  ', data)\n\n      //     \n      if (purchaseId) {\n        if (config.field === 'actual_received') {\n          const memoryUpdated = markItemAsReceived(purchaseId, numericId, selectedDate.toISOString(), receivedQuantity)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]     ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        } else if (config.field === 'statement_received') {\n          const memoryUpdated = markItemAsStatementReceived(purchaseId, numericId, selectedDate.toISOString(), currentUserName || undefined)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]      ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        }\n      }\n\n      if (onOptimisticUpdate) {\n        onOptimisticUpdate({\n          itemId: numericId,\n          selectedDate,\n          action: 'confirm',\n          receivedQuantity: receivedQuantity !== undefined ? receivedQuantity : itemInfo?.received_quantity,\n          itemInfo\n        })\n      }\n\n      //    onUpdate \n      if (onUpdate) {\n        onUpdate()\n      }\n      \n      toast.success(config.successMessage.confirm)\n    } catch (error) {\n      logger.error('   ', error)\n      toast.error(`${config.field === 'statement_received' ? '' : ''}     .`)\n    }\n  }, [config, currentUserName, canPerformAction, purchaseId, onUpdate, onOptimisticUpdate, supabase])\n\n  const handleCancel = useCallback(async (\n    itemId: number | string,\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n    }\n  ) => {\n    if (!canPerformAction) {\n      logger.warn(`   `, { canPerformAction, currentUserName })\n      toast.error(`${config.field === 'statement_received' ? '' : ''}   .`)\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('   ID .')\n      return\n    }\n\n    //   \n    if (itemInfo) {\n      const confirmMessage = `: ${itemInfo.item_name || '-'}\n: ${itemInfo.specification || '-'}\n: ${itemInfo.quantity?.toLocaleString() || 0}\n: ${itemInfo.unit_price_value?.toLocaleString() || 0}\n: ${itemInfo.amount_value?.toLocaleString() || 0}\n: ${itemInfo.remark || '-'}\n\n${config.confirmMessage.cancel}`\n      \n      if (!window.confirm(confirmMessage)) {\n        return\n      }\n    }\n\n    try {\n      logger.debug(` ${config.field}   `, { \n        itemId, \n        itemName: itemInfo?.item_name \n      })\n\n      let updateData: any\n\n      if (config.field === 'statement_received') {\n        updateData = {\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      } else if (config.field === 'actual_received') {\n        //   : receipt_history  \n        updateData = {\n          actual_received_date: null,\n          is_received: false,\n          received_quantity: 0,\n          delivery_status: 'pending',\n          receipt_history: []\n        }\n      }\n\n      logger.debug('   :', updateData)\n\n      const { data, error } = await supabase\n        .from('purchase_request_items')\n        .update(updateData)\n        .eq('id', numericId)\n        .select()\n\n      logger.debug('  DB  :', { data, error })\n\n      if (error) {\n        logger.error(' DB  ', error)\n        throw error\n      }\n\n      logger.info(` ${config.field}   `, data)\n\n      //     \n      if (purchaseId) {\n        if (config.field === 'actual_received') {\n          const memoryUpdated = markItemAsReceiptCanceled(purchaseId, numericId)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]     ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        } else if (config.field === 'statement_received') {\n          const memoryUpdated = markItemAsStatementCanceled(purchaseId, numericId)\n          if (!memoryUpdated) {\n            logger.warn('[useConfirmDateAction]      ', { \n              purchaseId, \n              itemId: numericId \n            })\n          }\n        }\n      }\n\n      if (onOptimisticUpdate) {\n        onOptimisticUpdate({\n          itemId: numericId,\n          action: 'cancel',\n          itemInfo\n        })\n      }\n\n      //    onUpdate \n      if (onUpdate) {\n        onUpdate()\n      }\n      \n      toast.success(config.successMessage.cancel)\n    } catch (error) {\n      logger.error(` ${config.field}   `, error)\n      toast.error(`${config.field === 'statement_received' ? '' : ''}     .`)\n    }\n  }, [config, canPerformAction, purchaseId, onUpdate, onOptimisticUpdate, supabase])\n\n  const isCompleted = useCallback((item: any) => {\n    if (config.field === 'statement_received') {\n      return item.is_statement_received\n    } else if (config.field === 'actual_received') {\n      return item.is_received // actual_received_date  is_received  \n    }\n    return false\n  }, [config.field])\n\n  //     ( )\n  const isPartiallyReceived = useCallback((item: any) => {\n    if (config.field === 'actual_received') {\n      const receivedQty = item.received_quantity || 0\n      const requestedQty = item.quantity || 0\n      return receivedQty > 0 && receivedQty < requestedQty\n    }\n    return false\n  }, [config.field])\n\n  //   \n  const getRemainingQuantity = useCallback((item: any) => {\n    const receivedQty = item.received_quantity || 0\n    const requestedQty = item.quantity || 0\n    return Math.max(0, requestedQty - receivedQty)\n  }, [])\n\n  const getCompletedDate = useCallback((item: any) => {\n    if (config.field === 'statement_received') {\n      return item.statement_received_date\n    } else if (config.field === 'actual_received') {\n      return item.actual_received_date\n    }\n    return null\n  }, [config.field])\n\n  const getCompletedByName = useCallback((item: any) => {\n    if (config.field === 'statement_received') {\n      return item.statement_received_by_name\n    } else if (config.field === 'actual_received') {\n      //     \n      return null\n    }\n    return null\n  }, [config.field])\n\n  return {\n    config,\n    handleConfirm,\n    handleCancel,\n    isCompleted,\n    isPartiallyReceived,\n    getRemainingQuantity,\n    getCompletedDate,\n    getCompletedByName\n  }\n}","import { ColumnInfo, DoneTabColumnId, ColumnVisibility } from '@/types/columnSettings';\n\n/**\n *     \n * 22     \n */\n\n//     ( )\nexport const DONE_TAB_COLUMNS: ColumnInfo[] = [\n  {\n    id: 'statement_progress',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'purchase_order_number',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'payment_category',\n    label: '',\n    description: '  (, ,  )',\n    defaultVisible: true,\n  },\n  {\n    id: 'requester_name',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'request_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'utk_status',\n    label: 'UTK',\n    description: 'UTK  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'vendor_name',\n    label: '',\n    description: '',\n    defaultVisible: true,\n  },\n  {\n    id: 'contact_name',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'delivery_request_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'revised_delivery_date',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'item_name',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'specification',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'quantity',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'unit_price',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'amount',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'remark',\n    label: '',\n    description: '  ',\n    defaultVisible: true,\n  },\n  {\n    id: 'link',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'project_vendor',\n    label: 'PJ',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'project_item',\n    label: 'PJ ITEM',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'sales_order_number',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'purchase_progress',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n  {\n    id: 'receipt_progress',\n    label: '',\n    description: ' ',\n    defaultVisible: true,\n  },\n];\n\n//     (  )\nexport const DEFAULT_COLUMN_VISIBILITY: ColumnVisibility = DONE_TAB_COLUMNS.reduce(\n  (acc, column) => {\n    acc[column.id] = column.defaultVisible;\n    return acc;\n  },\n  {} as ColumnVisibility\n);\n\n//  ID    \nexport const COLUMN_INFO_MAP: Record<DoneTabColumnId, ColumnInfo> = DONE_TAB_COLUMNS.reduce(\n  (acc, column) => {\n    acc[column.id] = column;\n    return acc;\n  },\n  {} as Record<DoneTabColumnId, ColumnInfo>\n);\n\n//   (   )\nexport const REQUIRED_COLUMNS: DoneTabColumnId[] = [\n  'purchase_order_number',\n  'vendor_name',\n  'item_name',\n  'specification',\n];\n\n//    (     )\nexport const RESTRICTED_COLUMNS: DoneTabColumnId[] = [\n  'statement_progress',  // \n  'utk_status',         // UTK\n  'unit_price',         // \n  'amount',            // ( )\n];\n\n//   \nexport const AUTHORIZED_ROLES = [\n  'app_admin',\n  'ceo',\n  'final_approver',\n  'purchase_manager',\n  'lead buyer',\n  'accounting',\n];\n\n//   ( UI )\nexport const COLUMN_GROUPS = [\n  {\n    title: ' ',\n    columns: [\n      'statement_progress',\n      'purchase_order_number',\n      'payment_category',\n      'requester_name',\n      'request_date',\n      'utk_status',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'vendor_name',\n      'contact_name',\n      'delivery_request_date',\n      'revised_delivery_date',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'item_name',\n      'specification',\n      'quantity',\n      'unit_price',\n      'amount',\n      'remark',\n      'link',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'project_vendor',\n      'project_item',\n      'sales_order_number',\n    ] as DoneTabColumnId[],\n  },\n  {\n    title: ' ',\n    columns: [\n      'purchase_progress',\n      'receipt_progress',\n    ] as DoneTabColumnId[],\n  },\n] as const;","import { useEffect, useState, useRef, useCallback, useMemo, memo, type CSSProperties } from 'react'\nimport { DndContext, closestCenter, PointerSensor, useSensor, useSensors, type DragEndEvent } from '@dnd-kit/core'\nimport { SortableContext, verticalListSortingStrategy, useSortable, arrayMove } from '@dnd-kit/sortable'\nimport { CSS } from '@dnd-kit/utilities'\nimport { createClient } from '@/lib/supabase/client'\nimport { PurchaseRequestWithDetails, Purchase, Vendor } from '@/types/purchase'\nimport { findPurchaseInMemory, markItemAsPaymentCompleted, markPurchaseAsPaymentCompleted, markItemAsReceived, markPurchaseAsReceived, markItemAsPaymentCanceled, markItemAsStatementReceived, markItemAsStatementCanceled, usePurchaseMemory, updatePurchaseInMemory, removeItemFromMemory, markItemAsExpenditureSet, markBulkExpenditureSet, removePurchaseFromMemory, addCacheListener } from '@/stores/purchaseMemoryStore'\nimport { formatDate } from '@/utils/helpers'\nimport { DatePickerPopover } from '@/components/ui/date-picker-popover'\nimport { DateAmountPickerPopover } from '@/components/ui/date-amount-picker-popover'\nimport { DateQuantityPickerPopover } from '@/components/ui/date-quantity-picker-popover'\nimport { \n  Calendar, \n  User, \n  Building2, \n  Package, \n  CreditCard,\n  X,\n  FileText,\n  DollarSign,\n  Edit2,\n  Trash2,\n  Save,\n  Plus,\n  CheckCircle,\n  XCircle,\n  Check,\n  Truck,\n  MessageSquarePlus,\n  Loader2,\n  GripVertical,\n  Image as ImageIcon,\n  FileCheck\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover'\nimport { Label } from '@/components/ui/label'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { toast } from 'sonner'\nimport { logger } from '@/lib/logger'\nimport { useConfirmDateAction } from '@/hooks/useConfirmDateAction'\nimport { format as formatDateInput } from 'date-fns'\nimport { AUTHORIZED_ROLES } from '@/constants/columnSettings'\nimport ReactSelect from 'react-select'\nimport transactionStatementService from '@/services/transactionStatementService'\nimport type { TransactionStatement } from '@/types/transactionStatement'\n\ninterface PurchaseDetailModalProps {\n  purchaseId: number | null\n  isOpen: boolean\n  onClose: () => void\n  embedded?: boolean  // Dialog   \n  currentUserRoles?: string[]\n  activeTab?: string\n  onRefresh?: (forceRefresh?: boolean, options?: { silent?: boolean }) => void | Promise<void>\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void\n  onDelete?: (purchase: PurchaseRequestWithDetails) => void\n}\n\ntype SortableRenderProps = {\n  setNodeRef: (element: HTMLElement | null) => void\n  style: CSSProperties\n  attributes: any\n  listeners: any\n  isDragging: boolean\n}\n\ntype SortableRowProps = {\n  id: string\n  children: (props: SortableRenderProps) => React.ReactNode\n}\n\n//  SortableRow        (  )\nconst SortableRow = ({ id, children }: SortableRowProps) => {\n  const { attributes, listeners, setNodeRef, transform, transition, isDragging } = useSortable({ id })\n  const style: CSSProperties = {\n    transform: CSS.Transform.toString(transform),\n    transition\n  }\n  return <>{children({ setNodeRef, attributes, listeners, isDragging, style })}</>\n}\n\nfunction PurchaseDetailModal({ \n  purchaseId, \n  isOpen, \n  onClose, \n  embedded = false,\n  currentUserRoles = [],\n  activeTab,\n  onRefresh,\n  onOptimisticUpdate,\n  onDelete\n}: PurchaseDetailModalProps) {\n  const { allPurchases, lastFetch } = usePurchaseMemory(); //     \n  \n  const [loading, setLoading] = useState(false)\n  const [purchase, setPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [isEditing, setIsEditing] = useState(false)\n  const [editedPurchase, setEditedPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [editedItems, setEditedItems] = useState<any[]>([])\n  const [deletedItemIds, setDeletedItemIds] = useState<number[]>([])\n  const [userRoles, setUserRoles] = useState<string[]>([])\n  const [currentUserName, setCurrentUserName] = useState<string>('')\n  const [columnWidths, setColumnWidths] = useState<number[]>([])\n  const [focusedInput, setFocusedInput] = useState<string | null>(null)\n  const [vendors, setVendors] = useState<Vendor[]>([])\n  const [vendorSearchTerm, setVendorSearchTerm] = useState('')\n  \n  //   \n  const [isModifyRequestOpen, setIsModifyRequestOpen] = useState(false)\n  const [modifySubject, setModifySubject] = useState('')\n  const [modifyMessage, setModifyMessage] = useState('')\n  const [isSendingModify, setIsSendingModify] = useState(false)\n  \n  //   \n  const [isSaving, setIsSaving] = useState(false)\n\n  //   \n  const [linkedStatements, setLinkedStatements] = useState<TransactionStatement[]>([])\n  const [isStatementViewerOpen, setIsStatementViewerOpen] = useState(false)\n  const [selectedStatementImage, setSelectedStatementImage] = useState<string>('')\n\n  const sensors = useSensors(\n    useSensor(PointerSensor, { activationConstraint: { distance: 4 } })\n  )\n\n  const makeStableKey = useCallback((item: any, idx: number) => {\n    return item?.stableKey\n      ?? (item?.id != null ? `sk-item-${item.id}`\n      : item?.tempId ? `sk-tmp-${item.tempId}`\n      : item?.line_number != null ? `sk-line-${item.line_number}-${idx}`\n      : `sk-idx-${idx}`)\n  }, [])\n\n  const normalizeItems = useCallback((items: any[] = []) => {\n    return items.map((item, idx) => {\n      const withTemp = {\n        ...item,\n        tempId: item?.tempId ?? `tmp-${item?.id ?? item?.line_number ?? idx}-${idx}`\n      }\n      return {\n        ...withTemp,\n        stableKey: makeStableKey(withTemp, idx)\n      }\n    })\n  }, [makeStableKey])\n\n  const getSortableId = useCallback((item: any, index: number) => {\n    if (item?.stableKey) return item.stableKey\n    if (item?.id != null) return `item-${item.id}`\n    if (item?.tempId) return `tmp-${item.tempId}`\n    if (item?.line_number != null) return `line-${item.line_number}`\n    return `temp-${index}`\n  }, [])\n\n  const handleDragEnd = useCallback((event: DragEndEvent) => {\n    const { active, over } = event\n    if (!over || active.id === over.id) return\n\n    setEditedItems(prev => {\n      const oldIndex = prev.findIndex((item, index) => getSortableId(item, index) === active.id)\n      const newIndex = prev.findIndex((item, index) => getSortableId(item, index) === over.id)\n      if (oldIndex === -1 || newIndex === -1) return prev\n\n      const reordered = arrayMove(prev, oldIndex, newIndex).map((item, idx) => ({\n        ...item,\n        line_number: idx + 1,\n        stableKey: item.stableKey ?? makeStableKey(item, idx)\n      }))\n      return reordered\n    })\n  }, [getSortableId, makeStableKey])\n\n  //   \n  useEffect(() => {\n    if (isModifyRequestOpen && purchase) {\n      setModifySubject(`[]  ${purchase.purchase_order_number}  .`)\n      setModifyMessage('') //    \n    }\n  }, [isModifyRequestOpen, purchase])\n\n  //  \n  const handleSendModifyRequest = async () => {\n    if (!modifySubject.trim() || !modifyMessage.trim()) {\n      toast.error('   .')\n      return\n    }\n\n    setIsSendingModify(true)\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      \n      if (!user) {\n        toast.error(' .')\n        return\n      }\n\n      const { error } = await supabase\n        .from('support_inquires')\n        .insert({\n          user_id: user.id,\n          user_email: user.email,\n          user_name: currentUserName,\n          inquiry_type: 'modify',\n          subject: modifySubject,\n          message: modifyMessage,\n          status: 'open',\n          purchase_request_id: purchase?.id,\n          purchase_order_number: purchase?.purchase_order_number,\n          requester_id: purchase?.requester_id,\n          purchase_info: JSON.stringify({\n            vendor_name: purchase?.vendor_name,\n            total_amount: purchase?.total_amount,\n            item_count: purchase?.purchase_request_items?.length || 0\n          })\n        })\n\n      if (error) throw error\n\n      toast.success('  .')\n      setIsModifyRequestOpen(false)\n      setModifySubject('')\n      setModifyMessage('')\n    } catch (error) {\n      logger.error('   ', error)\n      toast.error('     .')\n    } finally {\n      setIsSendingModify(false)\n    }\n  }\n\n  //    useEffect \n\n  //  isEditing  ref  (    )\n  const isEditingRef = useRef(isEditing)\n  useEffect(() => {\n    isEditingRef.current = isEditing\n  }, [isEditing])\n\n  //  Realtime   -         \n  const realtimeFirstMount = useRef(true)\n  useEffect(() => {\n    if (!isOpen || !purchaseId) return\n\n    const handleCacheUpdate = () => {\n      if (realtimeFirstMount.current) {\n        realtimeFirstMount.current = false\n        return\n      }\n      //        (  )\n      if (isEditingRef.current) {\n        return\n      }\n      //       \n      const updatedPurchase = findPurchaseInMemory(purchaseId)\n      if (updatedPurchase) {\n        //   items     items  (    )\n        const cachedItems = updatedPurchase.items || updatedPurchase.purchase_request_items || []\n        \n        setPurchase((prevPurchase) => {\n          //   items   items   items \n          const prevItems = prevPurchase?.items || prevPurchase?.purchase_request_items || []\n          const shouldPreserveItems = prevItems.length > 0 && cachedItems.length === 0\n          \n          const mergedItems = shouldPreserveItems ? prevItems : cachedItems\n          \n          return {\n            ...updatedPurchase,\n            id: String(updatedPurchase.id),\n            is_po_generated: false,\n            items: mergedItems,\n            purchase_request_items: mergedItems\n          } as PurchaseRequestWithDetails\n        })\n      }\n      // updatedPurchase null      (setPurchase  )\n    }\n\n    const unsubscribe = addCacheListener(handleCacheUpdate)\n    return () => unsubscribe()\n  }, [isOpen, purchaseId])\n\n  //   items        \n  const prevItemsRef = useRef<any[]>([])\n\n  //   items  ( purchase state  )\n  const currentItems = useMemo(() => {\n    let result: any[] = []\n    \n    // purchase state   (   )\n    if (purchase?.items && purchase.items.length > 0) {\n      result = normalizeItems(purchase.items);\n    } else if (purchase?.purchase_request_items && purchase.purchase_request_items.length > 0) {\n      result = normalizeItems(purchase.purchase_request_items);\n    } else if (purchaseId && allPurchases) {\n      // purchase state    \n      const memoryPurchase = allPurchases.find(p => p.id === purchaseId);\n      if (memoryPurchase) {\n        const memoryItems = (memoryPurchase.items && memoryPurchase.items.length > 0)\n          ? memoryPurchase.items\n          : (memoryPurchase.purchase_request_items || []);\n        result = normalizeItems(memoryItems);\n      }\n    }\n    \n    //         items     (    )\n    if (result.length === 0 && prevItemsRef.current.length > 0) {\n      return prevItemsRef.current;\n    }\n    \n    //    ref \n    if (result.length > 0) {\n      prevItemsRef.current = result;\n    }\n    \n    return result;\n  }, [purchase, purchaseId, allPurchases, lastFetch, normalizeItems]); // purchase       \n\n  //   :      ,   line_number \n  const displayItems = useMemo(() => {\n    if (isEditing) return editedItems || []\n    const base = currentItems || []\n    return [...base].sort((a, b) => {\n      const la = a?.line_number ?? 999999\n      const lb = b?.line_number ?? 999999\n      if (la !== lb) return la - lb\n      // tie-breakers to keep stable order\n      const ca = a?.created_at ? new Date(a.created_at).getTime() : 0\n      const cb = b?.created_at ? new Date(b.created_at).getTime() : 0\n      if (ca !== cb) return ca - cb\n      const ia = a?.id ?? 0\n      const ib = b?.id ?? 0\n      if (ia !== ib) return ia - ib\n      const ta = a?.tempId ?? ''\n      const tb = b?.tempId ?? ''\n      if (ta < tb) return -1\n      if (ta > tb) return 1\n      return 0\n    })\n  }, [isEditing, editedItems, currentItems])\n\n  //  SortableContext items     (  )\n  const sortableIds = useMemo(() => {\n    return (editedItems || []).map((item, idx) => getSortableId(item, idx))\n  }, [editedItems, getSortableId])\n\n  const tableMinWidth = useMemo(() => {\n    if (columnWidths.length > 0) {\n      const columnGap = columnWidths.length > 1 ? (columnWidths.length - 1) * 12 : 0\n      const padding = 24\n      const total = columnWidths.reduce((sum, width) => sum + width, 0) + columnGap + padding\n      return Math.max(total, 720)\n    }\n\n    const baseColumns: number[] = [120, 200, 70, 90, 100, 150, 80] // , , , , , , \n\n    if (activeTab === 'purchase') {\n      baseColumns.push(120)\n    }\n\n    if (activeTab === 'receipt' || activeTab === 'done') {\n      baseColumns.push(120)\n    }\n\n    if (activeTab === 'receipt') {\n      baseColumns.push(140)\n    }\n\n    if (activeTab === 'done') {\n      baseColumns.push(100, 80, 110) // (100), (80), (110)\n    }\n\n    if (isEditing) {\n      baseColumns.push(110)\n    }\n\n    const columnGap = baseColumns.length > 1 ? (baseColumns.length - 1) * 12 : 0\n    const total = baseColumns.reduce((sum, width) => sum + width, 0) + columnGap + 48\n    return Math.max(total, 720)\n  }, [columnWidths, activeTab, isEditing])\n  const headerRowRef = useRef<HTMLDivElement>(null)\n  const supabase = createClient()\n  \n  //      \n  useEffect(() => {\n    const loadUserRoles = async () => {\n      try {\n        // Supabase   \n        const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n        const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n        \n        if (!supabaseUrl || !supabaseAnonKey || supabaseUrl.includes('placeholder')) {\n          logger.warn('Supabase     - PurchaseDetailModal');\n          return;\n        }\n\n        const { data: { user } } = await supabase.auth.getUser()\n        if (user) {\n          //  ID \n          let { data: employeeData } = await supabase\n            .from('employees')\n            .select('*')\n            .eq('id', user.id)\n            .maybeSingle()\n          \n          // ID    \n          if (!employeeData && user.email) {\n            const { data: employeeByEmail } = await supabase\n              .from('employees')\n              .select('*')\n              .eq('email', user.email)\n              .maybeSingle()\n            \n            employeeData = employeeByEmail\n          }\n          \n          //   \n          if (employeeData?.name) {\n            setCurrentUserName(employeeData.name)\n          }\n          \n          if (employeeData?.purchase_role) {\n            let roles: string[] = []\n            if (Array.isArray(employeeData.purchase_role)) {\n              roles = employeeData.purchase_role.map((r: any) => String(r).trim())\n            } else {\n              const roleString = String(employeeData.purchase_role)\n              roles = roleString\n                .split(',')\n                .map((r: string) => r.trim())\n                .filter((r: string) => r.length > 0)\n            }\n            setUserRoles(roles)\n          }\n        }\n      } catch (error) {\n      }\n    }\n    \n    if (isOpen) {\n      loadUserRoles()\n    }\n  }, [isOpen])\n\n  //   \n  useEffect(() => {\n    const loadVendors = async () => {\n      try {\n        const { data: vendorsData, error } = await supabase\n          .from('vendors')\n          .select('*')\n          .order('vendor_name', { ascending: true })\n        \n        if (error) throw error\n        if (vendorsData) {\n          setVendors(vendorsData)\n        }\n      } catch (error) {\n        logger.error('   :', error)\n      }\n    }\n    \n    if (isOpen) {\n      loadVendors()\n    }\n  }, [isOpen])\n  \n  // currentUserRoles   userRoles \n  const effectiveRoles = Array.isArray(currentUserRoles) && currentUserRoles.length > 0 \n    ? currentUserRoles \n    : userRoles\n  \n  //  \n  //    (   )\n  const canEditAll = effectiveRoles.includes('final_approver') || \n                     effectiveRoles.includes('app_admin') || \n                     effectiveRoles.includes('ceo')\n  \n  // lead buyer    (/  )\n  const canEditLimited = effectiveRoles.includes('lead buyer')\n  \n  //    (      )\n  const canEdit = canEditAll || canEditLimited\n  \n  //     \n  const canViewFinancialInfo = effectiveRoles.some(role => AUTHORIZED_ROLES.includes(role))\n  \n  const showStatementColumns = purchase?.payment_category === '' && (\n    activeTab === 'done' || (activeTab === 'receipt' && effectiveRoles.includes('lead buyer'))\n  )\n  const showExpenditureColumn = purchase?.payment_category === '' && activeTab === 'done'\n  \n  //  :     (,   , lead buyer  )\n  const isApproved = purchase?.final_manager_status === 'approved';\n  const canDelete = isApproved \n    ? canEditAll  //      (lead buyer )\n    : (canEditAll || (purchase?.requester_name === currentUserName))  //  lead buyer \n  \n  //   : app_admin + lead buyer (  )\n  const canPurchase = effectiveRoles.includes('app_admin') || \n                     effectiveRoles.includes('lead buyer') || \n                     effectiveRoles.includes('lead buyer')\n  \n  //    \n  // 1.      \n  // 2.      \n  const canReceiveItems = effectiveRoles.includes('app_admin') || \n                         (purchase?.requester_name === currentUserName)\n  // 2.        \n  const isAdmin = effectiveRoles.includes('final_approver') || \n                  effectiveRoles.includes('app_admin') || \n                  effectiveRoles.includes('ceo')\n  const isRequester = purchase?.requester_name === currentUserName\n  \n  //   & UTK  : app_admin lead buyer, accounting \n  const canReceiptCheck = effectiveRoles.includes('app_admin') || \n                         effectiveRoles.includes('lead buyer') ||\n                         effectiveRoles.includes('accounting')\n  \n  //   : app_admin    \n  const canProcessReceipt = effectiveRoles.includes('app_admin') || isRequester\n  \n\n  //      (  )\n  const refreshModalData = useCallback(async () => {\n    if (!purchaseId) return\n    \n    try {\n      //  DB    vendor_contacts   \n      //   vendor_contacts    \n      const supabase = createClient()\n      //     \n      //  purchase_requests  \n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          vendors:vendor_id(id, vendor_name, is_active),\n          purchase_request_items(*),\n          contact:contact_id(id, contact_name, contact_email, contact_phone, position)\n        `)\n        .eq('id', purchaseId)\n        .single()\n      \n      if (error) throw error\n      \n      // vendor_id      ,      \n      let vendorContacts = []\n      if (data && data.vendor_id) {\n        const { data: allContacts } = await supabase\n          .from('vendor_contacts')\n          .select('id, contact_name, contact_email, contact_phone, position')\n          .eq('vendor_id', data.vendor_id)\n          .order('contact_name')\n        \n        if (allContacts && allContacts.length > 0) {\n          // contact_id     \n          if (data.contact_id) {\n            const currentContact = allContacts.find((c: any) => c.id === data.contact_id)\n            const otherContacts = allContacts.filter((c: any) => c.id !== data.contact_id)\n            vendorContacts = currentContact ? [currentContact, ...otherContacts] : allContacts\n          } else {\n            vendorContacts = allContacts\n          }\n          logger.info('    :', {\n            vendor_id: data.vendor_id,\n            contact_id: data.contact_id,\n            allContacts_count: allContacts.length,\n            vendorContacts\n          })\n        }\n      } else if (data && data.contact) {\n        // vendor_id   contact  \n        vendorContacts = [data.contact]\n      }\n\n      if (data) {\n        //   \n        const sortedItems = normalizeItems((data.purchase_request_items || []).sort((a: any, b: any) => {\n          const lineA = a.line_number || 999999;\n          const lineB = b.line_number || 999999;\n          return lineA - lineB;\n        }));\n\n        const purchaseData = {\n          ...data,\n          items: sortedItems,\n          vendor: data.vendors || null,\n          vendor_contacts: vendorContacts,\n          contact_id: data.contact_id,  // contact_id \n          contact_name: vendorContacts[0]?.contact_name || data.contact?.contact_name || null  // contact_name \n        } as PurchaseRequestWithDetails\n\n        setPurchase({\n          ...purchaseData,\n          items: sortedItems\n        })\n        setEditedPurchase(purchaseData)\n        setEditedItems(sortedItems)\n        logger.info(' refreshModalData DB  :', { \n          vendor_contacts: purchaseData.vendor_contacts,\n          vendorContacts_from_query: vendorContacts,\n          purchase_updated: true,\n          vendor_id: data.vendor_id,\n          has_vendor_contacts: vendorContacts && vendorContacts.length > 0\n        })\n        console.log(' refreshModalData - DB  :', {\n          vendor_id: data.vendor_id,\n          vendor_contacts: vendorContacts,\n          purchaseData_full: purchaseData,\n          : vendorContacts?.[0]?.contact_name || ''\n        })\n      }\n    } catch (error) {\n      logger.error('   ', error)\n    }\n  }, [purchaseId])\n\n  //          \n  useEffect(() => {\n    if (!purchaseId || !allPurchases || !purchase) return;\n    //        (  )\n    if (isEditing) return;\n\n    const memoryPurchase = allPurchases.find(p => p.id === purchaseId);\n    if (memoryPurchase) {\n      //   purchase state  (   )\n      const normalizedItems = normalizeItems((memoryPurchase.items && memoryPurchase.items.length > 0) \n        ? memoryPurchase.items \n        : (memoryPurchase.purchase_request_items || []));\n      \n      const updatedPurchase = {\n        ...purchase,\n        ...memoryPurchase,\n        id: String(memoryPurchase.id),\n        items: normalizedItems,\n        purchase_request_items: normalizedItems\n      } as PurchaseRequestWithDetails;\n\n      setPurchase(updatedPurchase);\n      setEditedPurchase(updatedPurchase);\n      setEditedItems(normalizedItems.length > 0 ? normalizedItems : []);\n    }\n  }, [allPurchases, lastFetch, isEditing]); // isEditing  \n\n  //         \n  useEffect(() => {\n    if (!isOpen || !purchaseId || !allPurchases) return;\n    //        (  )\n    if (isEditing) return;\n\n    const memoryPurchase = allPurchases.find(p => p.id === purchaseId);\n    if (memoryPurchase) {\n      const normalizedItems = normalizeItems((memoryPurchase.items && memoryPurchase.items.length > 0) \n        ? memoryPurchase.items \n        : (memoryPurchase.purchase_request_items || []));\n      \n      const updatedPurchase = {\n        ...memoryPurchase,\n        id: String(memoryPurchase.id),\n        is_po_generated: false,\n        items: normalizedItems,\n        purchase_request_items: normalizedItems,\n        vendor: {\n          id: memoryPurchase.vendor_id,\n          vendor_name: memoryPurchase.vendor_name || '  ',\n          is_active: true,\n          created_at: new Date().toISOString(),\n          updated_at: new Date().toISOString()\n        } as Vendor,\n        vendor_contacts: []\n      } as PurchaseRequestWithDetails;\n\n      setPurchase(updatedPurchase);\n      setEditedPurchase(updatedPurchase);\n      setEditedItems(normalizedItems.length > 0 ? normalizedItems : []);\n    }\n  }, [isOpen, purchaseId, allPurchases, isEditing]); // isEditing  \n  \n  //       \n  const [isInitialLoad, setIsInitialLoad] = useState(true)\n  \n  //   \n  const purchaseIdNumber = purchaseId ? Number(purchaseId) : (purchase ? Number(purchase.id) : NaN)\n\n  const handleActualReceiptOptimisticUpdate = useCallback(({ itemId, selectedDate, action, receivedQuantity }: {\n    itemId: number\n    selectedDate?: Date\n    action: 'confirm' | 'cancel'\n    receivedQuantity?: number\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n      received_quantity?: number\n    }\n  }) => {\n    const itemIdStr = String(itemId)\n    const nowIso = new Date().toISOString()\n    const selectedDateIso = selectedDate ? selectedDate.toISOString() : undefined\n\n    const updateItems = (items?: any[]) => {\n      if (!items) return items\n      return items.map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_received: true,\n            actual_received_date: selectedDateIso,\n            received_at: nowIso,\n            received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.received_quantity\n          }\n        }\n\n        return {\n          ...item,\n          is_received: false,\n          actual_received_date: undefined,\n          received_at: undefined,\n          received_quantity: undefined\n        }\n      })\n    }\n\n    setPurchase(prev => {\n      if (!prev) return prev\n      const updatedItems = updateItems(prev.items) || []\n      const updatedRequestItems = updateItems(prev.purchase_request_items) || []\n      const total = updatedItems.length\n      const completed = updatedItems.filter(item => item.is_received).length\n      const allReceived = total > 0 && completed === total\n\n      return {\n        ...prev,\n        items: updatedItems,\n        purchase_request_items: updatedRequestItems,\n        is_received: allReceived,\n        received_at: allReceived ? (prev.received_at || nowIso) : undefined,\n        updated_at: new Date().toISOString()\n      }\n    })\n\n    setEditedPurchase(prev => {\n      if (!prev) return prev\n      const updatedItems = updateItems(prev.items) || []\n      const updatedRequestItems = updateItems(prev.purchase_request_items) || []\n      return {\n        ...prev,\n        items: updatedItems,\n        purchase_request_items: updatedRequestItems\n      }\n    })\n\n    setEditedItems(prevItems => {\n      if (!prevItems || prevItems.length === 0) return prevItems\n      return prevItems.map(item => {\n        if (!item.id || String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_received: true,\n            actual_received_date: selectedDateIso,\n            received_at: nowIso,\n            received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.received_quantity\n          }\n        }\n\n        return {\n          ...item,\n          is_received: false,\n          actual_received_date: undefined,\n          received_at: undefined,\n          received_quantity: undefined\n        }\n      })\n    })\n\n    if (!Number.isNaN(purchaseIdNumber)) {\n      onOptimisticUpdate?.(purchaseIdNumber, prevPurchase => {\n        const updatedItems = updateItems(prevPurchase.items) || prevPurchase.items || []\n        const updatedRequestItems = updateItems(prevPurchase.purchase_request_items) || prevPurchase.purchase_request_items || []\n        const total = updatedItems.length || prevPurchase.items?.length || 0\n        const completed = updatedItems.filter(item => item.is_received).length\n        const allReceived = total > 0 && completed === total\n\n        return {\n          ...prevPurchase,\n          items: updatedItems,\n          purchase_request_items: updatedRequestItems,\n          is_received: allReceived,\n          received_at: allReceived ? (prevPurchase.received_at || nowIso) : undefined,\n          updated_at: new Date().toISOString()\n        }\n      })\n    }\n  }, [onOptimisticUpdate, purchaseIdNumber])\n\n  const handleStatementReceivedOptimisticUpdate = useCallback(({ itemId, selectedDate, action }: {\n    itemId: number\n    selectedDate?: Date\n    action: 'confirm' | 'cancel'\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n    }\n  }) => {\n    const itemIdStr = String(itemId)\n    const selectedDateIso = selectedDate ? selectedDate.toISOString() : undefined\n\n    let nextAllCompleted = false\n    let nextStatementAt: string | null = null\n\n    setPurchase(prev => {\n      if (!prev) return prev\n\n      const updatedItems = (prev.items || []).map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_statement_received: true,\n            statement_received_date: selectedDateIso,\n            statement_received_by_name: currentUserName\n          }\n        }\n\n        return {\n          ...item,\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      })\n\n      nextAllCompleted = updatedItems.length > 0 && updatedItems.every(item => item.is_statement_received)\n      nextStatementAt = nextAllCompleted\n        ? (selectedDateIso || prev.statement_received_at || new Date().toISOString())\n        : null\n\n      return {\n        ...prev,\n        items: updatedItems,\n        is_statement_received: nextAllCompleted,\n        statement_received_at: nextStatementAt\n      }\n    })\n\n    setEditedPurchase(prev => {\n      if (!prev) return prev\n\n      const updatedItems = (prev.items || []).map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_statement_received: true,\n            statement_received_date: selectedDateIso,\n            statement_received_by_name: currentUserName\n          }\n        }\n\n        return {\n          ...item,\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      })\n\n      return {\n        ...prev,\n        items: updatedItems,\n        is_statement_received: nextAllCompleted,\n        statement_received_at: nextStatementAt\n      }\n    })\n\n    setEditedItems(prevItems => {\n      if (!prevItems) return prevItems\n      return prevItems.map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_statement_received: true,\n            statement_received_date: selectedDateIso,\n            statement_received_by_name: currentUserName\n          }\n        }\n\n        return {\n          ...item,\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        }\n      })\n    })\n\n    if (!Number.isNaN(purchaseIdNumber)) {\n      onOptimisticUpdate?.(purchaseIdNumber, prevPurchase => {\n        const updatedItems = (prevPurchase.items || []).map(item => {\n          if (String(item.id) !== itemIdStr) return item\n\n          if (action === 'confirm') {\n            return {\n              ...item,\n              is_statement_received: true,\n              statement_received_date: selectedDateIso,\n              statement_received_by_name: currentUserName\n            }\n          }\n\n          return {\n            ...item,\n            is_statement_received: false,\n            statement_received_date: null,\n            statement_received_by_name: null\n          }\n        })\n\n        const allCompleted = updatedItems.length > 0 && updatedItems.every(item => item.is_statement_received)\n\n        return {\n          ...prevPurchase,\n          items: updatedItems,\n          is_statement_received: allCompleted\n        }\n      })\n    }\n\n    // purchase_requests   \n    if (purchase && nextAllCompleted !== undefined) {\n      const supabase = createClient()\n      supabase\n        .from('purchase_requests')\n        .update({\n          is_statement_received: nextAllCompleted,\n          statement_received_at: nextStatementAt\n        })\n        .eq('id', purchase.id)\n        .then(({ error }: { error: any }) => {\n          if (error) {\n            logger.error('  purchase_requests  ', error)\n          }\n        })\n    }\n  }, [currentUserName, onOptimisticUpdate, purchaseIdNumber, purchase])\n\n  const statementReceivedAction = useConfirmDateAction({\n    config: {\n      field: 'statement_received',\n      confirmMessage: {\n        confirm: '  ?',\n        cancel: '  ?'\n      },\n      successMessage: {\n        confirm: '  .',\n        cancel: '  .'\n      },\n      completedText: ' ',\n      waitingText: ''\n    },\n    currentUserName,\n    canPerformAction: canReceiptCheck,\n    purchaseId: purchase?.id,\n    onUpdate: refreshModalData,\n    onOptimisticUpdate: handleStatementReceivedOptimisticUpdate\n  })\n\n  const actualReceivedAction = useConfirmDateAction({\n    config: {\n      field: 'actual_received',\n      confirmMessage: {\n        confirm: '   ?',\n        cancel: '   ?'\n      },\n      successMessage: {\n        confirm: '   .',\n        cancel: '   .'\n      },\n      completedText: '',\n      waitingText: ''\n    },\n    currentUserName,\n    canPerformAction: canProcessReceipt,\n    purchaseId: purchase?.id,\n    onUpdate: refreshModalData,\n    onOptimisticUpdate: handleActualReceiptOptimisticUpdate\n  })\n  \n  //   \n  \n  \n  //   \n const canApproveMiddle = effectiveRoles.includes('middle_manager') || \n                          effectiveRoles.includes('app_admin') || \n                          effectiveRoles.includes('ceo')\n \n const canApproveFinal = effectiveRoles.includes('final_approver') || \n                         effectiveRoles.includes('app_admin') || \n                         effectiveRoles.includes('ceo')\n \n const approvalPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2 py-0.5 badge-text leading-tight'\n const approvalButtonClass = 'inline-flex items-center gap-1 business-radius-badge !h-auto !min-h-0 !px-2.5 !py-0.5 badge-text leading-tight'\n const approvalWaitingPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2.5 py-0.5 badge-text leading-tight'\n \n \n  useEffect(() => {\n    if (purchaseId && isOpen) {\n      //       \n      const memoryPurchase = findPurchaseInMemory(purchaseId)\n      if (memoryPurchase) {\n        //     (loading  )\n        const purchaseData = {\n          ...memoryPurchase,\n          id: String(memoryPurchase.id), // PurchaseRequest id string\n          is_po_generated: false, // Purchase   PurchaseRequest \n          vendor: (memoryPurchase as any).vendor || (memoryPurchase.vendor_id ? {\n            id: memoryPurchase.vendor_id,\n            vendor_name: memoryPurchase.vendor_name || '  ',\n            is_active: true,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString()\n          } as Vendor : null),\n          vendor_contacts: (memoryPurchase as any).vendor_contacts || []\n        } as PurchaseRequestWithDetails\n        \n        setPurchase(purchaseData)\n        setEditedPurchase(purchaseData)\n        setEditedItems(memoryPurchase.items || [])\n      } else {\n        //     \n        loadPurchaseDetail(purchaseId.toString())\n      }\n      setIsEditing(false) //      \n      \n      //   \n      loadLinkedStatements(purchaseId)\n    }\n  }, [purchaseId, isOpen])\n\n  //   \n  const loadLinkedStatements = async (purchaseId: number) => {\n    try {\n      const result = await transactionStatementService.getStatementsByPurchaseId(purchaseId)\n      if (result.success && result.data) {\n        setLinkedStatements(result.data)\n      }\n    } catch (e) {\n      //    (   )\n      setLinkedStatements([])\n    }\n  }\n\n  //   \n  const handleViewStatementImage = (imageUrl: string) => {\n    setSelectedStatementImage(imageUrl)\n    setIsStatementViewerOpen(true)\n  }\n\n  //    (  )\n  const calculateOptimalColumnWidths = useCallback(() => {\n    // items purchase_request_items   \n    const items = (purchase?.items && purchase.items.length > 0) \n      ? purchase.items \n      : (purchase?.purchase_request_items && purchase.purchase_request_items.length > 0)\n      ? purchase.purchase_request_items\n      : []\n    \n    if (items.length === 0) return []\n\n    const columnConfigs = [\n      { key: 'line_number', minWidth: 32, maxWidth: 32, baseWidth: 32, isFixed: true }, //  \n      { key: 'item_name', minWidth: 80, maxWidth: 500, baseWidth: 80 },\n      { key: 'specification', minWidth: 80, maxWidth: 200, baseWidth: 150, isFixed: false }, //   (80px~200px)\n      { key: 'quantity', minWidth: 70, maxWidth: 120, baseWidth: 70 }, // 100/0   maxWidth \n      { key: 'unit_price', minWidth: 90, maxWidth: 150, baseWidth: 90 },\n      { key: 'total_price', minWidth: 100, maxWidth: 180, baseWidth: 100 },\n    ]\n    \n    //     \n    if (purchase?.payment_category === '') {\n      columnConfigs.push({ key: 'tax_amount', minWidth: 80, maxWidth: 150, baseWidth: 80 })\n    }\n    \n    //    ( ,  )\n    columnConfigs.push({ key: 'link', minWidth: 60, maxWidth: 80, baseWidth: 60, isFixed: true })\n    \n    columnConfigs.push(\n      { key: 'remarks', minWidth: 150, maxWidth: 150, baseWidth: 150, isFixed: true } //   150px\n    )\n    \n    // pending      \n    if (activeTab !== 'pending') {\n      columnConfigs.push(\n        { key: 'status', minWidth: 70, maxWidth: 100, baseWidth: 70 } //    \n      )\n    }\n\n      //   ()\n      if (activeTab === 'receipt') {\n        columnConfigs.push(\n          { key: 'actual_receipt_date', minWidth: 100, maxWidth: 160, baseWidth: 100, isFixed: false }\n        )\n        if (showStatementColumns) {\n          columnConfigs.push(\n            { key: 'transaction_confirm', minWidth: 85, maxWidth: 120, baseWidth: 85, isFixed: false },\n            { key: 'accounting_date', minWidth: 70, maxWidth: 70, baseWidth: 70, isFixed: true }\n          )\n        }\n      }\n      if (activeTab === 'done' && purchase?.payment_category === '') {\n        columnConfigs.push(\n          { key: 'transaction_confirm', minWidth: 85, maxWidth: 120, baseWidth: 85, isFixed: false }, //     \n          { key: 'accounting_date', minWidth: 70, maxWidth: 70, baseWidth: 70, isFixed: true }, //     \n          { key: 'expenditure_info', minWidth: 90, maxWidth: 150, baseWidth: 90, isFixed: false } //    \n        )\n      }\n\n    const calculatedWidths = columnConfigs.map((config, index) => {\n      let maxLength = 4 //  4\n\n      //     ()\n      const getHeaders = () => {\n        const statusHeader = activeTab === 'purchase'\n          ? ''\n          : (activeTab === 'receipt' || activeTab === 'done')\n          ? ''\n          : ''\n\n        //    \n        // receipt, done  '/ '    \n        const quantityHeader = (activeTab === 'receipt' || activeTab === 'done') \n          ? '/ ' \n          : ''\n        const baseHeaders = activeTab === 'pending' \n          ? ['#', '', '', quantityHeader, '', '', purchase?.payment_category === '' ? '' : null, ''].filter(h => h !== null)\n          : ['#', '', '', quantityHeader, '', '', purchase?.payment_category === '' ? '' : null, '', statusHeader].filter(h => h !== null)\n        if (activeTab === 'receipt') {\n          const receiptHeaders = [...baseHeaders, '']\n          if (showStatementColumns) {\n            receiptHeaders.push(' ', ' ')\n          }\n          return receiptHeaders\n        } else if (activeTab === 'done') {\n          const doneHeaders = [...baseHeaders]\n          if (showStatementColumns) {\n            doneHeaders.push(' ', ' ')\n            if (showExpenditureColumn) {\n              doneHeaders.push('')\n            }\n          }\n          return doneHeaders\n        }\n        return baseHeaders\n      }\n      \n      const headers = getHeaders()\n      if (headers[index]) {\n        maxLength = Math.max(maxLength, headers[index].length)\n      }\n\n      //     \n      items.forEach(item => {\n        let cellValue = ''\n        switch (config.key) {\n          case 'line_number':\n            cellValue = item.line_number?.toString() || ''\n            break\n          case 'item_name':\n            cellValue = item.item_name || ''\n            break\n          case 'specification':\n            cellValue = item.specification || ''\n            break\n          case 'quantity':\n            // receipt, done  /  \n            if (activeTab === 'receipt' || activeTab === 'done') {\n              const quantity = item.quantity || 0\n              const receivedQuantity = item.received_quantity ?? 0\n              // 100  2      \n              //       (   /  )\n              cellValue = quantity >= 100 || receivedQuantity >= 100 \n                ? `${quantity}` // 2     \n                : `${quantity}/${receivedQuantity}` // 1   \n            } else {\n              cellValue = item.quantity?.toString() || ''\n            }\n            break\n          case 'unit_price':\n            cellValue = item.unit_price_value != null ? item.unit_price_value.toLocaleString() : ''\n            break\n          case 'total_price':\n            if (item.amount_value != null) {\n              cellValue = item.amount_value.toLocaleString()\n            } else if (item.quantity != null && item.unit_price_value != null) {\n              cellValue = (Number(item.quantity) * Number(item.unit_price_value)).toLocaleString()\n            } else {\n              cellValue = ''\n            }\n            break\n          case 'tax_amount':\n            cellValue = item.tax_amount_value != null ? item.tax_amount_value.toLocaleString() : ''\n            break\n          case 'remarks':\n            cellValue = item.remark || ''\n            break\n          case 'status':\n            cellValue = getStatusDisplay(item) || ''\n            break\n          case 'actual_receipt_date':\n            cellValue = item.actual_received_date ? formatDate(item.actual_received_date) : ''\n            break\n          case 'transaction_confirm':\n            cellValue = item.is_statement_received ? '' : ''\n            break\n          case 'accounting_date':\n            cellValue = item.statement_received_date ? formatDate(item.statement_received_date) : ''\n            break\n          case 'expenditure_info':\n            //    2   \n            if (item.expenditure_date && item.expenditure_amount !== null && item.expenditure_amount !== undefined) {\n              //   : \"2025. 11. 25.\" ( 14)\n              cellValue = '2025. 11. 25.' //    \n            } else {\n              cellValue = '' //  \n            }\n            break\n        }\n        \n        // /     ( 1.5 )\n        const adjustedLength = cellValue.split('').reduce((acc, char) => {\n          return acc + (/[-]/.test(char) ? 1.5 : 1)\n        }, 0)\n        \n        maxLength = Math.max(maxLength, Math.ceil(adjustedLength))\n      })\n\n      //     \n      if (config.isFixed) {\n        return config.baseWidth\n      }\n      \n      //    (  7px +  20px)\n      let calculatedWidth = Math.max(\n        config.minWidth,\n        Math.min(config.maxWidth, maxLength * 7 + 20)\n      )\n      \n      //      2   \n      if (config.key === 'expenditure_info') {\n        //   \"2025. 11. 25.\"  \n        // 2     \n        calculatedWidth = 110 //   \n      }\n\n      return calculatedWidth\n    })\n\n    setColumnWidths(calculatedWidths)\n    return calculatedWidths\n  }, [purchase, activeTab, showStatementColumns, showExpenditureColumn])\n\n  //     \n  const getStatusDisplay = (item: any) => {\n    if (activeTab === 'purchase') {\n      return item.is_payment_completed ? '' : ''\n    } else if (activeTab === 'receipt') {\n      return item.is_received ? '' : ''\n    }\n    return item.is_payment_completed ? '' : ''\n  }\n\n  //  gridTemplateColumns \n  const getGridTemplateColumns = () => {\n    //      (,    )\n    if (columnWidths.length > 0) {\n      const widths = columnWidths.map(width => `${width}px`)\n      \n      //      ( )\n      //      \n      \n      return widths.join(' ')\n    }\n    \n    //  (  )\n    // [, , , , , ]\n    let baseColumns = ['32px', 'minmax(80px, 1fr)', '200px', '70px', '90px', '100px']\n    \n    //     \n    if (purchase?.payment_category === '') {\n      baseColumns.push('100px') // \n    }\n    \n    //   \n    baseColumns.push('60px')\n    \n    //   \n    baseColumns.push('150px')\n    \n    // pending    /  \n    if (activeTab !== 'pending') {\n      if (isEditing) {\n        baseColumns.push('80px') // \n      } else {\n        baseColumns.push('80px') // \n      }\n    }\n    \n    //   \n    if (activeTab === 'receipt') {\n      const receiptColumns = [...baseColumns, '100px'] // \n      if (showStatementColumns) {\n        receiptColumns.push('100px', '80px') //  ,  \n      }\n      return receiptColumns.join(' ')\n    } else if (activeTab === 'done') {\n      const doneColumns = [...baseColumns]\n      if (showStatementColumns) {\n        doneColumns.push('100px', '80px') //  ,  \n        if (showExpenditureColumn) {\n          doneColumns.push('110px') // \n        }\n      }\n      return doneColumns.join(' ')\n    }\n    \n    return baseColumns.join(' ')\n  }\n\n  //  measureColumnWidths  ( )\n  const measureColumnWidths = () => {\n    calculateOptimalColumnWidths()\n  }\n\n  // View     (  )\n  //      \n  useEffect(() => {\n    // items purchase_request_items   \n    const hasItems = (purchase?.items && purchase.items.length > 0) || \n                     (purchase?.purchase_request_items && purchase.purchase_request_items.length > 0)\n    \n    if (purchase && hasItems && !isEditing) {\n      // requestAnimationFrame       \n      requestAnimationFrame(() => {\n        calculateOptimalColumnWidths()\n      })\n    }\n  }, [purchase, isEditing, activeTab, calculateOptimalColumnWidths])\n\n  // Edit     \n  const handleEditToggle = (editing: boolean) => {\n    if (editing && !isEditing) {\n      // Edit       (line_number  )\n      setEditedPurchase(purchase)\n      const sortedItems = [...(currentItems || [])].sort((a, b) => {\n        const la = a?.line_number ?? 999999\n        const lb = b?.line_number ?? 999999\n        return la - lb\n      })\n      setEditedItems(sortedItems)\n      setDeletedItemIds([])\n      // Edit      \n      calculateOptimalColumnWidths()\n    }\n    setIsEditing(editing)\n  }\n\n  const loadPurchaseDetail = async (id: string) => {\n    try {\n      //     (    )\n      const memoryPurchase = findPurchaseInMemory(id)\n      if (memoryPurchase) {\n        //   PurchaseRequestWithDetails  \n        const purchaseData = {\n          ...memoryPurchase,\n          id: String(memoryPurchase.id), // PurchaseRequest id string\n          is_po_generated: false, // Purchase   PurchaseRequest \n          vendor: (memoryPurchase as any).vendor || (memoryPurchase.vendor_id ? {\n            id: memoryPurchase.vendor_id,\n            vendor_name: memoryPurchase.vendor_name || '  ',\n            is_active: true,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString()\n          } as Vendor : null),\n          vendor_contacts: (memoryPurchase as any).vendor_contacts || []\n        } as PurchaseRequestWithDetails\n        \n        setPurchase({\n          ...purchaseData,\n          items: normalizeItems(memoryPurchase.items || purchaseData.items || [])\n        })\n        setEditedPurchase(purchaseData)\n        setEditedItems(normalizeItems(memoryPurchase.items || []))\n        return\n      }\n      \n      //        DB  (fallback)\n      setLoading(true)\n      const supabase = createClient()\n      \n      //  purchase_requests  \n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          vendors:vendor_id(id, vendor_name, is_active),\n          purchase_request_items(*),\n          contact:contact_id(id, contact_name, contact_email, contact_phone, position)\n        `)\n        .eq('id', id)\n        .single()\n\n      if (error) throw error\n      \n      // vendor_id      ,      \n      let vendorContacts = []\n      if (data && data.vendor_id) {\n        const { data: allContacts } = await supabase\n          .from('vendor_contacts')\n          .select('id, contact_name, contact_email, contact_phone, position')\n          .eq('vendor_id', data.vendor_id)\n          .order('contact_name')\n        \n        if (allContacts && allContacts.length > 0) {\n          // contact_id     \n          if (data.contact_id) {\n            const currentContact = allContacts.find((c: any) => c.id === data.contact_id)\n            const otherContacts = allContacts.filter((c: any) => c.id !== data.contact_id)\n            vendorContacts = currentContact ? [currentContact, ...otherContacts] : allContacts\n          } else {\n            vendorContacts = allContacts\n          }\n          logger.info(' loadPurchaseDetail -    :', {\n            vendor_id: data.vendor_id,\n            contact_id: data.contact_id,\n            allContacts_count: allContacts.length,\n            vendorContacts\n          })\n        }\n      } else if (data && data.contact) {\n        // vendor_id   contact  \n        vendorContacts = [data.contact]\n      }\n\n      if (data) {\n        //   \n        const sortedItems = normalizeItems((data.purchase_request_items || []).sort((a: any, b: any) => {\n          const lineA = a.line_number || 999999;\n          const lineB = b.line_number || 999999;\n          return lineA - lineB;\n        }));\n\n        const purchaseData = {\n          ...data,\n          items: sortedItems,\n          vendor: data.vendors || null,\n          vendor_contacts: vendorContacts,\n          contact_id: data.contact_id,  // contact_id \n          contact_name: vendorContacts[0]?.contact_name || data.contact?.contact_name || null  // contact_name \n        } as PurchaseRequestWithDetails\n        setPurchase({\n          ...purchaseData,\n          items: sortedItems\n        })\n        setEditedPurchase(purchaseData)\n        setEditedItems(sortedItems)\n      }\n    } catch (error) {\n      logger.error('[PurchaseDetailModal]    :', error)\n      toast.error('    .')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getStatusBadge = () => {\n    if (!purchase) return null\n    \n    // payment_category  \n    if (purchase.payment_category) {\n      const category = purchase.payment_category.trim()\n      \n      if (category === '') {\n        return <span className=\"badge-stats bg-green-500 text-white\"></span>\n      } else if (category === '') {\n        return <span className=\"badge-stats bg-blue-500 text-white\"></span>\n      } else if (category === '') {\n        return <span className=\"badge-stats bg-gray-500 text-white\"></span>\n      } else {\n        // payment_category      \n        return <span className=\"badge-stats bg-blue-500 text-white\">{category}</span>\n      }\n    }\n    \n    // payment_category  \n    return <span className=\"badge-stats bg-blue-500 text-white\"></span>\n  }\n\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('ko-KR').format(amount)\n  }\n\n  const handleSave = async () => {\n    if (!purchase || !editedPurchase) {\n      toast.error('  .')\n      return\n    }\n    \n    //     \n    setIsSaving(true)\n    \n    logger.info('handleSave :', { \n      purchaseId: purchase.id,\n      vendor_id: editedPurchase.vendor_id,\n      vendor_name: editedPurchase.vendor_name,\n      vendor: editedPurchase.vendor,\n      editedPurchase: editedPurchase\n    })\n    \n    try {\n      const supabase = createClient()\n      \n      //    \n      const totalAmount = editedItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n      \n      logger.info('Update payload:', {\n        purchase_order_number: editedPurchase.purchase_order_number || null,\n        requester_name: editedPurchase.requester_name || null,\n        vendor_id: editedPurchase.vendor_id || null,\n        vendor_name: editedPurchase.vendor_name || null,\n        delivery_request_date: editedPurchase.delivery_request_date || null,\n        revised_delivery_request_date: editedPurchase.revised_delivery_request_date || null,\n        payment_category: editedPurchase.payment_category || null,\n        project_vendor: editedPurchase.project_vendor || null,\n        project_item: editedPurchase.project_item || null,\n        sales_order_number: editedPurchase.sales_order_number || null,\n        total_amount: Number(totalAmount),\n        updated_at: new Date().toISOString()\n      })\n      \n      // contact_id :  1. editedPurchase.contact_id 2. vendor_contacts[0].id 3. null\n      let contactId = null\n      if ((editedPurchase as any).contact_id) {\n        contactId = (editedPurchase as any).contact_id\n      } else if (Array.isArray(editedPurchase.vendor_contacts) && editedPurchase.vendor_contacts.length > 0) {\n        contactId = editedPurchase.vendor_contacts[0].id || null\n      }\n      \n      const { error: updateError } = await supabase\n        .from('purchase_requests')\n        .update({\n          purchase_order_number: editedPurchase.purchase_order_number || null,\n          requester_name: editedPurchase.requester_name || null,\n          vendor_id: editedPurchase.vendor_id || null,\n          vendor_name: editedPurchase.vendor_name || null,\n          contact_id: contactId, // contact_id \n          delivery_request_date: editedPurchase.delivery_request_date || null,\n          revised_delivery_request_date: editedPurchase.revised_delivery_request_date || null,\n          payment_category: editedPurchase.payment_category || null,\n          project_vendor: editedPurchase.project_vendor || null,\n          project_item: editedPurchase.project_item || null,\n          sales_order_number: editedPurchase.sales_order_number || null,\n          total_amount: Number(totalAmount),\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', purchase.id)\n\n      if (updateError) {\n        logger.error('Purchase update error:', updateError)\n        throw updateError\n      }\n\n      //      contact_id \n      let finalContactId = null\n      logger.info('  :', { \n        vendor_id: editedPurchase.vendor_id,\n        vendor_contacts: editedPurchase.vendor_contacts,\n        isArray: Array.isArray(editedPurchase.vendor_contacts)\n      })\n      \n      if (editedPurchase.vendor_id && Array.isArray(editedPurchase.vendor_contacts) && editedPurchase.vendor_contacts.length > 0) {\n        const contact = editedPurchase.vendor_contacts[0]\n        logger.info(' :', { contact })\n        \n        //    ,  \n        if (contact.id) {\n          finalContactId = contact.id\n          const { error: contactUpdateError } = await supabase\n            .from('vendor_contacts')\n            .update({\n              contact_name: contact.contact_name || '',\n              contact_email: contact.contact_email || '',\n              contact_phone: contact.contact_phone || '',\n              position: contact.position || ''\n            })\n            .eq('id', contact.id)\n          \n          if (contactUpdateError) {\n            logger.error('  :', contactUpdateError)\n          } else {\n            //  UI  \n            setPurchase(prev => {\n              const updated = prev ? {\n                ...prev,\n                vendor_contacts: [contact],\n                contact_id: contact.id,\n                contact_name: contact.contact_name  // contact_name \n              } : null\n              logger.info('    setPurchase:', { \n                prev_vendor_contacts: prev?.vendor_contacts,\n                new_vendor_contacts: [contact],\n                updated_purchase: updated\n              })\n              console.log('    setPurchase ')\n              return updated\n            })\n          }\n        } else if (contact.contact_name) {\n          //   \n          const { data: newContact, error: contactInsertError } = await supabase\n            .from('vendor_contacts')\n            .insert({\n              vendor_id: editedPurchase.vendor_id,\n              contact_name: contact.contact_name,\n              contact_email: contact.contact_email || '',\n              contact_phone: contact.contact_phone || '',\n              position: contact.position || ''\n            })\n            .select()\n            .single()\n          \n          if (contactInsertError) {\n            logger.error('  :', contactInsertError)\n          } else if (newContact) {\n            finalContactId = newContact.id\n            //    editedPurchase \n            editedPurchase.vendor_contacts = [newContact]\n            logger.info('  :', newContact)\n            \n            //  UI  \n            setPurchase(prev => {\n              const updated = prev ? {\n                ...prev,\n                vendor_contacts: [newContact],\n                contact_id: newContact.id,\n                contact_name: newContact.contact_name  // contact_name \n              } : null\n              logger.info('     setPurchase:', { \n                prev_vendor_contacts: prev?.vendor_contacts,\n                new_vendor_contacts: [newContact],\n                newContact_full: newContact,\n                updated_purchase: updated\n              })\n              console.log('     setPurchase :', newContact)\n              return updated\n            })\n            \n            // purchase_requests  contact_id \n            const { error: purchaseUpdateError } = await supabase\n              .from('purchase_requests')\n              .update({\n                contact_id: newContact.id\n              })\n              .eq('id', purchase.id)\n            \n            if (purchaseUpdateError) {\n              logger.error('purchase_requests contact_id  :', purchaseUpdateError)\n            }\n          }\n        }\n      }\n\n      //   \n      if (deletedItemIds.length > 0) {\n        const { error: deleteError } = await supabase\n          .from('purchase_request_items')\n          .delete()\n          .in('id', deletedItemIds)\n\n        if (deleteError) throw deleteError\n      }\n\n      //      \n      if (editedItems.length === 0) {\n        logger.info('     ', {\n          purchaseId: purchase.id,\n          deletedItemIds: deletedItemIds\n        })\n\n        //  \n        const { error: requestDeleteError } = await supabase\n          .from('purchase_requests')\n          .delete()\n          .eq('id', purchase.id)\n\n        if (requestDeleteError) {\n          logger.error('  ', requestDeleteError)\n          throw requestDeleteError\n        }\n\n        //   \n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          const memoryUpdated = removePurchaseFromMemory(purchaseIdNumber)\n          if (!memoryUpdated) {\n            logger.warn('[handleSave]      ', { \n              purchaseId: purchaseIdNumber\n            })\n          } else {\n            logger.info(' [handleSave]      ', { \n              purchaseId: purchaseIdNumber\n            })\n          }\n        }\n\n        toast.success('    .')\n        handleEditToggle(false)\n        setDeletedItemIds([])\n        onClose() //  \n        \n        //  \n        const refreshResult = onRefresh?.(true, { silent: false })\n        if (refreshResult instanceof Promise) {\n          await refreshResult\n        }\n        \n        return //   \n      }\n\n      //     \n      \n      for (const item of editedItems) {\n        \n        //   \n        if (!item.item_name || !item.item_name.trim()) {\n          throw new Error(' .');\n        }\n        if (!item.quantity || item.quantity <= 0) {\n          throw new Error(' 0  .');\n        }\n        if (item.unit_price_value !== null && item.unit_price_value !== undefined && item.unit_price_value < 0) {\n          throw new Error(' 0  .');\n        }\n        if (item.amount_value !== null && item.amount_value !== undefined && item.amount_value < 0) {\n          throw new Error(' 0  .');\n        }\n        \n        if (item.id) {\n          //   \n          const { error } = await supabase\n            .from('purchase_request_items')\n            .update({\n              item_name: item.item_name.trim(),\n              specification: item.specification || null,\n              quantity: Number(item.quantity),\n              received_quantity: item.received_quantity !== null && item.received_quantity !== undefined ? Number(item.received_quantity) : null,\n              unit_price_value: Number(item.unit_price_value),\n              unit_price_currency: purchase.currency || 'KRW',\n              amount_value: Number(item.amount_value),\n              amount_currency: purchase.currency || 'KRW',\n              remark: item.remark || null,\n              updated_at: new Date().toISOString()\n            })\n            .eq('id', item.id)\n\n          if (error) {\n            logger.error('   ', error);\n            throw error;\n          }\n        } else {\n          //   \n          const insertData = {\n            purchase_request_id: purchase.id,\n            item_name: item.item_name.trim(),\n            specification: item.specification || null,\n            quantity: Number(item.quantity),\n            received_quantity: item.received_quantity !== null && item.received_quantity !== undefined ? Number(item.received_quantity) : null,\n            unit_price_value: Number(item.unit_price_value),\n            unit_price_currency: purchase.currency || 'KRW',\n            amount_value: Number(item.amount_value),\n            amount_currency: purchase.currency || 'KRW',\n            remark: item.remark || null,\n            line_number: item.line_number || editedItems.indexOf(item) + 1,\n            created_at: new Date().toISOString()\n          };\n          \n          //  INSERT   ID  (.select() )\n          const { data: insertedItem, error } = await supabase\n            .from('purchase_request_items')\n            .insert(insertData)\n            .select()\n            .single()\n\n          if (error) {\n            logger.error('   ', error);\n            throw error;\n          }\n          \n          //    ID editedItems \n          if (insertedItem) {\n            const itemIndex = editedItems.indexOf(item)\n            if (itemIndex !== -1) {\n              editedItems[itemIndex] = { ...editedItems[itemIndex], ...insertedItem }\n              logger.info('   ID :', { id: insertedItem.id, itemIndex })\n            }\n          }\n        }\n      }\n\n      //        (  )\n      const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n      const sourceData = editedPurchase || purchase\n      \n      // 1.         (  )\n      if (!Number.isNaN(purchaseIdNumber) && deletedItemIds.length > 0) {\n        logger.info(' [ ]     ', {\n          purchaseId: purchaseIdNumber,\n          deletedItemIds: deletedItemIds,\n          deletedCount: deletedItemIds.length\n        })\n        \n        //         (   )\n        deletedItemIds.forEach(itemId => {\n          const memoryUpdated = removeItemFromMemory(purchaseIdNumber, itemId)\n          if (!memoryUpdated) {\n            logger.warn('[handleSave]       ', { \n              purchaseId: purchaseIdNumber, \n              itemId: itemId \n            })\n          } else {\n            logger.info(' [handleSave]       ', { \n              purchaseId: purchaseIdNumber, \n              itemId: itemId \n            })\n          }\n        })\n      }\n      \n      // 2.       ( )\n      if (!Number.isNaN(purchaseIdNumber)) {\n        const memoryUpdated = updatePurchaseInMemory(purchaseIdNumber, (prev) => {\n          const totalAmount = editedItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n          \n          logger.info(' [ ]    ', {\n            purchaseId: purchaseIdNumber,\n            newTotalAmount: totalAmount,\n            itemsCount: editedItems.length\n          })\n          \n          return {\n            ...prev,\n            //    \n            purchase_order_number: sourceData?.purchase_order_number || prev.purchase_order_number,\n            requester_name: sourceData?.requester_name || prev.requester_name,\n            vendor_id: sourceData?.vendor_id || prev.vendor_id,\n            vendor_name: sourceData?.vendor_name || prev.vendor_name,\n            vendor: sourceData?.vendor || (prev as any).vendor,\n            vendor_contacts: sourceData?.vendor_contacts || (prev as any).vendor_contacts,\n            delivery_request_date: sourceData?.delivery_request_date || prev.delivery_request_date,\n            revised_delivery_request_date: sourceData?.revised_delivery_request_date || prev.revised_delivery_request_date,\n            payment_category: sourceData?.payment_category || prev.payment_category,\n            project_vendor: sourceData?.project_vendor || prev.project_vendor,\n            project_item: sourceData?.project_item || prev.project_item,\n            total_amount: totalAmount,\n            //       (   )\n            items: editedItems,\n            purchase_request_items: editedItems,\n            updated_at: new Date().toISOString()\n          } as Purchase\n        })\n        \n        logger.info(' [ ]    :', { memoryUpdated })\n      }\n      \n      // 3. applyOptimisticUpdate   (  )\n      const applyOptimisticUpdate = () => {\n        if (!Number.isNaN(purchaseIdNumber) && onOptimisticUpdate) {\n          onOptimisticUpdate(purchaseIdNumber, prev => {\n            const finalItems = editedItems //    \n            const totalAmount = finalItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n            \n            logger.info(' [onOptimisticUpdate]  UI ', {\n              originalItemsCount: prev.items?.length || prev.purchase_request_items?.length || 0,\n              finalItemsCount: finalItems.length,\n              deletedItemsCount: deletedItemIds.length\n            })\n            \n            return {\n              ...prev,\n              //    \n              purchase_order_number: sourceData?.purchase_order_number || prev.purchase_order_number,\n              requester_name: sourceData?.requester_name || prev.requester_name,\n              vendor_id: sourceData?.vendor_id || prev.vendor_id,\n              vendor_name: sourceData?.vendor_name || prev.vendor_name,\n              vendor: sourceData?.vendor || (prev as any).vendor,\n              vendor_contacts: sourceData?.vendor_contacts || (prev as any).vendor_contacts,\n              delivery_request_date: sourceData?.delivery_request_date || prev.delivery_request_date,\n              revised_delivery_request_date: sourceData?.revised_delivery_request_date || prev.revised_delivery_request_date,\n              payment_category: sourceData?.payment_category || prev.payment_category,\n              project_vendor: sourceData?.project_vendor || prev.project_vendor,\n              project_item: sourceData?.project_item || prev.project_item,\n              total_amount: totalAmount,\n              //    -   \n              items: finalItems,\n              purchase_request_items: finalItems,\n              updated_at: new Date().toISOString()\n            } as Purchase\n          })\n        }\n      }\n      \n      // 4.  UI   (  )\n      applyOptimisticUpdate()\n\n      toast.success('   .')\n      handleEditToggle(false)\n      setDeletedItemIds([])\n      \n      // 5.   : refreshModalData ,   onRefresh\n      await refreshModalData()\n      logger.info(' refreshModalData   purchase:', { purchaseId: purchase?.id })\n      console.log(' refreshModalData   -  purchase :', purchase)\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      logger.error('   ', error);\n      const errorMessage = error instanceof Error ? error.message : '    '\n      toast.error(` : ${errorMessage}`)\n    } finally {\n      //     \n      setIsSaving(false)\n    }\n  }\n\n  const handleItemChange = (index: number, field: string, value: any) => {\n    const newItems = [...editedItems]\n    \n    if (field === 'quantity' || field === 'unit_price_value') {\n      //         \n      const quantity = field === 'quantity' ? value : newItems[index].quantity\n      const unitPrice = field === 'unit_price_value' ? value : newItems[index].unit_price_value\n      const amount = (quantity || 0) * (unitPrice || 0)\n      \n      //    (10%)  \n      const taxAmount = purchase?.payment_category === '' ? Math.round(amount * 0.1) : 0\n      \n      newItems[index] = {\n        ...newItems[index],\n        [field]: value,\n        amount_value: amount,\n        tax_amount_value: taxAmount\n      }\n    } else if (field === 'amount_value') {\n      //    \n      const amount = Number(value) || 0\n      \n      //    (10%)  \n      const taxAmount = purchase?.payment_category === '' ? Math.round(amount * 0.1) : 0\n      \n      newItems[index] = {\n        ...newItems[index],\n        amount_value: amount,\n        tax_amount_value: taxAmount\n      }\n    } else {\n      //   \n      newItems[index] = {\n        ...newItems[index],\n        [field]: value\n      }\n    }\n    \n    setEditedItems(newItems)\n  }\n\n  const handleAddItem = () => {\n    //    \n    const maxLineNumber = editedItems.reduce((max, item) => {\n      const lineNum = item.line_number || 0;\n      return lineNum > max ? lineNum : max;\n    }, 0);\n\n    const newItem = {\n      item_name: '',\n      specification: '',\n      quantity: 1,\n      unit_price_value: 0,\n      amount_value: 0,\n      remark: '',\n      line_number: maxLineNumber + 1,\n      tempId: `tmp-new-${Date.now()}-${Math.random()}`\n    }\n    \n    //       \n    const newItems = [...editedItems, newItem].sort((a, b) => {\n      const lineA = a.line_number || 999999;\n      const lineB = b.line_number || 999999;\n      return lineA - lineB;\n    }).map((item, idx) => ({\n      ...item,\n      line_number: idx + 1,\n      stableKey: item.stableKey ?? makeStableKey(item, idx)\n    }));\n    \n    setEditedItems(newItems)\n  }\n\n  const handleRemoveItem = (index: number) => {\n    const item = editedItems[index]\n    if (item.id) {\n      setDeletedItemIds([...deletedItemIds, item.id])\n    }\n    const newItems = editedItems\n      .filter((_, i) => i !== index)\n      .sort((a, b) => {\n        const lineA = a.line_number || 999999;\n        const lineB = b.line_number || 999999;\n        return lineA - lineB;\n      })\n      .map((it, idx) => ({\n        ...it,\n        line_number: idx + 1,\n        stableKey: it.stableKey ?? makeStableKey(it, idx)\n      }))\n    setEditedItems(newItems)\n  }\n\n  //   \n  const handlePaymentToggle = async (itemId: number | string, isCompleted: boolean) => {\n    \n    if (!canPurchase) {\n      logger.warn('[handlePaymentToggle]  ', { canPurchase, currentUserRoles })\n      toast.error('   .')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n\n    if (Number.isNaN(numericId)) {\n      logger.error('[handlePaymentToggle]  ID', { itemId, numericId })\n      toast.error('   ID .')\n      return\n    }\n\n    //     -   \n    \n    // items purchase_request_items    - length    \n    if (!purchase) return\n    \n    const purchaseItems = (purchase.items && purchase.items.length > 0) ? purchase.items : []\n    const requestItems = (purchase.purchase_request_items && purchase.purchase_request_items.length > 0) ? purchase.purchase_request_items : []\n    const items = purchaseItems.length > 0 ? purchaseItems : requestItems\n    \n    \n    const targetItem = items.find(item => String(item.id) === itemIdStr)\n    \n    \n    if (!targetItem) {\n      return\n    }\n\n    const itemInfo = `: ${targetItem.item_name}\n: ${targetItem.specification || ''}\n: ${targetItem.quantity?.toLocaleString() || 0}${targetItem.unit || ''}\n: ${targetItem.unit_price_value?.toLocaleString() || 0}\n: ${targetItem.amount_value?.toLocaleString() || 0}`\n\n    const confirmMessage = isCompleted \n      ? `   ?\\n\\n${itemInfo}` \n      : `   ?\\n\\n${itemInfo}`\n    \n    const confirm = window.confirm(confirmMessage)\n    \n    if (!confirm) {\n      return\n    }\n\n    try {\n      \n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_payment_completed: isCompleted,\n          payment_completed_at: isCompleted ? new Date().toISOString() : null\n        })\n        .eq('id', numericId)\n\n      if (error) {\n        throw error\n      }\n      \n\n      //      (/  )\n      if (purchase) {\n        \n        const memoryUpdated = isCompleted \n          ? markItemAsPaymentCompleted(purchase.id, numericId)\n          : markItemAsPaymentCanceled(purchase.id, numericId);\n          \n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]     ', { \n            purchaseId: purchase.id, \n            itemId: numericId,\n            isCompleted\n          });\n        }\n      }\n\n      //     (UI  )\n      setPurchase(prev => {\n        if (!prev) {\n          return null\n        }\n        \n        // items purchase_request_items     - length    \n        const prevItems = (prev.items && prev.items.length > 0) ? prev.items : []\n        const prevRequestItems = (prev.purchase_request_items && prev.purchase_request_items.length > 0) ? prev.purchase_request_items : []\n        const currentItems = prevItems.length > 0 ? prevItems : prevRequestItems\n        const updatedItems = currentItems.map(item => \n          String(item.id) === itemIdStr \n            ? { ...item, is_payment_completed: isCompleted, payment_completed_at: isCompleted ? new Date().toISOString() : null }\n            : item\n        )\n        \n        \n        //    \n        const result = {\n          ...prev,\n          items: prev.items ? updatedItems : prev.items,\n          purchase_request_items: prev.purchase_request_items ? updatedItems : prev.purchase_request_items\n        }\n        \n        return result\n      })\n\n      if (purchase) {\n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate?.(purchaseIdNumber, prev => {\n            const updatedItems = (prev.items || []).map(item =>\n              String(item.id) === itemIdStr\n                ? { ...item, is_payment_completed: isCompleted }\n                : item\n            )\n            const total = updatedItems.length || prev.items?.length || 0\n            const completed = updatedItems.filter(item => item.is_payment_completed).length\n            const allCompleted = total > 0 && completed === total\n            return {\n              ...prev,\n              items: updatedItems,\n              is_payment_completed: allCompleted,\n              payment_completed_at: allCompleted ? new Date().toISOString() : null,\n              payment_completed_by_name: allCompleted ? (currentUserName || prev.payment_completed_by_name) : prev.payment_completed_by_name\n            }\n          })\n        }\n      }\n      \n      toast.success(isCompleted ? ' .' : ' .')\n\n      //         \n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n  //     (  + ) -   \n  const handleItemReceiptToggle = async (itemId: number | string, selectedDate: Date, receivedQuantity?: number) => {\n    if (!canReceiveItems) {\n      toast.error('   .')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('   ID .')\n      return\n    }\n\n    //    \n    const currentItem = purchase?.items?.find(item => String(item.id) === itemIdStr) \n      || purchase?.purchase_request_items?.find(item => String(item.id) === itemIdStr)\n    \n    const requestedQty = currentItem?.quantity || 0\n    const currentReceivedQty = currentItem?.received_quantity || 0\n    const newReceivedQty = receivedQuantity !== undefined ? receivedQuantity : requestedQty\n    const totalReceivedQty = currentReceivedQty + newReceivedQty\n    const isFullyReceived = totalReceivedQty >= requestedQty\n    const deliveryStatus: 'pending' | 'partial' | 'received' = totalReceivedQty === 0 ? 'pending' : (isFullyReceived ? 'received' : 'partial')\n\n    //    \n    const existingHistory = (currentItem?.receipt_history as any[]) || []\n    const nextSeq = existingHistory.length + 1\n    const newHistoryItem = {\n      seq: nextSeq,\n      qty: newReceivedQty,\n      date: selectedDate.toISOString(),\n      by: currentUserName || ''\n    }\n    const updatedHistory = [...existingHistory, newHistoryItem]\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  is_received: isFullyReceived,\n                  delivery_status: deliveryStatus,\n                  actual_received_date: selectedDate.toISOString(),\n                  received_quantity: totalReceivedQty,\n                  receipt_history: updatedHistory\n                }\n              : item\n          )\n          const total = updatedItems.length || prev.items?.length || 0\n          const completed = updatedItems.filter(item => item.is_received).length\n          const allReceived = total > 0 && completed === total\n\n          return {\n            ...prev,\n            items: updatedItems,\n            is_received: allReceived,\n            received_at: allReceived ? new Date().toISOString() : prev.received_at\n          }\n        })\n      }\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: isFullyReceived,\n          delivery_status: deliveryStatus,\n          received_at: new Date().toISOString(),\n          actual_received_date: selectedDate.toISOString(),\n          received_quantity: totalReceivedQty,\n          receipt_history: updatedHistory\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      //      (  )\n      if (purchase) {\n        const memoryUpdated = markItemAsReceived(purchase.id, numericId, selectedDate.toISOString(), totalReceivedQty);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]       ', { \n            purchaseId: purchase.id, \n            itemId: numericId \n          });\n        }\n      }\n\n      //     (  )\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          String(item.id) === itemIdStr \n            ? { \n                ...item, \n                is_received: isFullyReceived, \n                delivery_status: deliveryStatus,\n                received_at: new Date().toISOString(),\n                actual_received_date: selectedDate.toISOString(),\n                received_quantity: totalReceivedQty,\n                receipt_history: updatedHistory\n              }\n            : item\n        )\n        const updatedRequestItems = prev.purchase_request_items?.map(item => \n          String(item.id) === itemIdStr \n            ? { \n                ...item, \n                is_received: isFullyReceived, \n                delivery_status: deliveryStatus,\n                received_at: new Date().toISOString(),\n                actual_received_date: selectedDate.toISOString(),\n                received_quantity: totalReceivedQty,\n                receipt_history: updatedHistory\n              }\n            : item\n        )\n        return { \n          ...prev, \n          items: updatedItems,\n          purchase_request_items: updatedRequestItems,\n          updated_at: new Date().toISOString()\n        }\n      })\n\n      applyOptimisticUpdate()\n      \n      const targetItem = purchase?.items?.find(item => String(item.id) === itemIdStr)\n      toast.success(`\"${targetItem?.item_name}\"   .`)\n\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n  //   \n  const handleReceiptCancel = async (itemId: number | string) => {\n    if (!canProcessReceipt) {\n      toast.error('   .')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('   ID .')\n      return\n    }\n\n    const targetItem = purchase?.items?.find(item => String(item.id) === itemIdStr)\n    if (!targetItem) return\n\n    const confirm = window.confirm(`\"${targetItem.item_name}\"   ?`)\n    if (!confirm) return\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  is_received: false,\n                  actual_received_date: undefined\n                }\n              : item\n          )\n          const total = updatedItems.length || prev.items?.length || 0\n          const completed = updatedItems.filter(item => item.is_received).length\n          const allReceived = total > 0 && completed === total\n\n          return {\n            ...prev,\n            items: updatedItems,\n            is_received: allReceived,\n            received_at: allReceived ? prev.received_at : null\n          }\n        })\n      }\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: false,\n          received_at: null,\n          actual_received_date: null,\n          actual_received_by_name: null\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      //    \n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          String(item.id) === itemIdStr \n            ? { ...item, is_received: false, received_at: null, actual_received_date: undefined, actual_received_by_name: undefined }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n      \n      applyOptimisticUpdate()\n\n      toast.success(' .')\n\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n\n  //  \n  const handleApprove = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const approvalType = type === 'middle' ? '1 ' : ' '\n    const confirmMessage = `: ${purchase.purchase_order_number}\\n\\n${approvalType} ?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n    \n    try {\n      const updateData = type === 'middle' \n        ? { \n            middle_manager_status: 'approved'\n          }\n        : { \n            final_manager_status: 'approved'\n          }\n\n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n\n      //     (UI  )\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'approved' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'approved' } : null)\n      }\n\n      //      ( notifyCacheListeners  ->    )\n      updatePurchaseInMemory(String(purchase.id), (prev) => ({\n        ...prev,\n        ...(type === 'middle' \n          ? { middle_manager_status: 'approved' as any }\n          : { final_manager_status: 'approved' as any }\n        )\n      }))\n\n      // Optimistic Update    (/  )\n      if (purchase && onOptimisticUpdate) {\n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate(purchaseIdNumber, prev => {\n            if (type === 'middle') {\n              return {\n                ...prev,\n                middle_manager_status: 'approved' as any\n              }\n            } else {\n              return {\n                ...prev,\n                final_manager_status: 'approved' as any\n              }\n            }\n          })\n        }\n      }\n      \n      toast.success(`${type === 'middle' ? '' : ''}  .`)\n\n      //      \n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n  \n  //    (   )\n  const handleCompleteAllPayment = async () => {\n    \n    if (!purchase || !canPurchase) {\n      return\n    }\n    \n    const confirmMessage = `: ${purchase.purchase_order_number}\\n\\n  ?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) {\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const allItems = prev.purchase_request_items || [];\n          const pendingItems = allItems.filter(item => !item.is_payment_completed);\n          \n          const updatedItems = allItems.map(item => \n            !item.is_payment_completed \n              ? { ...item, is_payment_completed: true, payment_completed_at: new Date().toISOString() }\n              : item\n          );\n          \n          return {\n            ...prev,\n            purchase_request_items: updatedItems,\n            items: prev.items ? updatedItems : prev.items,\n            is_payment_completed: updatedItems.every(item => item.is_payment_completed)\n          }\n        })\n      }\n    }\n    \n    try {\n      //     (   )\n      const allItems = purchase.purchase_request_items || [];\n      const pendingItems = allItems.filter(item => !item.is_payment_completed);\n      \n      if (pendingItems.length === 0) {\n        toast.info('   .');\n        return;\n      }\n\n      logger.info(`  : ${pendingItems.length}  ( ${allItems.length} )`);\n      \n      for (const item of pendingItems) {\n        //   DB  (   )\n        const updateData = {\n          is_payment_completed: true,\n          payment_completed_at: new Date().toISOString()\n        };\n\n        const { error } = await supabase\n          .from('purchase_request_items')\n          .update(updateData)\n          .eq('id', item.id);\n\n        if (error) throw error;\n\n        //       (  )\n        const memoryUpdated = markItemAsPaymentCompleted(purchase.id, item.id);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]       ', { \n            purchaseId: purchase.id, \n            itemId: item.id \n          });\n        }\n      }\n\n      toast.success(`${pendingItems.length}   .`);\n\n      //   (  )\n      await refreshModalData();\n      const refreshResult = onRefresh?.(true, { silent: true });\n      if (refreshResult instanceof Promise) {\n        await refreshResult;\n      }\n    } catch (error) {\n      logger.error('   ', error);\n      toast.error('    .')\n    }\n  }\n\n  //     \n  const handleItemExpenditure = async (itemId: number | string, date: Date, amount: number) => {\n    if (!purchase || !canReceiptCheck) {\n      toast.error('    .')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      logger.error('  itemId', { itemId })\n      return\n    }\n\n    const targetItem = purchase.items?.find(item => String(item.id) === itemIdStr)\n    if (!targetItem) return\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  expenditure_date: date.toISOString(),\n                  expenditure_amount: amount\n                }\n              : item\n          )\n          return { ...prev, items: updatedItems }\n        })\n      }\n    }\n\n    try {\n      applyOptimisticUpdate()\n\n      //     (items purchase_request_items  ) -    \n      setPurchase(prev => {\n        if (!prev) return null\n        const currentItems = prev.items || prev.purchase_request_items || []\n        const updatedItems = currentItems.map(item => \n          String(item.id) === itemIdStr\n            ? {\n                ...item,\n                expenditure_date: date.toISOString(),\n                expenditure_amount: amount\n              }\n            : item\n        )\n        const totalExpenditure = updatedItems.reduce((sum, item) => sum + (item.expenditure_amount || 0), 0)\n        //    React   \n        return { \n          ...prev, \n          items: updatedItems,\n          purchase_request_items: updatedItems,\n          total_expenditure_amount: totalExpenditure,\n          updated_at: new Date().toISOString() //    \n        }\n      })\n\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          expenditure_date: date.toISOString(),\n          expenditure_amount: amount\n        })\n        .eq('id', numericId)\n\n      if (error) {\n        logger.error('  DB  ', { error, itemId: numericId })\n        throw error\n      }\n\n      // purchase_requests total_expenditure_amount \n      const allItemsForTotal = purchase.items || purchase.purchase_request_items || []\n      const totalExpenditure = allItemsForTotal.reduce((sum, item) => {\n        if (String(item.id) === itemIdStr) {\n          return sum + amount\n        }\n        return sum + (item.expenditure_amount || 0)\n      }, 0)\n\n      await supabase\n        .from('purchase_requests')\n        .update({ total_expenditure_amount: totalExpenditure })\n        .eq('id', purchaseIdNumber)\n\n      //      ( UI ) - DB   \n      if (purchase?.id) {\n        const memoryUpdated = markItemAsExpenditureSet(purchase.id, numericId, date.toISOString(), amount)\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]      ', { \n            purchaseId: purchase.id, \n            itemId: numericId \n          })\n        }\n      }\n\n      toast.success(`\"${targetItem.item_name}\"    .`)\n\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      logger.error('    ', error)\n      toast.error('     .')\n    }\n  }\n\n  //     \n  const handleBulkExpenditure = async (date: Date, amount: number) => {\n    if (!purchase || !canReceiptCheck) {\n      toast.error('    .')\n      return\n    }\n\n    const confirmMessage = `: ${purchase.purchase_order_number}\\n\\n   ?\\n: ${date.toLocaleDateString('ko-KR')}\\n : ${amount.toLocaleString()}\\n\\n* :        ,    .`\n    \n    if (!window.confirm(confirmMessage)) {\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item => ({\n            ...item,\n            expenditure_date: date.toISOString(),\n            expenditure_amount: null\n          }))\n          return { \n            ...prev, \n            items: updatedItems,\n            total_expenditure_amount: amount\n          }\n        })\n      }\n    }\n\n    try {\n      applyOptimisticUpdate()\n\n      const allItems = purchase.items || purchase.purchase_request_items || []\n      \n      if (allItems.length === 0) {\n        toast.error(' .')\n        return\n      }\n\n      //    \n      setPurchase(prev => {\n        if (!prev) return null\n        const allItems = prev.items || prev.purchase_request_items || []\n        const updatedItems = allItems.map(item => ({\n            ...item,\n            expenditure_date: date.toISOString(),\n            expenditure_amount: null\n        }))\n        \n        return { \n          ...prev, \n          items: updatedItems,\n          purchase_request_items: updatedItems,\n          total_expenditure_amount: amount,\n          updated_at: new Date().toISOString()\n        }\n      })\n\n      // DB  -   ( null)\n      const { error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .update({\n          expenditure_date: date.toISOString(),\n          expenditure_amount: null\n        })\n        .in('id', allItems.map(item => item.id))\n\n      if (itemsError) {\n        logger.error('    DB  ', { error: itemsError })\n        throw itemsError\n      }\n\n      // DB  -  \n      const { error: requestError } = await supabase\n        .from('purchase_requests')\n        .update({ total_expenditure_amount: amount })\n        .eq('id', purchaseIdNumber)\n\n      if (requestError) {\n        logger.error('    DB  ', { error: requestError })\n        throw requestError\n      }\n\n      //      ( UI )\n      markBulkExpenditureSet(purchase.id, date.toISOString(), amount)\n\n      toast.success('   .')\n    } catch (error) {\n      logger.error('     ', error)\n      toast.error('      .')\n    }\n  }\n\n  //     (   )\n  const handleCompleteAllStatement = async (selectedDate: Date) => {\n    if (!purchase || !canReceiptCheck) {\n      return\n    }\n\n    const formattedDate = selectedDate.toLocaleDateString('ko-KR', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit'\n    })\n\n    const confirmMessage = `: ${purchase.purchase_order_number}\n\n   ?`\n    \n    if (!window.confirm(confirmMessage)) {\n      return\n    }\n\n    const selectedDateIso = selectedDate.toISOString()\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const allItems = prev.purchase_request_items || [];\n          const pendingItems = allItems.filter(item => !item.is_statement_received);\n          \n          const updatedItems = allItems.map(item => \n            !item.is_statement_received \n              ? { \n                  ...item, \n                  is_statement_received: true, \n                  statement_received_date: selectedDateIso,\n                  statement_received_by_name: currentUserName || null\n                }\n              : item\n          );\n          \n          return {\n            ...prev,\n            purchase_request_items: updatedItems,\n            items: prev.items ? updatedItems : prev.items,\n            is_statement_received: updatedItems.every(item => item.is_statement_received),\n            statement_received_at: selectedDateIso\n          }\n        })\n      }\n    }\n\n    try {\n      //     (    )\n      const allItems = purchase.purchase_request_items || [];\n      const pendingItems = allItems.filter(item => !item.is_statement_received);\n      \n      if (pendingItems.length === 0) {\n        toast.info('    .');\n        return;\n      }\n\n      logger.info(`   : ${pendingItems.length}  ( ${allItems.length} )`);\n      \n      for (const item of pendingItems) {\n        //   DB  (   )\n        const updateData = {\n          is_statement_received: true,\n          statement_received_date: selectedDateIso,\n          statement_received_by_name: currentUserName || null\n        };\n\n        const { error } = await supabase\n          .from('purchase_request_items')\n          .update(updateData)\n          .eq('id', item.id);\n\n        if (error) throw error;\n\n        //       (  )\n        const memoryUpdated = markItemAsStatementReceived(purchase.id, item.id, selectedDateIso, currentUserName || undefined);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]        ', { \n            purchaseId: purchase.id, \n            itemId: item.id \n          });\n        }\n      }\n\n      toast.success(`${pendingItems.length}    .`);\n\n      //   (  )\n      await refreshModalData();\n      const refreshResult = onRefresh?.(true, { silent: true });\n      if (refreshResult instanceof Promise) {\n        await refreshResult;\n      }\n    } catch (error) {\n      logger.error('    ', error)\n      toast.error('     .')\n    }\n  }\n\n  //    (  + )\n  const handleCompleteAllReceipt = async (selectedDate: Date, receivedQuantity?: number) => {\n    if (!purchase || !canReceiveItems) {\n      return\n    }\n\n    //   \n    const confirmMessage = `: ${purchase.purchase_order_number}\n\n  ?`\n    \n    if (!window.confirm(confirmMessage)) {\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    try {\n      //     (   )\n      const allItems = purchase.purchase_request_items || [];\n      const pendingItems = allItems.filter(item => !item.is_received);\n      \n      const applyOptimisticUpdate = () => {\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate?.(purchaseIdNumber, prev => {\n            const updatedItems = (prev.items || []).map(item => {\n              const pendingItem = pendingItems.find((p: any) => String(p.id) === String(item.id))\n              if (pendingItem) {\n                //   , receivedQuantity  (quantity)  \n                return {\n                  ...item,\n                  is_received: true,\n                  actual_received_date: item.actual_received_date || selectedDate.toISOString(),\n                  received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n                }\n              }\n              return item\n            })\n            const updatedRequestItems = (prev.purchase_request_items || []).map(item => {\n              const pendingItem = pendingItems.find((p: any) => String(p.id) === String(item.id))\n              if (pendingItem) {\n                //   , receivedQuantity  (quantity)  \n                return {\n                  ...item,\n                  is_received: true,\n                  actual_received_date: item.actual_received_date || selectedDate.toISOString(),\n                  received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n                }\n              }\n              return item\n            })\n\n            return {\n              ...prev,\n              items: updatedItems,\n              purchase_request_items: updatedRequestItems,\n              is_received: true,\n              received_at: new Date().toISOString(),\n              updated_at: new Date().toISOString()\n            }\n          })\n        }\n      }\n      \n      if (pendingItems.length === 0) {\n        toast.info('   .');\n        return;\n      }\n\n      logger.info(`  : ${pendingItems.length}  ( ${allItems.length} )`);\n      \n      // Optimistic Update  \n      applyOptimisticUpdate()\n      \n      //    \n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => {\n          const pendingItem = pendingItems.find(p => String(p.id) === String(item.id))\n          if (pendingItem) {\n            // receivedQuantity  (quantity)  \n            return {\n              ...item,\n              is_received: true,\n              received_at: new Date().toISOString(),\n              actual_received_date: selectedDate.toISOString(),\n              received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n            }\n          }\n          return item\n        }) || []\n        const updatedRequestItems = prev.purchase_request_items?.map(item => {\n          const pendingItem = pendingItems.find(p => String(p.id) === String(item.id))\n          if (pendingItem) {\n            // receivedQuantity  (quantity)  \n            return {\n              ...item,\n              is_received: true,\n              received_at: new Date().toISOString(),\n              actual_received_date: selectedDate.toISOString(),\n              received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity\n            }\n          }\n          return item\n        }) || []\n        const total = updatedItems.length\n        const completed = updatedItems.filter(item => item.is_received).length\n        const allReceived = total > 0 && completed === total\n        \n        return {\n          ...prev,\n          items: updatedItems,\n          purchase_request_items: updatedRequestItems,\n          is_received: allReceived,\n          received_at: allReceived ? new Date().toISOString() : prev.received_at,\n          updated_at: new Date().toISOString()\n        }\n      })\n      \n      for (const item of pendingItems) {\n        //   DB  (   )\n        // receivedQuantity  (quantity)  \n        const updateData = {\n          actual_received_date: selectedDate.toISOString(),\n          is_received: true,\n          received_quantity: receivedQuantity !== undefined ? receivedQuantity : item.quantity //     \n        };\n\n        const { error } = await supabase\n          .from('purchase_request_items')\n          .update(updateData)\n          .eq('id', item.id);\n\n        if (error) throw error;\n\n        //       (  )\n        // receivedQuantity  (quantity)  \n        const itemReceivedQuantity = receivedQuantity !== undefined ? receivedQuantity : item.quantity\n        const memoryUpdated = markItemAsReceived(purchase.id, item.id, selectedDate.toISOString(), itemReceivedQuantity);\n        if (!memoryUpdated) {\n          logger.warn('[PurchaseDetailModal]       ', { \n            purchaseId: purchase.id, \n            itemId: item.id \n          });\n        }\n      }\n\n      toast.success(`${pendingItems.length}   .`);\n\n      //   (  )\n      await refreshModalData();\n      const refreshResult = onRefresh?.(true, { silent: true });\n      if (refreshResult instanceof Promise) {\n        await refreshResult;\n      }\n    } catch (error) {\n      logger.error('   ', error)\n      toast.error('    .')\n    }\n  }\n  \n\n  //  \n  const handleReject = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const reason = window.prompt('  :')\n    if (!reason) return\n    \n    try {\n      const updateData = type === 'middle'\n        ? {\n            middle_manager_status: 'rejected'\n          }\n        : {\n            final_manager_status: 'rejected'\n          }\n      \n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n      \n      //     (UI  )\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'rejected' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'rejected' } : null)\n      }\n      \n      toast.success(`${type === 'middle' ? '' : ''}  .`)\n    } catch (error) {\n      toast.error('    .')\n    }\n  }\n\n  const renderItemRow = (item: any, index: number, dragProps?: SortableRenderProps, rowKey?: string) => {\n    const stableKey = rowKey || item?.stableKey || getSortableId(item, index)\n    const rowClass = `px-2 sm:px-3 py-1 border-b border-gray-50 hover:bg-gray-50/50 relative overflow-visible w-fit ${isEditing ? 'pl-7 sm:pl-8' : ''} ${dragProps?.isDragging ? 'shadow-lg ring-2 ring-blue-200 bg-white' : ''}`\n    const rowProps: any = {\n      className: rowClass,\n      key: stableKey\n    }\n    if (dragProps?.setNodeRef) rowProps.ref = dragProps.setNodeRef\n    if (dragProps?.style) rowProps.style = dragProps.style\n\n    return (\n      <div {...rowProps}>\n        {isEditing && dragProps && (\n          <button\n            className=\"absolute left-1 top-2 sm:top-3 text-gray-400 hover:text-gray-600 p-1 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-200\"\n            {...dragProps.attributes}\n            {...dragProps.listeners}\n            aria-label=\"   \"\n          >\n            <GripVertical className=\"w-3.5 h-3.5\" />\n          </button>\n        )}\n        {/* Desktop Layout */}\n        <div className={`hidden sm:grid items-center gap-1 overflow-visible w-fit`} style={{\n          gridTemplateColumns: getGridTemplateColumns()\n        }}>\n          {/*  */}\n          <div className=\"flex justify-center items-center text-[11px] text-gray-500 font-medium -ml-2 sm:-ml-3\">\n            {item.line_number || index + 1}\n          </div>\n          {/*  */}\n          <div className=\"min-w-0 relative overflow-visible flex items-center\">\n            {isEditing ? (\n              <Input\n                value={item.item_name}\n                onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                onFocus={() => setFocusedInput(`item_name_${index}`)}\n                onBlur={() => setFocusedInput(null)}\n                className={`modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                  focusedInput === `item_name_${index}` \n                    ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal' \n                    : '!h-5 !truncate'\n                }`}\n                placeholder=\"\"\n              />\n            ) : (\n              <div \n                className=\"modal-value\" \n                style={{\n                  whiteSpace: 'normal',\n                  wordBreak: 'break-all',\n                  overflowWrap: 'break-word',\n                  hyphens: 'none',\n                  WebkitHyphens: 'none',\n                  MozHyphens: 'none',\n                  msHyphens: 'none',\n                  lineHeight: '1.4',\n                  maxHeight: '2.8em',\n                  overflow: 'hidden',\n                  display: '-webkit-box',\n                  WebkitLineClamp: 2,\n                  WebkitBoxOrient: 'vertical'\n                }}\n                title={item.item_name || ' '}\n              >\n                {item.item_name || ' '}\n              </div>\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"min-w-0 relative overflow-visible flex items-center w-full\">\n            {isEditing ? (\n              <Input\n                value={item.specification}\n                onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                onFocus={() => setFocusedInput(`specification_${index}`)}\n                onBlur={() => setFocusedInput(null)}\n                className={`modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                  focusedInput === `specification_${index}` \n                    ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal' \n                    : '!h-5 !truncate'\n                }`}\n                placeholder=\"\"\n              />\n            ) : (\n              <div \n                className=\"text-[11px] text-gray-600 font-medium\" \n                style={{\n                  whiteSpace: 'normal',\n                  wordBreak: 'break-all',\n                  overflowWrap: 'break-word',\n                  hyphens: 'none',\n                  WebkitHyphens: 'none',\n                  MozHyphens: 'none',\n                  msHyphens: 'none',\n                  lineHeight: '1.4',\n                  maxHeight: '2.8em',\n                  overflow: 'hidden',\n                  display: '-webkit-box',\n                  WebkitLineClamp: 2,\n                  WebkitBoxOrient: 'vertical'\n                }}\n                title={item.specification || '-'}\n              >\n                {item.specification || '-'}\n              </div>\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"text-center min-w-0 flex items-center justify-center\">\n            {isEditing ? (\n              (activeTab === 'receipt' || activeTab === 'done') ? (\n                <div className=\"flex flex-col items-center gap-0.5 w-full\">\n                  <Input\n                    type=\"number\"\n                    value={item.quantity}\n                    onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                    className=\"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                    placeholder=\"\"\n                    max=\"99999\"\n                    disabled={canEditLimited && !canEditAll}\n                  />\n                  <div className=\"flex items-center gap-0.5 w-full\">\n                    <span className=\"text-[9px] text-gray-500\">/</span>\n                    <Input\n                      type=\"number\"\n                      value={item.received_quantity ?? ''}\n                      onChange={(e) => handleItemChange(index, 'received_quantity', e.target.value ? Number(e.target.value) : null)}\n                      className=\"border-gray-200 rounded-lg text-center flex-1 !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                      placeholder=\"\"\n                      max=\"99999\"\n                      disabled={canEditLimited && !canEditAll}\n                    />\n                  </div>\n                </div>\n              ) : (\n                <Input\n                  type=\"number\"\n                  value={item.quantity}\n                  onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                  className=\"border-gray-200 rounded-lg text-center w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                  placeholder=\"\"\n                  max=\"99999\"\n                  disabled={canEditLimited && !canEditAll}\n                />\n              )\n            ) : (\n              (activeTab === 'receipt' || activeTab === 'done') ? (\n                (() => {\n                  const quantity = item.quantity || 0\n                  const receivedQuantity = item.received_quantity ?? 0\n                  const shouldWrap = quantity >= 100 || receivedQuantity >= 100\n                  const hasReceived = receivedQuantity > 0\n                  \n                  if (shouldWrap) {\n                    return (\n                      <div className=\"flex flex-col items-center leading-tight\">\n                        <div className={`modal-subtitle ${hasReceived ? 'text-gray-400' : ''}`}>{quantity}</div>\n                        <div className={`modal-subtitle ${hasReceived ? '' : 'text-gray-400'}`}>/{receivedQuantity}</div>\n                      </div>\n                    )\n                  } else {\n                    return (\n                      <span className=\"modal-subtitle\">\n                        <span className={hasReceived ? 'text-gray-400' : ''}>{quantity}</span>\n                        <span className={hasReceived ? '' : 'text-gray-400'}>/{receivedQuantity}</span>\n                      </span>\n                    )\n                  }\n                })()\n              ) : (\n                <span className=\"modal-subtitle\">{item.quantity || 0}</span>\n              )\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"text-right min-w-0 flex items-center justify-end\">\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={item.unit_price_value}\n                onChange={(e) => handleItemChange(index, 'unit_price_value', Number(e.target.value))}\n                className=\"border-gray-200 rounded-lg text-right w-full !h-5 !px-1.5 !py-0.5 !text-[9px] font-normal text-gray-600 focus:border-blue-400\"\n                placeholder=\"\"\n                max=\"100000000000\"\n              />\n            ) : (\n              <span className=\"modal-subtitle\">\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : `${formatCurrency(item.unit_price_value)}`}\n              </span>\n            )}\n          </div>\n          \n          {/*  (  ) */}\n          <div className=\"text-right min-w-0 flex items-center justify-end\">\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={item.amount_value || 0}\n                onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                className=\"border-gray-200 rounded-lg w-full !h-6 !px-1.5 !py-0.5 !text-[10px] font-normal text-gray-600 focus:border-blue-400 text-right\"\n                placeholder=\"\"\n              />\n            ) : (\n              <span className=\"modal-value\">\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : `${formatCurrency(item.amount_value || 0)}`}\n              </span>\n            )}\n          </div>\n          \n          {/*  -       */}\n          {purchase?.payment_category === '' && (\n            <div className=\"text-right min-w-0 flex items-center justify-end\">\n              <span className={isEditing ? \"modal-subtitle\" : \"modal-value\"}>\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : `${formatCurrency(item.tax_amount_value || 0)}`}\n              </span>\n            </div>\n          )}\n          \n          {/*  */}\n          <div className=\"text-center min-w-0 flex items-center justify-center\">\n            {item.link ? (\n              <a\n                href={item.link}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-blue-600 hover:text-blue-800 underline text-[11px]\"\n                onClick={(e) => e.stopPropagation()}\n              >\n                \n              </a>\n            ) : (\n              <span className=\"text-gray-400 text-[11px]\">-</span>\n            )}\n          </div>\n          \n          {/*  */}\n          <div className=\"min-w-0 flex justify-center items-center text-center relative overflow-visible\" style={{ width: '150px', maxWidth: '150px', minWidth: '150px' }}>\n            {isEditing ? (\n              <Input\n                value={item.remark || ''}\n                disabled={canEditLimited && !canEditAll}\n                onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                onFocus={() => setFocusedInput(`remark_${index}`)}\n                onBlur={() => setFocusedInput(null)}\n                className={`modal-label border-gray-200 rounded-lg text-center w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                  focusedInput === `remark_${index}` \n                    ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal !text-left' \n                    : '!h-5 !truncate'\n                }`}\n                placeholder=\"\"\n              />\n            ) : (\n              <div \n                className=\"text-[11px] text-gray-600 font-medium\"\n                style={{\n                  width: '150px',\n                  maxWidth: '150px',\n                  minWidth: '150px',\n                  boxSizing: 'border-box',\n                  whiteSpace: 'normal',\n                  wordBreak: 'break-all',\n                  overflowWrap: 'break-word',\n                  hyphens: 'none',\n                  WebkitHyphens: 'none',\n                  MozHyphens: 'none',\n                  msHyphens: 'none',\n                  lineHeight: '1.4',\n                  maxHeight: '2.8em',\n                  overflow: 'hidden',\n                  display: '-webkit-box',\n                  WebkitLineClamp: 2,\n                  WebkitBoxOrient: 'vertical'\n                }}\n                title={item.remark || '-'}\n              >\n                {item.remark || '-'}\n              </div>\n            )}\n          </div>\n          \n          {/* / -   */}\n          {activeTab !== 'pending' && (\n            <div className=\"text-center flex justify-center items-center\">\n              {isEditing ? (\n                <Button\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => handleRemoveItem(index)}\n                  className=\"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6\"\n                  disabled={canEditLimited && !canEditAll}\n                >\n                  <Trash2 className=\"w-3 h-3\" />\n                </Button>\n              ) : (\n                <>\n                  {activeTab === 'purchase' && (\n                  <div className=\"flex justify-center\">\n                    {canPurchase ? (\n                      <button\n                        onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                        className={`${\n                          item.is_payment_completed\n                            ? 'button-toggle-active bg-orange-500 hover:bg-orange-600 text-white'\n                            : 'button-toggle-inactive'\n                        }`}\n                      >\n                        {item.is_payment_completed ? '' : ''}\n                      </button>\n                    ) : (\n                      <span className={`${\n                        item.is_payment_completed \n                          ? 'button-toggle-active bg-orange-500 text-white' \n                          : 'button-waiting-inactive'\n                      }`}>\n                        {item.is_payment_completed ? '' : ''}\n                      </span>\n                    )}\n                  </div>\n                )}\n                \n                {activeTab === 'receipt' && (\n                  <div className=\"flex justify-center\">\n                    {canReceiveItems ? (\n                      actualReceivedAction.isCompleted(item) ? (\n                        //   - \n                        <button\n                          onClick={() => {\n                            actualReceivedAction.handleCancel(item.id, {\n                              item_name: item.item_name,\n                              specification: item.specification,\n                              quantity: item.quantity,\n                              unit_price_value: item.unit_price_value,\n                              amount_value: item.amount_value,\n                              remark: item.remark\n                            })\n                          }}\n                          className=\"button-action-primary\"\n                        >\n                          {actualReceivedAction.config.completedText}\n                        </button>\n                      ) : actualReceivedAction.isPartiallyReceived(item) ? (\n                        //   -  (  )\n                        <DateQuantityPickerPopover\n                          onConfirm={(date, quantity) => {\n                            handleItemReceiptToggle(item.id, date, quantity)\n                          }}\n                          placeholder=\"  \"\n                          align=\"center\"\n                          side=\"bottom\"\n                          maxQuantity={actualReceivedAction.getRemainingQuantity(item)}\n                          quantityInfoText={`: ${actualReceivedAction.getRemainingQuantity(item)}`}\n                        >\n                          <button className=\"button-base bg-blue-300 hover:bg-blue-400 text-white\">\n                            \n                          </button>\n                        </DateQuantityPickerPopover>\n                      ) : (\n                        //   - \n                        <DateQuantityPickerPopover\n                          onConfirm={(date, quantity) => {\n                            handleItemReceiptToggle(item.id, date, quantity)\n                          }}\n                          placeholder=\"  \"\n                          align=\"center\"\n                          side=\"bottom\"\n                          defaultQuantity={item.received_quantity ?? undefined}\n                          maxQuantity={item.quantity}\n                        >\n                          <button className=\"button-toggle-inactive\">\n                            {actualReceivedAction.config.waitingText}\n                          </button>\n                        </DateQuantityPickerPopover>\n                      )\n                    ) : (\n                      <span className={`${\n                        actualReceivedAction.isCompleted(item)\n                          ? 'button-action-primary' \n                          : actualReceivedAction.isPartiallyReceived(item)\n                          ? 'button-base bg-blue-300 text-white'\n                          : 'button-waiting-inactive'\n                      }`}>\n                        {actualReceivedAction.isCompleted(item) \n                          ? actualReceivedAction.config.completedText \n                          : actualReceivedAction.isPartiallyReceived(item)\n                          ? ''\n                          : actualReceivedAction.config.waitingText}\n                      </span>\n                    )}\n                  </div>\n                )}\n                \n                {activeTab === 'done' && (\n                  <div className=\"flex justify-center\">\n                    <span className={`button-base ${\n                      actualReceivedAction.isCompleted(item)\n                        ? 'bg-blue-500 hover:bg-blue-600 text-white' \n                        : actualReceivedAction.isPartiallyReceived(item)\n                        ? 'bg-blue-300 text-white'\n                        : 'border border-gray-300 text-gray-600 bg-white hover:bg-gray-50'\n                    }`}>\n                      {actualReceivedAction.isCompleted(item) \n                        ? '' \n                        : actualReceivedAction.isPartiallyReceived(item)\n                        ? ''\n                        : ''}\n                    </span>\n                  </div>\n                )}\n                \n                {activeTab !== 'purchase' && activeTab !== 'receipt' && activeTab !== 'done' && (\n                  <div className=\"flex justify-center\">\n                    <span className=\"badge-text\">-</span>\n                  </div>\n                )}\n              </>\n            )}\n            </div>\n          )}\n          \n          {/*    -    (  ) */}\n          {activeTab === 'receipt' && (\n            <div className=\"text-center flex justify-center items-center pl-2\">\n              {actualReceivedAction.getCompletedDate(item) ? (\n                <div className=\"modal-subtitle text-green-700\">\n                  {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                    year: 'numeric',\n                    month: '2-digit',\n                    day: '2-digit'\n                  })}\n                </div>\n              ) : (\n                <span className=\"modal-subtitle text-gray-400\">-</span>\n              )}\n            </div>\n          )}\n\n          {/*   -  +  / */}\n          {showStatementColumns && (\n            <div className=\"text-center flex justify-center items-center\">\n              {canReceiptCheck ? (\n                statementReceivedAction.isCompleted(item) ? (\n                  <button\n                    onClick={() => {\n                      statementReceivedAction.handleCancel(item.id, {\n                        item_name: item.item_name,\n                        specification: item.specification,\n                        quantity: item.quantity,\n                        unit_price_value: item.unit_price_value,\n                        amount_value: item.amount_value,\n                        remark: item.remark\n                      })\n                    }}\n                    className=\"button-action-primary hover:bg-green-600\"\n                    title=\"   \"\n                  >\n                    {statementReceivedAction.config.completedText}\n                  </button>\n                ) : (\n                  <DatePickerPopover\n                    onDateSelect={(date) => {\n                      statementReceivedAction.handleConfirm(item.id, date, {\n                        item_name: item.item_name,\n                        specification: item.specification,\n                        quantity: item.quantity,\n                        unit_price_value: item.unit_price_value,\n                        amount_value: item.amount_value,\n                        remark: item.remark\n                      })\n                    }}\n                    placeholder=\"  \"\n                    align=\"center\"\n                    side=\"bottom\"\n                  >\n                    <button \n                      className=\"button-toggle-inactive\"\n                      onClick={() => {}}\n                    >\n                      {statementReceivedAction.config.waitingText}\n                    </button>\n                  </DatePickerPopover>\n                )\n              ) : (\n                <span className={`${\n                  statementReceivedAction.isCompleted(item)\n                    ? 'button-action-primary' \n                    : 'button-waiting-inactive'\n                }`}>\n                  {statementReceivedAction.isCompleted(item) ? statementReceivedAction.config.completedText : statementReceivedAction.config.waitingText}\n                </span>\n              )}\n            </div>\n          )}\n\n          {/*   -  +  / */}\n          {showStatementColumns && (\n            <div className=\"text-center flex justify-center items-center\">\n              {statementReceivedAction.getCompletedDate(item) ? (\n                <div className=\"modal-subtitle text-blue-700\">\n                  {new Date(statementReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                    year: 'numeric',\n                    month: '2-digit',\n                    day: '2-digit'\n                  })}\n                </div>\n              ) : (\n                <span className=\"modal-subtitle text-gray-400\">-</span>\n              )}\n            </div>\n          )}\n\n          {/*  -      */}\n          {showExpenditureColumn && (\n            <div className=\"text-center flex justify-center items-center\">\n              {(() => {\n                const hasExpenditure = !!item.expenditure_date\n                const hasExpenditureAmount = item.expenditure_amount !== null && item.expenditure_amount !== undefined\n                \n                if (canReceiptCheck) {\n                  return hasExpenditure ? (\n                    <div className=\"w-full px-1 leading-none\">\n                      <div className=\"text-blue-700 text-[9px] leading-[1.1] font-normal\">\n                        {(() => {\n                          const date = new Date(item.expenditure_date)\n                          const year = date.getFullYear().toString().slice(-2)\n                          const month = (date.getMonth() + 1).toString().padStart(2, '0')\n                          const day = date.getDate().toString().padStart(2, '0')\n                          return `${year}.${month}.${day}`\n                        })()}\n                      </div>\n                      <div className=\"text-gray-700 text-[9px] leading-[1.1] font-normal\">\n                        {!canViewFinancialInfo \n                          ? '-' \n                          : (hasExpenditureAmount ? `${Number(item.expenditure_amount).toLocaleString()}` : '')}\n                      </div>\n                    </div>\n                  ) : (\n                    <DateAmountPickerPopover\n                      onConfirm={(date, amount) => handleItemExpenditure(item.id, date, amount)}\n                      placeholder=\"   \"\n                      align=\"center\"\n                      side=\"bottom\"\n                    >\n                      <button className=\"button-toggle-inactive\">\n                        \n                      </button>\n                    </DateAmountPickerPopover>\n                  )\n                } else {\n                  return hasExpenditure ? (\n                    <div className=\"w-full px-1 leading-none\">\n                      <div className=\"text-blue-700 text-[9px] leading-[1.1] font-normal\">\n                        {(() => {\n                          const date = new Date(item.expenditure_date)\n                          const year = date.getFullYear().toString().slice(-2)\n                          const month = (date.getMonth() + 1).toString().padStart(2, '0')\n                          const day = date.getDate().toString().padStart(2, '0')\n                          return `${year}.${month}.${day}`\n                        })()}\n                      </div>\n                      <div className=\"text-gray-700 text-[9px] leading-[1.1] font-normal\">\n                        {!canViewFinancialInfo \n                          ? '-' \n                          : (hasExpenditureAmount ? `${Number(item.expenditure_amount).toLocaleString()}` : '')}\n                      </div>\n                    </div>\n                  ) : (\n                    <span className=\"modal-subtitle text-gray-400\">-</span>\n                  )\n                }\n              })()}\n            </div>\n          )}\n\n        </div>\n        \n        {/* Mobile Layout */}\n        <div className=\"block sm:hidden space-y-2\">\n          <div className=\"flex justify-between items-start\">\n            <div className=\"flex-1 min-w-0 relative\">\n              {isEditing ? (\n                <Input\n                  value={item.item_name}\n                  onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                  onFocus={() => setFocusedInput(`m_item_name_${index}`)}\n                  onBlur={() => setFocusedInput(null)}\n                  className={`modal-label border-gray-200 rounded-lg w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                    focusedInput === `m_item_name_${index}` \n                      ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal' \n                      : '!h-5 !truncate'\n                  }`}\n                  placeholder=\"\"\n                />\n              ) : (\n                <div className=\"modal-value font-medium\">{item.item_name || ' '}</div>\n              )}\n              {isEditing ? (\n                <Input\n                  value={item.specification}\n                  onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                  onFocus={() => setFocusedInput(`m_specification_${index}`)}\n                  onBlur={() => setFocusedInput(null)}\n                  className={`modal-label border-gray-200 rounded-lg mt-1 w-full !px-1.5 !py-0.5 !text-[10px] focus:border-blue-400 transition-all duration-200 ${\n                    focusedInput === `m_specification_${index}` \n                      ? '!h-auto !min-h-[20px] !absolute !z-[9999] !bg-white !shadow-lg !left-0 !right-0 !-translate-y-1/2 !top-1/2 !whitespace-normal !w-full' \n                      : '!h-5 !truncate'\n                  }`}\n                  placeholder=\"\"\n                />\n              ) : (\n                <div className=\"modal-subtitle text-gray-500\">{item.specification || '-'}</div>\n              )}\n            </div>\n            <div className=\"ml-3 text-right flex-shrink-0\">\n              {isEditing ? (\n                <Input\n                  type=\"number\"\n                  value={item.amount_value || 0}\n                  onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                  className=\"border-gray-200 rounded-lg w-24 !h-6 !px-1.5 !py-0.5 !text-[10px] font-normal text-gray-600 focus:border-blue-400 text-right\"\n                  placeholder=\"\"\n                />\n              ) : (\n                <div className=\"modal-value font-semibold\">{formatCurrency(item.amount_value || 0)}</div>\n              )}\n              <div className=\"text-[10px] text-gray-500 mt-0.5\">\n                {activeTab === 'done' && !canViewFinancialInfo \n                  ? '-' \n                  : `${formatCurrency(item.unit_price_value || 0)}`} / \n              </div>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-2\">\n            <div>\n              <span className=\"text-gray-500 text-xs\"></span>\n              {isEditing ? (\n                (activeTab === 'receipt' || activeTab === 'done') ? (\n                  <div className=\"grid grid-cols-2 gap-1 mt-1\">\n                    <Input\n                      type=\"number\"\n                      value={item.quantity}\n                      onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                      className=\"border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                      placeholder=\"\"\n                      max=\"99999\"\n                    />\n                    <Input\n                      type=\"number\"\n                      value={item.received_quantity ?? ''}\n                      onChange={(e) => handleItemChange(index, 'received_quantity', e.target.value ? Number(e.target.value) : null)}\n                      className=\"border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                      placeholder=\"\"\n                      max=\"99999\"\n                    />\n                  </div>\n                ) : (\n                  <Input\n                    type=\"number\"\n                    value={item.quantity}\n                    onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                    className=\"border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400 mt-1\"\n                    placeholder=\"\"\n                    max=\"99999\"\n                  />\n                )\n              ) : (\n                <div className=\"modal-subtitle mt-1\">\n                  {activeTab === 'receipt' || activeTab === 'done' ? (\n                    <>\n                      <span className=\"text-gray-500\">{item.quantity || 0}</span>\n                      <span className=\"text-gray-400\">/{item.received_quantity ?? 0}</span>\n                    </>\n                  ) : (\n                    item.quantity || 0\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <span className=\"text-gray-500 text-xs\"></span>\n              <div className=\"mt-1\">\n                {item.link ? (\n                  <a\n                    href={item.link}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-blue-600 hover:text-blue-800 underline text-[11px] break-all\"\n                    onClick={(e) => e.stopPropagation()}\n                  >\n                    {item.link}\n                  </a>\n                ) : (\n                  <span className=\"text-gray-400 text-[11px]\">-</span>\n                )}\n              </div>\n            </div>\n          </div>\n\n          {/* / */}\n          <div className=\"grid grid-cols-2 gap-2 items-center\">\n            <div>\n              <span className=\"text-gray-500 text-xs\"></span>\n              <div className=\"mt-1\">\n                {activeTab === 'pending' ? (\n                  <span className=\"text-xs text-gray-400\">-</span>\n                ) : (\n                  <>\n                    {activeTab === 'purchase' && (\n                      <div className=\"flex items-center gap-2\">\n                        {canPurchase ? (\n                          <button\n                            onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                            className={`text-xs px-2 py-1 rounded ${\n                              item.is_payment_completed\n                                ? 'button-action-primary'\n                                : 'bg-gray-100 text-gray-600'\n                            }`}\n                          >\n                            {item.is_payment_completed ? '' : ''}\n                          </button>\n                        ) : (\n                          <span className={`text-xs px-2 py-1 rounded ${\n                            item.is_payment_completed \n                              ? 'button-action-primary' \n                              : 'bg-gray-100 text-gray-400'\n                          }`}>\n                            {item.is_payment_completed ? '' : ''}\n                          </span>\n                        )}\n                      </div>\n                    )}\n\n                    {activeTab === 'receipt' && (\n                      <div className=\"flex items-center gap-2\">\n                        {canReceiveItems ? (\n                          actualReceivedAction.isCompleted(item) ? (\n                            <button\n                              onClick={() => {\n                                actualReceivedAction.handleCancel(item.id, {\n                                  item_name: item.item_name,\n                                  specification: item.specification,\n                                  quantity: item.quantity,\n                                  unit_price_value: item.unit_price_value,\n                                  amount_value: item.amount_value,\n                                  remark: item.remark\n                                })\n                              }}\n                              className=\"text-xs px-2 py-1 rounded button-action-primary\"\n                            >\n                              {actualReceivedAction.config.completedText}\n                            </button>\n                          ) : (\n                            <DatePickerPopover\n                              onDateSelect={(date) => {\n                                actualReceivedAction.handleConfirm(item.id, date, {\n                                  item_name: item.item_name,\n                                  specification: item.specification,\n                                  quantity: item.quantity,\n                                  unit_price_value: item.unit_price_value,\n                                  amount_value: item.amount_value,\n                                  remark: item.remark\n                                })\n                              }}\n                              placeholder=\"   \"\n                              align=\"center\"\n                              side=\"bottom\"\n                            >\n                              <button className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\">\n                                {actualReceivedAction.config.waitingText}\n                              </button>\n                            </DatePickerPopover>\n                          )\n                        ) : (\n                          <span className={`text-xs px-2 py-1 rounded ${\n                            actualReceivedAction.isCompleted(item)\n                              ? 'button-action-primary' \n                              : 'bg-gray-100 text-gray-400'\n                          }`}>\n                            {actualReceivedAction.isCompleted(item) ? actualReceivedAction.config.completedText : actualReceivedAction.config.waitingText}\n                          </span>\n                        )}\n                      </div>\n                    )}\n                    \n                    {activeTab === 'done' && (\n                      <>\n                        <span className={`button-base ${\n                          actualReceivedAction.isCompleted(item)\n                            ? 'bg-green-500 text-white' \n                            : 'border border-gray-300 text-gray-600 bg-white'\n                        }`}>\n                          {actualReceivedAction.isCompleted(item) ? '' : ''}\n                        </span>\n                      </>\n                    )}\n                    \n                    {activeTab !== 'purchase' && activeTab !== 'receipt' && activeTab !== 'done' && (\n                      <span className=\"text-xs text-gray-400\">-</span>\n                    )}\n                  </>\n                )}\n              </div>\n            </div>\n\n            {(item.remark || isEditing) && (\n              <div>\n                <span className=\"text-gray-500 text-xs\">:</span>\n                {isEditing ? (\n                  <Input\n                    value={item.remark || ''}\n                    onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                    className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                    placeholder=\"\"\n                  />\n                ) : (\n                  <div className=\"modal-subtitle text-gray-500 mt-1\">{item.remark || '-'}</div>\n                )}\n              </div>\n            )}\n          </div>\n\n          {!isEditing && activeTab === 'receipt' && actualReceivedAction.getCompletedDate(item) && (\n            <div>\n              <span className=\"text-gray-500 text-xs\">:</span>\n              <div className=\"mt-1\">\n                <div className=\"modal-subtitle text-green-700\">\n                  {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                    year: 'numeric',\n                    month: '2-digit',\n                    day: '2-digit'\n                  })}\n                </div>\n                <div className=\"text-[9px] text-gray-500\">\n                  {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleTimeString('ko-KR', {\n                    hour: '2-digit',\n                    minute: '2-digit'\n                  })}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {!isEditing && showStatementColumns && (\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-gray-500 text-xs\"> :</span>\n              <div className=\"flex items-center gap-2\">\n                {canReceiptCheck ? (\n                  statementReceivedAction.isCompleted(item) ? (\n                    <button\n                      onClick={() => {\n                        statementReceivedAction.handleCancel(item.id, {\n                          item_name: item.item_name,\n                          specification: item.specification,\n                          quantity: item.quantity,\n                          unit_price_value: item.unit_price_value,\n                          amount_value: item.amount_value,\n                          remark: item.remark\n                        })\n                      }}\n                      className=\"text-xs px-2 py-1 rounded button-action-primary\"\n                    >\n                      {statementReceivedAction.config.completedText}\n                    </button>\n                  ) : (\n                    <DatePickerPopover\n                      onDateSelect={(date) => {\n                        statementReceivedAction.handleConfirm(item.id, date, {\n                          item_name: item.item_name,\n                          specification: item.specification,\n                          quantity: item.quantity,\n                          unit_price_value: item.unit_price_value,\n                          amount_value: item.amount_value,\n                          remark: item.remark\n                        })\n                      }}\n                      placeholder=\"  \"\n                      align=\"center\"\n                      side=\"bottom\"\n                    >\n                      <button className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\">\n                        {statementReceivedAction.config.waitingText}\n                      </button>\n                    </DatePickerPopover>\n                  )\n                ) : (\n                  <span className={`text-xs px-2 py-1 rounded ${\n                    statementReceivedAction.isCompleted(item)\n                      ? 'button-action-primary' \n                      : 'bg-gray-100 text-gray-400'\n                  }`}>\n                    {statementReceivedAction.isCompleted(item) ? statementReceivedAction.config.completedText : statementReceivedAction.config.waitingText}\n                  </span>\n                )}\n              </div>\n            </div>\n          )}\n\n          {!isEditing && showStatementColumns && statementReceivedAction.getCompletedDate(item) && (\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-gray-500 text-xs\"> :</span>\n              <span className=\"modal-subtitle text-blue-700\">\n                {new Date(statementReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                  year: 'numeric',\n                  month: '2-digit',\n                  day: '2-digit'\n                })}\n              </span>\n            </div>\n          )}\n\n          {!isEditing && showExpenditureColumn && (\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-gray-500 text-xs\">:</span>\n              <div className=\"text-right\">\n                {item.expenditure_date ? (\n                  <>\n                    <div className=\"text-blue-700 text-[11px]\">\n                      {(() => {\n                        const date = new Date(item.expenditure_date)\n                        const year = date.getFullYear().toString().slice(-2)\n                        const month = (date.getMonth() + 1).toString().padStart(2, '0')\n                        const day = date.getDate().toString().padStart(2, '0')\n                        return `${year}.${month}.${day}`\n                      })()}\n                    </div>\n                    <div className=\"text-gray-700 text-[11px]\">\n                      {!canViewFinancialInfo \n                        ? '-' \n                        : (item.expenditure_amount !== null && item.expenditure_amount !== undefined\n                          ? `${Number(item.expenditure_amount).toLocaleString()}`\n                          : '')}\n                    </div>\n                  </>\n                ) : (\n                  <span className=\"text-gray-400 text-[11px]\">-</span>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  const content = (\n    <div className=\"space-y-1 sm:space-y-4\">\n      {loading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-hansl-600\"></div>\n        </div>\n      ) : purchase ? (\n        <div>\n          {/* Compact Info Header */}\n          <div className=\"bg-gray-50 rounded-lg p-2 sm:p-3 mb-1 sm:mb-2 border border-gray-100\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 items-center gap-3 sm:gap-0\">\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4\">\n                <div className=\"flex items-center gap-3\">\n                  {getStatusBadge()}\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"modal-label\">:</span>\n                    <span className=\"modal-value\">{purchase.requester_name}</span>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-3 h-3 text-gray-500\" />\n                  <span className=\"modal-subtitle\">: {formatDate(purchase.request_date)}</span>\n                </div>\n              </div>\n              \n              {/*     */}\n              <div className=\"flex items-center justify-center gap-2 sm:gap-3 flex-wrap\">\n                {/* 1   */}\n                {(() => {\n                  const shouldShow = canApproveMiddle && purchase.middle_manager_status === 'pending';\n                  return shouldShow;\n                })() && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('middle')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    1  \n                  </Button>\n                )}\n                {purchase.middle_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text shadow-sm\">\n                    <Check className=\"w-3 h-3\" />\n                    1 \n                  </div>\n                )}\n                {purchase.middle_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                    1 \n                  </div>\n                )}\n                {purchase.middle_manager_status === 'pending' && !canApproveMiddle && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                    1 \n                  </div>\n                )}\n\n                {/*    */}\n                {(() => {\n                  const shouldShow = canApproveFinal && purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'pending';\n                  return shouldShow;\n                })() && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('final')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    <Check className=\"w-3 h-3\" />\n                     \n                  </Button>\n                )}\n                {purchase.final_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text\">\n                    <Check className=\"w-3 h-3\" />\n                     \n                  </div>\n                )}\n                {purchase.final_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                     \n                  </div>\n                )}\n                {purchase.middle_manager_status !== 'approved' && purchase.final_manager_status === 'pending' && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                     \n                  </div>\n                )}\n              </div>\n              \n              {/*    */}\n              <div></div>\n            </div>\n          </div>\n\n          {/* Main 2-Column Layout */}\n          <div className=\"flex flex-col lg:flex-row gap-3 sm:gap-6\">\n            {/* Left Column - Basic Info (Fixed Width) */}\n            <div className=\"lg:w-80 lg:flex-shrink-0 space-y-1 sm:space-y-4 relative\">\n              \n              {/*   */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <div className=\"mb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <h3 className=\"modal-section-title flex items-center\">\n                      <FileText className=\"w-4 h-4 mr-2 text-gray-600\" />\n                      {purchase?.purchase_order_number || 'PO '}\n                    </h3>\n                    {canReceiptCheck && canViewFinancialInfo && activeTab === 'done' && (\n                      <button\n                        onClick={async () => {\n                          if (!purchase) return\n                          const isCurrentlyChecked = purchase.is_utk_checked || false\n                          const newStatus = !isCurrentlyChecked\n                          \n                          const confirmMessage = newStatus\n                            ? `: ${purchase.purchase_order_number}\\n\\nUTK  ?`\n                            : `: ${purchase.purchase_order_number}\\n\\nUTK  ?`\n                          \n                          if (!window.confirm(confirmMessage)) return\n                          \n                          try {\n                            const supabase = createClient()\n                            const { error } = await supabase\n                              .from('purchase_requests')\n                              .update({ is_utk_checked: newStatus })\n                              .eq('id', purchase.id)\n                            \n                            if (error) {\n                              logger.error('UTK  DB  ', { error, purchaseId: purchase.id })\n                              toast.error('UTK     .')\n                              return\n                            }\n                            \n                            //     (   React  )\n                            setPurchase(prev => prev ? { \n                              ...prev, \n                              is_utk_checked: newStatus,\n                              updated_at: new Date().toISOString() //    \n                            } : null)\n                            \n                            //   \n                            if (purchase.id) {\n                              updatePurchaseInMemory(purchase.id, (prev) => ({\n                                ...prev,\n                                is_utk_checked: newStatus\n                              }))\n                            }\n                            \n                            toast.success(newStatus ? 'UTK  .' : 'UTK  .')\n                            \n                            await refreshModalData()\n                            const refreshResult = onRefresh?.(true, { silent: true })\n                            if (refreshResult instanceof Promise) {\n                              await refreshResult\n                            }\n                          } catch (error) {\n                            logger.error('UTK    ', error)\n                            toast.error('UTK     .')\n                          }\n                        }}\n                        className={`button-base text-xs px-2 py-1 flex items-center ${\n                          purchase?.is_utk_checked\n                            ? 'button-toggle-active bg-orange-500 hover:bg-orange-600 text-white'\n                            : 'button-toggle-inactive'\n                        }`}\n                        title={purchase?.is_utk_checked ? 'UTK  ' : 'UTK '}\n                      >\n                        <CheckCircle className=\"w-3 h-3 mr-1\" />\n                        UTK {purchase?.is_utk_checked ? '' : ''}\n                      </button>\n                    )}\n                  </div>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.request_type || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, request_type: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.request_type || ''}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.payment_category || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, payment_category: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"//\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.payment_category || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        <DatePickerPopover\n                          onDateSelect={(date) => {\n                            setEditedPurchase(prev => prev ? {\n                              ...prev,\n                              delivery_request_date: formatDateInput(date, 'yyyy-MM-dd')\n                            } : null)\n                          }}\n                          placeholder=\"  \"\n                          align=\"start\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            variant=\"outline\"\n                            className=\"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input\"\n                            disabled={canEditLimited && !canEditAll}\n                          >\n                            <Calendar className=\"mr-1 h-3 w-3\" />\n                            {editedPurchase?.delivery_request_date ? \n                              formatDate(editedPurchase.delivery_request_date) : \n                              ' '\n                            }\n                          </Button>\n                        </DatePickerPopover>\n                      ) : (\n                        <p className=\"modal-subtitle\">{formatDate(purchase.delivery_request_date)}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label text-orange-500\"> </span>\n                      {isEditing ? (\n                        <DatePickerPopover\n                          onDateSelect={(date) => {\n                            setEditedPurchase(prev => prev ? {\n                              ...prev,\n                              revised_delivery_request_date: formatDateInput(date, 'yyyy-MM-dd')\n                            } : null)\n                          }}\n                          placeholder=\"  \"\n                          align=\"start\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            variant=\"outline\"\n                            className=\"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input\"\n                            disabled={canEditLimited && !canEditAll}\n                          >\n                            <Calendar className=\"mr-1 h-3 w-3\" />\n                            {editedPurchase?.revised_delivery_request_date ? \n                              formatDate(editedPurchase.revised_delivery_request_date) : \n                              ' '\n                            }\n                          </Button>\n                        </DatePickerPopover>\n                      ) : (\n                        <p className=\"modal-subtitle text-orange-700\">\n                          {purchase.revised_delivery_request_date ? formatDate(purchase.revised_delivery_request_date) : ''}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/*   */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <h3 className=\"modal-section-title mb-3 flex items-center\">\n                  <Building2 className=\"w-4 h-4 mr-2 text-gray-600\" />\n                   \n                </h3>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"></span>\n                      {isEditing ? (\n                        <ReactSelect\n                          options={vendors.map(v => ({ \n                            value: v.id.toString(), \n                            label: v.vendor_name \n                          }))}\n                          value={editedPurchase?.vendor_id ? {\n                            value: editedPurchase.vendor_id.toString(),\n                            label: editedPurchase.vendor_name || vendors.find(v => v.id === editedPurchase.vendor_id)?.vendor_name || ''\n                          } : null}\n                          isDisabled={canEditLimited && !canEditAll}\n                          onChange={(option) => {\n                            logger.info('ReactSelect onChange:', { option })\n                            if (option) {\n                              const selectedVendor = vendors.find(v => v.id.toString() === option.value)\n                              logger.info('Selected vendor:', { selectedVendor })\n                              if (selectedVendor) {\n                                //    \n                                const supabase = createClient()\n                                supabase\n                                  .from('vendor_contacts')\n                                  .select('id, contact_name, contact_email, contact_phone, position')\n                                  .eq('vendor_id', selectedVendor.id)\n                                  .then(({ data: contactsData, error }: { data: any, error: any }) => {\n                                    if (error) {\n                                      logger.error('    :', error)\n                                      console.error('   :', error)\n                                    }\n                                    \n                                    logger.info('   -   :', { \n                                      vendor_id: selectedVendor.id,\n                                      vendor_name: selectedVendor.vendor_name,\n                                      contactsData,\n                                      contactsCount: contactsData?.length || 0\n                                    })\n                                    console.log('   -  :', contactsData)\n                                    \n                                    setEditedPurchase(prev => {\n                                      const updated = prev ? { \n                                        ...prev, \n                                        vendor_id: selectedVendor.id,\n                                        vendor_name: selectedVendor.vendor_name,\n                                        vendor: selectedVendor,\n                                        vendor_contacts: Array.isArray(contactsData) ? contactsData : [],\n                                        contact_id: undefined,  //     \n                                        contact_name: undefined  //      \n                                      } : null\n                                      logger.info('   - editedPurchase  :', { \n                                        vendor_id: selectedVendor.id,\n                                        vendor_name: selectedVendor.vendor_name,\n                                        contactsData,\n                                        updated_vendor_contacts: updated?.vendor_contacts,\n                                        updated_full: updated\n                                      })\n                                      console.log('   - editedPurchase :', updated)\n                                      return updated\n                                    })\n                                  })\n                              }\n                            } else {\n                              setEditedPurchase(prev => prev ? { \n                                ...prev, \n                                vendor_id: undefined,\n                                vendor_name: '',\n                                vendor: undefined,\n                                vendor_contacts: [],\n                                contact_id: undefined,  //     \n                                contact_name: undefined  //      \n                              } : null)\n                            }\n                          }}\n                          placeholder=\" \"\n                          isClearable\n                          isSearchable\n                          menuPortalTarget={document.body}\n                          styles={{\n                            control: (base) => ({\n                              ...base,\n                              minHeight: '20px',\n                              height: '20px',\n                              fontSize: '10px',\n                              borderRadius: '8px', // rounded-lg  \n                              borderColor: '#e5e7eb', // border-gray-200  \n                              borderWidth: '1px',\n                              backgroundColor: '#ffffff',\n                              boxShadow: 'none',\n                              paddingLeft: '6px', // px-1.5\n                              paddingRight: '6px', // px-1.5\n                              '&:hover': {\n                                borderColor: '#e5e7eb', // hover    \n                              },\n                              '&:focus-within': {\n                                borderColor: '#60a5fa', // focus:border-blue-400\n                                boxShadow: 'none',\n                                outline: 'none',\n                              },\n                            }),\n                            valueContainer: (base) => ({\n                              ...base,\n                              height: '18px', // Input   \n                              padding: '0 2px', //   \n                              margin: '0',\n                            }),\n                            input: (base) => ({\n                              ...base,\n                              margin: '0',\n                              padding: '0',\n                              fontSize: '10px',\n                            }),\n                            indicatorsContainer: (base) => ({\n                              ...base,\n                              height: '18px',\n                              padding: '0',\n                            }),\n                            indicatorSeparator: () => ({\n                              display: 'none',\n                            }),\n                            dropdownIndicator: (base) => ({\n                              ...base,\n                              padding: '0 2px',\n                              svg: {\n                                width: '12px',\n                                height: '12px',\n                              },\n                            }),\n                            clearIndicator: (base) => ({\n                              ...base,\n                              padding: '0 2px',\n                              svg: {\n                                width: '12px',\n                                height: '12px',\n                              },\n                            }),\n                            option: (base) => ({\n                              ...base,\n                              fontSize: '10px',\n                              padding: '4px 8px',\n                            }),\n                            menuPortal: (base) => ({\n                              ...base,\n                              zIndex: 9999,\n                            }),\n                          }}\n                          classNamePrefix=\"vendor-select\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.vendor?.vendor_name || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"> </span>\n                      {isEditing ? (\n                        editedPurchase?.vendor_id ? (\n                          <ReactSelect\n                            isDisabled={canEditLimited && !canEditAll}\n                            options={(() => {\n                              const contacts = Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                              //  : id    ( ID  )\n                              const uniqueContacts = contacts.filter((contact, index, arr) => \n                                arr.findIndex(c => c.id === contact.id) === index\n                              )\n                              //  contact_name    (   ID  )\n                              const finalUniqueContacts = uniqueContacts.filter((contact, index, arr) => \n                                arr.findIndex(c => c.contact_name === contact.contact_name) === index\n                              )\n                              const options = finalUniqueContacts.map(c => ({\n                                value: c.id.toString(),\n                                label: c.contact_name || ''\n                              })) || []\n                              logger.info('   :', {\n                                vendor_id: editedPurchase.vendor_id,\n                                vendor_contacts_raw: editedPurchase.vendor_contacts,\n                                vendor_contacts_count: contacts.length,\n                                unique_by_id_count: uniqueContacts.length,\n                                final_unique_count: finalUniqueContacts.length,\n                                options\n                              })\n                              console.log('   :', options)\n                              return options\n                            })()}\n                            value={(() => {\n                              const contacts = Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                              const firstContact = contacts[0]\n                              return firstContact?.id ? {\n                                value: firstContact.id.toString(),\n                                label: firstContact.contact_name || ''\n                              } : null\n                            })()}\n                            onChange={(option) => {\n                              logger.info('   :', { option })\n                              if (option) {\n                                const contacts = Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                                const selectedContact = contacts.find(c => c.id.toString() === option.value)\n                                if (selectedContact) {\n                                  setEditedPurchase(prev => prev ? {\n                                    ...prev,\n                                    contact_id: selectedContact.id,\n                                    contact_name: selectedContact.contact_name,\n                                    vendor_contacts: [selectedContact, ...contacts.filter(c => c.id !== selectedContact.id)]\n                                  } : null)\n                                }\n                              } else {\n                                setEditedPurchase(prev => prev ? {\n                                  ...prev,\n                                  contact_id: undefined,\n                                  contact_name: undefined,\n                                  vendor_contacts: Array.isArray(editedPurchase.vendor_contacts) ? editedPurchase.vendor_contacts : []\n                                } : null)\n                              }\n                            }}\n                            placeholder=\" \"\n                            isClearable\n                            isSearchable\n                            noOptionsMessage={() => \" \"}\n                            menuPortalTarget={document.body}\n                            styles={{\n                              control: (base) => ({\n                                ...base,\n                                minHeight: '20px',\n                                height: '20px',\n                                fontSize: '10px',\n                                borderRadius: '8px', // rounded-lg  \n                                borderColor: '#e5e7eb', // border-gray-200  \n                                borderWidth: '1px',\n                                backgroundColor: '#ffffff',\n                                boxShadow: 'none',\n                                paddingLeft: '6px', // px-1.5\n                                paddingRight: '6px', // px-1.5\n                                '&:hover': {\n                                  borderColor: '#e5e7eb', // hover    \n                                },\n                                '&:focus-within': {\n                                  borderColor: '#60a5fa', // focus:border-blue-400\n                                  boxShadow: 'none',\n                                  outline: 'none',\n                                },\n                              }),\n                              valueContainer: (base) => ({\n                                ...base,\n                                height: '18px', // Input   \n                                padding: '0 2px', //   \n                                margin: '0',\n                              }),\n                              input: (base) => ({\n                                ...base,\n                                margin: '0',\n                                padding: '0',\n                                fontSize: '10px',\n                              }),\n                              indicatorsContainer: (base) => ({\n                                ...base,\n                                height: '18px',\n                                padding: '0',\n                              }),\n                              indicatorSeparator: () => ({\n                                display: 'none',\n                              }),\n                              dropdownIndicator: (base) => ({\n                                ...base,\n                                padding: '0 2px',\n                                svg: {\n                                  width: '12px',\n                                  height: '12px',\n                                },\n                              }),\n                              clearIndicator: (base) => ({\n                                ...base,\n                                padding: '0 2px',\n                                svg: {\n                                  width: '12px',\n                                  height: '12px',\n                                },\n                              }),\n                              option: (base) => ({\n                                ...base,\n                                fontSize: '10px',\n                                padding: '4px 8px',\n                              }),\n                              menuPortal: (base) => ({\n                                ...base,\n                                zIndex: 9999,\n                              }),\n                            }}\n                            classNamePrefix=\"contact-select\"\n                          />\n                        ) : (\n                          <Input\n                            value=\"\"\n                            disabled\n                            className=\"mt-1 rounded-lg border-gray-200 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                            placeholder=\"  \"\n                          />\n                        )\n                      ) : (\n                        <p className=\"modal-value\">{(() => {\n                          // : 1. contact_name , 2. vendor_contacts    , 3. '-'\n                          const contacts = Array.isArray(purchase.vendor_contacts) ? purchase.vendor_contacts : []\n                          const contactName = (purchase as any).contact_name ||\n                                            contacts[0]?.contact_name || \n                                            '-'\n                          logger.info(' vendor_contacts display :', { \n                            purchase_id: purchase?.id,\n                            vendor_id: purchase?.vendor_id,\n                            contact_id: purchase?.contact_id,\n                            vendor_contacts: purchase.vendor_contacts,\n                            purchase_contact_name: purchase.contact_name,\n                            contactName,\n                            purchase_full: purchase\n                          })\n                          console.log(' vendor_contacts display :', { \n                            purchase_id: purchase?.id,\n                            vendor_id: purchase?.vendor_id,\n                            contact_id: purchase?.contact_id,\n                            vendor_contacts: purchase.vendor_contacts,\n                            purchase_contact_name: purchase.contact_name,\n                            contactName\n                          })\n                          return contactName\n                        })()}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">PJ</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_vendor || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_vendor: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.project_vendor || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">Item</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_item || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_item: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p\n                          className=\"modal-subtitle break-all whitespace-pre-wrap\"\n                          style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-all' }}\n                        >\n                          {purchase.project_item || '-'}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\"></span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.sales_order_number || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, sales_order_number: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"\"\n                          disabled={canEditLimited && !canEditAll}\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle\">{purchase.sales_order_number || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/*   */}\n              {linkedStatements.length > 0 && (\n                <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm mt-3\">\n                  <div className=\"mb-2\">\n                    <h3 className=\"modal-section-title flex items-center\">\n                      <FileCheck className=\"w-4 h-4 mr-2 text-gray-600\" />\n                       \n                      <span className=\"ml-2 badge-stats bg-green-500 text-white text-[10px]\">\n                        {linkedStatements.length}\n                      </span>\n                    </h3>\n                  </div>\n                  <div className=\"space-y-2\">\n                    {linkedStatements.map((stmt) => (\n                      <div\n                        key={stmt.id}\n                        className=\"flex items-center justify-between p-2 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors\"\n                        onClick={() => handleViewStatementImage(stmt.image_url)}\n                      >\n                        <div className=\"flex items-center gap-2 min-w-0\">\n                          <ImageIcon className=\"w-4 h-4 text-gray-400 flex-shrink-0\" />\n                          <div className=\"min-w-0\">\n                            <p className=\"text-xs font-medium text-gray-900 truncate\">\n                              {stmt.vendor_name || stmt.file_name || ''}\n                            </p>\n                            <p className=\"text-[10px] text-gray-500\">\n                              {stmt.statement_date \n                                ? formatDate(stmt.statement_date)\n                                : formatDate(stmt.uploaded_at)\n                              }\n                              {stmt.grand_total && (\n                                <span className=\"ml-2 text-gray-700\">\n                                  {stmt.grand_total.toLocaleString()}\n                                </span>\n                              )}\n                            </p>\n                          </div>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          variant=\"ghost\"\n                          className=\"h-6 w-6 p-0 flex-shrink-0\"\n                          title=\" \"\n                        >\n                          <ImageIcon className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n            </div>\n\n            {/* Right Column - Items List (Fit Width) */}\n            <div className=\"lg:w-fit lg:min-w-0 relative overflow-visible\">\n              \n              <div className=\"bg-white rounded-lg border border-gray-100 shadow-sm\">\n                <div className=\"p-2 sm:p-3 bg-gray-50 border-b border-gray-100 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0\">\n                  <h3 className=\"modal-section-title flex items-center\">\n                    <Package className=\"w-4 h-4 mr-2 text-gray-600\" />\n                     \n                    <span className=\"ml-2 badge-stats bg-gray-500 text-white\">\n                      {currentItems?.length || 0}\n                    </span>\n                    {isEditing ? (\n                      <ReactSelect\n                        isDisabled={canEditLimited && !canEditAll}\n                        options={[\n                          { value: 'KRW', label: 'KRW' },\n                          { value: 'USD', label: 'USD' },\n                          { value: 'EUR', label: 'EUR' },\n                          { value: 'JPY', label: 'JPY' },\n                          { value: 'CNY', label: 'CNY' },\n                        ]}\n                        value={editedPurchase?.currency ? {\n                          value: editedPurchase.currency,\n                          label: editedPurchase.currency\n                        } : { value: 'KRW', label: 'KRW' }}\n                        onChange={(option) => {\n                          if (option) {\n                            setEditedPurchase(prev => prev ? { ...prev, currency: option.value as 'KRW' | 'USD' } : null)\n                          }\n                        }}\n                        menuPortalTarget={document.body}\n                        styles={{\n                          control: (base) => ({\n                            ...base,\n                            minHeight: '20px',\n                            height: '20px',\n                            width: '75px',\n                            fontSize: '10px',\n                            borderRadius: '8px',\n                            borderColor: '#e5e7eb',\n                            marginLeft: '8px',\n                          }),\n                          valueContainer: (base) => ({\n                            ...base,\n                            padding: '0 6px',\n                            height: '20px',\n                          }),\n                          singleValue: (base) => ({\n                            ...base,\n                            margin: 0,\n                            position: 'absolute',\n                            top: '50%',\n                            transform: 'translateY(-50%)',\n                          }),\n                          input: (base) => ({\n                            ...base,\n                            margin: 0,\n                            padding: 0,\n                          }),\n                          indicatorsContainer: (base) => ({\n                            ...base,\n                            height: '20px',\n                          }),\n                          indicatorSeparator: () => ({ display: 'none' }),\n                          dropdownIndicator: (base) => ({\n                            ...base,\n                            padding: '0 4px',\n                          }),\n                          option: (base) => ({\n                            ...base,\n                            fontSize: '10px',\n                            padding: '4px 8px',\n                          }),\n                          menuPortal: (base) => ({\n                            ...base,\n                            zIndex: 9999,\n                          }),\n                        }}\n                      />\n                    ) : (\n                      <span className=\"ml-2 badge-stats bg-blue-500 text-white\">\n                        {purchase.currency || 'KRW'}\n                      </span>\n                    )}\n                  </h3>\n                  {!isEditing && (\n                    <>\n                      {activeTab === 'purchase' && canPurchase && (\n                        <Button\n                          size=\"sm\"\n                          onClick={handleCompleteAllPayment}\n                          className=\"button-base bg-orange-500 hover:bg-orange-600 text-white\"\n                        >\n                          <CreditCard className=\"w-3 h-3 mr-1\" />\n                           \n                        </Button>\n                      )}\n                      {activeTab === 'receipt' && canReceiveItems && (\n                        <DateQuantityPickerPopover\n                          onConfirm={handleCompleteAllReceipt}\n                          placeholder=\" \"\n                          align=\"end\"\n                          side=\"bottom\"\n                          hideQuantityInput={true}\n                          quantityInfoText=\"   \"\n                        >\n                          <Button\n                            size=\"sm\"\n                            className=\"button-base button-action-primary\"\n                          >\n                            <Truck className=\"w-3 h-3 mr-1\" />\n                             \n                          </Button>\n                        </DateQuantityPickerPopover>\n                      )}\n                      {showStatementColumns && canReceiptCheck && canViewFinancialInfo && (\n                        <div className=\"flex items-center gap-2\">\n                          <DatePickerPopover\n                            onDateSelect={handleCompleteAllStatement}\n                            placeholder=\"   \"\n                            align=\"end\"\n                            side=\"bottom\"\n                          >\n                            <Button\n                              size=\"sm\"\n                              className=\"button-base button-action-primary\"\n                            >\n                              <FileText className=\"w-3 h-3 mr-1\" />\n                               \n                            </Button>\n                          </DatePickerPopover>\n                          {activeTab === 'done' && purchase.payment_category === '' && (\n                            <DateAmountPickerPopover\n                              onConfirm={handleBulkExpenditure}\n                              placeholder=\"    \"\n                              align=\"end\"\n                              side=\"bottom\"\n                            >\n                              <Button\n                                size=\"sm\"\n                                className=\"button-base button-action-primary\"\n                              >\n                                <DollarSign className=\"w-3 h-3 mr-1\" />\n                                \n                              </Button>\n                            </DateAmountPickerPopover>\n                          )}\n                        </div>\n                      )}\n                    </>\n                  )}\n                </div>\n                \n                {/* Mobile Table Header */}\n                <div className=\"block sm:hidden bg-gray-50 px-2 py-1 border-b border-gray-100\">\n                  <div className=\"text-xs font-medium text-gray-600\">  ( )</div>\n                </div>\n                \n                {/* Items List with Header Inside Scrollable Container */}\n                <div className=\"max-h-[50vh] sm:max-h-[40vh] overflow-auto\">\n                  <div className=\"w-fit\">\n                    {/* Items Table Header - Sticky inside scroll container */}\n                    <div className={`bg-gray-50 px-2 sm:px-3 py-1 border-b border-gray-100 sticky top-0 z-10 w-fit ${isEditing ? 'pl-7 sm:pl-8' : ''}`}>\n                      <div \n                        ref={headerRowRef}\n                         className=\"hidden sm:grid gap-1 modal-label w-fit\"\n                        style={{\n                          gridTemplateColumns: getGridTemplateColumns()\n                        }}\n                      >\n                        <div className=\"text-center -ml-2 sm:-ml-3\">#</div>\n                        <div></div>\n                        <div></div>\n                        <div className=\"text-center\">\n                          {(activeTab === 'receipt' || activeTab === 'done') && !isEditing ? (\n                            <div className=\"flex flex-col items-center leading-tight\">\n                              <div className=\"text-[9px]\">/</div>\n                              <div className=\"text-[10px]\"></div>\n                            </div>\n                          ) : (\n                            ''\n                          )}\n                        </div>\n                        <div className=\"text-right\"></div>\n                        <div className=\"text-right\"></div>\n                        {purchase.payment_category === '' && (\n                          <div className=\"text-right\"></div>\n                        )}\n                        <div className=\"text-center\"></div>\n                        <div className=\"text-center\"></div>\n                        {activeTab !== 'pending' && (\n                          isEditing ? (\n                            <>\n                              <div className=\"text-center\"></div>\n                              {activeTab === 'receipt' && (\n                                <>\n                                  <div className=\"text-center\"></div>\n                                </>\n                              )}\n                              {showStatementColumns && (\n                                <>\n                                  <div className=\"text-center\"> </div>\n                                  <div className=\"text-center\"> </div>\n                                  {showExpenditureColumn && <div className=\"text-center\"></div>}\n                                </>\n                              )}\n                            </>\n                          ) : (\n                            <>\n                              <div className=\"text-center\">\n                                {activeTab === 'purchase'\n                                  ? ''\n                                  : (activeTab === 'receipt' || activeTab === 'done')\n                                  ? ''\n                                  : ''}\n                              </div>\n                              {activeTab === 'receipt' && (\n                                <>\n                                  <div className=\"text-center\"></div>\n                                </>\n                              )}\n                              {showStatementColumns && (\n                                <>\n                                  <div className=\"text-center\"> </div>\n                                  <div className=\"text-center\"> </div>\n                                  {showExpenditureColumn && <div className=\"text-center\"></div>}\n                                </>\n                              )}\n                            </>\n                          )\n                        )}\n                      </div>\n                    </div>\n                    {isEditing && (\n                      <DndContext sensors={sensors} collisionDetection={closestCenter} onDragEnd={handleDragEnd}>\n                        <SortableContext\n                          items={sortableIds}\n                          strategy={verticalListSortingStrategy}\n                        >\n                          {(editedItems || []).map((item, index) => (\n                            <SortableRow key={getSortableId(item, index)} id={getSortableId(item, index)}>\n                              {(dragProps) => renderItemRow(item, index, dragProps, getSortableId(item, index))}\n                            </SortableRow>\n                          ))}\n                        </SortableContext>\n                      </DndContext>\n                    )}\n                    {!isEditing && (\n                    <div className=\"divide-y divide-gray-100 overflow-visible w-fit\">\n                      {(displayItems)?.map((item, index) => (\n                        renderItemRow(item, index, undefined, getSortableId(item, index))\n                      ))}\n                    </div>\n                    )}\n                </div>\n              </div>\n                \n                {/*  */}\n                <div className=\"bg-gray-50 px-2 sm:px-3 border-t border-gray-100\">\n                  <div className=\"hidden sm:grid items-center gap-1 py-2 w-fit\" style={{\n                    gridTemplateColumns: getGridTemplateColumns()\n                  }}>\n                    {/*  */}\n                    <div className=\"-ml-2 sm:-ml-3\"></div>\n                    {/*  */}\n                    <div></div>\n                    {/*  */}\n                    <div></div>\n                    {/*  */}\n                    <div></div>\n                    {/*   -   */}\n                    <div className=\"text-right flex items-center justify-end\">\n                      <span className=\"text-[11px] text-gray-600 font-medium\"></span>\n                    </div>\n                    {/*   -    */}\n                    <div className=\"text-right flex items-center justify-end\">\n                      <span className=\"text-[12px] font-bold text-gray-900\">\n                        {activeTab === 'done' && !canViewFinancialInfo \n                          ? '-' \n                          : `${(isEditing ? editedPurchase?.currency : purchase.currency) === 'USD' ? '$' : ''}${formatCurrency(\n                              (displayItems)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0\n                            )}`}\n                      </span>\n                    </div>\n                    {/*   ( ) */}\n                    {purchase.payment_category === '' && (\n                      <div className=\"text-right flex items-center justify-end\">\n                        {/*   -    */}\n                        <span className=\"text-[12px] font-bold text-gray-900\">\n                          {activeTab === 'done' && !canViewFinancialInfo \n                            ? '-' \n                            : `${(isEditing ? editedPurchase?.currency : purchase.currency) === 'USD' ? '$' : ''}${formatCurrency(\n                                (displayItems)?.reduce((sum, item) => sum + (item.tax_amount_value || 0), 0) || 0\n                              )}`}\n                        </span>\n                      </div>\n                    )}\n                    {/*  */}\n                    <div></div>\n                    {/*  */}\n                    <div></div>\n                    {/*    - pending  ,      */}\n                    {activeTab !== 'pending' && (\n                      isEditing ? (\n                        <div></div>\n                      ) : (\n                        <div className={activeTab === 'done' && purchase.payment_category === '' ? \"text-right flex items-center justify-end\" : \"\"}>\n                          {activeTab === 'done' && purchase.payment_category === '' && (\n                            <span className=\"text-[11px] text-gray-600 font-medium\"></span>\n                          )}\n                        </div>\n                      )\n                    )}\n                    {activeTab === 'receipt' && <div></div>}\n                    {activeTab === 'done' && (\n                      <>\n                        {/*   -      */}\n                        {purchase.payment_category === '' && (\n                          <>\n                            <div className=\"text-right flex items-center justify-end\">\n                              <div className=\"text-[12px] font-bold text-blue-700\">\n                                {!canViewFinancialInfo \n                                  ? '-' \n                                  : `${formatCurrency(\n                                      purchase.total_expenditure_amount ?? \n                                      ((isEditing ? editedItems : currentItems)?.reduce((sum: number, item: any) => {\n                                        return sum + (Number(item.expenditure_amount) || 0)\n                                      }, 0) || 0)\n                                    )}`}\n                              </div>\n                            </div>\n                            {/*    */}\n                            <div></div>\n                            {/*   */}\n                            <div></div>\n                          </>\n                        )}\n                      </>\n                    )}\n                  </div>\n\n                  {/* +  ( ) */}\n                  {purchase.payment_category === '' && (\n                    <div className=\"hidden sm:grid items-center gap-1 py-2 w-fit border-t border-gray-300\" style={{\n                      gridTemplateColumns: getGridTemplateColumns()\n                    }}>\n                      {/*  */}\n                      <div className=\"-ml-2 sm:-ml-3\"></div>\n                      {/*   */}\n                      <div></div>\n                      <div></div>\n                      <div></div>\n                      {/*   -  */}\n                      <div></div>\n                      {/*   -   */}\n                      <div className=\"text-right flex items-center justify-end\">\n                        <span className=\"text-[11px] text-gray-600 font-medium\"></span>\n                      </div>\n                      {/*   - +  */}\n                      <div className=\"text-right flex items-center justify-end\">\n                        <span className=\"text-[12px] font-bold text-blue-600\">\n                          {activeTab === 'done' && !canViewFinancialInfo \n                            ? '-' \n                            : `${formatCurrency(\n                                (isEditing ? editedItems : currentItems)?.reduce((sum, item) => {\n                                  const amount = item.amount_value || 0\n                                  const tax = item.tax_amount_value || 0\n                                  return sum + amount + tax\n                                }, 0) || 0\n                              )}`}\n                        </span>\n                      </div>\n                      {/*   -  */}\n                      <div></div>\n                      {/*    */}\n                      <div></div>\n                      {isEditing ? <div></div> : <div></div>}\n                      {activeTab === 'receipt' && <div></div>}\n                      {activeTab === 'done' && purchase.payment_category === '' && (\n                        <>\n                          {/*   */}\n                          <div></div>\n                          {/*    */}\n                          <div></div>\n                          {/*   */}\n                          <div></div>\n                        </>\n                      )}\n                    </div>\n                  )}\n                  \n                  {/* Mobile  */}\n                  <div className=\"block sm:hidden py-2 space-y-1\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-[12px] text-gray-500\"> </span>\n                      <span className=\"text-[13px] font-bold text-gray-900\">\n                        {activeTab === 'done' && !canViewFinancialInfo \n                          ? '-' \n                          : `${formatCurrency(\n                              (isEditing ? editedItems : currentItems)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0\n                            )}`}\n                      </span>\n                    </div>\n                    {/*  ( ) */}\n                    {purchase.payment_category === '' && (\n                      <>\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-[12px] text-gray-500\"> </span>\n                          <span className=\"text-[13px] font-bold text-gray-900\">\n                            {activeTab === 'done' && !canViewFinancialInfo \n                              ? '-' \n                              : `${formatCurrency(\n                                  (isEditing ? editedItems : currentItems)?.reduce((sum, item) => sum + (item.tax_amount_value || 0), 0) || 0\n                                )}`}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between items-center border-t pt-1\">\n                          <span className=\"text-[12px] text-gray-500\">+</span>\n                          <span className=\"text-[13px] font-bold text-blue-600\">\n                            {activeTab === 'done' && !canViewFinancialInfo \n                              ? '-' \n                              : `${formatCurrency(\n                                  (isEditing ? editedItems : currentItems)?.reduce((sum, item) => {\n                                    const amount = item.amount_value || 0\n                                    const tax = item.tax_amount_value || 0\n                                    return sum + amount + tax\n                                  }, 0) || 0\n                                )}`}\n                          </span>\n                        </div>\n                      </>\n                    )}\n                    {/* Mobile   -    */}\n                    {activeTab === 'done' && purchase.payment_category === '' && (\n                      <div className=\"flex justify-between items-center border-t pt-1\">\n                        <span className=\"text-[12px] text-gray-500\"> </span>\n                        <span className=\"text-[13px] font-bold text-blue-700\">\n                          {!canViewFinancialInfo \n                            ? '-' \n                            : `${formatCurrency(\n                                purchase.total_expenditure_amount ??\n                                ((isEditing ? editedItems : currentItems)?.reduce((sum: number, item: any) => {\n                                  return sum + (Number(item.expenditure_amount) || 0)\n                                }, 0) || 0)\n                              )}`}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                \n                {/*    */}\n                {isEditing && (\n                  <div className=\"p-2 sm:p-3 border-t border-gray-100\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={handleAddItem}\n                      className=\"w-full rounded-lg border-dashed border-2 border-gray-300 hover:border-gray-400 py-2 badge-text\"\n                    >\n                      <Plus className=\"w-4 h-4 mr-1\" />\n                       \n                    </Button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"text-center py-12\">\n          {loading ? (\n            <div className=\"flex items-center justify-center gap-2\">\n              <div className=\"w-5 h-5 border-2 border-gray-300 border-t-transparent rounded-full animate-spin\" />\n              <span className=\"modal-subtitle\"> ...</span>\n            </div>\n          ) : (\n            <div className=\"space-y-3\">\n              <span className=\"modal-subtitle\">\n                   .\n              </span>\n              {!embedded && (\n                <div>\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={onClose}\n                    className=\"button-base button-action-secondary\"\n                  >\n                    \n                  </Button>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n\n  // embedded true Dialog   \n  if (embedded) {\n    return content\n  }\n\n  // embedded false Dialog  \n  return (\n    <>\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent \n        className=\"overflow-hidden bg-white rounded-lg shadow-sm border-0 w-full sm:w-auto max-w-[calc(100vw-48px)] sm:max-w-[calc(100vw-80px)] lg:max-w-[90vw] xl:max-w-[85vw] h-[95vh] sm:h-auto sm:max-h-[90vh] lg:max-h-[85vh] sm:rounded-lg flex flex-col\" \n        showCloseButton={false}\n      >\n        <DialogHeader className=\"sr-only\">\n          <DialogTitle>  </DialogTitle>\n        </DialogHeader>\n        {/* Apple-style Header */}\n        <div className=\"relative px-3 sm:px-6 pt-0 sm:pt-3 lg:pt-4 pb-0 sm:pb-2 lg:pb-3 flex-shrink-0\">\n          <div className=\"absolute right-3 sm:right-6 top-3 sm:top-3 lg:top-4 flex items-center gap-2 z-10\">\n            {/*   (app_admin, final_approver, ceo, lead_buyer) */}\n            {!isEditing && canEdit && (\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => handleEditToggle(true)}\n                className=\"button-base button-action-secondary h-8 text-xs px-3\"\n              >\n                <Edit2 className=\"w-3.5 h-3.5 mr-1.5\" />\n                \n              </Button>\n            )}\n            \n            {/*   */}\n            {!isEditing && canDelete && onDelete && (\n              <Button\n                size=\"sm\"\n                variant=\"outline\"\n                onClick={() => {\n                  if (purchase) {\n                    //      (    )\n                    onDelete(purchase);\n                    //             \n                  }\n                }}\n                className=\"button-base button-action-danger h-8 text-xs px-3\"\n              >\n                <Trash2 className=\"w-3.5 h-3.5 mr-1.5\" />\n                \n              </Button>\n            )}\n            \n            {/*   ( ,    lead_buyer) */}\n            {!isAdmin && !isEditing && (\n              <Popover open={isModifyRequestOpen} onOpenChange={setIsModifyRequestOpen}>\n                <PopoverTrigger asChild>\n                  <Button \n                    variant=\"outline\" \n                    size=\"sm\" \n                    className=\"button-base button-action-secondary h-8 text-xs px-3 gap-1.5\"\n                    title=\" \"\n                  >\n                    <MessageSquarePlus className=\"w-3.5 h-3.5 text-gray-500\" />\n                    <span> </span>\n                  </Button>\n                </PopoverTrigger>\n                <PopoverContent \n                  className=\"w-80 sm:w-96 p-4\" \n                  align=\"end\"\n                  onOpenAutoFocus={(e) => e.preventDefault()}\n                >\n                  <div className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                      <h4 className=\"font-medium leading-none\"> </h4>\n                      <p className=\"text-xs text-muted-foreground\">\n                             .\n                      </p>\n                    </div>\n                    <div className=\"space-y-3\">\n                      <div className=\"space-y-1\">\n                        <Label htmlFor=\"subject\" className=\"text-xs\"></Label>\n                        <Input\n                          id=\"subject\"\n                          value={modifySubject}\n                          onChange={(e) => setModifySubject(e.target.value)}\n                          className=\"h-8 text-xs\"\n                          placeholder=\" \"\n                        />\n                      </div>\n                      <div className=\"space-y-1\">\n                        <Label htmlFor=\"message\" className=\"text-xs\"></Label>\n                        <div className=\"relative\" onWheel={(e) => e.stopPropagation()}>\n                          <Textarea\n                            id=\"message\"\n                            value={modifyMessage}\n                            onChange={(e) => setModifyMessage(e.target.value)}\n                            className=\"min-h-[150px] text-xs font-mono overflow-auto\"\n                            placeholder=\"  \"\n                            style={{ resize: 'none' }}\n                          />\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"flex justify-end gap-2\">\n                      <Button \n                        variant=\"outline\" \n                        size=\"sm\" \n                        onClick={() => setIsModifyRequestOpen(false)}\n                        className=\"h-8 text-xs\"\n                      >\n                        \n                      </Button>\n                      <Button \n                        size=\"sm\" \n                        onClick={handleSendModifyRequest}\n                        disabled={isSendingModify}\n                        className=\"h-8 text-xs bg-blue-600 hover:bg-blue-700\"\n                      >\n                        {isSendingModify ? ' ...' : ' '}\n                      </Button>\n                    </div>\n                  </div>\n                </PopoverContent>\n              </Popover>\n            )}\n            \n            <button\n              onClick={onClose}\n              className=\"button-base button-action-secondary w-8 h-8 rounded-full flex items-center justify-center\"\n            >\n              <X className=\"w-4 h-4 text-gray-500\" />\n            </button>\n          </div>\n          \n          <div className=\"pr-8 sm:pr-16\">\n            <div className=\"flex items-start gap-4 mb-0 sm:mb-3\">\n              <div className=\"min-w-0 flex-1\">\n                <h1 className=\"page-title mb-0 sm:mb-1\">\n                   \n                </h1>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                {isEditing && (\n                  <>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => {\n                        handleEditToggle(false)\n                        setEditedPurchase(purchase)\n                        setEditedItems(purchase?.items || [])\n                        setDeletedItemIds([])\n                      }}\n                      className=\"button-base button-action-secondary\"\n                    >\n                      <X className=\"w-4 h-4 mr-2\" />\n                      \n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      onClick={handleSave}\n                      disabled={isSaving}\n                      className=\"button-base button-action-primary\"\n                    >\n                      {isSaving ? (\n                        <>\n                          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                           ...\n                        </>\n                      ) : (\n                        <>\n                          <Save className=\"w-4 h-4 mr-2\" />\n                          \n                        </>\n                      )}\n                    </Button>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Apple-style Content */}\n        <div className=\"overflow-y-auto flex-1 px-3 sm:px-6 pb-1 sm:pb-6 mt-0\">\n          {content}\n        </div>\n      </DialogContent>\n      \n    </Dialog>\n\n    {/*    */}\n    <Dialog open={isStatementViewerOpen} onOpenChange={setIsStatementViewerOpen}>\n      <DialogContent className=\"max-w-[90vw] max-h-[90vh] p-0 bg-black/90 border-none\">\n        <div className=\"absolute top-4 right-4 z-50\">\n          <Button\n            size=\"sm\"\n            variant=\"ghost\"\n            onClick={() => setIsStatementViewerOpen(false)}\n            className=\"text-white hover:bg-white/20\"\n          >\n            <X className=\"w-5 h-5\" />\n          </Button>\n        </div>\n        <div className=\"flex items-center justify-center w-full h-[80vh] overflow-auto p-4\">\n          {selectedStatementImage && (\n            <img\n              src={selectedStatementImage}\n              alt=\"\"\n              className=\"max-w-full max-h-full object-contain\"\n            />\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n    </>\n  )\n}\n\nexport default memo(PurchaseDetailModal)"],"names":["DollarSign","createLucideIcon","x1","x2","y1","y2","key","d","GripVertical","cx","cy","r","MessageSquarePlus","Pen","Truck","ROOT_NAME","createAlertDialogContext","createAlertDialogScope","createContextScope","createDialogScope","useDialogScope","AlertDialog","props","__scopeAlertDialog","alertDialogProps","dialogScope","jsx","DialogPrimitive.Root","modal","displayName","React.forwardRef","forwardedRef","triggerProps","DialogPrimitive.Trigger","ref","AlertDialogPortal","portalProps","DialogPrimitive.Portal","AlertDialogOverlay","overlayProps","DialogPrimitive.Overlay","CONTENT_NAME","AlertDialogContentProvider","useAlertDialogContentContext","Slottable","createSlottable","AlertDialogContent","children","contentProps","contentRef","React.useRef","composedRefs","useComposedRefs","cancelRef","DialogPrimitive.WarningProvider","contentName","titleName","TITLE_NAME","docsSlug","scope","jsxs","DialogPrimitive.Content","role","onOpenAutoFocus","composeEventHandlers","event","preventDefault","current","focus","preventScroll","onPointerDownOutside","onInteractOutside","DescriptionWarning","AlertDialogTitle","titleProps","DialogPrimitive.Title","DESCRIPTION_NAME","AlertDialogDescription","descriptionProps","DialogPrimitive.Description","AlertDialogAction","actionProps","DialogPrimitive.Close","CANCEL_NAME","AlertDialogCancel","cancelProps","MESSAGE","React.useEffect","document","getElementById","getAttribute","Overlay2","Content2","Action","Cancel","Title2","Description2","className","AlertDialogPrimitive.Overlay","cn","AlertDialogPrimitive.Content","AlertDialogHeader","AlertDialogFooter","AlertDialogPrimitive.Title","AlertDialogPrimitive.Description","AlertDialogPrimitive.Action","buttonVariants","AlertDialogPrimitive.Cancel","variant","canUseDOM","window","createElement","isWindow","element","elementString","Object","prototype","toString","call","isNode","node","getWindow","target","_target$ownerDocument","_target$ownerDocument2","ownerDocument","defaultView","isDocument","Document","isHTMLElement","HTMLElement","isSVGElement","SVGElement","getOwnerDocument","useIsomorphicLayoutEffect","useLayoutEffect","useEffect","useEvent","handler","handlerRef","useRef","useCallback","_len","arguments","length","args","Array","_key","useLatestValue","value","dependencies","valueRef","useLazyMemo","callback","useMemo","newValue","useNodeRef","onChange","onChangeHandler","setNodeRef","usePrevious","ids","useUniqueId","prefix","id","createAdjustmentFn","modifier","object","adjustments","reduce","accumulator","adjustment","entries","valueAdjustment","add","subtract","isKeyboardEvent","KeyboardEvent","getEventCoordinates","TouchEvent","isTouchEvent","touches","clientX","x","clientY","y","changedTouches","hasViewportRelativeCoordinates","CSS","freeze","Translate","transform","Math","round","Scale","scaleX","scaleY","Transform","join","Transition","_ref","property","duration","easing","SELECTOR","findFirstFocusableNode","matches","querySelector","hiddenStyles","display","HiddenText","React","style","LiveRegion","announcement","ariaLiveType","position","top","left","width","height","margin","border","padding","overflow","clip","clipPath","whiteSpace","DndMonitorContext","createContext","defaultScreenReaderInstructions","draggable","defaultAnnouncements","onDragStart","active","onDragOver","_ref2","over","onDragEnd","_ref3","onDragCancel","_ref4","Accessibility","announcements","container","hiddenTextDescribedById","screenReaderInstructions","announce","setAnnouncement","useState","useAnnouncement","liveRegionId","mounted","setMounted","listener","registerListener","useContext","Error","useDndMonitor","onDragMove","_ref5","_ref6","markup","Fragment","createPortal","noop","defaultCoordinates","distanceBetween","p1","p2","sqrt","pow","sortCollisionsAsc","data","a","b","sortCollisionsDesc","centerOfRectangle","rect","closestCenter","collisionRect","droppableRects","droppableContainers","centerRect","collisions","droppableContainer","get","distBetween","push","sort","getIntersectionRatio","entry","max","right","min","bottom","targetArea","entryArea","intersectionArea","Number","toFixed","rectIntersection","intersectionRatio","getRectDelta","rect1","rect2","createRectAdjustmentFn","acc","getAdjustedRect","defaultOptions","ignoreTransform","getClientRect","options","getBoundingClientRect","transformOrigin","getComputedStyle","parsedTransform","startsWith","transformArray","slice","split","parseTransform","translateX","translateY","parseFloat","indexOf","w","h","inverseTransform","getTransformAgnosticClientRect","getScrollableAncestors","limit","scrollParents","findScrollableAncestors","scrollingElement","includes","computedStyle","overflowRegex","some","test","isScrollable","isFixed","parentNode","getFirstScrollableAncestor","firstScrollableAncestor","getScrollableElement","getScrollXCoordinate","scrollX","scrollLeft","getScrollYCoordinate","scrollY","scrollTop","getScrollCoordinates","Direction","isDocumentScrollingElement","getScrollPosition","scrollingContainer","minScroll","dimensions","innerHeight","innerWidth","clientHeight","clientWidth","maxScroll","scrollWidth","scrollHeight","isTop","isLeft","isBottom","isRight","defaultThreshold","getScrollDirectionAndSpeed","scrollContainer","scrollContainerRect","acceleration","thresholdPercentage","direction","speed","threshold","Backward","abs","Forward","getScrollElementRect","getScrollOffsets","scrollableAncestors","properties","Rect","constructor","this","scrollOffsets","axis","keys","getScrollOffset","defineProperty","currentOffsets","scrollOffsetsDeltla","enumerable","Listeners","listeners","removeAll","forEach","_this$target","removeEventListener","eventName","_this$target2","addEventListener","hasExceededDistance","delta","measurement","dx","dy","EventName","KeyboardCode","stopPropagation","defaultKeyboardCodes","start","Space","Enter","cancel","Esc","end","Tab","defaultKeyboardCoordinateGetter","currentCoordinates","code","Right","Left","Down","Up","KeyboardSensor","autoScrollEnabled","referenceCoordinates","windowListeners","handleKeyDown","bind","handleCancel","attach","handleStart","Resize","VisibilityChange","setTimeout","Keydown","activeNode","onStart","measure","scrollIntoView","block","inline","scrollIntoViewIfNeeded","context","keyboardCodes","coordinateGetter","scrollBehavior","handleEnd","newCoordinates","coordinatesDelta","scrollDelta","scrollElementRect","clampedCoordinates","canScrollX","canScrollY","newScrollCoordinates","canScrollToNewCoordinates","scrollTo","behavior","scrollBy","handleMove","coordinates","onMove","onEnd","detach","onCancel","isDistanceConstraint","constraint","Boolean","isDelayConstraint","activators","onActivation","nativeEvent","activator","activatorNode","AbstractPointerSensor","events","listenerTarget","_getEventCoordinates","EventTarget","getEventListenerTarget","activated","initialCoordinates","timeoutId","documentListeners","handleKeydown","removeTextSelection","activationConstraint","bypassActivationConstraint","move","name","passive","DragStart","ContextMenu","delay","handlePending","clearTimeout","offset","onPending","Click","capture","SelectionChange","_getEventCoordinates2","tolerance","distance","cancelable","onAbort","_this$document$getSel","getSelection","removeAllRanges","PointerSensor","super","isPrimary","button","events$1","MouseButton","RightClick","events$2","AutoScrollActivator","TraversalOrder","useAutoScroller","Pointer","canScroll","draggingRect","enabled","interval","order","TreeOrder","pointerCoordinates","scrollableAncestorRects","scrollIntent","disabled","previousDelta","previousIntent","defaultScrollIntent","sign","useScrollIntent","setAutoScrollInterval","clearAutoScrollInterval","intervalRef","setInterval","clearInterval","useInterval","scrollSpeed","scrollDirection","DraggableRect","scrollContainerRef","autoScroll","sortedScrollableAncestors","reverse","index","JSON","stringify","setup","MeasuringStrategy","MeasuringFrequency","defaultValue","Map","useInitialValue","computeFn","previousValue","useResizeObserver","handleResize","resizeObserver","ResizeObserver","disconnect","defaultMeasure","useRect","fallbackRect","setRect","measureRect","currentRect","isConnected","newRect","mutationObserver","handleMutations","MutationObserver","useMutationObserver","records","record","type","contains","observe","body","childList","subtree","defaultValue$1","useScrollOffsetsDelta","initialScrollOffsets","hasScrollOffsets","useWindowRect","getWindowClientRect","defaultValue$2","useDragOverlayMeasuring","handleNodeChange","firstChild","getMeasurableNode","nodeRef","setRef","defaultSensors","sensor","defaultData","defaultMeasuringConfiguration","droppable","strategy","WhileDragging","frequency","Optimized","dragOverlay","DroppableContainersMap","_super$get","toArray","from","values","getEnabled","filter","getNodeFor","_this$get$node$curren","_this$get","defaultPublicContext","activatorEvent","activeNodeRect","containerNodeRect","draggableNodes","measuringConfiguration","measureDroppableContainers","windowRect","measuringScheduled","defaultInternalContext","ariaDescribedById","dispatch","InternalContext","PublicContext","getInitialState","nodes","translate","containers","reducer","state","action","DragMove","DragEnd","DragCancel","RegisterDroppable","set","SetDroppableDisabled","UnregisterDroppable","delete","RestoreFocus","previousActivatorEvent","previousActiveId","activeElement","draggableNode","requestAnimationFrame","focusableNode","ActiveDraggableContext","Status","DndContext","memo","_sensorContext$curren","_dragOverlay$nodeRef$","_dragOverlay$rect","_over$rect","accessibility","sensors","collisionDetection","measuring","modifiers","store","useReducer","dispatchMonitorEvent","registerMonitorListener","Set","_listener$type","useDndMonitorProvider","status","setStatus","Uninitialized","isInitialized","Initialized","activeId","activeRects","initial","translated","_node$data","activeRef","activeSensor","setActiveSensor","setActivatorEvent","latestProps","draggableDescribedById","enabledDroppableContainers","config","dragging","queue","setQueue","containersRef","Always","BeforeDragging","isDisabled","disabledRef","concat","map","useDroppableMeasuring","cachedNode","useCachedNode","activationCoordinates","autoScrollOptions","activeSensorDisablesAutoscroll","autoScrollGloballyDisabled","getAutoScrollerOptions","initialActiveNodeRect","useInitialRect","initialRect","initialized","rectDelta","useLayoutShiftScrollCompensation","layoutShiftCompensation","parentElement","sensorContext","draggingNode","draggingNodeRect","scrollAdjustedTranslate","overNode","usesDragOverlay","nodeRectDelta","previousNode","ancestors","useScrollableAncestors","elements","firstElement","rects","setRects","measureRects","useRects","modifiedTranslate","applyModifiers","overlayNodeRect","scrollCoordinates","setScrollCoordinates","prevElements","handleScroll","previousElements","cleanup","scrollableElement","useScrollOffsets","scrollAdjustment","activeNodeScrollDelta","overId","firstCollision","getFirstCollision","setOver","adjustScale","activeSensorRef","instantiateSensor","Sensor","sensorInstance","onDragAbort","onDragPending","unstable_batchedUpdates","Initializing","createHandler","async","cancelDrop","Promise","resolve","getSyntheticHandler","useCombineActivators","activeDraggableNode","dndKit","defaultPrevented","activationContext","capturedBy","teardownFns","teardown","useSensorSetup","overContainer","publicContext","internalContext","Provider","restoreFocus","NullContext","defaultRole","useDraggable","attributes","roleDescription","tabIndex","isDragging","setActivatorNodeRef","useSyntheticListeners","dataRef","defaultResizeObserverConfig","timeout","arrayMove","array","to","newArray","splice","getSortedRects","items","isValidIndex","rectSortingStrategy","activeIndex","overIndex","newRects","oldRect","defaultScale$1","verticalListSortingStrategy","_rects$activeIndex","fallbackActiveRect","overIndexRect","itemGap","clientRects","previousRect","nextRect","getItemGap$1","ID_PREFIX","Context","containerId","disableTransforms","useDragOverlay","sortedRects","SortableContext","userDefinedItems","disabledProp","item","previousItemsRef","itemsHaveChanged","i","itemsEqual","normalizeDisabled","contextValue","defaultNewIndexGetter","defaultAnimateLayoutChanges","isSorting","wasDragging","newIndex","previousItems","previousContainerId","transition","defaultTransition","transitionProperty","disabledTransition","defaultAttributes","useSortable","animateLayoutChanges","userDefinedAttributes","localDisabled","customData","getNewIndex","localStrategy","resizeObserverConfig","globalDisabled","globalStrategy","_localDisabled$dragga","_localDisabled$droppa","normalizeLocalDisabled","sortable","itemsAfterCurrentSortable","isOver","setDroppableNodeRef","previous","resizeObserverConnected","callbackId","resizeObserverDisabled","updateMeasurementsFor","resizeObserverTimeout","isArray","newElement","previousElement","unobserve","useDroppable","setDraggableNodeRef","refs","useCombinedRefs","displaceItem","shouldDisplaceDragSource","dragSourceDisplacement","finalTransform","shouldAnimateLayoutChanges","derivedTransform","setDerivedtransform","previousIndex","useDerivedTransform","getTransition","DateAmountPickerPopover","onConfirm","placeholder","align","side","defaultDate","defaultAmount","open","setOpen","selectedDate","setSelectedDate","amount","setAmount","Popover","onOpenChange","PopoverTrigger","asChild","PopoverContent","sideOffset","Calendar","mode","selected","onSelect","locale","ko","initialFocus","fromDate","Date","toDate","defaultMonth","today","modifiersClassNames","Input","e","replace","numValue","parseInt","toLocaleString","Button","size","onClick","amountNum","isNaN","DateQuantityPickerPopover","defaultQuantity","maxQuantity","hideQuantityInput","quantityInfoText","quantity","setQuantity","quantityNum","useConfirmDateAction","currentUserName","canPerformAction","purchaseId","onUpdate","onOptimisticUpdate","supabase","createClient","handleConfirm","itemId","itemInfo","receivedQuantity","logger","warn","toast","error","field","numericId","confirmMessage","item_name","specification","unit_price_value","amount_value","remark","confirm","updateData","is_statement_received","statement_received_date","toISOString","statement_received_by_name","requestedQuantity","currentReceivedQuantity","received_quantity","newReceivedQuantity","totalReceivedQuantity","existingItem","select","eq","single","existingHistory","receipt_history","newHistoryItem","seq","qty","date","by","updatedHistory","isFullyReceived","actual_received_date","is_received","delivery_status","debug","historyCount","update","info","markItemAsReceived","markItemAsStatementReceived","success","successMessage","itemName","markItemAsReceiptCanceled","markItemAsStatementCanceled","isCompleted","isPartiallyReceived","receivedQty","requestedQty","getRemainingQuantity","getCompletedDate","getCompletedByName","DONE_TAB_COLUMNS","label","description","defaultVisible","DEFAULT_COLUMN_VISIBILITY","column","REQUIRED_COLUMNS","RESTRICTED_COLUMNS","AUTHORIZED_ROLES","COLUMN_GROUPS","title","columns","SortableRow","PurchaseDetailModal$1","isOpen","onClose","embedded","currentUserRoles","activeTab","onRefresh","onDelete","allPurchases","lastFetch","usePurchaseMemory","loading","setLoading","purchase","setPurchase","isEditing","setIsEditing","editedPurchase","setEditedPurchase","editedItems","setEditedItems","deletedItemIds","setDeletedItemIds","userRoles","setUserRoles","setCurrentUserName","columnWidths","setColumnWidths","focusedInput","setFocusedInput","vendors","setVendors","vendorSearchTerm","setVendorSearchTerm","isModifyRequestOpen","setIsModifyRequestOpen","modifySubject","setModifySubject","modifyMessage","setModifyMessage","isSendingModify","setIsSendingModify","isSaving","setIsSaving","linkedStatements","setLinkedStatements","isStatementViewerOpen","setIsStatementViewerOpen","selectedStatementImage","setSelectedStatementImage","useSensors","makeStableKey","idx","stableKey","tempId","line_number","normalizeItems","withTemp","getSortableId","handleDragEnd","prev","oldIndex","findIndex","purchase_order_number","isEditingRef","realtimeFirstMount","unsubscribe","addCacheListener","updatedPurchase","findPurchaseInMemory","cachedItems","purchase_request_items","prevPurchase","prevItems","mergedItems","String","is_po_generated","prevItemsRef","currentItems","result","memoryPurchase","find","p","memoryItems","displayItems","la","lb","ca","created_at","getTime","cb","ia","ib","ta","tb","sortableIds","columnGap","total","sum","baseColumns","headerRowRef","supabaseUrl","user","auth","getUser","employeeData","maybeSingle","email","employeeByEmail","purchase_role","roles","trim","loadUserRoles","vendorsData","ascending","loadVendors","effectiveRoles","canEditAll","canEditLimited","canEdit","canViewFinancialInfo","showStatementColumns","payment_category","showExpenditureColumn","canDelete","final_manager_status","requester_name","canPurchase","canReceiveItems","isAdmin","isRequester","canReceiptCheck","canProcessReceipt","refreshModalData","vendorContacts","vendor_id","allContacts","contact_id","currentContact","c","otherContacts","allContacts_count","contact","sortedItems","purchaseData","vendor","vendor_contacts","contact_name","vendorContacts_from_query","purchase_updated","has_vendor_contacts","normalizedItems","vendor_name","is_active","updated_at","isInitialLoad","setIsInitialLoad","purchaseIdNumber","NaN","handleActualReceiptOptimisticUpdate","itemIdStr","nowIso","selectedDateIso","updateItems","received_at","updatedItems","updatedRequestItems","completed","allReceived","handleStatementReceivedOptimisticUpdate","nextAllCompleted","nextStatementAt","every","statement_received_at","allCompleted","then","statementReceivedAction","completedText","waitingText","actualReceivedAction","canApproveMiddle","canApproveFinal","approvalButtonClass","approvalWaitingPillClass","loadPurchaseDetail","loadLinkedStatements","transactionStatementService","getStatementsByPurchaseId","calculateOptimalColumnWidths","columnConfigs","minWidth","maxWidth","baseWidth","calculatedWidths","maxLength","headers","statusHeader","quantityHeader","baseHeaders","receiptHeaders","doneHeaders","getHeaders","cellValue","tax_amount_value","getStatusDisplay","formatDate","expenditure_date","expenditure_amount","adjustedLength","char","ceil","calculatedWidth","is_payment_completed","getGridTemplateColumns","receiptColumns","doneColumns","hasItems","handleEditToggle","editing","formatCurrency","Intl","NumberFormat","format","handleItemChange","newItems","taxAmount","handlePaymentToggle","purchaseItems","requestItems","targetItem","unit","payment_completed_at","markItemAsPaymentCompleted","markItemAsPaymentCanceled","prevRequestItems","payment_completed_by_name","refreshResult","silent","handleItemReceiptToggle","currentItem","newReceivedQty","totalReceivedQty","deliveryStatus","handleApprove","approvalType","middle_manager_status","updatePurchaseInMemory","handleItemExpenditure","totalExpenditure","total_expenditure_amount","markItemAsExpenditureSet","renderItemRow","dragProps","rowKey","rowProps","gridTemplateColumns","onFocus","onBlur","wordBreak","overflowWrap","hyphens","WebkitHyphens","MozHyphens","msHyphens","lineHeight","maxHeight","WebkitLineClamp","WebkitBoxOrient","hasReceived","link","href","rel","boxSizing","_","it","handleRemoveItem","Trash2","toLocaleDateString","year","month","day","DatePickerPopover","onDateSelect","hasExpenditure","hasExpenditureAmount","getFullYear","getMonth","padStart","getDate","toLocaleTimeString","hour","minute","content","category","getStatusBadge","request_date","Check","X","FileText","newStatus","is_utk_checked","CheckCircle","request_type","delivery_request_date","formatDateInput","revised_delivery_request_date","Building2","ReactSelect","v","option","selectedVendor","contactsData","contactsCount","updated","updated_vendor_contacts","updated_full","isClearable","isSearchable","menuPortalTarget","styles","control","base","minHeight","fontSize","borderRadius","borderColor","borderWidth","backgroundColor","boxShadow","paddingLeft","paddingRight","outline","valueContainer","input","indicatorsContainer","indicatorSeparator","dropdownIndicator","svg","clearIndicator","menuPortal","zIndex","classNamePrefix","contacts","uniqueContacts","arr","finalUniqueContacts","vendor_contacts_raw","vendor_contacts_count","unique_by_id_count","final_unique_count","firstContact","selectedContact","noOptionsMessage","contactName","purchase_id","purchase_contact_name","purchase_full","project_vendor","project_item","sales_order_number","FileCheck","stmt","handleViewStatementImage","imageUrl","image_url","ImageIcon","file_name","statement_date","uploaded_at","grand_total","Package","currency","marginLeft","singleValue","allItems","pendingItems","CreditCard","applyOptimisticUpdate","itemReceivedQuantity","itemsError","in","requestError","markBulkExpenditureSet","newItem","lineNum","now","random","Plus","Dialog","DialogContent","showCloseButton","DialogHeader","DialogTitle","Edit2","Label","htmlFor","onWheel","Textarea","resize","insert","user_id","user_email","user_name","inquiry_type","subject","message","purchase_request_id","requester_id","purchase_info","total_amount","item_count","totalAmount","contactId","updateError","finalContactId","contactUpdateError","contact_email","contact_phone","prev_vendor_contacts","new_vendor_contacts","updated_purchase","newContact","contactInsertError","newContact_full","purchaseUpdateError","deleteError","requestDeleteError","removePurchaseFromMemory","unit_price_currency","amount_currency","insertData","insertedItem","itemIndex","sourceData","deletedCount","removeItemFromMemory","memoryUpdated","newTotalAmount","itemsCount","finalItems","originalItemsCount","finalItemsCount","deletedItemsCount","errorMessage","Loader2","Save","src","alt"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,7,8,9,10]}