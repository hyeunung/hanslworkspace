{"version":3,"mappings":";6ZAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,GAAa,CACjB,CACE,OACA,CACE,EAAG,mIACH,IAAK,QACX,CACA,EACE,CAAC,OAAQ,CAAE,EAAG,YAAa,IAAK,QAAQ,CAAE,CAC5C,EACMC,GAASC,GAAiB,SAAUF,EAAU,ECJhCG,OAAK,IAAAC,GAAA,IAAM,OAAO,gCAAc,2BAAC,EAOrD,SAAwBC,IAAkB,CACxC,MAAMC,EAAWC,GAAA,EACXC,EAAWC,GAAA,EAEX,CAACC,EAAMC,EAAO,EAAIC,WAAc,IAAI,EACpC,CAACC,EAAcC,CAAe,EAAIF,WAAiB,EAAE,EACrD,CAACG,GAAWC,CAAY,EAAIJ,WAAkI,EAAE,EAChK,CAACK,EAAwBC,CAAyB,EAAIN,WAAS,EAAK,EACpE,CAACO,EAAUC,EAAW,EAAIR,WAAS,CAAC,EACpC,CAACS,EAAkBC,CAAmB,EAAIV,WAAS,EAAE,EAG3DW,YAAU,IAAM,EACE,SAAY,CAC1B,KAAM,CAAE,KAAM,CAAE,KAAAb,IAAW,MAAMF,EAAS,KAAK,UAC/CG,GAAQD,CAAI,CACd,GACA,CACF,EAAG,EAAE,EAELa,YAAU,IAAM,EAEQ,SAAY,CAChC,GAAI,CACF,KAAM,CAAE,KAAAC,EAAM,MAAAC,GAAU,MAAMjB,EAC3B,KAAK,WAAW,EAChB,OAAO,uDAAuD,EAC9D,MAAM,MAAM,EAGf,GAAIgB,GAAQ,CAACC,GAASD,EAAK,OAAS,GAYlC,GAXAR,EAAaQ,EAAK,IAAIE,IAAU,CAC9B,GAAIA,EAAM,GACV,KAAMA,EAAM,KACZ,MAAOA,EAAM,OAAS,GACtB,MAAOA,EAAM,OAAS,GACtB,QAASA,EAAM,SAAW,GAC1B,SAAUA,EAAM,UAAY,GAC5B,WAAYA,EAAM,YAAc,IAChC,CAAC,EAGCb,GAAgB,CAACW,EAAK,QAAYG,EAAI,OAASd,CAAY,EAAG,CAEhE,MAAMe,EAAc,CAClB,GAAIlB,GAAM,IAAM,eAChB,KAAMG,EACN,MAAOH,GAAM,OAAS,GACtB,MAAO,GACP,QAAS,GACT,SAAU,GACV,WAAY,IAEdM,EAAa,CAAC,GAAGQ,EAAK,IAAIE,IAAU,CAClC,GAAIA,EAAM,GACV,KAAMA,EAAM,KACZ,MAAOA,EAAM,OAAS,GACtB,MAAOA,EAAM,OAAS,GACtB,QAASA,EAAM,SAAW,GAC1B,SAAUA,EAAM,UAAY,GAC5B,WAAYA,EAAM,YAAc,IAChC,EAAGE,CAAW,CAAC,CACnB,OAIEZ,EADEH,EACW,CAAC,CACZ,GAAIH,GAAM,IAAM,eAChB,KAAMG,EACN,MAAOH,GAAM,OAAS,GACtB,MAAO,GACP,QAAS,GACT,SAAU,GACV,WAAY,GACb,EAEY,EAFX,CAKR,MAAc,CAGVM,EADEH,EACW,CAAC,CACZ,GAAIH,GAAM,IAAM,eAChB,KAAMG,EACN,MAAOH,GAAM,OAAS,GACtB,MAAO,GACP,QAAS,GACT,SAAU,GACV,WAAY,GACb,EAEY,EAFX,CAIN,CACF,GAGA,CACF,EAAG,CAACG,EAAcH,CAAI,CAAC,EAEvB,KAAM,CAACmB,GAASC,EAAU,EAAIlB,WAAgD,EAAE,EAC1E,CAACmB,EAAUC,CAAW,EAAIpB,WAAiH,EAAE,EAC7I,CAACqB,GAAQC,CAAS,EAAItB,WAAS,EAAE,EACjC,CAACuB,GAAkBC,EAAmB,EAAIxB,WAAmB,EAAE,EAC/D,CAACyB,EAAUC,CAAW,EAAI1B,WAAS,KAAK,EACxC,CAAC2B,EAASC,CAAU,EAAI5B,WAAS,EAAK,EACtC,CAACa,EAAOgB,CAAQ,EAAI7B,WAAS,EAAE,EAC/B,CAAC8B,GAAaC,EAAc,EAAI/B,WAAkC,EAAE,EACpE,CAACgC,GAAqBC,CAAsB,EAAIjC,WAAS,EAAK,EAC9D,CAACkC,EAAiBC,CAAkB,EAAInC,WAAmI,EAAE,EAC7K,CAACoC,GAAYC,CAAa,EAAIrC,WAAS,EAAK,EAE5CsC,EAAkBC,SAAO,EAAK,EAE9B,CAAE,QAAAC,EAAS,aAAcC,GAAgB,MAAAC,EAAO,SAAAC,EAAU,MAAAC,GAAO,UAAAC,EAAA,EAAcC,GAAsB,CACzG,cAAe,CACb,cAAe,GACf,iBAAkB,GAClB,SAAU,MACV,iBAAkB,KAClB,aAAc,GACd,SAAU,GACV,mBAAoB,GACpB,eAAgB,GAChB,aAAc,GACd,sBAAuB,GACvB,UAAW,EACX,eAAgB,GAChB,MAAO,CACL,CACE,YAAa,EACb,UAAW,GACX,cAAe,GACf,SAAU,EACV,iBAAkB,EAClB,oBAAqB,MACrB,aAAc,EACd,gBAAiB,MACjB,OAAQ,GACR,KAAM,GACR,EAEF,iBAAkB,OAAO,cAAc,MAAM,EAAG,EAAE,EACpD,CACD,EAEK,CAAE,OAAAC,EAAQ,OAAAC,GAAQ,OAAAC,GAAQ,OAAAC,CAAA,EAAWC,GAAc,CACvD,QAAAX,EACA,KAAM,QACP,EAGD7B,YAAU,IAAM,CACd,GAAI,CAACb,GAAM,OAASO,EAAwB,QAEvB,SAAY,CAC/B,KAAM,CAAE,KAAM+C,CAAA,EAAY,MAAMxD,EAC7B,KAAK,WAAW,EAChB,OAAO,MAAM,EACb,GAAG,QAASE,EAAK,KAAK,EACtB,SAECsD,GAAS,OACXlD,EAAgBkD,EAAQ,IAAI,EAC5BT,EAAS,iBAAkBS,EAAQ,IAAI,EACvC9C,EAA0B,EAAI,EAElC,GACA,CACF,EAAG,CAACR,EAAMF,EAAU+C,EAAUtC,CAAsB,CAAC,EAGrDM,YAAU,IAAM,EACc,SAAY,CACtC,GAAIb,GAAM,OAAS6C,GAAY,CAACtC,EAC9B,GAAI,CACF,KAAM,CAAE,KAAMgD,EAAc,MAAAxC,GAAU,MAAMjB,EACzC,KAAK,WAAW,EAChB,OAAO,MAAM,EACb,GAAG,QAASE,EAAK,KAAK,EACtB,SAEH,GAAIuD,GAAgB,CAACxC,EACnBX,EAAgBmD,EAAa,IAAI,EAEjC,WAAW,IAAM,CACfV,EAAS,iBAAkBU,EAAa,KAAM,CAC5C,eAAgB,GAChB,YAAa,GACd,CACH,EAAG,GAAG,EACN/C,EAA0B,EAAI,MACzB,CACL,MAAMgD,EAAexD,EAAK,MAAM,MAAM,GAAG,EAAE,CAAC,GAAK,MACjDI,EAAgBoD,CAAY,EAC5B,WAAW,IAAM,CACfX,EAAS,iBAAkBW,EAAc,CACvC,eAAgB,GAChB,YAAa,GACd,CACH,EAAG,GAAG,EACNhD,EAA0B,EAAI,CAChC,CACF,MAAc,CACZ,MAAMgD,EAAexD,EAAK,OAAO,MAAM,GAAG,EAAE,CAAC,GAAK,MAClDI,EAAgBoD,CAAY,EAC5B,WAAW,IAAM,CACfX,EAAS,iBAAkBW,EAAc,CACvC,eAAgB,GAChB,YAAa,GACd,CACH,EAAG,GAAG,EACNhD,EAA0B,EAAI,CAChC,CAEJ,GAEA,CACF,EAAG,CAACR,EAAM6C,EAAUtC,CAAsB,CAAC,EAG3CM,YAAU,IAAM,EACM,SAAY,CAC9B,GAAI,CACF,KAAM,CAAE,KAAAC,EAAM,MAAAC,GAAU,MAAMjB,EAC3B,KAAK,SAAS,EACd,OAAO,GAAG,EACV,MAAM,aAAa,EAEtB,GAAIiB,EAAO,MAAMA,EACjBK,GAAWN,GAAQ,EAAE,CACvB,MAAgB,CACd2C,EAAM,MAAM,oBAAoB,CAClC,CACF,GAEA,CACF,EAAG,EAAE,EAEL,MAAMC,EAAiBd,EAAM,WAAW,EAGxC/B,YAAU,IAAM,EACO,SAAY,CAC/B,GAAI6C,EACF,GAAI,CACF,KAAM,CAAE,KAAA5C,EAAM,MAAAC,GAAU,MAAMjB,EAC3B,KAAK,iBAAiB,EACtB,OAAO,0DAA0D,EACjE,GAAG,YAAa4D,CAAc,EAEjC,GAAI3C,EAAO,MAAMA,EACjBO,EAAYR,GAAQ,EAAE,CACxB,MAAgB,CACdQ,EAAY,EAAE,CAChB,MAEAA,EAAY,EAAE,CAElB,GAEA,CACF,EAAG,CAACoC,CAAc,CAAC,EAGnB7C,YAAU,IAAM,CAEd,MAAM8C,EADQZ,GAAU,OAAO,EACJ,IAAIa,IAAS,CACtC,GAAGA,EACH,oBAAqBjC,EACrB,gBAAiBA,CAAA,EACjB,EACFkB,EAAS,QAASc,CAAY,EAC9B/B,EAAYD,CAAQ,CACtB,EAAG,CAACA,EAAUkB,EAAUE,EAAS,CAAC,EAGlClC,YAAU,IAAM,CACdoC,EAAO,QAAQ,CAACW,EAAMC,IAAQ,CAC5B,MAAMC,EAAa,OAAOF,EAAK,QAAQ,EAAI,OAAOA,EAAK,gBAAgB,EACnEA,EAAK,eAAiBE,GACxBV,EAAOS,EAAK,CAAE,GAAGD,EAAM,aAAcE,EAAY,CAErD,CAAC,CAEH,EAAG,CAACb,EAAO,IAAIc,GAAK,GAAGA,EAAE,QAAQ,IAAIA,EAAE,gBAAgB,EAAE,EAAE,KAAK,GAAG,CAAC,CAAC,EAsCrE,MAAMC,GAAsB,IAAM,CAChC,MAAMC,EAAcrB,EAAM,cAAc,EAClCsB,EAAetB,EAAM,eAAe,EACpCuB,EAAkBvB,EAAM,kBAAkB,EAC1CwB,EAAWxB,EAAM,WAAW,EAElC,MAAO,CAAC,EAAEqB,GAAeC,GAAgBC,GAAmBC,GAAYA,IAAa,GAAKnB,EAAO,OAAS,EAC5G,EAGM,CAACoB,GAAaC,EAAc,EAAIpE,WAAS,EAAK,EAGpDW,YAAU,IAAM,CACdyD,GAAeN,IAAqB,CACtC,EAAG,CAACpB,EAAM,cAAc,EAAGA,EAAM,eAAe,EAAGA,EAAM,kBAAkB,EAAGA,EAAM,WAAW,EAAGK,CAAM,CAAC,EAGzG,MAAMsB,GAA8B,SAAY,CAC9C,MAAMC,MAAY,KAIZC,EAAS,IAFG,IAAI,KAAKD,EAAM,UAAa,IAAS,GAAK,GAAK,EACvC,cAAc,MAAM,EAAG,EAAE,EAAE,QAAQ,KAAM,EAAE,CAC3C,IAGpB,CAAE,KAAME,EAAgB,MAAOC,CAAA,EAAe,MAAM7E,EACvD,KAAK,mBAAmB,EACxB,OAAO,uBAAuB,EAC9B,KAAK,wBAAyB,GAAG2E,CAAM,GAAG,EAC1C,MAAM,wBAAyB,CAAE,UAAW,GAAO,EAMtD,IAAIG,EAAa,EACbC,EAAc,EAElB,GAAIH,GAAkBA,EAAe,OAAS,EAAG,CAE/C,UAAWI,MAASJ,EAAgB,CAIlC,MAAMK,GAHcD,GAAM,sBAGA,MAAM,GAAG,EACnC,GAAIC,GAAM,QAAU,EAAG,CACrB,MAAMC,GAAcD,GAAM,CAAC,EACrBE,EAAW,SAASD,GAAa,EAAE,EAGrC,CAAC,MAAMC,CAAQ,GAAKA,EAAWJ,IACjCA,EAAcI,EAElB,CACF,CAEAL,EAAaC,EAAc,CAC7B,CAGA,MAAMK,EAAiB,MAAMN,CAAU,EAAI,EAAIA,EAG/C,MAF4B,GAAGH,CAAM,GAAG,OAAOS,CAAc,EAAE,SAAS,EAAG,GAAG,CAAC,EAGjF,EAGMC,GAAe,MAAOrE,GAAqB,CAC/C,MAAMsE,EAAkB/E,GAAU,QAAYY,EAAI,OAASH,EAAK,cAAc,EAE9E,GAAI,CAAA0B,EAAgB,QAIpB,IAAI,CAAC4C,EAAiB,CACpBrD,EAAS,2CAA2C,EACpD,MACF,CAGA,GAAKiC,KAIL,CAAAxB,EAAgB,QAAU,GAC1BV,EAAW,EAAI,EACfC,EAAS,EAAE,EAEX,GAAI,CAEF,IAAIsD,EAAe,EACfC,EAA8B,GAClC,MAAMC,EAAa,EACnB,IAAIC,EAAa,EAGjB,KAAOA,EAAaD,GAClB,GAAI,CAEFD,EAAsB,MAAMf,GAAA,EAG5B,KAAM,CAAE,KAAMkB,EAAI,MAAOC,CAAA,EAAY,MAAM5F,EAAS,KAAK,mBAAmB,EAAE,OAAO,CACnF,aAAcsF,EAAgB,GAC9B,sBAAuBE,EACvB,eAAgBxE,EAAK,eACrB,gBAAiBsE,GAAiB,MAClC,cAAe,KACf,kBAAmBA,GAAiB,QACpC,UAAWtE,EAAK,UAChB,mBAAoBA,EAAK,mBACzB,eAAgBA,EAAK,eACrB,aAAcA,EAAK,aACnB,aAAcA,EAAK,aACnB,sBAAuBA,EAAK,uBAAyB,KACrD,aAAcA,EAAK,aACnB,cAAeA,EAAK,cACpB,qBAAsB,GACtB,iBAAkBA,EAAK,iBACvB,SAAAa,EACA,aAAcsB,EAAO,OAAO,CAAC0C,EAAKC,KAAMD,EAAMC,GAAE,aAAc,CAAC,EAC/D,oBAAqB3C,EAAO,CAAC,GAAG,qBAAuBtB,EACvD,iBAAkBb,EAAK,iBACvB,WAAYA,EAAK,WAAa,OAAOA,EAAK,UAAU,EAAI,KACzD,EAAE,OAAO,IAAI,EAAE,SAGhB,GAAI4E,GAAW,CAACA,EAAQ,QAAQ,SAAS,gDAAgD,EACvF,MAAMA,EAIR,GAAIA,GAAWA,EAAQ,QAAQ,SAAS,gDAAgD,EAAG,CAEzF,GADAF,IACIA,GAAcD,EAChB,MAAM,IAAI,MAAM,cAAcA,CAAU,2BAA2B,EAGrE,MAAM,IAAI,QAAQM,GAAW,WAAWA,EAAS,IAAM,KAAK,SAAW,GAAG,CAAC,EAC3E,QACF,CAGA,GAAI,CAACJ,EAAI,MAAM,IAAI,MAAM,OAAO,EAChCJ,EAAOI,EAAG,GACV,KAEF,OAASK,EAAiB,CAExB,GAAI,CAACA,EAAW,QAAQ,SAAS,gDAAgD,EAC/E,MAAMA,EAIR,GADAN,IACIA,GAAcD,EAChB,MAAM,IAAI,MAAM,cAAcA,CAAU,2BAA2B,EAIrE,MAAM,IAAI,QAAQM,GAAW,WAAWA,EAAS,IAAM,KAAK,SAAW,GAAG,CAAC,CAC7E,CAIF,SAAW,CAAChC,EAAKD,CAAI,IAAKX,EAAO,UAAW,CAC1C,KAAM,CAAE,MAAO8C,GAAY,MAAMjG,EAAS,KAAK,wBAAwB,EAAE,OAAO,CAC9E,oBAAqBuF,EACrB,YAAaxB,EAAM,EACnB,UAAWD,EAAK,UAChB,cAAeA,EAAK,cACpB,SAAUA,EAAK,SACf,iBAAkBA,EAAK,iBACvB,oBAAqBjC,EACrB,aAAciC,EAAK,aACnB,gBAAiBjC,EACjB,OAAQiC,EAAK,OACb,KAAMA,EAAK,MAAQ,KACpB,EACD,GAAImC,EAAS,MAAMA,CACrB,CAKA,GAAI,CACF,MAAMC,EAAiB,MAAM,MAAM,iBAAiBX,CAAI,yBAA0B,CAChF,OAAQ,OACR,QAAS,CACP,eAAgB,mBAClB,CACD,EAED,GAAIW,EAAe,GAAI,CACrB,MAAMC,EAAe,MAAMD,EAAe,MAC5C,KAAO,CACL,MAAME,EAAY,MAAMF,EAAe,MACzC,CACF,MAAsB,CACtB,CAGAlD,GAAM,CACJ,cAAe,GACf,iBAAkB,GAClB,SAAU,MACV,iBAAkB,KAClB,aAAc,GACd,SAAU,GACV,mBAAoB,GACpB,eAAgB,GAChB,aAAc,GACd,sBAAuB,GACvB,UAAW,EACX,eAAgB3C,EAChB,MAAO,CACL,CACE,YAAa,EACb,UAAW,GACX,cAAe,GACf,SAAU,EACV,iBAAkB,EAClB,oBAAqB,MACrB,aAAc,EACd,gBAAiB,MACjB,OAAQ,GACR,KAAM,GACR,EAEF,iBAAkB,OAAO,cAAc,MAAM,EAAG,EAAE,EACnD,EAGDqB,EAAU,EAAE,EACZE,GAAoB,EAAE,EACtBE,EAAY,KAAK,EACjBG,EAAS,EAAE,EACXD,EAAW,EAAK,EAGhB2B,EAAM,QAAQ,uBAAuB,EAGrC,GAAI,CACF,MAAM7D,EAAS,gBAAgB,CACjC,MAAsB,CAEpB,OAAO,SAAS,KAAO,gBACzB,CACA,MACF,OAASuG,EAAU,CACjBpE,EAASoE,EAAI,SAAW,aAAa,EACrC1C,EAAM,MAAM0C,EAAI,SAAW,mBAAmB,CAChD,SAEErE,EAAW,EAAK,EAChBU,EAAgB,QAAU,EAC5B,GACF,EAEM4D,GAAcnD,EAAO,OAAO,CAAC0C,EAAK/B,IAAS+B,EAAM/B,EAAK,aAAc,CAAC,EAErEyC,GAAsB,IAAM,CAEhC,MAAMC,EAAmBjF,EAAS,IAAIkF,IAAM,CAAE,GAAGA,EAAG,MAAO,IAAQ,EAC7DC,EAAkB,CAAE,aAAc,GAAI,cAAe,GAAI,cAAe,GAAI,SAAU,GAAI,MAAO,IACvGnE,EAAmB,CAAC,GAAGiE,EAAkBE,CAAe,CAAC,EACzDjE,EAAc,EAAK,EACnBJ,EAAuB,EAAI,CAC7B,EAEMsE,EAAsB,CAACC,EAAeC,EAAeC,IAAkB,CAC3EvE,KAA2BwE,EAAK,IAAI,CAACC,EAASlB,IAC5CA,IAAMc,EAAQ,CAAE,GAAGI,EAAS,CAACH,CAAK,EAAGC,GAAUE,CAAA,CAChD,EACDvE,EAAc,EAAI,CACpB,EAEMwE,GAAoB,IAAM,CAC9B1E,KAA2B,CAAC,GAAGwE,EAAM,CAAE,aAAc,GAAI,cAAe,GAAI,cAAe,GAAI,SAAU,GAAI,MAAO,GAAM,CAAC,EAC3HtE,EAAc,EAAI,CACpB,EAEMyE,GAAqBN,GAAkB,CAC3CrE,EAAmBwE,GAAQA,EAAK,OAAO,CAACI,EAAGrB,IAAMA,IAAMc,CAAK,CAAC,EAC7DnE,EAAc,EAAI,CACpB,EAEM2E,GAAwB,SAAY,CACxC,GAAKxD,EAEL,GAAI,CAGF,GADoBtB,EAAgB,OAAOmE,GAAKA,EAAE,eAAiBA,EAAE,cAAc,SAAS,WAAW,CAAC,EACxF,OAAS,EAAG,CAC1B,MAAM,gCAAgC,EACtC,MACF,CAEA,UAAWO,KAAW1E,EAChB0E,EAAQ,cAAgBA,EAAQ,gBAC9B,CAACA,EAAQ,OAASA,EAAQ,GAE5B,MAAMhH,EACH,KAAK,iBAAiB,EACtB,OAAO,CACN,aAAcgH,EAAQ,aACtB,cAAeA,EAAQ,cACvB,cAAeA,EAAQ,eAAiB,GACxC,SAAUA,EAAQ,UAAY,GAC/B,EACA,GAAG,KAAMA,EAAQ,EAAE,EACbA,EAAQ,OAEjB,MAAMhH,EACH,KAAK,iBAAiB,EACtB,OAAO,CACN,UAAW4D,EACX,aAAcoD,EAAQ,aACtB,cAAeA,EAAQ,cACvB,cAAeA,EAAQ,eAAiB,GACxC,SAAUA,EAAQ,UAAY,GAC/B,GAMT,KAAM,CAAE,KAAAhG,CAAA,EAAS,MAAMhB,EACpB,KAAK,iBAAiB,EACtB,OAAO,0DAA0D,EACjE,GAAG,YAAa4D,CAAc,EAE7B5C,KAAkBA,CAAI,EAC1BqB,EAAuB,EAAK,EAC5BsB,EAAM,QAAQ,kBAAkB,CAClC,MAAgB,CACdA,EAAM,MAAM,iBAAiB,CAC/B,CACF,EAwBMU,GAAkBvB,EAAM,kBAAkB,EAEhD,OACEuE,OAAC,QACC,SAAWC,GAAM,CACfA,EAAE,iBACFzE,GAAewC,EAAY,EAAEiC,CAAC,CAChC,EACA,UAAWA,GAAK,EACVA,EAAE,MAAQ,SAAWA,EAAE,UAAY,KACrCA,EAAE,gBAEN,EAEA,UAAAD,OAAC,OAAI,UAAU,aAEb,UAAAA,OAAC,OAAI,UAAU,0EACb,UAAAA,OAAC,OAAI,UAAU,wDACb,UAAAE,MAAC,OAAI,UAAU,gBACb,SAAAA,MAAC,MAAG,UAAU,wCAAwC,sBAAU,EAClE,EACAF,OAAC,OAAI,UAAU,4BACb,UAAAA,OAACG,EAAA,CAAM,UAAU,qBAAqB,qBAAQD,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EAC1FA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,mBACL,OAAQ,CAAC,CAAE,MAAAiE,KACTQ,OAACK,EAAA,CAAO,MAAOb,EAAM,MAAO,cAAeA,EAAM,SAC/C,UAAAU,MAACI,GAAc,UAAU,8DACvB,eAACC,EAAA,CAAY,YAAY,QAAQ,EACnC,SACCC,EAAA,CACC,UAAAN,MAACO,EAAA,CAAW,MAAM,KAAK,cAAE,EACzBP,MAACO,EAAA,CAAW,MAAM,MAAM,eAAG,EAC3BP,MAACO,EAAA,CAAW,MAAM,MAAM,eAAG,EAC3BP,MAACO,EAAA,CAAW,MAAM,KAAK,cAAE,GAC3B,GACF,GAEJ,EACF,GACF,SAGC,OACC,UAAAT,OAACG,EAAA,CAAM,UAAU,qBAAqB,kBAAKD,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EACvFA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,iBACL,OAAQ,CAAC,CAAE,MAAAiE,CAAA,IACTU,MAACQ,EAAA,CACE,GAAGlB,EACJ,MAAOA,EAAM,OAASxG,GAAgB,GACtC,UAAU,8CACV,YAAY,WACZ,SAAQ,IACV,EAEJ,EACF,SAGC,OACC,UAAAgH,OAACG,EAAA,CAAM,UAAU,qBAAqB,kBAAKD,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EACvFA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,YACL,OAAQ,CAAC,CAAE,MAAAiE,KAAY,CACrB,MAAMmB,EAAkB3G,GAAQ,OAAO4G,GACrCA,EAAE,YAAY,cAAc,SAASpH,EAAiB,aAAa,GAGrE,OACE0G,MAAC,OAAI,UAAU,WACb,SAAAF,OAACK,EAAA,CACC,MAAOb,EAAM,OAAO,WACpB,cAAgBC,GAAU,CACxBD,EAAM,SAAS,OAAOC,CAAK,CAAC,EAC5BpF,EAAUoF,CAAK,EACf/D,EAAS,YAAa,OAAO+D,CAAK,CAAC,EACnChG,EAAoB,EAAE,CACxB,EAEA,UAAAyG,MAACI,GAAc,UAAU,8CACvB,eAACC,EAAA,CAAY,YAAY,QAAQ,EACnC,SACCC,EAAA,CACC,UAAAN,MAAC,OAAI,UAAU,MAAM,QAAUD,GAAMA,EAAE,kBACrC,SAAAC,MAACQ,EAAA,CACC,YAAY,WACZ,MAAOlH,EACP,SAAWyG,GAAMxG,EAAoBwG,EAAE,OAAO,KAAK,EACnD,UAAYA,GAAMA,EAAE,kBACpB,UAAU,mBACV,UAAS,KAEb,EACCU,EAAgB,SAAW,EAC1BT,MAAC,OAAI,UAAU,yCAAyC,uBAExD,EAEAS,EAAgB,IAAKvG,GACnB8F,MAACO,EAAA,CAA2B,MAAOrG,EAAO,GAAG,WAAY,UAAU,UAChE,SAAAA,EAAO,aADOA,EAAO,EAExB,CACD,GAEL,KAEJ,CAEJ,GACF,EACF,EAGCmC,EAAiB,GAChByD,OAAC,OACC,UAAAA,OAAC,OAAI,UAAU,yCACb,UAAAE,MAACC,EAAA,CAAM,UAAU,gBAAgB,eAAG,EACpCH,OAACa,EAAA,CACC,KAAK,SACL,QAAS3B,GACT,QAAQ,QACR,KAAK,KACL,UAAU,mBAEV,UAAAgB,MAAC9H,GAAA,CAAO,UAAU,eAAe,EAAE,OAErC,EACF,EACC8B,EAAS,OAAS,EACjBgG,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,aACL,OAAQ,CAAC,CAAE,MAAAiE,KACTQ,OAACK,EAAA,CAAO,MAAOb,EAAM,OAAO,WAAY,cAAgBC,GAAUD,EAAM,SAAS,OAAOC,CAAK,CAAC,EAC5F,UAAAS,MAACI,GAAc,UAAU,8CACvB,eAACC,EAAA,CAAY,YAAY,SAAS,EACpC,EACAL,MAACM,EAAA,CACE,SAAAtG,EAAS,IAAKyF,GACbK,OAACS,EAAA,CAA4B,MAAOd,EAAQ,GAAG,WAC5C,UAAAA,EAAQ,aAAa,KAAGA,EAAQ,SAAS,MAD3BA,EAAQ,EAEzB,CACD,EACH,GACF,IAIJO,MAAC,OAAI,UAAU,sEAAsE,mCAErF,GAEJ,SAID,OACC,UAAAA,MAACC,EAAA,CAAM,UAAU,qBAAqB,gBAAI,EAC1CD,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,qBACL,OAAQ,CAAC,CAAE,MAAAiE,CAAA,IACTU,MAACQ,EAAA,CACE,GAAGlB,EACJ,UAAU,8CACV,YAAY,QACd,EAEJ,EACF,SAGC,OACC,UAAAU,MAACC,EAAA,CAAM,UAAU,qBAAqB,gBAAI,EAC1CD,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,iBACL,OAAQ,CAAC,CAAE,MAAAiE,CAAA,IACTU,MAACQ,EAAA,CACE,GAAGlB,EACJ,UAAU,8CACV,YAAY,QACd,EAEJ,EACF,SAGC,OACC,UAAAU,MAACC,EAAA,CAAM,UAAU,qBAAqB,mBAAO,EAC7CD,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,eACL,OAAQ,CAAC,CAAE,MAAAiE,CAAA,IACTU,MAACQ,EAAA,CACE,GAAGlB,EACJ,UAAU,8CACV,YAAY,WACd,EAEJ,EACF,SAGC,OACC,UAAAQ,OAACG,EAAA,CAAM,UAAU,qBAAqB,gBAAGD,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EACrFA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,eACL,OAAQ,CAAC,CAAE,MAAAiE,CAAA,IACTU,MAACQ,EAAA,CACE,GAAGlB,EACJ,KAAK,OACL,UAAU,+CACZ,EAEJ,EACF,SAGC,OACC,UAAAU,MAACC,EAAA,CAAM,UAAU,qBAAqB,iBAAK,EAC3CD,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,wBACL,OAAQ,CAAC,CAAE,MAAAiE,CAAA,IACTU,MAACQ,EAAA,CACE,GAAGlB,EACJ,KAAK,OACL,UAAU,+CACZ,EAEJ,EACF,SAGC,OACC,UAAAQ,OAACG,EAAA,CAAM,UAAU,qBAAqB,kBAAKD,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EACvFA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,eACL,OAAQ,CAAC,CAAE,MAAAiE,KACTQ,OAACK,EAAA,CAAO,MAAOb,EAAM,MAAO,cAAeA,EAAM,SAC/C,UAAAU,MAACI,GAAc,UAAU,8CACvB,eAACC,EAAA,CAAY,YAAY,QAAQ,EACnC,SACCC,EAAA,CACC,UAAAN,MAACO,EAAA,CAAW,MAAM,MAAM,eAAG,EAC3BP,MAACO,EAAA,CAAW,MAAM,MAAM,eAAG,GAC7B,GACF,GAEJ,EACF,SAGC,OACC,UAAAT,OAACG,EAAA,CAAM,UAAU,qBAAqB,kBAAKD,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EACvFA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,gBACL,OAAQ,CAAC,CAAE,MAAAiE,KACTQ,OAACK,EAAA,CAAO,MAAOb,EAAM,MAAO,cAAeA,EAAM,SAC/C,UAAAU,MAACI,GAAc,UAAU,8CACvB,eAACC,EAAA,CAAY,YAAY,QAAQ,EACnC,SACCC,EAAA,CACC,UAAAN,MAACO,EAAA,CAAW,MAAM,KAAK,cAAE,EACzBP,MAACO,EAAA,CAAW,MAAM,MAAM,eAAG,GAC7B,GACF,GAEJ,EACF,SAGC,OACC,UAAAT,OAACG,EAAA,CAAM,UAAU,qBAAqB,kBAAKD,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EACvFA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,mBACL,OAAQ,CAAC,CAAE,MAAAiE,KACTQ,OAACK,EAAA,CAAO,MAAOb,EAAM,MAAO,cAAeA,EAAM,SAC/C,UAAAU,MAACI,GAAc,UAAU,8CACvB,eAACC,EAAA,CAAY,YAAY,QAAQ,EACnC,SACCC,EAAA,CACC,UAAAN,MAACO,EAAA,CAAW,MAAM,OAAO,gBAAI,EAC7BP,MAACO,EAAA,CAAW,MAAM,OAAO,gBAAI,EAC7BP,MAACO,EAAA,CAAW,MAAM,QAAQ,iBAAK,GACjC,GACF,GAEJ,EACF,SAGC,OACC,UAAAT,OAACG,EAAA,CAAM,UAAU,qBAAqB,eAAED,MAAC,QAAK,UAAU,oBAAoB,aAAC,GAAO,EACpFA,MAACE,EAAA,CACC,QAAA7E,EACA,KAAK,WACL,OAAQ,CAAC,CAAE,MAAAiE,CAAA,IACTQ,OAACK,EAAA,CACC,MAAOb,EAAM,MACb,cAAgBC,GAAU,CACxBD,EAAM,SAASC,CAAK,EACpBhF,EAAYgF,CAAK,CACnB,EAEA,UAAAS,MAACI,EAAA,CAAc,UAAU,8CACvB,SAAAJ,MAACK,IAAY,EACf,SACCC,EAAA,CACC,UAAAN,MAACO,EAAA,CAAW,MAAM,MAAM,oBAAQ,EAChCP,MAACO,EAAA,CAAW,MAAM,MAAM,oBAAQ,GAClC,IACF,EAEJ,EACF,GACF,EAGAT,OAAC,OAAI,UAAU,wDACb,UAAAA,OAAC,OAAI,UAAU,yCACb,UAAAA,OAAC,OACC,UAAAE,MAAC,MAAG,UAAU,wCAAwC,iBAAK,EAC3DA,MAAC,KAAE,UAAU,6BAA6B,4BAAgB,GAC5D,EACAF,OAAC,OAAI,UAAU,0BACb,UAAAA,OAACc,GAAA,CAAM,QAAQ,YAAY,UAAU,iBAAiB,mBAC7C7B,GAAY,eAAe,OAAO,EAAE,IAAEzE,CAAA,EAC/C,EACA0F,MAACW,EAAA,CACC,KAAK,SACL,KAAK,KACL,QAAQ,UACR,UAAU,4DACV,QAAS,IAAM,CACT,QAAQ,kBAAkB,IAC5B/E,EAAO,QAAQ,CAACiF,EAAMxB,IAAUvD,GAAOF,EAAO,OAAS,EAAIyD,CAAK,CAAC,EACjExD,GAAO,CACL,YAAa,EACb,UAAW,GACX,cAAe,GACf,SAAU,EACV,iBAAkB,EAClB,oBAAqBvB,EACrB,aAAc,EACd,gBAAiBA,EACjB,OAAQ,GACR,KAAM,GACP,EAEL,EACD,kBAGD0F,MAACQ,EAAA,CACC,KAAK,SACL,IAAK,EACL,MAAOpH,EACP,SAAU2G,GAAK1G,GAAY,KAAK,IAAI,EAAG,OAAO0G,EAAE,OAAO,MAAM,QAAQ,UAAW,EAAE,CAAC,CAAC,CAAC,EACrF,UAAU,qBAEZD,OAACa,EAAA,CACC,KAAK,SACL,QAAS,IAAM,CACb,MAAMG,EAAiB,IAAMlF,EAAO,OACpC,GAAIkF,GAAkB,EAAG,CACvB,MAAM,wBAAwB,EAC9B,MACF,CACA,MAAMC,EAAa,KAAK,IAAI3H,EAAU0H,CAAc,EACpD,QAASvC,EAAI,EAAGA,EAAIwC,EAAYxC,IAC9B1C,GAAO,CACL,YAAaD,EAAO,OAAS,EAAI2C,EACjC,UAAW,GACX,cAAe,GACf,SAAU,EACV,iBAAkB,EAClB,oBAAqBjE,EACrB,aAAc,EACd,gBAAiBA,EACjB,OAAQ,GACR,KAAM,GACP,EAECyG,EAAa3H,GACf,MAAM,UAAU2H,CAAU,aAAa,CAE3C,EACA,KAAK,KACL,UAAU,6CAEV,UAAAf,MAACgB,GAAA,CAAK,UAAU,eAAe,EAAE,UAEnC,EACF,GACF,EAGAhB,MAAC,OAAI,UAAU,6DACb,eAAC,OAAI,UAAU,kBACb,SAAAA,MAAC,OAAI,UAAU,gCACb,SAAAF,OAAC,SAAM,UAAU,iBACf,UAAAE,MAAC,SAAM,UAAU,+BACf,SAAAF,OAAC,MAAG,UAAU,2BACZ,UAAAE,MAAC,MAAG,UAAU,qDAAqD,aAAC,EACpEF,OAAC,MAAG,UAAU,iEAAiE,eAC3EE,MAAC,QAAK,UAAU,eAAe,aAAC,GACpC,EACAA,MAAC,MAAG,UAAU,iEAAiE,cAAE,EACjFF,OAAC,MAAG,UAAU,uDAAuD,eACjEE,MAAC,QAAK,UAAU,eAAe,aAAC,GACpC,EACAF,OAAC,MAAG,UAAU,kEAAkE,iBACzExF,EAAS,KAChB,EACAwF,OAAC,MAAG,UAAU,kEAAkE,iBACzExF,EAAS,KAChB,EACCwC,KAAoB,QACnBkD,MAAC,MAAG,UAAU,iEAAiE,cAAE,EAEnFA,MAAC,MAAG,UAAU,iEAAiE,cAAE,EACjFA,MAAC,MAAG,UAAU,uDAAuD,GACvE,EACF,EACAA,MAAC,SAAM,UAAU,WACd,SAAApE,EAAO,IAAI,CAACW,EAAMC,IACjBsD,OAAC,MAAa,UAAU,4CACtB,UAAAE,MAAC,MAAG,UAAU,sCAAuC,SAAAxD,EAAM,EAAE,EAE7DwD,MAAC,MAAG,UAAU,YACZ,SAAAA,MAACQ,EAAA,CACC,MAAOjE,EAAK,UACZ,SAAWwD,GAAMhE,EAAOS,EAAK,CAAE,GAAGD,EAAM,UAAWwD,EAAE,OAAO,MAAO,EACnE,UAAU,qDACV,YAAY,WAEhB,EAGAC,MAAC,MAAG,UAAU,YACZ,SAAAA,MAACQ,EAAA,CACC,MAAOjE,EAAK,cACZ,SAAWwD,GAAMhE,EAAOS,EAAK,CAAE,GAAGD,EAAM,cAAewD,EAAE,OAAO,MAAO,EACvE,UAAU,qDACV,YAAY,UAEhB,EAGAC,MAAC,MAAG,UAAU,YACZ,SAAAA,MAACQ,EAAA,CACC,KAAK,SACL,IAAI,IACJ,MAAOjE,EAAK,UAAY,GACxB,UAAU,iEACV,YAAY,IACZ,SAAWwD,GAAM,CACf,MAAMkB,EAAc,SAASlB,EAAE,OAAO,KAAK,GAAK,EAChDhE,EAAOS,EAAK,CAAE,GAAGD,EAAM,SAAU0E,EAAa,CAChD,IAEJ,QAGC,MAAG,UAAU,YACZ,SAAAnB,OAAC,OAAI,UAAU,oBACb,UAAAE,MAACQ,EAAA,CACC,KAAK,OACL,UAAU,UACV,MAAO7F,GAAY,GAAG6B,CAAG,mBAAmB,IAAMD,EAAK,mBAAqB,EAAI,GAAKA,EAAK,kBAAkB,eAAe,OAAO,GAAK,IACvI,SAAWwD,GAAM,CAGf,MAAMmB,EAFMnB,EAAE,OAAO,MAAM,QAAQ,KAAM,EAAE,EAEpB,QAAQ,WAAY,EAAE,EAEvCrC,EAAQwD,EAAW,MAAM,GAAG,EAC5BC,EAAazD,EAAM,OAAS,EAAIA,EAAM,CAAC,EAAI,IAAMA,EAAM,MAAM,CAAC,EAAE,KAAK,EAAE,EAAIwD,EAGjFtG,GAAe4E,IAAS,CAAC,GAAGA,EAAM,CAAC,GAAGhD,CAAG,mBAAmB,EAAG2E,CAAA,EAAY,EAG3E,MAAMC,EAASD,IAAe,GAAK,EAAI,WAAWA,CAAU,GAAK,EACjEpF,EAAOS,EAAK,CAAE,GAAGD,EAAM,iBAAkB6E,EAAQ,CACnD,EACA,OAAQ,IAAM,CAEZxG,GAAe4E,GAAQ,CACrB,MAAM6B,EAAW,CAAC,GAAG7B,CAAA,EACrB,cAAO6B,EAAS,GAAG7E,CAAG,mBAAmB,EAClC6E,CACT,CAAC,CACH,EACA,UAAU,gEACV,YAAY,YAEb,QAAK,UAAU,6BAA8B,SAAA/G,IAAa,MAAQ,IAAM,IAAI,GAC/E,EACF,QAGC,MAAG,UAAU,YACZ,SAAAwF,OAAC,OAAI,UAAU,gCACb,UAAAE,MAAC,QAAK,UAAU,iCACZ,UAAAzD,EAAK,cAAgB,GAAG,eAAe,OAAO,EAClD,QACC,QAAK,UAAU,6BAA8B,SAAAjC,IAAa,MAAQ,IAAM,IAAI,GAC/E,EACF,EAGCwC,KAAoB,QACnBkD,MAAC,MAAG,UAAU,YACZ,SAAAA,MAACQ,EAAA,CACC,MAAOjE,EAAK,MAAQ,GACpB,SAAWwD,GAAMhE,EAAOS,EAAK,CAAE,GAAGD,EAAM,KAAMwD,EAAE,OAAO,MAAO,EAC9D,KAAK,MACL,UAAU,qDACV,YAAY,gBAEhB,EAIFC,MAAC,MAAG,UAAU,YACZ,SAAAA,MAACQ,EAAA,CACC,MAAOjE,EAAK,QAAU,GACtB,SAAWwD,GAAMhE,EAAOS,EAAK,CAAE,GAAGD,EAAM,OAAQwD,EAAE,OAAO,MAAO,EAChE,UAAU,qDACV,YAAY,OAEhB,QAEC,MAAG,UAAU,wBACX,SAAAnE,EAAO,OAAS,GACfoE,MAACW,EAAA,CACC,KAAK,SACL,QAAS,IAAM7E,GAAOU,CAAG,EACzB,KAAK,KACL,QAAQ,QACR,UAAU,8BAEV,SAAAwD,MAACsB,GAAA,CAAE,UAAU,uBAAuB,GACtC,CAEJ,IAvHO9E,CAwHT,CACD,EACH,GACF,EACF,EACF,EACF,EAEAsD,OAAC,OAAI,UAAU,wCAAwC,eAClDlE,EAAO,OAAO,kBACnB,GACF,GACF,EAGClC,GACCsG,MAAC,OAAI,UAAU,2EACZ,SAAAtG,EACH,EAIFoG,OAAC,OAAI,UAAU,8BACb,UAAAE,MAACW,EAAA,CACC,KAAK,SACL,QAAQ,UACR,QAAS,IAAMpI,EAAS,EAAE,EAC3B,gBAGDyH,MAACW,EAAA,CACC,KAAK,SACL,SAAUnG,GAAW,CAACwC,GACtB,UAAU,6CAET,WACC8C,OAAAyB,WAAA,CACE,UAAAvB,MAAC,OAAI,UAAU,oFAAoF,EAAE,WAEvG,EAEAF,OAAAyB,WAAA,CACE,UAAAvB,MAACwB,GAAA,CAAK,UAAU,eAAe,EAAE,QAEnC,GAEJ,EACF,EAGAxB,MAACyB,IAAO,KAAM5G,GAAqB,aAAcC,EAC/C,SAAAgF,OAAC4B,GAAA,CAAc,UAAU,gEACvB,UAAA1B,MAAC2B,GAAA,CACC,SAAA3B,MAAC4B,GAAA,CAAY,kBAAM,EACrB,EACA5B,MAAC,OAAI,UAAU,YACZ,SAAAjF,EAAgB,IAAI,CAAC0E,EAASJ,IAC7BS,OAAC,OAAgB,UAAU,uBACzB,UAAAA,OAAC,OAAI,UAAU,SACb,UAAAE,MAACC,EAAA,CAAM,UAAU,UAAU,cAAE,EAC7BD,MAACQ,EAAA,CACC,MAAOf,EAAQ,aACf,SAAWM,GAAMX,EAAoBC,EAAO,eAAgBU,EAAE,OAAO,KAAK,EAC1E,YAAY,SACZ,UAAU,OACZ,EACF,EACAD,OAAC,OAAI,UAAU,SACb,UAAAE,MAACC,EAAA,CAAM,UAAU,UAAU,eAAG,EAC9BD,MAACQ,EAAA,CACC,MAAOf,EAAQ,cACf,SAAWM,GAAMX,EAAoBC,EAAO,gBAAiBU,EAAE,OAAO,KAAK,EAC3E,YAAY,MACZ,UAAU,OACZ,EACF,EACAD,OAAC,OAAI,UAAU,SACb,UAAAE,MAACC,EAAA,CAAM,UAAU,UAAU,gBAAI,EAC/BD,MAACQ,EAAA,CACC,MAAOf,EAAQ,cACf,SAAWM,GAAMX,EAAoBC,EAAO,gBAAiBU,EAAE,OAAO,KAAK,EAC3E,YAAY,OACZ,UAAU,OACZ,EACF,EACAD,OAAC,OAAI,UAAU,SACb,UAAAE,MAACC,EAAA,CAAM,UAAU,UAAU,cAAE,EAC7BD,MAACQ,EAAA,CACC,MAAOf,EAAQ,SACf,SAAWM,GAAMX,EAAoBC,EAAO,WAAYU,EAAE,OAAO,KAAK,EACtE,YAAY,KACZ,UAAU,OACZ,EACF,EACAC,MAACW,EAAA,CACC,KAAK,SACL,KAAK,KACL,QAAQ,QACR,QAAS,IAAMhB,GAAkBN,CAAK,EACtC,UAAU,WAEV,SAAAW,MAACsB,GAAA,CAAE,UAAU,UAAU,GACzB,GA7CQjC,CA8CV,CACD,EACH,EACAS,OAAC+B,GAAA,CAAa,UAAU,QACtB,UAAA/B,OAACa,EAAA,CACC,KAAK,SACL,QAAQ,UACR,QAASjB,GACT,KAAK,KAEL,UAAAM,MAACgB,GAAA,CAAK,UAAU,eAAe,EAAE,YAGnChB,MAAC8B,GAAA,CAAY,QAAO,GAClB,SAAA9B,MAACW,EAAA,CAAO,KAAK,SAAS,QAAQ,UAAU,KAAK,KAAK,cAElD,EACF,EACAX,MAACW,EAAA,CACC,KAAK,SACL,QAASd,GACT,SAAU,CAAC5E,GACX,KAAK,KACN,eAED,EACF,GACF,EACF,IAGN","names":["__iconNode","Pencil","createLucideIcon","lazy","__vitePreload","PurchaseNewMain","navigate","useNavigate","supabase","createClient","user","setUser","useState","employeeName","setEmployeeName","employees","setEmployees","defaultRequesterLoaded","setDefaultRequesterLoaded","addCount","setAddCount","vendorSearchTerm","setVendorSearchTerm","useEffect","data","error","dbEmp","emp","currentUser","vendors","setVendors","contacts","setContacts","vendor","setVendor","selectedContacts","setSelectedContacts","currency","setCurrency","loading","setLoading","setError","inputValues","setInputValues","isContactDialogOpen","setIsContactDialogOpen","contactsForEdit","setContactsForEdit","hasChanges","setHasChanges","isSubmittingRef","useRef","control","rhHandleSubmit","watch","setValue","reset","getValues","useFormRH","fields","append","remove","update","useFieldArray","empData","employeeData","fallbackName","toast","selectedVendor","updatedItems","item","idx","calcAmount","f","checkRequiredFields","requestType","progressType","paymentCategory","vendorId","isFormValid","setIsFormValid","generatePurchaseOrderNumber","today","prefix","existingOrders","queryError","nextNumber","maxSequence","order","parts","sequenceStr","sequence","safeNextNumber","handleSubmit","currentEmployee","prId","purchaseOrderNumber","maxRetries","retryCount","pr","prError","sum","i","resolve","retryError","itemErr","notifyResponse","notifyResult","errorText","err","totalAmount","openContactsManager","existingContacts","c","newEmptyContact","handleContactChange","index","field","value","prev","contact","addNewContactSlot","removeContactSlot","_","handleSaveAllContacts","jsxs","e","jsx","Label","Controller","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","Input","filteredVendors","v","Button","Badge","_idx","remainingSlots","itemsToAdd","Plus","newQuantity","cleanValue","finalValue","numVal","newState","X","Fragment","Save","Dialog","DialogContent","DialogHeader","DialogTitle","DialogFooter","DialogClose"],"ignoreList":[0],"sources":["../../node_modules/lucide-react/dist/esm/icons/pencil.js","../../src/components/purchase/PurchaseNewMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z\",\n      key: \"1a8usu\"\n    }\n  ],\n  [\"path\", { d: \"m15 5 4 4\", key: \"1mk7zo\" }]\n];\nconst Pencil = createLucideIcon(\"pencil\", __iconNode);\n\nexport { __iconNode, Pencil as default };\n//# sourceMappingURL=pencil.js.map\n","import { useState, useEffect, useRef, useLayoutEffect, lazy, Suspense } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Plus, X, Save, Calculator, Pencil, Trash2 } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useForm as useFormRH, Controller, useFieldArray } from \"react-hook-form\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogClose } from \"@/components/ui/dialog\";\nimport { FormValues, FormItem } from \"@/types/purchase\";\nimport { toast } from \"sonner\";\nimport { DatePicker } from \"@/components/ui/datepicker\";\nimport { Separator } from \"@/components/ui/separator\";\nconst ReactSelect = lazy(() => import('react-select'));\n\ninterface EmployeeOption {\n  value: string;\n  label: string;\n}\n\nexport default function PurchaseNewMain() {\n  const navigate = useNavigate();\n  const supabase = createClient();\n  \n  const [user, setUser] = useState<any>(null);\n  const [employeeName, setEmployeeName] = useState<string>(\"\");\n  const [employees, setEmployees] = useState<{id: string; name: string; email?: string; phone?: string; address?: string; position?: string; department?: string;}[]>([]);\n  const [defaultRequesterLoaded, setDefaultRequesterLoaded] = useState(false);\n  const [addCount, setAddCount] = useState(1);\n  const [vendorSearchTerm, setVendorSearchTerm] = useState(\"\");\n  \n  // ì´ˆê¸° ì‚¬ìš©ì ì •ë³´ ë¡œë“œ\n  useEffect(() => {\n    const getUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      setUser(user);\n    };\n    getUser();\n  }, []);\n\n  useEffect(() => {\n    // DBì—ì„œ ì§ì› ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n    const loadEmployees = async () => {\n      try {\n        const { data, error } = await supabase\n          .from('employees')\n          .select('id, name, email, phone, address, position, department')\n          .order('name');\n        \n        \n        if (data && !error && data.length > 0) {\n          setEmployees(data.map(dbEmp => ({\n            id: dbEmp.id,\n            name: dbEmp.name,\n            email: dbEmp.email || '',\n            phone: dbEmp.phone || '',\n            address: dbEmp.address || '',\n            position: dbEmp.position || '',\n            department: dbEmp.department || ''\n          })));\n          \n          // ì´ë¯¸ ì„¤ì •ëœ employeeNameì´ ìˆê³  employees ë°°ì—´ì— í•´ë‹¹ ì§ì›ì´ ìˆëŠ”ì§€ í™•ì¸\n          if (employeeName && !data.find(emp => emp.name === employeeName)) {\n            // í˜„ì¬ ì‚¬ìš©ìë¥¼ employees ë°°ì—´ì— ì¶”ê°€\n            const currentUser = {\n              id: user?.id || 'current-user',\n              name: employeeName,\n              email: user?.email || '',\n              phone: '',\n              address: '',\n              position: '',\n              department: ''\n            };\n            setEmployees([...data.map(dbEmp => ({\n              id: dbEmp.id,\n              name: dbEmp.name,\n              email: dbEmp.email || '',\n              phone: dbEmp.phone || '',\n              address: dbEmp.address || '',\n              position: dbEmp.position || '',\n              department: dbEmp.department || ''\n            })), currentUser]);\n          }\n        } else {\n          // DBì—ì„œ ëª» ë¶ˆëŸ¬ì™€ë„ í˜„ì¬ ì‚¬ìš©ìë§Œì´ë¼ë„ ì¶”ê°€\n          if (employeeName) {\n            setEmployees([{\n              id: user?.id || 'current-user',\n              name: employeeName,\n              email: user?.email || '',\n              phone: '',\n              address: '',\n              position: '',\n              department: ''\n            }]);\n          } else {\n            setEmployees([]);\n          }\n        }\n      } catch (err) {\n        // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ í˜„ì¬ ì‚¬ìš©ì ì¶”ê°€\n        if (employeeName) {\n          setEmployees([{\n            id: user?.id || 'current-user',\n            name: employeeName,\n            email: user?.email || '',\n            phone: '',\n            address: '',\n            position: '',\n            department: ''\n          }]);\n        } else {\n          setEmployees([]);\n        }\n      }\n    };\n    \n    // user ìƒíƒœì™€ ê´€ê³„ì—†ì´ ì§ì› ëª©ë¡ ë¡œë“œ\n    loadEmployees();\n  }, [employeeName, user]);\n\n  const [vendors, setVendors] = useState<{ id: number; vendor_name: string }[]>([]);\n  const [contacts, setContacts] = useState<{ id: number; contact_name: string; contact_email: string; contact_phone: string; position: string }[]>([]);\n  const [vendor, setVendor] = useState(\"\");\n  const [selectedContacts, setSelectedContacts] = useState<string[]>([]);\n  const [currency, setCurrency] = useState(\"KRW\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [inputValues, setInputValues] = useState<{[key: string]: string}>({});\n  const [isContactDialogOpen, setIsContactDialogOpen] = useState(false);\n  const [contactsForEdit, setContactsForEdit] = useState<{ id?: number; contact_name: string; contact_email: string; contact_phone: string; position: string; isNew?: boolean }[]>([]);\n  const [hasChanges, setHasChanges] = useState(false);\n  // ì¤‘ë³µ ì œì¶œ ë°©ì§€ìš© ref\n  const isSubmittingRef = useRef(false);\n\n  const { control, handleSubmit: rhHandleSubmit, watch, setValue, reset, getValues } = useFormRH<FormValues>({\n    defaultValues: {\n      progress_type: \"\",\n      payment_category: \"\",\n      currency: \"KRW\",\n      po_template_type: \"ì¼ë°˜\",\n      request_type: \"\",\n      contacts: [],\n      sales_order_number: '',\n      project_vendor: '',\n      project_item: '',\n      delivery_request_date: '',\n      vendor_id: 0,\n      requester_name: \"\",\n      items: [\n        {\n          line_number: 1,\n          item_name: \"\",\n          specification: \"\",\n          quantity: 1,\n          unit_price_value: 0,\n          unit_price_currency: \"KRW\",\n          amount_value: 0,\n          amount_currency: \"KRW\",\n          remark: \"\",\n          link: \"\",\n        },\n      ],\n      request_date: new Date().toISOString().slice(0, 10),\n    }\n  });\n\n  const { fields, append, remove, update } = useFieldArray({\n    control,\n    name: \"items\"\n  });\n\n  // ì‚¬ìš©ì ì •ë³´ë¡œ êµ¬ë§¤ìš”ì²­ì ê¸°ë³¸ê°’ ì„¤ì •\n  useEffect(() => {\n    if (!user?.email || defaultRequesterLoaded) return;\n    \n    const loadUserName = async () => {\n      const { data: empData } = await supabase\n        .from('employees')\n        .select('name')\n        .eq('email', user.email)\n        .single();\n      \n      if (empData?.name) {\n        setEmployeeName(empData.name);\n        setValue('requester_name', empData.name);\n        setDefaultRequesterLoaded(true);\n      }\n    };\n    loadUserName();\n  }, [user, supabase, setValue, defaultRequesterLoaded]);\n\n  // ì—…ì²´ ëª©ë¡ ë¡œë“œ\n  useEffect(() => {\n    const setDefaultRequester = async () => {\n      if (user?.email && setValue && !defaultRequesterLoaded) {\n        try {\n          const { data: employeeData, error } = await supabase\n            .from('employees')\n            .select('name')\n            .eq('email', user.email)\n            .single();\n          \n          if (employeeData && !error) {\n            setEmployeeName(employeeData.name);\n            // React Hook Formì˜ setValueë¥¼ ì•½ê°„ì˜ ì§€ì—° í›„ í˜¸ì¶œ\n            setTimeout(() => {\n              setValue('requester_name', employeeData.name, { \n                shouldValidate: true,\n                shouldDirty: true \n              });\n            }, 100);\n            setDefaultRequesterLoaded(true);\n          } else {\n            const fallbackName = user.email.split('@')[0] || \"ì‚¬ìš©ì\";\n            setEmployeeName(fallbackName);\n            setTimeout(() => {\n              setValue('requester_name', fallbackName, { \n                shouldValidate: true,\n                shouldDirty: true \n              });\n            }, 100);\n            setDefaultRequesterLoaded(true);\n          }\n        } catch (err) {\n          const fallbackName = user.email?.split('@')[0] || \"ì‚¬ìš©ì\";\n          setEmployeeName(fallbackName);\n          setTimeout(() => {\n            setValue('requester_name', fallbackName, { \n              shouldValidate: true,\n              shouldDirty: true \n            });\n          }, 100);\n          setDefaultRequesterLoaded(true);\n        }\n      }\n    };\n    \n    setDefaultRequester();\n  }, [user, setValue, defaultRequesterLoaded]);\n\n  // Vendors ë¡œë“œ\n  useEffect(() => {\n    const loadVendors = async () => {\n      try {\n        const { data, error } = await supabase\n          .from(\"vendors\")\n          .select(\"*\")\n          .order(\"vendor_name\");\n        \n        if (error) throw error;\n        setVendors(data || []);\n      } catch (error) {\n        toast.error(\"ì—…ì²´ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n      }\n    };\n\n    loadVendors();\n  }, []);\n\n  const selectedVendor = watch('vendor_id');\n\n  // ì—…ì²´ ë³€ê²½ ì‹œ ë‹´ë‹¹ì ëª©ë¡ ë¡œë“œ\n  useEffect(() => {\n    const loadContacts = async () => {\n      if (selectedVendor) {\n        try {\n          const { data, error } = await supabase\n            .from('vendor_contacts')\n            .select('id, contact_name, contact_email, contact_phone, position')\n            .eq('vendor_id', selectedVendor);\n          \n          if (error) throw error;\n          setContacts(data || []);\n        } catch (error) {\n          setContacts([]);\n        }\n      } else {\n        setContacts([]);\n      }\n    };\n    \n    loadContacts();\n  }, [selectedVendor]);\n\n  // í†µí™” ë³€ê²½ì‹œ í’ˆëª©ë“¤ì˜ í†µí™”ë„ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    const items = getValues(\"items\");\n    const updatedItems = items.map(item => ({\n      ...item,\n      unit_price_currency: currency,\n      amount_currency: currency\n    }));\n    setValue(\"items\", updatedItems);\n    setCurrency(currency);\n  }, [currency, setValue, getValues]);\n\n  // ìˆ˜ëŸ‰ì´ë‚˜ ë‹¨ê°€ ë³€ê²½ ì‹œ ê¸ˆì•¡ ìë™ ê³„ì‚°\n  useEffect(() => {\n    fields.forEach((item, idx) => {\n      const calcAmount = Number(item.quantity) * Number(item.unit_price_value);\n      if (item.amount_value !== calcAmount) {\n        update(idx, { ...item, amount_value: calcAmount });\n      }\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fields.map(f => `${f.quantity}-${f.unit_price_value}`).join(\",\")]);\n\n  // í’ˆëª© ì¶”ê°€\n  const addItem = () => {\n    const currentItems = getValues(\"items\");\n    const nextLineNumber = Math.max(...currentItems.map(item => item.line_number), 0) + 1;\n    \n    append({\n      line_number: nextLineNumber,\n      item_name: \"\",\n      specification: \"\",\n      quantity: 1,\n      unit_price_value: 0,\n      unit_price_currency: currency,\n      amount_value: 0,\n      amount_currency: currency,\n      remark: \"\",\n      link: \"\"\n    });\n  };\n\n  // ê¸ˆì•¡ ê³„ì‚°\n  const calculateAmount = (index: number) => {\n    const items = getValues(\"items\");\n    const item = items[index];\n    const amount = item.quantity * item.unit_price_value;\n    \n    // update í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ fields ë°°ì—´ ì§ì ‘ ì—…ë°ì´íŠ¸\n    update(index, { ...item, amount_value: amount });\n  };\n\n  // ì „ì²´ ê¸ˆì•¡ ê³„ì‚°\n  const getTotalAmount = () => {\n    const items = getValues(\"items\");\n    return items.reduce((sum, item) => sum + item.amount_value, 0);\n  };\n\n  // í•„ìˆ˜ í•­ëª© ì²´í¬ í•¨ìˆ˜\n  const checkRequiredFields = () => {\n    const requestType = watch('request_type');\n    const progressType = watch('progress_type');\n    const paymentCategory = watch('payment_category');\n    const vendorId = watch('vendor_id');\n    \n    return !!(requestType && progressType && paymentCategory && vendorId && vendorId !== 0 && fields.length > 0);\n  };\n\n  // ì‹¤ì‹œê°„ í•„ìˆ˜í•­ëª© ì²´í¬ë¥¼ ìœ„í•œ state\n  const [isFormValid, setIsFormValid] = useState(false);\n\n  // í•„ìˆ˜í•­ëª© ë³€ê²½ ê°ì§€\n  useEffect(() => {\n    setIsFormValid(checkRequiredFields());\n  }, [watch('request_type'), watch('progress_type'), watch('payment_category'), watch('vendor_id'), fields]);\n\n  // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„± í•¨ìˆ˜ (ì¬ì‹œë„ ë¡œì§ í¬í•¨)\n  const generatePurchaseOrderNumber = async () => {\n    const today = new Date();\n    // í•œêµ­ ì‹œê°„ëŒ€(UTC+9) ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ìƒì„±\n    const koreaTime = new Date(today.getTime() + (9 * 60 * 60 * 1000));\n    const dateStr = koreaTime.toISOString().slice(0, 10).replace(/-/g, ''); // YYYYMMDD\n    const prefix = `F${dateStr}_`;\n    \n    // ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì‹œì‘í•˜ëŠ” ë°œì£¼ìš”ì²­ë²ˆí˜¸ë“¤ ì¡°íšŒ (ìœ íš¨í•œ ìˆ«ì í˜•ì‹ë§Œ)\n    const { data: existingOrders, error: queryError } = await supabase\n      .from('purchase_requests')\n      .select('purchase_order_number')\n      .like('purchase_order_number', `${prefix}%`)\n      .order('purchase_order_number', { ascending: false });\n    \n    if (queryError) {\n    }\n    \n    // ë‹¤ìŒ ìˆœë²ˆ ê³„ì‚° (ìˆ«ìì¸ ì‹œí€€ìŠ¤ë§Œ ì°¾ê¸°)\n    let nextNumber = 1;\n    let maxSequence = 0;\n    \n    if (existingOrders && existingOrders.length > 0) {\n      // ëª¨ë“  ë°œì£¼ìš”ì²­ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì—¬ ê°€ì¥ í° ìœ íš¨í•œ ìˆ«ì ì‹œí€€ìŠ¤ ì°¾ê¸°\n      for (const order of existingOrders) {\n        const orderNumber = order.purchase_order_number;\n        \n        // ë°œì£¼ìš”ì²­ë²ˆí˜¸ í˜•ì‹: F20250612_001\n        const parts = orderNumber.split('_');\n        if (parts.length >= 2) {\n          const sequenceStr = parts[1];\n          const sequence = parseInt(sequenceStr, 10);\n          \n          // ìœ íš¨í•œ ìˆ«ìì´ê³  í˜„ì¬ ìµœëŒ€ê°’ë³´ë‹¤ í¬ë©´ ì—…ë°ì´íŠ¸\n          if (!isNaN(sequence) && sequence > maxSequence) {\n            maxSequence = sequence;\n          }\n        }\n      }\n      \n      nextNumber = maxSequence + 1;\n    }\n    \n    // 3ìë¦¬ íŒ¨ë”©ìœ¼ë¡œ ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±\n    const safeNextNumber = isNaN(nextNumber) ? 1 : nextNumber;\n    const purchaseOrderNumber = `${prefix}${String(safeNextNumber).padStart(3, '0')}`;\n    \n    return purchaseOrderNumber;\n  };\n\n  // í¼ ì œì¶œ\n  const handleSubmit = async (data: FormValues) => {\n    const currentEmployee = employees.find(emp => emp.name === data.requester_name);\n    \n    if (isSubmittingRef.current) {\n      return;\n    }\n\n    if (!currentEmployee) {\n      setError(\"êµ¬ë§¤ìš”ì²­ì ì´ë¦„ì— í•´ë‹¹í•˜ëŠ” ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤. ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.\");\n      return;\n    }\n    \n    // í•„ìˆ˜ í•­ëª©ì´ ëª¨ë‘ ì±„ì›Œì ¸ ìˆëŠ”ì§€ ì¬í™•ì¸\n    if (!checkRequiredFields()) {\n      return; // ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•˜ë¯€ë¡œ ë³„ë„ ì˜¤ë¥˜ ë©”ì‹œì§€ ì—†ì´ ê·¸ëƒ¥ ë¦¬í„´\n    }\n\n    isSubmittingRef.current = true;\n    setLoading(true);\n    setError(\"\");\n    \n    try {\n\n      let prId: number = 0;\n      let purchaseOrderNumber: string = '';\n      const maxRetries = 5;\n      let retryCount = 0;\n\n      // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•œ ì¬ì‹œë„ ë¡œì§\n      while (retryCount < maxRetries) {\n        try {\n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìë™ ìƒì„±\n          purchaseOrderNumber = await generatePurchaseOrderNumber();\n\n          // êµ¬ë§¤ìš”ì²­ ë“±ë¡ ì‹œë„\n          const { data: pr, error: prError } = await supabase.from(\"purchase_requests\").insert({\n            requester_id: currentEmployee.id,\n            purchase_order_number: purchaseOrderNumber,\n            requester_name: data.requester_name,\n            requester_phone: currentEmployee?.phone,\n            requester_fax: null, // faxëŠ” í˜„ì¬ employees í…Œì´ë¸”ì— ì—†ìœ¼ë¯€ë¡œ null\n            requester_address: currentEmployee?.address,\n            vendor_id: data.vendor_id,\n            sales_order_number: data.sales_order_number,\n            project_vendor: data.project_vendor,\n            project_item: data.project_item,\n            request_date: data.request_date,\n            delivery_request_date: data.delivery_request_date || null,\n            request_type: data.request_type,\n            progress_type: data.progress_type,\n            is_payment_completed: false,\n            payment_category: data.payment_category,\n            currency: currency,\n            total_amount: fields.reduce((sum, i) => sum + i.amount_value, 0),\n            unit_price_currency: fields[0]?.unit_price_currency || currency,\n            po_template_type: data.po_template_type,\n            contact_id: data.contact_id ? Number(data.contact_id) : null,\n          }).select(\"id\").single();\n          \n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ì—ëŸ¬ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì—ëŸ¬ëŠ” ë°”ë¡œ throw\n          if (prError && !prError.message.includes('duplicate key value violates unique constraint')) {\n            throw prError;\n          }\n          \n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ì—ëŸ¬ì¸ ê²½ìš°\n          if (prError && prError.message.includes('duplicate key value violates unique constraint')) {\n            retryCount++;\n            if (retryCount >= maxRetries) {\n              throw new Error(`ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±ì— ${maxRetries}ë²ˆ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);\n            }\n            // ì¬ì‹œë„ë¥¼ ìœ„í•´ ì§§ì€ ëŒ€ê¸°\n            await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n            continue;\n          }\n          \n          // ì„±ê³µí•œ ê²½ìš°\n          if (!pr) throw new Error(\"ë“±ë¡ ì‹¤íŒ¨\");\n          prId = pr.id;\n          break; // ì„±ê³µ ì‹œ ë£¨í”„ ì¢…ë£Œ\n          \n        } catch (retryError: any) {\n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µì´ ì•„ë‹Œ ì—ëŸ¬ëŠ” ë°”ë¡œ throw\n          if (!retryError.message.includes('duplicate key value violates unique constraint')) {\n            throw retryError;\n          }\n          \n          retryCount++;\n          if (retryCount >= maxRetries) {\n            throw new Error(`ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±ì— ${maxRetries}ë²ˆ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);\n          }\n          \n          // ì¬ì‹œë„ë¥¼ ìœ„í•´ ì§§ì€ ëŒ€ê¸° (100-300ms ëœë¤)\n          await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n        }\n      }\n\n      // í’ˆëª©ë“¤ ì €ì¥\n      for (const [idx, item] of fields.entries()) {\n        const { error: itemErr } = await supabase.from(\"purchase_request_items\").insert({\n          purchase_request_id: prId,\n          line_number: idx + 1,\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          unit_price_currency: currency,\n          amount_value: item.amount_value,\n          amount_currency: currency,\n          remark: item.remark,\n          link: item.link || null,\n        });\n        if (itemErr) throw itemErr;\n      }\n      \n      // ë°œì£¼ìš”ì²­ ì„±ê³µ ì²˜ë¦¬\n      \n      // ğŸ“¨ ì¤‘ê°„ê´€ë¦¬ì DM ì•Œë¦¼ ë°œì†¡ (í’ˆëª© ì¶”ê°€ ì™„ë£Œ í›„ ì •í™•í•œ ê°œìˆ˜ë¡œ)\n      try {\n        const notifyResponse = await fetch(`/api/purchase/${prId}/notify-middle-manager`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n        \n        if (notifyResponse.ok) {\n          const notifyResult = await notifyResponse.json();\n        } else {\n          const errorText = await notifyResponse.text();\n        }\n      } catch (notifyError) {\n      }\n      \n      // 1. í¼ ì´ˆê¸°í™”\n      reset({\n        progress_type: \"\",\n        payment_category: \"\",\n        currency: \"KRW\",\n        po_template_type: \"ì¼ë°˜\",\n        request_type: \"\",\n        contacts: [],\n        sales_order_number: '',\n        project_vendor: '',\n        project_item: '',\n        delivery_request_date: '',\n        vendor_id: 0,\n        requester_name: employeeName, // ìš”ì²­ì ì´ë¦„ì€ ìœ ì§€\n        items: [\n          {\n            line_number: 1,\n            item_name: \"\",\n            specification: \"\",\n            quantity: 1,\n            unit_price_value: 0,\n            unit_price_currency: \"KRW\",\n            amount_value: 0,\n            amount_currency: \"KRW\",\n            remark: \"\",\n            link: \"\",\n          },\n        ],\n        request_date: new Date().toISOString().slice(0, 10),\n      });\n      \n      // 2. ìƒíƒœ ì´ˆê¸°í™”\n      setVendor(\"\");\n      setSelectedContacts([]);\n      setCurrency(\"KRW\");\n      setError(\"\");\n      setLoading(false);\n      \n      // 3. ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ\n      toast.success(\"ë°œì£¼ìš”ì²­ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n      \n      // 4. ë°œì£¼ìš”ì²­ ëª©ë¡ìœ¼ë¡œ ì´ë™\n      try {\n        await navigate('/purchase/list');\n      } catch (routerError) {\n        // ëŒ€ì²´ ë¼ìš°íŒ… ë°©ë²•\n        window.location.href = '/purchase/list';\n      }\n      return;\n    } catch (err: any) {\n      setError(err.message || \"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n      toast.error(err.message || \"ë°œì£¼ìš”ì²­ì„œ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n    } finally {\n      // ì˜¤ë¥˜ê°€ ìˆì—ˆì„ ë•Œë§Œ ì‹¤í–‰ë¨ (ì„±ê³µ ì‹œì—ëŠ” returnìœ¼ë¡œ ë¹ ì§)\n      setLoading(false);\n      isSubmittingRef.current = false;\n    }\n  };\n\n  const totalAmount = fields.reduce((sum, item) => sum + item.amount_value, 0);\n\n  const openContactsManager = () => {\n    // ê¸°ì¡´ ë‹´ë‹¹ìë“¤ì„ ë³µì‚¬í•˜ê³  ìƒˆë¡œìš´ ë‹´ë‹¹ì ì¶”ê°€ë¥¼ ìœ„í•œ ë¹ˆ ìŠ¬ë¡¯ë„ ì¶”ê°€\n    const existingContacts = contacts.map(c => ({ ...c, isNew: false }));\n    const newEmptyContact = { contact_name: '', contact_email: '', contact_phone: '', position: '', isNew: true };\n    setContactsForEdit([...existingContacts, newEmptyContact]);\n    setHasChanges(false);\n    setIsContactDialogOpen(true);\n  };\n\n  const handleContactChange = (index: number, field: string, value: string) => {\n    setContactsForEdit(prev => prev.map((contact, i) => \n      i === index ? { ...contact, [field]: value } : contact\n    ));\n    setHasChanges(true);\n  };\n\n  const addNewContactSlot = () => {\n    setContactsForEdit(prev => [...prev, { contact_name: '', contact_email: '', contact_phone: '', position: '', isNew: true }]);\n    setHasChanges(true);\n  };\n\n  const removeContactSlot = (index: number) => {\n    setContactsForEdit(prev => prev.filter((_, i) => i !== index));\n    setHasChanges(true);\n  };\n\n  const handleSaveAllContacts = async () => {\n    if (!selectedVendor) return;\n    \n    try {\n      // @hanslë¡œ ëë‚˜ëŠ” ì´ë©”ì¼ ì²´í¬\n      const hanslEmails = contactsForEdit.filter(c => c.contact_email && c.contact_email.endsWith('@hansl.io'));\n      if (hanslEmails.length > 0) {\n        alert('í•œìŠ¬ ì§ì› ì´ë©”ì¼ì€ ì—…ì²´ ë‹´ë‹¹ìë¡œ ë“±ë¡í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n        return;\n      }\n\n      for (const contact of contactsForEdit) {\n        if (contact.contact_name && contact.contact_email) {\n          if (!contact.isNew && contact.id) {\n            // ê¸°ì¡´ ë‹´ë‹¹ì ì—…ë°ì´íŠ¸\n            await supabase\n              .from('vendor_contacts')\n              .update({\n                contact_name: contact.contact_name,\n                contact_email: contact.contact_email,\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              })\n              .eq('id', contact.id);\n          } else if (contact.isNew) {\n            // ìƒˆë¡œìš´ ë‹´ë‹¹ì ì¶”ê°€\n            await supabase\n              .from('vendor_contacts')\n              .insert({\n                vendor_id: selectedVendor,\n                contact_name: contact.contact_name,\n                contact_email: contact.contact_email,\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              });\n          }\n        }\n      }\n      \n      // ë‹´ë‹¹ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      const { data } = await supabase\n        .from('vendor_contacts')\n        .select('id, contact_name, contact_email, contact_phone, position')\n        .eq('vendor_id', selectedVendor);\n      \n      if (data) setContacts(data);\n      setIsContactDialogOpen(false);\n      toast.success('ë‹´ë‹¹ì ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      toast.error('ë‹´ë‹¹ì ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleDeleteContact = async (contactId: number) => {\n    if (!confirm('ì •ë§ ì´ ë‹´ë‹¹ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;\n    \n    try {\n      await supabase\n        .from('vendor_contacts')\n        .delete()\n        .eq('id', contactId);\n      \n      // ë‹´ë‹¹ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      const { data } = await supabase\n        .from('vendor_contacts')\n        .select('id, contact_name, contact_email, contact_phone, position')\n        .eq('vendor_id', selectedVendor);\n      \n      if (data) setContacts(data);\n      toast.success('ë‹´ë‹¹ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      toast.error('ë‹´ë‹¹ì ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const paymentCategory = watch('payment_category');\n\n  return (\n    <form \n      onSubmit={(e) => {\n        e.preventDefault();\n        rhHandleSubmit(handleSubmit)(e);\n      }}\n      onKeyDown={e => {\n        if (e.key === 'Enter' || e.keyCode === 13) {\n          e.preventDefault();\n        }\n      }}\n    >\n      <div className=\"flex gap-6\">\n        {/* ë°œì£¼ìš”ì²­ ê¸°ë³¸ ì •ë³´ - ì¢Œì¸¡ */}\n        <div className=\"w-1/3 relative bg-white border border-gray-200 rounded-lg p-6 space-y-4\">\n          <div className=\"flex flex-row items-start justify-between w-full mb-4\">\n            <div className=\"flex flex-col\">\n              <h4 className=\"text-base font-semibold text-gray-900\">ë°œì£¼ìš”ì²­ ê¸°ë³¸ ì •ë³´</h4>\n            </div>\n            <div className=\"flex flex-col items-start\">\n              <Label className=\"mb-1 block text-xs\">ë°œì£¼ìš”ì²­ì„œ ì¢…ë¥˜<span className=\"text-red-500 ml-1\">*</span></Label>\n              <Controller\n                control={control}\n                name=\"po_template_type\"\n                render={({ field }) => (\n                  <Select value={field.value} onValueChange={field.onChange}>\n                    <SelectTrigger className=\"h-8 w-28 bg-white border border-gray-200 rounded-md text-xs\">\n                      <SelectValue placeholder=\"ì¢…ë¥˜ ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"ì¼ë°˜\">ì¼ë°˜</SelectItem>\n                      <SelectItem value=\"PCB\">PCB</SelectItem>\n                      <SelectItem value=\"ì†Œëª¨í’ˆ\">ì†Œëª¨í’ˆ</SelectItem>\n                      <SelectItem value=\"ê¸°íƒ€\">ê¸°íƒ€</SelectItem>\n                    </SelectContent>\n                  </Select>\n                )}\n              />\n            </div>\n          </div>\n\n          {/* êµ¬ë§¤ìš”ì²­ì */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">êµ¬ë§¤ìš”ì²­ì<span className=\"text-red-500 ml-1\">*</span></Label>\n            <Controller\n              control={control}\n              name=\"requester_name\"\n              render={({ field }) => (\n                <Input\n                  {...field}\n                  value={field.value || employeeName || ''}\n                  className=\"h-8 bg-white border border-gray-200 text-xs\"\n                  placeholder=\"êµ¬ë§¤ìš”ì²­ì ì´ë¦„\"\n                  readOnly\n                />\n              )}\n            />\n          </div>\n\n          {/* ì—…ì²´ ì„ íƒ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">ì—…ì²´ ì„ íƒ<span className=\"text-red-500 ml-1\">*</span></Label>\n            <Controller\n              control={control}\n              name=\"vendor_id\"\n              render={({ field }) => {\n                const filteredVendors = vendors.filter(v => \n                  v.vendor_name.toLowerCase().includes(vendorSearchTerm.toLowerCase())\n                );\n                \n                return (\n                  <div className=\"relative\">\n                    <Select \n                      value={field.value?.toString()} \n                      onValueChange={(value) => {\n                        field.onChange(Number(value));\n                        setVendor(value);\n                        setValue('vendor_id', Number(value));\n                        setVendorSearchTerm(\"\");\n                      }}\n                    >\n                      <SelectTrigger className=\"h-8 bg-white border border-gray-200 text-xs\">\n                        <SelectValue placeholder=\"ì—…ì²´ ì„ íƒ\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <div className=\"p-2\" onClick={(e) => e.stopPropagation()}>\n                          <Input\n                            placeholder=\"ì—…ì²´ ê²€ìƒ‰...\"\n                            value={vendorSearchTerm}\n                            onChange={(e) => setVendorSearchTerm(e.target.value)}\n                            onKeyDown={(e) => e.stopPropagation()}\n                            className=\"h-7 text-xs mb-2\"\n                            autoFocus\n                          />\n                        </div>\n                        {filteredVendors.length === 0 ? (\n                          <div className=\"text-xs text-gray-500 text-center py-2\">\n                            ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤\n                          </div>\n                        ) : (\n                          filteredVendors.map((vendor) => (\n                            <SelectItem key={vendor.id} value={vendor.id.toString()} className=\"text-xs\">\n                              {vendor.vendor_name}\n                            </SelectItem>\n                          ))\n                        )}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                );\n              }}\n            />\n          </div>\n\n          {/* ë‹´ë‹¹ì */}\n          {selectedVendor > 0 && (\n            <div>\n              <div className=\"flex justify-between items-center mb-1\">\n                <Label className=\"block text-xs\">ë‹´ë‹¹ì</Label>\n                <Button\n                  type=\"button\"\n                  onClick={openContactsManager}\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"h-6 px-2 text-xs\"\n                >\n                  <Pencil className=\"h-3 w-3 mr-1\" />\n                  ê´€ë¦¬\n                </Button>\n              </div>\n              {contacts.length > 0 ? (\n                <Controller\n                  control={control}\n                  name=\"contact_id\"\n                  render={({ field }) => (\n                    <Select value={field.value?.toString()} onValueChange={(value) => field.onChange(Number(value))}>\n                      <SelectTrigger className=\"h-8 bg-white border border-gray-200 text-xs\">\n                        <SelectValue placeholder=\"ë‹´ë‹¹ì ì„ íƒ\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {contacts.map((contact) => (\n                          <SelectItem key={contact.id} value={contact.id.toString()}>\n                            {contact.contact_name} ({contact.position})\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  )}\n                />\n              ) : (\n                <div className=\"text-xs text-gray-500 p-2 border border-gray-200 rounded bg-gray-50\">\n                  ë‹´ë‹¹ìë¥¼ ì¶”ê°€í•˜ë ¤ë©´ ê´€ë¦¬ ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* ìˆ˜ì£¼ë²ˆí˜¸ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">ìˆ˜ì£¼ë²ˆí˜¸</Label>\n            <Controller\n              control={control}\n              name=\"sales_order_number\"\n              render={({ field }) => (\n                <Input\n                  {...field}\n                  className=\"h-8 bg-white border border-gray-200 text-xs\"\n                  placeholder=\"ì£¼ë¬¸ë²ˆí˜¸\"\n                />\n              )}\n            />\n          </div>\n\n          {/* PJì—…ì²´ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">PJì—…ì²´</Label>\n            <Controller\n              control={control}\n              name=\"project_vendor\"\n              render={({ field }) => (\n                <Input\n                  {...field}\n                  className=\"h-8 bg-white border border-gray-200 text-xs\"\n                  placeholder=\"PJì—…ì²´\"\n                />\n              )}\n            />\n          </div>\n\n          {/* PJ ITEM */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">PJ ITEM</Label>\n            <Controller\n              control={control}\n              name=\"project_item\"\n              render={({ field }) => (\n                <Input\n                  {...field}\n                  className=\"h-8 bg-white border border-gray-200 text-xs\"\n                  placeholder=\"PJ ITEM\"\n                />\n              )}\n            />\n          </div>\n\n          {/* ìš”ì²­ì¼ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">ìš”ì²­ì¼<span className=\"text-red-500 ml-1\">*</span></Label>\n            <Controller\n              control={control}\n              name=\"request_date\"\n              render={({ field }) => (\n                <Input\n                  {...field}\n                  type=\"date\"\n                  className=\"h-8 bg-white border border-gray-200 text-xs\"\n                />\n              )}\n            />\n          </div>\n\n          {/* ë‚©ê¸°ìš”ì²­ì¼ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">ë‚©ê¸°ìš”ì²­ì¼</Label>\n            <Controller\n              control={control}\n              name=\"delivery_request_date\"\n              render={({ field }) => (\n                <Input\n                  {...field}\n                  type=\"date\"\n                  className=\"h-8 bg-white border border-gray-200 text-xs\"\n                />\n              )}\n            />\n          </div>\n\n          {/* ìš”ì²­ ì¢…ë¥˜ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">ìš”ì²­ ì¢…ë¥˜<span className=\"text-red-500 ml-1\">*</span></Label>\n            <Controller\n              control={control}\n              name=\"request_type\"\n              render={({ field }) => (\n                <Select value={field.value} onValueChange={field.onChange}>\n                  <SelectTrigger className=\"h-8 bg-white border border-gray-200 text-xs\">\n                    <SelectValue placeholder=\"ìš”ì²­ ì¢…ë¥˜\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"ì›ìì¬\">ì›ìì¬</SelectItem>\n                    <SelectItem value=\"ì†Œëª¨í’ˆ\">ì†Œëª¨í’ˆ</SelectItem>\n                  </SelectContent>\n                </Select>\n              )}\n            />\n          </div>\n\n          {/* ì§„í–‰ ì¢…ë¥˜ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">ì§„í–‰ ì¢…ë¥˜<span className=\"text-red-500 ml-1\">*</span></Label>\n            <Controller\n              control={control}\n              name=\"progress_type\"\n              render={({ field }) => (\n                <Select value={field.value} onValueChange={field.onChange}>\n                  <SelectTrigger className=\"h-8 bg-white border border-gray-200 text-xs\">\n                    <SelectValue placeholder=\"ì§„í–‰ ì¢…ë¥˜\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"ì¼ë°˜\">ì¼ë°˜</SelectItem>\n                    <SelectItem value=\"ì„ ì§„í–‰\">ì„ ì§„í–‰</SelectItem>\n                  </SelectContent>\n                </Select>\n              )}\n            />\n          </div>\n\n          {/* ê²°ì œ ì¢…ë¥˜ */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">ê²°ì œ ì¢…ë¥˜<span className=\"text-red-500 ml-1\">*</span></Label>\n            <Controller\n              control={control}\n              name=\"payment_category\"\n              render={({ field }) => (\n                <Select value={field.value} onValueChange={field.onChange}>\n                  <SelectTrigger className=\"h-8 bg-white border border-gray-200 text-xs\">\n                    <SelectValue placeholder=\"ê²°ì œ ì¢…ë¥˜\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"ë°œì£¼ìš”ì²­\">ë°œì£¼ìš”ì²­</SelectItem>\n                    <SelectItem value=\"êµ¬ë§¤ìš”ì²­\">êµ¬ë§¤ìš”ì²­</SelectItem>\n                    <SelectItem value=\"í˜„ì¥ ê²°ì œ\">í˜„ì¥ ê²°ì œ</SelectItem>\n                  </SelectContent>\n                </Select>\n              )}\n            />\n          </div>\n\n          {/* í†µí™” */}\n          <div>\n            <Label className=\"mb-1 block text-xs\">í†µí™”<span className=\"text-red-500 ml-1\">*</span></Label>\n            <Controller\n              control={control}\n              name=\"currency\"\n              render={({ field }) => (\n                <Select \n                  value={field.value} \n                  onValueChange={(value) => {\n                    field.onChange(value);\n                    setCurrency(value);\n                  }}\n                >\n                  <SelectTrigger className=\"h-8 bg-white border border-gray-200 text-xs\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"KRW\">KRW (ì›í™”)</SelectItem>\n                    <SelectItem value=\"USD\">USD (ë‹¬ëŸ¬)</SelectItem>\n                  </SelectContent>\n                </Select>\n              )}\n            />\n          </div>\n        </div>\n\n        {/* í’ˆëª© ì •ë³´ - ìš°ì¸¡ (í…Œì´ë¸” í˜•íƒœ) */}\n        <div className=\"flex-1 bg-white border border-gray-200 rounded-lg p-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h4 className=\"text-base font-semibold text-gray-900\">í’ˆëª© ì •ë³´</h4>\n              <p className=\"text-xs text-gray-500 mt-1\">ìµœëŒ€ 100ê°œ í’ˆëª© ì…ë ¥ ê°€ëŠ¥</p>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Badge variant=\"secondary\" className=\"text-hansl-500\">\n                ì´ ê¸ˆì•¡: {totalAmount.toLocaleString('ko-KR')} {currency}\n              </Badge>\n              <Button \n                type=\"button\" \n                size=\"sm\" \n                variant=\"outline\" \n                className=\"bg-white text-gray-600 hover:text-red-600 hover:bg-red-50\" \n                onClick={() => { \n                  if (confirm('ëª¨ë“  í’ˆëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                    fields.forEach((_idx, index) => remove(fields.length - 1 - index)); \n                    append({ \n                      line_number: 1, \n                      item_name: '', \n                      specification: '', \n                      quantity: 1, \n                      unit_price_value: 0, \n                      unit_price_currency: currency, \n                      amount_value: 0, \n                      amount_currency: currency, \n                      remark: '', \n                      link: '' \n                    });\n                  }\n                }}\n              >\n                ì „ì²´ì‚­ì œ\n              </Button>\n              <Input\n                type=\"number\"\n                min={1}\n                value={addCount}\n                onChange={e => setAddCount(Math.max(1, Number(e.target.value.replace(/[^0-9]/g, ''))))}\n                className=\"w-16 h-8 text-xs\"\n              />\n              <Button\n                type=\"button\"\n                onClick={() => {\n                  const remainingSlots = 100 - fields.length;\n                  if (remainingSlots <= 0) {\n                    alert('ìµœëŒ€ 100ê°œê¹Œì§€ë§Œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');\n                    return;\n                  }\n                  const itemsToAdd = Math.min(addCount, remainingSlots);\n                  for (let i = 0; i < itemsToAdd; i++) {\n                    append({\n                      line_number: fields.length + 1 + i,\n                      item_name: '',\n                      specification: '',\n                      quantity: 1,\n                      unit_price_value: 0,\n                      unit_price_currency: currency,\n                      amount_value: 0,\n                      amount_currency: currency,\n                      remark: '',\n                      link: ''\n                    });\n                  }\n                  if (itemsToAdd < addCount) {\n                    alert(`ìµœëŒ€ í•œë„ë¡œ ${itemsToAdd}ê°œë§Œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`);\n                  }\n                }}\n                size=\"sm\"\n                className=\"bg-hansl-500 hover:bg-hansl-600 text-white\"\n              >\n                <Plus className=\"w-4 h-4 mr-1\" />\n                í’ˆëª© ì¶”ê°€\n              </Button>\n            </div>\n          </div>\n\n          {/* í…Œì´ë¸” í˜•íƒœì˜ í’ˆëª© ë¦¬ìŠ¤íŠ¸ */}\n          <div className=\"relative border border-gray-200 rounded-lg overflow-hidden\">\n            <div className=\"overflow-x-auto\">\n              <div className=\"max-h-[500px] overflow-y-auto\">\n                <table className=\"w-full text-xs\">\n                  <thead className=\"bg-gray-50 sticky top-0 z-10\">\n                    <tr className=\"border-b border-gray-200\">\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 w-10\">#</th>\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 sm:min-w-[150px]\">\n                        í’ˆëª©<span className=\"text-red-500\">*</span>\n                      </th>\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 sm:min-w-[120px]\">ê·œê²©</th>\n                      <th className=\"px-2 py-2 text-center font-medium text-gray-700 w-20\">\n                        ìˆ˜ëŸ‰<span className=\"text-red-500\">*</span>\n                      </th>\n                      <th className=\"px-2 py-2 text-right font-medium text-gray-700 sm:min-w-[100px]\">\n                        ë‹¨ê°€ ({currency})\n                      </th>\n                      <th className=\"px-2 py-2 text-right font-medium text-gray-700 sm:min-w-[120px]\">\n                        í•©ê³„ ({currency})\n                      </th>\n                      {paymentCategory === \"êµ¬ë§¤ìš”ì²­\" && (\n                        <th className=\"px-2 py-2 text-left font-medium text-gray-700 sm:min-w-[150px]\">ë§í¬</th>\n                      )}\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 sm:min-w-[150px]\">ë¹„ê³ </th>\n                      <th className=\"px-2 py-2 text-center font-medium text-gray-700 w-10\"></th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white\">\n                    {fields.map((item, idx) => (\n                      <tr key={idx} className=\"border-b border-gray-100 hover:bg-gray-50\">\n                        <td className=\"px-2 py-1 text-center text-gray-500\">{idx + 1}</td>\n                        {/* í’ˆëª© */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            value={item.item_name}\n                            onChange={(e) => update(idx, { ...item, item_name: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"í’ˆëª©ëª… ì…ë ¥\"\n                          />\n                        </td>\n\n                        {/* ê·œê²© */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            value={item.specification}\n                            onChange={(e) => update(idx, { ...item, specification: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"ê·œê²© ì…ë ¥\"\n                          />\n                        </td>\n\n                        {/* ìˆ˜ëŸ‰ */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            type=\"number\"\n                            min=\"1\"\n                            value={item.quantity || ''}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs text-center\"\n                            placeholder=\"0\"\n                            onChange={(e) => {\n                              const newQuantity = parseInt(e.target.value) || 0;\n                              update(idx, { ...item, quantity: newQuantity });\n                            }}\n                          />\n                        </td>\n\n                        {/* ë‹¨ê°€ */}\n                        <td className=\"px-2 py-1\">\n                          <div className=\"flex items-center\">\n                            <Input\n                              type=\"text\"\n                              inputMode=\"decimal\"\n                              value={inputValues[`${idx}_unit_price_value`] ?? (item.unit_price_value === 0 ? \"\" : item.unit_price_value?.toLocaleString('ko-KR') || \"\")}\n                              onChange={(e) => {\n                                const raw = e.target.value.replace(/,/g, \"\");\n                                // ìˆ«ìì™€ ì†Œìˆ˜ì ë§Œ í—ˆìš©\n                                const cleanValue = raw.replace(/[^0-9.]/g, '');\n                                // ì†Œìˆ˜ì  ì¤‘ë³µ ë°©ì§€\n                                const parts = cleanValue.split('.');\n                                const finalValue = parts.length > 2 ? parts[0] + '.' + parts.slice(1).join('') : cleanValue;\n                                \n                                // ì…ë ¥ ì¤‘ì¸ ê°’ ì €ì¥ (ì†Œìˆ˜ì  ìœ ì§€)\n                                setInputValues(prev => ({...prev, [`${idx}_unit_price_value`]: finalValue}));\n                                \n                                // ê³„ì‚°ìš© ìˆ«ì ê°’ ì €ì¥\n                                const numVal = finalValue === '' ? 0 : parseFloat(finalValue) || 0;\n                                update(idx, { ...item, unit_price_value: numVal });\n                              }}\n                              onBlur={() => {\n                                // í¬ì»¤ìŠ¤ ë²—ì–´ë‚  ë•Œ ì…ë ¥ê°’ ì •ë¦¬\n                                setInputValues(prev => {\n                                  const newState = {...prev};\n                                  delete newState[`${idx}_unit_price_value`];\n                                  return newState;\n                                });\n                              }}\n                              className=\"h-7 w-full bg-white border border-gray-200 text-xs text-right\"\n                              placeholder=\"0\"\n                            />\n                            <span className=\"ml-1 text-xs text-gray-500\">{currency === \"KRW\" ? \"â‚©\" : \"$\"}</span>\n                          </div>\n                        </td>\n\n                        {/* í•©ê³„ */}\n                        <td className=\"px-2 py-1\">\n                          <div className=\"flex items-center justify-end\">\n                            <span className=\"text-xs text-right font-medium\">\n                              {(item.amount_value || 0).toLocaleString('ko-KR')}\n                            </span>\n                            <span className=\"ml-1 text-xs text-gray-500\">{currency === \"KRW\" ? \"â‚©\" : \"$\"}</span>\n                          </div>\n                        </td>\n\n                        {/* ë§í¬ (êµ¬ë§¤ìš”ì²­ì¼ ë•Œë§Œ) */}\n                        {paymentCategory === \"êµ¬ë§¤ìš”ì²­\" && (\n                          <td className=\"px-2 py-1\">\n                            <Input\n                              value={item.link || ''}\n                              onChange={(e) => update(idx, { ...item, link: e.target.value })}\n                              type=\"url\"\n                              className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                              placeholder=\"https://...\"\n                            />\n                          </td>\n                        )}\n\n                        {/* ë¹„ê³  */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            value={item.remark || ''}\n                            onChange={(e) => update(idx, { ...item, remark: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"ë¹„ê³ \"\n                          />\n                        </td>\n                        {/* ì‚­ì œ ë²„íŠ¼ */}\n                        <td className=\"px-2 py-1 text-center\">\n                          {fields.length > 1 && (\n                            <Button\n                              type=\"button\"\n                              onClick={() => remove(idx)}\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              className=\"h-6 w-6 p-0 hover:bg-red-50\"\n                            >\n                              <X className=\"w-3 h-3 text-red-600\" />\n                            </Button>\n                          )}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n          {/* í’ˆëª© ìˆ˜ í‘œì‹œ */}\n          <div className=\"mt-2 text-xs text-gray-500 text-right\">\n            ì´ {fields.length}ê°œ í’ˆëª© / ìµœëŒ€ 100ê°œ\n          </div>\n        </div>\n      </div>\n\n      {/* ì—ëŸ¬ ë©”ì‹œì§€ */}\n      {error && (\n        <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm\">\n          {error}\n        </div>\n      )}\n\n      {/* ì œì¶œ ë²„íŠ¼ */}\n      <div className=\"flex justify-end gap-3 mt-6\">\n        <Button \n          type=\"button\" \n          variant=\"outline\"\n          onClick={() => navigate(-1)}\n        >\n          ì·¨ì†Œ\n        </Button>\n        <Button \n          type=\"submit\"\n          disabled={loading || !isFormValid}\n          className=\"bg-hansl-600 hover:bg-hansl-700 text-white\"\n        >\n          {loading ? (\n            <>\n              <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n              ì²˜ë¦¬ ì¤‘...\n            </>\n          ) : (\n            <>\n              <Save className=\"w-4 h-4 mr-2\" />\n              ë°œì£¼ìš”ì²­\n            </>\n          )}\n        </Button>\n      </div>\n\n      {/* ë‹´ë‹¹ì ê´€ë¦¬ ëª¨ë‹¬ */}\n      <Dialog open={isContactDialogOpen} onOpenChange={setIsContactDialogOpen}>\n        <DialogContent className=\"w-full max-w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>ë‹´ë‹¹ì ê´€ë¦¬</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {contactsForEdit.map((contact, index) => (\n              <div key={index} className=\"flex gap-2 items-end\">\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì´ë¦„</Label>\n                  <Input\n                    value={contact.contact_name}\n                    onChange={(e) => handleContactChange(index, 'contact_name', e.target.value)}\n                    placeholder=\"ë‹´ë‹¹ì ì´ë¦„\"\n                    className=\"h-8\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì´ë©”ì¼</Label>\n                  <Input\n                    value={contact.contact_email}\n                    onChange={(e) => handleContactChange(index, 'contact_email', e.target.value)}\n                    placeholder=\"ì´ë©”ì¼\"\n                    className=\"h-8\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì „í™”ë²ˆí˜¸</Label>\n                  <Input\n                    value={contact.contact_phone}\n                    onChange={(e) => handleContactChange(index, 'contact_phone', e.target.value)}\n                    placeholder=\"ì „í™”ë²ˆí˜¸\"\n                    className=\"h-8\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì§ì±…</Label>\n                  <Input\n                    value={contact.position}\n                    onChange={(e) => handleContactChange(index, 'position', e.target.value)}\n                    placeholder=\"ì§ì±…\"\n                    className=\"h-8\"\n                  />\n                </div>\n                <Button\n                  type=\"button\"\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => removeContactSlot(index)}\n                  className=\"h-8 px-2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            ))}\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={addNewContactSlot}\n              size=\"sm\"\n            >\n              <Plus className=\"h-4 w-4 mr-1\" />\n              ë‹´ë‹¹ì ì¶”ê°€\n            </Button>\n            <DialogClose asChild>\n              <Button type=\"button\" variant=\"outline\" size=\"sm\">\n                ì·¨ì†Œ\n              </Button>\n            </DialogClose>\n            <Button\n              type=\"button\"\n              onClick={handleSaveAllContacts}\n              disabled={!hasChanges}\n              size=\"sm\"\n            >\n              ì €ì¥\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </form>\n  );\n}"],"file":"assets/PurchaseNewMain-FGjxHh3m.js"}