{"version":3,"mappings":"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","names":["Building","createLucideIcon","d","key","x","y","width","height","rx","DollarSign","x1","x2","y1","y2","Info","cx","cy","r","SlidersVertical","globalCache","purchases","lastFetch","userInfo","CACHE_DURATION","filteredData","Map","FILTER_CACHE_DURATION","usePurchaseData","now","Date","hasCache","length","setPurchases","useState","loading","setLoading","currentUserRoles","setCurrentUserRoles","currentUserName","setCurrentUserName","currentUserEmail","setCurrentUserEmail","currentUserId","setCurrentUserId","supabase","createClient","initializationRef","useRef","hasLoadedCacheRef","useEffect","async","current","cacheValid","employeeData","roles","purchase_role","Array","isArray","map","String","trim","split","filter","name","full_name","email","id","error","logger","userResult","auth","getUser","data","user","from","select","eq","maybeSingle","loadInitialData","loadPurchases","useCallback","forceRefresh","options","showSpinner","silent","clear","setTimeout","debug","authError","toast","order","ascending","limit","employeeList","vendorList","contactList","employeesResult","vendorsResult","contactsResult","Promise","all","today","toISOString","processedData","request_date","startsWith","request","firstItem","purchase_request_items","requesterEmployee","find","emp","requester_id","vendorInfo","vendor","vendor_id","contactInfo","contact","contact_id","Number","purchase_order_number","delivery_request_date","revised_delivery_request_date","progress_type","payment_completed_at","payment_completed_by_name","payment_category","currency","request_type","vendor_name","vendor_payment_schedule","vendor_contacts","requester_name","requester_full_name","item_name","specification","quantity","unit_price_value","amount_value","remark","project_vendor","sales_order_number","project_item","line_number","contact_name","middle_manager_status","final_manager_status","is_received","received_at","is_payment_completed","is_utk_checked","is_statement_received","is_po_download","link","items","sort","a","b","total_amount","reduce","sum","item","updatePurchaseOptimistic","purchaseId","updater","prev","next","purchase","catch","refreshPurchases","HIDDEN_EMPLOYEES","FastPurchaseTable","lazy","__vitePreload","import","__VITE_PRELOAD__","TableSkeleton","memo","jsx","className","children","_","i","jsxs","displayName","LazyPurchaseTable","activeTab","onRefresh","onOptimisticUpdate","onPaymentComplete","onReceiptComplete","Suspense","fallback","FILTER_FIELDS","label","type","icon","Calendar","category","User","Package","CheckCircle","Check","DATE_FIELDS","value","SORT_FIELDS","FilterToolbar","activeFilters","sortConfig","searchTerm","onFiltersChange","onSortChange","onSearchChange","availableEmployees","availableVendors","availableContacts","availablePaymentSchedules","isFilterOpen","setIsFilterOpen","isSortOpen","setIsSortOpen","isSearchExpanded","setIsSearchExpanded","newFilter","setNewFilter","datePickerOpen","setDatePickerOpen","monthPickerOpen","setMonthPickerOpen","tempDateRange","setTempDateRange","tempMonth","setTempMonth","tempMonthRange","setTempMonthRange","tempSort","setTempSort","searchInputRef","focus","field","direction","handleRemoveFilter","filterId","f","renderValueInput","fieldConfig","Input","placeholder","onChange","e","target","style","padding","fontSize","fontWeight","Popover","PopoverTrigger","asChild","Button","variant","role","Search","PopoverContent","align","Command","CommandInput","CommandEmpty","CommandGroup","option","CommandItem","onSelect","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","scheduleOptions","open","onOpenChange","includes","start","end","to","format","CalendarComponent","mode","selected","range","numberOfMonths","initialFocus","onClick","rangeValue","disabled","startYear","startMonth","endYear","endMonth","slice","year","month","currentYear","getFullYear","newDate","getMonth","size","monthDate","isSelected","isDisabled","Sliders","Badge","dateField","df","X","defaultCondition","condition","scrollbarWidth","scrollbarColor","WebkitScrollbarWidth","Object","entries","acc","push","fields","isDateFilter","requiresDateField","finalCondition","ArrowUpDown","ref","PurchaseItemsModal","NAV_TABS","PurchaseListMain","showEmailButton","navigate","useNavigate","location","useLocation","selectedPurchase","setSelectedPurchase","isModalOpen","setIsModalOpen","setActiveFilters","setSortConfig","setSearchTerm","setAvailableEmployees","setAvailableVendors","setAvailableContacts","setAvailablePaymentSchedules","isAdmin","setActiveTab","filteredPurchases","selectedEmployee","setSelectedEmployee","isPurchaseManager","isLeadBuyer","isHr","roleCase","useMemo","some","computeDefaultEmployee","tabKey","defaultEmployee","visiblePurchases","p","tabFilteredPurchases","matches","middlePending","finalPending","middleRejected","finalRejected","middleApproved","finalApproved","isRequest","isSeonJin","isIlban","employeeFilteredPurchases","result","dateA","getTime","tabCounts","countPurchases","getUniqueOrderCount","filtered","Set","getFilteredDataForTab","pendingData","purchaseData","receiptData","doneData","pendingFiltered","purchaseFiltered","receiptFiltered","pending","receipt","done","useFastPurchaseFilters","URLSearchParams","search","get","employees","employeeNames","Boolean","vendors","vendorNames","v","contacts","contactNames","c","schedules","scheduleNames","s","loadFilterOptions","hasInitializedTabRefresh","refreshLatestData","applyAdvancedFilters","sixtyDaysAgo","setDate","getDate","searchLower","toLowerCase","forEach","actualField","fieldValue","getFieldValue","filterFieldType","applyFilterCondition","created_at","statement_received_at","filterValue","filterField","startDate","endDate","fieldDate","endOfMonth","endsWith","filterYear","filterMonth","parseInt","fieldStr","filterStr","match","applySorting","aValue","bValue","comparison","localeCompare","advancedFilteredPurchases","filteredTabCounts","advancedFiltered","monthlyFilterSummary","monthFilters","monthlyTotals","totalSum","currentDate","monthStr","toString","padStart","monthData","purchaseDate","monthTotal","total","count","setMonth","months","grandTotal","handleReceiptComplete","currentTime","requestResult","itemsResult","update","delivery_status","success","handlePaymentComplete","modalPurchaseData","marginTop","marginBottom","Plus","tab","toLocaleString","Card","CardHeader","CardTitle","m","CardContent","isOpen","onClose","onUpdate"],"ignoreList":[0,1,2,3],"sources":["../../node_modules/lucide-react/dist/esm/icons/building.js","../../node_modules/lucide-react/dist/esm/icons/dollar-sign.js","../../node_modules/lucide-react/dist/esm/icons/info.js","../../node_modules/lucide-react/dist/esm/icons/sliders-vertical.js","../../src/hooks/usePurchaseData.ts","../../src/hooks/useFastPurchaseFilters.ts","../../src/components/purchase/LazyPurchaseTable.tsx","../../src/components/purchase/FilterToolbar.tsx","../../src/components/purchase/PurchaseListMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 10h.01\", key: \"1nrarc\" }],\n  [\"path\", { d: \"M12 14h.01\", key: \"1etili\" }],\n  [\"path\", { d: \"M12 6h.01\", key: \"1vi96p\" }],\n  [\"path\", { d: \"M16 10h.01\", key: \"1m94wz\" }],\n  [\"path\", { d: \"M16 14h.01\", key: \"1gbofw\" }],\n  [\"path\", { d: \"M16 6h.01\", key: \"1x0f13\" }],\n  [\"path\", { d: \"M8 10h.01\", key: \"19clt8\" }],\n  [\"path\", { d: \"M8 14h.01\", key: \"6423bh\" }],\n  [\"path\", { d: \"M8 6h.01\", key: \"1dz90k\" }],\n  [\"path\", { d: \"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3\", key: \"cabbwy\" }],\n  [\"rect\", { x: \"4\", y: \"2\", width: \"16\", height: \"20\", rx: \"2\", key: \"1uxh74\" }]\n];\nconst Building = createLucideIcon(\"building\", __iconNode);\n\nexport { __iconNode, Building as default };\n//# sourceMappingURL=building.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"2\", y2: \"22\", key: \"7eqyqh\" }],\n  [\"path\", { d: \"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6\", key: \"1b0p4s\" }]\n];\nconst DollarSign = createLucideIcon(\"dollar-sign\", __iconNode);\n\nexport { __iconNode, DollarSign as default };\n//# sourceMappingURL=dollar-sign.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"M12 16v-4\", key: \"1dtifu\" }],\n  [\"path\", { d: \"M12 8h.01\", key: \"e9boi3\" }]\n];\nconst Info = createLucideIcon(\"info\", __iconNode);\n\nexport { __iconNode, Info as default };\n//# sourceMappingURL=info.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"21\", y2: \"14\", key: \"1p332r\" }],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"10\", y2: \"3\", key: \"gb41h5\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"21\", y2: \"12\", key: \"hf2csr\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"8\", y2: \"3\", key: \"1kfi7u\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"21\", y2: \"16\", key: \"1lhrwl\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"12\", y2: \"3\", key: \"16vvfq\" }],\n  [\"line\", { x1: \"2\", x2: \"6\", y1: \"14\", y2: \"14\", key: \"1uebub\" }],\n  [\"line\", { x1: \"10\", x2: \"14\", y1: \"8\", y2: \"8\", key: \"1yglbp\" }],\n  [\"line\", { x1: \"18\", x2: \"22\", y1: \"16\", y2: \"16\", key: \"1jxqpz\" }]\n];\nconst SlidersVertical = createLucideIcon(\"sliders-vertical\", __iconNode);\n\nexport { __iconNode, SlidersVertical as default };\n//# sourceMappingURL=sliders-vertical.js.map\n","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { logger } from '@/lib/logger';\nimport { toast } from 'sonner';\n\nexport interface Purchase {\n  id: number;\n  purchase_order_number?: string;\n  request_date: string;\n  delivery_request_date?: string | null;\n  revised_delivery_request_date?: string | null;\n  progress_type: string;\n  is_payment_completed: boolean;\n  payment_category: string;\n  payment_completed_at?: string;\n  payment_completed_by_name?: string;\n  currency: string;\n  request_type: string;\n  vendor?: {\n    vendor_name: string;\n    vendor_payment_schedule?: string;\n  };\n  vendor_name: string;\n  vendor_payment_schedule?: string;\n  vendor_id?: number;\n  contact_id?: number;\n  vendor_contacts?: {\n    contact_name: string;\n  } | Array<{\n    contact_name: string;\n  }>;\n  contact_name?: string;\n  requester_id: string;\n  requester_name: string;\n  requester_full_name: string;\n  project_vendor: string;\n  sales_order_number: string;\n  project_item: string;\n  middle_manager_status?: string;\n  final_manager_status?: string;\n  total_amount: number;\n  is_received: boolean;\n  received_at?: string;\n\n  is_po_download?: boolean;\n  is_utk_checked?: boolean;\n  is_statement_received?: boolean;\n  items?: any[];\n  purchase_request_items?: any[];\n  item_name?: string;\n  specification?: string;\n  quantity?: number;\n  unit_price_value?: number;\n  amount_value?: number;\n  remark?: string;\n  line_number?: number;\n  link?: string;\n}\n\n\n//   \nconst globalCache = {\n  purchases: null as Purchase[] | null,\n  lastFetch: 0,\n  userInfo: null as any,\n  CACHE_DURATION: 5 * 60 * 1000, // 5  \n  //    \n  filteredData: new Map<string, { data: Purchase[]; timestamp: number }>(),\n  FILTER_CACHE_DURATION: 30 * 1000 // 30  \n};\n\n//    \nexport const clearPurchaseCache = () => {\n  globalCache.purchases = null;\n  globalCache.userInfo = null;\n  globalCache.lastFetch = 0;\n  globalCache.filteredData.clear();\n};\n\n//    ()\nexport const invalidateFilterCache = (tabKey?: string) => {\n  if (tabKey) {\n    for (const [key] of globalCache.filteredData.entries()) {\n      if (key.includes(tabKey)) {\n        globalCache.filteredData.delete(key);\n      }\n    }\n  } else {\n    globalCache.filteredData.clear();\n  }\n};\n\nexport const usePurchaseData = () => {\n  //      \n  const now = Date.now();\n  const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n  const hasCache = cacheValid && globalCache.purchases && globalCache.purchases.length > 0;\n  \n  const [purchases, setPurchases] = useState<Purchase[]>(hasCache ? globalCache.purchases : []);\n  const [loading, setLoading] = useState(!hasCache);\n  const [currentUserRoles, setCurrentUserRoles] = useState<string[]>([]);\n  const [currentUserName, setCurrentUserName] = useState<string>('');\n  const [currentUserEmail, setCurrentUserEmail] = useState<string>('');\n  const [currentUserId, setCurrentUserId] = useState<string>('');\n  \n  const supabase = createClient();\n  const initializationRef = useRef(false);\n  const hasLoadedCacheRef = useRef(hasCache);\n\n  //    ( ,  ) -  \n  useEffect(() => {\n    const loadInitialData = async () => {\n      if (initializationRef.current) return;\n      initializationRef.current = true;\n      \n      const now = Date.now();\n      const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n      \n      try {\n        //     \n        if (cacheValid && globalCache.userInfo) {\n          try {\n            const employeeData = globalCache.userInfo;\n            if (employeeData) {\n              let roles: string[] = [];\n              if (employeeData.purchase_role) {\n                if (Array.isArray(employeeData.purchase_role)) {\n                  roles = employeeData.purchase_role.map((r: any) => String(r).trim());\n                } else {\n                  const roleString = String(employeeData.purchase_role);\n                  roles = roleString\n                    .split(',')\n                    .map((r: string) => r.trim())\n                    .filter((r: string) => r.length > 0);\n                }\n              }\n              \n              setCurrentUserRoles(roles);\n              setCurrentUserName(employeeData.name || employeeData.full_name || '');\n              setCurrentUserEmail(employeeData.email || '');\n              setCurrentUserId(employeeData.id || '');\n            }\n            return;\n          } catch (error) {\n            logger.error('    ', error);\n            //  \n            globalCache.purchases = null;\n            globalCache.userInfo = null;\n            globalCache.lastFetch = 0;\n          }\n        }\n        \n        //      \n        const userResult = await supabase.auth.getUser();\n\n        //     \n        if (userResult.data.user && !userResult.error) {\n          // email    ( )\n          let employeeData = null;\n          if (userResult.data.user.email) {\n            const emailResult = await supabase\n              .from('employees')\n              .select('*')\n              .eq('email', userResult.data.user.email)\n              .maybeSingle();\n            \n            employeeData = emailResult.data;\n          }\n          \n          if (employeeData) {\n            globalCache.userInfo = employeeData;\n            \n            let roles: string[] = [];\n            if (employeeData.purchase_role) {\n              if (Array.isArray(employeeData.purchase_role)) {\n                roles = employeeData.purchase_role.map((r: any) => String(r).trim());\n              } else {\n                const roleString = String(employeeData.purchase_role);\n                roles = roleString\n                  .split(',')\n                  .map((r: string) => r.trim())\n                  .filter((r: string) => r.length > 0);\n              }\n            }\n            \n            setCurrentUserRoles(roles);\n            setCurrentUserName(employeeData.name || employeeData.full_name || '');\n            setCurrentUserEmail(employeeData.email || '');\n            setCurrentUserId(employeeData.id || '');\n          }\n          \n          globalCache.lastFetch = now;\n        }\n      } catch (error) {\n        logger.error('   ', error);\n      }\n    };\n\n    loadInitialData();\n  }, []);\n\n  //    -    \n  const loadPurchases = useCallback(async (forceRefresh?: boolean, options?: { silent?: boolean }) => {\n    const showSpinner = !options?.silent && !hasLoadedCacheRef.current;\n    \n    try {\n      //  \n      const now = Date.now();\n      const cacheValid = globalCache.lastFetch && (now - globalCache.lastFetch) < globalCache.CACHE_DURATION;\n      \n      //      \n      if (forceRefresh) {\n        invalidateFilterCache();\n        globalCache.purchases = null;\n        globalCache.lastFetch = 0;\n        hasLoadedCacheRef.current = false;\n        // silent       \n        if (showSpinner) {\n          setLoading(true);\n        }\n      } else if (cacheValid && globalCache.purchases) {\n        //    \n        setPurchases(globalCache.purchases);\n        setLoading(false);\n        hasLoadedCacheRef.current = true;\n        \n        // silent    \n        if (!options?.silent) {\n          setTimeout(async () => {\n            try {\n              //      (silent )\n              await loadPurchases(true, { silent: true });\n            } catch (error) {\n              //     (   )\n              logger.debug('    ()', error);\n            }\n          }, 100);\n        }\n        \n        return;\n      } else {\n        //     (    )\n        if (showSpinner && !hasLoadedCacheRef.current) {\n          setLoading(true);\n        }\n      }\n      \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      if (authError || !user) {\n        logger.error('  ', authError);\n        toast.error(' .');\n        if (showSpinner) {\n          setLoading(false);\n        }\n        return;\n      }\n\n      //        \n      \n      //  purchase_requests  (vendors JOIN )\n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          purchase_request_items(*)\n        `)\n        .order('request_date', { ascending: false })\n        .limit(1000); //  :  1000\n\n      if (error) {\n        throw error;\n      }\n\n      //  employees vendors, vendor_contacts   (   )\n      let employeeList: any[] = [];\n      let vendorList: any[] = [];\n      let contactList: any[] = [];\n      \n      //     \n      if (data && data.length > 0) {\n        //     (  )\n        const [employeesResult, vendorsResult, contactsResult] = await Promise.all([\n          supabase.from('employees').select('id, name, email'),\n          supabase.from('vendors').select('id, vendor_name, vendor_payment_schedule'),\n          supabase.from('vendor_contacts').select('id, contact_name')\n        ]);\n        \n        employeeList = employeesResult.data || [];\n        vendorList = vendorsResult.data || [];\n        contactList = contactsResult.data || [];\n      }\n\n      \n      //    \n      const today = new Date().toISOString().split('T')[0];\n      const todayItems = (data || []).filter((d: any) => d.request_date?.startsWith(today));\n\n      //   (hanslwebapp )\n      const processedData = (data || []).map((request: any) => {\n        //     (   )\n        const firstItem = request.purchase_request_items?.[0] || {};\n        \n        // requester_id employee \n        const requesterEmployee = employeeList.find(emp => emp.id === request.requester_id);\n        \n        // vendor_id vendor \n        const vendorInfo = vendorList.find(vendor => vendor.id === request.vendor_id);\n        \n        // contact_id  \n        const contactInfo = contactList.find(contact => contact.id === request.contact_id);\n        \n        return {\n          id: Number(request.id),\n          purchase_order_number: request.purchase_order_number as string,\n          request_date: request.request_date as string,\n          delivery_request_date: request.delivery_request_date ?? null,\n          revised_delivery_request_date: request.revised_delivery_request_date ?? null,\n          progress_type: request.progress_type as string,\n          payment_completed_at: request.payment_completed_at as string,\n          payment_completed_by_name: request.payment_completed_by_name as string,\n          payment_category: request.payment_category as string,\n          currency: request.currency as string,\n          request_type: request.request_type as string,\n          vendor: undefined, // vendors JOIN \n          vendor_name: request.vendor_name || '', // purchase_requests  vendor_name \n          vendor_payment_schedule: vendorInfo?.vendor_payment_schedule || '', // vendors  \n          vendor_contacts: [], // vendors JOIN  \n          requester_id: request.requester_id as string,\n          requester_name: request.requester_name as string,\n          requester_full_name: requesterEmployee?.name || request.requester_name || '',\n          item_name: firstItem.item_name as string || '',\n          specification: firstItem.specification as string || '',\n          quantity: Number(firstItem.quantity) || 0,\n          unit_price_value: Number(firstItem.unit_price_value) || 0,\n          amount_value: Number(firstItem.amount_value) || 0,\n          remark: firstItem.remark as string || '',\n          project_vendor: request.project_vendor as string,\n          sales_order_number: request.sales_order_number as string,\n          project_item: request.project_item as string,\n          line_number: Number(firstItem.line_number) || 1,\n          contact_name: contactInfo?.contact_name || '', // contact_id   \n          middle_manager_status: request.middle_manager_status,\n          final_manager_status: request.final_manager_status,\n          is_received: !!request.is_received,\n          received_at: request.received_at as string,\n          is_payment_completed: !!request.is_payment_completed,\n          is_utk_checked: !!request.is_utk_checked,\n          is_statement_received: !!request.is_statement_received,\n          is_po_download: !!request.is_po_download,\n          link: firstItem.link as string | undefined,\n          //     (hanslwebapp  items ) - line_number \n          items: (request.purchase_request_items || []).sort((a: any, b: any) => \n            (a.line_number || 0) - (b.line_number || 0)),\n          //   \n          total_amount: request.purchase_request_items?.reduce((sum: number, item: any) => \n            sum + (Number(item.amount_value) || 0), 0) || 0\n        };\n      });\n\n\n      //     \n      setPurchases(processedData);\n      globalCache.purchases = processedData;\n      globalCache.lastFetch = now;\n      hasLoadedCacheRef.current = true;\n    } catch (error) {\n      logger.error('   ', error);\n      toast.error('    .');\n    } finally {\n      if (showSpinner) {\n        setLoading(false);\n      } else {\n        // silent    false  (  )\n        setLoading(false);\n      }\n    }\n  }, [supabase]);\n\n  const updatePurchaseOptimistic = useCallback((purchaseId: number, updater: (prev: Purchase) => Purchase) => {\n    setPurchases(prev => {\n      const next = prev.map(purchase => (purchase.id === purchaseId ? updater(purchase) : purchase));\n      globalCache.purchases = next;\n      return next;\n    });\n  }, []);\n\n  //     \n  useEffect(() => {\n    if (hasLoadedCacheRef.current) {\n      //     \n      setTimeout(() => {\n        loadPurchases(true, { silent: true }).catch(() => {\n          //    \n        });\n      }, 100);\n      return;\n    }\n    \n    //    \n    loadPurchases();\n  }, [loadPurchases]);\n\n  return {\n    purchases,\n    loading,\n    currentUserRoles,\n    currentUserName,\n    currentUserEmail,\n    currentUserId,\n    refreshPurchases: loadPurchases,\n    updatePurchaseOptimistic\n  };\n};\n","import { useState, useMemo, useEffect, useCallback } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { Purchase } from './usePurchaseData';\n\n//   -     (  )\nconst HIDDEN_EMPLOYEES = [''];  //  \n\nexport const useFastPurchaseFilters = (purchases: Purchase[], currentUserRoles: string[], currentUserName: string, currentUserId?: string, currentUserEmail?: string) => {\n  const supabase = createClient();\n  const [activeTab, setActiveTab] = useState('pending');\n  //   - hanslwebapp    \n  const [selectedEmployee, setSelectedEmployee] = useState<string>('');\n\n  //   \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  const isFinalApprover = currentUserRoles?.includes('final_approver');\n  const isMiddleManager = currentUserRoles?.includes('middle_manager');\n  const isPurchaseManager = currentUserRoles?.includes('purchase_manager');\n  const hasApprovalRole = isAdmin || isFinalApprover || isMiddleManager;\n  \n  // lead buyer   \n  const isLeadBuyer = currentUserRoles?.includes('raw_material_manager') || \n                      currentUserRoles?.includes('consumable_manager') || \n                      currentUserRoles?.includes('purchase_manager');\n                      \n  // HR   \n  const isHr = currentUserRoles?.includes('hr');\n\n  // hanslwebapp   - roleCase  (lead buyer )\n  const roleCase = useMemo(() => {\n    if (!currentUserRoles || currentUserRoles.length === 0) return 1; // null\n    if (isPurchaseManager) return 2; // purchase_manager\n    if (currentUserRoles.some(r => ['middle_manager', 'final_approver', 'app_admin', 'ceo'].includes(r))) return 3;\n    return 1;\n  }, [currentUserRoles, isPurchaseManager]);\n  \n  //      (,  lead buyer, HR, app_admin  )\n  const computeDefaultEmployee = useCallback(\n    (tabKey: string): string => {\n      if (!currentUserName) return 'all';\n      \n      //   lead buyer, HR, app_admin  \n      if (tabKey === 'purchase') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return 'all';\n        }\n        return currentUserName;\n      }\n      \n      //   lead buyer, HR, app_admin  \n      if (tabKey === 'receipt') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return 'all';\n        }\n        return currentUserName;\n      }\n      \n      switch (roleCase) {\n        case 1: // role null\n          if (tabKey === 'done') return 'all';\n          return currentUserName;\n        case 2: // purchase_manager\n          if (tabKey === 'done') return 'all';\n          return currentUserName; // pending & receipt\n        case 3: //  \n          return 'all';\n        default:\n          return currentUserName;\n      }\n    },\n    [currentUserName, roleCase, isLeadBuyer, isHr, isAdmin]\n  );\n  \n  //    /     (hanslwebapp )\n  useEffect(() => {\n    if (!currentUserName) return;\n    const defaultEmployee = computeDefaultEmployee(activeTab);\n    setSelectedEmployee(defaultEmployee);\n  }, [activeTab, currentUserName, roleCase, computeDefaultEmployee]);\n  \n  // 1:   ( )\n  const visiblePurchases = useMemo(() => {\n    //    -   \n    const hasManagerRole = currentUserRoles.includes('purchase_manager') || currentUserRoles.includes('app_admin');\n    \n    const result = hasManagerRole \n      ? purchases \n      : purchases.filter(p => !HIDDEN_EMPLOYEES.includes(p.requester_name));\n    return result;\n  }, [purchases, currentUserRoles]);\n\n\n  // 2:  \n  const tabFilteredPurchases = useMemo(() => {\n    //    (  )\n    const today = new Date().toISOString().split('T')[0];\n    \n    const result = visiblePurchases.filter((purchase: Purchase) => {\n      let matches = false;\n      \n      switch (activeTab) {\n        case 'pending':\n          //     pending \n          const middlePending = ['pending', '', '', null, undefined].includes(purchase.middle_manager_status as any);\n          const finalPending = ['pending', '', '', null, undefined].includes(purchase.final_manager_status as any);\n          \n          //   \n          const middleRejected = purchase.middle_manager_status === 'rejected';\n          const finalRejected = purchase.final_manager_status === 'rejected';\n          \n          if (middleRejected || finalRejected) return false;\n          \n          //     \n          const middleApproved = purchase.middle_manager_status === 'approved';\n          const finalApproved = purchase.final_manager_status === 'approved';\n          \n          if (middleApproved && finalApproved) {\n            return false; //      \n          }\n          \n          //     \n          matches = middlePending || finalPending;\n          \n          return matches;\n          \n        case 'purchase': {\n          // DB  : ' ' ( )  ''\n          const isRequest = purchase.payment_category === ' ';\n          const isSeonJin = (purchase.progress_type || '').includes('');\n          const isIlban = (purchase.progress_type || '').includes('');\n          const finalApproved = purchase.final_manager_status === 'approved';\n          \n          //     \n          if (purchase.is_payment_completed) {\n            return false; //    \n          }\n          \n          //   :     \n          if (!isRequest) {\n            matches = false;\n          } else {\n            matches = (isSeonJin) || (isIlban && finalApproved);\n          }\n          \n          return matches;\n        }\n        \n        case 'receipt': {\n          // :  & ( or )\n          const isSeonJin = (purchase.progress_type || '').includes('');\n          const finalApproved = purchase.final_manager_status === 'approved';\n          \n          //     \n          if (purchase.is_received) {\n            return false; //    \n          }\n          \n          //   : ( or )\n          matches = (isSeonJin || finalApproved);\n          return matches;\n        }\n        \n        case 'done':\n          matches = true;\n          return matches;\n          \n        default:\n          return true;\n      }\n    });\n    return result;\n  }, [visiblePurchases, activeTab]);\n\n  // 3:  \n  const employeeFilteredPurchases = useMemo(() => {\n    let result;\n    if (selectedEmployee && selectedEmployee !== 'all' && selectedEmployee !== '') {\n      result = tabFilteredPurchases.filter((purchase: Purchase) => purchase.requester_name === selectedEmployee);\n    } else {\n      result = tabFilteredPurchases;\n    }\n    return result;\n  }, [tabFilteredPurchases, selectedEmployee]);\n\n  // 4:      -  ()\n  const filteredPurchases = useMemo(() => {\n    return [...employeeFilteredPurchases].sort((a, b) => {\n      const dateA = a.request_date ? new Date(a.request_date).getTime() : 0\n      const dateB = b.request_date ? new Date(b.request_date).getTime() : 0\n      return dateB - dateA\n    })\n  }, [employeeFilteredPurchases]);\n\n  //   (hanslwebapp  )\n  const tabCounts = useMemo(() => {\n    //     \n    const countPurchases = visiblePurchases;\n    \n    //    -   \n    const dateFilteredForCount = countPurchases;\n    \n    //      ( )\n    const getUniqueOrderCount = (filtered: Purchase[]) => {\n      return new Set(filtered.map(p => p.purchase_order_number)).size;\n    };\n    \n    //       ()\n    const getFilteredDataForTab = (tabKey: string) => {\n      //    \n      if (tabKey === 'purchase') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return countPurchases;\n        } else {\n          return countPurchases.filter((p: Purchase) => p.requester_name === currentUserName);\n        }\n      }\n      \n      //    \n      if (tabKey === 'receipt') {\n        if (isLeadBuyer || isHr || isAdmin) {\n          return countPurchases;\n        } else {\n          return countPurchases.filter((p: Purchase) => p.requester_name === currentUserName);\n        }\n      }\n      \n      const defaultEmployee = computeDefaultEmployee(tabKey);\n      \n      if (defaultEmployee === 'all' || defaultEmployee === '') {\n        return countPurchases;\n      } else {\n        return countPurchases.filter((p: Purchase) => p.requester_name === defaultEmployee);\n      }\n    };\n    \n    //    \n    const pendingData = getFilteredDataForTab('pending');\n    const purchaseData = getFilteredDataForTab('purchase');\n    const receiptData = getFilteredDataForTab('receipt');\n    const doneData = getFilteredDataForTab('done');\n    \n    const pendingFiltered = pendingData.filter((p: Purchase) => {\n      //  \n      const today = new Date().toISOString().split('T')[0];\n      \n      //     pending \n      const middlePending = ['pending', '', '', null, undefined].includes(p.middle_manager_status as any);\n      const finalPending = ['pending', '', '', null, undefined].includes(p.final_manager_status as any);\n      \n      //   \n      const middleRejected = p.middle_manager_status === 'rejected';\n      const finalRejected = p.final_manager_status === 'rejected';\n      \n      if (middleRejected || finalRejected) return false;\n      \n      //     \n      const middleApproved = p.middle_manager_status === 'approved';\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      if (middleApproved && finalApproved) {\n        return false; //      \n      }\n      \n      //     \n      return middlePending || finalPending;\n    });\n    \n    const purchaseFiltered = purchaseData.filter((p: Purchase) => {\n      //  \n      const today = new Date().toISOString().split('T')[0];\n      \n      const isRequest = p.payment_category === ' ';\n      const isSeonJin = (p.progress_type || '').includes('');\n      const isIlban = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      //     \n      if (p.is_payment_completed) {\n        return false; //    \n      }\n      \n      if (!isRequest) return false;\n      return (isSeonJin) || (isIlban && finalApproved);\n    });\n    \n    const receiptFiltered = receiptData.filter((p: Purchase) => {\n      //  \n      const today = new Date().toISOString().split('T')[0];\n      \n      const isSeonJin = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      //     \n      if (p.is_received) {\n        return false; //    \n      }\n      \n      return (isSeonJin || finalApproved);\n    });\n    \n    const counts = {\n      pending: getUniqueOrderCount(pendingFiltered),\n      purchase: getUniqueOrderCount(purchaseFiltered),\n      receipt: getUniqueOrderCount(receiptFiltered),\n      done: getUniqueOrderCount(doneData)  //  \n    };\n    \n    return counts;\n  }, [visiblePurchases, roleCase, currentUserName, computeDefaultEmployee, isLeadBuyer, isHr, isAdmin]);\n\n\n  return {\n    // States\n    activeTab,\n    selectedEmployee,\n    \n    // Setters\n    setActiveTab,\n    setSelectedEmployee,\n    \n    // Computed values\n    filteredPurchases,\n    tabCounts\n  };\n};","import { memo, lazy, Suspense } from 'react';\nimport { Purchase } from '@/hooks/usePurchaseData';\n\n// Lazy load the heavy table component\nconst FastPurchaseTable = lazy(() => import('./FastPurchaseTable'));\n\ninterface LazyPurchaseTableProps {\n  purchases: Purchase[];\n  activeTab: string;\n  currentUserRoles: string[];\n  onRefresh: (forceRefresh?: boolean, options?: { silent?: boolean }) => Promise<void> | void;\n  onOptimisticUpdate: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void;\n  onPaymentComplete: (id: number) => Promise<void>;\n  onReceiptComplete: (id: number) => Promise<void>;\n}\n\n// Memoized loading component\nconst TableSkeleton = memo(() => (\n  <div className=\"p-4 space-y-4\">\n    {[...Array(5)].map((_, i) => (\n      <div key={i} className=\"flex space-x-4 animate-pulse\">\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n        <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n      </div>\n    ))}\n  </div>\n));\nTableSkeleton.displayName = 'TableSkeleton';\n\n// Main component with memoization\nconst LazyPurchaseTable = memo<LazyPurchaseTableProps>(({\n  purchases,\n  activeTab,\n  currentUserRoles,\n  onRefresh,\n  onOptimisticUpdate,\n  onPaymentComplete,\n  onReceiptComplete\n}) => (\n  <Suspense fallback={<TableSkeleton />}>\n    <FastPurchaseTable\n      purchases={purchases}\n      activeTab={activeTab}\n      currentUserRoles={currentUserRoles}\n      onRefresh={onRefresh}\n      onOptimisticUpdate={onOptimisticUpdate}\n      onPaymentComplete={onPaymentComplete}\n      onReceiptComplete={onReceiptComplete}\n    />\n  </Suspense>\n));\n\nLazyPurchaseTable.displayName = 'LazyPurchaseTable';\n\nexport default LazyPurchaseTable;","import { useState, useRef, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { \n  Sliders, \n  ArrowUpDown, \n  Search, \n  X, \n  Calendar,\n  Check,\n  User,\n  Building,\n  Package,\n  DollarSign,\n  CheckCircle\n} from 'lucide-react'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Badge } from '@/components/ui/badge'\nimport { Calendar as CalendarComponent } from '@/components/ui/calendar'\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n} from '@/components/ui/command'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\n\n//   \ntype FilterCondition = 'contains' | 'equals' | 'starts_with' | 'ends_with' | 'is_empty' | 'is_not_empty' | 'greater_than' | 'less_than' | 'after' | 'before' | 'not_equals'\n\n//   \nexport interface FilterRule {\n  id: string\n  field: string\n  condition: FilterCondition\n  value: string | number | Date\n  label: string\n  dateField?: string // /    \n}\n\nexport interface SortRule {\n  field: string\n  direction: 'asc' | 'desc'\n  label: string\n}\n\ninterface FilterToolbarProps {\n  activeFilters: FilterRule[]\n  sortConfig: SortRule | null\n  searchTerm: string\n  onFiltersChange: (filters: FilterRule[]) => void\n  onSortChange: (sort: SortRule | null) => void\n  onSearchChange: (search: string) => void\n  availableEmployees?: string[]\n  availableVendors?: string[]\n  availableContacts?: string[]\n  availablePaymentSchedules?: string[]\n}\n\n//   \nconst FILTER_FIELDS = [\n  //  \n  { \n    key: 'date_range', \n    label: '', \n    type: 'date_range',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'date_month', \n    label: '', \n    type: 'date_month',\n    icon: Calendar,\n    category: ''\n  },\n  \n  // & \n  { \n    key: 'requester_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  { \n    key: 'vendor_name', \n    label: '', \n    type: 'searchable_select',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'contact_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'purchase_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'item_name', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'specification', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'remark', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'project_vendor', \n    label: 'PJ', \n    type: 'text',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'project_item', \n    label: 'PJ ITEM', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'sales_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'quantity', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'unit_price_value', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'total_amount', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'payment_category', \n    label: '', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '', '']\n  },\n  { \n    key: 'payment_schedule', \n    label: '', \n    type: 'select_with_empty',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'is_payment_completed', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_received', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_statement_received', \n    label: ' ', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_utk_checked', \n    label: 'UTK ', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '']\n  }\n]\n\n//   \nconst TEXT_CONDITIONS = [\n  { value: 'contains', label: '' },\n  { value: 'equals', label: '' },\n  { value: 'starts_with', label: '' },\n  { value: 'ends_with', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst NUMBER_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'greater_than', label: '' },\n  { value: 'less_than', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst DATE_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'after', label: '' },\n  { value: 'before', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst SELECT_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'not_equals', label: '' }\n]\n\n//    \nconst DATE_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'payment_completed_at', label: '' },\n  { value: 'received_at', label: '' },\n  { value: 'created_at', label: '' },\n  { value: 'statement_received_at', label: '' }\n]\n\n//   \nconst SORT_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'purchase_order_number', label: '' },\n  { value: 'vendor_name', label: '' },\n  { value: 'requester_name', label: '' },\n  { value: 'total_amount', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'created_at', label: '' }\n]\n\nexport default function FilterToolbar({\n  activeFilters,\n  sortConfig,\n  searchTerm,\n  onFiltersChange,\n  onSortChange,\n  onSearchChange,\n  availableEmployees = [],\n  availableVendors = [],\n  availableContacts = [],\n  availablePaymentSchedules = []\n}: FilterToolbarProps) {\n  const [isFilterOpen, setIsFilterOpen] = useState(false)\n  const [isSortOpen, setIsSortOpen] = useState(false)\n  const [isSearchExpanded, setIsSearchExpanded] = useState(false)\n  const [newFilter, setNewFilter] = useState<Partial<FilterRule>>({})\n  const [datePickerOpen, setDatePickerOpen] = useState(false)\n  const [monthPickerOpen, setMonthPickerOpen] = useState(false)\n  const [tempDateRange, setTempDateRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempMonth, setTempMonth] = useState<Date | undefined>()\n  const [tempMonthRange, setTempMonthRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempSort, setTempSort] = useState<{field?: string, direction?: 'asc' | 'desc'}>({})\n  const searchInputRef = useRef<HTMLInputElement>(null)\n\n  //    \n  useEffect(() => {\n    if (isSearchExpanded && searchInputRef.current) {\n      searchInputRef.current.focus()\n    }\n  }, [isSearchExpanded])\n\n  //       \n  useEffect(() => {\n    if (isSortOpen) {\n      setTempSort({\n        field: sortConfig?.field || '',\n        direction: sortConfig?.direction || 'asc'\n      })\n    }\n  }, [isSortOpen, sortConfig])\n\n  const handleAddFilter = (field: string) => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === field)\n    if (!fieldConfig) return\n\n    //      \n    let defaultCondition = 'contains'\n    if (fieldConfig.type === 'date_range' || fieldConfig.type === 'date_month') {\n      defaultCondition = 'equals'\n    }\n\n    setNewFilter({\n      id: `${field}_${Date.now()}`,\n      field,\n      condition: defaultCondition,\n      value: '',\n      label: fieldConfig.label\n    })\n  }\n\n  const handleApplyFilter = () => {\n    const isDateFilter = newFilter.field === 'date_range' || newFilter.field === 'date_month'\n    const requiresDateField = isDateFilter && !newFilter.dateField\n    \n    //      \n    let finalCondition = newFilter.condition\n    if (!finalCondition) {\n      if (isDateFilter) {\n        finalCondition = 'equals'\n      } else {\n        //   'contains',   'equals'\n        const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n        finalCondition = (fieldConfig?.type === 'select' || fieldConfig?.type === 'select_with_empty' || fieldConfig?.type === 'searchable_select') \n          ? 'equals' \n          : 'contains'\n      }\n    }\n    \n    if (newFilter.field && finalCondition !== undefined && newFilter.value !== '' && !requiresDateField) {\n      const filter: FilterRule = {\n        id: newFilter.id!,\n        field: newFilter.field,\n        condition: finalCondition,\n        value: newFilter.value,\n        label: newFilter.label!,\n        dateField: newFilter.dateField //    \n      }\n      onFiltersChange([...activeFilters, filter])\n      setNewFilter({})\n      setIsFilterOpen(false)\n    }\n  }\n\n  const handleRemoveFilter = (filterId: string) => {\n    onFiltersChange(activeFilters.filter(f => f.id !== filterId))\n  }\n\n  const handleClearAllFilters = () => {\n    onFiltersChange([])\n    setIsFilterOpen(false)\n  }\n\n  const handleSortFieldChange = (field: string) => {\n    setTempSort(prev => ({ ...prev, field }))\n  }\n\n  const handleSortDirectionChange = (direction: 'asc' | 'desc') => {\n    setTempSort(prev => ({ ...prev, direction }))\n  }\n\n  const handleApplySort = () => {\n    if (tempSort.field && tempSort.direction) {\n      const fieldConfig = SORT_FIELDS.find(f => f.value === tempSort.field)\n      if (fieldConfig) {\n        onSortChange({\n          field: tempSort.field,\n          direction: tempSort.direction,\n          label: fieldConfig.label\n        })\n      }\n    }\n    setIsSortOpen(false)\n    setTempSort({})\n  }\n\n  const handleClearSort = () => {\n    onSortChange(null)\n    setTempSort({})\n    setIsSortOpen(false)\n  }\n\n  const getConditionOptions = (fieldType: string) => {\n    switch (fieldType) {\n      case 'text':\n      case 'searchable_select':\n        return TEXT_CONDITIONS\n      case 'number':\n        return NUMBER_CONDITIONS\n      case 'date_range':\n      case 'date_month':\n        return DATE_CONDITIONS\n      case 'select':\n      case 'select_with_empty':\n        return SELECT_CONDITIONS\n      default:\n        return TEXT_CONDITIONS\n    }\n  }\n\n  const renderValueInput = () => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n    if (!fieldConfig) return null\n\n    switch (fieldConfig.type) {\n      case 'text':\n        return (\n          <Input\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n      \n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            placeholder=\" \"\n            value={newFilter.value || ''}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n\n      case 'searchable_select':\n        let options: string[] = []\n        let placeholder = \"\"\n        if (fieldConfig.key === 'requester_name') {\n          options = availableEmployees\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'vendor_name') {\n          options = availableVendors\n          placeholder = \"\"\n        } else if (fieldConfig.key === 'contact_name') {\n          options = availableContacts\n          placeholder = \"\"\n        }\n\n        return (\n          <Popover>\n            <PopoverTrigger asChild>\n              <Button\n                variant=\"outline\"\n                role=\"combobox\"\n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between [&>svg]:hidden\"\n              >\n                <span className=\"truncate text-left\" style={{fontSize: '12px', fontWeight: '500'}}>\n                  {newFilter.value || placeholder}\n                </span>\n                <Search className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-[200px] p-0 border-0 shadow-lg\" align=\"start\">\n              <Command className=\"border-0\">\n                <CommandInput placeholder={`${placeholder} ...`} className=\"h-auto border-0 focus:ring-0 focus:outline-none card-description placeholder:card-description\" style={{padding: '2px 10px'}} />\n                <CommandEmpty>{placeholder}   .</CommandEmpty>\n                <CommandGroup className=\"max-h-[200px] overflow-y-auto\">\n                  {options.map(option => (\n                    <CommandItem\n                      key={option}\n                      value={option}\n                      onSelect={(value) => {\n                        setNewFilter(prev => ({ ...prev, value: value }));\n                      }}\n                      className=\"cursor-pointer\"\n                    >\n                      <Check\n                        className={`mr-2 h-3 w-3 ${\n                          newFilter.value === option ? \"opacity-100\" : \"opacity-0\"\n                        }`}\n                      />\n                      <span className=\"card-description\">{option}</span>\n                    </CommandItem>\n                  ))}\n                </CommandGroup>\n              </Command>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'select':\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {fieldConfig.options?.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'select_with_empty':\n        const scheduleOptions = ['', ...availablePaymentSchedules]\n        return (\n          <Select value={newFilter.value || ''} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {scheduleOptions.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'date_range':\n        return (\n          <Popover open={datePickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempDateRange({\n                    from: new Date(start),\n                    to: new Date(end)\n                  });\n                } else {\n                  setTempDateRange({\n                    from: new Date(newFilter.value),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempDateRange({});\n              }\n            }\n            setDatePickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5 min-h-[32px]\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        return `${format(new Date(start), 'yy/MM/dd')}\\n~ ${format(new Date(end), 'yy/MM/dd')}`;\n                      } else {\n                        return format(new Date(newFilter.value), 'yy/MM/dd');\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-2\">  </div>\n                  <CalendarComponent\n                    mode=\"range\"\n                    selected={tempDateRange}\n                    onSelect={(range) => {\n                      if (range) {\n                        setTempDateRange(range);\n                      }\n                    }}\n                    numberOfMonths={1}\n                    initialFocus\n                    className=\"compact-calendar\"\n                  />\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempDateRange({});\n                      setDatePickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempDateRange.from) {\n                        if (tempDateRange.to) {\n                          // ~ \n                          const rangeValue = `${format(tempDateRange.from, 'yyyy-MM-dd')}~${format(tempDateRange.to, 'yyyy-MM-dd')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  ( )\n                          setNewFilter(prev => ({ ...prev, value: format(tempDateRange.from, 'yyyy-MM-dd') }));\n                        }\n                        setDatePickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempDateRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'date_month':\n        return (\n          <Popover open={monthPickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value) {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempMonthRange({\n                    from: new Date(`${start}-01`),\n                    to: new Date(`${end}-01`)\n                  });\n                } else {\n                  setTempMonthRange({\n                    from: new Date(`${newFilter.value}-01`),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempMonthRange({});\n              }\n            }\n            setMonthPickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        const [startYear, startMonth] = start.split('-');\n                        const [endYear, endMonth] = end.split('-');\n                        return `${startYear.slice(-2)}/${startMonth}\\n~ ${endYear.slice(-2)}/${endMonth}`;\n                      } else {\n                        const [year, month] = newFilter.value.split('-');\n                        return `${year.slice(-2)}/${month}`;\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-3\"> </div>\n                  \n                  {/*   -  12  */}\n                  <div className=\"flex gap-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"text-xs text-gray-500 mb-2\">  </div>\n                      {/*   */}\n                      <div className=\"mb-3\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear - 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                          <span className=\"text-sm font-medium text-gray-700\">\n                            {tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear()}\n                          </span>\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear + 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                        </div>\n                      </div>\n                      \n                      {/* 12  */}\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        {Array.from({ length: 12 }, (_, i) => {\n                          const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                          const monthDate = new Date(currentYear, i, 1);\n                          const isSelected = tempMonthRange.from && \n                            tempMonthRange.from.getFullYear() === currentYear && \n                            tempMonthRange.from.getMonth() === i;\n                          \n                          return (\n                            <Button\n                              key={i}\n                              onClick={() => {\n                                setTempMonthRange(prev => ({ ...prev, from: monthDate }));\n                              }}\n                              variant=\"outline\"\n                              className={`button-base text-xs h-8 ${\n                                isSelected \n                                  ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                  : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                              }`}\n                            >\n                              {i + 1}\n                            </Button>\n                          );\n                        })}\n                      </div>\n                    </div>\n                    \n                    {tempMonthRange.from && (\n                      <div className=\"flex-1\">\n                        <div className=\"text-xs text-gray-500 mb-2\">   ()</div>\n                        {/*     */}\n                        <div className=\"mb-3\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear - 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                            <span className=\"text-sm font-medium text-gray-700\">\n                              {tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear()}\n                            </span>\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                                const newDate = new Date(currentYear + 1, tempMonthRange.to ? tempMonthRange.to.getMonth() : 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                          </div>\n                        </div>\n                        \n                        {/*   12  */}\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {Array.from({ length: 12 }, (_, i) => {\n                            const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from.getFullYear();\n                            const monthDate = new Date(currentYear, i, 1);\n                            const isSelected = tempMonthRange.to && \n                              tempMonthRange.to.getFullYear() === currentYear && \n                              tempMonthRange.to.getMonth() === i;\n                            const isDisabled = monthDate < tempMonthRange.from;\n                            \n                            return (\n                              <Button\n                                key={i}\n                                onClick={() => {\n                                  if (!isDisabled) {\n                                    setTempMonthRange(prev => ({ ...prev, to: monthDate }));\n                                  }\n                                }}\n                                variant=\"outline\"\n                                disabled={isDisabled}\n                                className={`button-base text-xs h-8 ${\n                                  isSelected \n                                    ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                    : isDisabled\n                                    ? 'border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed'\n                                    : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                                }`}\n                              >\n                                {i + 1}\n                              </Button>\n                            );\n                          })}\n                        </div>\n                        \n                        <div className=\"mt-3\">\n                          <Button\n                            onClick={() => {\n                              setTempMonthRange(prev => ({ ...prev, to: undefined }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50 text-xs\"\n                          >\n                              \n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempMonthRange({});\n                      setMonthPickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempMonthRange.from) {\n                        if (tempMonthRange.to) {\n                          //  \n                          const rangeValue = `${format(tempMonthRange.from, 'yyyy-MM')}~${format(tempMonthRange.to, 'yyyy-MM')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  \n                          setNewFilter(prev => ({ ...prev, value: format(tempMonthRange.from, 'yyyy-MM') }));\n                        }\n                        setMonthPickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempMonthRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"w-full space-y-3\">\n      {/*   */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          {/*   */}\n          <Popover open={isFilterOpen} onOpenChange={setIsFilterOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Sliders className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {activeFilters.length > 0 && (\n                  <Badge variant=\"secondary\" className=\"ml-1 badge-stats-primary\">\n                    {activeFilters.length}\n                  </Badge>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-64 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"card-title\"></h4>\n                  {activeFilters.length > 0 && (\n                    <Button\n                      variant=\"ghost\"\n                      onClick={handleClearAllFilters}\n                      className=\"button-base text-red-600 hover:text-red-700 hover:bg-red-50\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  )}\n                </div>\n\n                {/*    */}\n                {activeFilters.length > 0 && (\n                  <div className=\"space-y-2\">\n                    {activeFilters.map(filter => (\n                      <div key={filter.id} className=\"flex items-center justify-between p-2 bg-gray-50 business-radius\">\n                        <span className=\"card-description\">\n                          {filter.label}\n                          {filter.dateField && (\n                            <span className=\"text-blue-600\">\n                              ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                            </span>\n                          )}\n                          : {filter.value}\n                        </span>\n                        <Button\n                          variant=\"ghost\"\n                          onClick={() => handleRemoveFilter(filter.id)}\n                          className=\"button-base h-6 w-6 p-0 hover:bg-red-50\"\n                        >\n                          <X className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                    <div className=\"border-t border-gray-200 my-2\" />\n                  </div>\n                )}\n\n                {/*    */}\n                <div className=\"space-y-2\">\n                  <Select onValueChange={handleAddFilter}>\n                    <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n                      <SelectValue placeholder=\"+  \" />\n                    </SelectTrigger>\n                    <SelectContent \n                      className=\"w-64 max-h-80 overflow-y-auto\"\n                      style={{\n                        scrollbarWidth: 'auto',\n                        scrollbarColor: '#9ca3af #f3f4f6',\n                        WebkitScrollbarWidth: '8px'\n                      }}\n                    >\n                      {Object.entries(\n                        FILTER_FIELDS.reduce((acc, field) => {\n                          if (!acc[field.category]) acc[field.category] = []\n                          acc[field.category].push(field)\n                          return acc\n                        }, {} as Record<string, typeof FILTER_FIELDS>)\n                      ).map(([category, fields]) => (\n                        <div key={category}>\n                          <div className=\"px-2 py-1 card-description uppercase\">\n                            {category}\n                          </div>\n                          {fields.map(field => (\n                            <SelectItem key={field.key} value={field.key}>\n                              <div className=\"flex items-center gap-2\">\n                                <field.icon className=\"w-4 h-4\" />\n                                <span className=\"card-description\">{field.label}</span>\n                              </div>\n                            </SelectItem>\n                          ))}\n                        </div>\n                      ))}\n                    </SelectContent>\n                  </Select>\n\n                  {/*   UI */}\n                  {newFilter.field && (\n                    <div className=\"space-y-2 p-3 border business-radius bg-white\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"card-title\">{newFilter.label} </span>\n                      </div>\n                      \n                      {/*    */}\n                      {(newFilter.field === 'date_range' || newFilter.field === 'date_month') ? (\n                        <div className=\"grid grid-cols-2 gap-2\">\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            <Select \n                              value={newFilter.dateField || ''} \n                              onValueChange={(value) => setNewFilter(prev => ({ ...prev, dateField: value }))}\n                            >\n                              <SelectTrigger className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center justify-center\">\n                                <SelectValue placeholder=\" \" className=\"text-center\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                {DATE_FIELDS.map(dateField => (\n                                  <SelectItem key={dateField.value} value={dateField.value}>\n                                    <span className=\"card-description\">{dateField.label}</span>\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                          </div>\n\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            {renderValueInput()}\n                          </div>\n                        </div>\n                      ) : (\n                        /*    -       */\n                        <div>\n                          {renderValueInput()}\n                        </div>\n                      )}\n\n                      <div className=\"flex gap-2\">\n                        <Button\n                          onClick={handleApplyFilter}\n                          disabled={\n                            !newFilter.field || \n                            newFilter.value === '' ||\n                            ((newFilter.field === 'date_range' || newFilter.field === 'date_month') && !newFilter.dateField)\n                          }\n                          className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                        >\n                          \n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => setNewFilter({})}\n                          className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                        >\n                          \n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <Popover open={isSortOpen} onOpenChange={setIsSortOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <ArrowUpDown className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {sortConfig && (\n                  <span className=\"ml-1 card-description\">\n                    ({sortConfig.direction === 'asc' ? '' : ''})\n                  </span>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-56 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <h4 className=\"card-title\"> </h4>\n                \n                <div className=\"space-y-2\">\n                  {/*    */}\n                  <div>\n                    <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                    <Select \n                      value={tempSort.field || ''} \n                      onValueChange={handleSortFieldChange}\n                    >\n                      <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                        <SelectValue placeholder=\"\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {SORT_FIELDS.map(field => (\n                          <SelectItem key={field.value} value={field.value}>\n                            <span className=\"card-description\">{field.label}</span>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  {/*    */}\n                  {tempSort.field && (\n                    <div>\n                      <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                      <Select \n                        value={tempSort.direction || ''} \n                        onValueChange={handleSortDirectionChange}\n                      >\n                        <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                          <SelectValue placeholder=\"\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"asc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                          <SelectItem value=\"desc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n\n                  {/* /  */}\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button \n                      onClick={handleApplySort}\n                      disabled={!tempSort.field || !tempSort.direction}\n                      className=\"button-base bg-blue-500 hover:bg-blue-600 text-white flex-1\"\n                    >\n                      \n                    </Button>\n                    <Button \n                      onClick={handleClearSort}\n                      className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n                    >\n                      \n                    </Button>\n                  </div>\n                </div>\n\n                {sortConfig && (\n                  <div className=\"border-t pt-2\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => onSortChange(null)}\n                      className=\"button-base w-full border border-gray-300 text-gray-700\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <div className=\"flex items-center gap-2\">\n            {!isSearchExpanded ? (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsSearchExpanded(true)}\n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Search className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n              </Button>\n            ) : (\n              <div className=\"flex items-center gap-2\">\n                <Input\n                  ref={searchInputRef}\n                  placeholder=\" ...\"\n                  value={searchTerm}\n                  onChange={(e) => onSearchChange(e.target.value)}\n                  className=\"w-64 business-radius-input button-base border border-gray-300 bg-white text-gray-700\"\n                />\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => {\n                    setIsSearchExpanded(false)\n                    onSearchChange('')\n                  }}\n                  className=\"button-base h-8 w-8 p-0\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/*    */}\n          <Button\n            variant=\"outline\"\n            onClick={() => {\n              onSearchChange('')\n              onFiltersChange([])\n              onSortChange({\n                field: 'created_at',\n                direction: 'desc',\n                label: ''\n              })\n              setIsSearchExpanded(false)\n            }}\n            className=\"button-base border border-gray-300 bg-white text-blue-600 hover:bg-blue-50 hover:border-blue-300\"\n          >\n             <span className=\"button-text text-blue-600\"></span>\n          </Button>\n        </div>\n      </div>\n\n      {/*    */}\n      {activeFilters.length > 0 && (\n        <div className=\"flex flex-wrap gap-2\">\n          {activeFilters.map(filter => (\n            <Badge\n              key={filter.id}\n              variant=\"secondary\"\n              className=\"badge-base flex items-center gap-1 bg-blue-50 text-blue-700 border-blue-200\"\n            >\n              {filter.label}\n              {filter.dateField && (\n                <span className=\"text-blue-600\">\n                  ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                </span>\n              )}\n              : {filter.value}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handleRemoveFilter(filter.id)}\n                className=\"h-4 w-4 p-0 hover:bg-blue-100 ml-1\"\n              >\n                <X className=\"w-3 h-3\" />\n              </Button>\n            </Badge>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}","\nimport { useState, lazy, Suspense, useEffect, useCallback, useMemo, useRef } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { usePurchaseData } from \"@/hooks/usePurchaseData\";\nimport { useFastPurchaseFilters } from \"@/hooks/useFastPurchaseFilters\";\nimport LazyPurchaseTable from \"@/components/purchase/LazyPurchaseTable\";\nimport FilterToolbar, { FilterRule, SortRule } from \"@/components/purchase/FilterToolbar\";\n\nimport { Plus, Package, Info } from \"lucide-react\";\nimport { generatePurchaseOrderExcelJS, PurchaseOrderData } from \"@/utils/exceljs/generatePurchaseOrderExcel\";\n\n// Lazy load modal for better performance\nconst PurchaseItemsModal = lazy(() => import(\"@/components/purchase/PurchaseItemsModal\"));\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n// Tabs     (hanslwebapp )\nimport { Button } from \"@/components/ui/button\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { Purchase } from \"@/hooks/usePurchaseData\";\nimport { logger } from \"@/lib/logger\";\n\ninterface PurchaseListMainProps {\n  //      \n  onEmailToggle?: () => void;\n  showEmailButton?: boolean;\n}\n\n//   () \nconst NAV_TABS: { key: string; label: string }[] = [\n  { key: 'pending', label: '' },\n  { key: 'purchase', label: ' ' },\n  { key: 'receipt', label: ' ' },\n  { key: 'done', label: ' ' },\n];\n\n//    \nexport default function PurchaseListMain({ showEmailButton = true }: PurchaseListMainProps) {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const supabase = createClient();\n  const [selectedPurchase, setSelectedPurchase] = useState<Purchase | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  \n  //    \n  const [activeFilters, setActiveFilters] = useState<FilterRule[]>([]);\n  const [sortConfig, setSortConfig] = useState<SortRule | null>({\n    field: 'created_at',\n    direction: 'desc',\n    label: ''\n  });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [availableEmployees, setAvailableEmployees] = useState<string[]>([]);\n  const [availableVendors, setAvailableVendors] = useState<string[]>([]);\n  const [availableContacts, setAvailableContacts] = useState<string[]>([]);\n  const [availablePaymentSchedules, setAvailablePaymentSchedules] = useState<string[]>([]);\n  \n  //     \n  const {\n    purchases,\n    loading,\n    currentUserRoles,\n    currentUserName,\n    currentUserEmail,\n    currentUserId,\n    refreshPurchases: loadPurchases,\n    updatePurchaseOptimistic\n  } = usePurchaseData();\n  \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  \n\n  //    \n  const {\n    activeTab,\n    selectedEmployee,\n    setActiveTab,\n    setSelectedEmployee,\n    filteredPurchases,\n    tabCounts\n  } = useFastPurchaseFilters(purchases, currentUserRoles, currentUserName, currentUserId, currentUserEmail);\n  \n  // URL    \n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const tab = searchParams.get('tab');\n    if (tab === 'purchase') {\n      setActiveTab('purchase');\n    }\n  }, [location.search, setActiveTab]);\n\n  //    \n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        //   (employees )\n        const { data: employees } = await supabase\n          .from('employees')\n          .select('name');\n        \n        if (employees) {\n          const employeeNames = [...new Set(employees.map((e: any) => e.name).filter(Boolean))];\n          setAvailableEmployees(employeeNames as string[]);\n        }\n\n        //   (vendors )\n        const { data: vendors } = await supabase\n          .from('vendors')\n          .select('vendor_name');\n        \n        if (vendors) {\n          const vendorNames = [...new Set(vendors.map((v: any) => v.vendor_name).filter(Boolean))];\n          setAvailableVendors(vendorNames as string[]);\n        }\n\n        //   (vendor_contacts )\n        const { data: contacts } = await supabase\n          .from('vendor_contacts')\n          .select('contact_name');\n        \n        if (contacts) {\n          const contactNames = [...new Set(contacts.map((c: any) => c.contact_name).filter(Boolean))];\n          setAvailableContacts(contactNames as string[]);\n        }\n\n        //   (vendors  vendor_payment_schedule)\n        const { data: schedules } = await supabase\n          .from('vendors')\n          .select('vendor_payment_schedule');\n        \n        if (schedules) {\n          const scheduleNames = [...new Set(schedules.map((s: any) => s.vendor_payment_schedule).filter(Boolean))];\n          setAvailablePaymentSchedules(scheduleNames as string[]);\n        }\n      } catch (error) {\n        logger.error('    ', error);\n      }\n    };\n\n    loadFilterOptions();\n  }, [supabase]);\n  \n  //       \n  const hasInitializedTabRefresh = useRef(false);\n  useEffect(() => {\n    if (!hasInitializedTabRefresh.current) {\n      hasInitializedTabRefresh.current = true;\n      return;\n    }\n\n    const refreshLatestData = async () => {\n      try {\n        await loadPurchases(true, { silent: true });\n      } catch (error) {\n        logger.error('      ', error);\n      }\n    };\n\n    refreshLatestData();\n  }, [activeTab, loadPurchases]);\n\n\n  //     -  \n  const getStatusBadge = useCallback((purchase: Purchase) => {\n    if (purchase.is_received) {\n      return <Badge variant={null} className=\"badge-success\"></Badge>;\n    } else if (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved') {\n      return <Badge variant={null} className=\"badge-primary\"></Badge>;\n    } else if (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected') {\n      return <Badge variant={null} className=\"badge-danger\"></Badge>;\n    } else {\n      return <Badge variant={null} className=\"badge-warning\"></Badge>;\n    }\n  }, []);\n\n  //   \n  const getReceiptProgress = (purchase: Purchase) => {\n    if (!purchase.items || purchase.items.length === 0) return { received: 0, total: 0, percentage: 0 };\n    \n    const total = purchase.items.length;\n    const received = purchase.items.filter(item => \n      item.actual_received_date !== null && item.actual_received_date !== undefined\n    ).length;\n    const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n    \n    return { received, total, percentage };\n  };\n\n  //   \n  const isAdvancePayment = (progress_type?: string) => {\n    return progress_type === '' || progress_type?.trim() === '' || progress_type?.includes('');\n  };\n\n  //   \n  const applyAdvancedFilters = useCallback((purchases: Purchase[]) => {\n    let filtered = [...purchases];\n\n    //     60  \n    //  (/ ) 60     \n    const hasAnyFilter = activeFilters.length > 0 || searchTerm.trim() !== '';\n    \n    if (!hasAnyFilter) {\n      const sixtyDaysAgo = new Date();\n      sixtyDaysAgo.setDate(sixtyDaysAgo.getDate() - 60);\n      filtered = filtered.filter(purchase => {\n        if (!purchase.request_date) return false;\n        const requestDate = new Date(purchase.request_date);\n        return requestDate >= sixtyDaysAgo;\n      });\n    }\n\n    //  \n    if (searchTerm.trim()) {\n      const searchLower = searchTerm.toLowerCase().trim();\n      filtered = filtered.filter(purchase => \n        purchase.purchase_order_number?.toLowerCase().includes(searchLower) ||\n        purchase.vendor_name?.toLowerCase().includes(searchLower) ||\n        purchase.requester_name?.toLowerCase().includes(searchLower) ||\n        purchase.item_name?.toLowerCase().includes(searchLower) ||\n        purchase.specification?.toLowerCase().includes(searchLower) ||\n        purchase.remark?.toLowerCase().includes(searchLower) ||\n        purchase.project_vendor?.toLowerCase().includes(searchLower) ||\n        purchase.project_item?.toLowerCase().includes(searchLower) ||\n        purchase.sales_order_number?.toLowerCase().includes(searchLower)\n      );\n    }\n\n    //   \n    activeFilters.forEach(filter => {\n      \n      filtered = filtered.filter(purchase => {\n        //       \n        const actualField = (filter.field === 'date_range' || filter.field === 'date_month') \n          ? filter.dateField || filter.field \n          : filter.field;\n        \n        const fieldValue = getFieldValue(purchase, actualField);\n        \n        //    \n        const filterFieldType = filter.field === 'date_month' ? 'date_month' : \n                               filter.field === 'date_range' ? 'date_range' : undefined;\n        \n        const result = applyFilterCondition(fieldValue, filter.condition, filter.value, filterFieldType);\n        \n        \n        return result;\n      });\n      \n    });\n\n    return filtered;\n  }, [searchTerm, activeFilters]);\n\n  //    \n  const getFieldValue = (purchase: Purchase, field: string): any => {\n    switch (field) {\n      case 'purchase_order_number':\n        return purchase.purchase_order_number;\n      case 'payment_category':\n        return purchase.payment_category;\n      case 'requester_name':\n        return purchase.requester_name;\n      case 'vendor_name':\n        return purchase.vendor_name;\n      case 'contact_name':\n        return purchase.contact_name;\n      case 'item_name':\n        return purchase.item_name;\n      case 'specification':\n        return purchase.specification;\n      case 'quantity':\n        return purchase.quantity;\n      case 'unit_price_value':\n        return purchase.unit_price_value;\n      case 'total_amount':\n        return purchase.total_amount;\n      case 'remark':\n        return purchase.remark;\n      case 'project_vendor':\n        return purchase.project_vendor;\n      case 'project_item':\n        return purchase.project_item;\n      case 'sales_order_number':\n        return purchase.sales_order_number;\n      case 'payment_schedule':\n        return (purchase as any).vendor_payment_schedule;\n      case 'is_payment_completed':\n        return purchase.is_payment_completed ? '' : '';\n      case 'is_received':\n        return purchase.is_received ? '' : '';\n      case 'is_statement_received':\n        return (purchase as any).is_statement_received ? '' : '';\n      case 'is_utk_checked':\n        return (purchase as any).is_utk_checked ? '' : '';\n      case 'request_date':\n        return purchase.request_date;\n      case 'delivery_request_date':\n        return purchase.delivery_request_date;\n      case 'payment_completed_at':\n        return purchase.payment_completed_at;\n      case 'received_at':\n        return purchase.received_at;\n      case 'created_at':\n        return (purchase as any).created_at;\n      case 'statement_received_at':\n        return (purchase as any).statement_received_at;\n      default:\n        return null;\n    }\n  };\n\n  //    \n  const applyFilterCondition = (fieldValue: any, condition: string, filterValue: any, filterField?: string): boolean => {\n    if (fieldValue === null || fieldValue === undefined) {\n      return condition === 'is_empty';\n    }\n\n    //      (~)\n    if (filterField === 'date_range' && filterValue && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startDate, endDate] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(startDate);\n      const end = new Date(endDate);\n      \n      //       \n      return fieldDate >= start && fieldDate <= end;\n    }\n\n    //      (~)\n    if (filterField === 'date_month' && filterValue && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startMonth, endMonth] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(`${startMonth}-01`);\n      const end = new Date(`${endMonth}-01`);\n      \n      //    (    )\n      const endOfMonth = new Date(end.getFullYear(), end.getMonth() + 1, 0, 23, 59, 59);\n      return fieldDate >= start && fieldDate <= endOfMonth;\n    }\n\n    //     ( )\n    if (filterField && (filterField === 'date_month' || filterField.endsWith('_month'))) {\n      if (!filterValue) return true;\n      \n      const fieldDate = new Date(fieldValue);\n      const [filterYear, filterMonth] = filterValue.split('-');\n      \n      return fieldDate.getFullYear() === parseInt(filterYear) && \n             (fieldDate.getMonth() + 1) === parseInt(filterMonth);\n    }\n\n    const fieldStr = String(fieldValue).toLowerCase();\n    const filterStr = String(filterValue).toLowerCase();\n\n    switch (condition) {\n      case 'contains':\n        return fieldStr.includes(filterStr);\n      case 'equals':\n        //      \n        if (filterField === 'date_range' || filterValue.match(/^\\d{4}-\\d{2}-\\d{2}/)) {\n          if (!fieldValue) return false;\n          try {\n            const fieldDate = new Date(fieldValue).toISOString().split('T')[0];\n            const filterDate = filterValue.split('T')[0];\n            return fieldDate === filterDate;\n          } catch (error) {\n            logger.error('  :', error);\n            return false;\n          }\n        }\n        return fieldStr === filterStr;\n      case 'starts_with':\n        return fieldStr.startsWith(filterStr);\n      case 'ends_with':\n        return fieldStr.endsWith(filterStr);\n      case 'is_empty':\n        return !fieldValue || fieldStr.trim() === '';\n      case 'is_not_empty':\n        return !!fieldValue && fieldStr.trim() !== '';\n      case 'greater_than':\n        return Number(fieldValue) > Number(filterValue);\n      case 'less_than':\n        return Number(fieldValue) < Number(filterValue);\n      case 'between':\n        //    \n        return true;\n      case 'after':\n        return new Date(fieldValue) > new Date(filterValue);\n      case 'before':\n        return new Date(fieldValue) < new Date(filterValue);\n      case 'not_equals':\n        return fieldStr !== filterStr;\n      default:\n        return true;\n    }\n  };\n\n  //   \n  const applySorting = useCallback((purchases: Purchase[]) => {\n    if (!sortConfig) return purchases;\n\n    return [...purchases].sort((a, b) => {\n      const aValue = getFieldValue(a, sortConfig.field);\n      const bValue = getFieldValue(b, sortConfig.field);\n\n      if (aValue === null || aValue === undefined) return 1;\n      if (bValue === null || bValue === undefined) return -1;\n\n      let comparison = 0;\n      if (typeof aValue === 'number' && typeof bValue === 'number') {\n        comparison = aValue - bValue;\n      } else if (aValue instanceof Date && bValue instanceof Date) {\n        comparison = aValue.getTime() - bValue.getTime();\n      } else {\n        comparison = String(aValue).localeCompare(String(bValue));\n      }\n\n      return sortConfig.direction === 'desc' ? -comparison : comparison;\n    });\n  }, [sortConfig]);\n\n  //      \n  const advancedFilteredPurchases = useMemo(() => {\n    let result = applyAdvancedFilters(filteredPurchases);\n    result = applySorting(result);\n    return result;\n  }, [filteredPurchases, applyAdvancedFilters, applySorting]);\n\n  //        \n  const filteredTabCounts = useMemo(() => {\n    //    (useFastPurchaseFilters  )\n    const HIDDEN_EMPLOYEES = [''];\n    const hasManagerRole = currentUserRoles?.includes('purchase_manager') || currentUserRoles?.includes('app_admin');\n    const visiblePurchases = hasManagerRole \n      ? purchases \n      : purchases.filter(p => !HIDDEN_EMPLOYEES.includes(p.requester_name));\n\n    //  visiblePurchases      (  )\n    //    60   \n    const advancedFiltered = applyAdvancedFilters(visiblePurchases);\n    \n    //     \n    const getUniqueOrderCount = (filtered: Purchase[]) => {\n      return new Set(filtered.map(p => p.purchase_order_number)).size;\n    };\n\n    const pendingFiltered = advancedFiltered.filter((p: Purchase) => {\n      const middlePending = ['pending', '', '', null, undefined].includes(p.middle_manager_status as any);\n      const finalPending = ['pending', '', '', null, undefined].includes(p.final_manager_status as any);\n      const middleRejected = p.middle_manager_status === 'rejected';\n      const finalRejected = p.final_manager_status === 'rejected';\n      \n      if (middleRejected || finalRejected) return false;\n      \n      const middleApproved = p.middle_manager_status === 'approved';\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      if (middleApproved && finalApproved) {\n        return false;\n      }\n      \n      return middlePending || finalPending;\n    });\n\n    const purchaseFiltered = advancedFiltered.filter((p: Purchase) => {\n      const isRequest = p.payment_category === ' ';\n      const isSeonJin = (p.progress_type || '').includes('');\n      const isIlban = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      if (p.is_payment_completed) {\n        return false;\n      }\n      \n      if (!isRequest) return false;\n      return (isSeonJin) || (isIlban && finalApproved);\n    });\n\n    const receiptFiltered = advancedFiltered.filter((p: Purchase) => {\n      const isSeonJin = (p.progress_type || '').includes('');\n      const finalApproved = p.final_manager_status === 'approved';\n      \n      if (p.is_received) {\n        return false;\n      }\n      \n      return (isSeonJin || finalApproved);\n    });\n\n    return {\n      pending: getUniqueOrderCount(pendingFiltered),\n      purchase: getUniqueOrderCount(purchaseFiltered),\n      receipt: getUniqueOrderCount(receiptFiltered),\n      done: getUniqueOrderCount(advancedFiltered)\n    };\n  }, [activeFilters, searchTerm, purchases, applyAdvancedFilters, currentUserRoles]);\n\n  //      \n  const monthlyFilterSummary = useMemo(() => {\n    //     \n    const monthFilters = activeFilters.filter(filter => \n      filter.field === 'date_month' || \n      (filter.field === 'date_range' && filter.dateField && filter.dateField.includes('_month'))\n    );\n    \n    if (monthFilters.length === 0) return null;\n    \n    const monthFilter = monthFilters[0];\n    const filterValue = monthFilter.value;\n    \n    //       \n    if (filterValue && filterValue.includes('~')) {\n      //   (: \"2024-04~2024-09\")\n      const [startMonth, endMonth] = filterValue.split('~');\n      const startDate = new Date(`${startMonth}-01`);\n      const endDate = new Date(`${endMonth}-01`);\n      \n      const monthlyTotals = [];\n      let totalSum = 0;\n      \n      //   \n      const currentDate = new Date(startDate);\n      while (currentDate <= endDate) {\n        const year = currentDate.getFullYear();\n        const month = currentDate.getMonth() + 1;\n        const monthStr = `${year}-${month.toString().padStart(2, '0')}`;\n        \n        //    \n        const monthData = advancedFilteredPurchases.filter(purchase => {\n          const purchaseDate = new Date(purchase.request_date);\n          return purchaseDate.getFullYear() === year && \n                 (purchaseDate.getMonth() + 1) === month;\n        });\n        \n        //    \n        const monthTotal = monthData.reduce((sum, purchase) => {\n          const amount = purchase.amount_value || purchase.total_amount || 0;\n          return sum + amount;\n        }, 0);\n        \n        monthlyTotals.push({\n          year,\n          month,\n          monthStr,\n          total: monthTotal,\n          count: monthData.length\n        });\n        \n        totalSum += monthTotal;\n        \n        //   \n        currentDate.setMonth(currentDate.getMonth() + 1);\n      }\n      \n      return {\n        type: 'range',\n        months: monthlyTotals,\n        grandTotal: totalSum\n      };\n    } else {\n      //    (: \"2024-10\")\n      const [year, month] = filterValue.split('-');\n      const monthData = advancedFilteredPurchases.filter(purchase => {\n        const purchaseDate = new Date(purchase.request_date);\n        return purchaseDate.getFullYear() === parseInt(year) && \n               (purchaseDate.getMonth() + 1) === parseInt(month);\n      });\n      \n      const monthTotal = monthData.reduce((sum, purchase) => {\n        const amount = purchase.amount_value || purchase.total_amount || 0;\n        return sum + amount;\n      }, 0);\n      \n      return {\n        type: 'single',\n        year: parseInt(year),\n        month: parseInt(month),\n        total: monthTotal,\n        count: monthData.length\n      };\n    }\n  }, [activeFilters, advancedFilteredPurchases]);\n\n\n  //  \n  const handleExcelDownload = async (purchase: Purchase) => {\n    try {\n      // DB    \n      const { data: purchaseRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .single();\n\n      if (requestError || !purchaseRequest) {\n        toast.error('     .');\n        return;\n      }\n\n      //   \n      const { data: orderItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .order('line_number');\n\n      if (itemsError || !orderItems || orderItems.length === 0) {\n        toast.error('      .');\n        return;\n      }\n\n      //       \n      const vendorInfo = {\n        vendor_name: purchase.vendor_name,\n        vendor_phone: '',\n        vendor_fax: '',\n        vendor_contact_name: ''\n      };\n\n      try {\n        const vendorId = purchaseRequest.vendor_id || purchase.vendor_id;\n        const contactId = purchaseRequest.contact_id || purchase.contact_id;\n        \n        // vendor  \n        if (vendorId) {\n          const { data: vendorData, error: vendorError } = await supabase\n            .from('vendors')\n            .select('vendor_phone, vendor_fax')\n            .eq('id', vendorId)\n            .single();\n\n          if (vendorData && !vendorError) {\n            vendorInfo.vendor_phone = vendorData.vendor_phone || '';\n            vendorInfo.vendor_fax = vendorData.vendor_fax || '';\n          }\n        }\n\n        // vendor_contacts contact_id   \n        if (contactId) {\n          const { data: contactData, error: contactError } = await supabase\n            .from('vendor_contacts')\n            .select('contact_name, contact_phone, contact_email')\n            .eq('id', contactId)\n            .single();\n          if (contactData && !contactError) {\n            vendorInfo.vendor_contact_name = contactData.contact_name || '';\n          }\n        }\n      } catch (error) {\n      }\n\n      const excelData: PurchaseOrderData = {\n        purchase_order_number: purchaseRequest.purchase_order_number || '',\n        request_date: purchaseRequest.request_date,\n        delivery_request_date: purchaseRequest.delivery_request_date,\n        requester_name: purchaseRequest.requester_name,\n        vendor_name: vendorInfo.vendor_name || '',\n        vendor_contact_name: vendorInfo.vendor_contact_name,\n        vendor_phone: vendorInfo.vendor_phone,\n        vendor_fax: vendorInfo.vendor_fax,\n        project_vendor: purchaseRequest.project_vendor,\n        sales_order_number: purchaseRequest.sales_order_number,\n        project_item: purchaseRequest.project_item,\n        items: orderItems.map((item: any) => ({\n          line_number: item.line_number,\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          amount_value: item.amount_value,\n          remark: item.remark,\n          currency: purchaseRequest.currency || 'KRW'\n        }))\n      };\n\n      //   ExcelJS  (    )\n      const blob = await generatePurchaseOrderExcelJS(excelData);\n      \n      //  : _{}_\n      const downloadFilename = `_${excelData.vendor_name}_${excelData.purchase_order_number}.xlsx`;\n\n      //    \n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = downloadFilename;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success('  .');\n      \n      // DB   (is_po_download)  - lead buyer \n      try {\n        const isLeadBuyer = currentUserRoles && currentUserRoles.includes('lead buyer');\n\n        if (isLeadBuyer) {\n          const { error: downloadFlagErr } = await supabase\n            .from('purchase_requests')\n            .update({ is_po_download: true })\n            .eq('purchase_order_number', purchase.purchase_order_number);\n          if (downloadFlagErr) {\n          } else {\n            //  \n            await loadPurchases();\n          }\n        }\n      } catch (flagErr) {\n      }\n    } catch (error) {\n      toast.error('  .');\n    }\n  };\n\n  //   -    \n  const handleReceiptComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_received: true,\n            received_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_received: true,\n            delivery_status: 'received'\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handlePaymentComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_payment_completed: true,\n            payment_completed_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_payment_completed: true\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handleItemsClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    setIsModalOpen(true);\n  }, []);\n  \n  //    -   \n  const modalPurchaseData = useMemo(() => {\n    if (!selectedPurchase) return null;\n    return {\n      ...selectedPurchase,\n      vendor_name: selectedPurchase.vendor_name || '',\n      project_vendor: selectedPurchase.project_vendor || '',\n      sales_order_number: selectedPurchase.sales_order_number || '',\n      project_item: selectedPurchase.project_item || ''\n    };\n  }, [selectedPurchase]);\n\n  return (\n    <div className=\"w-full\">\n      {/* Header */}\n      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4\">\n        <div>\n          <h1 className=\"page-title\"> </h1>\n          <p className=\"page-subtitle\" style={{marginTop:'-2px',marginBottom:'-4px'}}>Purchase Management</p>\n        </div>\n        <Button \n          onClick={() => navigate('/purchase/new')}\n          className=\"mt-4 sm:mt-0 bg-hansl-500 hover:bg-hansl-600\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n            \n        </Button>\n      </div>\n\n      {/*    -       */}\n      <div className=\"mb-3\">\n        <FilterToolbar\n          activeFilters={activeFilters}\n          sortConfig={sortConfig}\n          searchTerm={searchTerm}\n          onFiltersChange={setActiveFilters}\n          onSortChange={setSortConfig}\n          onSearchChange={setSearchTerm}\n          availableEmployees={availableEmployees}\n          availableVendors={availableVendors}\n          availableContacts={availableContacts}\n          availablePaymentSchedules={availablePaymentSchedules}\n        />\n        {/*       */}\n        {activeFilters.length === 0 && !searchTerm.trim() && (\n          <div className=\"mt-2 flex items-center gap-1.5 text-xs text-gray-500\">\n            <Info className=\"w-3.5 h-3.5\" />\n            <span> 60  .      .</span>\n          </div>\n        )}\n      </div>\n\n      {/*    (hanslwebapp ) -   */}\n      <div className=\"space-y-3\">\n        {/*   -    */}\n        <div className=\"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 business-radius-card border border-gray-200\">\n          {NAV_TABS.map((tab) => (\n            <button\n              key={tab.key}\n              onClick={() => {\n                setActiveTab(tab.key);\n              }}\n              className={`flex-1 flex items-center justify-center space-x-2 py-1.5 px-3 sm:px-4 business-radius-button button-text font-medium transition-colors ${\n                activeTab === tab.key\n                  ? 'text-hansl-600 bg-white shadow-sm border border-gray-200'\n                  : 'text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50'\n              }`}\n            >\n              <span className=\"whitespace-nowrap\">{tab.label}</span>\n              <Badge \n                variant=\"secondary\" \n                className={\n                  activeTab === tab.key \n                    ? 'badge-stats-active' \n                    : 'badge-stats-secondary'\n                }\n              >\n                {filteredTabCounts[tab.key as keyof typeof filteredTabCounts]}\n              </Badge>\n            </button>\n          ))}\n        </div>\n\n        {/*       */}\n        {monthlyFilterSummary && (\n          <div className=\"mb-3\">\n            {monthlyFilterSummary.type === 'single' ? (\n              //    -    \n              <div className=\"inline-flex items-center gap-2 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 business-radius-badge px-3 py-2 shadow-sm\">\n                <div className=\"flex items-center gap-1.5\">\n                  <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                  <span className=\"card-subtitle text-gray-700\">\n                    {monthlyFilterSummary.year} {monthlyFilterSummary.month}\n                  </span>\n                  <span className=\"badge-text text-gray-500\">\n                    {monthlyFilterSummary.count}\n                  </span>\n                </div>\n                <div className=\"h-4 w-px bg-blue-300\"></div>\n                <span className=\"modal-value text-blue-700 font-semibold\">\n                  {monthlyFilterSummary.total.toLocaleString()}\n                </span>\n              </div>\n            ) : (\n              //   \n              <Card className=\"business-radius-card border border-gray-200 shadow-sm\">\n                <CardHeader className=\"pb-3 pt-4 px-4\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                      <CardTitle className=\"section-title text-gray-800\">  </CardTitle>\n                    </div>\n                    {/*      */}\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"badge-text text-gray-600\">\n                        ({monthlyFilterSummary.months.reduce((sum, m) => sum + m.count, 0)})\n                      </span>\n                      <div className=\"h-4 w-px bg-gray-300\"></div>\n                      <span className=\"modal-value text-gray-500 font-bold\">\n                        {monthlyFilterSummary.grandTotal.toLocaleString()}\n                      </span>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"px-4 pb-4\">\n                  {/*   -     */}\n                  <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                    {monthlyFilterSummary.months.map((monthData) => (\n                      <div \n                        key={monthData.monthStr} \n                        className=\"bg-gray-50 business-radius-card px-3 py-1.5 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all flex-shrink-0\"\n                      >\n                        <div className=\"flex items-baseline gap-1.5\">\n                          <span className=\"modal-value font-bold text-gray-800 whitespace-nowrap\">\n                            {monthData.month}\n                          </span>\n                          <span className=\"text-[9px] text-gray-500 whitespace-nowrap\">\n                            ({monthData.count})\n                          </span>\n                          <span className=\"modal-value text-gray-500 font-bold whitespace-nowrap ml-1\">\n                            {monthData.total.toLocaleString()}\n                          </span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        )}\n\n        {/*   */}\n        <Card className=\"overflow-hidden border border-gray-200\">\n          <CardContent className=\"p-0\">\n            {loading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <div className=\"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin\" />\n                <span className=\"ml-3 card-subtitle\"> ...</span>\n              </div>\n            ) : advancedFilteredPurchases.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Package className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\"> </h3>\n                <p className=\"card-subtitle\">  .</p>\n              </div>\n            ) : (\n              <LazyPurchaseTable \n                purchases={advancedFilteredPurchases} \n                activeTab={activeTab}\n                currentUserRoles={currentUserRoles}\n                onRefresh={loadPurchases}\n                onOptimisticUpdate={updatePurchaseOptimistic}\n                onPaymentComplete={handlePaymentComplete}\n                onReceiptComplete={handleReceiptComplete}\n              />\n            )}\n          </CardContent>\n        </Card>\n      </div>\n      \n      {/*   -     */}\n      {modalPurchaseData && (\n        <Suspense fallback={<div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"><div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div></div>}>\n          <PurchaseItemsModal\n            isOpen={isModalOpen}\n            onClose={() => {\n              setIsModalOpen(false);\n              setSelectedPurchase(null);\n            }}\n            purchase={modalPurchaseData}\n            isAdmin={isAdmin || false}\n            onUpdate={loadPurchases}\n            activeTab={activeTab}\n          />\n        </Suspense>\n      )}\n    </div>\n  );\n}"],"file":"assets/PurchaseListMain-DDWS-gmy.js"}