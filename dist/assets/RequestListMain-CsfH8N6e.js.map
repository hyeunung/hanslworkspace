{"version":3,"mappings":"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","names":["Building","createLucideIcon","d","key","x","y","width","height","rx","EyeOff","Settings","cx","cy","r","SlidersVertical","x1","x2","y1","y2","TriangleAlert","ColumnSettingsDropdown","memo","isVisible","className","columnVisibility","applyColumnSettings","resetToDefault","isLoading","currentUserRoles","tempVisibility","setTempVisibility","useState","isOpen","setIsOpen","hasPermissionForColumn","columnId","RESTRICTED_COLUMNS","includes","some","role","AUTHORIZED_ROLES","useEffect","visibleColumnCount","Object","values","filter","Boolean","length","totalColumnCount","keys","tempVisibleCount","jsxs","DropdownMenu","open","onOpenChange","children","jsx","DropdownMenuTrigger","asChild","Button","variant","size","disabled","DropdownMenuContent","align","onInteractOutside","DropdownMenuLabel","onClick","title","RotateCcw","DropdownMenuSeparator","COLUMN_GROUPS","map","group","groupIndex","React","Fragment","columns","isRequired","REQUIRED_COLUMNS","hasPermission","prev","handleColumnToggle","Eye","statement_progress","purchase_order_number","payment_category","requester_name","request_date","utk_status","vendor_name","contact_name","delivery_request_date","revised_delivery_date","item_name","specification","quantity","unit_price","amount","remark","link","project_vendor","project_item","sales_order_number","purchase_progress","receipt_progress","received_quantity","Check","X","displayName","StatusBadge","purchase","status","is_received","middle_manager_status","final_manager_status","text","completed","inProgress","rejected","pending","MobilePurchaseCard","receiptProgress","purchase_request_items","received","total","percentage","item","actual_received_date","Math","round","getReceiptProgress","isAdvance","progress_type","formatDateShort","style","whiteSpace","wordBreak","amount_value","total_amount","toLocaleString","currency","is_payment_completed","VirtualScrollTable","purchases","activeTab","onRowClick","isLeadBuyer","onPaymentComplete","onReceiptComplete","onExcelDownload","onToggleUtkCheck","vendorColumnWidth","tableHeader","TableRowComponent","shouldUseFitLayout","containerRef","useRef","scrollTop","setScrollTop","containerHeight","setContainerHeight","dynamicHeight","setDynamicHeight","startIndex","endIndex","visibleItems","totalHeight","useMemo","itemCount","visibleCount","ceil","start","floor","end","min","actualStart","max","slice","handleScroll","useCallback","e","adjustedScrollTop","currentTarget","calculateDynamicHeight","windowHeight","window","innerHeight","calculatedHeight","updateHeight","current","rect","getBoundingClientRect","timer","setTimeout","handleResize","addEventListener","clearTimeout","removeEventListener","ref","overflow","position","onScroll","top","zIndex","backgroundColor","borderBottom","willChange","transform","left","right","index","id","getCurrencySymbol","COMMON_COLUMN_CLASSES","ApprovalStatusBadge","allPurchases","usePurchaseMemory","memoryPurchase","find","p","middleApproved","middleRejected","finalApproved","finalRejected","PaymentProgressBar","ReceiptProgressBar","StatementProgressBar","currentPurchase","statementProgress","items","is_statement_received","type","TableRow","UTK_AUTHORIZED_ROLES","canUtkCheck","src","alt","is_po_download","async","stopPropagation","pointerEvents","is_utk_checked","minWidth","maxWidth","revised_delivery_request_date","reduce","sum","receivedQuantity","isFullyReceived","shouldWrap","hasReceived","unitPrice","unit_price_value","unit_price_currency","totalAmount","tax_amount_value","amount_currency","href","target","rel","FastPurchaseTable","onRefresh","onOptimisticUpdate","selectedPurchaseId","setSelectedPurchaseId","isModalOpen","setIsModalOpen","deleteConfirmOpen","setDeleteConfirmOpen","purchaseToDelete","setPurchaseToDelete","supabase","createClient","maxLength","sampleSize","forEach","adjustedLength","split","acc","char","test","handleRowClick","handleCloseModal","handleToggleUtkCheck","newStatus","confirmMessage","confirm","error","from","update","eq","logger","purchaseId","toast","updatePurchaseInMemory","success","refreshResult","silent","Promise","err","handleExcelDownload","data","purchaseRequest","requestError","select","single","orderItems","itemsError","order","vendorInfo","vendor_phone","vendor_fax","vendor_contact_name","vendor_payment_schedule","vendorId","vendor_id","contactId","contact_id","vendorData","contactData","excelData","line_number","blob","generatePurchaseOrderExcelJS","downloadFilename","url","URL","createObjectURL","a","document","createElement","download","body","appendChild","click","removeChild","revokeObjectURL","downloadFlagErr","flagErr","handleConfirmDelete","info","purchaseOrderNumber","supabaseUrl","warn","user","authError","auth","getUser","employee","empError","email","roles","purchase_role","Array","isArray","String","trim","canEdit","isApproved","isRequester","name","employeeName","deletedItems","delete","code","message","details","hint","deletedItemsCount","purchaseIdForDelete","parseInt","isNaN","originalId","Error","inquiriesUpdated","inquiriesCount","relatedInquiries","inquiriesCheckError","inquiryIds","i","note","updatedInquiries","inquiriesUpdateError","purchase_request_id","updatedCount","updatedInquiryIds","resolve","inquiriesError","idType","idValue","errorMsg","inquiriesPreserved","purchaseIdNumber","removePurchaseFromMemory","refreshError","errorObj","stack","isColumnVisible","boxShadow","baseHeaders","additionalHeaders","visible","shouldUseVirtualScroll","PurchaseDetailModal","onClose","onDelete","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","FILTER_FIELDS","label","icon","Calendar","category","User","Package","DollarSign","CheckCircle","options","DATE_FIELDS","value","SORT_FIELDS","FilterToolbar","activeFilters","sortConfig","searchTerm","onFiltersChange","onSortChange","onSearchChange","availableEmployees","availableVendors","availableContacts","availablePaymentSchedules","isFilterOpen","setIsFilterOpen","isSortOpen","setIsSortOpen","isSearchExpanded","setIsSearchExpanded","newFilter","setNewFilter","datePickerOpen","setDatePickerOpen","monthPickerOpen","setMonthPickerOpen","tempDateRange","setTempDateRange","tempMonth","setTempMonth","tempMonthRange","setTempMonthRange","tempSort","setTempSort","searchValue","setSearchValue","searchInputRef","focus","field","direction","handleRemoveFilter","filterId","f","renderValueInput","fieldConfig","Input","placeholder","onChange","padding","fontSize","fontWeight","filteredOptions","option","toLowerCase","Popover","PopoverTrigger","Search","PopoverContent","autoFocus","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","scheduleOptions","Date","to","format","CalendarComponent","mode","selected","onSelect","range","numberOfMonths","initialFocus","rangeValue","startYear","startMonth","endYear","endMonth","year","month","currentYear","getFullYear","newDate","getMonth","_","monthDate","isSelected","isDisabled","Sliders","dateField","df","defaultCondition","now","condition","scrollbarWidth","scrollbarColor","entries","push","fields","isDateFilter","requiresDateField","finalCondition","ArrowUpDown","MANAGER_ROLES","HIDDEN_EMPLOYEES","filterByEmployeeVisibility","userRoles","PurchaseItemsModal","lazy","import","__VITE_PRELOAD__","NAV_TABS","PurchaseListMain","showEmailButton","navigate","useNavigate","location","useLocation","selectedPurchase","setSelectedPurchase","isWarningModalOpen","setIsWarningModalOpen","hasShownWarningRef","setActiveFilters","setSortConfig","setSearchTerm","setAvailableEmployees","setAvailableVendors","setAvailableContacts","setAvailablePaymentSchedules","loading","currentUser","getFilteredPurchases","isColumnLoading","setColumnVisibility","DEFAULT_COLUMN_VISIBILITY","setIsLoading","setError","forceUpdate","loadUserSettings","settings","settingsError","maybeSingle","userEmail","setting_value","savedSettings","mergedSettings","debug","settingsCount","saveUserSettings","newSettings","upsertError","upsert","user_email","setting_type","setting_key","onConflict","visibleColumns","toggleColumn","prevSettings","catch","then","useColumnSettings","currentUserName","refreshTrigger","setRefreshTrigger","cachedTabCounts","setCachedTabCounts","receipt","done","loadPurchases","updatePurchaseOptimistic","updater","isAdmin","roleCase","getRoleCase","defaultEmployeeByTab","hasHrRole","hasPurchaseManagerRole","hasManagerRole","initialTab","tab","URLSearchParams","search","get","getInitialTab","setActiveTab","selectedEmployee","setSelectedEmployee","isPending","startTransition","useTransition","visiblePurchases","deliveryWarningCount","useDeliveryWarningCount","targetPurchase","today","setHours","deliveryDate","revisedDate","checks","check1_isReceived","delivery_status","check2_approved","check3_requesterMatch","check4_notRevisionRequested","delivery_revision_requested","check5_dateOverdue","allChecksPass","every","v","hasShownWarning","dateToISOString","toISOString","deliveryDateOverdue","revisedDateOverdue","nameMatch","visiblePurchasesCount","purchaseOrderNumbers","visiblePurchasesLength","shouldShow","initialEmployeeValue","defaultEmp","isCacheValid","purchaseMemoryCache","hasData","lastFetch","loadAllPurchaseData","checkAndRefreshCache","employees","employeeNames","Set","vendors","vendorNames","contacts","contactNames","c","schedules","scheduleNames","s","loadFilterOptions","payment_completed_at","received_at","created_at","statement_received_date","fieldValue","filterValue","filterField","startDate","endDate","fieldDate","endOfMonth","endsWith","filterYear","filterMonth","fieldStr","filterStr","match","startsWith","Number","baseFilteredPurchases","advancedFilters","tabFilteredPurchases","templateType","po_template_type","newCounts","calculateTabCounts","filteredTabCounts","filteredTabCountsWithSearch","counts","filtered","getTabBadgeText","tabKey","toString","monthlyFilterSummary","monthFilters","totalFilteredAmount","itemSum","baseAmount","monthlyTotals","totalSum","currentDate","monthStr","padStart","monthData","purchaseDate","monthTotal","count","setMonth","months","grandTotal","handleReceiptComplete","currentTime","requestResult","itemsResult","all","markPurchaseAsReceived","handlePaymentComplete","markPurchaseAsPaymentCompleted","modalPurchaseData","marginTop","marginBottom","AlertTriangle","Badge","currentActiveTab","searchParams","set","replace","newEmployeeValue","availableKeys","newTab","newEmployee","actualNewEmployee","Card","CardHeader","CardTitle","m","CardContent","Suspense","fallback","onUpdate","DeliveryDateWarningModal","reload","CardUsageTab","BusinessTripTab","VehicleTab","TEMPLATE_TABS","RequestListMain","activeTemplateTab","setActiveTemplateTab"],"ignoreList":[0,1,2,3,4],"sources":["../../node_modules/lucide-react/dist/esm/icons/building.js","../../node_modules/lucide-react/dist/esm/icons/eye-off.js","../../node_modules/lucide-react/dist/esm/icons/settings.js","../../node_modules/lucide-react/dist/esm/icons/sliders-vertical.js","../../node_modules/lucide-react/dist/esm/icons/triangle-alert.js","../../src/components/purchase/ColumnSettingsDropdown.tsx","../../src/components/purchase/MobilePurchaseCard.tsx","../../src/components/purchase/VirtualScrollTable.tsx","../../src/components/purchase/FastPurchaseTable.tsx","../../src/components/purchase/FilterToolbar.tsx","../../src/utils/roleHelper.ts","../../src/components/purchase/PurchaseListMain.tsx","../../src/hooks/useColumnSettings.ts","../../src/components/purchase/CardUsageTab.tsx","../../src/components/purchase/BusinessTripTab.tsx","../../src/components/purchase/VehicleTab.tsx","../../src/components/purchase/RequestListMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 10h.01\", key: \"1nrarc\" }],\n  [\"path\", { d: \"M12 14h.01\", key: \"1etili\" }],\n  [\"path\", { d: \"M12 6h.01\", key: \"1vi96p\" }],\n  [\"path\", { d: \"M16 10h.01\", key: \"1m94wz\" }],\n  [\"path\", { d: \"M16 14h.01\", key: \"1gbofw\" }],\n  [\"path\", { d: \"M16 6h.01\", key: \"1x0f13\" }],\n  [\"path\", { d: \"M8 10h.01\", key: \"19clt8\" }],\n  [\"path\", { d: \"M8 14h.01\", key: \"6423bh\" }],\n  [\"path\", { d: \"M8 6h.01\", key: \"1dz90k\" }],\n  [\"path\", { d: \"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3\", key: \"cabbwy\" }],\n  [\"rect\", { x: \"4\", y: \"2\", width: \"16\", height: \"20\", rx: \"2\", key: \"1uxh74\" }]\n];\nconst Building = createLucideIcon(\"building\", __iconNode);\n\nexport { __iconNode, Building as default };\n//# sourceMappingURL=building.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",\n      key: \"ct8e1f\"\n    }\n  ],\n  [\"path\", { d: \"M14.084 14.158a3 3 0 0 1-4.242-4.242\", key: \"151rxh\" }],\n  [\n    \"path\",\n    {\n      d: \"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",\n      key: \"13bj9a\"\n    }\n  ],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst EyeOff = createLucideIcon(\"eye-off\", __iconNode);\n\nexport { __iconNode, EyeOff as default };\n//# sourceMappingURL=eye-off.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915\",\n      key: \"1i5ecw\"\n    }\n  ],\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"3\", key: \"1v7zrd\" }]\n];\nconst Settings = createLucideIcon(\"settings\", __iconNode);\n\nexport { __iconNode, Settings as default };\n//# sourceMappingURL=settings.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"21\", y2: \"14\", key: \"1p332r\" }],\n  [\"line\", { x1: \"4\", x2: \"4\", y1: \"10\", y2: \"3\", key: \"gb41h5\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"21\", y2: \"12\", key: \"hf2csr\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"8\", y2: \"3\", key: \"1kfi7u\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"21\", y2: \"16\", key: \"1lhrwl\" }],\n  [\"line\", { x1: \"20\", x2: \"20\", y1: \"12\", y2: \"3\", key: \"16vvfq\" }],\n  [\"line\", { x1: \"2\", x2: \"6\", y1: \"14\", y2: \"14\", key: \"1uebub\" }],\n  [\"line\", { x1: \"10\", x2: \"14\", y1: \"8\", y2: \"8\", key: \"1yglbp\" }],\n  [\"line\", { x1: \"18\", x2: \"22\", y1: \"16\", y2: \"16\", key: \"1jxqpz\" }]\n];\nconst SlidersVertical = createLucideIcon(\"sliders-vertical\", __iconNode);\n\nexport { __iconNode, SlidersVertical as default };\n//# sourceMappingURL=sliders-vertical.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\",\n      key: \"wmoenq\"\n    }\n  ],\n  [\"path\", { d: \"M12 9v4\", key: \"juzpu7\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n];\nconst TriangleAlert = createLucideIcon(\"triangle-alert\", __iconNode);\n\nexport { __iconNode, TriangleAlert as default };\n//# sourceMappingURL=triangle-alert.js.map\n","import React, { memo, useState, useEffect } from 'react';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Button } from '@/components/ui/button';\nimport { Settings, RotateCcw, Eye, EyeOff, Check, X } from 'lucide-react';\nimport { COLUMN_GROUPS, REQUIRED_COLUMNS, RESTRICTED_COLUMNS, AUTHORIZED_ROLES } from '@/constants/columnSettings';\nimport { DoneTabColumnId, ColumnVisibility } from '@/types/columnSettings';\nimport { Skeleton } from '@/components/ui/skeleton';\n\ninterface ColumnSettingsDropdownProps {\n  /**\n   *    \n   */\n  isVisible?: boolean;\n  /**\n   *  CSS \n   */\n  className?: string;\n  /**\n   *   \n   */\n  columnVisibility: ColumnVisibility;\n  /**\n   *    \n   */\n  applyColumnSettings: (newSettings: ColumnVisibility) => void;\n  /**\n   *   \n   */\n  resetToDefault: () => void;\n  /**\n   *  \n   */\n  isLoading?: boolean;\n  /**\n   *   \n   */\n  currentUserRoles?: string[];\n}\n\n/**\n *      \n * -   \n * -   \n * -  \n * -   \n */\nconst ColumnSettingsDropdown: React.FC<ColumnSettingsDropdownProps> = memo(({\n  isVisible = true,\n  className = '',\n  columnVisibility,\n  applyColumnSettings,\n  resetToDefault,\n  isLoading = false,\n  currentUserRoles = []\n}) => {\n  \n  //    (  )\n  const [tempVisibility, setTempVisibility] = useState<ColumnVisibility>(columnVisibility);\n  const [isOpen, setIsOpen] = useState(false);\n  \n  //   \n  const hasPermissionForColumn = (columnId: DoneTabColumnId): boolean => {\n    if (!RESTRICTED_COLUMNS.includes(columnId)) return true;\n    return currentUserRoles.some(role => AUTHORIZED_ROLES.includes(role));\n  };\n\n  //      \n  useEffect(() => {\n    if (isOpen) {\n      setTempVisibility(columnVisibility);\n    }\n  }, [isOpen, columnVisibility]);\n\n  //     \n  if (!isVisible) {\n    return null;\n  }\n\n  //    \n  const visibleColumnCount = Object.values(columnVisibility).filter(Boolean).length;\n  const totalColumnCount = Object.keys(columnVisibility).length;\n  const tempVisibleCount = Object.values(tempVisibility).filter(Boolean).length;\n\n  //    (  )\n  const handleColumnToggle = (columnId: DoneTabColumnId) => {\n    //     \n    if (REQUIRED_COLUMNS.includes(columnId) && tempVisibility[columnId]) {\n      return;\n    }\n    \n    //     \n    if (!hasPermissionForColumn(columnId)) {\n      return;\n    }\n    \n    setTempVisibility(prev => ({\n      ...prev,\n      [columnId]: !prev[columnId]\n    }));\n  };\n\n  //  \n  const handleApply = () => {\n    applyColumnSettings(tempVisibility);\n    setIsOpen(false);\n  };\n\n  // \n  const handleCancel = () => {\n    setTempVisibility(columnVisibility);\n    setIsOpen(false);\n  };\n\n  //  \n  const handleReset = () => {\n    resetToDefault();\n    setIsOpen(false);\n  };\n\n  return (\n    <DropdownMenu open={isOpen} onOpenChange={setIsOpen}>\n      <DropdownMenuTrigger asChild>\n        <Button variant=\"outline\" size=\"sm\" className={`button-base ${className}`} disabled={isLoading}>\n          <Settings className=\"w-4 h-4 mr-2\" />\n          <span className=\"button-text\">\n            {isLoading ? ' ...' : `  (${visibleColumnCount}/${totalColumnCount})`}\n          </span>\n        </Button>\n      </DropdownMenuTrigger>\n      \n      <DropdownMenuContent className=\"w-[320px] overflow-x-hidden\" align=\"end\" onInteractOutside={() => {\n        setTempVisibility(columnVisibility);\n        setIsOpen(false);\n      }}>\n        <div className=\"max-h-[min(600px,80vh)] overflow-y-auto overflow-x-hidden\">\n        {/*  */}\n        <DropdownMenuLabel className=\"flex items-center justify-between py-1.5\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"modal-section-title\">  </span>\n            <span className=\"card-description\">\n              ({tempVisibleCount}/{totalColumnCount})\n            </span>\n          </div>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={handleReset}\n            className=\"h-5 px-1.5\"\n            title=\" \"\n          >\n            <RotateCcw className=\"w-3 h-3\" />\n          </Button>\n        </DropdownMenuLabel>\n        \n        <DropdownMenuSeparator />\n\n        {/*    */}\n        {COLUMN_GROUPS.map((group, groupIndex) => (\n          <React.Fragment key={group.title}>\n            {/*   */}\n            <div className=\"px-3 py-1\">\n              <div className=\"modal-label\">\n                {group.title}\n              </div>\n            </div>\n\n            {/*    - 2  */}\n            <div className=\"grid grid-cols-2 gap-x-1 px-2\">\n              {group.columns.map((columnId) => {\n                const isVisible = tempVisibility[columnId];\n                const isRequired = REQUIRED_COLUMNS.includes(columnId);\n                const hasPermission = hasPermissionForColumn(columnId);\n                \n                //   \n                const columnLabels: Record<DoneTabColumnId, string> = {\n                  statement_progress: '',\n                  purchase_order_number: '',\n                  payment_category: '',\n                  requester_name: '',\n                  request_date: '',\n                  utk_status: 'UTK',\n                  vendor_name: '',\n                  contact_name: '',\n                  delivery_request_date: '',\n                  revised_delivery_date: '',\n                  item_name: '',\n                  specification: '',\n                  quantity: '',\n                  unit_price: '',\n                  amount: '',\n                  remark: '',\n                  link: '',\n                  project_vendor: 'PJ',\n                  project_item: 'PJ ITEM',\n                  sales_order_number: '',\n                  purchase_progress: '',\n                  receipt_progress: '',\n                  received_quantity: ' ',\n                };\n\n                return (\n                  <div\n                    key={columnId}\n                    className={`flex items-center gap-1 py-1 rounded overflow-hidden ${\n                      !hasPermission ? 'opacity-50 cursor-not-allowed' :\n                      isRequired && isVisible ? 'opacity-75' : 'cursor-pointer hover:bg-gray-50'\n                    }`}\n                    onClick={() => {\n                      if (!hasPermission) return;\n                      if (!(isRequired && isVisible)) {\n                        handleColumnToggle(columnId);\n                      }\n                    }}\n                    title={!hasPermission ? '    ' : ''}\n                  >\n                    <div className={`p-0.5 ${\n                      !hasPermission ? '' :\n                      isRequired && isVisible ? '' : 'hover:bg-gray-100 rounded transition-colors'\n                    }`}>\n                      {isVisible ? (\n                        <Eye className={`w-3.5 h-3.5 ${!hasPermission ? 'text-gray-400' : 'text-green-600'}`} />\n                      ) : (\n                        <EyeOff className=\"w-3.5 h-3.5 text-gray-400\" />\n                      )}\n                    </div>\n                    \n                    <div className=\"flex-1 min-w-0\">\n                      <div className={`modal-value truncate ${\n                        !hasPermission ? 'text-gray-400' :\n                        !isVisible ? 'text-gray-500' : ''\n                      }`}>\n                        {columnLabels[columnId]}\n                        {isRequired && (\n                          <span className=\"ml-1 text-red-500\" title=\" \">*</span>\n                        )}\n                        {!hasPermission && (\n                          <span className=\"ml-1 text-gray-400\" title=\" \"></span>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n\n            {/*   (  ) */}\n            {groupIndex < COLUMN_GROUPS.length - 1 && <DropdownMenuSeparator />}\n          </React.Fragment>\n        ))}\n\n        <DropdownMenuSeparator />\n\n        {/*   */}\n        <div className=\"px-3 py-2\">\n          <div className=\"card-description space-y-1\">\n            <div>  (*)   </div>\n            <div>     </div>\n            <div>    </div>\n          </div>\n        </div>\n\n        </div>\n        \n        <DropdownMenuSeparator />\n\n        {/* /  */}\n        <div className=\"px-3 py-3 flex gap-2 border-t bg-white\">\n          <Button\n            onClick={handleApply}\n            className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n          >\n            <Check className=\"w-4 h-4 mr-1\" />\n            \n          </Button>\n          <Button\n            onClick={handleCancel}\n            variant=\"outline\"\n            className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n          >\n            <X className=\"w-4 h-4 mr-1\" />\n            \n          </Button>\n        </div>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n});\n\nColumnSettingsDropdown.displayName = 'ColumnSettingsDropdown';\n\nexport default ColumnSettingsDropdown;","import { memo } from 'react'\nimport { Eye } from 'lucide-react'\nimport { Purchase } from '@/types/purchase'\nimport { formatDateShort } from '@/utils/helpers'\n\ninterface MobilePurchaseCardProps {\n  purchase: Purchase\n  onClick: (purchase: Purchase) => void\n}\n\n\nconst getReceiptProgress = (purchase: Purchase) => {\n  if (!purchase.purchase_request_items || purchase.purchase_request_items.length === 0) return { received: 0, total: 0, percentage: 0 }\n  \n  const total = purchase.purchase_request_items.length\n  const received = purchase.purchase_request_items.filter((item: any) => \n    item.actual_received_date !== null && item.actual_received_date !== undefined\n  ).length\n  const percentage = total > 0 ? Math.round((received / total) * 100) : 0\n  \n  return { received, total, percentage }\n}\n\nconst StatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const status = purchase.is_received \n    ? 'completed'\n    : (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')\n    ? 'inProgress'\n    : (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected')\n    ? 'rejected'\n    : 'pending'\n  \n  const config = {\n    completed: { text: '', className: 'badge-success' },\n    inProgress: { text: '', className: 'badge-primary' },\n    rejected: { text: '', className: 'badge-danger' },\n    pending: { text: '', className: 'badge-warning' }\n  }\n  \n  const { text, className } = config[status]\n  return <span className={`badge-stats ${className}`}>{text}</span>\n})\n\nStatusBadge.displayName = 'StatusBadge'\n\nconst MobilePurchaseCard = memo(({ purchase, onClick }: MobilePurchaseCardProps) => {\n  const receiptProgress = getReceiptProgress(purchase)\n  const isAdvance = purchase.progress_type === '' || purchase.progress_type?.includes('')\n  \n  return (\n    <div \n      className={`bg-white rounded-lg border p-4 space-y-3 cursor-pointer transition-all hover:shadow-md ${isAdvance ? 'border-red-400 bg-red-50 hover:bg-red-100' : 'hover:bg-gray-50'}`}\n      onClick={() => onClick(purchase)}\n    >\n      {/*  */}\n      <div className=\"flex items-start justify-between\">\n        <div>\n          <div className=\"flex items-center gap-2\">\n            {isAdvance ? (\n              <span className=\"badge-stats bg-red-500 text-white\">\n                \n              </span>\n            ) : (\n              <span className=\"badge-stats bg-gray-500 text-white\">\n                \n              </span>\n            )}\n            <span className=\"card-title text-gray-900\">\n              {purchase.purchase_order_number || '-'}\n            </span>\n          </div>\n          <div className=\"badge-text text-gray-500 mt-1\">\n            {formatDateShort(purchase.request_date)} \n          </div>\n        </div>\n        <StatusBadge purchase={purchase} />\n      </div>\n\n      {/*   */}\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"card-title\">{purchase.requester_name}</span>\n        </div>\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"card-title\">{purchase.vendor_name}</span>\n        </div>\n        {purchase.project_vendor && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\">PJ</span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.project_vendor}</span>\n          </div>\n        )}\n        {purchase.project_item && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\">PJ ITEM</span>\n            <span\n              className=\"text-[11px] font-medium text-gray-900 max-w-[150px] break-all whitespace-pre-wrap text-right leading-snug\"\n              style={{ whiteSpace: 'pre-wrap', wordBreak: 'break-all' }}\n            >\n              {purchase.project_item}\n            </span>\n          </div>\n        )}\n        {purchase.sales_order_number && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\"></span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.sales_order_number}</span>\n          </div>\n        )}\n        {purchase.item_name && (\n          <div className=\"flex items-center justify-between card-subtitle\">\n            <span className=\"text-gray-600\"></span>\n            <span className=\"card-title truncate max-w-[150px]\">{purchase.item_name}</span>\n          </div>\n        )}\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"font-semibold text-gray-900\">\n            {(purchase.amount_value || purchase.total_amount)?.toLocaleString()} {purchase.currency}\n          </span>\n        </div>\n      </div>\n\n      {/*   */}\n      <div className=\"space-y-1\">\n        <div className=\"flex items-center justify-between badge-text\">\n          <span className=\"text-gray-600\"></span>\n          <span className=\"text-gray-700\">\n            {receiptProgress.received}/{receiptProgress.total} ({receiptProgress.percentage}%)\n          </span>\n        </div>\n        <div className=\"bg-gray-200 rounded-full h-2\">\n          <div \n            className={`h-2 rounded-full transition-all ${\n              receiptProgress.percentage === 100 ? 'bg-green-500' : \n              receiptProgress.percentage > 0 ? 'bg-hansl-500' : 'bg-gray-300'\n            }`}\n            style={{ width: `${receiptProgress.percentage}%` }}\n          />\n        </div>\n      </div>\n\n      {/*   */}\n      {purchase.is_payment_completed !== undefined && (\n        <div className=\"flex items-center justify-between card-subtitle\">\n          <span className=\"text-gray-600\"></span>\n          {purchase.is_payment_completed ? (\n            <span className=\"badge-stats bg-green-500 text-white\"></span>\n          ) : (\n            <span className=\"badge-stats bg-gray-500 text-white\"></span>\n          )}\n        </div>\n      )}\n\n      {/*       */}\n      <div className=\"pt-2 border-t\">\n        <div className=\"flex items-center justify-center badge-text text-gray-500\">\n          <Eye className=\"w-3 h-3 mr-1\" />\n           \n        </div>\n      </div>\n    </div>\n  )\n})\n\nMobilePurchaseCard.displayName = 'MobilePurchaseCard'\n\nexport default MobilePurchaseCard","import React, { memo, useMemo, useRef, useEffect, useState, useCallback } from 'react';\nimport { Purchase } from '@/types/purchase';\nimport { ColumnVisibility } from '@/types/columnSettings';\n\ninterface VirtualScrollTableProps {\n  purchases: Purchase[];\n  activeTab?: string;\n  onRowClick: (purchase: Purchase) => void;\n  isLeadBuyer?: boolean;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n  onExcelDownload?: (purchase: Purchase) => Promise<void>;\n  onToggleUtkCheck?: (purchase: Purchase) => Promise<void>;\n  columnVisibility?: ColumnVisibility;\n  vendorColumnWidth?: number;\n  tableHeader: React.ReactNode;\n  TableRowComponent: React.ComponentType<any>;\n  height?: number;\n  shouldUseFitLayout?: boolean;\n  currentUserRoles?: string[];\n}\n\nconst ITEM_HEIGHT = 30; //     ( py-1.5 +  )\nconst BUFFER_SIZE = 5; //      \n\nconst VirtualScrollTable = memo<VirtualScrollTableProps>(({\n  purchases,\n  activeTab,\n  onRowClick,\n  isLeadBuyer,\n  onPaymentComplete,\n  onReceiptComplete,\n  onExcelDownload,\n  onToggleUtkCheck,\n  columnVisibility,\n  vendorColumnWidth,\n  tableHeader,\n  TableRowComponent,\n  height = 600,\n  shouldUseFitLayout = false,\n  currentUserRoles\n}) => {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [scrollTop, setScrollTop] = useState(0);\n  const [containerHeight, setContainerHeight] = useState(height);\n  \n  //    \n  const [dynamicHeight, setDynamicHeight] = useState(height);\n\n  //   \n  const { startIndex, endIndex, visibleItems, totalHeight } = useMemo(() => {\n    const itemCount = purchases.length;\n    const visibleCount = Math.ceil(containerHeight / ITEM_HEIGHT);\n    \n    const start = Math.floor(scrollTop / ITEM_HEIGHT);\n    const end = Math.min(start + visibleCount + BUFFER_SIZE, itemCount);\n    const actualStart = Math.max(0, start - BUFFER_SIZE);\n    \n    return {\n      startIndex: actualStart,\n      endIndex: end,\n      visibleItems: purchases.slice(actualStart, end),\n      totalHeight: itemCount * ITEM_HEIGHT\n    };\n  }, [purchases, scrollTop, containerHeight]);\n\n  //    -   \n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    const headerHeight = 30; //     ( )\n    const adjustedScrollTop = Math.max(0, e.currentTarget.scrollTop - headerHeight);\n    setScrollTop(adjustedScrollTop);\n  }, []);\n\n  //       \n  useEffect(() => {\n    const calculateDynamicHeight = () => {\n      const windowHeight = window.innerHeight;\n      \n      //      \n      let calculatedHeight;\n      \n      if (windowHeight <= 800) {\n        //  :  60% ( 450px)\n        calculatedHeight = Math.min(450, windowHeight * 0.6);\n      } else if (windowHeight <= 1080) {\n        //  :  70% ( 725px)\n        calculatedHeight = Math.min(725, windowHeight * 0.7);\n      } else if (windowHeight <= 1440) {\n        //  :  75% ( 1000px)\n        calculatedHeight = Math.min(1000, windowHeight * 0.75);\n      } else {\n        //   :  80% ( 1200px)\n        calculatedHeight = Math.min(1200, windowHeight * 0.8);\n      }\n      \n      console.log('   :', {\n        windowHeight,\n        calculatedHeight,\n        category: windowHeight <= 800 ? '' : \n                 windowHeight <= 1080 ? '' :\n                 windowHeight <= 1440 ? '' : ''\n      });\n      \n      setDynamicHeight(calculatedHeight);\n      setContainerHeight(calculatedHeight);\n    };\n\n    const updateHeight = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        setContainerHeight(Math.min(dynamicHeight, rect.height));\n      }\n    };\n\n    // DOM    \n    const timer = setTimeout(() => {\n      calculateDynamicHeight();\n      updateHeight();\n    }, 100); // 100ms  DOM   \n    \n    //   \n    const handleResize = () => {\n      calculateDynamicHeight();\n      updateHeight();\n    };\n    \n    window.addEventListener('resize', handleResize);\n    \n    return () => {\n      clearTimeout(timer);\n      window.removeEventListener('resize', handleResize);\n    };\n  }, [dynamicHeight]);\n\n  return (\n    <div className={shouldUseFitLayout ? 'table-container-fit-left' : 'border rounded-lg'}>\n      {/*     - x y    */}\n      <div\n        ref={containerRef}\n        className=\"virtual-scroll-body\"\n        style={{ \n          height: `${dynamicHeight}px`, \n          overflow: 'auto',\n          position: 'relative'\n        }}\n        onScroll={handleScroll}\n      >\n        {/*   -      */}\n        <div \n          className=\"sticky-header-container\"\n          style={{ \n          position: 'sticky', \n          top: 0, \n            zIndex: 30,\n            backgroundColor: '#f9fafb',\n            borderBottom: '1px solid #e5e7eb',\n            willChange: 'transform'\n          }}\n        >\n          <table className={shouldUseFitLayout ? `table-fit-left ${activeTab}-tab` : 'w-full min-w-[1790px] border-collapse'}>\n            {tableHeader}\n          </table>\n        </div>\n        \n        {/*     */}\n        <div style={{ height: `${totalHeight}px`, position: 'relative' }}>\n          {/*    */}\n          <div\n            style={{\n              transform: `translateY(${startIndex * ITEM_HEIGHT}px)`,\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              right: 0,\n            }}\n          >\n            <table className={`${shouldUseFitLayout ? `table-fit-left ${activeTab}-tab` : 'w-full min-w-[1790px] border-collapse'} virtual-scroll-table`}>\n              <tbody>\n                {visibleItems.map((purchase, index) => (\n                  <TableRowComponent\n                    key={purchase.id}\n                    purchase={purchase}\n                    onClick={onRowClick}\n                    activeTab={activeTab}\n                    isLeadBuyer={isLeadBuyer}\n                    onPaymentComplete={onPaymentComplete}\n                    onReceiptComplete={onReceiptComplete}\n                    onExcelDownload={onExcelDownload}\n                    onToggleUtkCheck={onToggleUtkCheck}\n                    vendorColumnWidth={vendorColumnWidth}\n                    columnVisibility={columnVisibility}\n                    currentUserRoles={currentUserRoles}\n                  />\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/*    */}\n        {purchases.length === 0 && (\n          <div className=\"text-center py-12 bg-white\">\n            <p className=\"card-subtitle\"> .</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n});\n\nVirtualScrollTable.displayName = 'VirtualScrollTable';\n\nexport default VirtualScrollTable;","import { memo, useMemo, useState, useCallback, useEffect } from \"react\";\nimport PurchaseDetailModal from \"./PurchaseDetailModal\";\nimport MobilePurchaseCard from \"./MobilePurchaseCard\";\nimport VirtualScrollTable from \"./VirtualScrollTable\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { generatePurchaseOrderExcelJS, PurchaseOrderData } from \"@/utils/exceljs/generatePurchaseOrderExcel\";\nimport { formatDateShort } from \"@/utils/helpers\";\nimport { logger } from \"@/lib/logger\";\nimport { usePurchaseMemory } from \"@/hooks/usePurchaseMemory\";\nimport { removePurchaseFromMemory, updatePurchaseInMemory } from '@/stores/purchaseMemoryStore';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Purchase, PurchaseRequestWithDetails } from \"@/types/purchase\";\nimport { DoneTabColumnId, ColumnVisibility } from \"@/types/columnSettings\";\nimport { RESTRICTED_COLUMNS, AUTHORIZED_ROLES, UTK_AUTHORIZED_ROLES } from \"@/constants/columnSettings\";\n\ninterface FastPurchaseTableProps {\n  purchases: Purchase[];\n  activeTab?: string; //   \n  currentUserRoles?: string[];\n  onRefresh?: (forceRefresh?: boolean, options?: { silent?: boolean }) => void | Promise<void>;\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n  columnVisibility?: ColumnVisibility; //   \n}\n\n//    ( )\nconst StatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const status = purchase.is_received \n    ? 'completed'\n    : (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')\n    ? 'inProgress'\n    : (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected')\n    ? 'rejected'\n    : 'pending';\n  \n  const config = {\n    completed: { text: '', className: 'badge-success' },\n    inProgress: { text: '', className: 'badge-primary' },\n    rejected: { text: '', className: 'badge-danger' },\n    pending: { text: '', className: 'badge-warning' }\n  };\n  \n  const { text, className } = config[status];\n  return <span className={`badge-stats ${className}`}>{text}</span>;\n});\n\nStatusBadge.displayName = 'StatusBadge';\n\n//     \nconst getCurrencySymbol = (currency: string) => {\n  if (!currency) return '';\n  if (['KRW', '', ''].includes(currency)) return '';\n  if (['USD', '$', ''].includes(currency)) return '$';\n  if (['EUR', ''].includes(currency)) return '';\n  if (['JPY', '', ''].includes(currency)) return '';\n  if (['CNY', '', ''].includes(currency)) return '';\n  return currency;\n};\n\n//   DB  1,979        (2025-10-28)\n//   : 90      \n//  min-width = max-width   , truncate   \nconst COMMON_COLUMN_CLASSES = {\n  //    \n  approvalStatus: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  \n  //     ( )\n  purchaseOrderNumber: \"pl-2 w-[155px] min-w-[155px] max-w-[155px] purchase-order-number-column\",      //  +  + \n  purchaseOrderNumberCompact: \"pl-2 w-36 min-w-[140px] max-w-[140px]\", //   (  )\n  paymentCategory: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  requesterName: \"w-12 min-w-[48px] max-w-[48px]\",                    //   2-3  (,  )\n  requestDate: \"text-center px-2 w-16 min-w-[64px] max-w-[68px]\",\n  vendorName: \"pl-3 pr-2 w-32 min-w-[128px] max-w-[128px]\",           //     (95% )\n  contactName: \"w-16 min-w-[68px] max-w-[68px]\",\n  deliveryRequestDate: \"w-20 min-w-[85px] max-w-[85px]\",\n  revisedDeliveryRequestDate: \"w-20 min-w-[85px] max-w-[85px]\",\n  itemName: \"w-44 min-w-[176px] max-w-[176px]\",                       //    : 160px  176px\n  specification: \"w-64 min-w-[260px] max-w-[260px]\",                  //  15.5 +  (  )\n  quantity: \"text-center w-14 min-w-[60px] max-w-[60px]\",\n  receivedQuantity: \"text-center w-16 min-w-[70px] max-w-[70px]\",\n  unitPrice: \"text-right w-24 min-w-[100px] max-w-[100px]\",\n  amount: \"text-right w-24 min-w-[100px] max-w-[100px]\",\n  \n  //    ( )\n  remark: \"w-[165px] min-w-[165px] max-w-[165px]\",                         //  1.8,  \n  paymentSchedule: \"w-24 min-w-[100px] max-w-[100px]\",\n  purchaseStatus: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  projectVendor: \"w-24 min-w-[105px] max-w-[105px]\",                  //  6.6\n  salesOrderNumber: \"w-28 min-w-[115px] max-w-[115px]\",               //  8.6\n  projectItem: \"w-44 min-w-[180px] max-w-[180px]\",                    //  11.1 +  (  )\n  receiptProgress: \"text-center w-20 min-w-[85px] max-w-[85px]\",\n  status: \"text-center w-24 min-w-[100px] max-w-[100px]\",\n  receipt: \"text-center w-24 min-w-[100px] max-w-[100px]\",           //  +  \n  paymentStatus: \"text-center w-16 min-w-[70px] max-w-[70px]\",\n  link: \"w-20 min-w-[85px] max-w-[85px]\",\n  utk: \"text-center w-14 min-w-[56px] max-w-[60px]\"  // UTK   ()\n};\n\n//      ( )\n//       usePurchaseMemory  \nconst ApprovalStatusBadge = memo(({ purchase }: { purchase: Purchase }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //     (  )\n  const memoryPurchase = allPurchases?.find(p => p.id === purchase.id) || purchase;\n  \n  const middleApproved = memoryPurchase.middle_manager_status === 'approved';\n  const middleRejected = memoryPurchase.middle_manager_status === 'rejected';\n  const finalApproved = memoryPurchase.final_manager_status === 'approved';\n  const finalRejected = memoryPurchase.final_manager_status === 'rejected';\n\n  //   \n  if (middleRejected || finalRejected) {\n    //    \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-0.5\">\n          <div className=\"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse\"></div>\n        </div>\n        <span className=\"badge-stats bg-red-500 text-white\">\n          \n        </span>\n      </div>\n    );\n  }\n  \n  if (middleApproved && finalApproved) {\n    //    \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-0.5\">\n          <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\n        </div>\n        <span className=\"badge-stats bg-green-500 text-white\">\n          \n        </span>\n      </div>\n    );\n  }\n  \n  if (middleApproved && !finalApproved && !finalRejected) {\n    //  \n    return (\n      <div className=\"flex flex-col items-center gap-0.5\">\n        <div className=\"flex items-center gap-1\">\n          <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\n          <div className=\"w-3 h-0.5 bg-gray-300\"></div>\n          <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n        </div>\n        <span className=\"badge-stats bg-yellow-500 text-white\">\n          1 \n        </span>\n      </div>\n    );\n  }\n  \n  //   \n  return (\n    <div className=\"flex flex-col items-center gap-0.5\">\n      <div className=\"flex items-center gap-1\">\n        <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n        <div className=\"w-3 h-0.5 bg-gray-300\"></div>\n        <div className=\"w-1.5 h-1.5 bg-gray-300 rounded-full\"></div>\n      </div>\n      <span className=\"badge-stats bg-gray-500 text-white\">\n        \n      </span>\n    </div>\n  );\n});\n\nApprovalStatusBadge.displayName = 'ApprovalStatusBadge';\n\n//    ( )\n//       usePurchaseMemory  \nconst PaymentProgressBar = memo(({ purchase, activeTab }: { purchase: Purchase; activeTab?: string }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //     (  )\n  const memoryPurchase = allPurchases?.find(p => p.id === purchase.id) || purchase;\n\n  //    ' '   \"-\" \n  if (activeTab === 'done') {\n    if (memoryPurchase.payment_category !== ' ') {\n      return (\n        <div className=\"flex items-center justify-center\">\n          <span className=\"card-title text-gray-500\">-</span>\n        </div>\n      );\n    }\n  }\n  \n  // purchase_requests  is_payment_completed   \n  if (memoryPurchase.is_payment_completed) {\n    const progress = { completed: 1, total: 1, percentage: 100 };\n    return (\n      <div className=\"flex items-center justify-center gap-1\">\n        <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n          <div \n            className=\"h-1.5 rounded-full bg-orange-500\"\n            style={{ width: '100%' }}\n          />\n        </div>\n        <span className=\"card-title text-gray-600\">100%</span>\n      </div>\n    );\n  }\n  \n  // items     \n  if (!memoryPurchase.purchase_request_items || memoryPurchase.purchase_request_items.length === 0) {\n    const progress = { completed: 0, total: 1, percentage: 0 };\n    return (\n      <div className=\"flex items-center justify-center gap-1\">\n        <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n          <div \n            className=\"h-1.5 rounded-full bg-gray-300\"\n            style={{ width: '0%' }}\n          />\n        </div>\n        <span className=\"card-title text-gray-600\">0%</span>\n      </div>\n    );\n  }\n  \n  //     \n  const total = memoryPurchase.purchase_request_items.length;\n  const completed = memoryPurchase.purchase_request_items.filter((item: any) => \n    item.is_payment_completed === true\n  ).length;\n  const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n  \n\n  return (\n    <div className=\"flex items-center justify-center gap-1\">\n      <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n        <div \n          className={`h-1.5 rounded-full ${\n            percentage === 100 ? 'bg-orange-500' : \n            percentage > 0 ? 'bg-orange-400' : 'bg-gray-300'\n          }`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      <span className=\"card-title text-gray-600\">{percentage}%</span>\n    </div>\n  );\n});\n\nPaymentProgressBar.displayName = 'PaymentProgressBar';\n\n//    ( )  \n//       usePurchaseMemory  \nconst ReceiptProgressBar = memo(({ purchase }: { purchase: Purchase }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //     (  )\n  const memoryPurchase = allPurchases?.find(p => p.id === purchase.id) || purchase;\n  \n  // items     \n  if (!memoryPurchase.purchase_request_items || memoryPurchase.purchase_request_items.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center gap-1\">\n        <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n          <div \n            className=\"h-1.5 rounded-full bg-gray-300\"\n            style={{ width: '0%' }}\n          />\n        </div>\n        <span className=\"card-title text-gray-600\">0%</span>\n      </div>\n    );\n  }\n  \n  //       (is_received )\n  const total = memoryPurchase.purchase_request_items.length;\n  const received = memoryPurchase.purchase_request_items.filter((item: any) => \n    item.is_received === true\n  ).length;\n  const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n\n  return (\n    <div className=\"flex items-center justify-center gap-1\">\n      <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n        <div \n          className={`h-1.5 rounded-full ${\n            percentage === 100 ? 'bg-blue-500' : \n            percentage > 0 ? 'bg-blue-400' : 'bg-gray-300'\n          }`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      <span className=\"card-title text-gray-600\">{percentage}%</span>\n    </div>\n  );\n});\n\nReceiptProgressBar.displayName = 'ReceiptProgressBar';\n\n//    ( )  \n//       usePurchaseMemory  \nconst StatementProgressBar = memo(({ purchase }: { purchase: Purchase }) => {\n  const { allPurchases } = usePurchaseMemory(); //    \n  \n  //      (  )\n  const currentPurchase = useMemo(() => {\n    if (!allPurchases) return purchase;\n    const memoryPurchase = allPurchases.find(p => p.id === purchase.id);\n    return memoryPurchase || purchase;\n  }, [allPurchases, purchase.id, purchase]);\n\n  //    \n  const statementProgress = useMemo(() => {\n    const items = currentPurchase.purchase_request_items || currentPurchase.items || [];\n    if (items.length === 0) {\n      return { completed: 0, total: 1, percentage: 0 };\n    }\n    \n    const total = items.length;\n    const completed = items.filter((item: any) => item.is_statement_received === true).length;\n    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n    \n    return { completed, total, percentage };\n  }, [currentPurchase]);\n\n  return (\n    <div className=\"flex items-center justify-center gap-1\">\n      <div className=\"bg-gray-200 rounded-full h-1.5 w-8\">\n        <div \n          className={`h-1.5 rounded-full ${\n            statementProgress.percentage === 100 ? 'bg-green-500' : \n            statementProgress.percentage > 0 ? 'bg-green-400' : 'bg-gray-300'\n          }`}\n          style={{ width: `${statementProgress.percentage}%` }}\n        />\n      </div>\n      <span className=\"card-title text-gray-600\">\n        {statementProgress.percentage}%\n      </span>\n    </div>\n  );\n});\n\nStatementProgressBar.displayName = 'StatementProgressBar';\n\n\n\n//   \nconst ProgressTypeBadge = memo(({ type }: { type?: string }) => {\n  const isAdvance = type === '' || type?.includes('');\n  \n  if (isAdvance) {\n    return (\n      <span className=\"badge-stats bg-red-500 text-white\">\n        \n      </span>\n    );\n  }\n  \n  return (\n    <span className=\"badge-stats bg-gray-500 text-white\">\n      \n    </span>\n  );\n});\n\nProgressTypeBadge.displayName = 'ProgressTypeBadge';\n\n//    \nconst TableRow = memo(({ purchase, onClick, activeTab, isLeadBuyer, onPaymentComplete, onReceiptComplete, onExcelDownload, onToggleUtkCheck, columnVisibility, vendorColumnWidth, currentUserRoles }: { \n  purchase: Purchase; \n  onClick: (purchase: Purchase) => void;\n  activeTab?: string;\n  isLeadBuyer?: boolean;\n  onPaymentComplete?: (purchaseId: number) => Promise<void>;\n  onReceiptComplete?: (purchaseId: number) => Promise<void>;\n  onExcelDownload?: (purchase: Purchase) => Promise<void>;\n  onToggleUtkCheck?: (purchase: Purchase) => Promise<void>;\n  columnVisibility?: ColumnVisibility;\n  vendorColumnWidth?: number;\n  currentUserRoles?: string[];\n}) => {\n  const isAdvance = purchase.progress_type === '' || purchase.progress_type?.includes('');\n  \n  //    \n  const isVisible = (columnId: DoneTabColumnId) => {\n    //      \n    if (!columnVisibility) return true;\n    \n    //     \n    if (activeTab === 'done' && RESTRICTED_COLUMNS.includes(columnId)) {\n      //     \n      const hasPermission = columnId === 'utk_status'\n        ? currentUserRoles?.some(role => UTK_AUTHORIZED_ROLES.includes(role))\n        : currentUserRoles?.some(role => AUTHORIZED_ROLES.includes(role));\n      if (!hasPermission) return false;\n    }\n    \n    return columnVisibility[columnId] !== false;\n  };\n\n  // UTK ()  ( )\n  const canUtkCheck = currentUserRoles?.some(role => UTK_AUTHORIZED_ROLES.includes(role)) ?? false;\n  \n  return (\n    <tr \n      className={`border-b hover:bg-gray-100 cursor-pointer transition-colors ${isAdvance ? 'bg-red-50 hover:bg-red-100' : ''}`}\n      onClick={() => onClick(purchase)}\n    >\n      {/*       */}\n      {activeTab === 'pending' && (\n        <td className={`px-2 py-1.5 whitespace-nowrap ${COMMON_COLUMN_CLASSES.approvalStatus}`}>\n          <ApprovalStatusBadge purchase={purchase} />\n        </td>\n      )}\n      {/*       */}\n      {activeTab === 'purchase' && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <PaymentProgressBar purchase={purchase} activeTab={activeTab} />\n        </td>\n      )}\n      {/*       */}\n      {activeTab === 'receipt' && isVisible('receipt_progress') && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <ReceiptProgressBar purchase={purchase} />\n        </td>\n      )}\n      {/*    */}\n      {activeTab === 'done' && isVisible('statement_progress') && (\n        <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receiptProgress}`}>\n          <StatementProgressBar purchase={purchase} />\n        </td>\n      )}\n      {/*   */}\n      {isVisible('purchase_order_number') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}>\n        <div className=\"flex items-center gap-1\">\n          {/*    -  ,   / */}\n          {onExcelDownload && (\n            <img\n              src=\"/excels-icon.svg\"\n              alt=\" \"\n              width=\"16\"\n              height=\"16\"\n              className={`inline-block align-middle transition-transform p-0.5 rounded\n                ${purchase.is_po_download ? 'border border-gray-400' : ''}\n                ${(purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                  (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved'))\n                  ? (purchase.is_po_download ? 'cursor-pointer' : 'cursor-pointer hover:scale-110')\n                  : 'opacity-40 grayscale cursor-not-allowed'}`}\n              onClick={async (e: React.MouseEvent) => {\n                if (purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                    (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved')) {\n                  e.stopPropagation();\n                  await onExcelDownload(purchase);\n                }\n              }}\n              style={{\n                pointerEvents: (purchase.progress_type === '' || purchase.progress_type?.includes('') ||\n                  (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved'))\n                  ? 'auto' : 'none'\n              }}\n              title={purchase.is_po_download ? ' ' : '  '}\n            />\n          )}\n          <span className=\"block truncate\" title={purchase.purchase_order_number || ''}>\n            {purchase.purchase_order_number || '-'}\n            {purchase.purchase_request_items && purchase.purchase_request_items.length > 1 && (\n              <span className=\"text-gray-500 ml-0.5\">({purchase.purchase_request_items.length})</span>\n            )}\n          </span>\n        </div>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('payment_category') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}>\n          <span className={`badge-stats ${\n            purchase.payment_category === '' || purchase.payment_category === ' ' ? 'bg-blue-500 text-white' :\n            purchase.payment_category === '' ? 'bg-green-500 text-white' :\n            purchase.payment_category === '' || purchase.payment_category === ' ' ? 'bg-gray-500 text-white' :\n            purchase.payment_category === ' ' ? 'bg-gray-500 text-white' :\n            'bg-gray-500 text-white'\n          }`}>\n            {(() => {\n              //   \n              if (purchase.payment_category === '') return '';\n              if (purchase.payment_category === ' ') return '';\n              if (purchase.payment_category === ' ') return '';\n              return purchase.payment_category || '-';\n            })()}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('requester_name') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.requesterName}`}>\n          <span className=\"block truncate\" title={purchase.requester_name || ''}>\n            {purchase.requester_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('request_date') && (\n        <td className={`py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.requestDate}`}>\n          {formatDateShort(purchase.request_date)}\n        </td>\n      )}\n      {/* UTK   */}\n      {activeTab === 'done' && isVisible('utk_status') && (\n        <td className={`pl-2 pr-3 py-1.5 card-title whitespace-nowrap text-center overflow-visible text-clip ${COMMON_COLUMN_CLASSES.utk}`}>\n          {canUtkCheck ? (\n            <button\n              type=\"button\"\n              onClick={async (e: React.MouseEvent) => {\n                e.stopPropagation();\n                await onToggleUtkCheck?.(purchase);\n              }}\n              className={`${(purchase as any).is_utk_checked ? 'badge-utk-complete' : 'badge-utk-pending'} mx-auto cursor-pointer`}\n              title={(purchase as any).is_utk_checked ? 'UTK  ' : 'UTK '}\n            >\n              {(purchase as any).is_utk_checked ? '' : ''}\n            </button>\n          ) : (\n            <span className={(purchase as any).is_utk_checked ? 'badge-utk-complete' : 'badge-utk-pending'}>\n              {(purchase as any).is_utk_checked ? '' : ''}\n            </span>\n          )}\n        </td>\n      )}\n      {/*   */}\n      {isVisible('vendor_name') && (\n        <td \n          className={`pl-3 pr-2 py-1.5 card-title ${activeTab === 'done' ? COMMON_COLUMN_CLASSES.vendorName : 'vendor-dynamic-column'}`}\n          style={activeTab === 'done' ? undefined : { \n            width: `${vendorColumnWidth || 80}px`, \n            minWidth: `${vendorColumnWidth || 80}px`, \n            maxWidth: `${vendorColumnWidth || 80}px` \n          }}\n        >\n          <span className=\"block truncate\" title={purchase.vendor_name || ''}>\n            {purchase.vendor_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('contact_name') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.contactName}`}>\n          <span className=\"block truncate\" title={purchase.contact_name || ''}>\n            {purchase.contact_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('delivery_request_date') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.deliveryRequestDate} ${\n          purchase.revised_delivery_request_date ? 'text-gray-400' : ''\n        }`}>\n          {formatDateShort(purchase.delivery_request_date)}\n        </td>\n      )}\n      {/*   */}\n      {(activeTab === 'receipt' || activeTab === 'done') && isVisible('revised_delivery_date') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.revisedDeliveryRequestDate}`}>\n          {formatDateShort(purchase.revised_delivery_request_date)}\n        </td>\n      )}\n      {/*   */}\n      {isVisible('item_name') && (\n        <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.itemName}`}>\n          <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.item_name || ''}>\n            {purchase.purchase_request_items?.[0]?.item_name || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('specification') && (\n        <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.specification}`}>\n          <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.specification || ''}>\n            {purchase.purchase_request_items?.[0]?.specification || '-'}\n          </span>\n        </td>\n      )}\n      {/*   */}\n      {isVisible('quantity') && (\n        (() => {\n          //     \n          const quantity = purchase.purchase_request_items?.reduce((sum, item) => sum + (item.quantity || 0), 0) || 0\n          const receivedQuantity = purchase.purchase_request_items?.reduce((sum, item) => sum + (item.received_quantity || 0), 0) || 0\n          const isFullyReceived = quantity === receivedQuantity && receivedQuantity > 0\n          const shouldWrap = (activeTab === 'receipt' || activeTab === 'done') && (quantity >= 100 || receivedQuantity >= 100) && !isFullyReceived\n          \n          return (\n            <td className={`px-2 card-title ${COMMON_COLUMN_CLASSES.quantity} ${shouldWrap ? 'py-0.5' : 'py-1.5'}`}>\n              {(activeTab === 'receipt' || activeTab === 'done') ? (\n                (() => {\n                  //         \n                  if (isFullyReceived) {\n                    return <span className=\"text-gray-900\">{receivedQuantity}</span>\n                  }\n                  \n                  //        \n                  const hasReceived = receivedQuantity > 0\n                  \n                  if (shouldWrap) {\n                    return (\n                      <div className=\"flex flex-col items-center justify-center gap-px leading-tight text-[10px]\">\n                        <div className={hasReceived ? 'text-gray-400' : ''}>{quantity}</div>\n                        <div className={hasReceived ? '' : 'text-gray-400'}>/{receivedQuantity}</div>\n                      </div>\n                    )\n                  } else {\n                    return (\n                      <span className=\"whitespace-nowrap\">\n                        <span className={hasReceived ? 'text-gray-400' : ''}>{quantity}</span>\n                        <span className={hasReceived ? '' : 'text-gray-400'}>/{receivedQuantity}</span>\n                      </span>\n                    )\n                  }\n                })()\n              ) : (\n                quantity || 0\n              )}\n            </td>\n          )\n        })()\n      )}\n      {/*   */}\n      {isVisible('unit_price') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}>\n          {(() => {\n            const itemCount = purchase.purchase_request_items?.length || 0\n            \n            //  2  '-' \n            if (itemCount > 1) {\n              return '-'\n            }\n            \n            //  1  \n            const unitPrice = purchase.purchase_request_items?.[0]?.unit_price_value || 0\n            const currency = purchase.purchase_request_items?.[0]?.unit_price_currency || 'KRW'\n            return `${unitPrice.toLocaleString()} ${getCurrencySymbol(currency)}`\n          })()}\n        </td>\n      )}\n      {/*   */}\n      {isVisible('amount') && (\n        <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}>\n          {(() => {\n            //     \n            //     \n            const totalAmount = purchase.purchase_request_items?.reduce((sum, item) => {\n              const baseAmount = item.amount_value || 0\n              const taxAmount = (purchase.payment_category === '' && item.tax_amount_value) ? item.tax_amount_value : 0\n              return sum + baseAmount + taxAmount\n            }, 0) || 0\n            const currency = purchase.purchase_request_items?.[0]?.amount_currency || purchase.currency || 'KRW'\n            return `${totalAmount.toLocaleString()} ${getCurrencySymbol(currency)}`\n          })()}\n        </td>\n      )}\n      \n      {/*     */}\n      {(activeTab === 'pending' || activeTab === 'purchase') && (\n        <>\n          {isVisible('remark') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n              <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.remark || ''}>\n                {purchase.purchase_request_items?.[0]?.remark || '-'}\n              </span>\n            </td>\n          )}\n          {activeTab === 'purchase' && isVisible('link') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.link}`}>\n              {purchase.purchase_request_items?.[0]?.link ? (\n                <a \n                  href={purchase.purchase_request_items?.[0]?.link} \n                  target=\"_blank\" \n                  rel=\"noopener noreferrer\" \n                  className=\"text-blue-600 hover:text-blue-800 underline truncate block\"\n                  title={purchase.purchase_request_items?.[0]?.link}\n                >\n                   \n                </a>\n              ) : (\n                <span className=\"text-gray-400\">-</span>\n              )}\n            </td>\n          )}\n          {isVisible('project_vendor') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n              <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n                {purchase.project_vendor || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('project_item') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n              <span className=\"block truncate\" title={purchase.project_item || ''}>\n                {purchase.project_item || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('sales_order_number') && (\n            <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n              <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n                {purchase.sales_order_number || '-'}\n              </span>\n            </td>\n          )}\n        </>\n      )}\n      \n      \n      {activeTab === 'receipt' && (\n        <>\n          {isVisible('remark') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n              <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.remark || ''}>\n                {purchase.purchase_request_items?.[0]?.remark || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('project_vendor') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n              <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n                {purchase.project_vendor || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('project_item') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n              <span className=\"block truncate\" title={purchase.project_item || ''}>\n                {purchase.project_item || '-'}\n              </span>\n            </td>\n          )}\n          {isVisible('sales_order_number') && (\n            <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n              <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n                {purchase.sales_order_number || '-'}\n              </span>\n            </td>\n          )}\n        </>\n      )}\n      \n      {(activeTab === 'done' || !activeTab) && (\n        <>\n          {/*   */}\n          {isVisible('remark') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.remark}`}>\n              <span className=\"block truncate\" title={purchase.purchase_request_items?.[0]?.remark || ''}>\n                {purchase.purchase_request_items?.[0]?.remark || '-'}\n              </span>\n            </td>\n          )}\n          {/*   */}\n          {isVisible('link') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.link}`}>\n              {purchase.purchase_request_items?.[0]?.link ? (\n                <a \n                  href={purchase.purchase_request_items?.[0]?.link} \n                  target=\"_blank\" \n                  rel=\"noopener noreferrer\" \n                  className=\"text-blue-600 hover:text-blue-800 underline truncate block\"\n                  title={purchase.purchase_request_items?.[0]?.link}\n                >\n                   \n                </a>\n              ) : (\n                <span className=\"text-gray-400\">-</span>\n              )}\n            </td>\n          )}\n          {/* PJ  */}\n          {isVisible('project_vendor') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectVendor}`}>\n              <span className=\"block truncate\" title={purchase.project_vendor || ''}>\n                {purchase.project_vendor || '-'}\n              </span>\n            </td>\n          )}\n          {/* PJ ITEM  */}\n          {isVisible('project_item') && (\n            <td className={`px-2 py-1.5 card-title ${COMMON_COLUMN_CLASSES.projectItem}`}>\n              <span className=\"block truncate\" title={purchase.project_item || ''}>\n                {purchase.project_item || '-'}\n              </span>\n            </td>\n          )}\n          {/*   */}\n          {isVisible('sales_order_number') && (\n            <td className={`px-2 py-1.5 card-title whitespace-nowrap ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}>\n              <span className=\"block truncate\" title={purchase.sales_order_number || ''}>\n                {purchase.sales_order_number || '-'}\n              </span>\n            </td>\n          )}\n          {/*   */}\n          {isVisible('purchase_progress') && activeTab !== 'purchase' && (\n            <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.status}`}>\n              <PaymentProgressBar purchase={purchase} activeTab={activeTab} />\n            </td>\n          )}\n          {/*   */}\n          {isVisible('receipt_progress') && (\n            <td className={`px-2 py-1.5 ${COMMON_COLUMN_CLASSES.receipt} ${activeTab === 'done' ? 'column-progress' : ''}`}>\n              <ReceiptProgressBar purchase={purchase} />\n            </td>\n          )}\n        </>\n      )}\n      \n    </tr>\n  );\n});\n\nTableRow.displayName = 'TableRow';\n\n//   \nconst FastPurchaseTable = ({ \n  purchases, \n  activeTab = 'done', \n  currentUserRoles = [], \n  onRefresh,\n  onOptimisticUpdate,\n  onPaymentComplete,\n  onReceiptComplete,\n  columnVisibility\n}: FastPurchaseTableProps) => {\n  const [selectedPurchaseId, setSelectedPurchaseId] = useState<number | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [deleteConfirmOpen, setDeleteConfirmOpen] = useState(false);\n  const [purchaseToDelete, setPurchaseToDelete] = useState<Purchase | null>(null);\n  // vendorColumnWidth  useMemo  \n  const supabase = createClient();\n\n  //   - lead buyer app_admin /   \n  const isLeadBuyer = currentUserRoles && (\n    currentUserRoles.includes('lead buyer') ||\n    currentUserRoles.includes('app_admin')\n  );\n  \n\n  //  \n  const canEdit = currentUserRoles.includes('final_approver') || \n                  currentUserRoles.includes('app_admin') || \n                  currentUserRoles.includes('ceo');\n  \n  const canDelete = canEdit;\n\n  //      (useState useEffect   )\n  const vendorColumnWidth = useMemo(() => {\n    if (!purchases || purchases.length === 0) return 80;\n\n    //        \n    const cacheKey = `${activeTab}-${purchases.length}`;\n    \n    let maxLength = 2; // \"\"  \n\n    //  :  100  \n    const sampleSize = Math.min(purchases.length, 100);\n    const sampledPurchases = purchases.slice(0, sampleSize);\n    \n    sampledPurchases.forEach(purchase => {\n      const vendorName = purchase.vendor_name || '';\n      // /     ( 1.5 )\n      const adjustedLength = vendorName.split('').reduce((acc, char) => {\n        return acc + (/[-]/.test(char) ? 1.5 : 1)\n      }, 0);\n      maxLength = Math.max(maxLength, Math.ceil(adjustedLength));\n    });\n\n    //    (  7px +  20px)\n    const calculatedWidth = Math.max(80, Math.min(200, maxLength * 7 + 20));\n    console.log(' [FastPurchaseTable]    :', { \n      activeTab,\n      maxLength,\n      calculatedWidth,\n      sampleSize,\n      firstVendor: sampledPurchases[0]?.vendor_name \n    });\n    return calculatedWidth;\n  }, [purchases, activeTab]);\n\n  const handleRowClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchaseId(purchase.id);\n    setIsModalOpen(true);\n  }, []);\n\n  const handleCloseModal = useCallback(() => {\n    setIsModalOpen(false);\n    setSelectedPurchaseId(null);\n  }, []);\n\n  // UTK   (  )\n  const handleToggleUtkCheck = useCallback(async (purchase: Purchase) => {\n    if (!purchase?.id) return\n    const isCurrentlyChecked = (purchase as any).is_utk_checked || false\n    const newStatus = !isCurrentlyChecked\n\n    const confirmMessage = newStatus\n      ? `: ${purchase.purchase_order_number}\\n\\nUTK  ?`\n      : `: ${purchase.purchase_order_number}\\n\\nUTK  ?`\n\n    if (!window.confirm(confirmMessage)) return\n\n    try {\n      const { error } = await supabase\n        .from('purchase_requests')\n        .update({ is_utk_checked: newStatus })\n        .eq('id', purchase.id)\n\n      if (error) {\n        logger.error('UTK  DB  ', { error, purchaseId: purchase.id })\n        toast.error('UTK     .')\n        return\n      }\n\n      //    (  )\n      updatePurchaseInMemory(purchase.id, (prev) => ({\n        ...prev,\n        is_utk_checked: newStatus\n      }))\n\n      toast.success(newStatus ? 'UTK  .' : 'UTK  .')\n\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (err) {\n      logger.error('UTK    ', err)\n      toast.error('UTK     .')\n    }\n  }, [supabase, onRefresh]);\n\n  //   \n  const handleExcelDownload = useCallback(async (purchase: Purchase) => {\n    try {\n      // DB    \n      const { data: purchaseRequest, error: requestError } = await supabase\n        .from('purchase_requests')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .single();\n\n      if (requestError || !purchaseRequest) {\n        toast.error('     .');\n        return;\n      }\n\n      //   \n      const { data: orderItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_order_number', purchase.purchase_order_number)\n        .order('line_number');\n\n      if (itemsError || !orderItems || orderItems.length === 0) {\n        toast.error('      .');\n        return;\n      }\n\n      //       \n      const vendorInfo = {\n        vendor_name: purchase.vendor_name,\n        vendor_phone: '',\n        vendor_fax: '',\n        vendor_contact_name: '',\n        vendor_payment_schedule: ''\n      };\n\n      try {\n        const vendorId = purchaseRequest.vendor_id || purchase.vendor_id;\n        const contactId = purchaseRequest.contact_id || purchase.contact_id;\n        \n        // vendor  \n        if (vendorId) {\n          const { data: vendorData } = await supabase\n            .from('vendors')\n            .select('vendor_phone, vendor_fax, vendor_payment_schedule')\n            .eq('id', vendorId)\n            .single();\n\n          if (vendorData) {\n            vendorInfo.vendor_phone = vendorData.vendor_phone || '';\n            vendorInfo.vendor_fax = vendorData.vendor_fax || '';\n            vendorInfo.vendor_payment_schedule = vendorData.vendor_payment_schedule || '';\n          }\n        }\n\n        // vendor_contacts contact_id   \n        if (contactId) {\n          const { data: contactData } = await supabase\n            .from('vendor_contacts')\n            .select('contact_name, contact_phone, contact_email')\n            .eq('id', contactId)\n            .single();\n          if (contactData) {\n            vendorInfo.vendor_contact_name = contactData.contact_name || '';\n          }\n        }\n      } catch (error) {\n        //     \n      }\n\n      const excelData: PurchaseOrderData = {\n        purchase_order_number: purchaseRequest.purchase_order_number || '',\n        request_date: purchaseRequest.request_date,\n        delivery_request_date: purchaseRequest.delivery_request_date,\n        requester_name: purchaseRequest.requester_name,\n        vendor_name: vendorInfo.vendor_name || '',\n        vendor_contact_name: vendorInfo.vendor_contact_name,\n        vendor_phone: vendorInfo.vendor_phone,\n        vendor_fax: vendorInfo.vendor_fax,\n        project_vendor: purchaseRequest.project_vendor,\n        sales_order_number: purchaseRequest.sales_order_number,\n        project_item: purchaseRequest.project_item,\n        vendor_payment_schedule: vendorInfo.vendor_payment_schedule,\n        items: orderItems.map((item: any) => ({\n          line_number: item.line_number,\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          amount_value: item.amount_value,\n          remark: item.remark,\n          currency: purchaseRequest.currency || 'KRW'\n        }))\n      };\n\n      //   ExcelJS \n      const blob = await generatePurchaseOrderExcelJS(excelData);\n      \n      //  \n      const downloadFilename = `_${excelData.vendor_name}_${excelData.purchase_order_number}.xlsx`;\n\n      //  \n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = downloadFilename;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      window.URL.revokeObjectURL(url);\n      \n      toast.success('  .');\n      \n      // DB   (is_po_download)  - lead buyer \n      try {\n        const canUpdateFlag = currentUserRoles && (\n          currentUserRoles.includes('lead buyer')\n        );\n\n        if (canUpdateFlag) {\n          const { error: downloadFlagErr } = await supabase\n            .from('purchase_requests')\n            .update({ is_po_download: true })\n            .eq('purchase_order_number', purchase.purchase_order_number);\n          \n          if (!downloadFlagErr) {\n            //  \n            onRefresh?.();\n          }\n        }\n      } catch (flagErr) {\n        //    \n      }\n    } catch (error) {\n      toast.error('  .');\n    }\n  }, [supabase]);\n\n  const handleConfirmDelete = useCallback(async () => {\n    if (!purchaseToDelete) {\n      logger.error('[handleConfirmDelete] purchaseToDelete null');\n      toast.error('    .');\n      return;\n    }\n\n    logger.info(' [handleConfirmDelete]  ', {\n      purchaseId: purchaseToDelete.id,\n      purchaseOrderNumber: purchaseToDelete.purchase_order_number,\n      type: typeof purchaseToDelete.id\n    });\n\n    try {\n      // Supabase   \n      const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n      const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n      \n      if (!supabaseUrl || !supabaseAnonKey || supabaseUrl.includes('placeholder')) {\n        logger.warn('Supabase     - FastPurchaseTable');\n        toast.error(\"   .\");\n        return;\n      }\n\n      //    \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      \n      if (authError || !user) {\n        toast.error(\" .\");\n        return;\n      }\n\n      //   \n      const { data: employee, error: empError } = await supabase\n        .from('employees')\n        .select('name, email, purchase_role')\n        .eq('email', user.email)\n        .single();\n\n\n      if (empError || !employee) {\n        toast.error(\"    .\");\n        return;\n      }\n\n      //  \n      let roles: string[] = [];\n      if (employee.purchase_role) {\n        if (Array.isArray(employee.purchase_role)) {\n          roles = employee.purchase_role.map((r: any) => String(r).trim());\n        } else {\n          const roleString = String(employee.purchase_role);\n          roles = roleString.split(',').map((r: string) => r.trim()).filter((r: string) => r.length > 0);\n        }\n      }\n\n      const canEdit = roles.includes('final_approver') || \n                      roles.includes('app_admin') || \n                      roles.includes('ceo');\n      \n      const isApproved = purchaseToDelete.final_manager_status === 'approved';\n      const isRequester = purchaseToDelete.requester_name === employee.name;\n      const canDeleteThis = isApproved ? canEdit : (canEdit || isRequester);\n\n\n      if (!canDeleteThis) {\n        logger.warn('[handleConfirmDelete]   ', {\n          canEdit,\n          isApproved,\n          isRequester,\n          roles,\n          employeeName: employee.name\n        });\n        toast.error(\"  .\");\n        return;\n      }\n\n      logger.info(' [handleConfirmDelete]   ,  ', {\n        purchaseId: purchaseToDelete.id\n      });\n\n      //   \n      logger.info(' [handleConfirmDelete]   ', {\n        purchaseId: purchaseToDelete.id\n      });\n      \n      const { data: deletedItems, error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .delete()\n        .eq('purchase_request_id', purchaseToDelete.id)\n        .select();\n\n      if (itemsError) {\n        logger.error(' [handleConfirmDelete]     ', itemsError, {\n          code: itemsError.code,\n          message: itemsError.message,\n          details: itemsError.details,\n          hint: itemsError.hint,\n          purchaseId: purchaseToDelete.id\n        });\n        throw itemsError;\n      }\n\n      logger.info(' [handleConfirmDelete]   ', {\n        purchaseId: purchaseToDelete.id,\n        deletedItemsCount: deletedItems?.length || 0\n      });\n\n      // ID   \n      const purchaseIdForDelete = typeof purchaseToDelete.id === 'string' \n        ? parseInt(purchaseToDelete.id, 10) \n        : purchaseToDelete.id;\n      \n      if (isNaN(purchaseIdForDelete)) {\n        logger.error(' [handleConfirmDelete] purchaseId  ', {\n          originalId: purchaseToDelete.id,\n          type: typeof purchaseToDelete.id\n        });\n        throw new Error(' ID  .');\n      }\n\n      // support_inquires   purchase_request_id   \n      // Foreign key constraint      \n      //  :  (support_inquires)  , purchase_request_id null \n      logger.info(' [handleConfirmDelete] support_inquires     (  )', {\n        purchaseId: purchaseIdForDelete\n      });\n      \n      let inquiriesUpdated = false;\n      let inquiriesCount = 0;\n      \n      try {\n        const { data: relatedInquiries, error: inquiriesCheckError } = await supabase\n          .from('support_inquires')\n          .select('id, purchase_order_number')\n          .eq('purchase_request_id', purchaseIdForDelete);\n\n        if (inquiriesCheckError) {\n          logger.warn('[handleConfirmDelete] support_inquires   (  )', {\n            error: inquiriesCheckError,\n            purchaseId: purchaseIdForDelete\n          });\n        } else if (relatedInquiries && relatedInquiries.length > 0) {\n          inquiriesCount = relatedInquiries.length;\n          logger.info(' [handleConfirmDelete] support_inquires    (  )', {\n            purchaseId: purchaseIdForDelete,\n            inquiriesCount: relatedInquiries.length,\n            inquiryIds: relatedInquiries.map((i: any) => i.id),\n            note: '    purchase_request_id null .'\n          });\n          \n          // support_inquires purchase_request_id null  ( )\n          //   ,    \n          const { data: updatedInquiries, error: inquiriesUpdateError } = await supabase\n            .from('support_inquires')\n            .update({ purchase_request_id: null })\n            .eq('purchase_request_id', purchaseIdForDelete)\n            .select();\n\n          if (inquiriesUpdateError) {\n            logger.error(' [handleConfirmDelete] support_inquires  ', {\n              error: inquiriesUpdateError,\n              purchaseId: purchaseIdForDelete,\n              code: inquiriesUpdateError.code,\n              message: inquiriesUpdateError.message,\n              details: inquiriesUpdateError.details\n            });\n            //         \n            throw new Error(` (${relatedInquiries.length})   .  .`);\n          } else {\n            inquiriesUpdated = true;\n            logger.info(' [handleConfirmDelete] support_inquires   (  )', {\n              purchaseId: purchaseIdForDelete,\n              updatedCount: updatedInquiries?.length || relatedInquiries.length,\n              updatedInquiryIds: updatedInquiries?.map((i: any) => i.id) || relatedInquiries.map((i: any) => i.id),\n              note: '   , purchase_request_id null .'\n            });\n            \n            //   DB    \n            await new Promise(resolve => setTimeout(resolve, 100));\n          }\n        } else {\n          logger.info(' [handleConfirmDelete] support_inquires   ', {\n            purchaseId: purchaseIdForDelete\n          });\n        }\n      } catch (inquiriesError) {\n        logger.error(' [handleConfirmDelete] support_inquires    ', {\n          error: inquiriesError,\n          purchaseId: purchaseIdForDelete\n        });\n        //    \n        toast.error(`     : ${inquiriesError instanceof Error ? inquiriesError.message : '   '}`);\n        throw inquiriesError;\n      }\n\n      //  \n      logger.info(' [handleConfirmDelete]   ', {\n        purchaseId: purchaseIdForDelete,\n        idType: typeof purchaseToDelete.id,\n        idValue: purchaseToDelete.id\n      });\n      \n      // select()    (409  )\n      const { error: requestError } = await supabase\n        .from('purchase_requests')\n        .delete()\n        .eq('id', purchaseIdForDelete);\n\n      if (requestError) {\n        logger.error(' [handleConfirmDelete]     ', requestError, {\n          code: requestError.code,\n          message: requestError.message,\n          details: requestError.details,\n          hint: requestError.hint,\n          purchaseId: purchaseIdForDelete,\n          originalId: purchaseToDelete.id,\n          note: '     .      .'\n        });\n        \n        // 409 Conflict  Foreign key violation      \n        if (requestError.code === '409' || \n            requestError.code === '23503' || \n            requestError.message?.includes('409') ||\n            requestError.message?.includes('foreign key')) {\n          const errorMsg = requestError.details || requestError.message || '   .';\n          logger.error(' [handleConfirmDelete] Foreign key constraint ', {\n            code: requestError.code,\n            message: requestError.message,\n            details: requestError.details,\n            hint: requestError.hint,\n            purchaseId: purchaseIdForDelete\n          });\n          toast.error(`  : ${errorMsg}  .`);\n        } else {\n          throw requestError;\n        }\n        return;\n      }\n\n      logger.info(' [handleConfirmDelete]   ', {\n        purchaseId: purchaseIdForDelete,\n        originalId: purchaseToDelete.id,\n        inquiriesPreserved: inquiriesUpdated ? `${inquiriesCount}   ` : '  '\n      });\n\n      //      (   )\n      const purchaseIdNumber = purchaseIdForDelete;\n      const memoryUpdated = removePurchaseFromMemory(purchaseIdNumber);\n      if (!memoryUpdated) {\n        logger.warn('[handleConfirmDelete]     ', { \n          purchaseId: purchaseIdNumber,\n          originalId: purchaseToDelete.id\n        });\n      } else {\n        logger.info(' [handleConfirmDelete]     ', { \n          purchaseId: purchaseIdNumber,\n          originalId: purchaseToDelete.id\n        });\n      }\n\n      //    (    )\n      if (inquiriesUpdated && inquiriesCount > 0) {\n        toast.success(` . (${inquiriesCount}   )`);\n      } else {\n        toast.success(\"  .\");\n      }\n      \n      //      (      )\n      setIsModalOpen(false);\n      setSelectedPurchaseId(null);\n      setDeleteConfirmOpen(false);\n      setPurchaseToDelete(null);\n      \n      //   ( ) -     UI \n      //      \n      if (onRefresh) {\n        try {\n          await onRefresh(true, { silent: false });\n          logger.info(' [handleConfirmDelete]   ');\n        } catch (refreshError) {\n          logger.error(' [handleConfirmDelete]   ', refreshError);\n        }\n      }\n    } catch (error) {\n      const errorObj = error as any;\n      logger.error(' [handleConfirmDelete]     ', errorObj, {\n        name: errorObj?.name,\n        message: errorObj?.message,\n        code: errorObj?.code,\n        details: errorObj?.details,\n        hint: errorObj?.hint,\n        stack: errorObj?.stack,\n        purchaseId: purchaseToDelete?.id,\n        purchaseOrderNumber: purchaseToDelete?.purchase_order_number\n      });\n      toast.error(`   : ${errorObj?.message || '   '}`);\n    } finally {\n      setDeleteConfirmOpen(false);\n      setPurchaseToDelete(null);\n    }\n  }, [supabase, purchaseToDelete, onRefresh]);\n\n  //     \n  const isColumnVisible = useCallback((columnId: DoneTabColumnId) => {\n    if (!columnVisibility) return true; // columnVisibility    \n    \n    //     \n    if (activeTab === 'done' && RESTRICTED_COLUMNS.includes(columnId)) {\n      //     \n      const hasPermission = currentUserRoles?.some(role => AUTHORIZED_ROLES.includes(role));\n      if (!hasPermission) return false;\n    }\n    \n    return columnVisibility[columnId] !== false;\n  }, [columnVisibility, activeTab, currentUserRoles]);\n\n  //    \n  const tableHeader = useMemo(() => {\n    if (activeTab === 'pending') {\n      return (\n        <thead className=\"sticky top-0 z-30 bg-gray-50\" style={{ boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)' }}>\n          <tr>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.approvalStatus}`}></th>\n            {isColumnVisible('purchase_order_number') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}></th>\n            )}\n            {isColumnVisible('payment_category') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}></th>\n            )}\n            {isColumnVisible('requester_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requesterName}`}></th>\n            )}\n            {isColumnVisible('request_date') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requestDate}`}></th>\n            )}\n            {isColumnVisible('vendor_name') && (\n              <th \n                className=\"px-2 py-1.5 modal-label text-gray-900 text-left vendor-dynamic-column\"\n                style={{ \n                  width: `${vendorColumnWidth || 80}px`, \n                  minWidth: `${vendorColumnWidth || 80}px`, \n                  maxWidth: `${vendorColumnWidth || 80}px` \n                }}\n              ></th>\n            )}\n            {isColumnVisible('contact_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.contactName}`}></th>\n            )}\n            {isColumnVisible('delivery_request_date') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.deliveryRequestDate}`}></th>\n            )}\n            {isColumnVisible('item_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.itemName}`}></th>\n            )}\n            {isColumnVisible('specification') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.specification}`}></th>\n            )}\n            {isColumnVisible('quantity') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.quantity}`}></th>\n            )}\n            {isColumnVisible('unit_price') && (\n              <th className={`px-2 py-1.5 table-header-text text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}></th>\n            )}\n            {isColumnVisible('amount') && (\n              <th className={`px-2 py-1.5 table-header-text text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}></th>\n            )}\n            {isColumnVisible('remark') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n            )}\n            {isColumnVisible('project_vendor') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n            )}\n            {isColumnVisible('project_item') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n            )}\n            {isColumnVisible('sales_order_number') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n            )}\n          </tr>\n        </thead>\n      );\n    }\n    \n    if (activeTab === 'purchase') {\n      return (\n        <thead className=\"sticky top-0 z-30 bg-gray-50\" style={{ boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)' }}>\n          <tr>\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n            {isColumnVisible('purchase_order_number') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}></th>\n            )}\n            {isColumnVisible('payment_category') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}></th>\n            )}\n            {isColumnVisible('requester_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requesterName}`}></th>\n            )}\n            {isColumnVisible('request_date') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requestDate}`}></th>\n            )}\n            {isColumnVisible('vendor_name') && (\n              <th \n                className=\"px-2 py-1.5 modal-label text-gray-900 text-left vendor-dynamic-column\"\n                style={{ \n                  width: `${vendorColumnWidth || 80}px`, \n                  minWidth: `${vendorColumnWidth || 80}px`, \n                  maxWidth: `${vendorColumnWidth || 80}px` \n                }}\n              ></th>\n            )}\n            {isColumnVisible('contact_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.contactName}`}></th>\n            )}\n            {isColumnVisible('delivery_request_date') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.deliveryRequestDate}`}></th>\n            )}\n            {isColumnVisible('item_name') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.itemName}`}></th>\n            )}\n            {isColumnVisible('specification') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.specification}`}></th>\n            )}\n            {isColumnVisible('quantity') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.quantity}`}></th>\n            )}\n            {isColumnVisible('unit_price') && (\n              <th className={`px-2 py-1.5 table-header-text text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}></th>\n            )}\n            {isColumnVisible('amount') && (\n              <th className={`px-2 py-1.5 table-header-text text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}></th>\n            )}\n            {isColumnVisible('remark') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n            )}\n            {activeTab === 'purchase' && isColumnVisible('link') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.link}`}></th>\n            )}\n            {isColumnVisible('project_vendor') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n            )}\n            {isColumnVisible('project_item') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n            )}\n            {isColumnVisible('sales_order_number') && (\n              <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n            )}\n          </tr>\n        </thead>\n      );\n    }\n    \n    const baseHeaders = (\n      <>\n        {isColumnVisible('purchase_order_number') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.purchaseOrderNumber}`}></th>\n        )}\n        {isColumnVisible('payment_category') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.paymentCategory}`}></th>\n        )}\n        {isColumnVisible('requester_name') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.requesterName}`}></th>\n        )}\n        {isColumnVisible('request_date') && (\n          <th className={`py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.requestDate}`}></th>\n        )}\n        {/*   UTK     */}\n        {activeTab === 'done' && isColumnVisible('utk_status') && (\n          <th className={`pl-2 pr-3 py-1.5 modal-label text-gray-900 whitespace-nowrap text-center ${COMMON_COLUMN_CLASSES.utk}`}>UTK</th>\n        )}\n        {isColumnVisible('vendor_name') && (\n          <th \n            className={`px-2 py-1.5 modal-label text-gray-900 text-left ${activeTab === 'done' ? COMMON_COLUMN_CLASSES.vendorName : 'vendor-dynamic-column'}`}\n            style={activeTab === 'done' ? undefined : { \n              width: `${vendorColumnWidth || 80}px`, \n              minWidth: `${vendorColumnWidth || 80}px`, \n              maxWidth: `${vendorColumnWidth || 80}px` \n            }}\n          ></th>\n        )}\n        {isColumnVisible('contact_name') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.contactName}`}></th>\n        )}\n        {isColumnVisible('delivery_request_date') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.deliveryRequestDate}`}></th>\n        )}\n        {(activeTab === 'receipt' || activeTab === 'done') && isColumnVisible('revised_delivery_date') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.revisedDeliveryRequestDate}`}> </th>\n        )}\n        {isColumnVisible('item_name') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.itemName}`}></th>\n        )}\n        {isColumnVisible('specification') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 text-left ${COMMON_COLUMN_CLASSES.specification}`}></th>\n        )}\n        {isColumnVisible('quantity') && (\n          <th className={`px-2 py-1.5 modal-label text-gray-900 ${COMMON_COLUMN_CLASSES.quantity}`}>\n            {(activeTab === 'receipt' || activeTab === 'done') ? (\n              <div className=\"flex flex-col items-center leading-tight\">\n                <div className=\"text-[9px]\">/</div>\n                <div className=\"text-[10px]\"></div>\n              </div>\n            ) : (\n              ''\n            )}\n          </th>\n        )}\n        {isColumnVisible('unit_price') && (\n          <th className={`px-2 py-1.5 table-header-text text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.unitPrice}`}></th>\n        )}\n        {isColumnVisible('amount') && (\n          <th className={`px-2 py-1.5 table-header-text text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.amount}`}>( )</th>\n        )}\n      </>\n    );\n\n    let additionalHeaders = null;\n    \n    if (activeTab === 'receipt') {\n      additionalHeaders = (\n        <>\n          {isColumnVisible('remark') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n          )}\n          {isColumnVisible('project_vendor') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n          )}\n          {isColumnVisible('project_item') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n          )}\n          {isColumnVisible('sales_order_number') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n          )}\n        </>\n      );\n    } else if (activeTab === 'done') {\n      //  \n      additionalHeaders = (\n        <>\n          {isColumnVisible('remark') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.remark}`}></th>\n          )}\n          {isColumnVisible('link') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.link}`}></th>\n          )}\n          {isColumnVisible('project_vendor') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectVendor}`}>PJ</th>\n          )}\n          {isColumnVisible('project_item') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.projectItem}`}>PJ ITEM</th>\n          )}\n          {isColumnVisible('sales_order_number') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap text-left ${COMMON_COLUMN_CLASSES.salesOrderNumber}`}></th>\n          )}\n          {isColumnVisible('purchase_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.status}`}></th>\n          )}\n          {isColumnVisible('receipt_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receipt}`}></th>\n          )}\n        </>\n      );\n    }\n\n    return (\n      <thead className=\"sticky top-0 z-30 bg-gray-50\" style={{ boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)' }}>\n        <tr>\n          {/*      */}\n          {activeTab === 'receipt' && isColumnVisible('receipt_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n          )}\n          {/*       */}\n          {activeTab === 'done' && isColumnVisible('statement_progress') && (\n            <th className={`px-2 py-1.5 modal-label text-gray-900 whitespace-nowrap ${COMMON_COLUMN_CLASSES.receiptProgress}`}></th>\n          )}\n          {baseHeaders}\n          {additionalHeaders}\n        </tr>\n      </thead>\n    );\n  }, [activeTab, isColumnVisible, vendorColumnWidth]);\n\n  //        \n  const shouldUseFitLayout = useMemo(() => {\n    if (!columnVisibility) return false;\n    const hasHidden = Object.values(columnVisibility).some(visible => !visible);\n    if (!hasHidden) return false;\n    return true;\n  }, [columnVisibility]);\n\n  //      (100   )\n  const shouldUseVirtualScroll = useMemo(() => {\n    return purchases.length >= 100;\n  }, [purchases.length]);\n\n  return (\n    <>\n      {/*    -   1,979     */}\n      <div className=\"hidden md:block w-full max-w-full\">\n        \n{shouldUseVirtualScroll ? (\n          //     (100  ) - DOM   \n          <VirtualScrollTable\n            purchases={purchases}\n            activeTab={activeTab}\n            onRowClick={handleRowClick}\n            isLeadBuyer={isLeadBuyer}\n            onPaymentComplete={onPaymentComplete}\n            onReceiptComplete={onReceiptComplete}\n            onExcelDownload={handleExcelDownload}\n            onToggleUtkCheck={handleToggleUtkCheck}\n            columnVisibility={columnVisibility}\n            vendorColumnWidth={vendorColumnWidth}\n            tableHeader={tableHeader}\n            TableRowComponent={TableRow}\n            shouldUseFitLayout={shouldUseFitLayout}\n            currentUserRoles={currentUserRoles}\n          />\n        ) : (\n          //   (100  )\n          <div className={shouldUseFitLayout ? 'table-container-fit-left max-h-[70vh] overflow-auto' : 'overflow-x-auto overflow-y-auto max-h-[70vh] border rounded-lg'}>\n            <table className={shouldUseFitLayout ? `table-fit-left ${activeTab}-tab` : 'w-full min-w-[1790px] border-collapse'}>\n              {tableHeader}\n              <tbody>\n                {purchases.map((purchase) => (\n                  <TableRow \n                    key={purchase.id} \n                    purchase={purchase} \n                    onClick={handleRowClick}\n                    activeTab={activeTab}\n                    isLeadBuyer={isLeadBuyer}\n                    onPaymentComplete={onPaymentComplete}\n                    onReceiptComplete={onReceiptComplete}\n                    onExcelDownload={handleExcelDownload}\n                    onToggleUtkCheck={handleToggleUtkCheck}\n                    vendorColumnWidth={vendorColumnWidth}\n                    columnVisibility={columnVisibility}\n                    currentUserRoles={currentUserRoles}\n                  />\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n      \n      {/*    */}\n      <div className=\"hidden sm:block md:hidden w-full\">\n        <div className=\"overflow-x-auto border rounded-lg\">\n          <table className=\"w-full min-w-[600px] card-title\">\n            <thead className=\"sticky top-0 z-30 bg-gray-50\" style={{ boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)' }}>\n              <tr>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-24\"></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-16\"></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 vendor-dynamic-column\" style={{ width: `${vendorColumnWidth || 80}px` }}></th>\n                <th className=\"text-left p-2 modal-label text-gray-900 w-32\"></th>\n                <th className=\"text-right p-2 modal-label text-gray-900 w-20\"></th>\n                <th className=\"text-center p-2 modal-label text-gray-900 w-16\"></th>\n              </tr>\n            </thead>\n            <tbody>\n              {purchases.map((purchase) => (\n                <tr \n                  key={purchase.id}\n                  className=\"border-b hover:bg-gray-50 cursor-pointer\"\n                  onClick={() => handleRowClick(purchase)}\n                >\n                  <td className=\"p-2 modal-value\">{purchase.purchase_order_number || '-'}</td>\n                  <td className=\"p-2\">{purchase.requester_name}</td>\n                  <td className=\"p-2 truncate\" title={purchase.vendor_name}>{purchase.vendor_name}</td>\n                  <td className=\"p-2 truncate\" title={purchase.purchase_request_items?.[0]?.item_name}>{purchase.purchase_request_items?.[0]?.item_name || '-'}</td>\n                  <td className=\"p-2 text-right card-amount\">\n                    {purchase.purchase_request_items?.[0]?.amount_value ? `${purchase.purchase_request_items[0].amount_value.toLocaleString()} ${getCurrencySymbol(purchase.purchase_request_items[0]?.amount_currency || 'KRW')}` : purchase.total_amount ? `${purchase.total_amount.toLocaleString()} ${getCurrencySymbol(purchase.currency || 'KRW')}` : `0 ${getCurrencySymbol(purchase.currency || 'KRW')}`}\n                  </td>\n                  <td className=\"p-2 text-center\">\n                    <StatusBadge purchase={purchase} />\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n      \n      {/*    */}\n      <div className=\"sm:hidden space-y-3\">\n        {purchases.map((purchase) => (\n          <MobilePurchaseCard\n            key={purchase.id}\n            purchase={purchase}\n            onClick={() => handleRowClick(purchase)}\n          />\n        ))}\n      </div>\n      \n      {/*  /  */}\n      <PurchaseDetailModal\n        purchaseId={selectedPurchaseId}\n        isOpen={isModalOpen}\n        onClose={handleCloseModal}\n        currentUserRoles={currentUserRoles}\n        activeTab={activeTab}\n        onRefresh={onRefresh}\n        onOptimisticUpdate={onOptimisticUpdate}\n        onDelete={(purchase) => {\n          logger.info(' [FastPurchaseTable]   ', {\n            purchaseId: purchase.id,\n            purchaseOrderNumber: purchase.purchase_order_number,\n            type: typeof purchase.id\n          });\n          setPurchaseToDelete(purchase as unknown as Purchase);\n          setDeleteConfirmOpen(true);\n        }}\n      />\n\n      {/*    */}\n      <AlertDialog open={deleteConfirmOpen} onOpenChange={(open) => {\n        setDeleteConfirmOpen(open);\n        if (!open) {\n          //    purchaseToDelete \n          setPurchaseToDelete(null);\n        }\n      }}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>  </AlertDialogTitle>\n            <AlertDialogDescription>\n               <strong>{purchaseToDelete?.purchase_order_number || '  '}</strong> ?\n              <br />\n                  .\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel></AlertDialogCancel>\n            <AlertDialogAction\n              onClick={async () => {\n                logger.info(' [FastPurchaseTable]    ', {\n                  purchaseId: purchaseToDelete?.id,\n                  purchaseOrderNumber: purchaseToDelete?.purchase_order_number\n                });\n                await handleConfirmDelete();\n              }}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              \n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </>\n  );\n};\n\nFastPurchaseTable.displayName = 'FastPurchaseTable';\n\nexport default FastPurchaseTable;","import { useState, useRef, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { \n  Sliders, \n  ArrowUpDown, \n  Search, \n  X, \n  Calendar,\n  Check,\n  User,\n  Building,\n  Package,\n  DollarSign,\n  CheckCircle\n} from 'lucide-react'\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from '@/components/ui/popover'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Calendar as CalendarComponent } from '@/components/ui/calendar'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\n\n//   \ntype FilterCondition = 'contains' | 'equals' | 'starts_with' | 'ends_with' | 'is_empty' | 'is_not_empty' | 'greater_than' | 'less_than' | 'after' | 'before' | 'not_equals'\n\n//   \nexport interface FilterRule {\n  id: string\n  field: string\n  condition: FilterCondition\n  value: string | number | Date\n  label: string\n  dateField?: string // /    \n}\n\nexport interface SortRule {\n  field: string\n  direction: 'asc' | 'desc'\n  label: string\n}\n\ninterface FilterToolbarProps {\n  activeFilters: FilterRule[]\n  sortConfig: SortRule | null\n  searchTerm: string\n  onFiltersChange: (filters: FilterRule[]) => void\n  onSortChange: (sort: SortRule | null) => void\n  onSearchChange: (search: string) => void\n  availableEmployees?: string[]\n  availableVendors?: string[]\n  availableContacts?: string[]\n  availablePaymentSchedules?: string[]\n  children?: React.ReactNode //      \n}\n\n//   \nconst FILTER_FIELDS = [\n  //  \n  { \n    key: 'date_range', \n    label: '', \n    type: 'date_range',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'date_month', \n    label: '', \n    type: 'date_month',\n    icon: Calendar,\n    category: ''\n  },\n  \n  // & \n  { \n    key: 'requester_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  { \n    key: 'vendor_name', \n    label: '', \n    type: 'searchable_select',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'contact_name', \n    label: '', \n    type: 'searchable_select',\n    icon: User,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'purchase_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'item_name', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'specification', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'remark', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'project_vendor', \n    label: 'PJ', \n    type: 'text',\n    icon: Building,\n    category: ''\n  },\n  { \n    key: 'project_item', \n    label: 'PJ ITEM', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  { \n    key: 'sales_order_number', \n    label: '', \n    type: 'text',\n    icon: Package,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'quantity', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'unit_price_value', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  { \n    key: 'total_amount', \n    label: '', \n    type: 'number',\n    icon: DollarSign,\n    category: ''\n  },\n  \n  //  \n  { \n    key: 'payment_category', \n    label: '', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', ' ', '', '', '']\n  },\n  { \n    key: 'payment_schedule', \n    label: '', \n    type: 'select_with_empty',\n    icon: Calendar,\n    category: ''\n  },\n  { \n    key: 'is_payment_completed', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_received', \n    label: '', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_statement_received', \n    label: ' ', \n    type: 'select',\n    icon: Check,\n    category: '',\n    options: ['', '']\n  },\n  { \n    key: 'is_utk_checked', \n    label: 'UTK ', \n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '']\n  },\n  {\n    key: 'approval_status',\n    label: '',\n    type: 'select',\n    icon: CheckCircle,\n    category: '',\n    options: ['', '1', '', '']\n  }\n]\n\n//   \nconst TEXT_CONDITIONS = [\n  { value: 'contains', label: '' },\n  { value: 'equals', label: '' },\n  { value: 'starts_with', label: '' },\n  { value: 'ends_with', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst NUMBER_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'greater_than', label: '' },\n  { value: 'less_than', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst DATE_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'after', label: '' },\n  { value: 'before', label: '' },\n  { value: 'between', label: '' },\n  { value: 'is_empty', label: '' },\n  { value: 'is_not_empty', label: ' ' }\n]\n\nconst SELECT_CONDITIONS = [\n  { value: 'equals', label: '' },\n  { value: 'not_equals', label: '' }\n]\n\n//    \nconst DATE_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'payment_completed_at', label: '' },\n  { value: 'received_at', label: '' },\n  { value: 'created_at', label: '' },\n  { value: 'statement_received_at', label: '' }\n]\n\n//   \nconst SORT_FIELDS = [\n  { value: 'request_date', label: '' },\n  { value: 'purchase_order_number', label: '' },\n  { value: 'vendor_name', label: '' },\n  { value: 'requester_name', label: '' },\n  { value: 'total_amount', label: '' },\n  { value: 'delivery_request_date', label: '' },\n  { value: 'created_at', label: '' }\n]\n\nexport default function FilterToolbar({\n  activeFilters,\n  sortConfig,\n  searchTerm,\n  onFiltersChange,\n  onSortChange,\n  onSearchChange,\n  availableEmployees = [],\n  availableVendors = [],\n  availableContacts = [],\n  availablePaymentSchedules = [],\n  children\n}: FilterToolbarProps) {\n  const [isFilterOpen, setIsFilterOpen] = useState(false)\n  const [isSortOpen, setIsSortOpen] = useState(false)\n  const [isSearchExpanded, setIsSearchExpanded] = useState(false)\n  const [newFilter, setNewFilter] = useState<Partial<FilterRule>>({})\n  const [datePickerOpen, setDatePickerOpen] = useState(false)\n  const [monthPickerOpen, setMonthPickerOpen] = useState(false)\n  const [tempDateRange, setTempDateRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempMonth, setTempMonth] = useState<Date | undefined>()\n  const [tempMonthRange, setTempMonthRange] = useState<{from?: Date, to?: Date}>({})\n  const [tempSort, setTempSort] = useState<{field?: string, direction?: 'asc' | 'desc'}>({})\n  const [searchValue, setSearchValue] = useState('')\n  const searchInputRef = useRef<HTMLInputElement>(null)\n\n  //    \n  useEffect(() => {\n    if (isSearchExpanded && searchInputRef.current) {\n      searchInputRef.current.focus()\n    }\n  }, [isSearchExpanded])\n\n  //       \n  useEffect(() => {\n    if (isSortOpen) {\n      setTempSort({\n        field: sortConfig?.field || '',\n        direction: sortConfig?.direction || 'asc'\n      })\n    }\n  }, [isSortOpen, sortConfig])\n\n  const handleAddFilter = (field: string) => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === field)\n    if (!fieldConfig) return\n\n    //      \n    let defaultCondition: FilterCondition = 'contains'\n    if (fieldConfig.type === 'date_range' || fieldConfig.type === 'date_month') {\n      defaultCondition = 'equals'\n    }\n\n    setNewFilter({\n      id: `${field}_${Date.now()}`,\n      field,\n      condition: defaultCondition,\n      value: '',\n      label: fieldConfig.label\n    })\n  }\n\n  const handleApplyFilter = () => {\n    const isDateFilter = newFilter.field === 'date_range' || newFilter.field === 'date_month'\n    const requiresDateField = isDateFilter && !newFilter.dateField\n    \n    //      \n    let finalCondition = newFilter.condition\n    if (!finalCondition) {\n      if (isDateFilter) {\n        finalCondition = 'equals'\n      } else {\n        //   'contains',   'equals'\n        const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n        finalCondition = (fieldConfig?.type === 'select' || fieldConfig?.type === 'select_with_empty' || fieldConfig?.type === 'searchable_select') \n          ? 'equals' \n          : 'contains'\n      }\n    }\n    \n    if (newFilter.field && finalCondition !== undefined && newFilter.value !== undefined && newFilter.value !== '' && !requiresDateField) {\n      const filter: FilterRule = {\n        id: newFilter.id!,\n        field: newFilter.field,\n        condition: finalCondition,\n        value: newFilter.value,\n        label: newFilter.label!,\n        dateField: newFilter.dateField //    \n      }\n      onFiltersChange([...activeFilters, filter])\n      setNewFilter({})\n      setIsFilterOpen(false)\n    }\n  }\n\n  const handleRemoveFilter = (filterId: string) => {\n    onFiltersChange(activeFilters.filter(f => f.id !== filterId))\n  }\n\n  const handleClearAllFilters = () => {\n    onFiltersChange([])\n    setIsFilterOpen(false)\n  }\n\n  const handleSortFieldChange = (field: string) => {\n    setTempSort(prev => ({ ...prev, field }))\n  }\n\n  const handleSortDirectionChange = (direction: 'asc' | 'desc') => {\n    setTempSort(prev => ({ ...prev, direction }))\n  }\n\n  const handleApplySort = () => {\n    if (tempSort.field && tempSort.direction) {\n      const fieldConfig = SORT_FIELDS.find(f => f.value === tempSort.field)\n      if (fieldConfig) {\n        onSortChange({\n          field: tempSort.field,\n          direction: tempSort.direction,\n          label: fieldConfig.label\n        })\n      }\n    }\n    setIsSortOpen(false)\n    setTempSort({})\n  }\n\n  const handleClearSort = () => {\n    onSortChange(null)\n    setTempSort({})\n    setIsSortOpen(false)\n  }\n\n  const getConditionOptions = (fieldType: string) => {\n    switch (fieldType) {\n      case 'text':\n      case 'searchable_select':\n        return TEXT_CONDITIONS\n      case 'number':\n        return NUMBER_CONDITIONS\n      case 'date_range':\n      case 'date_month':\n        return DATE_CONDITIONS\n      case 'select':\n      case 'select_with_empty':\n        return SELECT_CONDITIONS\n      default:\n        return TEXT_CONDITIONS\n    }\n  }\n\n  const renderValueInput = () => {\n    const fieldConfig = FILTER_FIELDS.find(f => f.key === newFilter.field)\n    if (!fieldConfig) return null\n\n    switch (fieldConfig.type) {\n      case 'text':\n        return (\n          <Input\n            placeholder=\" \"\n            value={String(newFilter.value || '')}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n      \n      case 'number':\n        return (\n          <Input\n            type=\"number\"\n            placeholder=\" \"\n            value={String(newFilter.value || '')}\n            onChange={(e) => setNewFilter(prev => ({ ...prev, value: e.target.value }))}\n            className=\"w-full business-radius-input border border-gray-300 bg-white text-gray-700 card-description h-auto\"\n            style={{padding: '2px 10px', fontSize: '10px', fontWeight: '500'}}\n          />\n        )\n\n      case 'searchable_select':\n        {\n          let options: string[] = []\n          let placeholder = \"\"\n          if (fieldConfig.key === 'requester_name') {\n            options = availableEmployees\n            placeholder = \"\"\n          } else if (fieldConfig.key === 'vendor_name') {\n            options = availableVendors\n            placeholder = \"\"\n          } else if (fieldConfig.key === 'contact_name') {\n            options = availableContacts\n            placeholder = \"\"\n          }\n\n          //   \n          const filteredOptions = options.filter(option =>\n            option.toLowerCase().includes(searchValue.toLowerCase())\n          )\n\n          return (\n            <Popover onOpenChange={(open) => {\n              if (!open) {\n                setSearchValue('')\n              }\n            }}>\n              <PopoverTrigger asChild>\n                <Button\n                  variant=\"outline\"\n                  role=\"combobox\"\n                  className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between [&>svg]:hidden\"\n                >\n                  <span className=\"truncate text-left\" style={{fontSize: '12px', fontWeight: '500'}}>\n                    {String(newFilter.value || placeholder)}\n                  </span>\n                  <Search className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n                </Button>\n              </PopoverTrigger>\n              <PopoverContent className=\"w-[200px] p-1 border-0 shadow-lg\" align=\"start\">\n                <div className=\"space-y-1\">\n                  {/*    */}\n                  <Input\n                    placeholder={`${placeholder} ...`}\n                    className=\"h-auto border-0 focus:ring-0 focus:outline-none card-description placeholder:card-description\"\n                    style={{padding: '2px 10px'}}\n                    value={searchValue}\n                    onChange={(e) => setSearchValue(e.target.value)}\n                    autoFocus\n                  />\n\n                  {/*   - Command   div  */}\n                  <div className=\"max-h-[200px] overflow-y-auto\">\n                    {filteredOptions.length === 0 ? (\n                      <div className=\"p-2 text-sm text-gray-500\">\n                        {searchValue ? '  ' : `${placeholder}   `}\n                      </div>\n                    ) : (\n                      filteredOptions.map(option => (\n                        <Button\n                          key={option}\n                          variant=\"ghost\"\n                          onClick={() => {\n                            setNewFilter(prev => ({ ...prev, value: option }))\n                            setSearchValue('')\n                          }}\n                          className=\"w-full justify-start p-2 h-auto hover:bg-gray-100 text-left\"\n                        >\n                          <Check\n                            className={`mr-2 h-3 w-3 ${\n                              newFilter.value === option ? \"opacity-100\" : \"opacity-0\"\n                            }`}\n                          />\n                          <span className=\"card-description\">{option}</span>\n                        </Button>\n                      ))\n                    )}\n                  </div>\n                </div>\n              </PopoverContent>\n            </Popover>\n          )\n        }\n\n      case 'select':\n        return (\n          <Select value={String(newFilter.value || '')} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n            <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n              <SelectValue placeholder=\"\" />\n            </SelectTrigger>\n            <SelectContent>\n              {fieldConfig.options?.map(option => (\n                <SelectItem key={option} value={option}>\n                  <span className=\"card-description\">{option}</span>\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        )\n\n      case 'select_with_empty':\n        {\n          const scheduleOptions = ['', ...availablePaymentSchedules]\n          return (\n            <Select value={String(newFilter.value || '')} onValueChange={(value) => setNewFilter(prev => ({ ...prev, value }))}>\n              <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n                <SelectValue placeholder=\"\" />\n              </SelectTrigger>\n              <SelectContent>\n                {scheduleOptions.map(option => (\n                  <SelectItem key={option} value={option}>\n                    <span className=\"card-description\">{option}</span>\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          )\n        }\n\n      case 'date_range':\n        return (\n          <Popover open={datePickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value && typeof newFilter.value === 'string') {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempDateRange({\n                    from: new Date(start),\n                    to: new Date(end)\n                  });\n                } else {\n                  setTempDateRange({\n                    from: new Date(newFilter.value),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempDateRange({});\n              }\n            }\n            setDatePickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5 min-h-[32px]\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value && typeof newFilter.value === 'string' ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        return `${format(new Date(start), 'yy/MM/dd')}\\n~ ${format(new Date(end), 'yy/MM/dd')}`;\n                      } else {\n                        return format(new Date(String(newFilter.value)), 'yy/MM/dd');\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-2\">  </div>\n                  <CalendarComponent\n                    mode=\"range\"\n                    selected={tempDateRange as any}\n                    onSelect={(range: any) => {\n                      if (range) {\n                        setTempDateRange(range);\n                      }\n                    }}\n                    numberOfMonths={1}\n                    initialFocus\n                    className=\"compact-calendar\"\n                  />\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempDateRange({});\n                      setDatePickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempDateRange.from) {\n                        if (tempDateRange.to) {\n                          // ~ \n                          const rangeValue = `${format(tempDateRange.from, 'yyyy-MM-dd')}~${format(tempDateRange.to, 'yyyy-MM-dd')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  ( )\n                          setNewFilter(prev => ({ ...prev, value: format(tempDateRange.from!, 'yyyy-MM-dd') }));\n                        }\n                        setDatePickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempDateRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      case 'date_month':\n        return (\n          <Popover open={monthPickerOpen} onOpenChange={(open) => {\n            if (open) {\n              //      \n              if (newFilter.value && typeof newFilter.value === 'string') {\n                if (newFilter.value.includes('~')) {\n                  const [start, end] = newFilter.value.split('~');\n                  setTempMonthRange({\n                    from: new Date(`${start}-01`),\n                    to: new Date(`${end}-01`)\n                  });\n                } else {\n                  setTempMonthRange({\n                    from: new Date(`${newFilter.value}-01`),\n                    to: undefined\n                  });\n                }\n              } else {\n                setTempMonthRange({});\n              }\n            }\n            setMonthPickerOpen(open);\n          }}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 justify-between h-auto\"\n              >\n                <div className=\"flex items-center gap-1.5\">\n                  <Calendar className=\"w-3 h-3 flex-shrink-0\" />\n                  <span className=\"card-description leading-tight whitespace-pre-line\">\n                    {newFilter.value && typeof newFilter.value === 'string' ? (() => {\n                      if (newFilter.value.includes('~')) {\n                        const [start, end] = newFilter.value.split('~');\n                        const [startYear, startMonth] = start.split('-');\n                        const [endYear, endMonth] = end.split('-');\n                        return `${startYear.slice(-2)}/${startMonth}\\n~ ${endYear.slice(-2)}/${endMonth}`;\n                      } else {\n                        const [year, month] = String(newFilter.value).split('-');\n                        return `${year.slice(-2)}/${month}`;\n                      }\n                    })() : ' '}\n                  </span>\n                </div>\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"p-3 pb-0\">\n                  <div className=\"text-xs font-medium text-gray-600 mb-3\"> </div>\n                  \n                  {/*   -  12  */}\n                  <div className=\"flex gap-4\">\n                    <div className=\"flex-1\">\n                      <div className=\"text-xs text-gray-500 mb-2\">  </div>\n                      {/*   */}\n                      <div className=\"mb-3\">\n                        <div className=\"flex items-center justify-between mb-2\">\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear - 1, tempMonthRange.from?.getMonth() || 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                          <span className=\"text-sm font-medium text-gray-700\">\n                            {tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear()}\n                          </span>\n                          <Button\n                            onClick={() => {\n                              const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                              const newDate = new Date(currentYear + 1, tempMonthRange.from ? tempMonthRange.from.getMonth() : 0, 1);\n                              setTempMonthRange(prev => ({ ...prev, from: newDate }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                          >\n                            \n                          </Button>\n                        </div>\n                      </div>\n                      \n                      {/* 12  */}\n                      <div className=\"grid grid-cols-3 gap-2\">\n                        {Array.from({ length: 12 }, (_, i) => {\n                          const currentYear = tempMonthRange.from ? tempMonthRange.from.getFullYear() : new Date().getFullYear();\n                          const monthDate = new Date(currentYear, i, 1);\n                          const isSelected = tempMonthRange.from && \n                            tempMonthRange.from.getFullYear() === currentYear && \n                            tempMonthRange.from.getMonth() === i;\n                          \n                          return (\n                            <Button\n                              key={i}\n                              onClick={() => {\n                                setTempMonthRange(prev => ({ ...prev, from: monthDate }));\n                              }}\n                              variant=\"outline\"\n                              className={`button-base text-xs h-8 ${\n                                isSelected \n                                  ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                  : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                              }`}\n                            >\n                              {i + 1}\n                            </Button>\n                          );\n                        })}\n                      </div>\n                    </div>\n                    \n                    {tempMonthRange.from && (\n                      <div className=\"flex-1\">\n                        <div className=\"text-xs text-gray-500 mb-2\">   ()</div>\n                        {/*     */}\n                        <div className=\"mb-3\">\n                          <div className=\"flex items-center justify-between mb-2\">\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from!.getFullYear();\n                                const newDate = new Date(currentYear - 1, tempMonthRange.to?.getMonth() || 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                            <span className=\"text-sm font-medium text-gray-700\">\n                              {tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from!.getFullYear()}\n                            </span>\n                            <Button\n                              onClick={() => {\n                                const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from!.getFullYear();\n                                const newDate = new Date(currentYear + 1, tempMonthRange.to?.getMonth() || 11, 1);\n                                setTempMonthRange(prev => ({ ...prev, to: newDate }));\n                              }}\n                              variant=\"outline\"\n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50\"\n                            >\n                              \n                            </Button>\n                          </div>\n                        </div>\n                        \n                        {/*   12  */}\n                        <div className=\"grid grid-cols-3 gap-2\">\n                          {Array.from({ length: 12 }, (_, i) => {\n                            const currentYear = tempMonthRange.to ? tempMonthRange.to.getFullYear() : tempMonthRange.from!.getFullYear();\n                            const monthDate = new Date(currentYear, i, 1);\n                            const isSelected = tempMonthRange.to && \n                              tempMonthRange.to.getFullYear() === currentYear && \n                              tempMonthRange.to.getMonth() === i;\n                            const isDisabled = tempMonthRange.from ? monthDate < tempMonthRange.from : false;\n                            \n                            return (\n                              <Button\n                                key={i}\n                                onClick={() => {\n                                  if (!isDisabled) {\n                                    setTempMonthRange(prev => ({ ...prev, to: monthDate }));\n                                  }\n                                }}\n                                variant=\"outline\"\n                                disabled={isDisabled}\n                                className={`button-base text-xs h-8 ${\n                                  isSelected \n                                    ? 'bg-blue-500 text-white border-blue-500 hover:bg-blue-600' \n                                    : isDisabled\n                                    ? 'border-gray-200 bg-gray-100 text-gray-400 cursor-not-allowed'\n                                    : 'border-gray-300 bg-white text-gray-700 hover:bg-gray-50'\n                                }`}\n                              >\n                                {i + 1}\n                              </Button>\n                            );\n                          })}\n                        </div>\n                        \n                        <div className=\"mt-3\">\n                          <Button\n                            onClick={() => {\n                              setTempMonthRange(prev => ({ ...prev, to: undefined }));\n                            }}\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"button-base border border-gray-300 bg-white text-gray-600 hover:bg-gray-50 text-xs\"\n                          >\n                              \n                          </Button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"flex gap-2 p-3 pt-0\">\n                  <Button\n                    onClick={() => {\n                      setTempMonthRange({});\n                      setMonthPickerOpen(false);\n                    }}\n                    variant=\"outline\"\n                    className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                  >\n                    \n                  </Button>\n                  <Button\n                    onClick={() => {\n                      if (tempMonthRange.from) {\n                        if (tempMonthRange.to) {\n                          //  \n                          const rangeValue = `${format(tempMonthRange.from, 'yyyy-MM')}~${format(tempMonthRange.to, 'yyyy-MM')}`;\n                          setNewFilter(prev => ({ ...prev, value: rangeValue }));\n                        } else {\n                          //  \n                          setNewFilter(prev => ({ ...prev, value: format(tempMonthRange.from!, 'yyyy-MM') }));\n                        }\n                        setMonthPickerOpen(false);\n                      }\n                    }}\n                    disabled={!tempMonthRange.from}\n                    className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                  >\n                    \n                  </Button>\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n        )\n\n      default:\n        return null\n    }\n  }\n\n  return (\n    <div className=\"w-full\">\n      {/*   */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2 flex-1\">\n          {/*   */}\n          <Popover open={isFilterOpen} onOpenChange={setIsFilterOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Sliders className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {activeFilters.length > 0 && (\n                  <span className=\"ml-1 badge-stats bg-blue-50 text-blue-700\">\n                    {activeFilters.length}\n                  </span>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-64 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <div className=\"flex items-center justify-between\">\n                  <h4 className=\"card-title\"></h4>\n                  {activeFilters.length > 0 && (\n                    <Button\n                      variant=\"ghost\"\n                      onClick={handleClearAllFilters}\n                      className=\"button-base text-red-600 hover:text-red-700 hover:bg-red-50\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  )}\n                </div>\n\n                {/*    */}\n                {activeFilters.length > 0 && (\n                  <div className=\"space-y-2\">\n                    {activeFilters.map(filter => (\n                      <div key={filter.id} className=\"flex items-center justify-between p-2 bg-gray-50 business-radius\">\n                        <span className=\"card-description\">\n                          {filter.label}\n                          {filter.dateField && (\n                            <span className=\"text-blue-600\">\n                              ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                            </span>\n                          )}\n                          : {String(filter.value)}\n                        </span>\n                        <Button\n                          variant=\"ghost\"\n                          onClick={() => handleRemoveFilter(filter.id)}\n                          className=\"button-base h-6 w-6 p-0 hover:bg-red-50\"\n                        >\n                          <X className=\"w-3 h-3\" />\n                        </Button>\n                      </div>\n                    ))}\n                    <div className=\"border-t border-gray-200 my-2\" />\n                  </div>\n                )}\n\n                {/*    */}\n                <div className=\"space-y-2\">\n                  <Select onValueChange={handleAddFilter}>\n                    <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center\">\n                      <SelectValue placeholder=\"+  \" />\n                    </SelectTrigger>\n                    <SelectContent \n                      className=\"w-64 max-h-80 overflow-y-auto\"\n                      style={{\n                        scrollbarWidth: 'auto',\n                        scrollbarColor: '#9ca3af #f3f4f6'\n                      }}\n                    >\n                      {Object.entries(\n                        FILTER_FIELDS.reduce((acc, field) => {\n                          if (!acc[field.category]) acc[field.category] = []\n                          acc[field.category].push(field)\n                          return acc\n                        }, {} as Record<string, typeof FILTER_FIELDS>)\n                      ).map(([category, fields]) => (\n                        <div key={category}>\n                          <div className=\"px-2 py-1 card-description uppercase\">\n                            {category}\n                          </div>\n                          {fields.map(field => (\n                            <SelectItem key={field.key} value={field.key}>\n                              <div className=\"flex items-center gap-2\">\n                                <field.icon className=\"w-4 h-4\" />\n                                <span className=\"card-description\">{field.label}</span>\n                              </div>\n                            </SelectItem>\n                          ))}\n                        </div>\n                      ))}\n                    </SelectContent>\n                  </Select>\n\n                  {/*   UI */}\n                  {newFilter.field && (\n                    <div className=\"space-y-2 p-3 border business-radius bg-white\">\n                      <div className=\"flex items-center gap-2\">\n                        <span className=\"card-title\">{newFilter.label} </span>\n                      </div>\n                      \n                      {/*    */}\n                      {(newFilter.field === 'date_range' || newFilter.field === 'date_month') ? (\n                        <div className=\"grid grid-cols-2 gap-2\">\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            <Select \n                              value={newFilter.dateField || ''} \n                              onValueChange={(value) => setNewFilter(prev => ({ ...prev, dateField: value }))}\n                            >\n                              <SelectTrigger className=\"w-full button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden text-center justify-center\">\n                                <SelectValue placeholder=\" \" className=\"text-center\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                {DATE_FIELDS.map(dateField => (\n                                  <SelectItem key={dateField.value} value={dateField.value}>\n                                    <span className=\"card-description\">{dateField.label}</span>\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                          </div>\n\n                          {/*    */}\n                          <div className=\"flex items-start\">\n                            {renderValueInput()}\n                          </div>\n                        </div>\n                      ) : (\n                        /*    -       */\n                        <div>\n                          {renderValueInput()}\n                        </div>\n                      )}\n\n                      <div className=\"flex gap-2\">\n                        <Button\n                          onClick={handleApplyFilter}\n                          disabled={\n                            !newFilter.field || \n                            newFilter.value === '' ||\n                            ((newFilter.field === 'date_range' || newFilter.field === 'date_month') && !newFilter.dateField)\n                          }\n                          className=\"button-base bg-blue-500 text-white hover:bg-blue-600 flex-1\"\n                        >\n                          \n                        </Button>\n                        <Button\n                          variant=\"outline\"\n                          onClick={() => setNewFilter({})}\n                          className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 flex-1\"\n                        >\n                          \n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <Popover open={isSortOpen} onOpenChange={setIsSortOpen}>\n            <PopoverTrigger asChild>\n              <Button \n                variant=\"outline\" \n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <ArrowUpDown className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n                {sortConfig && (\n                  <span className=\"ml-1 card-description\">\n                    ({sortConfig.direction === 'asc' ? '' : ''})\n                  </span>\n                )}\n              </Button>\n            </PopoverTrigger>\n            <PopoverContent className=\"w-56 p-3\" align=\"start\">\n              <div className=\"space-y-3\">\n                <h4 className=\"card-title\"> </h4>\n                \n                <div className=\"space-y-2\">\n                  {/*    */}\n                  <div>\n                    <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                    <Select \n                      value={tempSort.field || ''} \n                      onValueChange={handleSortFieldChange}\n                    >\n                      <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                        <SelectValue placeholder=\"\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {SORT_FIELDS.map(field => (\n                          <SelectItem key={field.value} value={field.value}>\n                            <span className=\"card-description\">{field.label}</span>\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  {/*    */}\n                  {tempSort.field && (\n                    <div>\n                      <label className=\"text-xs text-gray-500 mb-1 block\"> </label>\n                      <Select \n                        value={tempSort.direction || ''} \n                        onValueChange={handleSortDirectionChange}\n                      >\n                        <SelectTrigger className=\"button-base business-radius-button border border-gray-300 bg-white text-gray-700 [&>svg]:hidden\">\n                          <SelectValue placeholder=\"\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"asc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                          <SelectItem value=\"desc\">\n                            <span className=\"card-description\"> </span>\n                          </SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  )}\n\n                  {/* /  */}\n                  <div className=\"flex gap-2 pt-2\">\n                    <Button \n                      onClick={handleApplySort}\n                      disabled={!tempSort.field || !tempSort.direction}\n                      className=\"button-base bg-blue-500 hover:bg-blue-600 text-white flex-1\"\n                    >\n                      \n                    </Button>\n                    <Button \n                      onClick={handleClearSort}\n                      className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n                    >\n                      \n                    </Button>\n                  </div>\n                </div>\n\n                {sortConfig && (\n                  <div className=\"border-t pt-2\">\n                    <Button\n                      variant=\"outline\"\n                      onClick={() => onSortChange(null)}\n                      className=\"button-base w-full border border-gray-300 text-gray-700\"\n                    >\n                      <span className=\"button-text\"> </span>\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </PopoverContent>\n          </Popover>\n\n          {/*   */}\n          <div className=\"flex items-center gap-2\">\n            {!isSearchExpanded ? (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsSearchExpanded(true)}\n                className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50\"\n              >\n                <Search className=\"w-4 h-4 mr-1\" />\n                <span className=\"button-text\"></span>\n              </Button>\n            ) : (\n              <div className=\"flex items-center gap-2\">\n                <Input\n                  ref={searchInputRef}\n                  placeholder=\" ...\"\n                  value={searchTerm}\n                  onChange={(e) => onSearchChange(e.target.value)}\n                  className=\"w-64 business-radius-input button-base border border-gray-300 bg-white text-gray-700\"\n                />\n                <Button\n                  variant=\"ghost\"\n                  onClick={() => {\n                    setIsSearchExpanded(false)\n                    onSearchChange('')\n                  }}\n                  className=\"button-base h-8 w-8 p-0\"\n                >\n                  <X className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n\n          {/*    */}\n          <Button\n            variant=\"outline\"\n            onClick={() => {\n              onSearchChange('')\n              onFiltersChange([])\n              onSortChange({\n                field: 'created_at',\n                direction: 'desc',\n                label: ''\n              })\n              setIsSearchExpanded(false)\n            }}\n            className=\"button-base border border-gray-300 bg-white text-blue-600 hover:bg-blue-50 hover:border-blue-300\"\n          >\n             <span className=\"button-text text-blue-600\"></span>\n          </Button>\n\n          {/*    -       */}\n      {activeFilters.length > 0 && (\n            <>\n              <div className=\"h-6 w-px bg-gray-300 mx-3\" />\n              <div className=\"flex items-center gap-2 flex-nowrap overflow-x-auto\">\n          {activeFilters.map(filter => (\n            <span\n              key={filter.id}\n                  className=\"badge-stats flex items-center gap-1 bg-blue-50 text-blue-700 border border-blue-200 whitespace-nowrap\"\n            >\n              {filter.label}\n              {filter.dateField && (\n                <span className=\"text-blue-600\">\n                  ({DATE_FIELDS.find(df => df.value === filter.dateField)?.label})\n                </span>\n              )}\n                  : {String(filter.value)}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => handleRemoveFilter(filter.id)}\n                className=\"h-4 w-4 p-0 hover:bg-blue-100 ml-1\"\n              >\n                <X className=\"w-3 h-3\" />\n              </Button>\n            </span>\n          ))}\n        </div>\n            </>\n      )}\n        </div>\n\n        {/*   -     */}\n        <div className=\"flex items-center gap-2\">\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}","/**\n *     \n *       \n */\n\nexport type PurchaseRole = \n  | 'app_admin' \n  | 'ceo' \n  | 'middle_manager' \n  | 'final_approver' \n  | 'raw_material_manager' \n  | 'consumable_manager' \n  | 'purchase_manager' \n  | 'requester' \n  | 'lead buyer' \n  | 'buyer' \n  | 'hr'\n  | 'accounting';\n\n//   \nexport const MANAGER_ROLES: PurchaseRole[] = [\n  'purchase_manager',\n  'app_admin',\n  'raw_material_manager',\n  'consumable_manager'\n];\n\n//   \nexport const APPROVER_ROLES: PurchaseRole[] = [\n  'final_approver',\n  'app_admin',\n  'ceo',\n  'middle_manager',\n  'hr'\n];\n\n//   \nexport const HIDDEN_EMPLOYEES = [''];\n\n/**\n *    \n */\nexport function hasManagerRole(roles: string[]): boolean {\n  return MANAGER_ROLES.some(role => roles.includes(role));\n}\n\n/**\n *    \n */\nexport function hasApproverRole(roles: string[]): boolean {\n  return APPROVER_ROLES.some(role => roles.includes(role));\n}\n\n/**\n *    (  )\n * 1:   ( )\n * 2:   (   )\n * 3:   (app_admin, ceo -  )\n */\nexport function getRoleCase(roles: string[]): number {\n  if (!roles || roles.length === 0) return 1;\n  \n  // app_admin ceo   (case 3)\n  if (roles.includes('app_admin') || roles.includes('ceo')) return 3;\n  \n  //     (case 2)\n  if (roles.includes('consumable_manager') || \n      roles.includes('raw_material_manager') ||\n      roles.includes('purchase_manager') ||\n      roles.includes('lead buyer')) return 2;  // lead buyer \n  \n  // middle_manager  \n  if (roles.includes('middle_manager')) return 2;\n  \n  return 1;\n}\n\n/**\n *    \n */\nexport function filterByEmployeeVisibility<T extends { requester_name: string }>(\n  items: T[],\n  userRoles: string[]\n): T[] {\n  if (hasManagerRole(userRoles)) {\n    return items; //    \n  }\n  return items.filter(item => !HIDDEN_EMPLOYEES.includes(item.requester_name));\n}","\nimport { useState, lazy, Suspense, useEffect, useCallback, useMemo, useTransition, useRef } from \"react\";\nimport { useNavigate, useLocation } from \"react-router-dom\";\nimport { usePurchaseMemory } from \"@/hooks/usePurchaseMemory\";\nimport { useColumnSettings } from \"@/hooks/useColumnSettings\";\nimport ColumnSettingsDropdown from \"@/components/purchase/ColumnSettingsDropdown\";\nimport FastPurchaseTable from \"@/components/purchase/FastPurchaseTable\";\nimport FilterToolbar, { FilterRule, SortRule } from \"@/components/purchase/FilterToolbar\";\nimport { updatePurchaseInMemory, loadAllPurchaseData } from \"@/services/purchaseDataLoader\";\nimport { markPurchaseAsPaymentCompleted, markPurchaseAsReceived, isCacheValid, purchaseMemoryCache } from '@/stores/purchaseMemoryStore';\nimport DeliveryDateWarningModal, { useDeliveryWarningCount } from \"@/components/purchase/DeliveryDateWarningModal\";\n\nimport { Package, Info, AlertTriangle } from \"lucide-react\";\nimport { downloadPurchaseOrderExcel } from '@/utils/excelDownload';\nimport { dateToISOString } from '@/utils/helpers';\n\n// Lazy load modal for better performance\nconst PurchaseItemsModal = lazy(() => import(\"@/components/purchase/PurchaseItemsModal\"));\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { Purchase } from \"@/types/purchase\";\nimport { hasManagerRole, getRoleCase, filterByEmployeeVisibility } from \"@/utils/roleHelper\";\nimport { filterByEmployee, sortPurchases, calculateTabCounts } from \"@/utils/purchaseFilters\";\nimport { logger } from \"@/lib/logger\";\n\ninterface PurchaseListMainProps {\n  showEmailButton?: boolean;\n}\n\n//   () \nconst NAV_TABS: { key: string; label: string }[] = [\n  { key: 'pending', label: '' },\n  { key: 'purchase', label: ' ' },\n  { key: 'receipt', label: ' ' },\n  { key: 'done', label: ' ' },\n];\n\n//    \nexport default function PurchaseListMain({ showEmailButton = true }: PurchaseListMainProps) {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const supabase = createClient();\n  const [selectedPurchase, setSelectedPurchase] = useState<Purchase | null>(null);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [isWarningModalOpen, setIsWarningModalOpen] = useState(false);\n  const hasShownWarningRef = useRef(false);\n  \n  //  :  / \n  useEffect(() => {\n    logger.info(' [PurchaseListMain]  , hasShownWarning ');\n    hasShownWarningRef.current = false;\n    return () => {\n      logger.info(' [PurchaseListMain]  ');\n    };\n  }, []);\n  \n  //    \n  const [activeFilters, setActiveFilters] = useState<FilterRule[]>([]);\n  const [sortConfig, setSortConfig] = useState<SortRule | null>({\n    field: 'created_at',\n    direction: 'desc',\n    label: ''\n  });\n  const [searchTerm, setSearchTerm] = useState('');\n  const [availableEmployees, setAvailableEmployees] = useState<string[]>([]);\n  const [availableVendors, setAvailableVendors] = useState<string[]>([]);\n  const [availableContacts, setAvailableContacts] = useState<string[]>([]);\n  const [availablePaymentSchedules, setAvailablePaymentSchedules] = useState<string[]>([]);\n  \n  //     \n  const {\n    allPurchases: purchases,\n    loading,\n    currentUser,\n    getFilteredPurchases,\n    tabCounts\n  } = usePurchaseMemory();\n  \n  //   \n  const { columnVisibility, isLoading: isColumnLoading, applyColumnSettings, resetToDefault } = useColumnSettings();\n  \n  //    \n  const hasHiddenColumns = useMemo(() => {\n    if (!columnVisibility) return false;\n    return Object.values(columnVisibility).some(visible => !visible);\n  }, [columnVisibility]);\n  \n  \n  const currentUserRoles = useMemo(() => {\n    if (Array.isArray(currentUser?.purchase_role)) {\n      return currentUser.purchase_role.map((r: string) => r.trim())\n    }\n    if (typeof currentUser?.purchase_role === 'string') {\n      return currentUser.purchase_role.split(',').map((r: string) => r.trim())\n    }\n    return []\n  }, [currentUser?.purchase_role])\n  \n  const currentUserName = currentUser?.name || null;\n  \n  //     \n  const [refreshTrigger, setRefreshTrigger] = useState(0)\n  \n  //    state  0   \n  const [cachedTabCounts, setCachedTabCounts] = useState({ \n    pending: 0, \n    purchase: 0, \n    receipt: 0, \n    done: 0 \n  })\n  \n  //     \n  const loadPurchases = useCallback(async () => {\n    logger.debug(' [loadPurchases]   ')\n    setRefreshTrigger(prev => prev + 1)\n  }, []);\n  \n  // Optimistic Update:    \n  const updatePurchaseOptimistic = useCallback((purchaseId: number, updater: (prev: Purchase) => Purchase) => {\n    updatePurchaseInMemory(purchaseId, updater)\n  }, []);\n  \n  const isAdmin = currentUserRoles?.includes('app_admin');\n  \n  // roleCase  (   ) -  \n  const roleCase = useMemo(() => getRoleCase(currentUserRoles), [currentUserRoles]);\n\n  //      -    \n  const defaultEmployeeByTab = useMemo(() => {\n    // currentUserName   \n    if (!currentUserName) {\n      logger.warn('[defaultEmployeeByTab] currentUserName ', {\n        currentUser,\n        currentUserRoles\n      });\n      return { pending: 'all', purchase: 'all', receipt: 'all', done: 'all' };\n    }\n    \n    //   \n    const hasHrRole = currentUserRoles.includes('hr');\n    const hasPurchaseManagerRole = currentUserRoles.includes('purchase_manager');\n    const hasManagerRole = currentUserRoles.some((role: string) => \n      ['app_admin', 'ceo', 'lead buyer', 'finance_team', 'raw_material_manager', 'consumable_manager', 'purchase_manager', 'hr'].includes(role)\n    );\n    \n    const result = {\n      pending: roleCase === 3 ? 'all' : currentUserName,\n      purchase: hasManagerRole ? 'all' : (roleCase === 3 ? 'all' : currentUserName),\n      receipt: (hasHrRole || hasPurchaseManagerRole) ? 'all' : (roleCase === 3 ? 'all' : currentUserName),\n      done: 'all' //       \n    };\n    \n    return result;\n  }, [currentUserName, roleCase, currentUserRoles]);\n\n  // URL   \n  const getInitialTab = () => {\n    const searchParams = new URLSearchParams(location.search);\n    const tab = searchParams.get('tab');\n    if (tab && ['pending', 'purchase', 'receipt', 'done'].includes(tab)) {\n      return tab;\n    }\n    return 'pending';\n  };\n\n  //    -  \n  const initialTab = getInitialTab();\n  const [activeTab, setActiveTab] = useState(initialTab);\n  // selectedEmployee   \n  const [selectedEmployee, setSelectedEmployee] = useState<string>('all');\n  const [isPending, startTransition] = useTransition();\n\n  //    (  )\n  const visiblePurchases = useMemo(() => {\n    return filterByEmployeeVisibility(purchases, currentUserRoles);\n  }, [purchases, currentUserRoles]);\n\n  //       ( )\n  const deliveryWarningCount = useDeliveryWarningCount(visiblePurchases, currentUserName);\n  \n  //  : F20251226_003       \n  useEffect(() => {\n    if (!loading && visiblePurchases.length > 0) {\n      const targetPurchase = visiblePurchases.find(p => p.purchase_order_number === 'F20251226_003');\n      if (targetPurchase) {\n        const today = new Date();\n        today.setHours(0, 0, 0, 0);\n        \n        const deliveryDate = targetPurchase.delivery_request_date ? new Date(targetPurchase.delivery_request_date) : null;\n        const revisedDate = targetPurchase.revised_delivery_request_date ? new Date(targetPurchase.revised_delivery_request_date) : null;\n        \n        if (deliveryDate) deliveryDate.setHours(0, 0, 0, 0);\n        if (revisedDate) revisedDate.setHours(0, 0, 0, 0);\n        \n        const checks = {\n          check1_isReceived: !(targetPurchase.is_received || targetPurchase.delivery_status === 'completed'),\n          check2_approved: targetPurchase.middle_manager_status === 'approved' && targetPurchase.final_manager_status === 'approved',\n          check3_requesterMatch: !currentUserName || targetPurchase.requester_name === currentUserName,\n          check4_notRevisionRequested: targetPurchase.delivery_revision_requested !== true,\n          check5_dateOverdue: (revisedDate && revisedDate < today) || (deliveryDate && deliveryDate < today && !revisedDate)\n        };\n        \n        const allChecksPass = Object.values(checks).every(v => v === true);\n        \n        logger.info(' [  ] F20251226_003', {\n          ...checks,\n          allChecksPass,\n          deliveryWarningCount,\n          hasShownWarning: hasShownWarningRef.current,\n          deliveryDate: deliveryDate ? dateToISOString(deliveryDate) : undefined,\n          revisedDate: revisedDate ? dateToISOString(revisedDate) : undefined,\n          today: today.toISOString(),\n          deliveryDateOverdue: deliveryDate ? deliveryDate < today : false,\n          revisedDateOverdue: revisedDate ? revisedDate < today : false\n        });\n      }\n    }\n  }, [loading, visiblePurchases, currentUserName, deliveryWarningCount]);\n  \n  //  :    \n  useEffect(() => {\n    if (!loading && visiblePurchases.length > 0) {\n      const targetPurchase = visiblePurchases.find(p => p.purchase_order_number === 'F20251226_003');\n      if (targetPurchase) {\n        logger.info(' [ ] F20251226_003  ', {\n          purchase_order_number: targetPurchase.purchase_order_number,\n          requester_name: targetPurchase.requester_name,\n          currentUserName,\n          nameMatch: targetPurchase.requester_name === currentUserName,\n          is_received: targetPurchase.is_received,\n          delivery_status: targetPurchase.delivery_status,\n          middle_manager_status: targetPurchase.middle_manager_status,\n          final_manager_status: targetPurchase.final_manager_status,\n          delivery_revision_requested: targetPurchase.delivery_revision_requested,\n          delivery_request_date: targetPurchase.delivery_request_date,\n          revised_delivery_request_date: targetPurchase.revised_delivery_request_date,\n          deliveryWarningCount,\n          visiblePurchasesCount: visiblePurchases.length,\n          hasShownWarning: hasShownWarningRef.current,\n          loading\n        });\n      } else {\n        logger.warn(' [ ] F20251226_003  visiblePurchases   ', {\n          visiblePurchasesCount: visiblePurchases.length,\n          purchaseOrderNumbers: visiblePurchases.slice(0, 5).map(p => p.purchase_order_number)\n        });\n      }\n    }\n  }, [loading, visiblePurchases, currentUserName, deliveryWarningCount]);\n  \n  //        ( 1)\n  useEffect(() => {\n    //   \n    if (hasShownWarningRef.current) {\n      logger.debug(' []   ', {\n        hasShownWarning: hasShownWarningRef.current,\n        deliveryWarningCount,\n        loading,\n        visiblePurchasesLength: visiblePurchases.length\n      });\n      return;\n    }\n    \n    logger.debug(' []    ', {\n      loading,\n      deliveryWarningCount,\n      visiblePurchasesLength: visiblePurchases.length,\n      currentUserName,\n      shouldShow: !loading && deliveryWarningCount > 0 && visiblePurchases.length > 0\n    });\n    \n    if (!loading && deliveryWarningCount > 0 && visiblePurchases.length > 0) {\n      const timer = setTimeout(() => {\n        if (!hasShownWarningRef.current) {\n          hasShownWarningRef.current = true;\n          logger.info(' []   ', {\n            deliveryWarningCount,\n            visiblePurchasesLength: visiblePurchases.length\n          });\n          setIsWarningModalOpen(true);\n        }\n      }, 500);\n      return () => clearTimeout(timer);\n    }\n  }, [loading, deliveryWarningCount, visiblePurchases.length, currentUserName]);\n\n\n  //  selectedEmployee  (defaultEmployeeByTab  )\n  useEffect(() => {\n    if (defaultEmployeeByTab && currentUserName !== null) {\n      const initialEmployeeValue = defaultEmployeeByTab[activeTab as keyof typeof defaultEmployeeByTab];\n      if (initialEmployeeValue !== undefined) {\n        setSelectedEmployee(initialEmployeeValue);\n        logger.info('[ selectedEmployee ]', {\n          activeTab,\n          initialEmployeeValue,\n          defaultEmployeeByTab\n        });\n      }\n    }\n  }, []); //    \n\n  // URL       \n  useEffect(() => {\n    const searchParams = new URLSearchParams(location.search);\n    const tab = searchParams.get('tab');\n    if (tab && ['pending', 'purchase', 'receipt', 'done'].includes(tab)) {\n      setActiveTab(tab);\n    }\n  }, [location.search]);\n\n  //            \n  useEffect(() => {\n    const defaultEmp = defaultEmployeeByTab[activeTab as keyof typeof defaultEmployeeByTab];\n    // 'all'   undefined  \n    if (defaultEmp !== undefined) {\n      setSelectedEmployee(defaultEmp);\n    }\n  }, [activeTab, defaultEmployeeByTab]);\n\n  //       \n  useEffect(() => {\n    const checkAndRefreshCache = async () => {\n      //      \n      if (!isCacheValid() || !purchaseMemoryCache.allPurchases) {\n        logger.info(' [PurchaseListMain]   ,   ...', {\n          isCacheValid: isCacheValid(),\n          hasData: !!purchaseMemoryCache.allPurchases,\n          lastFetch: purchaseMemoryCache.lastFetch\n        });\n        \n        try {\n          await loadAllPurchaseData(currentUser?.id);\n          logger.info(' [PurchaseListMain]   ');\n        } catch (error) {\n          logger.error(' [PurchaseListMain]   :', error);\n        }\n      }\n    };\n    \n    checkAndRefreshCache();\n  }, [currentUser?.id, location.key]); //      \n\n  //    \n  useEffect(() => {\n    const loadFilterOptions = async () => {\n      try {\n        //   (employees )\n        const { data: employees } = await supabase\n          .from('employees')\n          .select('name');\n        \n        if (employees) {\n          const employeeNames = [...new Set(employees.map((e: any) => e.name).filter(Boolean))];\n          setAvailableEmployees(employeeNames as string[]);\n        }\n\n        //   (vendors )\n        const { data: vendors } = await supabase\n          .from('vendors')\n          .select('vendor_name');\n        \n        if (vendors) {\n          const vendorNames = [...new Set(vendors.map((v: any) => v.vendor_name).filter(Boolean))];\n          setAvailableVendors(vendorNames as string[]);\n        }\n\n        //   (vendor_contacts )\n        const { data: contacts } = await supabase\n          .from('vendor_contacts')\n          .select('contact_name');\n        \n        if (contacts) {\n          const contactNames = [...new Set(contacts.map((c: any) => c.contact_name).filter(Boolean))];\n          setAvailableContacts(contactNames as string[]);\n        }\n\n        //   (vendors  vendor_payment_schedule)\n        const { data: schedules } = await supabase\n          .from('vendors')\n          .select('vendor_payment_schedule');\n        \n        if (schedules) {\n          const scheduleNames = [...new Set(schedules.map((s: any) => s.vendor_payment_schedule).filter(Boolean))];\n          setAvailablePaymentSchedules(scheduleNames as string[]);\n        }\n      } catch (error) {\n        logger.error('    ', error);\n      }\n    };\n\n    loadFilterOptions();\n  }, [supabase]);\n\n\n  //     -  \n  const getStatusBadge = useCallback((purchase: Purchase) => {\n    if (purchase.is_received) {\n      return <span className=\"badge-stats bg-green-500 text-white\"></span>;\n    } else if (purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'approved') {\n      return <span className=\"badge-stats bg-blue-500 text-white\"></span>;\n    } else if (purchase.middle_manager_status === 'rejected' || purchase.final_manager_status === 'rejected') {\n      return <span className=\"badge-stats bg-red-500 text-white\"></span>;\n    } else {\n      return <span className=\"badge-stats bg-yellow-500 text-white\"></span>;\n    }\n  }, []);\n\n  //    \n  const getReceiptProgress = (purchase: Purchase) => {\n    if (!purchase.purchase_request_items || purchase.purchase_request_items.length === 0) {\n      return { received: 0, total: 0, percentage: 0 };\n    }\n    \n    const total = purchase.purchase_request_items.length;\n    const received = purchase.purchase_request_items.filter((item: any) => \n      item.is_received === true\n    ).length;\n    const percentage = total > 0 ? Math.round((received / total) * 100) : 0;\n    \n    return { received, total, percentage };\n  };\n  \n  //    \n  const getPurchaseProgress = (purchase: Purchase) => {\n    if (!purchase.purchase_request_items || purchase.purchase_request_items.length === 0) {\n      return { completed: 0, total: 0, percentage: 0 };\n    }\n    \n    const total = purchase.purchase_request_items.length;\n    const completed = purchase.purchase_request_items.filter((item: any) => \n      item.is_payment_completed === true\n    ).length;\n    const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n    \n    return { completed, total, percentage };\n  };\n\n  //   \n  const isAdvancePayment = (progress_type?: string) => {\n    return progress_type === '' || progress_type?.trim() === '' || progress_type?.includes('');\n  };\n\n  //     - useCallback \n  const getFieldValue = useCallback((purchase: Purchase, field: string): any => {\n    switch (field) {\n      case 'purchase_order_number':\n        return purchase.purchase_order_number;\n      case 'payment_category':\n        return purchase.payment_category;\n      case 'requester_name':\n        return purchase.requester_name;\n      case 'vendor_name':\n        return purchase.vendor_name;\n      case 'contact_name':\n        // vendor_contacts JOIN  -    \n        return '-'; // vendor_contacts JOIN \n      case 'item_name':\n        return purchase.purchase_request_items?.[0]?.item_name || '';\n      case 'specification':\n        return purchase.purchase_request_items?.[0]?.specification || '';\n      case 'quantity':\n        return purchase.purchase_request_items?.[0]?.quantity || 0;\n      case 'unit_price_value':\n        return purchase.purchase_request_items?.[0]?.unit_price_value || 0;\n      case 'total_amount':\n        return purchase.total_amount;\n      case 'remark':\n        return purchase.purchase_request_items?.[0]?.remark || '';\n      case 'project_vendor':\n        return purchase.project_vendor;\n      case 'project_item':\n        return purchase.project_item;\n      case 'sales_order_number':\n        return purchase.sales_order_number;\n      case 'payment_schedule':\n        // vendor_payment_schedule vendors   - JOIN \n        return '-';\n      case 'is_payment_completed':\n        //    \n        return purchase.is_payment_completed ? '' : '';\n      case 'is_received':\n        //    \n        return purchase.is_received ? '' : '';\n      case 'is_statement_received':\n        return purchase.is_statement_received ? '' : '';\n      case 'is_utk_checked':\n        return purchase.is_utk_checked ? '' : '';\n      case 'request_date':\n        return purchase.request_date;\n      case 'delivery_request_date':\n        return purchase.delivery_request_date;\n      case 'payment_completed_at':\n        return purchase.payment_completed_at;\n      case 'received_at':\n        return purchase.received_at;\n      case 'created_at':\n        return purchase.created_at;\n      case 'statement_received_at':\n        return purchase.purchase_request_items?.[0]?.statement_received_date || null;\n      default:\n        return null;\n    }\n  }, []);\n\n  //     - useCallback \n  const applyFilterCondition = useCallback((fieldValue: any, condition: string, filterValue: any, filterField?: string): boolean => {\n    if (fieldValue === null || fieldValue === undefined) {\n      return condition === 'is_empty';\n    }\n\n    //      (~)\n    if (filterField === 'date_range' && filterValue && typeof filterValue === 'string' && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startDate, endDate] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(startDate);\n      const end = new Date(endDate);\n      \n      //       \n      return fieldDate >= start && fieldDate <= end;\n    }\n\n    //      (~)\n    if (filterField === 'date_month' && filterValue && typeof filterValue === 'string' && filterValue.includes('~')) {\n      if (!fieldValue) return false;\n      \n      const [startMonth, endMonth] = filterValue.split('~');\n      const fieldDate = new Date(fieldValue);\n      const start = new Date(`${startMonth}-01`);\n      const end = new Date(`${endMonth}-01`);\n      \n      //    (    )\n      const endOfMonth = new Date(end.getFullYear(), end.getMonth() + 1, 0, 23, 59, 59);\n      return fieldDate >= start && fieldDate <= endOfMonth;\n    }\n\n    //     ( )\n    if (filterField && (filterField === 'date_month' || filterField.endsWith('_month'))) {\n      if (!filterValue) return true;\n      \n      const fieldDate = new Date(fieldValue);\n      const [filterYear, filterMonth] = filterValue.split('-');\n      \n      return fieldDate.getFullYear() === parseInt(filterYear) && \n             (fieldDate.getMonth() + 1) === parseInt(filterMonth);\n    }\n\n    const fieldStr = String(fieldValue).toLowerCase();\n    const filterStr = String(filterValue).toLowerCase();\n\n    switch (condition) {\n      case 'contains':\n        return fieldStr.includes(filterStr);\n      case 'equals':\n        //      \n        if (filterField === 'date_range' || filterValue.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}/)) {\n          if (!fieldValue) return false;\n          try {\n            const fieldDate = new Date(fieldValue).toISOString().split('T')[0];\n            const filterDate = filterValue.split('T')[0];\n            return fieldDate === filterDate;\n          } catch (error) {\n            logger.error('  :', error);\n            return false;\n          }\n        }\n        return fieldStr === filterStr;\n      case 'starts_with':\n        return fieldStr.startsWith(filterStr);\n      case 'ends_with':\n        return fieldStr.endsWith(filterStr);\n      case 'is_empty':\n        return !fieldValue || fieldStr.trim() === '';\n      case 'is_not_empty':\n        return !!fieldValue && fieldStr.trim() !== '';\n      case 'greater_than':\n        return Number(fieldValue) > Number(filterValue);\n      case 'less_than':\n        return Number(fieldValue) < Number(filterValue);\n      case 'between':\n        //    \n        return true;\n      case 'after':\n        return new Date(fieldValue) > new Date(filterValue);\n      case 'before':\n        return new Date(fieldValue) < new Date(filterValue);\n      case 'not_equals':\n        return fieldStr !== filterStr;\n      default:\n        return true;\n    }\n  }, []);\n\n\n  //   \n  const baseFilteredPurchases = useMemo(() => {\n    const employeeName = selectedEmployee === 'all' || selectedEmployee === '' ? null : selectedEmployee;\n    \n    return getFilteredPurchases({\n      tab: activeTab as any,\n      employeeName,\n      searchTerm,\n      advancedFilters: activeFilters,\n      sortConfig: sortConfig ? { key: sortConfig.field, direction: sortConfig.direction } : undefined\n    });\n  }, [getFilteredPurchases, activeTab, selectedEmployee, searchTerm, activeFilters, sortConfig, purchases]);\n\n  // /    (  : ''  null )\n  const tabFilteredPurchases = useMemo(() => {\n    return baseFilteredPurchases.filter((p: Purchase) => {\n      const templateType = (p as any).po_template_type;\n      return !templateType || templateType === '/' || templateType === '';\n    });\n  }, [baseFilteredPurchases]);\n\n\n  //     \n  useEffect(() => {\n    //      \n    if (purchases && purchases.length > 0) {\n      const newCounts = calculateTabCounts(purchases, currentUser);\n      setCachedTabCounts(newCounts);\n    } else if (purchaseMemoryCache.allPurchases && purchaseMemoryCache.allPurchases.length > 0) {\n      //  state    \n      const newCounts = calculateTabCounts(purchaseMemoryCache.allPurchases, currentUser);\n      setCachedTabCounts(newCounts);\n    }\n  }, [purchases, currentUser]);\n\n  //    (  )\n  const filteredTabCounts = cachedTabCounts;\n\n  //         \n  const filteredTabCountsWithSearch = useMemo(() => {\n    //      \n    if (!searchTerm && activeFilters.length === 0) {\n      return filteredTabCounts;\n    }\n\n    //     \n    const counts = {\n      pending: 0,\n      purchase: 0,\n      receipt: 0,\n      done: 0\n    };\n\n    //       \n    const tabs: Array<keyof typeof counts> = ['pending', 'purchase', 'receipt', 'done'];\n    tabs.forEach(tab => {\n      const filtered = getFilteredPurchases({\n        tab,\n        employeeName: defaultEmployeeByTab[tab] === 'all' ? null : defaultEmployeeByTab[tab],\n        searchTerm,\n        advancedFilters: activeFilters,\n        sortConfig: sortConfig ? { key: sortConfig.field, direction: sortConfig.direction } : undefined\n      });\n      counts[tab] = filtered.length;\n    });\n\n    return counts;\n  }, [searchTerm, activeFilters, filteredTabCounts, getFilteredPurchases, defaultEmployeeByTab, sortConfig]);\n\n  //     \n  const getTabBadgeText = useCallback((tabKey: string) => {\n    //       \n    if (searchTerm || activeFilters.length > 0) {\n      return filteredTabCountsWithSearch[tabKey as keyof typeof filteredTabCountsWithSearch].toString();\n    }\n    \n    //      (/  )\n    if (tabKey === 'done') {\n      return \"\";\n    }\n    \n    //     \n    return filteredTabCounts[tabKey as keyof typeof filteredTabCounts].toString();\n  }, [searchTerm, activeFilters.length, filteredTabCountsWithSearch, filteredTabCounts]);\n\n\n  //      \n  const monthlyFilterSummary = useMemo(() => {\n    //     \n    const monthFilters = activeFilters.filter(filter => \n      filter.field === 'date_month' || \n      (filter.field === 'date_range' && filter.dateField && filter.dateField.includes('_month'))\n    );\n    \n    if (monthFilters.length === 0) return null;\n    \n    //      \n    const totalFilteredAmount = tabFilteredPurchases.reduce((sum, purchase) => {\n      if (purchase.purchase_request_items?.length) {\n        const itemsTotal = purchase.purchase_request_items.reduce((itemSum: number, item: any) => {\n          //     \n          const baseAmount = item.amount_value || 0;\n          const taxAmount = (purchase.payment_category === '' && item.tax_amount_value) ? item.tax_amount_value : 0;\n          return itemSum + baseAmount + taxAmount;\n        }, 0);\n        return sum + itemsTotal;\n      }\n      // total_amount  ,    \n      const baseAmount = purchase.total_amount || 0;\n      const taxAmount = (purchase.payment_category === '') ? baseAmount * 0.1 : 0;\n      return sum + baseAmount + taxAmount;\n    }, 0);\n    \n    const monthFilter = monthFilters[0];\n    const filterValue = monthFilter.value;\n    \n    //       \n    if (filterValue && typeof filterValue === 'string' && filterValue.includes('~')) {\n      //   (: \"2024-04~2024-09\")\n      const [startMonth, endMonth] = filterValue.split('~');\n      const startDate = new Date(`${startMonth}-01`);\n      const endDate = new Date(`${endMonth}-01`);\n      \n      const monthlyTotals = [];\n      let totalSum = 0;\n      \n      //   \n      const currentDate = new Date(startDate);\n      while (currentDate <= endDate) {\n        const year = currentDate.getFullYear();\n        const month = currentDate.getMonth() + 1;\n        const monthStr = `${year}-${month.toString().padStart(2, '0')}`;\n        \n        //    \n        const monthData = tabFilteredPurchases.filter(purchase => {\n          const purchaseDate = new Date(purchase.request_date);\n          return purchaseDate.getFullYear() === year && \n                 (purchaseDate.getMonth() + 1) === month;\n        });\n        \n        //    \n        const monthTotal = monthData.reduce((sum, purchase) => {\n          // items amount_value   total_amount \n          if (purchase.purchase_request_items?.length) {\n            const itemsTotal = purchase.purchase_request_items.reduce((itemSum: number, item: any) => {\n              //     \n              const baseAmount = item.amount_value || 0;\n              const taxAmount = (purchase.payment_category === '' && item.tax_amount_value) ? item.tax_amount_value : 0;\n              return itemSum + baseAmount + taxAmount;\n            }, 0);\n            return sum + itemsTotal;\n          }\n          // total_amount  ,    \n          const baseAmount = purchase.total_amount || 0;\n          const taxAmount = (purchase.payment_category === '') ? baseAmount * 0.1 : 0;\n          return sum + baseAmount + taxAmount;\n        }, 0);\n        \n        monthlyTotals.push({\n          year,\n          month,\n          monthStr,\n          total: monthTotal,\n          count: monthData.length\n        });\n        \n        totalSum += monthTotal;\n        \n        //   \n        currentDate.setMonth(currentDate.getMonth() + 1);\n      }\n      \n      return {\n        type: 'range',\n        months: monthlyTotals,\n        grandTotal: totalSum,\n        totalFilteredAmount: totalFilteredAmount //     \n      };\n    } else {\n      //    (: \"2024-10\")\n      const [year, month] = (typeof filterValue === 'string' ? filterValue : '').split('-');\n      const monthData = tabFilteredPurchases.filter(purchase => {\n        const purchaseDate = new Date(purchase.request_date);\n        return purchaseDate.getFullYear() === parseInt(year) && \n               (purchaseDate.getMonth() + 1) === parseInt(month);\n      });\n      \n      const monthTotal = monthData.reduce((sum, purchase) => {\n        // items amount_value   total_amount \n        if (purchase.purchase_request_items?.length) {\n          const itemsTotal = purchase.purchase_request_items.reduce((itemSum: number, item: any) => {\n            //     \n            const baseAmount = item.amount_value || 0;\n            const taxAmount = (purchase.payment_category === '' && item.tax_amount_value) ? item.tax_amount_value : 0;\n            return itemSum + baseAmount + taxAmount;\n          }, 0);\n          return sum + itemsTotal;\n        }\n        // total_amount  ,    \n        const baseAmount = purchase.total_amount || 0;\n        const taxAmount = (purchase.payment_category === '') ? baseAmount * 0.1 : 0;\n        return sum + baseAmount + taxAmount;\n      }, 0);\n      \n      return {\n        type: 'single',\n        year: parseInt(year),\n        month: parseInt(month),\n        total: monthTotal,\n        count: monthData.length,\n        totalFilteredAmount: totalFilteredAmount //     \n      };\n    }\n  }, [activeFilters, tabFilteredPurchases]);\n\n\n  //   -   \n  const handleExcelDownload = async (purchase: Purchase) => {\n    try {\n      await downloadPurchaseOrderExcel(\n        {\n          id: purchase.id,\n          purchase_order_number: purchase.purchase_order_number,\n          vendor_name: purchase.vendor_name || '',\n          vendor_id: purchase.vendor_id?.toString(),\n          contact_id: purchase.contact_id?.toString()\n        },\n        currentUserRoles,\n        () => {\n          //  :  \n          loadPurchases();\n        }\n      );\n    } catch (error) {\n      logger.error('Excel    ', error);\n    }\n  };\n\n  //   -    \n  const handleReceiptComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_received: true,\n            received_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_received: true,\n            delivery_status: 'received'\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      //      (UI  )\n      const memoryUpdated = markPurchaseAsReceived(purchaseId);\n      if (!memoryUpdated) {\n        logger.warn('[PurchaseListMain]     ', { purchaseId });\n      }\n      \n      toast.success(' .');\n      await loadPurchases();\n    } catch (error) {\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handlePaymentComplete = useCallback(async (purchaseId: number) => {\n    try {\n      const currentTime = new Date().toISOString();\n      \n      //    \n      const [requestResult, itemsResult] = await Promise.all([\n        supabase\n          .from('purchase_requests')\n          .update({ \n            is_payment_completed: true,\n            payment_completed_at: currentTime\n          })\n          .eq('id', purchaseId),\n        supabase\n          .from('purchase_request_items')\n          .update({ \n            is_payment_completed: true,\n            payment_completed_at: currentTime\n          })\n          .eq('purchase_request_id', purchaseId)\n      ]);\n\n      if (requestResult.error) throw requestResult.error;\n      if (itemsResult.error) throw itemsResult.error;\n      \n      //      (UI  )\n      const memoryUpdated = markPurchaseAsPaymentCompleted(purchaseId);\n      if (!memoryUpdated) {\n        logger.warn('[PurchaseListMain]    ,  ', { purchaseId });\n        await loadPurchases(); // fallback:      \n      }\n      \n      toast.success(' .');\n    } catch (error) {\n      logger.error('[PurchaseListMain]   :', error);\n      toast.error('   .');\n    }\n  }, [supabase, loadPurchases]);\n\n  const handleItemsClick = useCallback((purchase: Purchase) => {\n    setSelectedPurchase(purchase);\n    setIsModalOpen(true);\n  }, []);\n  \n  //    -   \n  const modalPurchaseData = useMemo(() => {\n    if (!selectedPurchase) return null;\n    return {\n      ...selectedPurchase,\n      vendor_name: selectedPurchase.vendor_name || '',\n      project_vendor: selectedPurchase.project_vendor || '',\n      sales_order_number: selectedPurchase.sales_order_number || '',\n      project_item: selectedPurchase.project_item || ''\n    };\n  }, [selectedPurchase]);\n\n  //        \n  const handleWarningItemClick = useCallback((purchase: Purchase) => {\n    setIsWarningModalOpen(false);\n    setSelectedPurchase(purchase);\n    setIsModalOpen(true);\n  }, []);\n\n  return (\n    <div className=\"w-full\">\n      {/* Header */}\n      <div className=\"mb-4\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"page-title\"> </h1>\n            <p className=\"page-subtitle\" style={{marginTop:'-2px',marginBottom:'-4px'}}>Purchase Management</p>\n          </div>\n          \n          {/*     */}\n          {deliveryWarningCount > 0 && (\n            <Button\n              onClick={() => setIsWarningModalOpen(true)}\n              variant=\"outline\"\n              className=\"flex items-center gap-2 border-orange-300 bg-orange-50 text-orange-700 hover:bg-orange-100 hover:border-orange-400\"\n            >\n              <AlertTriangle className=\"w-4 h-4\" />\n              <span className=\"text-xs font-medium\"> </span>\n              <Badge variant=\"outline\" className=\"bg-orange-100 text-orange-700 border-orange-300 text-[10px] px-1.5 py-0\">\n                {deliveryWarningCount}\n              </Badge>\n            </Button>\n          )}\n        </div>\n\n      </div>\n\n      {/*    */}\n      <div className=\"mb-3\">\n        <FilterToolbar\n          activeFilters={activeFilters}\n          sortConfig={sortConfig}\n          searchTerm={searchTerm}\n          onFiltersChange={setActiveFilters}\n          onSortChange={setSortConfig}\n          onSearchChange={setSearchTerm}\n          availableEmployees={availableEmployees}\n          availableVendors={availableVendors}\n          availableContacts={availableContacts}\n          availablePaymentSchedules={availablePaymentSchedules}\n        >\n          {/*         */}\n          <ColumnSettingsDropdown \n            isVisible={true} \n            columnVisibility={columnVisibility}\n            applyColumnSettings={applyColumnSettings}\n            resetToDefault={resetToDefault}\n            isLoading={isColumnLoading}\n            currentUserRoles={currentUserRoles}\n          />\n        </FilterToolbar>\n        \n      </div>\n\n      {/*   */}\n      <div className=\"space-y-3\">\n\n        {/*   -    */}\n        <div className=\"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 business-radius-card border border-gray-200\">\n          {NAV_TABS.map((tab) => (\n            <button\n              key={tab.key}\n              onClick={() => {\n                logger.info('[  ]', {\n                  tab: tab.key,\n                  currentActiveTab: activeTab,\n                  currentUser: currentUser?.name,\n                  currentUserRoles,\n                  defaultEmployeeByTab,\n                  isPending\n                });\n                \n                // URL   (   )\n                const searchParams = new URLSearchParams(location.search);\n                searchParams.set('tab', tab.key);\n                navigate({ search: searchParams.toString() }, { replace: true });\n\n                // startTransition       \n                try {\n                  const newEmployeeValue = defaultEmployeeByTab[tab.key as keyof typeof defaultEmployeeByTab];\n                  \n                  // undefined  \n                  if (newEmployeeValue === undefined) {\n                    logger.error('[  ] defaultEmployeeByTab    ', {\n                      tabKey: tab.key,\n                      defaultEmployeeByTab,\n                      availableKeys: Object.keys(defaultEmployeeByTab)\n                    });\n                    //  \n                    setActiveTab(tab.key);\n                    setSelectedEmployee('all');\n                  } else {\n                    setActiveTab(tab.key);\n                    setSelectedEmployee(newEmployeeValue);\n                  }\n                  \n                  logger.info('[  ]', { \n                    newTab: tab.key,\n                    newEmployee: newEmployeeValue || 'all',\n                    actualNewEmployee: newEmployeeValue\n                  });\n                } catch (error) {\n                  logger.error('[  ]', error);\n                }\n              }}\n              className={`flex-1 flex items-center justify-center space-x-2 py-1.5 px-3 sm:px-4 business-radius-button button-text font-medium transition-colors ${\n                activeTab === tab.key\n                  ? 'text-hansl-600 bg-white shadow-sm border border-gray-200'\n                  : 'text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50'\n              }`}\n            >\n              <span className=\"whitespace-nowrap\">{tab.label}</span>\n              <span \n                className={\n                  `badge-stats ${\n                    activeTab === tab.key \n                      ? 'bg-hansl-50 text-hansl-700' \n                      : 'bg-gray-100 text-gray-600'\n                  }`\n                }\n              >\n                {getTabBadgeText(tab.key)}\n              </span>\n            </button>\n          ))}\n        </div>\n\n        {/*       */}\n        {monthlyFilterSummary && (\n          <div className=\"mb-3\">\n            {monthlyFilterSummary.type === 'single' ? (\n              //    -    \n              <div className=\"inline-flex items-center gap-2 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 business-radius-badge px-3 py-2 shadow-sm\">\n                <div className=\"flex items-center gap-1.5\">\n                  <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                  <span className=\"card-subtitle text-gray-700\">\n                    {monthlyFilterSummary.year} {monthlyFilterSummary.month}\n                  </span>\n                  <span className=\"badge-text text-gray-500\">\n                    {monthlyFilterSummary.count}\n                  </span>\n                </div>\n                <div className=\"h-4 w-px bg-blue-300\"></div>\n                <span className=\"modal-value text-blue-700 font-semibold\">\n                  {monthlyFilterSummary.totalFilteredAmount?.toLocaleString() || '0'}\n                </span>\n              </div>\n            ) : (\n              //   \n              <Card className=\"business-radius-card border border-gray-200 shadow-sm\">\n                <CardHeader className=\"pb-3 pt-4 px-4\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-1.5 h-1.5 bg-blue-500 rounded-full\"></div>\n                      <CardTitle className=\"section-title text-gray-800\">  </CardTitle>\n                    </div>\n                    {/*      */}\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"badge-text text-gray-600\">\n                        ({monthlyFilterSummary.months?.reduce((sum, m) => sum + m.count, 0) || 0})\n                      </span>\n                      <div className=\"h-4 w-px bg-gray-300\"></div>\n                      <span className=\"modal-value text-gray-500 font-bold\">\n                        {monthlyFilterSummary.totalFilteredAmount?.toLocaleString() || '0'}\n                      </span>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"px-4 pb-4\">\n                  {/*   -     */}\n                  <div className=\"flex gap-2 overflow-x-auto pb-2\">\n                    {monthlyFilterSummary.months?.map((monthData) => (\n                      <div \n                        key={monthData.monthStr} \n                        className=\"bg-gray-50 business-radius-card px-3 py-1.5 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-all flex-shrink-0\"\n                      >\n                        <div className=\"flex items-baseline gap-1.5\">\n                          <span className=\"modal-value font-bold text-gray-800 whitespace-nowrap\">\n                            {monthData.month}\n                          </span>\n                          <span className=\"text-[9px] text-gray-500 whitespace-nowrap\">\n                            ({monthData.count})\n                          </span>\n                          <span className=\"modal-value text-gray-500 font-bold whitespace-nowrap ml-1\">\n                            {monthData.total.toLocaleString()}\n                          </span>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n        )}\n\n        {/*   */}\n        <Card className=\"overflow-hidden border border-gray-200 w-full max-w-full\">\n          <CardContent className=\"p-0\">\n            {loading ? (\n              <div className=\"flex items-center justify-center py-12\">\n                <div className=\"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin\" />\n                <span className=\"ml-3 card-subtitle\"> ...</span>\n              </div>\n            ) : tabFilteredPurchases.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <Package className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\"> </h3>\n                <p className=\"card-subtitle\">  .</p>\n              </div>\n            ) : (\n              <FastPurchaseTable \n                purchases={tabFilteredPurchases} \n                activeTab={activeTab}\n                currentUserRoles={currentUserRoles}\n                onRefresh={loadPurchases}\n                onOptimisticUpdate={updatePurchaseOptimistic}\n                onPaymentComplete={handlePaymentComplete}\n                onReceiptComplete={handleReceiptComplete}\n                columnVisibility={columnVisibility}\n              />\n            )}\n          </CardContent>\n        </Card>\n      </div>\n      \n      {/*   -     */}\n      {modalPurchaseData && (\n        <Suspense fallback={<div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"><div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"></div></div>}>\n          <PurchaseItemsModal\n            isOpen={isModalOpen}\n            onClose={() => {\n              setIsModalOpen(false);\n              setSelectedPurchase(null);\n            }}\n            purchase={modalPurchaseData}\n            isAdmin={isAdmin || false}\n            onUpdate={loadPurchases}\n            activeTab={activeTab}\n          />\n        </Suspense>\n      )}\n      \n      {/*      */}\n      <DeliveryDateWarningModal\n        isOpen={isWarningModalOpen}\n        onClose={() => {\n          //    (  +  )\n          setIsWarningModalOpen(false);\n          window.location.reload();\n        }}\n        purchases={visiblePurchases}\n        currentUserName={currentUserName}\n      />\n    </div>\n  );\n}","import { useState, useEffect, useCallback } from 'react';\nimport { createClient } from '@/lib/supabase/client';\nimport { toast } from 'sonner';\nimport { logger } from '@/lib/logger';\nimport {\n  ColumnVisibility,\n  DoneTabColumnId,\n  UseColumnSettingsReturn,\n} from '@/types/columnSettings';\nimport { DEFAULT_COLUMN_VISIBILITY } from '@/constants/columnSettings';\n\n/**\n *      \n * -     DB /\n * -      \n */\nexport const useColumnSettings = (): UseColumnSettingsReturn => {\n  const [columnVisibility, setColumnVisibility] = useState<ColumnVisibility>(DEFAULT_COLUMN_VISIBILITY);\n  const [isLoading, setIsLoading] = useState(true); //    true \n  const [error, setError] = useState<string | null>(null);\n  const [, forceUpdate] = useState(0);\n  const supabase = createClient();\n\n  //   \n  const loadUserSettings = useCallback(async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n\n      //    \n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      if (authError || !user?.email) {\n        logger.warn('[useColumnSettings]    ', { authError });\n        setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n        return;\n      }\n\n      //   \n      const { data: settings, error: settingsError } = await supabase\n        .from('user_ui_settings')\n        .select('setting_value')\n        .eq('user_email', user.email)\n        .eq('setting_type', 'column_visibility')\n        .eq('setting_key', 'purchase_list_done')\n        .maybeSingle();\n\n      if (settingsError) {\n        logger.error('[useColumnSettings]   ', settingsError, {\n          userEmail: user.email\n        });\n        setError('    .');\n        setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n        return;\n      }\n\n      if (settings?.setting_value) {\n        // DB   \n        const savedSettings = settings.setting_value as ColumnVisibility;\n        \n        //   (    )\n        const mergedSettings = { ...DEFAULT_COLUMN_VISIBILITY, ...savedSettings };\n        \n        setColumnVisibility(mergedSettings);\n        logger.debug('[useColumnSettings]    ', {\n          userEmail: user.email,\n          settingsCount: Object.keys(mergedSettings).length\n        });\n      } else {\n        // DB     \n        setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n        logger.debug('[useColumnSettings]   ', {\n          userEmail: user.email\n        });\n      }\n    } catch (error) {\n      logger.error('[useColumnSettings]     ', error);\n      setError('    .');\n      setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [supabase]);\n\n  //  \n  const saveUserSettings = useCallback(async (newSettings: ColumnVisibility) => {\n    try {\n      const { data: { user }, error: authError } = await supabase.auth.getUser();\n      \n      if (authError || !user?.email) {\n        logger.warn('[useColumnSettings]     -  ', { authError });\n        return;\n      }\n\n      const { error: upsertError } = await supabase\n        .from('user_ui_settings')\n        .upsert({\n          user_email: user.email,\n          setting_type: 'column_visibility',\n          setting_key: 'purchase_list_done',\n          setting_value: newSettings,\n        }, {\n          onConflict: 'user_email,setting_type,setting_key'\n        });\n\n      if (upsertError) {\n        logger.error('[useColumnSettings]   ', upsertError, {\n          userEmail: user.email,\n          settings: newSettings\n        });\n        throw upsertError;\n      }\n\n      logger.info('[useColumnSettings]   ', {\n        userEmail: user.email,\n        settingsCount: Object.keys(newSettings).length,\n        visibleColumns: Object.entries(newSettings).filter(([, visible]) => visible).length\n      });\n    } catch (error) {\n      logger.error('[useColumnSettings]     ', error);\n      throw error;\n    }\n  }, [supabase]);\n\n  //   (  -  )\n  const toggleColumn = useCallback((columnId: DoneTabColumnId) => {\n    setColumnVisibility(prevSettings => {\n      const newSettings = {\n        ...prevSettings,\n        [columnId]: !prevSettings[columnId]\n      };\n\n      //  DB \n      saveUserSettings(newSettings).catch(error => {\n        //      \n        setColumnVisibility(prevSettings);\n        toast.error('  .');\n        logger.error('[useColumnSettings]   ,  ', error);\n      });\n\n      return newSettings;\n    });\n  }, [saveUserSettings]);\n\n  //    \n  const applyColumnSettings = useCallback((newSettings: ColumnVisibility) => {\n    logger.info('[useColumnSettings] applyColumnSettings ', { \n      newSettings,\n      keys: Object.keys(newSettings),\n      values: Object.values(newSettings)\n    });\n    \n    //  UI \n    setColumnVisibility(newSettings);\n    forceUpdate(prev => prev + 1); //  \n    logger.info('[useColumnSettings] setColumnVisibility ', { newSettings });\n\n    //  DB \n    saveUserSettings(newSettings).then(() => {\n      toast.success('  .');\n      logger.info('[useColumnSettings] DB  ');\n    }).catch(error => {\n      logger.error('[useColumnSettings]   ', error);\n      toast.error('  .');\n    });\n  }, [saveUserSettings]);\n\n  //  \n  const resetToDefault = useCallback(() => {\n    setColumnVisibility(DEFAULT_COLUMN_VISIBILITY);\n\n    // DB  \n    saveUserSettings(DEFAULT_COLUMN_VISIBILITY).catch(error => {\n      toast.error('   .');\n      logger.error('[useColumnSettings]   ', error);\n    });\n\n    toast.success('   .');\n  }, [saveUserSettings]);\n\n  //     \n  useEffect(() => {\n    loadUserSettings();\n  }, [loadUserSettings]);\n\n  return {\n    columnVisibility,\n    toggleColumn,\n    applyColumnSettings,\n    resetToDefault,\n    isLoading,\n    error,\n  };\n};","export default function CardUsageTab() {\n  return (\n    <div className=\"w-full\">\n      <div className=\"mb-4\">\n        <h1 className=\"page-title\"> </h1>\n        <p className=\"page-subtitle\" style={{ marginTop: \"-2px\", marginBottom: \"-4px\" }}>\n          Card Usage Management\n        </p>\n      </div>\n\n      <div className=\"business-radius-card border border-gray-200 bg-white p-8 text-center\">\n        <p className=\"section-title text-gray-700\">   </p>\n        <p className=\"card-subtitle mt-1\">  //     .</p>\n      </div>\n    </div>\n  );\n}\n","export default function BusinessTripTab() {\n  return (\n    <div className=\"w-full\">\n      <div className=\"mb-4\">\n        <h1 className=\"page-title\"> </h1>\n        <p className=\"page-subtitle\" style={{ marginTop: \"-2px\", marginBottom: \"-4px\" }}>\n          Business Trip Management\n        </p>\n      </div>\n\n      <div className=\"business-radius-card border border-gray-200 bg-white p-8 text-center\">\n        <p className=\"section-title text-gray-700\">   </p>\n        <p className=\"card-subtitle mt-1\">  //     .</p>\n      </div>\n    </div>\n  );\n}\n","export default function VehicleTab() {\n  return (\n    <div className=\"w-full\">\n      <div className=\"mb-4\">\n        <h1 className=\"page-title\"> </h1>\n        <p className=\"page-subtitle\" style={{ marginTop: \"-2px\", marginBottom: \"-4px\" }}>\n          Vehicle Management\n        </p>\n      </div>\n\n      <div className=\"business-radius-card border border-gray-200 bg-white p-8 text-center\">\n        <p className=\"section-title text-gray-700\">   </p>\n        <p className=\"card-subtitle mt-1\">  //     .</p>\n      </div>\n    </div>\n  );\n}\n","import { useState } from \"react\";\nimport PurchaseListMain from \"@/components/purchase/PurchaseListMain\";\nimport CardUsageTab from \"@/components/purchase/CardUsageTab\";\nimport BusinessTripTab from \"@/components/purchase/BusinessTripTab\";\nimport VehicleTab from \"@/components/purchase/VehicleTab\";\n\ninterface RequestListMainProps {\n  showEmailButton?: boolean;\n}\n\ntype TemplateTabKey = \"/\" | \"\" | \"\" | \"\";\n\nconst TEMPLATE_TABS: { key: TemplateTabKey; label: string }[] = [\n  { key: \"/\", label: \"/\" },\n  { key: \"\", label: \"\" },\n  { key: \"\", label: \"\" },\n  { key: \"\", label: \"\" },\n];\n\nexport default function RequestListMain({ showEmailButton = true }: RequestListMainProps) {\n  const [activeTemplateTab, setActiveTemplateTab] = useState<TemplateTabKey>(\"/\");\n\n  return (\n    <div className=\"w-full\">\n      <div className=\"flex space-x-6 border-b border-gray-200 mb-4\">\n        {TEMPLATE_TABS.map((tab) => (\n          <button\n            key={tab.key}\n            onClick={() => setActiveTemplateTab(tab.key)}\n            className={`pb-2 text-xs font-medium transition-colors relative ${\n              activeTemplateTab === tab.key ? \"text-hansl-600\" : \"text-gray-400 hover:text-gray-600\"\n            }`}\n          >\n            {tab.label}\n            {activeTemplateTab === tab.key && (\n              <span className=\"absolute bottom-0 left-0 right-0 h-[2px] bg-hansl-600 rounded-full\" />\n            )}\n          </button>\n        ))}\n      </div>\n\n      {activeTemplateTab === \"/\" && <PurchaseListMain showEmailButton={showEmailButton} />}\n      {activeTemplateTab === \"\" && <CardUsageTab />}\n      {activeTemplateTab === \"\" && <BusinessTripTab />}\n      {activeTemplateTab === \"\" && <VehicleTab />}\n    </div>\n  );\n}\n"],"file":"assets/RequestListMain-CsfH8N6e.js"}