{"version":3,"file":"PurchaseNewMain--CyTJ2Pu.js","sources":["../../node_modules/lucide-react/dist/esm/icons/copy.js","../../src/components/purchase/PurchaseNewMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\", key: \"17jyea\" }],\n  [\"path\", { d: \"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\", key: \"zix9uf\" }]\n];\nconst Copy = createLucideIcon(\"copy\", __iconNode);\n\nexport { __iconNode, Copy as default };\n//# sourceMappingURL=copy.js.map\n","import { useState, useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Plus, X, Save, Package, Copy, Check } from \"lucide-react\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { useNavigate } from \"react-router-dom\";\nimport { invalidatePurchaseMemoryCache } from '@/stores/purchaseMemoryStore';\nimport { useForm as useFormRH, useFieldArray } from \"react-hook-form\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogClose } from \"@/components/ui/dialog\";\nimport { FormValues, FormItem } from \"@/types/purchase\";\nimport { toast } from \"sonner\";\nimport ReactSelect from 'react-select';\n\ninterface EmployeeOption {\n  value: string;\n  label: string;\n}\n\nexport default function PurchaseNewMain() {\n  const navigate = useNavigate();\n  const supabase = createClient();\n  \n  const [user, setUser] = useState<any>(null);\n  const [employeeName, setEmployeeName] = useState<string>(\"\");\n  const [employees, setEmployees] = useState<{id: string; name: string; email?: string; phone?: string; address?: string; position?: string; department?: string;}[]>([]);\n  const [defaultRequesterLoaded, setDefaultRequesterLoaded] = useState(false);\n  const [addCount, setAddCount] = useState(1);\n  const [vendorSearchTerm, setVendorSearchTerm] = useState(\"\");\n  \n  // BOM ì—°ë™ì„ ìœ„í•œ ìƒíƒœ\n  const [boards, setBoards] = useState<{ id: string; board_name: string }[]>([]);\n  const [selectedBoard, setSelectedBoard] = useState<{ value: string; label: string } | null>(null);\n  const [productionQuantity, setProductionQuantity] = useState<number>(100); // BOM ë¶ˆëŸ¬ì˜¤ê¸° ì‹œ ì‚¬ìš©í•  ìƒì‚° ìˆ˜ëŸ‰\n  \n  // ì´ˆê¸° ì‚¬ìš©ì ì •ë³´ ë¡œë“œ\n  useEffect(() => {\n    const getUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      setUser(user);\n    };\n    getUser();\n  }, []);\n\n  // ë³´ë“œ ëª©ë¡ ë¡œë“œ (BOM ì—°ë™)\n  useEffect(() => {\n    const loadBoards = async () => {\n      const { data, error } = await supabase\n        .from('cad_drawings')\n        .select('id, board_name')\n        .order('board_name');\n      \n      if (data && !error) {\n        setBoards(data);\n      }\n    };\n    loadBoards();\n  }, [supabase]);\n\n  useEffect(() => {\n    // DBì—ì„œ ì§ì› ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n    const loadEmployees = async () => {\n      try {\n        const { data, error } = await supabase\n          .from('employees')\n          .select('id, name, email, phone, adress, position, department')\n          .order('name');\n        \n        \n        if (data && !error && data.length > 0) {\n          setEmployees(data.map((dbEmp: any) => ({\n            id: dbEmp.id,\n            name: dbEmp.name,\n            email: dbEmp.email || '',\n            phone: dbEmp.phone || '',\n            address: dbEmp.address || '',\n            position: dbEmp.position || '',\n            department: dbEmp.department || ''\n          })));\n          \n          // ì´ë¯¸ ì„¤ì •ëœ employeeNameì´ ìˆê³  employees ë°°ì—´ì— í•´ë‹¹ ì§ì›ì´ ìˆëŠ”ì§€ í™•ì¸\n          if (employeeName && !data.find((emp: any) => emp.name === employeeName)) {\n            // í˜„ì¬ ì‚¬ìš©ìë¥¼ employees ë°°ì—´ì— ì¶”ê°€\n            const currentUser = {\n              id: user?.id || 'current-user',\n              name: employeeName,\n              email: user?.email || '',\n              phone: '',\n              address: '',\n              position: '',\n              department: ''\n            };\n            setEmployees([...data.map((dbEmp: any) => ({\n              id: dbEmp.id,\n              name: dbEmp.name,\n              email: dbEmp.email || '',\n              phone: dbEmp.phone || '',\n              address: dbEmp.address || '',\n              position: dbEmp.position || '',\n              department: dbEmp.department || ''\n            })), currentUser]);\n          }\n        } else {\n          // DBì—ì„œ ëª» ë¶ˆëŸ¬ì™€ë„ í˜„ì¬ ì‚¬ìš©ìë§Œì´ë¼ë„ ì¶”ê°€\n          if (employeeName) {\n            setEmployees([{\n              id: user?.id || 'current-user',\n              name: employeeName,\n              email: user?.email || '',\n              phone: '',\n              address: '',\n              position: '',\n              department: ''\n            }]);\n          } else {\n            setEmployees([]);\n          }\n        }\n      } catch (err) {\n        // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ í˜„ì¬ ì‚¬ìš©ì ì¶”ê°€\n        if (employeeName) {\n          setEmployees([{\n            id: user?.id || 'current-user',\n            name: employeeName,\n            email: user?.email || '',\n            phone: '',\n            address: '',\n            position: '',\n            department: ''\n          }]);\n        } else {\n          setEmployees([]);\n        }\n      }\n    };\n    \n    // user ìƒíƒœì™€ ê´€ê³„ì—†ì´ ì§ì› ëª©ë¡ ë¡œë“œ\n    loadEmployees();\n  }, [employeeName, user]);\n\n  const [vendors, setVendors] = useState<{ id: number; vendor_name: string }[]>([]);\n  const [contacts, setContacts] = useState<{ id: number; contact_name: string; contact_email: string; contact_phone: string; position: string }[]>([]);\n  const [vendor, setVendor] = useState(\"\");\n  const [selectedContacts, setSelectedContacts] = useState<string[]>([]);\n  const [currency, setCurrency] = useState(\"KRW\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [inputValues, setInputValues] = useState<{[key: string]: string}>({});\n  const [isContactDialogOpen, setIsContactDialogOpen] = useState(false);\n  const [contactsForEdit, setContactsForEdit] = useState<{ id?: number; contact_name: string; contact_email: string; contact_phone: string; position: string; isNew?: boolean }[]>([]);\n  const [hasChanges, setHasChanges] = useState(false);\n  // ì¤‘ë³µ ì œì¶œ ë°©ì§€ìš© ref\n  const isSubmittingRef = useRef(false);\n  \n  // ì „ì²´ë³µì‚¬ ë²„íŠ¼ ìƒíƒœ\n  const [isCopied, setIsCopied] = useState(false);\n\n  const { control, handleSubmit: rhHandleSubmit, watch, setValue, reset, getValues } = useFormRH<FormValues>({\n    defaultValues: {\n      progress_type: \"\",\n      payment_category: \"\",\n      currency: \"KRW\",\n      po_template_type: \"ì¼ë°˜\",\n      request_type: \"\",\n      contacts: [],\n      sales_order_number: '',\n      project_vendor: '',\n      project_item: '',\n      delivery_request_date: '',\n      vendor_id: 0,\n      requester_name: \"\",\n      items: [\n        {\n          line_number: 1,\n          item_name: \"\",\n          specification: \"\",\n          quantity: 1,\n          unit_price_value: 0,\n          unit_price_currency: \"KRW\",\n          amount_value: 0,\n          amount_currency: \"KRW\",\n          remark: \"\",\n          link: \"\",\n        },\n      ],\n      request_date: new Date().toISOString().slice(0, 10),\n    }\n  });\n\n  const { fields, append, remove, update, replace } = useFieldArray({\n    control,\n    name: \"items\"\n  });\n\n  // ì‚¬ìš©ì ì •ë³´ë¡œ êµ¬ë§¤ìš”ì²­ì ê¸°ë³¸ê°’ ì„¤ì •\n  useEffect(() => {\n    if (!user?.email || defaultRequesterLoaded) return;\n    \n    const loadUserName = async () => {\n      const { data: empData } = await supabase\n        .from('employees')\n        .select('name')\n        .eq('email', user.email)\n        .single();\n      \n      if (empData?.name) {\n        setEmployeeName(empData.name);\n        setValue('requester_name', empData.name);\n        setDefaultRequesterLoaded(true);\n      }\n    };\n    loadUserName();\n  }, [user, supabase, setValue, defaultRequesterLoaded]);\n\n  // ì—…ì²´ ëª©ë¡ ë¡œë“œ\n  useEffect(() => {\n    const setDefaultRequester = async () => {\n      if (user?.email && setValue && !defaultRequesterLoaded) {\n        try {\n          const { data: employeeData, error } = await supabase\n            .from('employees')\n            .select('name')\n            .eq('email', user.email)\n            .single();\n          \n          if (employeeData && !error) {\n            setEmployeeName(employeeData.name);\n            // React Hook Formì˜ setValueë¥¼ ì•½ê°„ì˜ ì§€ì—° í›„ í˜¸ì¶œ\n            setTimeout(() => {\n              setValue('requester_name', employeeData.name, { \n                shouldValidate: true,\n                shouldDirty: true \n              });\n            }, 100);\n            setDefaultRequesterLoaded(true);\n          } else {\n            const fallbackName = user.email.split('@')[0] || \"ì‚¬ìš©ì\";\n            setEmployeeName(fallbackName);\n            setTimeout(() => {\n              setValue('requester_name', fallbackName, { \n                shouldValidate: true,\n                shouldDirty: true \n              });\n            }, 100);\n            setDefaultRequesterLoaded(true);\n          }\n        } catch (err) {\n          const fallbackName = user.email?.split('@')[0] || \"ì‚¬ìš©ì\";\n          setEmployeeName(fallbackName);\n          setTimeout(() => {\n            setValue('requester_name', fallbackName, { \n              shouldValidate: true,\n              shouldDirty: true \n            });\n          }, 100);\n          setDefaultRequesterLoaded(true);\n        }\n      }\n    };\n    \n    setDefaultRequester();\n  }, [user, setValue, defaultRequesterLoaded]);\n\n  // Vendors ë¡œë“œ\n  useEffect(() => {\n    const loadVendors = async () => {\n      try {\n        const { data, error } = await supabase\n          .from(\"vendors\")\n          .select(\"*\")\n          .order(\"vendor_name\");\n        \n        if (error) throw error;\n        setVendors(data || []);\n      } catch (error) {\n        toast.error(\"ì—…ì²´ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n      }\n    };\n\n    loadVendors();\n  }, []);\n\n  const selectedVendor = watch('vendor_id');\n\n  // ì—…ì²´ ë³€ê²½ ì‹œ ë‹´ë‹¹ì ëª©ë¡ ë¡œë“œ\n  useEffect(() => {\n    const loadContacts = async () => {\n      if (selectedVendor) {\n        try {\n          const { data, error } = await supabase\n            .from('vendor_contacts')\n            .select('id, contact_name, contact_email, contact_phone, position')\n            .eq('vendor_id', selectedVendor);\n          \n          if (error) throw error;\n          setContacts(data || []);\n        } catch (error) {\n          setContacts([]);\n        }\n      } else {\n        setContacts([]);\n      }\n    };\n    \n    loadContacts();\n  }, [selectedVendor]);\n\n  // í†µí™” ë³€ê²½ì‹œ í’ˆëª©ë“¤ì˜ í†µí™”ë„ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    const items = getValues(\"items\");\n    const updatedItems = items.map(item => ({\n      ...item,\n      unit_price_currency: currency,\n      amount_currency: currency\n    }));\n    setValue(\"items\", updatedItems);\n    setCurrency(currency);\n  }, [currency, setValue, getValues]);\n\n  // ìˆ˜ëŸ‰ì´ë‚˜ ë‹¨ê°€ ë³€ê²½ ì‹œ ê¸ˆì•¡ ìë™ ê³„ì‚°\n  useEffect(() => {\n    fields.forEach((item, idx) => {\n      const calcAmount = Number(item.quantity) * Number(item.unit_price_value);\n      if (item.amount_value !== calcAmount) {\n        update(idx, { ...item, amount_value: calcAmount });\n      }\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fields.map(f => `${f.quantity}-${f.unit_price_value}`).join(\",\")]);\n\n  // í’ˆëª© ì¶”ê°€\n  const addItem = () => {\n    const currentItems = getValues(\"items\");\n    const nextLineNumber = Math.max(...currentItems.map(item => item.line_number), 0) + 1;\n    \n    append({\n      line_number: nextLineNumber,\n      item_name: \"\",\n      specification: \"\",\n      quantity: 1,\n      unit_price_value: 0,\n      unit_price_currency: currency,\n      amount_value: 0,\n      amount_currency: currency,\n      remark: \"\",\n      link: \"\"\n    });\n  };\n\n  // ê¸ˆì•¡ ê³„ì‚°\n  const calculateAmount = (index: number) => {\n    const items = getValues(\"items\");\n    const item = items[index];\n    const amount = item.quantity * item.unit_price_value;\n    \n    // update í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ fields ë°°ì—´ ì§ì ‘ ì—…ë°ì´íŠ¸\n    update(index, { ...item, amount_value: amount });\n  };\n\n  // ì—‘ì…€ ë¶™ì—¬ë„£ê¸° í•¸ë“¤ëŸ¬\n  const handlePasteFromExcel = (e: React.ClipboardEvent) => {\n    // ë¶™ì—¬ë„£ê¸° ì´ë²¤íŠ¸ê°€ input ìš”ì†Œ ë‚´ë¶€ì—ì„œ ë°œìƒí–ˆë‹¤ë©´, í•´ë‹¹ inputì˜ ê¸°ë³¸ ë™ì‘ì„ í—ˆìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ,\n    // ì—¬ê¸°ì„œëŠ” ëŒ€ëŸ‰ ë¶™ì—¬ë„£ê¸°ë¥¼ ìœ„í•´ í…Œì´ë¸” ì „ì²´ ë™ì‘ìœ¼ë¡œ ì²˜ë¦¬\n    // ë‹¨, ë‹¨ì¼ ì…€ ë¶™ì—¬ë„£ê¸°(ì§§ì€ í…ìŠ¤íŠ¸)ì¸ ê²½ìš°ëŠ” ì œì™¸í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìœ¼ë‚˜,\n    // íƒ­ ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆê±°ë‚˜ ê°œí–‰ì´ í¬í•¨ëœ ê²½ìš° ì—‘ì…€ ë°ì´í„°ë¡œ ê°„ì£¼\n    \n    const clipboardData = e.clipboardData.getData('text');\n    if (!clipboardData) return;\n    \n    // ì—‘ì…€ ë°ì´í„°ì¸ì§€ í™•ì¸ (íƒ­ì´ë‚˜ ê°œí–‰ì´ í¬í•¨ëœ ê²½ìš°)\n    const isExcelData = clipboardData.includes('\\t') || clipboardData.includes('\\n');\n    if (!isExcelData) return; // ì¼ë°˜ í…ìŠ¤íŠ¸ ë¶™ì—¬ë„£ê¸°ëŠ” ê° inputì˜ ê¸°ë³¸ ë™ì‘ ë”°ë¦„\n\n    e.preventDefault(); // ê¸°ë³¸ ë¶™ì—¬ë„£ê¸° ë°©ì§€\n    e.stopPropagation();\n\n    try {\n      // í–‰ ë¶„ë¦¬\n      const rows = clipboardData.split(/\\r\\n|\\n|\\r/).filter(row => row.trim() !== '');\n      \n      if (rows.length === 0) return;\n\n      const currentItems = getValues(\"items\");\n      \n      // í˜„ì¬ í¬ì»¤ìŠ¤ëœ í–‰ ë° í•„ë“œ ì°¾ê¸°\n      let startIndex = 0;\n      let startFieldName = 'item_name';\n      \n      const activeElement = document.activeElement as HTMLInputElement;\n      let targetInput: HTMLInputElement | null = null;\n      \n      if (activeElement && activeElement.tagName === 'INPUT') {\n        targetInput = activeElement;\n      } else {\n        // fallback\n        const targetElement = e.target as HTMLElement;\n        if (targetElement) {\n          let element: HTMLElement | null = targetElement;\n          while (element && element.tagName !== 'INPUT') {\n            element = element.parentElement;\n            if (element && element.tagName === 'INPUT') {\n              targetInput = element as HTMLInputElement;\n              break;\n            }\n          }\n        }\n      }\n      \n      if (targetInput) {\n        // í–‰ ì¸ë±ìŠ¤ ì°¾ê¸°\n        const rowIndexAttr = targetInput.getAttribute('data-row-index');\n        if (rowIndexAttr !== null) {\n          const parsedIndex = parseInt(rowIndexAttr, 10);\n          if (!isNaN(parsedIndex) && parsedIndex >= 0 && parsedIndex < currentItems.length) {\n            startIndex = parsedIndex;\n          }\n        } else {\n            // data-row-indexê°€ ì—†ìœ¼ë©´ DOM êµ¬ì¡°ë¡œ ì°¾ê¸° (fallback)\n            let parent = targetInput.parentElement;\n            while (parent && parent.tagName !== 'TR') {\n              parent = parent.parentElement;\n            }\n            \n            if (parent && parent.tagName === 'TR') {\n              const tbody = parent.parentElement;\n              if (tbody && tbody.tagName === 'TBODY') {\n                const rowIndex = Array.from(tbody.children).indexOf(parent);\n                if (rowIndex >= 0 && rowIndex < currentItems.length) {\n                  startIndex = rowIndex;\n                }\n              }\n            }\n        }\n        \n        // í•„ë“œëª… ì°¾ê¸°\n        const fieldNameAttr = targetInput.getAttribute('data-field-name');\n        if (fieldNameAttr) {\n          startFieldName = fieldNameAttr;\n        }\n      }\n\n      // í•„ë“œ ìˆœì„œ ì •ì˜ (í™”ë©´ìƒ ìˆœì„œì™€ ì¼ì¹˜í•´ì•¼ í•¨)\n      const FIELDS = [\n        'item_name', \n        'specification', \n        'quantity', \n        'unit_price_value', \n        'amount_value', // ReadOnly (í•©ê³„) - ê±´ë„ˆë›°ê¸°ìš©\n        ...(paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" ? ['link'] : []),\n        'remark'\n      ];\n      \n      const startColIndex = FIELDS.indexOf(startFieldName);\n      if (startColIndex === -1) return; // ìœ íš¨í•˜ì§€ ì•Šì€ í•„ë“œë©´ ì¤‘ë‹¨\n\n      // ì—…ë°ì´íŠ¸í•  ë°ì´í„° ì¤€ë¹„\n      const updatedItems = [...currentItems];\n      let maxRowIndex = currentItems.length - 1;\n\n      // ë¶™ì—¬ë„£ê¸° ë°ì´í„° ì²˜ë¦¬\n      rows.forEach((row, rIndex) => {\n        const columns = row.split('\\t');\n        const targetRowIndex = startIndex + rIndex;\n        \n        // í•„ìš”í•œ ê²½ìš° ìƒˆ í–‰ ë°ì´í„° ì¤€ë¹„\n        if (targetRowIndex > maxRowIndex) {\n          updatedItems.push({\n            line_number: targetRowIndex + 1,\n            item_name: \"\",\n            specification: \"\",\n            quantity: 1,\n            unit_price_value: 0,\n          unit_price_currency: currency,\n            amount_value: 0,\n          amount_currency: currency,\n            remark: \"\",\n            link: \"\",\n          });\n          maxRowIndex++;\n        }\n        \n        // í˜„ì¬ í–‰ ë°ì´í„°\n        const currentItem = updatedItems[targetRowIndex];\n        \n        // ì»¬ëŸ¼ë³„ ë°ì´í„° ë§¤í•‘\n        columns.forEach((colValue, cIndex) => {\n          const targetColIndex = startColIndex + cIndex;\n          \n          // í•„ë“œ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ ë¬´ì‹œ\n          if (targetColIndex >= FIELDS.length) return;\n          \n          const fieldName = FIELDS[targetColIndex];\n          const cleanValue = colValue.trim();\n          \n          // í•©ê³„(amount_value) í•„ë“œëŠ” ì…ë ¥ ë¶ˆê°€í•˜ë¯€ë¡œ ê±´ë„ˆëœ€ (ë°ì´í„°ê°€ ìˆì–´ë„ ë¬´ì‹œ)\n          if (fieldName === 'amount_value') return;\n\n          // ë°ì´í„° íƒ€ì… ë³€í™˜ ë° í• ë‹¹\n          if (fieldName === 'quantity') {\n             const qty = parseInt(cleanValue.replace(/,/g, '') || '0') || 0;\n             currentItem.quantity = qty;\n          } else if (fieldName === 'unit_price_value') {\n             const price = parseFloat(cleanValue.replace(/,/g, '') || '0') || 0;\n             currentItem.unit_price_value = price;\n          } else if (fieldName === 'link') {\n             currentItem.link = cleanValue;\n          } else if (fieldName === 'remark') {\n             currentItem.remark = cleanValue;\n          } else if (fieldName === 'item_name') {\n             currentItem.item_name = cleanValue;\n          } else if (fieldName === 'specification') {\n             currentItem.specification = cleanValue;\n          }\n        });\n        \n        // ê¸ˆì•¡ ì¬ê³„ì‚° (ìˆ˜ëŸ‰ * ë‹¨ê°€)\n        currentItem.amount_value = currentItem.quantity * currentItem.unit_price_value;\n        \n        // ì—…ë°ì´íŠ¸ëœ í–‰ ì €ì¥\n        updatedItems[targetRowIndex] = currentItem;\n      });\n        \n      // ìƒíƒœ ì—…ë°ì´íŠ¸ (ì „ì²´ ë¦¬ìŠ¤íŠ¸ êµì²´ ë˜ëŠ” ê°œë³„ ì—…ë°ì´íŠ¸)\n      // useFieldArrayì˜ updateë¥¼ ë°˜ë³µ í˜¸ì¶œí•˜ë©´ ì„±ëŠ¥ ì´ìŠˆê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ,\n      // setValueë¡œ ì „ì²´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜, ë³€ê²½ëœ í–‰ë§Œ update í˜¸ì¶œ\n      \n      // ë³€ê²½ëœ í–‰ë§Œ update í˜¸ì¶œ (ìµœì í™”)\n      const changedRowCount = Math.min(rows.length + (updatedItems.length - currentItems.length), updatedItems.length - startIndex);\n      \n      // ê¸°ì¡´ í–‰ ì—…ë°ì´íŠ¸\n      for (let i = 0; i < rows.length; i++) {\n        const targetIdx = startIndex + i;\n        if (targetIdx < currentItems.length) {\n          update(targetIdx, updatedItems[targetIdx]);\n        }\n      }\n      \n      // ìƒˆë¡œ ì¶”ê°€ëœ í–‰ ì¶”ê°€ (append)\n      if (updatedItems.length > currentItems.length) {\n        const newRows = updatedItems.slice(currentItems.length);\n        append(newRows);\n      }\n\n      toast.success(`${rows.length}ê°œ í–‰ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ì—ˆìŠµë‹ˆë‹¤.`);\n      \n    } catch (error) {\n      console.error('Excel paste error:', error);\n      toast.error('ì—‘ì…€ ë°ì´í„° ë¶™ì—¬ë„£ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ë³´ë“œ ì„ íƒ ì‹œ í’ˆëª© ìë™ ì±„ìš°ê¸° í•¸ë“¤ëŸ¬\n  const handleBoardSelect = async (selected: { value: string; label: string } | null) => {\n    setSelectedBoard(selected);\n    \n    if (selected) {\n      if (confirm(`\"${selected.label}\"ì˜ BOM ë°ì´í„°ë¡œ í’ˆëª© ëª©ë¡ì„ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?\\n(ê¸°ì¡´ ì…ë ¥ëœ í’ˆëª©ì€ ì‚­ì œë©ë‹ˆë‹¤)`)) {\n        try {\n          const { data: items, error } = await supabase\n            .from('bom_items')\n            .select('*')\n            .eq('cad_drawing_id', selected.value)\n            .order('line_number');\n          \n          if (error) throw error;\n          \n          if (items && items.length > 0) {\n            // BOM ë°ì´í„° ë§¤í•‘\n            const bomRows = items.map((item: any) => ({\n              line_number: item.line_number,\n              item_name: item.item_name,\n              specification: item.specification || '',\n              // SET ìˆ˜ëŸ‰ * ìƒì‚° ìˆ˜ëŸ‰ = ì´ ìˆ˜ëŸ‰\n              quantity: (item.set_count || 0) * productionQuantity,\n              unit_price_value: 0, // ë‹¨ê°€ëŠ” 0ìœ¼ë¡œ ì´ˆê¸°í™”\n              unit_price_currency: currency,\n              amount_value: 0,\n              amount_currency: currency,\n              remark: item.remark || '',\n              link: ''\n            }));\n            \n            // ê¸°ì¡´ í•­ëª© ì „ì²´ êµì²´\n            replace(bomRows);\n            toast.success(`${items.length}ê°œ í’ˆëª©ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);\n          } else {\n            toast.warning('í•´ë‹¹ ë³´ë“œì˜ BOM ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');\n          }\n        } catch (error) {\n          console.error('BOM load error:', error);\n          toast.error('BOM ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n        }\n      }\n    }\n  };\n\n  // ìƒì‚°ìˆ˜ëŸ‰ ë³€ê²½ ì‹œ ìë™ ì¬ê³„ì‚° (ì„ íƒëœ ë³´ë“œê°€ ìˆì„ ë•Œë§Œ)\n  const handleProductionQuantityChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newQty = parseInt(e.target.value) || 0;\n    setProductionQuantity(newQty);\n    \n    if (selectedBoard && newQty > 0) {\n      // 1ì´ˆ ë”œë ˆì´ í›„ ì¬ê³„ì‚° (íƒ€ì´í•‘ ì¤‘ ë¹ˆë²ˆí•œ ì—…ë°ì´íŠ¸ ë°©ì§€)\n      // í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” ì‚¬ìš©ì ëª…ì‹œì  ì•¡ì…˜ì´ ë‚«ìœ¼ë¯€ë¡œ, ìë™ìœ¼ë¡œ ë°”ê¾¸ì§„ ì•Šê³ \n      // \"ì¬ê³„ì‚°\" ë²„íŠ¼ì„ ë‘ê±°ë‚˜, ë‹¤ì‹œ ë³´ë“œë¥¼ ì„ íƒí•˜ê²Œ í•˜ëŠ”ê²Œ ë‚˜ì„ ìˆ˜ ìˆìŒ.\n      // ì¼ë‹¨ì€ ì‹¬í”Œí•˜ê²Œ ë³´ë“œê°€ ì„ íƒëœ ìƒíƒœì—ì„œ ìˆ˜ëŸ‰ ë°”ê¾¸ë©´ ë‹¤ì‹œ ë¡œë“œí•˜ê² ëƒê³  ë¬¼ì–´ë³´ëŠ”ê±´ ë„ˆë¬´ ê·€ì°®ì„ ìˆ˜ ìˆìœ¼ë‹ˆ\n      // ìˆ˜ëŸ‰ ì…ë ¥ì¹¸ ì˜†ì— [ì ìš©] ë²„íŠ¼ì„ ë‘ëŠ”ê²Œ ì¢‹ê² ìŒ.\n    }\n  };\n\n  // ìˆ˜ëŸ‰ ì ìš© ë²„íŠ¼ í•¸ë“¤ëŸ¬\n  const handleApplyQuantity = () => {\n    if (!selectedBoard) {\n      toast.error('ë¨¼ì € ë³´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');\n      return;\n    }\n    \n    // í˜„ì¬ ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” í•­ëª©ë“¤ì˜ ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸\n    // (ë‹¨, BOMì—ì„œ ê°€ì ¸ì˜¨ í•­ëª©ì´ë¼ëŠ” ë³´ì¥ì´ ì—†ìœ¼ë¯€ë¡œ, ë‹¤ì‹œ DBì—ì„œ ê°€ì ¸ì˜¤ëŠ”ê²Œ ì•ˆì „)\n    handleBoardSelect(selectedBoard);\n  };\n\n  // ì „ì²´ ê¸ˆì•¡ ê³„ì‚°\n  const getTotalAmount = () => {\n    const items = getValues(\"items\");\n    return items.reduce((sum, item) => sum + item.amount_value, 0);\n  };\n\n  // í•„ìˆ˜ í•­ëª© ì²´í¬ í•¨ìˆ˜\n  const checkRequiredFields = () => {\n    const requestType = watch('request_type');\n    const progressType = watch('progress_type');\n    const paymentCategory = watch('payment_category');\n    const vendorId = watch('vendor_id');\n    \n    return !!(requestType && progressType && paymentCategory && vendorId && vendorId !== 0 && fields.length > 0);\n  };\n\n  // ì‹¤ì‹œê°„ í•„ìˆ˜í•­ëª© ì²´í¬ë¥¼ ìœ„í•œ state\n  const [isFormValid, setIsFormValid] = useState(false);\n\n  // í•„ìˆ˜í•­ëª© ë³€ê²½ ê°ì§€\n  useEffect(() => {\n    setIsFormValid(checkRequiredFields());\n  }, [watch('request_type'), watch('progress_type'), watch('payment_category'), watch('vendor_id'), fields]);\n\n  // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„± í•¨ìˆ˜ (ì¬ì‹œë„ ë¡œì§ í¬í•¨)\n  const generatePurchaseOrderNumber = async () => {\n    const today = new Date();\n    // í•œêµ­ ì‹œê°„ëŒ€(UTC+9) ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ìƒì„±\n    const koreaTime = new Date(today.getTime() + (9 * 60 * 60 * 1000));\n    const dateStr = koreaTime.toISOString().slice(0, 10).replace(/-/g, ''); // YYYYMMDD\n    const prefix = `F${dateStr}_`;\n    \n    // ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì‹œì‘í•˜ëŠ” ë°œì£¼ìš”ì²­ë²ˆí˜¸ë“¤ ì¡°íšŒ (ìœ íš¨í•œ ìˆ«ì í˜•ì‹ë§Œ)\n    const { data: existingOrders, error: queryError } = await supabase\n      .from('purchase_requests')\n      .select('purchase_order_number')\n      .like('purchase_order_number', `${prefix}%`)\n      .order('purchase_order_number', { ascending: false });\n    \n    if (queryError) {\n    }\n    \n    // ë‹¤ìŒ ìˆœë²ˆ ê³„ì‚° (ìˆ«ìì¸ ì‹œí€€ìŠ¤ë§Œ ì°¾ê¸°)\n    let nextNumber = 1;\n    let maxSequence = 0;\n    \n    if (existingOrders && existingOrders.length > 0) {\n      // ëª¨ë“  ë°œì£¼ìš”ì²­ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì—¬ ê°€ì¥ í° ìœ íš¨í•œ ìˆ«ì ì‹œí€€ìŠ¤ ì°¾ê¸°\n      for (const order of existingOrders) {\n        const orderNumber = order.purchase_order_number;\n        \n        // ë°œì£¼ìš”ì²­ë²ˆí˜¸ í˜•ì‹: F20250612_001\n        const parts = orderNumber.split('_');\n        if (parts.length >= 2) {\n          const sequenceStr = parts[1];\n          const sequence = parseInt(sequenceStr, 10);\n          \n          // ìœ íš¨í•œ ìˆ«ìì´ê³  í˜„ì¬ ìµœëŒ€ê°’ë³´ë‹¤ í¬ë©´ ì—…ë°ì´íŠ¸\n          if (!isNaN(sequence) && sequence > maxSequence) {\n            maxSequence = sequence;\n          }\n        }\n      }\n      \n      nextNumber = maxSequence + 1;\n    }\n    \n    // 3ìë¦¬ íŒ¨ë”©ìœ¼ë¡œ ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±\n    const safeNextNumber = isNaN(nextNumber) ? 1 : nextNumber;\n    const purchaseOrderNumber = `${prefix}${String(safeNextNumber).padStart(3, '0')}`;\n    \n    return purchaseOrderNumber;\n  };\n\n  // í¼ ì œì¶œ\n  const handleSubmit = async (data: FormValues) => {\n    const currentEmployee = employees.find(emp => emp.name === data.requester_name);\n    \n    if (isSubmittingRef.current) {\n      return;\n    }\n\n    if (!currentEmployee) {\n      setError(\"êµ¬ë§¤ìš”ì²­ì ì´ë¦„ì— í•´ë‹¹í•˜ëŠ” ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤. ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.\");\n      return;\n    }\n    \n    // í•„ìˆ˜ í•­ëª©ì´ ëª¨ë‘ ì±„ì›Œì ¸ ìˆëŠ”ì§€ ì¬í™•ì¸\n    if (!checkRequiredFields()) {\n      return; // ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•˜ë¯€ë¡œ ë³„ë„ ì˜¤ë¥˜ ë©”ì‹œì§€ ì—†ì´ ê·¸ëƒ¥ ë¦¬í„´\n    }\n\n    isSubmittingRef.current = true;\n    setLoading(true);\n    setError(\"\");\n    \n    try {\n\n      let prId: number = 0;\n      let purchaseOrderNumber: string = '';\n      const maxRetries = 5;\n      let retryCount = 0;\n\n      // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•œ ì¬ì‹œë„ ë¡œì§\n      while (retryCount < maxRetries) {\n        try {\n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìë™ ìƒì„±\n          purchaseOrderNumber = await generatePurchaseOrderNumber();\n\n          // êµ¬ë§¤ìš”ì²­ ë“±ë¡ ì‹œë„\n          const { data: pr, error: prError } = await supabase.from(\"purchase_requests\").insert({\n            requester_id: currentEmployee.id,\n            purchase_order_number: purchaseOrderNumber,\n            requester_name: data.requester_name,\n            requester_phone: currentEmployee?.phone,\n            requester_fax: null,\n            requester_address: currentEmployee?.address,\n            vendor_id: data.vendor_id,\n            sales_order_number: data.sales_order_number,\n            project_vendor: data.project_vendor,\n            project_item: data.project_item,\n            request_date: data.request_date,\n            delivery_request_date: data.delivery_request_date || null,\n            request_type: data.request_type,\n            progress_type: data.progress_type,\n            is_payment_completed: false,\n            payment_category: data.payment_category,\n            currency: currency,\n            total_amount: fields.reduce((sum, i) => sum + i.amount_value, 0),\n            unit_price_currency: fields[0]?.unit_price_currency || currency,\n            po_template_type: data.po_template_type,\n            contact_id: data.contact_id ? Number(data.contact_id) : null,\n          }).select(\"id\").single();\n          \n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ì—ëŸ¬ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì—ëŸ¬ëŠ” ë°”ë¡œ throw\n          if (prError && !prError.message.includes('duplicate key value violates unique constraint')) {\n            throw prError;\n          }\n          \n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ì—ëŸ¬ì¸ ê²½ìš°\n          if (prError && prError.message.includes('duplicate key value violates unique constraint')) {\n            retryCount++;\n            if (retryCount >= maxRetries) {\n              throw new Error(`ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±ì— ${maxRetries}ë²ˆ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);\n            }\n            // ì¬ì‹œë„ë¥¼ ìœ„í•´ ì§§ì€ ëŒ€ê¸°\n            await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n            continue;\n          }\n          \n          // ì„±ê³µí•œ ê²½ìš°\n          if (!pr) throw new Error(\"ë“±ë¡ ì‹¤íŒ¨\");\n          prId = pr.id;\n          break; // ì„±ê³µ ì‹œ ë£¨í”„ ì¢…ë£Œ\n          \n        } catch (retryError: any) {\n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µì´ ì•„ë‹Œ ì—ëŸ¬ëŠ” ë°”ë¡œ throw\n          if (!retryError.message.includes('duplicate key value violates unique constraint')) {\n            throw retryError;\n          }\n          \n          retryCount++;\n          if (retryCount >= maxRetries) {\n            throw new Error(`ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±ì— ${maxRetries}ë²ˆ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);\n          }\n          \n          // ì¬ì‹œë„ë¥¼ ìœ„í•´ ì§§ì€ ëŒ€ê¸° (100-300ms ëœë¤)\n          await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n        }\n      }\n\n      // í’ˆëª©ë“¤ ì €ì¥ - ë°°ì—´ ìˆœì„œ ê·¸ëŒ€ë¡œ ì €ì¥ (ì—‘ì…€ ë¶™ì—¬ë„£ê¸° ìˆœì„œ ìœ ì§€)\n      for (const [idx, item] of fields.entries()) {\n        const { error: itemErr } = await supabase.from(\"purchase_request_items\").insert({\n          purchase_request_id: prId,\n          line_number: idx + 1, // ë°°ì—´ ìˆœì„œëŒ€ë¡œ 1, 2, 3... ì„¤ì •\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          unit_price_currency: currency,\n          amount_value: item.amount_value,\n          amount_currency: currency,\n          remark: item.remark,\n          link: item.link || null,\n        });\n        if (itemErr) throw itemErr;\n      }\n      \n      // ë°œì£¼ìš”ì²­ ì„±ê³µ ì²˜ë¦¬\n      \n      // ğŸ“¨ ì¤‘ê°„ê´€ë¦¬ì DM ì•Œë¦¼ ë°œì†¡ (í’ˆëª© ì¶”ê°€ ì™„ë£Œ í›„ ì •í™•í•œ ê°œìˆ˜ë¡œ)\n      try {\n        const notifyResponse = await fetch(`/api/purchase/${prId}/notify-middle-manager`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n        \n        if (notifyResponse.ok) {\n          const notifyResult = await notifyResponse.json();\n        } else {\n          const errorText = await notifyResponse.text();\n        }\n      } catch (notifyError) {\n      }\n      \n      // 1. í¼ ì´ˆê¸°í™”\n      reset({\n        progress_type: \"\",\n        payment_category: \"\",\n        currency: \"KRW\",\n        po_template_type: \"ì¼ë°˜\",\n        request_type: \"\",\n        contacts: [],\n        sales_order_number: '',\n        project_vendor: '',\n        project_item: '',\n        delivery_request_date: '',\n        vendor_id: 0,\n        requester_name: employeeName, // ìš”ì²­ì ì´ë¦„ì€ ìœ ì§€\n        items: [\n          {\n            line_number: 1,\n            item_name: \"\",\n            specification: \"\",\n            quantity: 1,\n            unit_price_value: 0,\n            unit_price_currency: \"KRW\",\n            amount_value: 0,\n            amount_currency: \"KRW\",\n            remark: \"\",\n            link: \"\",\n          },\n        ],\n        request_date: new Date().toISOString().slice(0, 10),\n      });\n      \n      // 2. ìƒíƒœ ì´ˆê¸°í™”\n      setVendor(\"\");\n      setSelectedContacts([]);\n      setCurrency(\"KRW\");\n      setError(\"\");\n      setLoading(false);\n      \n      // 3. ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ\n      toast.success(\"ë°œì£¼ìš”ì²­ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n      \n      // 4. ë©”ëª¨ë¦¬ ìºì‹œ ë¬´íš¨í™”í•˜ì—¬ ìƒˆë¡œìš´ ë°œì£¼ìš”ì²­ì´ ëª©ë¡ì— ë‚˜íƒ€ë‚˜ë„ë¡ í•¨\n      invalidatePurchaseMemoryCache() // ìºì‹œ ë¬´íš¨í™”ë¡œ ë‹¤ìŒ ë¡œë“œ ì‹œ ìƒˆë¡œê³ ì¹¨\n      \n      // 5. ë°œì£¼ìš”ì²­ ê´€ë¦¬ í˜ì´ì§€ì˜ ìŠ¹ì¸ëŒ€ê¸° íƒ­ìœ¼ë¡œ ì´ë™\n      try {\n        await navigate('/purchase/list?tab=pending');\n      } catch (routerError) {\n        // ëŒ€ì²´ ë¼ìš°íŒ… ë°©ë²•\n        window.location.href = '/purchase/list?tab=pending';\n      }\n      return;\n    } catch (err: any) {\n      setError(err.message || \"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n      toast.error(err.message || \"ë°œì£¼ìš”ì²­ì„œ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n    } finally {\n      // ì˜¤ë¥˜ê°€ ìˆì—ˆì„ ë•Œë§Œ ì‹¤í–‰ë¨ (ì„±ê³µ ì‹œì—ëŠ” returnìœ¼ë¡œ ë¹ ì§)\n      setLoading(false);\n      isSubmittingRef.current = false;\n    }\n  };\n\n  const totalAmount = fields.reduce((sum, item) => sum + item.amount_value, 0);\n\n  const openContactsManager = () => {\n    // ê¸°ì¡´ ë‹´ë‹¹ìë“¤ì„ ë³µì‚¬í•˜ê³  ìƒˆë¡œìš´ ë‹´ë‹¹ì ì¶”ê°€ë¥¼ ìœ„í•œ ë¹ˆ ìŠ¬ë¡¯ë„ ì¶”ê°€\n    const existingContacts = contacts.map(c => ({ ...c, isNew: false }));\n    const newEmptyContact = { contact_name: '', contact_email: '', contact_phone: '', position: '', isNew: true };\n    setContactsForEdit([...existingContacts, newEmptyContact]);\n    setHasChanges(false);\n    setIsContactDialogOpen(true);\n  };\n\n  const handleContactChange = (index: number, field: string, value: string) => {\n    setContactsForEdit(prev => prev.map((contact, i) => \n      i === index ? { ...contact, [field]: value } : contact\n    ));\n    setHasChanges(true);\n  };\n\n  const addNewContactSlot = () => {\n    setContactsForEdit(prev => [...prev, { contact_name: '', contact_email: '', contact_phone: '', position: '', isNew: true }]);\n    setHasChanges(true);\n  };\n\n  const removeContactSlot = (index: number) => {\n    setContactsForEdit(prev => prev.filter((_, i) => i !== index));\n    setHasChanges(true);\n  };\n\n  const handleSaveAllContacts = async () => {\n    if (!selectedVendor) return;\n    \n    try {\n      // @hanslë¡œ ëë‚˜ëŠ” ì´ë©”ì¼ ì²´í¬\n      const hanslEmails = contactsForEdit.filter(c => c.contact_email && c.contact_email.endsWith('@hansl.io'));\n      if (hanslEmails.length > 0) {\n        alert('í•œìŠ¬ ì§ì› ì´ë©”ì¼ì€ ì—…ì²´ ë‹´ë‹¹ìë¡œ ë“±ë¡í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n        return;\n      }\n\n      for (const contact of contactsForEdit) {\n        if (contact.contact_name && contact.contact_email) {\n          if (!contact.isNew && contact.id) {\n            // ê¸°ì¡´ ë‹´ë‹¹ì ì—…ë°ì´íŠ¸\n            await supabase\n              .from('vendor_contacts')\n              .update({\n                contact_name: contact.contact_name,\n                contact_email: contact.contact_email,\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              })\n              .eq('id', contact.id);\n          } else if (contact.isNew) {\n            // ìƒˆë¡œìš´ ë‹´ë‹¹ì ì¶”ê°€\n            await supabase\n              .from('vendor_contacts')\n              .insert({\n                vendor_id: selectedVendor,\n                contact_name: contact.contact_name,\n                contact_email: contact.contact_email,\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              });\n          }\n        }\n      }\n      \n      // ë‹´ë‹¹ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      const { data } = await supabase\n        .from('vendor_contacts')\n        .select('id, contact_name, contact_email, contact_phone, position')\n        .eq('vendor_id', selectedVendor);\n      \n      if (data) setContacts(data);\n      setIsContactDialogOpen(false);\n      toast.success('ë‹´ë‹¹ì ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      toast.error('ë‹´ë‹¹ì ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleDeleteContact = async (contactId: number) => {\n    if (!confirm('ì •ë§ ì´ ë‹´ë‹¹ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;\n    \n    try {\n      await supabase\n        .from('vendor_contacts')\n        .delete()\n        .eq('id', contactId);\n      \n      // ë‹´ë‹¹ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      const { data } = await supabase\n        .from('vendor_contacts')\n        .select('id, contact_name, contact_email, contact_phone, position')\n        .eq('vendor_id', selectedVendor);\n      \n      if (data) setContacts(data);\n      toast.success('ë‹´ë‹¹ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      toast.error('ë‹´ë‹¹ì ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const paymentCategory = watch('payment_category');\n\n  return (\n    <form \n      onSubmit={(e) => {\n        e.preventDefault();\n        rhHandleSubmit(handleSubmit)(e);\n      }}\n      onKeyDown={e => {\n        if (e.key === 'Enter' || e.keyCode === 13) {\n          e.preventDefault();\n        }\n      }}\n    >\n      <div className=\"flex flex-col lg:flex-row gap-4 lg:gap-6 items-start\">\n        {/* ë°œì£¼ ê¸°ë³¸ ì •ë³´ - ëª¨ë°”ì¼: ì „ì²´í­, ë°ìŠ¤í¬í†±: 1/4 í­ */}\n        <div className=\"w-full lg:w-1/4 relative bg-muted/20 border border-border rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-4 lg:p-5 space-y-4\">\n          <div className=\"flex flex-row items-start justify-between w-full mb-4\">\n            <div className=\"flex flex-col\">\n              <h4 className=\"font-semibold text-foreground\">ë°œì£¼ ê¸°ë³¸ ì •ë³´</h4>\n              <p className=\"text-xs text-muted-foreground mt-0.5\">Basic Information</p>\n            </div>\n          <div className=\"flex flex-col items-start gap-1 shrink-0 self-end\">\n            <div className=\"flex items-center justify-start w-full gap-2\">\n              <Label className=\"mb-1 block text-xs\">ë³´ë“œëª… (BOM ìë™ì…ë ¥)</Label>\n              {selectedBoard && (\n                <span\n                  className=\"text-[10px] text-blue-600 cursor-pointer hover:underline mb-1\"\n                  onClick={() => setSelectedBoard(null)}\n                >\n                  ì´ˆê¸°í™”\n                </span>\n              )}\n            </div>\n            <div className=\"flex gap-2 w-full justify-start\">\n              <div className=\"w-28 sm:w-32\">\n                <ReactSelect\n                  options={boards.map(b => ({ value: b.id, label: b.board_name }))}\n                  value={selectedBoard}\n                  onChange={handleBoardSelect}\n                  placeholder=\"ë³´ë“œ ì„ íƒ\"\n                  isClearable\n                  isSearchable\n                  className=\"text-xs\"\n                  menuPortalTarget={document.body}\n                  styles={{\n                    control: (base) => ({\n                      ...base,\n                      minHeight: '36px',\n                      height: '36px',\n                      fontSize: '0.75rem',\n                      backgroundColor: '#fff',\n                      borderColor: '#d2d2d7',\n                      borderRadius: '0.375rem',\n                      boxShadow: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n                      '&:hover': {\n                        borderColor: '#d2d2d7',\n                        boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'\n                      }\n                    }),\n                    menuPortal: (base) => ({ ...base, zIndex: 9999 }),\n                    menu: (base) => ({ \n                      ...base, \n                      zIndex: 9999, \n                      fontSize: '0.75rem',\n                      minWidth: '240px',\n                      width: 'auto',\n                      whiteSpace: 'nowrap'\n                    }),\n                    option: (base) => ({ ...base, padding: '6px 10px', whiteSpace: 'nowrap' }),\n                    placeholder: (base) => ({ ...base, color: '#9ca3af' }),\n                    indicatorSeparator: () => ({ display: 'none' })\n                  }}\n                />\n              </div>\n              {selectedBoard && (\n                <div className=\"flex items-center gap-1 w-32 shrink-0\">\n                  <Input\n                    type=\"number\"\n                    min=\"1\"\n                    value={productionQuantity}\n                    onChange={handleProductionQuantityChange}\n                    className=\"h-9 text-center text-xs bg-white border border-[#d2d2d7] rounded-md shadow-sm hover:shadow-md transition-shadow duration-200\"\n                    placeholder=\"ìˆ˜ëŸ‰\"\n                  />\n                  <Button \n                    type=\"button\" \n                    size=\"sm\" \n                    variant=\"outline\" \n                    onClick={handleApplyQuantity}\n                    className=\"h-9 px-2 text-[10px] border-[#d2d2d7] hover:bg-gray-50\"\n                  >\n                    ì ìš©\n                  </Button>\n                </div>\n              )}\n            </div>\n            </div>\n          </div>\n\n          {watch('po_template_type') === 'ì¼ë°˜' && (\n            <div className=\"space-y-4\">\n              {/* ìš”ì²­ ì„¤ì • */}\n              <div className=\"grid grid-cols-3 gap-1.5 sm:gap-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ìš”ì²­ ìœ í˜•<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <Select value={watch('request_type')} onValueChange={(value) => setValue('request_type', value)}>\n                    <SelectTrigger className=\"!h-9 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200\">\n                      <SelectValue placeholder=\"ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      <SelectItem value=\"ì›ìì¬\">ì›ìì¬</SelectItem>\n                      <SelectItem value=\"ì†Œëª¨í’ˆ\">ì†Œëª¨í’ˆ</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì§„í–‰ ì¢…ë¥˜<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <Select value={watch('progress_type')} onValueChange={(value) => setValue('progress_type', value)}>\n                    <SelectTrigger className=\"!h-9 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200\">\n                      <SelectValue placeholder=\"ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      <SelectItem value=\"ì¼ë°˜\">ì¼ë°˜</SelectItem>\n                      <SelectItem value=\"ì„ ì§„í–‰\">ì„ ì§„í–‰</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ê²°ì œ ì¢…ë¥˜<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <Select value={watch('payment_category')} onValueChange={(value) => setValue('payment_category', value)}>\n                    <SelectTrigger className=\"!h-9 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200\">\n                      <SelectValue placeholder=\"ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      <SelectItem value=\"êµ¬ë§¤ ìš”ì²­\">êµ¬ë§¤ ìš”ì²­</SelectItem>\n                      <SelectItem value=\"ë°œì£¼\">ë°œì£¼</SelectItem>\n                      <SelectItem value=\"í˜„ì¥ ê²°ì œ\">í˜„ì¥ ê²°ì œ</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {/* ì—…ì²´ ì •ë³´ */}\n              <div className=\"grid grid-cols-2 gap-1.5 sm:gap-2 lg:grid-cols-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì—…ì²´ëª…<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <ReactSelect\n                      options={vendors.map(v => ({ value: v.id.toString(), label: v.vendor_name }))}\n                      value={vendors.find(v => v.id.toString() === vendor) ? { value: vendor, label: vendors.find(v => v.id.toString() === vendor)?.vendor_name } : null}\n                      onChange={(option) => {\n                        const opt = option as { value: string; label: string } | null;\n                        if (opt) {\n                          setVendor(opt.value);\n                          setValue('vendor_id', Number(opt.value));\n                        } else {\n                          setVendor('');\n                          setValue('vendor_id', 0);\n                        }\n                      }}\n                      placeholder=\"ì—…ì²´ ì„ íƒ\"\n                      isClearable\n                      isSearchable\n                      closeMenuOnSelect={false}\n                      classNamePrefix=\"vendor-select\"\n                      blurInputOnSelect={false}\n                      openMenuOnFocus={false}\n                      openMenuOnClick={true}\n                      tabSelectsValue={false}\n                      captureMenuScroll={false}\n                      pageSize={20}\n                      styles={{\n                        container: base => ({ ...base, width: '100%' }),\n                        control: base => ({ \n                          ...base, \n                          height: '36px !important',\n                          minHeight: '36px !important',\n                          maxHeight: '36px !important',\n                          background: '#fff',\n                          border: '1px solid #d2d2d7',\n                          borderRadius: '6px',\n                          fontSize: '0.75rem',\n                          boxShadow: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n                          padding: '0 !important',\n                          margin: '0 !important',\n                          alignItems: 'center',\n                          display: 'flex',\n                          position: 'relative',\n                          verticalAlign: 'top',\n                          lineHeight: '1',\n                          '&:hover': { \n                            boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)' \n                          }\n                        }),\n                        valueContainer: base => ({ \n                          ...base, \n                          height: '36px !important',\n                          minHeight: '36px !important',\n                          maxHeight: '36px !important',\n                          padding: '0 14px !important',\n                          margin: '0 !important',\n                          fontSize: '0.75rem',\n                          alignItems: 'center',\n                          display: 'flex',\n                          lineHeight: '1',\n                          justifyContent: 'flex-start'\n                        }),\n                        input: base => ({ \n                          ...base, \n                          margin: '0 !important', \n                          padding: '0 !important', \n                          fontSize: '0.75rem',\n                          lineHeight: '1',\n                          position: 'relative',\n                          top: '0'\n                        }),\n                        singleValue: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '1',\n                          position: 'relative',\n                          top: '0',\n                          transform: 'none'\n                        }),\n                        placeholder: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '1',\n                          position: 'relative',\n                          top: '0',\n                          transform: 'none'\n                        }),\n                        indicatorsContainer: base => ({ \n                          ...base, \n                          height: '36px !important',\n                          padding: '0 8px !important',\n                          alignItems: 'center',\n                          display: 'flex'\n                        }),\n                        indicatorSeparator: () => ({ display: 'none' }),\n                        dropdownIndicator: base => ({ ...base, padding: '4px !important' }),\n                        clearIndicator: base => ({ ...base, padding: '4px !important' }),\n                        menuPortal: base => ({ ...base, zIndex: 1400 })\n                      }}\n                    />\n                </div>\n                <div>\n                  <div className=\"flex items-center justify-between mb-0.5\">\n                    <Label className=\"text-[10px] sm:text-xs\">ì—…ì²´ ë‹´ë‹¹ì</Label>\n                    <span\n                      className=\"text-primary text-[9px] sm:text-[10px] cursor-pointer hover:underline select-none flex items-center\"\n                      onClick={openContactsManager}\n                    >\n                      <span className=\"-translate-y-px\">+</span><span className=\"ml-0.5\">ì¶”ê°€/ìˆ˜ì •</span>\n                    </span>\n                  </div>\n                  <Select\n                    value={watch('contacts')[0] || ''}\n                    onValueChange={val => {\n                      setValue('contacts', [val]);\n                      setValue('contact_id', val ? Number(val) : undefined);\n                    }}\n                  >\n                    <SelectTrigger className=\"!h-9 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200\">\n                      <SelectValue placeholder=\"ë‹´ë‹¹ì ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      {contacts.map(c => (\n                        <SelectItem key={c.id} value={c.id.toString()}>\n                          {c.contact_name || c.contact_email || c.contact_phone || c.position || ''}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {/* êµ¬ë§¤ìš”êµ¬ì ë° ì¼ì • ì •ë³´ */}\n              <div className=\"grid grid-cols-3 gap-1.5 sm:gap-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">êµ¬ë§¤ìš”êµ¬ì</Label>\n                  <ReactSelect\n                      key={`employee-select-${employeeName}`}\n                      value={employeeName ? { value: employeeName, label: employeeName } : null}\n                      defaultValue={employeeName ? { value: employeeName, label: employeeName } : null}\n                      onChange={(selectedOption) => {\n                        const value = (selectedOption as EmployeeOption)?.value || \"\";\n                        setValue('requester_name', value);\n                        setEmployeeName(value);\n                      }}\n                      options={employees.map(employee => ({\n                        value: employee.name,\n                        label: employee.name\n                      }))}\n                      placeholder=\"ì„ íƒ\"\n                      isSearchable\n                      isClearable={false}\n                      noOptionsMessage={() => \"ì¼ì¹˜í•˜ëŠ” ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤\"}\n                      filterOption={(option, inputValue) => {\n                        const employee = employees.find(emp => emp.name === option.value);\n                        const searchText = `${employee?.name || ''} ${employee?.position || ''} ${employee?.email || ''}`.toLowerCase();\n                        return searchText.includes(inputValue.toLowerCase());\n                      }}\n                      styles={{\n                        control: (base) => ({\n                          ...base,\n                          height: '36px !important',\n                          minHeight: '36px !important',\n                          maxHeight: '36px !important',\n                          background: '#fff',\n                          border: '1px solid #d2d2d7',\n                          borderRadius: '6px',\n                          fontSize: '0.75rem',\n                          boxShadow: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n                          padding: '0 !important',\n                          margin: '0 !important',\n                          alignItems: 'center',\n                          display: 'flex',\n                          position: 'relative',\n                          verticalAlign: 'top',\n                          lineHeight: '1',\n                          '&:hover': {\n                            borderColor: '#d2d2d7',\n                            boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'\n                          }\n                        }),\n                        valueContainer: (base) => ({\n                          ...base,\n                          height: '36px !important',\n                          minHeight: '36px !important',\n                          maxHeight: '36px !important',\n                          padding: '0 14px !important',\n                          margin: '0 !important',\n                          fontSize: '0.75rem',\n                          alignItems: 'center',\n                          display: 'flex',\n                          lineHeight: '1',\n                          justifyContent: 'flex-start'\n                        }),\n                        input: (base) => ({ \n                          ...base, \n                          margin: '0 !important', \n                          padding: '0 !important', \n                          fontSize: '0.75rem',\n                          lineHeight: '1',\n                          position: 'relative',\n                          top: '0'\n                        }),\n                        singleValue: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '1',\n                          position: 'relative',\n                          top: '0',\n                          transform: 'none'\n                        }),\n                        placeholder: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '1',\n                          position: 'relative',\n                          top: '0',\n                          transform: 'none'\n                        }),\n                        indicatorsContainer: (base) => ({ \n                          ...base, \n                          height: '36px !important',\n                          padding: '0 8px !important',\n                          alignItems: 'center',\n                          display: 'flex'\n                        }),\n                        indicatorSeparator: () => ({ display: 'none' }),\n                        dropdownIndicator: base => ({ ...base, padding: '4px !important' }),\n                        clearIndicator: base => ({ ...base, padding: '4px !important' }),\n                        menu: (base) => ({ ...base, fontSize: '0.75rem', zIndex: 9999 }),\n                        option: (base) => ({ ...base, fontSize: '0.75rem', padding: '6px 10px' })\n                      }}\n                    />\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì²­êµ¬ì¼</Label>\n                  <Input\n                    type=\"date\"\n                    value={watch('request_date')}\n                    onChange={e => setValue('request_date', e.target.value)}\n                    className=\"h-9 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì…ê³  ìš”ì²­ì¼</Label>\n                  <Input\n                    type=\"date\"\n                    value={watch('delivery_request_date')}\n                    onChange={e => setValue('delivery_request_date', e.target.value)}\n                    className=\"h-9 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n              </div>\n\n              {/* í”„ë¡œì íŠ¸ ì •ë³´ */}\n              <div className=\"grid grid-cols-3 gap-1.5 sm:gap-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">PJì—…ì²´</Label>\n                  <Input \n                    type=\"text\" \n                    value={watch('project_vendor')} \n                    onChange={(e) => setValue('project_vendor', e.target.value)} \n                    placeholder=\"ì…ë ¥\"\n                    className=\"h-9 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md focus:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ìˆ˜ì£¼ë²ˆí˜¸</Label>\n                  <Input \n                    type=\"text\" \n                    value={watch('sales_order_number')} \n                    onChange={(e) => setValue('sales_order_number', e.target.value)} \n                    placeholder=\"ì…ë ¥\"\n                    className=\"h-9 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md focus:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">Item</Label>\n                  <Input \n                    type=\"text\" \n                    value={watch('project_item')} \n                    onChange={(e) => setValue('project_item', e.target.value)} \n                    placeholder=\"ì…ë ¥\"\n                    className=\"h-9 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md focus:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Professional Items Section - ëª¨ë°”ì¼: ì „ì²´í­, ë°ìŠ¤í¬í†±: 3/4 í­ */}\n        <div className=\"w-full lg:w-3/4 space-y-4\">\n\n          {/* í…Œì´ë¸” í˜•íƒœì˜ í’ˆëª© ë¦¬ìŠ¤íŠ¸ */}\n          <div className=\"relative border border-gray-200 rounded-lg overflow-hidden\">\n            <div className=\"bg-gray-50 border-b border-gray-100 px-2 sm:px-3 py-2 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3\">\n              <div className=\"flex flex-wrap items-center gap-3\">\n                <div className=\"flex items-center gap-2\">\n                  <Package className=\"w-4 h-4 text-gray-600\" />\n                  <div className=\"flex flex-col\">\n                    <span className=\"font-semibold text-foreground leading-tight\">í’ˆëª© ëª©ë¡</span>\n                    <span className=\"text-xs text-muted-foreground leading-tight\">Purchase Items</span>\n                  </div>\n                  <span className=\"badge-secondary whitespace-nowrap\">\n                    {fields.length}ê°œ\n                  </span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                <Select value={currency} onValueChange={setCurrency}>\n                  <SelectTrigger className=\"w-20 text-xs border-border business-radius-badge shadow-sm hover:shadow-md transition-shadow duration-200 bg-white\" style={{ height: 'auto', padding: '2.5px 10px', minHeight: 'auto' }}>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent className=\"rounded-md\">\n                    <SelectItem value=\"KRW\">KRW</SelectItem>\n                    <SelectItem value=\"USD\">USD</SelectItem>\n                  </SelectContent>\n                </Select>\n                  {selectedBoard?.label && (\n                    <span className=\"text-[11px] text-gray-400\">\n                      ë³´ë“œëª…: {selectedBoard.label}\n                    </span>\n                  )}\n                </div>\n              </div>\n              <div className=\"flex items-center justify-end gap-2 flex-wrap sm:flex-nowrap\">\n                <span className=\"badge-stats text-hansl-500 text-[10px] px-1.5 py-0.5 whitespace-nowrap flex-shrink-0 bg-hansl-50 business-radius-badge\">\n                  ì´ì•¡: {totalAmount.toLocaleString('ko-KR')} {currency}\n                </span>\n                <Button \n                  type=\"button\" \n                  className={`button-base border transition-all duration-200 ${\n                    isCopied \n                      ? 'border-green-400 text-green-600 bg-green-50' \n                      : 'border-gray-300 text-gray-600 bg-white hover:bg-blue-50 hover:text-blue-600'\n                  }`}\n                  disabled={isCopied}\n                  onClick={async () => { \n                    const showCopiedFeedback = () => {\n                      setIsCopied(true);\n                      setTimeout(() => setIsCopied(false), 1000);\n                    };\n                    \n                    try {\n                      // í’ˆëª© ë°ì´í„°ë¥¼ TSV í˜•ì‹ìœ¼ë¡œ ë³€í™˜ (íƒ­ìœ¼ë¡œ ì—´ êµ¬ë¶„, ì¤„ë°”ê¿ˆìœ¼ë¡œ í–‰ êµ¬ë¶„)\n                      const headers = paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" \n                        ? ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë§í¬', 'ë¹„ê³ ']\n                        : ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë¹„ê³ '];\n                      \n                      const rows = fields.map(item => {\n                        const baseRow = [\n                          item.item_name || '',\n                          item.specification || '',\n                          item.quantity?.toString() || '0',\n                          item.unit_price_value?.toString() || '0',\n                          item.amount_value?.toString() || '0',\n                        ];\n                        \n                        if (paymentCategory === \"êµ¬ë§¤ ìš”ì²­\") {\n                          baseRow.push(item.link || '');\n                        }\n                        baseRow.push(item.remark || '');\n                        \n                        return baseRow.join('\\t');\n                      });\n                      \n                      const tsvData = [headers.join('\\t'), ...rows].join('\\n');\n                      \n                      await navigator.clipboard.writeText(tsvData);\n                      showCopiedFeedback();\n                      toast.success(`ğŸ“‹ ${fields.length}ê°œ í’ˆëª© ë³µì‚¬ ì™„ë£Œ! ì—‘ì…€ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.`);\n                    } catch (err) {\n                      // Fallback: êµ¬í˜• ë¸Œë¼ìš°ì € ëŒ€ì‘\n                      try {\n                        const headers = paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" \n                          ? ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë§í¬', 'ë¹„ê³ ']\n                          : ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë¹„ê³ '];\n                        \n                        const rows = fields.map(item => {\n                          const baseRow = [\n                            item.item_name || '',\n                            item.specification || '',\n                            item.quantity?.toString() || '0',\n                            item.unit_price_value?.toString() || '0',\n                            item.amount_value?.toString() || '0',\n                          ];\n                          \n                          if (paymentCategory === \"êµ¬ë§¤ ìš”ì²­\") {\n                            baseRow.push(item.link || '');\n                          }\n                          baseRow.push(item.remark || '');\n                          \n                          return baseRow.join('\\t');\n                        });\n                        \n                        const tsvData = [headers.join('\\t'), ...rows].join('\\n');\n                        \n                        const textArea = document.createElement('textarea');\n                        textArea.value = tsvData;\n                        textArea.style.position = 'fixed';\n                        textArea.style.left = '-9999px';\n                        document.body.appendChild(textArea);\n                        textArea.select();\n                        document.execCommand('copy');\n                        document.body.removeChild(textArea);\n                        showCopiedFeedback();\n                        toast.success(`ğŸ“‹ ${fields.length}ê°œ í’ˆëª© ë³µì‚¬ ì™„ë£Œ! ì—‘ì…€ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.`);\n                      } catch (fallbackErr) {\n                        toast.error('í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.');\n                      }\n                    }\n                  }}\n                >\n                  {isCopied ? (\n                    <>\n                      <Check className=\"w-3 h-3 mr-0.5\" />\n                      ë³µì‚¬ë¨\n                    </>\n                  ) : (\n                    <>\n                      <Copy className=\"w-3 h-3 mr-0.5\" />\n                      ì „ì²´ë³µì‚¬\n                    </>\n                  )}\n                </Button>\n                <Button \n                  type=\"button\" \n                  className=\"button-base border border-gray-300 text-gray-600 bg-white hover:bg-red-50 hover:text-red-600\" \n                  onClick={() => { \n                    if (confirm('ëª¨ë“  í’ˆëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                      fields.forEach((_idx, index) => remove(fields.length - 1 - index)); \n                      append({ \n                        line_number: 1, \n                        item_name: '', \n                        specification: '', \n                        quantity: 1, \n                        unit_price_value: 0, \n                        unit_price_currency: currency, \n                        amount_value: 0, \n                        amount_currency: currency, \n                        remark: '', \n                        link: '' \n                      });\n                    }\n                  }}\n                >\n                  ì „ì²´ì‚­ì œ\n                </Button>\n                <Input\n                  type=\"number\"\n                  min={1}\n                  max={1000}\n                  value={addCount}\n                  onChange={e => setAddCount(Math.max(1, Number(e.target.value.replace(/[^0-9]/g, ''))))}\n                  className=\"w-12 text-center flex-shrink-0 business-radius-badge border border-gray-300 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [&]:!text-[12px] [&]:!font-medium [&]:!leading-tight\"\n                  style={{ \n                    height: 'auto',\n                    padding: '2px 6px', \n                    minHeight: 'auto',\n                    maxHeight: 'none',\n                    lineHeight: '1.25'\n                  }}\n                />\n                <Button\n                  type=\"button\"\n                  onClick={() => {\n                    for (let i = 0; i < addCount; i++) {\n                      append({\n                        line_number: fields.length + 1 + i,\n                        item_name: '',\n                        specification: '',\n                        quantity: 1,\n                        unit_price_value: 0,\n                        unit_price_currency: currency,\n                        amount_value: 0,\n                        amount_currency: currency,\n                        remark: '',\n                        link: ''\n                      });\n                    }\n                  }}\n                  className=\"button-base bg-blue-500 hover:bg-blue-600 text-white\"\n                >\n                  <Plus className=\"w-3 h-3 mr-0.5\" />\n                  ì¶”ê°€\n                </Button>\n              </div>\n            </div>\n            <div className=\"overflow-x-auto\" onPaste={handlePasteFromExcel} tabIndex={0} style={{ outline: 'none' }}>\n              <div className=\"max-h-[calc(100vh-180px)] overflow-y-auto\">\n                <table className=\"w-full text-xs\">\n                  <thead className=\"bg-gray-50 sticky top-0 z-10\">\n                    <tr className=\"border-b border-gray-200\">\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 w-10\">#</th>\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[100px] sm:min-w-[120px]\">\n                        í’ˆëª©<span className=\"text-red-500\">*</span>\n                      </th>\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[250px] sm:min-w-[320px]\">ê·œê²©</th>\n                      <th className=\"px-2 py-2 text-center font-medium text-gray-700 w-20\">\n                        ìˆ˜ëŸ‰<span className=\"text-red-500\">*</span>\n                      </th>\n                      <th className=\"px-2 py-2 text-right font-medium text-gray-700 w-[140px] sm:w-[160px]\">\n                        ë‹¨ê°€ ({currency})\n                      </th>\n                      <th className=\"px-2 py-2 text-right font-medium text-gray-700 min-w-[110px] sm:min-w-[140px]\">\n                        í•©ê³„ ({currency})\n                      </th>\n                      {paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" && (\n                        <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[120px] sm:min-w-[150px]\">ë§í¬</th>\n                      )}\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[100px] sm:min-w-[150px]\">ë¹„ê³ </th>\n                      <th className=\"px-2 py-2 text-center font-medium text-gray-700 w-10\"></th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white\">\n                    {fields.map((item, idx) => (\n                      <tr key={idx} className=\"border-b border-gray-100 hover:bg-gray-50\">\n                        <td className=\"px-2 py-1 text-center text-gray-500\">{idx + 1}</td>\n                        {/* í’ˆëª© */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"item_name\"\n                            value={item.item_name}\n                            onChange={(e) => update(idx, { ...item, item_name: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"í’ˆëª©ëª… ì…ë ¥\"\n                          />\n                        </td>\n\n                        {/* ê·œê²© */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"specification\"\n                            value={item.specification}\n                            onChange={(e) => update(idx, { ...item, specification: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"ê·œê²© ì…ë ¥\"\n                          />\n                        </td>\n\n                        {/* ìˆ˜ëŸ‰ */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"quantity\"\n                            type=\"number\"\n                            min=\"1\"\n                            value={item.quantity || ''}\n                            className=\"h-7 w-20 bg-white border border-gray-200 text-xs text-center [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n                            placeholder=\"0\"\n                            onChange={(e) => {\n                              const newQuantity = parseInt(e.target.value) || 0;\n                              update(idx, { ...item, quantity: newQuantity });\n                            }}\n                          />\n                        </td>\n\n                        {/* ë‹¨ê°€ */}\n                        <td className=\"px-2 py-1\">\n                          <div className=\"flex items-center\">\n                            <Input\n                              data-row-index={idx}\n                              data-field-name=\"unit_price_value\"\n                              type=\"text\"\n                              inputMode=\"decimal\"\n                              value={inputValues[`${idx}_unit_price_value`] ?? (item.unit_price_value === 0 ? \"\" : item.unit_price_value?.toLocaleString('ko-KR') || \"\")}\n                              onChange={(e) => {\n                                const raw = e.target.value.replace(/,/g, \"\");\n                                // ìˆ«ìì™€ ì†Œìˆ˜ì ë§Œ í—ˆìš©\n                                const cleanValue = raw.replace(/[^0-9.]/g, '');\n                                // ì†Œìˆ˜ì  ì¤‘ë³µ ë°©ì§€\n                                const parts = cleanValue.split('.');\n                                const finalValue = parts.length > 2 ? parts[0] + '.' + parts.slice(1).join('') : cleanValue;\n                                \n                                // ì…ë ¥ ì¤‘ì¸ ê°’ ì €ì¥ (ì†Œìˆ˜ì  ìœ ì§€)\n                                setInputValues(prev => ({...prev, [`${idx}_unit_price_value`]: finalValue}));\n                                \n                                // ê³„ì‚°ìš© ìˆ«ì ê°’ ì €ì¥\n                                const numVal = finalValue === '' ? 0 : parseFloat(finalValue) || 0;\n                                update(idx, { ...item, unit_price_value: numVal });\n                              }}\n                              onBlur={() => {\n                                // í¬ì»¤ìŠ¤ ë²—ì–´ë‚  ë•Œ ì…ë ¥ê°’ ì •ë¦¬\n                                setInputValues(prev => {\n                                  const newState = {...prev};\n                                  delete newState[`${idx}_unit_price_value`];\n                                  return newState;\n                                });\n                              }}\n                              className=\"h-7 w-32 bg-white border border-gray-200 text-xs text-right\"\n                              placeholder=\"0\"\n                            />\n                            <span className=\"ml-1 text-xs text-gray-500\">{currency === \"KRW\" ? \"â‚©\" : \"$\"}</span>\n                          </div>\n                        </td>\n\n                        {/* í•©ê³„ */}\n                        <td className=\"px-2 py-1\">\n                          <div className=\"flex items-center justify-end\">\n                            <span className=\"text-xs text-right font-medium\">\n                              {(item.amount_value || 0).toLocaleString('ko-KR')}\n                            </span>\n                            <span className=\"ml-1 text-xs text-gray-500\">{currency === \"KRW\" ? \"â‚©\" : \"$\"}</span>\n                          </div>\n                        </td>\n\n                        {/* ë§í¬ (êµ¬ë§¤ìš”ì²­ì¼ ë•Œë§Œ) */}\n                        {paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" && (\n                          <td className=\"px-2 py-1\">\n                            <Input\n                              data-row-index={idx}\n                              data-field-name=\"link\"\n                              value={item.link || ''}\n                              onChange={(e) => update(idx, { ...item, link: e.target.value })}\n                              type=\"url\"\n                              className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                              placeholder=\"https://...\"\n                            />\n                          </td>\n                        )}\n\n                        {/* ë¹„ê³  */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"remark\"\n                            value={item.remark || ''}\n                            onChange={(e) => update(idx, { ...item, remark: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"ë¹„ê³ \"\n                          />\n                        </td>\n                        {/* ì‚­ì œ ë²„íŠ¼ */}\n                        <td className=\"px-2 py-1 text-center\">\n                          {fields.length > 1 && (\n                            <Button\n                              type=\"button\"\n                              onClick={() => remove(idx)}\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              className=\"h-6 w-6 p-0 hover:bg-red-50\"\n                            >\n                              <X className=\"w-3 h-3 text-red-600\" />\n                            </Button>\n                          )}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n          \n          {/* ì œì¶œ ë²„íŠ¼ */}\n          <div className=\"flex justify-end gap-3 mt-2\">\n            <Button \n              type=\"button\" \n              variant=\"outline\"\n              onClick={() => navigate(-1)}\n              className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-400\"\n            >\n              ì·¨ì†Œ\n            </Button>\n            <Button \n              type=\"submit\"\n              disabled={loading || !isFormValid}\n              className=\"button-base bg-hansl-600 hover:bg-hansl-700 text-white\"\n            >\n              {loading ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                  ì²˜ë¦¬ ì¤‘...\n                </>\n              ) : (\n                <>\n                  <Save className=\"w-4 h-4 mr-2\" />\n                  ë°œì£¼ìš”ì²­\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {/* ì—ëŸ¬ ë©”ì‹œì§€ */}\n      {error && (\n        <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm\">\n          {error}\n        </div>\n      )}\n\n      {/* ë‹´ë‹¹ì ê´€ë¦¬ ëª¨ë‹¬ */}\n      <Dialog open={isContactDialogOpen} onOpenChange={setIsContactDialogOpen}>\n        <DialogContent className=\"w-full max-w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>ë‹´ë‹¹ì ê´€ë¦¬</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {contactsForEdit.map((contact, index) => (\n              <div key={index} className=\"flex gap-2 items-end\">\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì´ë¦„</Label>\n                  <Input\n                    value={contact.contact_name}\n                    onChange={(e) => handleContactChange(index, 'contact_name', e.target.value)}\n                    placeholder=\"ë‹´ë‹¹ì ì´ë¦„\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì´ë©”ì¼</Label>\n                  <Input\n                    value={contact.contact_email}\n                    onChange={(e) => handleContactChange(index, 'contact_email', e.target.value)}\n                    placeholder=\"ì´ë©”ì¼\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì „í™”ë²ˆí˜¸</Label>\n                  <Input\n                    value={contact.contact_phone}\n                    onChange={(e) => handleContactChange(index, 'contact_phone', e.target.value)}\n                    placeholder=\"ì „í™”ë²ˆí˜¸\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì§ì±…</Label>\n                  <Input\n                    value={contact.position}\n                    onChange={(e) => handleContactChange(index, 'position', e.target.value)}\n                    placeholder=\"ì§ì±…\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <Button\n                  type=\"button\"\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => removeContactSlot(index)}\n                  className=\"h-9 px-2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            ))}\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={addNewContactSlot}\n              size=\"sm\"\n            >\n              <Plus className=\"h-4 w-4 mr-1\" />\n              ë‹´ë‹¹ì ì¶”ê°€\n            </Button>\n            <DialogClose asChild>\n              <Button type=\"button\" variant=\"outline\" size=\"sm\">\n                ì·¨ì†Œ\n              </Button>\n            </DialogClose>\n            <Button\n              type=\"button\"\n              onClick={handleSaveAllContacts}\n              disabled={!hasChanges}\n              size=\"sm\"\n            >\n              ì €ì¥\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </form>\n  );\n}\n"],"names":["Copy","createLucideIcon","width","height","x","y","rx","ry","key","d","PurchaseNewMain","navigate","useNavigate","supabase","createClient","user","setUser","useState","employeeName","setEmployeeName","employees","setEmployees","defaultRequesterLoaded","setDefaultRequesterLoaded","addCount","setAddCount","vendorSearchTerm","setVendorSearchTerm","boards","setBoards","selectedBoard","setSelectedBoard","productionQuantity","setProductionQuantity","useEffect","async","data","auth","getUser","error","from","select","order","loadBoards","length","map","dbEmp","id","name","email","phone","address","position","department","find","emp","currentUser","err","loadEmployees","vendors","setVendors","contacts","setContacts","vendor","setVendor","selectedContacts","setSelectedContacts","currency","setCurrency","loading","setLoading","setError","inputValues","setInputValues","isContactDialogOpen","setIsContactDialogOpen","contactsForEdit","setContactsForEdit","hasChanges","setHasChanges","isSubmittingRef","useRef","isCopied","setIsCopied","control","handleSubmit","rhHandleSubmit","watch","setValue","reset","getValues","useFormRH","defaultValues","progress_type","payment_category","po_template_type","request_type","sales_order_number","project_vendor","project_item","delivery_request_date","vendor_id","requester_name","items","line_number","item_name","specification","quantity","unit_price_value","unit_price_currency","amount_value","amount_currency","remark","link","request_date","Date","toISOString","slice","fields","append","remove","update","replace","useFieldArray","empData","eq","single","loadUserName","employeeData","setTimeout","shouldValidate","shouldDirty","fallbackName","split","setDefaultRequester","toast","loadVendors","selectedVendor","loadContacts","updatedItems","item","forEach","idx","calcAmount","Number","f","join","handleBoardSelect","selected","confirm","label","value","bomRows","set_count","success","warning","checkRequiredFields","requestType","progressType","paymentCategory","vendorId","isFormValid","setIsFormValid","generatePurchaseOrderNumber","prefix","getTime","existingOrders","queryError","like","ascending","nextNumber","maxSequence","parts","purchase_order_number","sequenceStr","sequence","parseInt","isNaN","safeNextNumber","String","padStart","currentEmployee","current","prId","purchaseOrderNumber","maxRetries","retryCount","pr","prError","insert","requester_id","requester_phone","requester_fax","requester_address","is_payment_completed","total_amount","reduce","sum","i","contact_id","message","includes","Error","Promise","resolve","Math","random","retryError","entries","itemErr","purchase_request_id","notifyResponse","fetch","method","headers","ok","json","text","notifyError","invalidatePurchaseMemoryCache","routerError","window","location","href","totalAmount","handleContactChange","index","field","prev","contact","jsxs","onSubmit","e","preventDefault","onKeyDown","keyCode","children","className","jsx","Label","onClick","ReactSelect","options","b","board_name","onChange","placeholder","isClearable","isSearchable","menuPortalTarget","document","body","styles","base","minHeight","fontSize","backgroundColor","borderColor","borderRadius","boxShadow","menuPortal","zIndex","menu","minWidth","whiteSpace","option","padding","color","indicatorSeparator","display","Input","type","min","newQty","target","Button","size","variant","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","v","toString","vendor_name","opt","closeMenuOnSelect","classNamePrefix","blurInputOnSelect","openMenuOnFocus","openMenuOnClick","tabSelectsValue","captureMenuScroll","pageSize","container","maxHeight","background","border","margin","alignItems","verticalAlign","lineHeight","valueContainer","justifyContent","input","top","singleValue","transform","indicatorsContainer","dropdownIndicator","clearIndicator","existingContacts","c","isNew","contact_name","contact_email","contact_phone","val","defaultValue","selectedOption","employee","noOptionsMessage","filterOption","inputValue","toLowerCase","Package","style","toLocaleString","disabled","showCopiedFeedback","rows","baseRow","push","tsvData","navigator","clipboard","writeText","textArea","createElement","left","appendChild","execCommand","removeChild","fallbackErr","Fragment","Check","_idx","max","Plus","onPaste","clipboardData","getData","stopPropagation","filter","row","trim","currentItems","startIndex","startFieldName","activeElement","targetInput","tagName","targetElement","element","parentElement","rowIndexAttr","getAttribute","parsedIndex","parent","tbody","rowIndex","Array","indexOf","fieldNameAttr","FIELDS","startColIndex","maxRowIndex","rIndex","columns","targetRowIndex","currentItem","colValue","cIndex","targetColIndex","fieldName","cleanValue","qty","price","parseFloat","targetIdx","newRows","tabIndex","outline","newQuantity","inputMode","finalValue","numVal","onBlur","newState","X","Save","Dialog","open","onOpenChange","DialogContent","DialogHeader","DialogTitle","_","removeContactSlot","DialogFooter","DialogClose","asChild","endsWith","alert"],"mappings":"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","x_google_ignoreList":[0]}