{"version":3,"file":"SupportMain-xa1gv7PT.js","sources":["../../node_modules/lucide-react/dist/esm/icons/image-plus.js","../../node_modules/lucide-react/dist/esm/icons/send.js","../../src/components/ui/date-range-picker.tsx","../../src/components/support/SupportMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M16 5h6\", key: \"1vod17\" }],\n  [\"path\", { d: \"M19 2v6\", key: \"4bpg5p\" }],\n  [\"path\", { d: \"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5\", key: \"1ue2ih\" }],\n  [\"path\", { d: \"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\", key: \"1xmnt7\" }],\n  [\"circle\", { cx: \"9\", cy: \"9\", r: \"2\", key: \"af1f0g\" }]\n];\nconst ImagePlus = createLucideIcon(\"image-plus\", __iconNode);\n\nexport { __iconNode, ImagePlus as default };\n//# sourceMappingURL=image-plus.js.map\n","/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",\n      key: \"1ffxy3\"\n    }\n  ],\n  [\"path\", { d: \"m21.854 2.147-10.94 10.939\", key: \"12cjpa\" }]\n];\nconst Send = createLucideIcon(\"send\", __iconNode);\n\nexport { __iconNode, Send as default };\n//# sourceMappingURL=send.js.map\n","import * as React from \"react\"\nimport { CalendarIcon, X } from \"lucide-react\"\nimport { DateRange } from \"react-day-picker\"\nimport { ko } from \"date-fns/locale\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Calendar } from \"@/components/ui/calendar\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\n\ninterface DateRangePickerProps extends React.HTMLAttributes<HTMLDivElement> {\n  date?: DateRange\n  onDateChange?: (date: DateRange | undefined) => void\n  placeholder?: string\n  disabled?: boolean\n}\n\nexport function DateRangePicker({\n  className,\n  date,\n  onDateChange,\n  placeholder = \"ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”\",\n  disabled = false,\n  ...props\n}: DateRangePickerProps) {\n  const [open, setOpen] = React.useState(false)\n\n  const formatDateRange = (range: DateRange | undefined) => {\n    if (!range?.from) {\n      return placeholder\n    }\n\n    const formatDate = (date: Date) => {\n      return date.toLocaleDateString('ko-KR', {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      })\n    }\n\n    if (range.from && range.to) {\n      // ê°™ì€ ë‹¬ì¸ì§€ í™•ì¸\n      const isSameMonth = range.from.getFullYear() === range.to.getFullYear() && \n                         range.from.getMonth() === range.to.getMonth()\n      \n      if (isSameMonth) {\n        const year = range.from.getFullYear()\n        const month = range.from.toLocaleDateString('ko-KR', { month: 'long' })\n        const fromDay = range.from.getDate()\n        const toDay = range.to.getDate()\n        return `${year}ë…„ ${month} ${fromDay}ì¼ - ${toDay}ì¼`\n      }\n      \n      return `${formatDate(range.from)} - ${formatDate(range.to)}`\n    }\n\n    return formatDate(range.from)\n  }\n\n  return (\n    <div className={cn(\"grid gap-2\", className)} {...props}>\n      <Popover open={open} onOpenChange={setOpen}>\n        <PopoverTrigger asChild>\n          <Button\n            id=\"date\"\n            variant=\"outline\"\n            className={cn(\n              \"w-full justify-start text-left font-normal h-9 text-sm border-gray-200 hover:border-gray-300 hover:bg-gray-50 transition-colors\",\n              !date && \"text-gray-500\",\n              date && \"text-gray-900\"\n            )}\n            disabled={disabled}\n          >\n            <CalendarIcon className=\"mr-2 h-4 w-4 text-gray-400\" />\n            <span className=\"truncate\">{formatDateRange(date)}</span>\n            {date && (\n              <X \n                className=\"ml-auto h-4 w-4 text-gray-400 hover:text-gray-600 transition-colors\" \n                onClick={(e) => {\n                  e.stopPropagation()\n                  onDateChange?.(undefined)\n                  setOpen(false)\n                }}\n              />\n            )}\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent className=\"w-auto p-0 shadow-lg border border-gray-200\" align=\"start\">\n          <div className=\"bg-white rounded-lg overflow-hidden\">\n            <div className=\"bg-gray-50 border-b border-gray-100 px-4 py-3\">\n              <h4 className=\"text-sm font-medium text-gray-900\">ê¸°ê°„ ì„ íƒ</h4>\n              <p className=\"text-xs text-gray-500 mt-1\">ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ì„ íƒí•˜ì„¸ìš”</p>\n            </div>\n            <div className=\"p-4\">\n              <Calendar\n                initialFocus\n                mode=\"range\"\n                defaultMonth={date?.from}\n                selected={date}\n                onSelect={(newDate) => {\n                  onDateChange?.(newDate)\n                  // ì¢…ë£Œì¼ì´ ì„ íƒë˜ë©´ ìë™ìœ¼ë¡œ íŒì˜¤ë²„ ë‹«ê¸°\n                  if (newDate?.from && newDate?.to) {\n                    setOpen(false)\n                  }\n                }}\n                numberOfMonths={2}\n                disabled={disabled}\n                locale={ko}\n                className=\"rounded-md\"\n                classNames={{\n                  months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n                  month: \"space-y-4\",\n                  caption: \"flex justify-center pt-1 relative items-center text-sm font-medium\",\n                  caption_label: \"text-sm font-medium text-gray-900\",\n                  nav: \"space-x-1 flex items-center\",\n                  nav_button: \"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none border border-input bg-background hover:bg-accent hover:text-accent-foreground h-7 w-7\",\n                  nav_button_previous: \"absolute left-1\",\n                  nav_button_next: \"absolute right-1\",\n                  table: \"w-full border-collapse space-y-1\",\n                  head_row: \"flex\",\n                  head_cell: \"text-gray-500 rounded-md w-9 font-normal text-[0.8rem]\",\n                  row: \"flex w-full mt-2\",\n                  cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n                  day: \"inline-flex items-center justify-center rounded-md text-sm font-normal ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 aria-selected:opacity-100 h-9 w-9 hover:bg-gray-100 hover:text-gray-900 text-gray-900\",\n                  day_range_start: \"day-range-start bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                  day_range_end: \"day-range-end bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                  day_selected: \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n                  day_today: \"bg-accent text-accent-foreground font-semibold\",\n                  outside: \"!text-gray-400 !opacity-40 hover:!text-gray-500 hover:bg-gray-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30\",\n                  day_disabled: \"!text-gray-400 !opacity-40\",\n                  day_range_middle: \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n                  day_hidden: \"invisible\",\n                }}\n              />\n            </div>\n            {date && (\n              <div className=\"bg-gray-50 border-t border-gray-100 px-4 py-3\">\n                <div className=\"flex items-center justify-between\">\n                  <span className=\"text-xs text-gray-600\">\n                    ì„ íƒëœ ê¸°ê°„: {formatDateRange(date)}\n                  </span>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => {\n                      onDateChange?.(undefined)\n                      setOpen(false)\n                    }}\n                    className=\"h-6 px-2 text-xs\"\n                  >\n                    ì§€ìš°ê¸°\n                  </Button>\n                </div>\n              </div>\n            )}\n          </div>\n        </PopoverContent>\n      </Popover>\n    </div>\n  )\n}","import React, { useState, useEffect, useLayoutEffect, useRef } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'\nimport { MessageCircle, Send, Calendar, Search, CheckCircle, Clock, AlertCircle, ChevronRight, ChevronLeft, ChevronDown, ChevronUp, Eye, X, Edit2, Trash2, Save, ImagePlus, Loader2 } from 'lucide-react'\nimport { supportService, type SupportInquiry, type SupportAttachment, type SupportInquiryMessage } from '@/services/supportService'\nimport { createClient } from '@/lib/supabase/client'\nimport { toast } from 'sonner'\nimport { removePurchaseFromMemory } from '@/stores/purchaseMemoryStore'\nimport { format } from 'date-fns'\nimport { ko } from 'date-fns/locale'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '@/components/ui/alert-dialog'\nimport { DateRangePicker } from '@/components/ui/date-range-picker'\nimport { DateRange } from 'react-day-picker'\nimport PurchaseDetailModal from '@/components/purchase/PurchaseDetailModal'\n\nexport default function SupportMain() {\n  const [inquiryType, setInquiryType] = useState('')\n  const [subject, setSubject] = useState('')\n  const [message, setMessage] = useState('')\n  const [loading, setLoading] = useState(false)\n  \n  // ì²¨ë¶€íŒŒì¼ ê´€ë ¨\n  const [attachments, setAttachments] = useState<SupportAttachment[]>([])\n  const [uploadingImage, setUploadingImage] = useState(false)\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  \n  // ë°œì£¼ìš”ì²­ ì„ íƒ ê´€ë ¨\n  const [showPurchaseSelect, setShowPurchaseSelect] = useState(false)\n  const [dateRange, setDateRange] = useState<DateRange | undefined>()\n  const [purchaseRequests, setPurchaseRequests] = useState<any[]>([])\n  const [selectedPurchase, setSelectedPurchase] = useState<any>(null)\n  const [searchingPurchase, setSearchingPurchase] = useState(false)\n  const [currentPage, setCurrentPage] = useState(1)\n  const [expandedPurchase, setExpandedPurchase] = useState<string | null>(null)\n  const itemsPerPage = 5\n  \n  // ë¬¸ì˜ ëª©ë¡ ê´€ë ¨\n  const [inquiries, setInquiries] = useState<SupportInquiry[]>([])\n  const [isAdmin, setIsAdmin] = useState<boolean | null>(null)\n  const [currentUserEmail, setCurrentUserEmail] = useState('')\n  const [currentUserId, setCurrentUserId] = useState<string>('')\n  const [currentUserRoles, setCurrentUserRoles] = useState<string[]>([])\n  const [loadingInquiries, setLoadingInquiries] = useState(true)\n  const [expandedInquiry, setExpandedInquiry] = useState<number | null>(null)\n  \n  // ëª¨ë‹¬ ê´€ë ¨\n  const [showDetailModal, setShowDetailModal] = useState(false)\n  const [selectedInquiryDetail, setSelectedInquiryDetail] = useState<any>(null)\n  const [loadingDetail, setLoadingDetail] = useState(false)\n  const [editingItemId, setEditingItemId] = useState<string | null>(null)\n  const [editingItem, setEditingItem] = useState<any>(null)\n\n  // ì „ì²´í•­ëª© íƒ­ ìƒì„¸ëª¨ë‹¬(PurchaseDetailModal) ì¬ì‚¬ìš©\n  const [purchaseDetailModalOpen, setPurchaseDetailModalOpen] = useState(false)\n  const [purchaseDetailId, setPurchaseDetailId] = useState<number | null>(null)\n  const [deleteConfirmOpen, setDeleteConfirmOpen] = useState(false)\n  const [purchaseToDelete, setPurchaseToDelete] = useState<any>(null)\n  const [purchaseMissingOpen, setPurchaseMissingOpen] = useState(false)\n  const [purchaseMissingMessage, setPurchaseMissingMessage] = useState('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n\n  // ì±„íŒ…(ëŒ€í™”) ë“œë¡­ë‹¤ìš´(í™•ì¥ ì˜ì—­ ë‚´)\n  const [chatMessages, setChatMessages] = useState<SupportInquiryMessage[]>([])\n  const [chatLoading, setChatLoading] = useState(false)\n  const [chatRefreshing, setChatRefreshing] = useState(false)\n  const [chatText, setChatText] = useState('')\n  const [chatSending, setChatSending] = useState(false)\n  const chatScrollRef = useRef<HTMLDivElement>(null)\n  const chatScrollRestoreRef = useRef<{ atBottom: boolean; prevTop: number } | null>(null)\n  const chatFirstLoadInquiryIdRef = useRef<number | null>(null)\n  const chatForceBottomOnOpenRef = useRef(false)\n  const chatMessagesCacheRef = useRef<Map<number, SupportInquiryMessage[]>>(new Map())\n\n  // ì´ˆê¸° ê¶Œí•œ/ëª©ë¡ ë¡œë“œëŠ” ë§ˆìš´íŠ¸ 1íšŒë§Œ (ë“œë¡­ë‹¤ìš´ í† ê¸€ë¡œ ì¬ì‹¤í–‰ë˜ë©´ ê¹œë¹¡ì„ ë°œìƒ)\n  useEffect(() => {\n    checkUserRole()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  // ì‹¤ì‹œê°„ êµ¬ë…ì€ ê¶Œí•œ/ì‚¬ìš©ì ì •ë³´ê°€ ì¤€ë¹„ëœ í›„ì—ë§Œ ì„¸íŒ… (expandedInquiry ë³€í™”ë¡œëŠ” ì¬êµ¬ë…í•˜ì§€ ì•ŠìŒ)\n  useEffect(() => {\n    if (isAdmin === null) return\n    // ì‹¤ì‹œê°„ êµ¬ë… ì„¤ì •\n    const subscription = supportService.subscribeToInquiries((payload) => {\n      const eventType = payload?.eventType as 'INSERT' | 'UPDATE' | 'DELETE' | undefined\n      const newRow = payload?.new as SupportInquiry | undefined\n      const oldRow = payload?.old as SupportInquiry | undefined\n\n      const isRelevantRow = (row?: SupportInquiry) => {\n        if (!row) return false\n        if (isAdmin) return true\n        return !!currentUserId && row.user_id === currentUserId\n      }\n\n      // ì´ë²¤íŠ¸ì— ë”°ë¼ inquiries stateë¥¼ ì§ì ‘ ê°±ì‹  (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì—†ì´ ì‹¤ì‹œê°„ ë°˜ì˜)\n      if (eventType === 'DELETE') {\n        const deletedId = oldRow?.id\n        if (!deletedId) return\n        setInquiries(prev => {\n          const next = prev.filter(i => i.id !== deletedId)\n          return next\n        })\n        if (expandedInquiry === deletedId) {\n          setExpandedInquiry(null)\n        }\n        return\n      }\n\n      // INSERT/UPDATE\n      const row = newRow\n      if (!row?.id) return\n\n      setInquiries(prev => {\n        // ë¹„ê´€ë¦¬ìëŠ” ë‚´ ë¬¸ì˜ë§Œ ìœ ì§€\n        const relevant = isRelevantRow(row)\n        const idx = prev.findIndex(i => i.id === row.id)\n\n        // ê´€ë ¨ ì—†ëŠ” rowë©´ ê¸°ì¡´ì— ìˆë˜ ê²ƒë§Œ ì œê±°\n        if (!relevant) {\n          if (idx === -1) return prev\n          const next = prev.filter(i => i.id !== row.id)\n          return next\n        }\n\n        // upsert\n        const next = [...prev]\n        if (idx >= 0) {\n          next[idx] = row\n        } else {\n          next.unshift(row)\n        }\n\n        // ìµœì‹ ìˆœ ì •ë ¬ (created_at ë‚´ë¦¼ì°¨ìˆœ)\n        next.sort((a, b) => {\n          const at = a.created_at ? new Date(a.created_at).getTime() : 0\n          const bt = b.created_at ? new Date(b.created_at).getTime() : 0\n          return bt - at\n        })\n        return next\n      })\n    })\n    \n    return () => {\n      subscription.unsubscribe()\n    }\n  }, [isAdmin, currentUserId])\n\n  // ì‚¬ìš©ì ê¶Œí•œ í™•ì¸\n  const checkUserRole = async () => {\n    const supabase = createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return\n\n    setCurrentUserEmail(user.email || '')\n    setCurrentUserId(user.id)\n\n    const { data: employee } = await supabase\n      .from('employees')\n      .select('purchase_role')\n      .eq('email', user.email)\n      .single()\n\n    if (employee) {\n      const roles = Array.isArray(employee.purchase_role)\n        ? employee.purchase_role\n        : employee.purchase_role?.split(',').map((r: string) => r.trim()) || []\n      \n      setCurrentUserRoles(roles)\n      const adminStatus = roles.includes('app_admin')\n      setIsAdmin(adminStatus)\n      \n      // ê¶Œí•œ í™•ì¸ í›„ ë°”ë¡œ ëª©ë¡ ë¡œë“œ\n      loadInquiriesWithRole(adminStatus)\n    }\n  }\n  \n  // ì—­í• ì— ë”°ë¼ ë¬¸ì˜ ëª©ë¡ ë¡œë“œ (ë‚´ë¶€ í•¨ìˆ˜)\n  const loadInquiriesWithRole = async (adminStatus: boolean) => {\n    setLoadingInquiries(true)\n    \n    const result = adminStatus \n      ? await supportService.getAllInquiries()\n      : await supportService.getMyInquiries()\n    \n    \n    if (result.success) {\n      setInquiries(result.data)\n    } else {\n      toast.error(result.error || 'ë¬¸ì˜ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨')\n    }\n    \n    setLoadingInquiries(false)\n  }\n\n  // ë¬¸ì˜ ëª©ë¡ ë¡œë“œ\n  const loadInquiries = async () => {\n    // ê¶Œí•œ í™•ì¸ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìœ¼ë©´ ëŒ€ê¸°\n    if (isAdmin === null) {\n      return;\n    }\n    \n    setLoadingInquiries(true)\n    \n    // ê´€ë¦¬ìë©´ ëª¨ë“  ë¬¸ì˜, ì•„ë‹ˆë©´ ë‚´ ë¬¸ì˜ë§Œ\n    const result = isAdmin \n      ? await supportService.getAllInquiries()\n      : await supportService.getMyInquiries()\n    \n    \n    if (result.success) {\n      setInquiries(result.data)\n    } else {\n      toast.error(result.error || 'ë¬¸ì˜ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨')\n    }\n    \n    setLoadingInquiries(false)\n  }\n\n  // ë¬¸ì˜ ìœ í˜• ë³€ê²½ ì‹œ\n  useEffect(() => {\n    if (inquiryType === 'modify' || inquiryType === 'delete') {\n      setShowPurchaseSelect(true)\n    } else {\n      setShowPurchaseSelect(false)\n      setSelectedPurchase(null)\n    }\n  }, [inquiryType])\n\n  // ë°œì£¼ìš”ì²­ ê²€ìƒ‰\n  const searchPurchaseRequests = async () => {\n    setSearchingPurchase(true)\n    setCurrentPage(1) // ê²€ìƒ‰ ì‹œ ì²« í˜ì´ì§€ë¡œ ë¦¬ì…‹\n    \n    const startDate = dateRange?.from ? dateRange.from.toISOString().split('T')[0] : undefined\n    const endDate = dateRange?.to ? dateRange.to.toISOString().split('T')[0] : undefined\n    \n    const result = await supportService.getMyPurchaseRequests(startDate, endDate)\n    \n    if (result.success) {\n      setPurchaseRequests(result.data)\n    } else {\n      toast.error(result.error || 'ë°œì£¼ìš”ì²­ ì¡°íšŒ ì‹¤íŒ¨')\n    }\n    \n    setSearchingPurchase(false)\n  }\n\n  // í˜ì´ì§€ë„¤ì´ì…˜ ê³„ì‚°\n  const totalPages = Math.ceil(purchaseRequests.length / itemsPerPage)\n  const startIndex = (currentPage - 1) * itemsPerPage\n  const endIndex = startIndex + itemsPerPage\n  const currentPurchaseRequests = purchaseRequests.slice(startIndex, endIndex)\n\n  // ë¬¸ì˜ ì œì¶œ\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    \n    if (!inquiryType || !subject || !message) {\n      toast.error('ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.')\n      return\n    }\n    \n    // ìˆ˜ì •/ì‚­ì œ ìš”ì²­ì¸ë° ë°œì£¼ë¥¼ ì„ íƒí•˜ì§€ ì•Šì€ ê²½ìš°\n    if ((inquiryType === 'modify' || inquiryType === 'delete') && !selectedPurchase) {\n      toast.error('ìˆ˜ì •/ì‚­ì œí•  ë°œì£¼ìš”ì²­ì„ ì„ íƒí•´ì£¼ì„¸ìš”.')\n      return\n    }\n\n    setLoading(true)\n    \n    // ë°œì£¼ ì •ë³´ë¥¼ í…ìŠ¤íŠ¸ë¡œ êµ¬ì„±\n    let finalMessage = message;\n    let purchaseInfo = '';\n    \n    if (selectedPurchase) {\n      const items = selectedPurchase.purchase_request_items || [];\n      const itemsText = items.map((item: any) => \n        `- ${item.item_name} (${item.specification}) ${item.quantity}ê°œ`\n      ).join('\\n');\n      \n      const poNumberText = selectedPurchase.purchase_order_number || '(ìŠ¹ì¸ëŒ€ê¸°)'\n      purchaseInfo = `ë°œì£¼ë²ˆí˜¸: ${selectedPurchase.purchase_order_number}\nì—…ì²´: ${selectedPurchase.vendor_name}\nìš”ì²­ì: ${selectedPurchase.requester_name}\nìš”ì²­ì¼: ${selectedPurchase.request_date}\ní’ˆëª©:\n${itemsText}`;\n      purchaseInfo = `ë°œì£¼ë²ˆí˜¸: ${poNumberText}\nì—…ì²´: ${selectedPurchase.vendor_name}\nìš”ì²­ì: ${selectedPurchase.requester_name}\nìš”ì²­ì¼: ${selectedPurchase.request_date || selectedPurchase.created_at || '-'}\ní’ˆëª©:\n${itemsText}`;\n\n      finalMessage = `${message}\n\n[ê´€ë ¨ ë°œì£¼ ì •ë³´]\n${purchaseInfo}`;\n    }\n\n    const result = await supportService.createInquiry({\n      inquiry_type: inquiryType as any,\n      subject,\n      message: finalMessage,\n      purchase_request_id: selectedPurchase?.id,\n      purchase_info: purchaseInfo,\n      purchase_order_number: selectedPurchase?.purchase_order_number,\n      attachments: attachments\n    })\n\n    if (result.success) {\n      toast.success('ë¬¸ì˜ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      const createdId = result.inquiryId\n      // í¼ ì´ˆê¸°í™”\n      setInquiryType('')\n      setSubject('')\n      setMessage('')\n      setSelectedPurchase(null)\n      setPurchaseRequests([])\n      setDateRange(undefined)\n      setAttachments([])\n      // ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      loadInquiries()\n\n      // âœ… ìƒì„±ëœ ë¬¸ì˜ë¥¼ í¼ì³ì„œ(ë“œë¡­ë‹¤ìš´) ë°”ë¡œ ëŒ€í™”ì°½ì´ ë³´ì´ê²Œ\n      if (createdId) {\n        setExpandedInquiry(createdId)\n      }\n    } else {\n      toast.error(result.error || 'ë¬¸ì˜ ì ‘ìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')\n    }\n    \n    setLoading(false)\n  }\n\n  // ì´ë¯¸ì§€ ì²¨ë¶€ í•¸ë“¤ëŸ¬\n  const handleImageSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = e.target.files\n    if (!files || files.length === 0) return\n\n    // ìµœëŒ€ 5ê°œ ì œí•œ\n    if (attachments.length >= 5) {\n      toast.error('ì²¨ë¶€íŒŒì¼ì€ ìµœëŒ€ 5ê°œê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤.')\n      return\n    }\n\n    const file = files[0]\n    \n    // íŒŒì¼ í¬ê¸° ì œí•œ (5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      toast.error('íŒŒì¼ í¬ê¸°ëŠ” 5MB ì´í•˜ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.')\n      return\n    }\n\n    // ì´ë¯¸ì§€ íƒ€ì… í™•ì¸\n    if (!file.type.startsWith('image/')) {\n      toast.error('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì²¨ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.')\n      return\n    }\n\n    setUploadingImage(true)\n    const result = await supportService.uploadAttachment(file)\n    \n    if (result.success && result.data) {\n      setAttachments(prev => [...prev, result.data!])\n      toast.success('ì´ë¯¸ì§€ê°€ ì²¨ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.')\n    } else {\n      toast.error(result.error || 'ì´ë¯¸ì§€ ì—…ë¡œë“œ ì‹¤íŒ¨')\n    }\n    \n    setUploadingImage(false)\n    \n    // input ì´ˆê¸°í™” (ê°™ì€ íŒŒì¼ ë‹¤ì‹œ ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡)\n    if (fileInputRef.current) {\n      fileInputRef.current.value = ''\n    }\n  }\n\n  // ì²¨ë¶€íŒŒì¼ ì‚­ì œ í•¸ë“¤ëŸ¬\n  const handleRemoveAttachment = async (index: number) => {\n    const attachment = attachments[index]\n    \n    // Storageì—ì„œ ì‚­ì œ\n    await supportService.deleteAttachment(attachment.path)\n    \n    // stateì—ì„œ ì œê±°\n    setAttachments(prev => prev.filter((_, i) => i !== index))\n    toast.success('ì²¨ë¶€íŒŒì¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n  }\n\n  // ë¬¸ì˜ ìƒíƒœ ì—…ë°ì´íŠ¸ (ê´€ë¦¬ììš©)\n  const handleStatusUpdate = async (inquiryId: number, newStatus: 'in_progress' | 'resolved' | 'closed', resolutionNote?: string) => {\n    if (newStatus === 'resolved') {\n      // âœ… ì…ë ¥ ì—†ì´ ì™„ë£Œ ì²˜ë¦¬ + ì‚¬ìš©ìì—ê²Œ \"ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤\" ì•Œë¦¼ + ë¡œê·¸ ê¸°ë¡(DB í•¨ìˆ˜)\n      const result = await supportService.resolveInquiry(inquiryId)\n      if (result.success) {\n        toast.success('ë¬¸ì˜ê°€ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n        loadInquiries()\n      } else {\n        toast.error(result.error || 'ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨')\n      }\n    } else {\n      const result = await supportService.updateInquiryStatus(inquiryId, newStatus)\n      \n      if (result.success) {\n        toast.success('ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.')\n        loadInquiries()\n      } else {\n        toast.error(result.error || 'ìƒíƒœ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨')\n      }\n    }\n  }\n\n  const expandedInquiryObj = inquiries.find((i) => i.id === expandedInquiry) || null\n\n  // í™•ì¥ëœ ë¬¸ì˜ì— ëŒ€í•´ ë©”ì‹œì§€ ë¡œë“œ + ì‹¤ì‹œê°„ êµ¬ë… + (ì‚¬ìš©ì) ì•Œë¦¼ ì½ìŒ ì²˜ë¦¬\n  useEffect(() => {\n    if (!expandedInquiryObj?.id) return\n    const inquiryId = expandedInquiryObj.id!\n\n    let cancelled = false\n    // ë“œë¡­ë‹¤ìš´ ì²« ì˜¤í”ˆ ì‹œì—ëŠ” ë¬´ì¡°ê±´ ë§¨ ì•„ë˜ë¡œ\n    chatForceBottomOnOpenRef.current = true\n    const cached = chatMessagesCacheRef.current.get(inquiryId)\n    if (cached && cached.length > 0) {\n      // ìºì‹œê°€ ìˆìœ¼ë©´ ì¦‰ì‹œ í‘œì‹œ(ê¹œë¹¡ì„/ë¹ˆ í™”ë©´ ì—†ìŒ)\n      setChatMessages(cached)\n      setChatLoading(false)\n      setChatRefreshing(true)\n    } else {\n      // ìºì‹œê°€ ì—†ìœ¼ë©´ ì´ˆê¸° ë¡œë”© ìŠ¤í”¼ë„ˆ\n      setChatMessages([])\n      setChatLoading(true)\n      setChatRefreshing(false)\n    }\n\n    const load = async () => {\n      // ìºì‹œê°€ ìˆì„ ë•ŒëŠ” UIë¥¼ ìœ ì§€í•œ ì±„ë¡œ ë°±ê·¸ë¼ìš´ë“œ ê°±ì‹ ë§Œ í‘œì‹œ\n      const hasCached = (chatMessagesCacheRef.current.get(inquiryId)?.length ?? 0) > 0\n      if (hasCached) setChatRefreshing(true)\n      else setChatLoading(true)\n\n      const result = await supportService.getInquiryMessages(inquiryId)\n      if (!cancelled) {\n        if (result.success) {\n          const el = chatScrollRef.current\n          const prevTop = el?.scrollTop ?? 0\n          const isFirstLoad = chatFirstLoadInquiryIdRef.current !== inquiryId\n          chatFirstLoadInquiryIdRef.current = inquiryId\n\n          const atBottom = isFirstLoad\n            ? true\n            : (el ? (el.scrollHeight - el.scrollTop - el.clientHeight) < 80 : true)\n\n          chatScrollRestoreRef.current = { atBottom, prevTop }\n\n          setChatMessages(result.data)\n          chatMessagesCacheRef.current.set(inquiryId, result.data)\n          setChatLoading(false)\n          setChatRefreshing(false)\n        } else {\n          toast.error(result.error || 'ëŒ€í™” ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.')\n          setChatLoading(false)\n          setChatRefreshing(false)\n        }\n      }\n    }\n\n    // ì‚¬ìš©ì: í•´ë‹¹ ë¬¸ì˜ ì•Œë¦¼(ì•ˆì½ìŒ) ì²˜ë¦¬\n    const markAsRead = async () => {\n      if (isAdmin) return\n      if (!currentUserEmail) return\n      const supabase = createClient()\n      await supabase\n        .from('notifications')\n        .update({ is_read: true, read_at: new Date().toISOString() })\n        .eq('user_email', currentUserEmail)\n        .eq('is_read', false)\n        .in('type', ['inquiry_message', 'inquiry_resolved'])\n        .eq('data->>inquiryId', String(inquiryId))\n    }\n\n    load()\n    markAsRead()\n\n    const subscription = supportService.subscribeToInquiryMessages(inquiryId, () => {\n      load()\n    })\n\n    return () => {\n      cancelled = true\n      subscription.unsubscribe()\n    }\n  }, [expandedInquiryObj?.id, isAdmin, currentUserEmail])\n\n  // chatMessagesê°€ DOMì— ë°˜ì˜ëœ ì§í›„(useLayoutEffect)ì— ìŠ¤í¬ë¡¤ì„ ë³´ì •\n  // NOTE: expandedInquiryObj ì„ ì–¸ ì´í›„ì— ìœ„ì¹˜í•´ì•¼ TDZ(ì´ˆê¸°í™” ì „ ì°¸ì¡°) ì—ëŸ¬ê°€ ë‚˜ì§€ ì•ŠìŒ\n  useLayoutEffect(() => {\n    if (!expandedInquiryObj?.id) return\n    const el = chatScrollRef.current\n    if (!el) return\n\n    if (chatForceBottomOnOpenRef.current) {\n      el.scrollTop = el.scrollHeight\n      // ì‹¤ì œ ì½˜í…ì¸ ê°€ ë Œë”ëœ ìƒíƒœ(ë˜ëŠ” ë¡œë”© ì¢…ë£Œ)ì—ì„œë§Œ ê°•ì œ í”Œë˜ê·¸ë¥¼ ë‚´ë¦¼\n      // ë„ˆë¬´ ì¼ì° falseê°€ ë˜ë©´, ì´í›„ ë©”ì‹œì§€ DOMì´ ë¶™ì„ ë•Œ ë‹¤ì‹œ ë§¨ ìœ„ë¡œ ë‚¨ëŠ” ë¬¸ì œê°€ ìƒê¹€\n      if (chatMessages.length > 0 || !chatLoading) {\n        chatForceBottomOnOpenRef.current = false\n      }\n    } else {\n      const restore = chatScrollRestoreRef.current\n      if (!restore) return\n      if (restore.atBottom) el.scrollTop = el.scrollHeight\n      else el.scrollTop = restore.prevTop\n    }\n  }, [expandedInquiryObj?.id, chatMessages, chatLoading])\n\n  const handleSendChat = async () => {\n    if (!expandedInquiryObj?.id) return\n    if (!chatText.trim()) {\n      toast.error('ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.')\n      return\n    }\n    if (expandedInquiryObj.status === 'resolved' || expandedInquiryObj.status === 'closed') {\n      toast.error('ì™„ë£Œëœ ë¬¸ì˜ì—ëŠ” ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    setChatSending(true)\n    const result = await supportService.sendInquiryMessage({\n      inquiryId: expandedInquiryObj.id!,\n      message: chatText.trim(),\n      senderRole: isAdmin ? 'admin' : 'user'\n    })\n\n    if (result.success) {\n      setChatText('')\n    } else {\n      toast.error(result.error || 'ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨')\n    }\n    setChatSending(false)\n  }\n\n  const handleResolveFromChat = async () => {\n    if (!expandedInquiryObj?.id) return\n    const result = await supportService.resolveInquiry(expandedInquiryObj.id!)\n    if (result.success) {\n      toast.success('ë¬¸ì˜ê°€ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      setChatText('')\n      setExpandedInquiry(null)\n      loadInquiries()\n    } else {\n      toast.error(result.error || 'ì™„ë£Œ ì²˜ë¦¬ ì‹¤íŒ¨')\n    }\n  }\n\n  // ë¬¸ì˜ ì‚­ì œ\n  const handleDeleteInquiry = async (inquiryId: number) => {\n    if (!confirm('ì •ë§ë¡œ ì´ ë¬¸ì˜ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\nì‚­ì œëœ ë¬¸ì˜ëŠ” ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return\n\n    const result = await supportService.deleteInquiry(inquiryId)\n    \n    if (result.success) {\n      toast.success('ë¬¸ì˜ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n      loadInquiries()\n    } else {\n      toast.error(result.error || 'ë¬¸ì˜ ì‚­ì œ ì‹¤íŒ¨')\n    }\n  }\n\n  // ë¬¸ì˜ ìƒì„¸ ë³´ê¸°\n  const viewInquiryDetail = (inquiry: SupportInquiry) => {\n    setSelectedInquiryDetail(inquiry)\n    setShowDetailModal(true)\n  }\n\n  const openPurchaseDetailFromInquiry = async (inquiry: SupportInquiry) => {\n    try {\n      // 1) ê°€ì¥ ì •í™•í•œ ê°’: purchase_request_id (ì‹ ê·œ ë¬¸ì˜ë¶€í„° ì €ì¥ë¨)\n      if (inquiry.purchase_request_id) {\n        setPurchaseDetailId(inquiry.purchase_request_id)\n        setPurchaseDetailModalOpen(true)\n        return\n      }\n\n      // 2) ê³¼ê±° ë°ì´í„° í˜¸í™˜: purchase_order_numberë¡œ purchase_requestsì—ì„œ id ì¡°íšŒ\n      const orderNumber = inquiry.purchase_order_number?.trim()\n      if (!orderNumber) {\n        setPurchaseMissingMessage('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n        setPurchaseMissingOpen(true)\n        return\n      }\n\n      const supabase = createClient()\n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select('id')\n        .eq('purchase_order_number', orderNumber)\n        .limit(1)\n        .maybeSingle()\n\n      if (error) throw error\n      if (!data?.id) {\n        setPurchaseMissingMessage('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n        setPurchaseMissingOpen(true)\n        return\n      }\n\n      setPurchaseDetailId(data.id)\n      setPurchaseDetailModalOpen(true)\n    } catch (e) {\n      setPurchaseMissingMessage('ë°œì£¼ë‚´ì—­ì´ ì‚­ì œ ë˜ì—ˆê±°ë‚˜ ì—†ìŠµë‹ˆë‹¤.')\n      setPurchaseMissingOpen(true)\n    }\n  }\n\n  // í’ˆëª© ìˆ˜ì • ì‹œì‘\n  const startEditItem = (item: any) => {\n    setEditingItemId(item.id)\n    setEditingItem({\n      item_name: item.item_name,\n      specification: item.specification,\n      quantity: item.quantity,\n      unit_price_value: item.unit_price_value,\n      remark: item.remark\n    })\n  }\n\n  // í’ˆëª© ìˆ˜ì • ì·¨ì†Œ\n  const cancelEditItem = () => {\n    setEditingItemId(null)\n    setEditingItem(null)\n  }\n\n  // í’ˆëª© ìˆ˜ì • ì €ì¥\n  const saveEditItem = async (itemId: string) => {\n    if (!editingItem) return\n\n    const totalPrice = (editingItem.quantity || 0) * (editingItem.unit_price_value || 0)\n    const result = await supportService.updatePurchaseRequestItem(itemId, {\n      item_name: editingItem.item_name,\n      specification: editingItem.specification,\n      quantity: editingItem.quantity,\n      unit_price_value: editingItem.unit_price_value,\n      amount_value: totalPrice,\n      remark: editingItem.remark\n    })\n\n    if (result.success) {\n      toast.success('í’ˆëª©ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      // ëª©ë¡ ìƒˆë¡œê³ ì¹¨ - ìƒì„¸ ì •ë³´ê°€ ìˆë‹¤ë©´ ë‹¤ì‹œ ë¡œë“œ\n      if (selectedInquiryDetail?.id) {\n        // Refresh logic can be implemented here if needed\n      }\n      cancelEditItem()\n    } else {\n      toast.error(result.error || 'í’ˆëª© ìˆ˜ì • ì‹¤íŒ¨')\n    }\n  }\n\n  // í’ˆëª© ì‚­ì œ\n  const deleteItem = async (itemId: string) => {\n    if (!confirm('ì´ í’ˆëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return\n\n    const result = await supportService.deletePurchaseRequestItem(itemId)\n\n    if (result.success) {\n      toast.success('í’ˆëª©ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n      // ëª©ë¡ ìƒˆë¡œê³ ì¹¨ - ìƒì„¸ ì •ë³´ê°€ ìˆë‹¤ë©´ ë‹¤ì‹œ ë¡œë“œ\n      if (selectedInquiryDetail?.id) {\n        // Refresh logic can be implemented here if needed\n      }\n    } else {\n      toast.error(result.error || 'í’ˆëª© ì‚­ì œ ì‹¤íŒ¨')\n    }\n  }\n\n  // ë°œì£¼ìš”ì²­ ì „ì²´ ì‚­ì œ\n  const deletePurchaseRequest = async () => {\n    if (!selectedInquiryDetail?.id) return\n    if (!confirm('ì´ ë°œì£¼ìš”ì²­ ì „ì²´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\nëª¨ë“  í’ˆëª©ì´ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.')) return\n\n    const result = await supportService.deletePurchaseRequest(selectedInquiryDetail.id)\n\n    if (result.success) {\n      // ğŸš€ ë©”ëª¨ë¦¬ ìºì‹œì—ì„œ ì¦‰ì‹œ ì‚­ì œ (ì‹¤ì‹œê°„ ë°˜ì˜)\n      const memoryUpdated = removePurchaseFromMemory(selectedInquiryDetail.id)\n      if (!memoryUpdated) {\n        console.warn('[deletePurchaseRequest] ë©”ëª¨ë¦¬ ìºì‹œì—ì„œ ë°œì£¼ì„œ ì‚­ì œ ì‹¤íŒ¨', { \n          purchaseId: selectedInquiryDetail.id \n        })\n      } else {\n        console.info('âœ… [deletePurchaseRequest] ë©”ëª¨ë¦¬ ìºì‹œì—ì„œ ë°œì£¼ì„œ ì‚­ì œ ì„±ê³µ', { \n          purchaseId: selectedInquiryDetail.id \n        })\n      }\n\n      toast.success('ë°œì£¼ìš”ì²­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.')\n      setShowDetailModal(false)\n      setSelectedInquiryDetail(null)\n      // ë¬¸ì˜ ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      loadInquiries()\n    } else {\n      toast.error(result.error || 'ë°œì£¼ìš”ì²­ ì‚­ì œ ì‹¤íŒ¨')\n    }\n  }\n\n  const handleConfirmDeleteFromPurchaseModal = async () => {\n    if (!purchaseToDelete?.id) {\n      toast.error('ì‚­ì œí•  ë°œì£¼ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    const supabase = createClient()\n\n    try {\n      const purchaseIdForDelete =\n        typeof purchaseToDelete.id === 'string' ? parseInt(purchaseToDelete.id, 10) : purchaseToDelete.id\n\n      if (!purchaseIdForDelete || Number.isNaN(purchaseIdForDelete)) {\n        toast.error('ë°œì£¼ IDê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.')\n        return\n      }\n\n      // 1) ë¬¸ì˜ ê¸°ë¡ ë³´ì¡´: support_inquiresì—ì„œ purchase_request_idë§Œ nullë¡œ ë³€ê²½\n      const { error: inquiryUpdateError } = await supabase\n        .from('support_inquires')\n        .update({ purchase_request_id: null })\n        .eq('purchase_request_id', purchaseIdForDelete)\n\n      if (inquiryUpdateError) {\n        // ì—¬ê¸°ì„œ ë§‰ì§€ ì•Šê³  ê³„ì† ì§„í–‰í•˜ë©´ FKë¡œ ì‚­ì œê°€ ì‹¤íŒ¨í•  ìˆ˜ ìˆì–´ ì¤‘ë‹¨í•˜ëŠ” í¸ì´ ì•ˆì „\n        throw inquiryUpdateError\n      }\n\n      // 2) í’ˆëª© ì‚­ì œ\n      const { error: itemsError } = await supabase\n        .from('purchase_request_items')\n        .delete()\n        .eq('purchase_request_id', purchaseIdForDelete)\n      if (itemsError) throw itemsError\n\n      // 3) ë°œì£¼ìš”ì²­ ì‚­ì œ\n      const { error: requestError } = await supabase\n        .from('purchase_requests')\n        .delete()\n        .eq('id', purchaseIdForDelete)\n      if (requestError) throw requestError\n\n      // 4) ë©”ëª¨ë¦¬ ìºì‹œ ì¦‰ì‹œ ë°˜ì˜\n      removePurchaseFromMemory(purchaseIdForDelete)\n\n      toast.success('ë°œì£¼ìš”ì²­ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. (ë¬¸ì˜ ê¸°ë¡ì€ ë³´ì¡´ë©ë‹ˆë‹¤)')\n\n      // UI ì •ë¦¬\n      setDeleteConfirmOpen(false)\n      setPurchaseToDelete(null)\n      setPurchaseDetailModalOpen(false)\n      setPurchaseDetailId(null)\n\n      // ë¬¸ì˜ ëª©ë¡ ê°±ì‹ \n      loadInquiries()\n    } catch (e) {\n      toast.error(e instanceof Error ? e.message : 'ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    } finally {\n      setDeleteConfirmOpen(false)\n      setPurchaseToDelete(null)\n    }\n  }\n\n  // ìƒíƒœ ë°°ì§€ ìŠ¤íƒ€ì¼\n  const getStatusBadge = (status?: string) => {\n    switch (status) {\n      case 'open':\n        return <span className=\"badge-stats bg-yellow-100 text-yellow-800\">ëŒ€ê¸°</span>\n      case 'in_progress':\n        return <span className=\"badge-stats bg-blue-100 text-blue-800\">ì²˜ë¦¬ì¤‘</span>\n      case 'resolved':\n        return <span className=\"badge-stats bg-green-100 text-green-800\">ì™„ë£Œ</span>\n      case 'closed':\n        return <span className=\"badge-stats bg-gray-100 text-gray-800\">ì¢…ë£Œ</span>\n      default:\n        return <span className=\"badge-stats border border-gray-300 bg-white text-gray-600\">-</span>\n    }\n  }\n\n  // ë¬¸ì˜ ìœ í˜• ë¼ë²¨\n  const getInquiryTypeLabel = (type: string) => {\n    switch (type) {\n      case 'bug': return 'ì˜¤ë¥˜ ì‹ ê³ '\n      case 'modify': return 'ìˆ˜ì • ìš”ì²­'\n      case 'delete': return 'ì‚­ì œ ìš”ì²­'\n      case 'other': return 'ê¸°íƒ€ ë¬¸ì˜'\n      default: return type\n    }\n  }\n\n  // ê¶Œí•œ í™•ì¸ ì¤‘ì¼ ë•Œ ë¡œë”© í‘œì‹œ\n  if (isAdmin === null) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">ê¶Œí•œ í™•ì¸ ì¤‘...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"w-full\">\n        {/* í—¤ë” */}\n        <div className=\"mb-4\">\n          <h1 className=\"page-title text-gray-900\">ë¬¸ì˜í•˜ê¸°</h1>\n          <p className=\"page-subtitle text-gray-600 mt-1\">\n            {isAdmin \n              ? 'ëª¨ë“  ë¬¸ì˜ë¥¼ ê´€ë¦¬í•˜ê³  ë‹µë³€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤'\n              : 'ì‹œìŠ¤í…œ ì‚¬ìš© ì¤‘ ê¶ê¸ˆí•˜ì‹  ì ì´ë‚˜ ê°œì„ ì‚¬í•­ì„ ì•Œë ¤ì£¼ì„¸ìš”'}\n          </p>\n        </div>\n\n        <div className={`${isAdmin ? 'max-w-4xl' : 'grid grid-cols-1 xl:grid-cols-2 gap-4'}`}>\n          {/* ë¬¸ì˜ ì‘ì„± í¼ - app_adminì´ ì•„ë‹Œ ê²½ìš°ì—ë§Œ í‘œì‹œ */}\n          {!isAdmin && (\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <MessageCircle className=\"w-5 h-5\" />\n                  ë¬¸ì˜ ë‚´ìš©\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-1\">\n                    ë¬¸ì˜ ìœ í˜• <span className=\"text-red-500\">*</span>\n                  </label>\n                  <Select value={inquiryType} onValueChange={setInquiryType}>\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"ë¬¸ì˜ ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"bug\">ì˜¤ë¥˜ ì‹ ê³ </SelectItem>\n                      <SelectItem value=\"modify\">ìˆ˜ì • ìš”ì²­</SelectItem>\n                      <SelectItem value=\"delete\">ì‚­ì œ ìš”ì²­</SelectItem>\n                      <SelectItem value=\"other\">ê¸°íƒ€ ë¬¸ì˜</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* ìˆ˜ì •/ì‚­ì œ ìš”ì²­ ì‹œ ë°œì£¼ìš”ì²­ ì„ íƒ */}\n                {showPurchaseSelect && (\n                  <div className=\"space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200\">\n                    <div className=\"modal-label text-blue-900\">\n                      ìˆ˜ì •/ì‚­ì œí•  ë°œì£¼ìš”ì²­ ì„ íƒ\n                    </div>\n                    \n                    <div>\n                      <label className=\"modal-label text-gray-600 mb-2 block\">ê¸°ê°„ ì„ íƒ</label>\n                      <DateRangePicker\n                        date={dateRange}\n                        onDateChange={setDateRange}\n                        placeholder=\"ë°œì£¼ìš”ì²­ ê¸°ê°„ì„ ì„ íƒí•˜ì„¸ìš”\"\n                        className=\"w-full\"\n                      />\n                    </div>\n                    \n                    <Button\n                      type=\"button\"\n                      onClick={searchPurchaseRequests}\n                      disabled={searchingPurchase}\n                      className=\"w-full h-9\"\n                      variant=\"outline\"\n                    >\n                      {searchingPurchase ? (\n                        <>\n                          <div className=\"w-4 h-4 border-2 border-gray-600 border-t-transparent rounded-full animate-spin mr-2\" />\n                          ê²€ìƒ‰ ì¤‘...\n                        </>\n                      ) : (\n                        <>\n                          <Search className=\"w-4 h-4 mr-2\" />\n                          ë°œì£¼ìš”ì²­ ê²€ìƒ‰\n                        </>\n                      )}\n                    </Button>\n                    \n                    {purchaseRequests.length > 0 && (\n                      <div className=\"space-y-3\">\n                        <div className=\"modal-label text-gray-600\">\n                          ë°œì£¼ìš”ì²­ ì„ íƒ (ì´ {purchaseRequests.length}ê±´)\n                        </div>\n                        \n                        {/* ë°œì£¼ìš”ì²­ ë¦¬ìŠ¤íŠ¸ */}\n                        <div className=\"space-y-1\">\n                          {currentPurchaseRequests.map((pr) => (\n                            <div key={pr.id} className=\"border rounded overflow-hidden\">\n                              <div\n                                onClick={() => setSelectedPurchase(pr)}\n                                className={`px-3 py-2 cursor-pointer transition-all badge-text ${\n                                  selectedPurchase?.id === pr.id\n                                    ? 'border-blue-500 bg-blue-50'\n                                    : 'hover:bg-gray-50'\n                                }`}\n                              >\n                                <div className=\"flex items-center justify-between gap-2\">\n                                  <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                                    <span className=\"modal-value whitespace-nowrap\">\n                                      {pr.purchase_order_number || '(ìŠ¹ì¸ëŒ€ê¸°)'}\n                                    </span>\n                                    {(pr.final_manager_status && pr.final_manager_status !== 'approved') && (\n                                      <span\n                                        className={`badge-stats whitespace-nowrap ${\n                                          pr.final_manager_status === 'rejected' || pr.middle_manager_status === 'rejected'\n                                            ? 'bg-red-100 text-red-800'\n                                            : 'bg-yellow-100 text-yellow-800'\n                                        }`}\n                                      >\n                                        {pr.final_manager_status === 'rejected' || pr.middle_manager_status === 'rejected'\n                                          ? 'ë°˜ë ¤'\n                                          : 'ìŠ¹ì¸ëŒ€ê¸°'}\n                                      </span>\n                                    )}\n                                    <span className=\"text-gray-600 truncate\">\n                                      {pr.vendor_name}\n                                    </span>\n                                    <span className=\"text-gray-500\">\n                                      {pr.purchase_request_items?.[0]?.item_name || 'í’ˆëª© ì—†ìŒ'}\n                                      {pr.purchase_request_items?.length > 1 && (\n                                        <span className=\"modal-value text-blue-600\">\n                                          {` ì™¸ ${pr.purchase_request_items.length - 1}ê±´`}\n                                        </span>\n                                      )}\n                                    </span>\n                                    <span className=\"text-gray-400 whitespace-nowrap ml-auto\">\n                                      {(pr.request_date || pr.created_at) && format(new Date(pr.request_date || pr.created_at), 'MM/dd')}\n                                    </span>\n                                  </div>\n                                  <div className=\"flex items-center gap-1\">\n                                    {selectedPurchase?.id === pr.id && (\n                                      <CheckCircle className=\"w-4 h-4 text-blue-500 flex-shrink-0\" />\n                                    )}\n                                    {pr.purchase_request_items?.length > 1 && (\n                                      <button\n                                        type=\"button\"\n                                        onClick={(e) => {\n                                          e.stopPropagation()\n                                          setExpandedPurchase(expandedPurchase === pr.id ? null : pr.id)\n                                        }}\n                                        className=\"p-1 hover:bg-gray-200 rounded\"\n                                      >\n                                        {expandedPurchase === pr.id ? (\n                                          <ChevronUp className=\"w-4 h-4\" />\n                                        ) : (\n                                          <ChevronDown className=\"w-4 h-4\" />\n                                        )}\n                                      </button>\n                                    )}\n                                  </div>\n                                </div>\n                              </div>\n                              \n                              {/* ìƒì„¸ í’ˆëª© ëª©ë¡ */}\n                              {expandedPurchase === pr.id && pr.purchase_request_items?.length > 0 && (\n                                <div className=\"px-3 py-2 bg-gray-50 border-t badge-text\">\n                                  <div className=\"space-y-1\">\n                                    <div className=\"modal-value text-gray-700 mb-1\">í’ˆëª© ìƒì„¸</div>\n                                    {pr.purchase_request_items.map((item: any, index: number) => (\n                                      <div key={index} className=\"flex items-center gap-2 text-gray-600 pl-2\">\n                                        <span className=\"text-gray-400\">{index + 1}.</span>\n                                        <span>{item.item_name}</span>\n                                        {item.specification && (\n                                          <span className=\"text-gray-500\">({item.specification})</span>\n                                        )}\n                                        <span className=\"text-gray-500\">- {item.quantity}ê°œ</span>\n                                      </div>\n                                    ))}\n                                  </div>\n                                </div>\n                              )}\n                            </div>\n                          ))}\n                        </div>\n                        \n                        {/* í˜ì´ì§€ë„¤ì´ì…˜ */}\n                        {totalPages > 1 && (\n                          <div className=\"flex justify-center items-center gap-1 pt-2\">\n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                              disabled={currentPage === 1}\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <ChevronLeft className=\"w-4 h-4\" />\n                            </Button>\n                            \n                            {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\n                              <Button\n                                key={page}\n                                type=\"button\"\n                                variant={currentPage === page ? \"default\" : \"outline\"}\n                                size=\"sm\"\n                                onClick={() => setCurrentPage(page)}\n                                className=\"h-8 w-8 p-0\"\n                              >\n                                {page}\n                              </Button>\n                            ))}\n                            \n                            <Button\n                              type=\"button\"\n                              variant=\"outline\"\n                              size=\"sm\"\n                              onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\n                              disabled={currentPage === totalPages}\n                              className=\"h-8 w-8 p-0\"\n                            >\n                              <ChevronRight className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-1\">\n                    ì œëª© <span className=\"text-red-500\">*</span>\n                  </label>\n                  <Input\n                    value={subject}\n                    onChange={(e) => setSubject(e.target.value)}\n                    placeholder=\"ë¬¸ì˜ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”\"\n                    maxLength={100}\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-1\">\n                    ë‚´ìš© <span className=\"text-red-500\">*</span>\n                  </label>\n                  <Textarea\n                    value={message}\n                    onChange={(e) => setMessage(e.target.value)}\n                    placeholder=\"ë¬¸ì˜ ë‚´ìš©ì„ ìì„¸íˆ ì…ë ¥í•´ì£¼ì„¸ìš”\"\n                    rows={6}\n                    maxLength={1000}\n                  />\n                  <p className=\"badge-text text-gray-500 mt-1\">\n                    {message.length}/1000\n                  </p>\n                </div>\n\n                {/* ì‚¬ì§„ ì²¨ë¶€ ì˜ì—­ */}\n                <div>\n                  <label className=\"block modal-label text-gray-700 mb-2\">\n                    ì‚¬ì§„ ì²¨ë¶€ <span className=\"badge-text text-gray-400\">(ì„ íƒ, ìµœëŒ€ 5ê°œ)</span>\n                  </label>\n                  \n                  {/* ì²¨ë¶€ëœ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° */}\n                  {attachments.length > 0 && (\n                    <div className=\"flex flex-wrap gap-2 mb-3\">\n                      {attachments.map((attachment, index) => (\n                        <div key={index} className=\"relative group\">\n                          <img\n                            src={attachment.url}\n                            alt={attachment.name}\n                            className=\"w-20 h-20 object-cover rounded-lg border border-gray-200\"\n                          />\n                          <button\n                            type=\"button\"\n                            onClick={() => handleRemoveAttachment(index)}\n                            className=\"absolute -top-2 -right-2 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\"\n                            title=\"ì‚­ì œ\"\n                          >\n                            <X className=\"w-3 h-3\" />\n                          </button>\n                          <p className=\"text-[10px] text-gray-500 mt-1 truncate w-20 text-center\">\n                            {attachment.name}\n                          </p>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                  \n                  {/* ì´ë¯¸ì§€ ì¶”ê°€ ë²„íŠ¼ */}\n                  {attachments.length < 5 && (\n                    <div className=\"flex items-center gap-2\">\n                      <input\n                        ref={fileInputRef}\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={handleImageSelect}\n                        className=\"hidden\"\n                      />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        disabled={uploadingImage}\n                        className=\"button-action-secondary disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {uploadingImage ? (\n                          <>\n                            <Loader2 className=\"w-3.5 h-3.5 animate-spin\" />\n                            ì—…ë¡œë“œ ì¤‘...\n                          </>\n                        ) : (\n                          <>\n                            <ImagePlus className=\"w-3.5 h-3.5\" />\n                            ì‚¬ì§„ ì¶”ê°€\n                          </>\n                        )}\n                      </button>\n                      <span className=\"badge-text text-gray-400\">\n                        {attachments.length}/5\n                      </span>\n                    </div>\n                  )}\n                </div>\n\n                <Button \n                  type=\"submit\" \n                  className=\"w-full\"\n                  disabled={loading || uploadingImage}\n                >\n                  {loading ? (\n                    <>\n                      <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                      ì „ì†¡ ì¤‘...\n                    </>\n                  ) : (\n                    <>\n                      <Send className=\"w-4 h-4 mr-2\" />\n                      ë¬¸ì˜ ë³´ë‚´ê¸°\n                    </>\n                  )}\n                </Button>\n              </form>\n            </CardContent>\n          </Card>\n          )}\n\n          {/* ë¬¸ì˜ ëª©ë¡ */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <span className=\"flex items-center gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-orange-500\" />\n                  {isAdmin ? 'ì „ì²´ ë¬¸ì˜ ëª©ë¡' : 'ë‚´ ë¬¸ì˜ ë‚´ì—­'}\n                </span>\n                <span className=\"badge-stats border border-gray-300 bg-white text-gray-600\">\n                  {inquiries.length}ê±´\n                </span>\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              {loadingInquiries ? (\n                <div className=\"flex items-center justify-center py-8\">\n                  <div className=\"w-6 h-6 border-2 border-gray-300 border-t-transparent rounded-full animate-spin\" />\n                </div>\n              ) : inquiries.length === 0 ? (\n                <div className=\"text-center py-8 text-gray-500\">\n                  <MessageCircle className=\"w-12 h-12 mx-auto mb-3 text-gray-300\" />\n                  <p className=\"text-sm\">ë¬¸ì˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤</p>\n                </div>\n              ) : (\n                <div className=\"space-y-1 max-h-[600px] overflow-y-auto\">\n                  {inquiries.map((inquiry) => (\n                    <div key={inquiry.id!} className=\"border rounded overflow-hidden\">\n                      {/* ë¬¸ì˜ ìš”ì•½ (í•œ ì¤„) */}\n                      <div \n                        className=\"px-3 py-2 hover:bg-gray-50 transition-colors cursor-pointer\"\n                        onClick={() => {\n                          setExpandedInquiry(expandedInquiry === inquiry.id ? null : inquiry.id!)\n                        }}\n                      >\n                        <div className=\"flex items-center justify-between gap-2\">\n                          <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                            <span className=\"badge-stats border border-gray-300 bg-white text-gray-600 whitespace-nowrap\">\n                              {getInquiryTypeLabel(inquiry.inquiry_type)}\n                            </span>\n                            {getStatusBadge(inquiry.status)}\n                            <span className=\"modal-label truncate\">\n                              {inquiry.subject}\n                            </span>\n                            {isAdmin && (\n                              <span className=\"badge-text text-gray-500\">\n                                {inquiry.user_name || inquiry.user_email}\n                              </span>\n                            )}\n                            {inquiry.purchase_order_number && (\n                              <button\n                                type=\"button\"\n                                className=\"badge-text text-blue-600 hover:underline\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  openPurchaseDetailFromInquiry(inquiry)\n                                }}\n                                title=\"ë°œì£¼ ìƒì„¸ ì—´ê¸°\"\n                              >\n                                [{inquiry.purchase_order_number}]\n                              </button>\n                            )}\n                            <span className=\"badge-text text-gray-400 ml-auto whitespace-nowrap\">\n                              {inquiry.created_at && format(new Date(inquiry.created_at), 'MM/dd HH:mm')}\n                            </span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            {isAdmin && inquiry.status === 'open' && (\n                              <button\n                                type=\"button\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleStatusUpdate(inquiry.id!, 'in_progress')\n                                }}\n                                className=\"badge-stats border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-400\"\n                              >\n                                ì²˜ë¦¬ì¤‘\n                              </button>\n                            )}\n                            {isAdmin && (inquiry.status === 'open' || inquiry.status === 'in_progress') && (\n                              <button\n                                type=\"button\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleStatusUpdate(inquiry.id!, 'resolved')\n                                }}\n                                className=\"badge-stats bg-green-500 text-white hover:bg-green-600\"\n                              >\n                                ì™„ë£Œ\n                              </button>\n                            )}\n                            {/* ì‚­ì œ ë²„íŠ¼ - ê´€ë¦¬ìëŠ” ëª¨ë“  ë¬¸ì˜ ì‚­ì œ ê°€ëŠ¥, ì¼ë°˜ ì‚¬ìš©ìëŠ” ë³¸ì¸ì˜ open ìƒíƒœë§Œ */}\n                            {(isAdmin || (inquiry.status === 'open' && !inquiry.resolution_note && inquiry.user_email === currentUserEmail)) && (\n                              <Button\n                                size=\"sm\"\n                                variant=\"ghost\"\n                                onClick={(e) => {\n                                  e.stopPropagation()\n                                  handleDeleteInquiry(inquiry.id!)\n                                }}\n                                className=\"h-6 w-6 p-0 hover:bg-red-50\"\n                                title=\"ë¬¸ì˜ ì‚­ì œ\"\n                              >\n                                <Trash2 className=\"w-3 h-3 text-red-600\" />\n                              </Button>\n                            )}\n                            <button\n                              type=\"button\"\n                              className=\"p-1 hover:bg-gray-200 rounded\"\n                            >\n                              {expandedInquiry === inquiry.id ? (\n                                <ChevronUp className=\"w-4 h-4\" />\n                              ) : (\n                                <ChevronDown className=\"w-4 h-4\" />\n                              )}\n                            </button>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {/* ìƒì„¸ ë‚´ì—­ */}\n                      {expandedInquiry === inquiry.id && (\n                        <div className=\"px-3 py-3 bg-gray-50 border-t text-sm\">\n                          <div className=\"space-y-2\">\n                            <div>\n                              <span className=\"modal-value text-gray-700\">ë‚´ìš©:</span>\n                              <p className=\"text-gray-600 mt-1 whitespace-pre-wrap\">{inquiry.message}</p>\n                            </div>\n                            {inquiry.purchase_order_number && (\n                              <div>\n                                <span className=\"modal-value text-gray-700\">ê´€ë ¨ ë°œì£¼ë²ˆí˜¸:</span>\n                                <button\n                                  type=\"button\"\n                                  className=\"text-blue-600 ml-2 hover:underline\"\n                                  onClick={(e) => {\n                                    e.stopPropagation()\n                                    openPurchaseDetailFromInquiry(inquiry)\n                                  }}\n                                  title=\"ë°œì£¼ ìƒì„¸ ì—´ê¸°\"\n                                >\n                                  {inquiry.purchase_order_number}\n                                </button>\n                              </div>\n                            )}\n                            {inquiry.handled_by && (\n                              <div>\n                                <span className=\"modal-value text-gray-700\">ì²˜ë¦¬ì:</span>\n                                <span className=\"text-green-600 ml-2\">\n                                  {inquiry.handled_by}\n                                  {inquiry.processed_at && ` (${format(new Date(inquiry.processed_at), 'yyyy-MM-dd HH:mm')})`}\n                                </span>\n                              </div>\n                            )}\n                            {/* ì²¨ë¶€ ì´ë¯¸ì§€ */}\n                            {inquiry.attachments && inquiry.attachments.length > 0 && (\n                              <div>\n                                <span className=\"modal-value text-gray-700\">ì²¨ë¶€ ì´ë¯¸ì§€:</span>\n                                <div className=\"flex flex-wrap gap-2 mt-2\">\n                                  {inquiry.attachments.map((attachment, index) => (\n                                    <a\n                                      key={index}\n                                      href={attachment.url}\n                                      target=\"_blank\"\n                                      rel=\"noopener noreferrer\"\n                                      className=\"block\"\n                                      onClick={(e) => e.stopPropagation()}\n                                    >\n                                      <img\n                                        src={attachment.url}\n                                        alt={attachment.name}\n                                        className=\"w-24 h-24 object-cover rounded-lg border border-gray-200 hover:border-blue-400 transition-colors cursor-pointer\"\n                                      />\n                                    </a>\n                                  ))}\n                                </div>\n                              </div>\n                            )}\n\n                            {/* ëŒ€í™”(ë“œë¡­ë‹¤ìš´) */}\n                            <div className=\"mt-3 border-t pt-3\">\n                              <div className=\"flex items-center justify-between\">\n                                <div className=\"modal-value text-gray-800\">ëŒ€í™”</div>\n                                {isAdmin && inquiry.status !== 'resolved' && inquiry.status !== 'closed' && (\n                                  <button\n                                    type=\"button\"\n                                    onClick={(e) => {\n                                      e.stopPropagation()\n                                      handleResolveFromChat()\n                                    }}\n                                    className=\"button-action-success\"\n                                  >\n                                    ì™„ë£Œ\n                                  </button>\n                                )}\n                              </div>\n\n                              <div className=\"mt-2 border rounded-lg bg-white relative\">\n                                {chatRefreshing && (\n                                  <div\n                                    className=\"absolute top-2 right-2 text-[11px] text-gray-400 bg-white/80 backdrop-blur px-2 py-1 rounded border pointer-events-none\"\n                                    aria-hidden=\"true\"\n                                  >\n                                    ì—…ë°ì´íŠ¸ ì¤‘â€¦\n                                  </div>\n                                )}\n                                <div ref={chatScrollRef} className=\"max-h-[260px] overflow-y-auto p-3 space-y-2\">\n                                  {chatLoading && chatMessages.length === 0 ? (\n                                    <div className=\"flex items-center justify-center py-8\">\n                                      <div className=\"w-6 h-6 border-2 border-gray-300 border-t-transparent rounded-full animate-spin\" />\n                                    </div>\n                                  ) : chatMessages.length === 0 ? (\n                                    <div className=\"text-center text-gray-500 py-8\">\n                                      ëŒ€í™” ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.\n                                    </div>\n                                  ) : (\n                                    chatMessages.map((m) => {\n                                      const isSystem = m.sender_role === 'system'\n                                      const isMine = !isSystem && m.sender_email === currentUserEmail\n                                      return (\n                                        <div key={m.id} className={isSystem ? 'text-center' : `flex ${isMine ? 'justify-end' : 'justify-start'}`}>\n                                          <div className={isSystem ? 'inline-block text-xs text-gray-500 px-3 py-1 rounded-full bg-gray-50 border' : `max-w-[80%] rounded-lg px-3 py-2 ${isMine ? 'bg-blue-600 text-white' : 'bg-gray-50 border text-gray-800'}`}>\n                                            {!isSystem && (\n                                              <div className={`text-[11px] mb-1 ${isMine ? 'text-white/80' : 'text-gray-500'}`}>\n                                                {m.sender_role === 'admin' ? 'ê´€ë¦¬ì' : 'ë¬¸ì˜ì'}\n                                                {m.created_at && ` Â· ${format(new Date(m.created_at), 'MM/dd HH:mm')}`}\n                                              </div>\n                                            )}\n                                            <div className=\"whitespace-pre-wrap text-sm\">{m.message}</div>\n                                            {m.attachments && m.attachments.length > 0 && (\n                                              <div className=\"flex flex-wrap gap-2 mt-2\">\n                                                {m.attachments.map((a, idx) => (\n                                                  <a\n                                                    key={idx}\n                                                    href={a.url}\n                                                    target=\"_blank\"\n                                                    rel=\"noopener noreferrer\"\n                                                    className=\"block\"\n                                                    onClick={(e) => e.stopPropagation()}\n                                                  >\n                                                    <img\n                                                      src={a.url}\n                                                      alt={a.name}\n                                                      className=\"w-20 h-20 object-cover rounded border\"\n                                                    />\n                                                  </a>\n                                                ))}\n                                              </div>\n                                            )}\n                                          </div>\n                                        </div>\n                                      )\n                                    })\n                                  )}\n                                </div>\n\n                                <div className=\"border-t p-2\">\n                                  {(inquiry.status === 'resolved' || inquiry.status === 'closed') ? (\n                                    <div className=\"text-sm text-gray-500 text-center py-1\">\n                                      ì™„ë£Œëœ ë¬¸ì˜ì…ë‹ˆë‹¤. ì¶”ê°€ ëŒ€í™”ê°€ í•„ìš”í•˜ë©´ ìƒˆ ë¬¸ì˜ë¥¼ ë“±ë¡í•´ì£¼ì„¸ìš”.\n                                    </div>\n                                  ) : (\n                                    <div className=\"flex items-end gap-2\">\n                                      <Textarea\n                                        value={chatText}\n                                        onChange={(e) => setChatText(e.target.value)}\n                                        placeholder=\"ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”\"\n                                        rows={2}\n                                        maxLength={1000}\n                                        disabled={chatSending}\n                                        onClick={(e) => e.stopPropagation()}\n                                      />\n                                      <button\n                                        type=\"button\"\n                                        onClick={(e) => {\n                                          e.stopPropagation()\n                                          handleSendChat()\n                                        }}\n                                        disabled={chatSending || !chatText.trim()}\n                                        className=\"button-action-primary disabled:opacity-50 disabled:cursor-not-allowed\"\n                                      >\n                                        {chatSending ? 'ì „ì†¡ì¤‘' : 'ì „ì†¡'}\n                                      </button>\n                                    </div>\n                                  )}\n                                </div>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* ë°œì£¼ìš”ì²­ ìƒì„¸ ëª¨ë‹¬ */}\n      <Dialog open={showDetailModal} onOpenChange={setShowDetailModal}>\n        <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center justify-between text-lg\">\n              <div className=\"flex items-center gap-2\">\n                <span>ë°œì£¼ìš”ì²­ ìƒì„¸</span>\n                {selectedInquiryDetail?.purchase_order_number && (\n                  <span className=\"badge-stats border border-gray-300 bg-white text-gray-600 font-normal\">\n                    {selectedInquiryDetail.purchase_order_number}\n                  </span>\n                )}\n              </div>\n              {isAdmin && selectedInquiryDetail && (\n                <Button\n                  variant=\"destructive\"\n                  size=\"sm\"\n                  onClick={deletePurchaseRequest}\n                  className=\"h-8 px-3\"\n                >\n                  <Trash2 className=\"w-4 h-4 mr-1\" />\n                  ì „ì²´ ì‚­ì œ\n                </Button>\n              )}\n            </DialogTitle>\n          </DialogHeader>\n          \n          {loadingDetail ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"w-6 h-6 border-2 border-gray-300 border-t-transparent rounded-full animate-spin\" />\n            </div>\n          ) : selectedInquiryDetail && (\n            <div className=\"space-y-6\">\n              {/* ê¸°ë³¸ ì •ë³´ */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-gray-50 rounded-lg\">\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ë°œì£¼ë²ˆí˜¸</span>\n                  <p className=\"font-semibold text-sm mt-1\">{selectedInquiryDetail.purchase_order_number || 'N/A'}</p>\n                </div>\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ì—…ì²´ëª…</span>\n                  <p className=\"font-semibold text-sm mt-1\">{selectedInquiryDetail.vendor_name}</p>\n                </div>\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ìš”ì²­ì</span>\n                  <p className=\"font-semibold text-sm mt-1\">{selectedInquiryDetail.requester_name}</p>\n                </div>\n                <div>\n                  <span className=\"badge-text text-gray-500 uppercase tracking-wider\">ìš”ì²­ì¼</span>\n                  <p className=\"font-semibold text-sm mt-1\">\n                    {selectedInquiryDetail.request_date && \n                      format(new Date(selectedInquiryDetail.request_date), 'yyyy-MM-dd')}\n                  </p>\n                </div>\n              </div>\n\n              {/* í’ˆëª© ëª©ë¡ - ê°œì„ ëœ ë””ìì¸ */}\n              <div>\n                <h3 className=\"font-semibold text-base mb-3\">í’ˆëª© ìƒì„¸</h3>\n                <div className=\"border rounded-lg overflow-x-auto\">\n                  <table className=\"w-full\">\n                    <thead className=\"bg-gray-50 border-b\">\n                      <tr>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 w-12\">ë²ˆí˜¸</th>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 min-w-[180px]\">í’ˆëª…</th>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 min-w-[150px]\">ê·œê²©</th>\n                        <th className=\"text-center badge-text modal-value text-gray-700 px-3 py-3 w-20\">ìˆ˜ëŸ‰</th>\n                        <th className=\"text-right badge-text modal-value text-gray-700 px-3 py-3 w-28\">ë‹¨ê°€</th>\n                        <th className=\"text-right badge-text modal-value text-gray-700 px-3 py-3 w-32\">ê¸ˆì•¡</th>\n                        <th className=\"text-left badge-text modal-value text-gray-700 px-3 py-3 min-w-[150px]\">ë¹„ê³ </th>\n                        <th className=\"text-center badge-text modal-value text-gray-700 px-3 py-3 w-16\">ë§í¬</th>\n                        {isAdmin && <th className=\"text-center badge-text modal-value text-gray-700 px-3 py-3 w-24\">ì‘ì—…</th>}\n                      </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-gray-200\">\n                      {selectedInquiryDetail.purchase_request_items?.map((item: any, index: number) => (\n                        <tr key={item.id} className=\"hover:bg-gray-50 transition-colors\">\n                          <td className=\"text-sm px-3 py-3 text-center modal-value text-gray-600\">\n                            {item.line_number || index + 1}\n                          </td>\n                          <td className=\"text-sm px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                value={editingItem?.item_name || ''}\n                                onChange={(e) => setEditingItem({...editingItem, item_name: e.target.value})}\n                                className=\"h-9 text-sm w-full\"\n                                autoFocus\n                              />\n                            ) : (\n                              <span className=\"modal-value text-gray-900\">{item.item_name}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                value={editingItem?.specification || ''}\n                                onChange={(e) => setEditingItem({...editingItem, specification: e.target.value})}\n                                className=\"h-9 text-sm w-full\"\n                              />\n                            ) : (\n                              <span className=\"text-gray-600\">{item.specification || '-'}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-center px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                type=\"number\"\n                                value={editingItem?.quantity || ''}\n                                onChange={(e) => setEditingItem({...editingItem, quantity: parseInt(e.target.value)})}\n                                className=\"h-9 text-sm text-center w-full\"\n                              />\n                            ) : (\n                              <span className=\"modal-value\">{item.quantity}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-right px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Input\n                                type=\"number\"\n                                value={editingItem?.unit_price_value || ''}\n                                onChange={(e) => setEditingItem({...editingItem, unit_price_value: parseInt(e.target.value)})}\n                                className=\"h-9 text-sm text-right w-full\"\n                              />\n                            ) : (\n                              <span className=\"modal-value\">\n                                {item.unit_price_value ? `${parseFloat(item.unit_price_value).toLocaleString()}` : '-'}\n                              </span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-right px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <span className=\"font-semibold text-blue-600\">\n                                {((editingItem?.quantity || 0) * (editingItem?.unit_price_value || 0)).toLocaleString()}\n                              </span>\n                            ) : (\n                              <span className=\"font-semibold text-blue-600\">\n                                {item.amount_value ? `${parseFloat(item.amount_value).toLocaleString()}` : '-'}\n                              </span>\n                            )}\n                          </td>\n                          <td className=\"text-sm px-3 py-3\">\n                            {editingItemId === item.id ? (\n                              <Textarea\n                                value={editingItem?.remark || ''}\n                                onChange={(e) => setEditingItem({...editingItem, remark: e.target.value})}\n                                className=\"h-9 text-sm w-full resize-none\"\n                                rows={1}\n                              />\n                            ) : (\n                              <span className=\"text-gray-600 badge-text\">{item.remark || '-'}</span>\n                            )}\n                          </td>\n                          <td className=\"text-sm text-center px-3 py-3\">\n                            {item.link ? (\n                              <a \n                                href={item.link} \n                                target=\"_blank\" \n                                rel=\"noopener noreferrer\" \n                                className=\"inline-flex items-center justify-center w-8 h-8 rounded hover:bg-blue-50 text-blue-600\"\n                              >\n                                <Eye className=\"w-4 h-4\" />\n                              </a>\n                            ) : (\n                              <span className=\"text-gray-400\">-</span>\n                            )}\n                          </td>\n                          {isAdmin && (\n                            <td className=\"text-sm text-center px-3 py-3\">\n                              {editingItemId === item.id ? (\n                                <div className=\"flex justify-center gap-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    onClick={() => saveEditItem(item.id)}\n                                    className=\"h-8 px-2 bg-green-600 hover:bg-green-700\"\n                                  >\n                                    <Save className=\"w-4 h-4 mr-1\" />\n                                    ì €ì¥\n                                  </Button>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"outline\"\n                                    onClick={cancelEditItem}\n                                    className=\"h-8 px-2\"\n                                  >\n                                    ì·¨ì†Œ\n                                  </Button>\n                                </div>\n                              ) : (\n                                <div className=\"flex justify-center gap-1\">\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    onClick={() => startEditItem(item)}\n                                    className=\"h-8 w-8 p-0 hover:bg-blue-50\"\n                                  >\n                                    <Edit2 className=\"w-4 h-4 text-blue-600\" />\n                                  </Button>\n                                  <Button\n                                    size=\"sm\"\n                                    variant=\"ghost\"\n                                    onClick={() => deleteItem(item.id)}\n                                    className=\"h-8 w-8 p-0 hover:bg-red-50\"\n                                  >\n                                    <Trash2 className=\"w-4 h-4 text-red-600\" />\n                                  </Button>\n                                </div>\n                              )}\n                            </td>\n                          )}\n                        </tr>\n                      ))}\n                    </tbody>\n                    <tfoot className=\"bg-gray-50 border-t-2\">\n                      <tr>\n                        <td colSpan={5} className=\"text-sm font-semibold text-right px-3 py-3\">\n                          í•©ê³„\n                        </td>\n                        <td className=\"text-sm font-bold text-right px-3 py-3 text-blue-600\">\n                          {selectedInquiryDetail.purchase_request_items\n                            ?.reduce((sum: number, item: any) => sum + (parseFloat(item.amount_value) || 0), 0)\n                            .toLocaleString()}\n                        </td>\n                        <td colSpan={isAdmin ? 3 : 2} className=\"px-3 py-3\"></td>\n                      </tr>\n                    </tfoot>\n                  </table>\n                </div>\n              </div>\n\n              {/* ë¹„ê³  */}\n              {selectedInquiryDetail.notes && (\n                <div>\n                  <h3 className=\"modal-value mb-2\">ë¹„ê³ </h3>\n                  <p className=\"page-subtitle text-gray-600 p-3 bg-gray-50 rounded-lg\">\n                    {selectedInquiryDetail.notes}\n                  </p>\n                </div>\n              )}\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n      {/* ì „ì²´í•­ëª© íƒ­ ìƒì„¸ëª¨ë‹¬(ì¬ì‚¬ìš©) */}\n      <PurchaseDetailModal\n        purchaseId={purchaseDetailId}\n        isOpen={purchaseDetailModalOpen}\n        onClose={() => {\n          setPurchaseDetailModalOpen(false)\n          setPurchaseDetailId(null)\n        }}\n        currentUserRoles={currentUserRoles}\n        activeTab=\"done\"\n        onDelete={(purchase) => {\n          setPurchaseToDelete(purchase)\n          setDeleteConfirmOpen(true)\n        }}\n      />\n\n      {/* ì‚­ì œ í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ (PurchaseDetailModal ì—°ë™) */}\n      <AlertDialog\n        open={deleteConfirmOpen}\n        onOpenChange={(open) => {\n          setDeleteConfirmOpen(open)\n          if (!open) setPurchaseToDelete(null)\n        }}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>ë°œì£¼ìš”ì²­ ë‚´ì—­ ì‚­ì œ</AlertDialogTitle>\n            <AlertDialogDescription>\n              ë°œì£¼ìš”ì²­ë²ˆí˜¸ <strong>{purchaseToDelete?.purchase_order_number || 'ì•Œ ìˆ˜ ì—†ìŒ'}</strong>ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n              <br />\n              ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>ì·¨ì†Œ</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmDeleteFromPurchaseModal}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              ì‚­ì œ\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* ì‚­ì œ/ì—†ìŒ ì•ˆë‚´ ëª¨ë‹¬ (ë¬¸ì˜ì—ì„œ ë°œì£¼ë¥¼ ëª» ì°¾ëŠ” ê²½ìš°) */}\n      <Dialog open={purchaseMissingOpen} onOpenChange={setPurchaseMissingOpen}>\n        <DialogContent\n          showCloseButton={false}\n          maxWidth=\"sm:max-w-md\"\n          className=\"p-0 overflow-hidden\"\n        >\n          <div className=\"px-8 py-10 text-center\">\n            <div className=\"text-xl font-semibold text-gray-900\">ì•ˆë‚´</div>\n            <div className=\"mt-4 text-base text-gray-700 whitespace-pre-wrap\">\n              {purchaseMissingMessage}\n            </div>\n            <div className=\"mt-6 text-sm text-gray-400\">\n              í™”ë©´ì„ í´ë¦­í•˜ê±°ë‚˜ ESCë¡œ ë‹«ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  )\n}"],"names":["ImagePlus","createLucideIcon","d","key","cx","cy","r","Send","DateRangePicker","className","date","onDateChange","placeholder","disabled","props","open","setOpen","React.useState","formatDateRange","range","from","formatDate","toLocaleDateString","year","month","day","to","getFullYear","getMonth","getDate","jsx","cn","children","jsxs","Popover","onOpenChange","PopoverTrigger","asChild","Button","id","variant","CalendarIcon","X","onClick","e","stopPropagation","PopoverContent","align","Calendar","initialFocus","mode","defaultMonth","selected","onSelect","newDate","numberOfMonths","locale","ko","classNames","months","caption","caption_label","nav","nav_button","nav_button_previous","nav_button_next","table","head_row","head_cell","row","cell","day_range_start","day_range_end","day_selected","day_today","outside","day_disabled","day_range_middle","day_hidden","size","SupportMain","inquiryType","setInquiryType","useState","subject","setSubject","message","setMessage","loading","setLoading","attachments","setAttachments","uploadingImage","setUploadingImage","fileInputRef","useRef","showPurchaseSelect","setShowPurchaseSelect","dateRange","setDateRange","purchaseRequests","setPurchaseRequests","selectedPurchase","setSelectedPurchase","searchingPurchase","setSearchingPurchase","currentPage","setCurrentPage","expandedPurchase","setExpandedPurchase","inquiries","setInquiries","isAdmin","setIsAdmin","currentUserEmail","setCurrentUserEmail","currentUserId","setCurrentUserId","currentUserRoles","setCurrentUserRoles","loadingInquiries","setLoadingInquiries","expandedInquiry","setExpandedInquiry","showDetailModal","setShowDetailModal","selectedInquiryDetail","setSelectedInquiryDetail","loadingDetail","setLoadingDetail","editingItemId","setEditingItemId","editingItem","setEditingItem","purchaseDetailModalOpen","setPurchaseDetailModalOpen","purchaseDetailId","setPurchaseDetailId","deleteConfirmOpen","setDeleteConfirmOpen","purchaseToDelete","setPurchaseToDelete","purchaseMissingOpen","setPurchaseMissingOpen","purchaseMissingMessage","setPurchaseMissingMessage","chatMessages","setChatMessages","chatLoading","setChatLoading","chatRefreshing","setChatRefreshing","chatText","setChatText","chatSending","setChatSending","chatScrollRef","chatScrollRestoreRef","chatFirstLoadInquiryIdRef","chatForceBottomOnOpenRef","chatMessagesCacheRef","Map","useEffect","checkUserRole","subscription","supportService","subscribeToInquiries","payload","eventType","newRow","new","oldRow","old","deletedId","prev","filter","i","relevant","user_id","idx","findIndex","next","unshift","sort","a","b","at","created_at","Date","getTime","unsubscribe","async","supabase","createClient","data","user","auth","getUser","email","employee","select","eq","single","roles","Array","isArray","purchase_role","split","map","trim","adminStatus","includes","loadInquiriesWithRole","result","getAllInquiries","getMyInquiries","success","toast","error","loadInquiries","totalPages","Math","ceil","length","startIndex","endIndex","currentPurchaseRequests","slice","handleStatusUpdate","inquiryId","newStatus","resolutionNote","resolveInquiry","updateInquiryStatus","expandedInquiryObj","find","cancelled","current","cached","get","load","getInquiryMessages","el","prevTop","scrollTop","isFirstLoad","atBottom","scrollHeight","clientHeight","set","update","is_read","read_at","toISOString","in","String","markAsRead","subscribeToInquiryMessages","useLayoutEffect","restore","openPurchaseDetailFromInquiry","inquiry","purchase_request_id","orderNumber","purchase_order_number","limit","maybeSingle","cancelEditItem","getStatusBadge","status","getInquiryTypeLabel","type","Card","CardHeader","CardTitle","MessageCircle","CardContent","onSubmit","preventDefault","finalMessage","purchaseInfo","itemsText","purchase_request_items","item","item_name","specification","quantity","join","poNumberText","vendor_name","requester_name","request_date","createInquiry","inquiry_type","purchase_info","createdId","Select","value","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","startDate","endDate","getMyPurchaseRequests","Fragment","Search","pr","final_manager_status","middle_manager_status","format","CheckCircle","ChevronUp","ChevronDown","index","max","ChevronLeft","_","page","min","ChevronRight","Input","onChange","target","maxLength","Textarea","rows","attachment","src","url","alt","name","deleteAttachment","path","handleRemoveAttachment","title","ref","accept","files","file","startsWith","uploadAttachment","click","Loader2","AlertCircle","user_name","user_email","resolution_note","confirm","deleteInquiry","handleDeleteInquiry","Trash2","handled_by","processed_at","href","rel","handleResolveFromChat","m","isSystem","sender_role","isMine","sender_email","sendInquiryMessage","senderRole","handleSendChat","Dialog","DialogContent","DialogHeader","DialogTitle","deletePurchaseRequest","removePurchaseFromMemory","line_number","autoFocus","parseInt","unit_price_value","parseFloat","toLocaleString","amount_value","remark","link","Eye","itemId","totalPrice","updatePurchaseRequestItem","saveEditItem","Save","startEditItem","Edit2","deletePurchaseRequestItem","deleteItem","colSpan","reduce","sum","notes","PurchaseDetailModal","purchaseId","isOpen","onClose","activeTab","onDelete","purchase","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","purchaseIdForDelete","Number","isNaN","inquiryUpdateError","itemsError","delete","requestError","Error","showCloseButton","maxWidth"],"mappings":"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","x_google_ignoreList":[0,1]}