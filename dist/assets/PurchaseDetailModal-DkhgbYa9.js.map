{"version":3,"file":"PurchaseDetailModal-DkhgbYa9.js","sources":["../../node_modules/lucide-react/dist/esm/icons/truck.js","../../src/components/purchase/PurchaseDetailModal.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2\", key: \"wrbu53\" }],\n  [\"path\", { d: \"M15 18H9\", key: \"1lyqi6\" }],\n  [\n    \"path\",\n    {\n      d: \"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14\",\n      key: \"lysw3i\"\n    }\n  ],\n  [\"circle\", { cx: \"17\", cy: \"18\", r: \"2\", key: \"332jqn\" }],\n  [\"circle\", { cx: \"7\", cy: \"18\", r: \"2\", key: \"19iecd\" }]\n];\nconst Truck = createLucideIcon(\"truck\", __iconNode);\n\nexport { __iconNode, Truck as default };\n//# sourceMappingURL=truck.js.map\n","import { useEffect, useState, useRef, useCallback } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { PurchaseRequestWithDetails, Purchase } from '@/types/purchase'\nimport { formatDate } from '@/utils/helpers'\nimport { DatePickerPopover } from '@/components/ui/date-picker-popover'\nimport { \n  Calendar, \n  User, \n  Building2, \n  Package, \n  CreditCard,\n  X,\n  FileText,\n  DollarSign,\n  Edit2,\n  Trash2,\n  Save,\n  Plus,\n  CheckCircle,\n  XCircle,\n  Check,\n  Truck\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { toast } from 'sonner'\nimport { logger } from '@/lib/logger'\nimport { useConfirmDateAction } from '@/hooks/useConfirmDateAction'\nimport { format as formatDateInput } from 'date-fns'\n\ninterface PurchaseDetailModalProps {\n  purchaseId: number | null\n  isOpen: boolean\n  onClose: () => void\n  embedded?: boolean  // Dialog 없이 내용만 렌더링\n  currentUserRoles?: string[]\n  activeTab?: string\n  onRefresh?: (forceRefresh?: boolean, options?: { silent?: boolean }) => void | Promise<void>\n  onOptimisticUpdate?: (purchaseId: number, updater: (prev: Purchase) => Purchase) => void\n  onDelete?: (purchase: PurchaseRequestWithDetails) => void\n}\n\nexport default function PurchaseDetailModal({ \n  purchaseId, \n  isOpen, \n  onClose, \n  embedded = false,\n  currentUserRoles = [],\n  activeTab,\n  onRefresh,\n  onOptimisticUpdate,\n  onDelete\n}: PurchaseDetailModalProps) {\n  const [loading, setLoading] = useState(false)\n  const [purchase, setPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [isEditing, setIsEditing] = useState(false)\n  const [editedPurchase, setEditedPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [editedItems, setEditedItems] = useState<any[]>([])\n  const [deletedItemIds, setDeletedItemIds] = useState<number[]>([])\n  const [userRoles, setUserRoles] = useState<string[]>([])\n  const [currentUserName, setCurrentUserName] = useState<string>('')\n  const [columnWidths, setColumnWidths] = useState<number[]>([])\n  const headerRowRef = useRef<HTMLDivElement>(null)\n  const supabase = createClient()\n  \n  // 사용자 권한 및 이름 직접 로드\n  useEffect(() => {\n    const loadUserRoles = async () => {\n      try {\n        // Supabase 환경 변수 확인\n        const supabaseUrl = import.meta.env.VITE_SUPABASE_URL;\n        const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY;\n        \n        if (!supabaseUrl || !supabaseAnonKey || supabaseUrl.includes('placeholder')) {\n          logger.warn('Supabase 환경 변수가 설정되지 않음 - PurchaseDetailModal');\n          return;\n        }\n\n        const { data: { user } } = await supabase.auth.getUser()\n        if (user) {\n          // 먼저 ID로 시도\n          let { data: employeeData } = await supabase\n            .from('employees')\n            .select('*')\n            .eq('id', user.id)\n            .maybeSingle()\n          \n          // ID로 못 찾았으면 이메일로 시도\n          if (!employeeData && user.email) {\n            const { data: employeeByEmail } = await supabase\n              .from('employees')\n              .select('*')\n              .eq('email', user.email)\n              .maybeSingle()\n            \n            employeeData = employeeByEmail\n          }\n          \n          // 사용자 이름 저장\n          if (employeeData?.name) {\n            setCurrentUserName(employeeData.name)\n          }\n          \n          if (employeeData?.purchase_role) {\n            let roles: string[] = []\n            if (Array.isArray(employeeData.purchase_role)) {\n              roles = employeeData.purchase_role.map((r: any) => String(r).trim())\n            } else {\n              const roleString = String(employeeData.purchase_role)\n              roles = roleString\n                .split(',')\n                .map((r: string) => r.trim())\n                .filter((r: string) => r.length > 0)\n            }\n            setUserRoles(roles)\n          }\n        }\n      } catch (error) {\n      }\n    }\n    \n    if (isOpen) {\n      loadUserRoles()\n    }\n  }, [isOpen])\n  \n  // currentUserRoles가 배열이 아니면 userRoles 사용\n  const effectiveRoles = Array.isArray(currentUserRoles) && currentUserRoles.length > 0 \n    ? currentUserRoles \n    : userRoles\n  \n  // 권한 체크\n  const canEdit = effectiveRoles.includes('final_approver') || \n                  effectiveRoles.includes('app_admin') || \n                  effectiveRoles.includes('ceo')\n  \n  // 삭제 권한: 관리자 또는 요청자 본인 (단, 승인된 요청은 관리자만)\n  const isApproved = purchase?.final_manager_status === 'approved';\n  const canDelete = isApproved \n    ? canEdit  // 승인된 요청은 관리자만 삭제 가능\n    : (canEdit || (purchase?.requester_name === currentUserName))  // 미승인 요청은 요청자도 삭제 가능\n  \n  // 구매 권한 체크: app_admin + lead buyer만 (요청자 본인 제외)\n  const canPurchase = effectiveRoles.includes('app_admin') || \n                     effectiveRoles.includes('lead_buyer') || \n                     effectiveRoles.includes('lead buyer')\n  \n  // 입고 권한 체크 \n  // 1. 관리자는 모든 건 입고 처리 가능\n  // 2. 요청자는 자신의 요청건만 입고 처리 가능\n  const canReceiveItems = effectiveRoles.includes('app_admin') || \n                         (purchase?.requester_name === currentUserName)\n  // 2. 일반 직원은 본인이 요청한 건만 입고 처리 가능\n  const isAdmin = effectiveRoles.includes('final_approver') || \n                  effectiveRoles.includes('app_admin') || \n                  effectiveRoles.includes('ceo')\n  const isRequester = purchase?.requester_name === currentUserName\n  const canReceiptCheck = isAdmin || isRequester\n  \n\n  // 모달 내부 데이터만 새로고침하는 함수 (모달 닫지 않음)\n  const refreshModalData = useCallback(async () => {\n    if (!purchaseId) return\n    \n    try {\n      // 최신 구매 요청 데이터 로드\n      const { data: freshPurchase } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          items:purchase_request_items (\n            *\n          )\n        `)\n        .eq('id', purchaseId)\n        .single()\n      \n      if (freshPurchase) {\n          setPurchase(freshPurchase as PurchaseRequestWithDetails)\n          setEditedPurchase(freshPurchase as PurchaseRequestWithDetails)\n          setEditedItems((freshPurchase as PurchaseRequestWithDetails).items || [])\n          \n          // 외부 진행률 업데이트는 별도의 이벤트로 처리 (모달 상태에 영향 주지 않음)\n          // 필요시 부모 컴포넌트에서 실시간 데이터 폴링 등으로 처리\n          logger.debug('모달 데이터 새로고침 완료 - 모달 상태 유지')\n        }\n    } catch (error) {\n      logger.error('모달 데이터 새로고침 실패', error)\n    }\n  }, [purchaseId, supabase])\n  \n  // 컴포넌트가 마운트될 때 외부 새로고침을 방지하는 플래그\n  const [isInitialLoad, setIsInitialLoad] = useState(true)\n  \n  // 커스텀 훅 설정\n  const purchaseIdNumber = purchaseId ? Number(purchaseId) : (purchase ? Number(purchase.id) : NaN)\n\n  const handleActualReceiptOptimisticUpdate = useCallback(({ itemId, selectedDate, action }: {\n    itemId: number\n    selectedDate?: Date\n    action: 'confirm' | 'cancel'\n    itemInfo?: {\n      item_name?: string\n      specification?: string\n      quantity?: number\n      unit_price_value?: number\n      amount_value?: number\n      remark?: string\n    }\n  }) => {\n    const itemIdStr = String(itemId)\n    const nowIso = new Date().toISOString()\n    const selectedDateIso = selectedDate ? selectedDate.toISOString() : undefined\n\n    const updateItems = (items?: any[]) => {\n      if (!items) return items\n      return items.map(item => {\n        if (String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_received: true,\n            actual_received_date: selectedDateIso,\n            received_at: nowIso\n          }\n        }\n\n        return {\n          ...item,\n          is_received: false,\n          actual_received_date: undefined,\n          received_at: undefined\n        }\n      })\n    }\n\n    setPurchase(prev => {\n      if (!prev) return prev\n      const updatedItems = updateItems(prev.items) || []\n      const total = updatedItems.length\n      const completed = updatedItems.filter(item => item.is_received).length\n      const allReceived = total > 0 && completed === total\n\n      return {\n        ...prev,\n        items: updatedItems,\n        is_received: allReceived,\n        received_at: allReceived ? (prev.received_at || nowIso) : undefined\n      }\n    })\n\n    setEditedPurchase(prev => {\n      if (!prev) return prev\n      const updatedItems = updateItems(prev.items) || []\n      return {\n        ...prev,\n        items: updatedItems\n      }\n    })\n\n    setEditedItems(prevItems => {\n      if (!prevItems || prevItems.length === 0) return prevItems\n      return prevItems.map(item => {\n        if (!item.id || String(item.id) !== itemIdStr) return item\n\n        if (action === 'confirm') {\n          return {\n            ...item,\n            is_received: true,\n            actual_received_date: selectedDateIso,\n            received_at: nowIso\n          }\n        }\n\n        return {\n          ...item,\n          is_received: false,\n          actual_received_date: undefined,\n          received_at: undefined\n        }\n      })\n    })\n\n    if (!Number.isNaN(purchaseIdNumber)) {\n      onOptimisticUpdate?.(purchaseIdNumber, prevPurchase => {\n        const updatedItems = updateItems(prevPurchase.items) || prevPurchase.items || []\n        const total = updatedItems.length || prevPurchase.items?.length || 0\n        const completed = updatedItems.filter(item => item.is_received).length\n        const allReceived = total > 0 && completed === total\n\n        return {\n          ...prevPurchase,\n          items: updatedItems,\n          is_received: allReceived,\n          received_at: allReceived ? (prevPurchase.received_at || nowIso) : undefined\n        }\n      })\n    }\n  }, [onOptimisticUpdate, purchaseIdNumber])\n\n  const statementReceivedAction = useConfirmDateAction({\n    config: {\n      field: 'statement_received',\n      confirmMessage: {\n        confirm: '거래명세서 확인을 처리하시겠습니까?',\n        cancel: '거래명세서 확인을 취소하시겠습니까?'\n      },\n      successMessage: {\n        confirm: '거래명세서 확인이 완료되었습니다.',\n        cancel: '거래명세서 확인이 취소되었습니다.'\n      },\n      completedText: '✓ 완료',\n      waitingText: '대기'\n    },\n    currentUserName,\n    canPerformAction: canReceiptCheck,\n    onUpdate: refreshModalData\n  })\n\n  const actualReceivedAction = useConfirmDateAction({\n    config: {\n      field: 'actual_received',\n      confirmMessage: {\n        confirm: '실제 입고 처리를 진행하시겠습니까?',\n        cancel: '실제 입고 처리를 취소하시겠습니까?'\n      },\n      successMessage: {\n        confirm: '실제 입고 처리가 완료되었습니다.',\n        cancel: '실제 입고 처리가 취소되었습니다.'\n      },\n      completedText: '입고완료',\n      waitingText: '입고대기'\n    },\n    currentUserName,\n    canPerformAction: canReceiptCheck,\n    onUpdate: refreshModalData,\n    onOptimisticUpdate: handleActualReceiptOptimisticUpdate\n  })\n  \n  // 날짜 선택 핸들러들\n  \n  // 디버깅용 로그\n  logger.debug('Receipt Check', {\n    activeTab,\n    canReceiptCheck,\n    isAdmin,\n    isRequester,\n    currentUserName,\n    requesterName: purchase?.requester_name,\n    effectiveRoles\n  });\n  \n  // 승인 권한 체크\n const canApproveMiddle = effectiveRoles.includes('middle_manager') || \n                          effectiveRoles.includes('app_admin') || \n                          effectiveRoles.includes('ceo')\n \n const canApproveFinal = effectiveRoles.includes('final_approver') || \n                         effectiveRoles.includes('app_admin') || \n                         effectiveRoles.includes('ceo')\n \n const approvalPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2 py-0.5 badge-text leading-tight'\n const approvalButtonClass = 'inline-flex items-center gap-1 business-radius-badge !h-auto !min-h-0 !px-2.5 !py-0.5 badge-text leading-tight'\n const approvalWaitingPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2.5 py-0.5 badge-text leading-tight'\n \n   // 디버깅 로그\n   logger.debug('PurchaseDetailModal 권한 체크', {\n     currentUserRoles,\n     userRoles,\n     effectiveRoles,\n     canApproveMiddle,\n     canApproveFinal,\n     isEditing,\n     middleManagerStatus: purchase?.middle_manager_status,\n     finalManagerStatus: purchase?.final_manager_status\n   });\n \n  useEffect(() => {\n    if (purchaseId && isOpen) {\n      loadPurchaseDetail(purchaseId.toString())\n      setIsEditing(false) // 모달 열 때마다 편집 모드 초기화\n    }\n  }, [purchaseId, isOpen])\n\n  // 칼럼 너비 계산 (텍스트 길이 기반)\n  const calculateOptimalColumnWidths = useCallback(() => {\n    if (!purchase?.items || purchase.items.length === 0) return []\n\n    const items = purchase.items ?? []\n\n    const columnConfigs = [\n      { key: 'item_name', minWidth: 80, maxWidth: 500, baseWidth: 80 },\n      { key: 'specification', minWidth: 120, maxWidth: 700, baseWidth: 120 },\n      { key: 'quantity', minWidth: 70, maxWidth: 100, baseWidth: 70 },\n      { key: 'unit_price', minWidth: 90, maxWidth: 150, baseWidth: 90 },\n      { key: 'total_price', minWidth: 100, maxWidth: 180, baseWidth: 100 },\n      { key: 'remarks', minWidth: 80, maxWidth: 240, baseWidth: 80 },\n      { key: 'status', minWidth: 80, maxWidth: 120, baseWidth: 80 }\n    ]\n\n    // 추가 칼럼들 (탭별)\n    if (activeTab === 'receipt') {\n      columnConfigs.push({ key: 'actual_receipt_date', minWidth: 100, maxWidth: 160, baseWidth: 100 })\n    }\n    if (activeTab === 'done') {\n      columnConfigs.push(\n        { key: 'transaction_confirm', minWidth: 100, maxWidth: 160, baseWidth: 100 },\n        { key: 'accounting_date', minWidth: 100, maxWidth: 160, baseWidth: 100 },\n        { key: 'processor', minWidth: 80, maxWidth: 120, baseWidth: 80 }\n      )\n    }\n\n    const calculatedWidths = columnConfigs.map((config, index) => {\n      let maxLength = 4 // 최소 4자\n\n      // 헤더 텍스트 길이 고려 (탭별)\n      const getHeaders = () => {\n        const statusHeader = activeTab === 'purchase'\n          ? '구매상태'\n          : (activeTab === 'receipt' || activeTab === 'done')\n          ? '입고상태'\n          : '상태'\n\n        const baseHeaders = ['품목명', '규격', '수량', '단가', '합계', '비고', statusHeader]\n        if (activeTab === 'receipt') {\n          return [...baseHeaders, '실제입고일']\n        } else if (activeTab === 'done') {\n          return [...baseHeaders, '거래명세서 확인', '회계상 입고일', '처리자']\n        }\n        return baseHeaders\n      }\n      \n      const headers = getHeaders()\n      if (headers[index]) {\n        maxLength = Math.max(maxLength, headers[index].length)\n      }\n\n      // 실제 데이터에서 최대 길이 찾기\n      items.forEach(item => {\n        let cellValue = ''\n        switch (config.key) {\n          case 'item_name':\n            cellValue = item.item_name || ''\n            break\n          case 'specification':\n            cellValue = item.specification || ''\n            break\n          case 'quantity':\n            cellValue = item.quantity?.toString() || ''\n            break\n          case 'unit_price':\n            cellValue = item.unit_price_value != null ? item.unit_price_value.toLocaleString() : ''\n            break\n          case 'total_price':\n            if (item.amount_value != null) {\n              cellValue = item.amount_value.toLocaleString()\n            } else if (item.quantity != null && item.unit_price_value != null) {\n              cellValue = (Number(item.quantity) * Number(item.unit_price_value)).toLocaleString()\n            } else {\n              cellValue = ''\n            }\n            break\n          case 'remarks':\n            cellValue = item.remark || ''\n            break\n          case 'status':\n            cellValue = getStatusDisplay(item) || ''\n            break\n          case 'actual_receipt_date':\n            cellValue = item.actual_received_date ? formatDate(item.actual_received_date) : ''\n            break\n          case 'transaction_confirm':\n            cellValue = item.is_statement_received ? '확인완료' : '미확인'\n            break\n          case 'accounting_date':\n            cellValue = item.statement_received_date ? formatDate(item.statement_received_date) : ''\n            break\n          case 'processor':\n            cellValue = item.statement_received_by_name || ''\n            break\n        }\n        \n        // 한글/영문 혼합 텍스트 길이 계산 (한글은 1.5배 가중치)\n        const adjustedLength = cellValue.split('').reduce((acc, char) => {\n          return acc + (/[가-힣]/.test(char) ? 1.5 : 1)\n        }, 0)\n        \n        maxLength = Math.max(maxLength, Math.ceil(adjustedLength))\n      })\n\n      // 길이를 픽셀로 변환 (글자당 약 7px + 여백 20px)\n      const calculatedWidth = Math.max(\n        config.minWidth,\n        Math.min(config.maxWidth, maxLength * 7 + 20)\n      )\n\n      logger.debug(`Column ${config.key} calculated:`, { \n        maxLength, \n        calculatedWidth, \n        range: `${config.minWidth}-${config.maxWidth}px` \n      })\n\n      return calculatedWidth\n    })\n\n    setColumnWidths(calculatedWidths)\n    logger.debug('Optimal column widths calculated', { calculatedWidths })\n    return calculatedWidths\n  }, [purchase, activeTab])\n\n  // 상태 표시 텍스트 반환 함수\n  const getStatusDisplay = (item: any) => {\n    if (activeTab === 'purchase') {\n      return item.purchase_status === 'ordered' ? '발주' : '구매요청'\n    } else if (activeTab === 'receipt') {\n      return item.receipt_status === 'received' ? '입고' : '입고대기'\n    }\n    return item.purchase_status === 'ordered' ? '발주' : '구매요청'\n  }\n\n  // 동적 gridTemplateColumns 생성\n  const getGridTemplateColumns = () => {\n    if (columnWidths.length > 0) {\n      return columnWidths.map(width => `${width}px`).join(' ')\n    }\n    \n    // 기본값 (데이터 로드 전)\n    const baseColumns = ['80px', '120px', '70px', '90px', '100px', '80px', '80px']\n    \n    // 탭별 추가 칼럼\n    if (activeTab === 'receipt') {\n      return [...baseColumns, '100px'].join(' ')\n    } else if (activeTab === 'done') {\n      return [...baseColumns, '100px', '100px', '80px'].join(' ')\n    }\n    \n    return baseColumns.join(' ')\n  }\n\n  // 레거시 measureColumnWidths 함수 (호환성 유지)\n  const measureColumnWidths = () => {\n    calculateOptimalColumnWidths()\n  }\n\n  // View 모드에서 칼럼 너비 계산 (데이터 로드 후)\n  useEffect(() => {\n    if (purchase && purchase.items && purchase.items.length > 0 && !isEditing) {\n      // 즉시 계산 (DOM 측정 불필요)\n      calculateOptimalColumnWidths()\n    }\n  }, [purchase, isEditing, activeTab, calculateOptimalColumnWidths])\n\n  // Edit 모드 전환 시 너비 계산\n  const handleEditToggle = (editing: boolean) => {\n    if (editing && !isEditing) {\n      // Edit 모드로 전환하기 전에 현재 너비 계산\n      calculateOptimalColumnWidths()\n    }\n    setIsEditing(editing)\n  }\n\n  const loadPurchaseDetail = async (id: string) => {\n    try {\n      setLoading(true)\n      const supabase = createClient()\n      \n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          vendors(id, vendor_name),\n          purchase_request_items(*)\n        `)\n        .eq('id', id)\n        .single()\n\n      if (error) throw error\n\n      if (data) {\n        // 라인넘버 순서대로 정렬\n        const sortedItems = (data.purchase_request_items || []).sort((a: any, b: any) => {\n          const lineA = a.line_number || 999999;\n          const lineB = b.line_number || 999999;\n          return lineA - lineB;\n        });\n\n        const purchaseData = {\n          ...data,\n          items: sortedItems,\n          vendor: data.vendors || { id: 0, vendor_name: '알 수 없음' },\n          vendor_contacts: []\n        } as PurchaseRequestWithDetails\n        setPurchase(purchaseData)\n        setEditedPurchase(purchaseData)\n        setEditedItems(sortedItems)\n      }\n    } catch (error) {\n      toast.error('발주 상세 정보를 불러오는데 실패했습니다.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getStatusBadge = () => {\n    if (!purchase) return null\n    \n    // payment_category 우선 확인\n    if (purchase.payment_category) {\n      const category = purchase.payment_category.trim()\n      \n      if (category === '발주') {\n        return <Badge variant={null} className=\"badge-success\">발주</Badge>\n      } else if (category === '구매요청') {\n        return <Badge variant={null} className=\"badge-primary\">구매요청</Badge>\n      } else if (category === '현장결제') {\n        return <Badge variant={null} className=\"badge-secondary\">현장결제</Badge>\n      } else {\n        // payment_category 값이 있지만 알려진 값이 아닌 경우\n        return <Badge variant={null} className=\"badge-primary\">{category}</Badge>\n      }\n    }\n    \n    // payment_category가 없으면 기본값\n    return <Badge variant={null} className=\"badge-primary\">구매요청</Badge>\n  }\n\n  // formatDate는 utils/helpers.ts에서 import\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('ko-KR').format(amount)\n  }\n\n  const handleSave = async () => {\n    if (!purchase || !editedPurchase) {\n      toast.error('저장할 데이터가 없습니다.')\n      return\n    }\n    \n    try {\n      logger.debug('저장 시작', { \n        purchaseId: purchase.id, \n        editedItemsCount: editedItems.length,\n        deletedItemsCount: deletedItemIds.length \n      });\n      \n      // 발주 기본 정보 업데이트\n      const totalAmount = editedItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n      logger.debug('계산된 총액', { totalAmount });\n      \n      const { error: updateError } = await supabase\n        .from('purchase_requests')\n        .update({\n          purchase_order_number: editedPurchase.purchase_order_number || null,\n          requester_name: editedPurchase.requester_name || null,\n          delivery_request_date: editedPurchase.delivery_request_date || null,\n          revised_delivery_request_date: editedPurchase.revised_delivery_request_date || null,\n          payment_category: editedPurchase.payment_category || null,\n          project_vendor: editedPurchase.project_vendor || null,\n          total_amount: Number(totalAmount),\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', purchase.id)\n\n      if (updateError) throw updateError\n\n      // 삭제된 항목들 처리\n      if (deletedItemIds.length > 0) {\n        const { error: deleteError } = await supabase\n          .from('purchase_request_items')\n          .delete()\n          .in('id', deletedItemIds)\n\n        if (deleteError) throw deleteError\n      }\n\n      // 각 아이템 업데이트 또는 생성\n      logger.debug('저장할 editedItems', { count: editedItems.length });\n      \n      for (const item of editedItems) {\n        logger.debug('처리 중인 item', { \n          itemId: item.id, \n          itemName: item.item_name,\n          quantity: item.quantity,\n          unitPrice: item.unit_price_value,\n          amount: item.amount_value\n        });\n        \n        // 필수 필드 검증\n        if (!item.item_name || !item.item_name.trim()) {\n          throw new Error('품목명은 필수입니다.');\n        }\n        if (!item.quantity || item.quantity <= 0) {\n          throw new Error('수량은 0보다 커야 합니다.');\n        }\n        if (item.unit_price_value !== null && item.unit_price_value !== undefined && item.unit_price_value < 0) {\n          throw new Error('단가는 0 이상이어야 합니다.');\n        }\n        if (item.amount_value !== null && item.amount_value !== undefined && item.amount_value < 0) {\n          throw new Error('합계는 0 이상이어야 합니다.');\n        }\n        \n        if (item.id) {\n          // 기존 항목 업데이트\n          logger.debug('기존 항목 업데이트', { itemId: item.id });\n          const { error } = await supabase\n            .from('purchase_request_items')\n            .update({\n              item_name: item.item_name.trim(),\n              specification: item.specification || null,\n              quantity: Number(item.quantity),\n              unit_price_value: Number(item.unit_price_value),\n              unit_price_currency: purchase.currency || 'KRW',\n              amount_value: Number(item.amount_value),\n              amount_currency: purchase.currency || 'KRW',\n              remark: item.remark || null,\n              updated_at: new Date().toISOString()\n            })\n            .eq('id', item.id)\n\n          if (error) {\n            logger.error('기존 항목 업데이트 오류', error);\n            throw error;\n          }\n        } else {\n          // 새 항목 생성\n          logger.debug('새 항목 생성', { itemName: item.item_name });\n          const insertData = {\n            purchase_request_id: purchase.id,\n            item_name: item.item_name.trim(),\n            specification: item.specification || null,\n            quantity: Number(item.quantity),\n            unit_price_value: Number(item.unit_price_value),\n            unit_price_currency: purchase.currency || 'KRW',\n            amount_value: Number(item.amount_value),\n            amount_currency: purchase.currency || 'KRW',\n            remark: item.remark || null,\n            line_number: item.line_number || editedItems.indexOf(item) + 1,\n            created_at: new Date().toISOString()\n          };\n          logger.debug('삽입할 데이터', { itemName: insertData.item_name });\n          \n          const { error } = await supabase\n            .from('purchase_request_items')\n            .insert(insertData)\n\n          if (error) {\n            logger.error('새 항목 생성 오류', error);\n            throw error;\n          } else {\n            logger.debug('새 항목 생성 성공');\n          }\n        }\n      }\n\n      logger.debug('저장 완료');\n      toast.success('발주 내역이 성공적으로 저장되었습니다.')\n      handleEditToggle(false)\n      setDeletedItemIds([])\n      \n      // 수정된 데이터 다시 로드 (모달은 열린 상태 유지)\n      await loadPurchaseDetail(purchaseId?.toString() || '')\n\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      logger.error('저장 중 전체 오류', error);\n      const errorMessage = error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다'\n      toast.error(`저장 실패: ${errorMessage}`)\n    }\n  }\n\n  const handleItemChange = (index: number, field: string, value: any) => {\n    const newItems = [...editedItems]\n    \n    if (field === 'amount_value') {\n      // 금액을 직접 수정한 경우\n      newItems[index] = {\n        ...newItems[index],\n        amount_value: value\n      }\n    } else if (field === 'quantity' || field === 'unit_price_value') {\n      // 수량이나 단가를 수정한 경우 금액 자동 계산\n      const quantity = field === 'quantity' ? value : newItems[index].quantity\n      const unitPrice = field === 'unit_price_value' ? value : newItems[index].unit_price_value\n      newItems[index] = {\n        ...newItems[index],\n        [field]: value,\n        amount_value: quantity * unitPrice\n      }\n    } else {\n      // 기타 필드 수정\n      newItems[index] = {\n        ...newItems[index],\n        [field]: value\n      }\n    }\n    \n    setEditedItems(newItems)\n  }\n\n  const handleAddItem = () => {\n    // 현재 최대 라인넘버 찾기\n    const maxLineNumber = editedItems.reduce((max, item) => {\n      const lineNum = item.line_number || 0;\n      return lineNum > max ? lineNum : max;\n    }, 0);\n\n    const newItem = {\n      item_name: '',\n      specification: '',\n      quantity: 1,\n      unit_price_value: 0,\n      amount_value: 0,\n      remark: '',\n      line_number: maxLineNumber + 1\n    }\n    \n    // 새 아이템 추가 후 라인넘버 순서대로 정렬\n    const newItems = [...editedItems, newItem].sort((a, b) => {\n      const lineA = a.line_number || 999999;\n      const lineB = b.line_number || 999999;\n      return lineA - lineB;\n    });\n    \n    setEditedItems(newItems)\n  }\n\n  const handleRemoveItem = (index: number) => {\n    const item = editedItems[index]\n    if (item.id) {\n      setDeletedItemIds([...deletedItemIds, item.id])\n    }\n    const newItems = editedItems.filter((_, i) => i !== index).sort((a, b) => {\n      const lineA = a.line_number || 999999;\n      const lineB = b.line_number || 999999;\n      return lineA - lineB;\n    });\n    setEditedItems(newItems)\n  }\n\n  // 구매완료 처리 함수\n  const handlePaymentToggle = async (itemId: number | string, isCompleted: boolean) => {\n    if (!canPurchase) {\n      toast.error('구매완료 처리 권한이 없습니다.')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('유효하지 않은 항목 ID 입니다.')\n      return\n    }\n\n    // 해당 품목 정보 찾기\n    const targetItem = purchase?.items?.find(item => String(item.id) === itemIdStr)\n    if (!targetItem) return\n\n    const itemInfo = `품명: ${targetItem.item_name}\n규격: ${targetItem.specification || '미입력'}\n수량: ${targetItem.quantity?.toLocaleString() || 0}${targetItem.unit || ''}\n단가: ₩${targetItem.unit_price_value?.toLocaleString() || 0}\n합계: ₩${targetItem.amount_value?.toLocaleString() || 0}`\n\n    const confirmMessage = isCompleted \n      ? `다음 품목을 구매완료 처리하시겠습니까?\\n\\n${itemInfo}` \n      : `다음 품목의 구매완료를 취소하시겠습니까?\\n\\n${itemInfo}`\n    \n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_payment_completed: isCompleted,\n          payment_completed_at: isCompleted ? new Date().toISOString() : null\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      // 로컬 상태 즉시 업데이트 (UI 즉시 반영)\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          String(item.id) === itemIdStr \n            ? { ...item, is_payment_completed: isCompleted, payment_completed_at: isCompleted ? new Date().toISOString() : null }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n\n      if (purchase) {\n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate?.(purchaseIdNumber, prev => {\n            const updatedItems = (prev.items || []).map(item =>\n              String(item.id) === itemIdStr\n                ? { ...item, is_payment_completed: isCompleted }\n                : item\n            )\n            const total = updatedItems.length || prev.items?.length || 0\n            const completed = updatedItems.filter(item => item.is_payment_completed).length\n            const allCompleted = total > 0 && completed === total\n            return {\n              ...prev,\n              items: updatedItems,\n              is_payment_completed: allCompleted,\n              payment_completed_at: allCompleted ? new Date().toISOString() : null,\n              payment_completed_by_name: allCompleted ? (currentUserName || prev.payment_completed_by_name) : prev.payment_completed_by_name\n            }\n          })\n        }\n      }\n      \n      toast.success(isCompleted ? '구매완료 처리되었습니다.' : '구매완료가 취소되었습니다.')\n\n      // 상세 모달 및 상위 리스트 모두 최신 상태로 동기화\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      toast.error('구매완료 처리 중 오류가 발생했습니다.')\n    }\n  }\n\n  // 개별 품목 입고완료 처리 (날짜 선택)\n  const handleItemReceiptToggle = async (itemId: number | string, selectedDate: Date) => {\n    if (!canReceiptCheck) {\n      toast.error('입고 처리 권한이 없습니다.')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('유효하지 않은 항목 ID 입니다.')\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  is_received: true,\n                  actual_received_date: selectedDate.toISOString()\n                }\n              : item\n          )\n          const total = updatedItems.length || prev.items?.length || 0\n          const completed = updatedItems.filter(item => item.is_received).length\n          const allReceived = total > 0 && completed === total\n\n          return {\n            ...prev,\n            items: updatedItems,\n            is_received: allReceived,\n            received_at: allReceived ? new Date().toISOString() : prev.received_at\n          }\n        })\n      }\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: true,\n          received_at: new Date().toISOString(),\n          actual_received_date: selectedDate.toISOString()\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      // 로컬 상태 즉시 업데이트\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          String(item.id) === itemIdStr \n            ? { \n                ...item, \n                is_received: true, \n                received_at: new Date().toISOString(),\n                actual_received_date: selectedDate.toISOString()\n              }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n\n      applyOptimisticUpdate()\n      \n      const targetItem = purchase?.items?.find(item => String(item.id) === itemIdStr)\n      toast.success(`\"${targetItem?.item_name}\" 품목이 입고완료 처리되었습니다.`)\n\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n\n      applyOptimisticUpdate()\n    } catch (error) {\n      toast.error('입고완료 처리 중 오류가 발생했습니다.')\n    }\n  }\n\n  // 입고완료 취소 처리\n  const handleReceiptCancel = async (itemId: number | string) => {\n    if (!canReceiptCheck) {\n      toast.error('입고 처리 권한이 없습니다.')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('유효하지 않은 항목 ID 입니다.')\n      return\n    }\n\n    const targetItem = purchase?.items?.find(item => String(item.id) === itemIdStr)\n    if (!targetItem) return\n\n    const confirm = window.confirm(`\"${targetItem.item_name}\" 품목의 입고완료를 취소하시겠습니까?`)\n    if (!confirm) return\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item =>\n            String(item.id) === itemIdStr\n              ? {\n                  ...item,\n                  is_received: false,\n                  actual_received_date: undefined\n                }\n              : item\n          )\n          const total = updatedItems.length || prev.items?.length || 0\n          const completed = updatedItems.filter(item => item.is_received).length\n          const allReceived = total > 0 && completed === total\n\n          return {\n            ...prev,\n            items: updatedItems,\n            is_received: allReceived,\n            received_at: allReceived ? prev.received_at : null\n          }\n        })\n      }\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: false,\n          received_at: null,\n          actual_received_date: null,\n          actual_received_by_name: null\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      // 로컬 상태 즉시 업데이트\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          String(item.id) === itemIdStr \n            ? { ...item, is_received: false, received_at: null, actual_received_date: undefined, actual_received_by_name: undefined }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n      \n      applyOptimisticUpdate()\n\n      toast.success('입고완료가 취소되었습니다.')\n\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n\n      applyOptimisticUpdate()\n    } catch (error) {\n      toast.error('입고완료 취소 중 오류가 발생했습니다.')\n    }\n  }\n\n\n  // 승인 처리\n  const handleApprove = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const approvalType = type === 'middle' ? '1차 승인' : '최종 승인'\n    const confirmMessage = `발주번호: ${purchase.purchase_order_number}\\n\\n${approvalType}을 진행하시겠습니까?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n    \n    try {\n      const updateData = type === 'middle' \n        ? { \n            middle_manager_status: 'approved'\n          }\n        : { \n            final_manager_status: 'approved'\n          }\n      \n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n      \n      // 로컬 상태 즉시 업데이트 (UI 즉시 반영)\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'approved' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'approved' } : null)\n      }\n      \n      toast.success(`${type === 'middle' ? '중간' : '최종'} 승인이 완료되었습니다.`)\n    } catch (error) {\n      toast.error('승인 처리 중 오류가 발생했습니다.')\n    }\n  }\n  \n  // 전체 구매완료 처리\n  const handleCompleteAllPayment = async () => {\n    if (!purchase || !canPurchase) return\n    \n    const confirmMessage = `발주번호: ${purchase.purchase_order_number}\\n\\n모든 품목을 구매완료 처리하시겠습니까?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n    \n    try {\n      const updateData = {\n        is_payment_completed: true,\n        payment_completed_at: new Date().toISOString()\n      }\n      \n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update(updateData)\n        .eq('purchase_request_id', purchase.id)\n        .eq('is_payment_completed', false) // 아직 구매완료되지 않은 항목만\n      \n      if (error) throw error\n      \n      // 로컬 상태 즉시 업데이트 (UI 즉시 반영)\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          !item.is_payment_completed \n            ? { ...item, is_payment_completed: true, payment_completed_at: new Date().toISOString() }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n\n      if (purchase) {\n        const purchaseIdNumber = Number(purchase.id)\n        if (!Number.isNaN(purchaseIdNumber)) {\n          onOptimisticUpdate?.(purchaseIdNumber, prev => {\n            const updatedItems = (prev.items || []).map(item => ({\n              ...item,\n              is_payment_completed: true\n            }))\n            return {\n              ...prev,\n              items: updatedItems,\n              is_payment_completed: true,\n              payment_completed_at: new Date().toISOString(),\n              payment_completed_by_name: currentUserName || prev.payment_completed_by_name\n            }\n          })\n        }\n      }\n      \n      toast.success('모든 품목이 구매완료 처리되었습니다.')\n\n      // 상세 모달 및 리스트 모두 새로고침\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n    } catch (error) {\n      logger.error('전체 구매완료 처리 오류', error);\n      toast.error('구매완료 처리 중 오류가 발생했습니다.')\n    }\n  }\n\n  // 전체 입고완료 처리 (날짜 선택)\n  const handleCompleteAllReceipt = async (selectedDate: Date) => {\n    if (!purchase || !canReceiveItems) {\n      return\n    }\n\n    // 확인 다이얼로그 표시\n    const confirmMessage = `발주번호: ${purchase.purchase_order_number}\n\n전체 입고완료 처리하시겠습니까?`\n    \n    if (!window.confirm(confirmMessage)) {\n      return\n    }\n\n    const purchaseIdNumber = purchase ? Number(purchase.id) : NaN\n\n    const applyOptimisticUpdate = () => {\n      if (!Number.isNaN(purchaseIdNumber)) {\n        onOptimisticUpdate?.(purchaseIdNumber, prev => {\n          const updatedItems = (prev.items || []).map(item => ({\n            ...item,\n            is_received: true,\n            actual_received_date: item.actual_received_date || selectedDate.toISOString()\n          }))\n\n          return {\n            ...prev,\n            items: updatedItems,\n            is_received: true,\n            received_at: new Date().toISOString()\n          }\n        })\n      }\n    }\n\n    try {\n      const updateData = {\n        is_received: true,\n        received_at: new Date().toISOString(),\n        actual_received_date: selectedDate.toISOString()\n      }\n      \n\n      const { data, error } = await supabase\n        .from('purchase_request_items')\n        .update(updateData)\n        .eq('purchase_request_id', purchase.id)\n        .is('actual_received_date', null) // 아직 실제 입고되지 않은 항목만\n        .select()\n\n\n      if (error) throw error\n\n      // 로컬 상태 즉시 업데이트\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          !item.actual_received_date \n            ? { \n                ...item, \n                is_received: true, \n                received_at: new Date().toISOString(),\n                actual_received_date: selectedDate.toISOString()\n              }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n\n      applyOptimisticUpdate()\n\n      toast.success('모든 품목이 입고완료 처리되었습니다.')\n\n      await refreshModalData()\n      const refreshResult = onRefresh?.(true, { silent: true })\n      if (refreshResult instanceof Promise) {\n        await refreshResult\n      }\n\n      applyOptimisticUpdate()\n    } catch (error) {\n      logger.error('전체 입고완료 처리 오류', error)\n      toast.error('입고완료 처리 중 오류가 발생했습니다.')\n    }\n  }\n  \n\n  // 반려 처리\n  const handleReject = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const reason = window.prompt('반려 사유를 입력해주세요:')\n    if (!reason) return\n    \n    try {\n      const updateData = type === 'middle'\n        ? {\n            middle_manager_status: 'rejected'\n          }\n        : {\n            final_manager_status: 'rejected'\n          }\n      \n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n      \n      // 로컬 상태 즉시 업데이트 (UI 즉시 반영)\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'rejected' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'rejected' } : null)\n      }\n      \n      toast.success(`${type === 'middle' ? '중간' : '최종'} 반려가 완료되었습니다.`)\n    } catch (error) {\n      toast.error('반려 처리 중 오류가 발생했습니다.')\n    }\n  }\n\n  const content = (\n    <div className=\"space-y-1 sm:space-y-4\">\n      {loading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-hansl-600\"></div>\n        </div>\n      ) : purchase ? (\n        <div>\n          {/* Compact Info Header */}\n          <div className=\"bg-gray-50 rounded-lg p-2 sm:p-3 mb-1 sm:mb-2 border border-gray-100\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 items-center gap-3 sm:gap-0\">\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4\">\n                <div className=\"flex items-center gap-3\">\n                  {getStatusBadge()}\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"modal-label\">요청자:</span>\n                    <span className=\"modal-value\">{purchase.requester_name}</span>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-3 h-3 text-gray-500\" />\n                  <span className=\"modal-subtitle\">청구일: {formatDate(purchase.request_date)}</span>\n                </div>\n              </div>\n              \n              {/* 승인 버튼들을 중앙에 배치 */}\n              <div className=\"flex items-center justify-center gap-2 sm:gap-3 flex-wrap\">\n                {/* 1차 승인 버튼 */}\n                {canApproveMiddle && purchase.middle_manager_status === 'pending' && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('middle')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    1차 승인 대기\n                  </Button>\n                )}\n                {purchase.middle_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text shadow-sm\">\n                    <Check className=\"w-3 h-3\" />\n                    1차 승인완료\n                  </div>\n                )}\n                {purchase.middle_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                    1차 반려\n                  </div>\n                )}\n                {purchase.middle_manager_status === 'pending' && !canApproveMiddle && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                    1차 승인대기\n                  </div>\n                )}\n\n                {/* 최종 승인 버튼 */}\n                {canApproveFinal && purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'pending' && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('final')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    <Check className=\"w-3 h-3\" />\n                    최종 승인\n                  </Button>\n                )}\n                {purchase.final_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text\">\n                    <Check className=\"w-3 h-3\" />\n                    최종 승인완료\n                  </div>\n                )}\n                {purchase.final_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                    최종 반려\n                  </div>\n                )}\n                {purchase.middle_manager_status !== 'approved' && purchase.final_manager_status === 'pending' && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                    최종 승인대기\n                  </div>\n                )}\n              </div>\n              \n              {/* 우측 빈 영역 */}\n              <div></div>\n            </div>\n          </div>\n\n          {/* Main 2-Column Layout */}\n          <div className=\"flex flex-col lg:flex-row gap-3 sm:gap-6\">\n            {/* Left Column - Basic Info (Fixed Width) */}\n            <div className=\"lg:w-80 lg:flex-shrink-0 space-y-1 sm:space-y-4 relative\">\n              \n              {/* 발주 기본정보 */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <div className=\"mb-3\">\n                  <h3 className=\"modal-section-title flex items-center\">\n                    <FileText className=\"w-4 h-4 mr-2 text-gray-600\" />\n                    {purchase?.purchase_order_number || 'PO번호 없음'}\n                  </h3>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">발주서 종류</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.request_type || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, request_type: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"일반\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.request_type || '일반'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">결제 종류</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.payment_category || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, payment_category: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"발주/구매요청/현장결제\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.payment_category || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">입고 요청일</span>\n                      {isEditing ? (\n                        <DatePickerPopover\n                          onDateSelect={(date) => {\n                            setEditedPurchase(prev => prev ? {\n                              ...prev,\n                              delivery_request_date: formatDateInput(date, 'yyyy-MM-dd')\n                            } : null)\n                          }}\n                          placeholder=\"입고 요청일을 선택하세요\"\n                          align=\"start\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            variant=\"outline\"\n                            className=\"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input\"\n                          >\n                            <Calendar className=\"mr-1 h-3 w-3\" />\n                            {editedPurchase?.delivery_request_date ? \n                              formatDate(editedPurchase.delivery_request_date) : \n                              '날짜 선택'\n                            }\n                          </Button>\n                        </DatePickerPopover>\n                      ) : (\n                        <p className=\"modal-subtitle\">{formatDate(purchase.delivery_request_date)}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label text-orange-500\">변경 입고일</span>\n                      {isEditing ? (\n                        <DatePickerPopover\n                          onDateSelect={(date) => {\n                            setEditedPurchase(prev => prev ? {\n                              ...prev,\n                              revised_delivery_request_date: formatDateInput(date, 'yyyy-MM-dd')\n                            } : null)\n                          }}\n                          placeholder=\"변경 입고일을 선택하세요\"\n                          align=\"start\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            variant=\"outline\"\n                            className=\"mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] justify-start text-left font-normal business-radius-input\"\n                          >\n                            <Calendar className=\"mr-1 h-3 w-3\" />\n                            {editedPurchase?.revised_delivery_request_date ? \n                              formatDate(editedPurchase.revised_delivery_request_date) : \n                              '날짜 선택'\n                            }\n                          </Button>\n                        </DatePickerPopover>\n                      ) : (\n                        <p className=\"modal-subtitle text-orange-700\">\n                          {purchase.revised_delivery_request_date ? formatDate(purchase.revised_delivery_request_date) : '미설정'}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* 업체 정보 */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <h3 className=\"modal-section-title mb-3 flex items-center\">\n                  <Building2 className=\"w-4 h-4 mr-2 text-gray-600\" />\n                  업체 정보\n                </h3>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">업체명</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.vendor?.vendor_name || editedPurchase?.vendor_name || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, vendor_name: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"업체 선택\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.vendor?.vendor_name || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">업체 담당자</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.vendor_contacts?.[0]?.contact_name || ''}\n                          onChange={(e) => {\n                            setEditedPurchase(prev => {\n                              if (!prev) return null;\n                              const contacts = prev.vendor_contacts || [];\n                              const updatedContacts = [...contacts];\n                              if (updatedContacts[0]) {\n                                updatedContacts[0] = { ...updatedContacts[0], contact_name: e.target.value };\n                              } else {\n                                updatedContacts[0] = { contact_name: e.target.value } as any;\n                              }\n                              return { ...prev, vendor_contacts: updatedContacts };\n                            })\n                          }}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"담당자 선택\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.vendor_contacts?.[0]?.contact_name || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">PJ업체</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_vendor || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_vendor: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"입력\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.project_vendor || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">Item</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_item || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_item: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"입력\"\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle\">{purchase.project_item || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">수주번호</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.order_number || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, order_number: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"입력\"\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle\">{purchase.order_number || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n\n            {/* Right Column - Items List (Flexible Width) */}\n            <div className=\"lg:flex-1 lg:min-w-0 relative overflow-visible\">\n              \n              <div className=\"bg-white rounded-lg border border-gray-100 overflow-hidden shadow-sm\">\n                <div className=\"p-2 sm:p-3 bg-gray-50 border-b border-gray-100 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0\">\n                  <h3 className=\"modal-section-title flex items-center\">\n                    <Package className=\"w-4 h-4 mr-2 text-gray-600\" />\n                    품목 리스트\n                    <span className=\"ml-2 badge-secondary\">\n                      {purchase.items?.length || 0}개\n                    </span>\n                  </h3>\n                  {!isEditing && (\n                    <>\n                      {activeTab === 'purchase' && canPurchase && (\n                        <Button\n                          size=\"sm\"\n                          onClick={handleCompleteAllPayment}\n                          className=\"button-base bg-orange-500 hover:bg-orange-600 text-white\"\n                        >\n                          <CreditCard className=\"w-3 h-3 mr-1\" />\n                          전체 구매완료\n                        </Button>\n                      )}\n                      {activeTab === 'receipt' && canReceiveItems && (\n                        <DatePickerPopover\n                          onDateSelect={handleCompleteAllReceipt}\n                          placeholder=\"전체 입고완료 날짜를 선택하세요\"\n                          align=\"end\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            size=\"sm\"\n                            className=\"button-base button-action-primary\"\n                          >\n                            <Truck className=\"w-3 h-3 mr-1\" />\n                            전체 입고완료\n                          </Button>\n                        </DatePickerPopover>\n                      )}\n                    </>\n                  )}\n                </div>\n                \n                {/* Mobile Table Header */}\n                <div className=\"block sm:hidden bg-gray-50 px-2 py-1 border-b border-gray-100\">\n                  <div className=\"text-xs font-medium text-gray-600\">품목 목록 (터치하여 스크롤)</div>\n                </div>\n                \n                {/* Items List with Header Inside Scrollable Container */}\n                <div className=\"max-h-[50vh] sm:max-h-[40vh] overflow-y-auto overflow-x-auto min-w-fit\">\n                  {/* Items Table Header - Sticky inside scroll container */}\n                  <div className=\"bg-gray-50 px-2 sm:px-3 py-1 border-b border-gray-100 sticky top-0 z-10\">\n                    <div \n                      ref={headerRowRef}\n                      className=\"hidden sm:grid gap-3 modal-label\" \n                      style={{\n                        gridTemplateColumns: getGridTemplateColumns()\n                      }}\n                    >\n                      <div>품목명</div>\n                      <div>규격</div>\n                      <div className=\"text-center\">수량</div>\n                      <div className=\"text-right\">단가</div>\n                      <div className=\"text-right\">합계</div>\n                      <div className=\"text-center\">비고</div>\n                      {isEditing ? (\n                        <>\n                          <div className=\"text-center\">삭제</div>\n                          {activeTab === 'receipt' && (\n                            <>\n                              <div className=\"text-center\">실제입고일</div>\n                            </>\n                          )}\n                          {activeTab === 'done' && (\n                            <>\n                              <div className=\"text-center\">거래명세서 확인</div>\n                              <div className=\"text-center\">회계상 입고일</div>\n                              <div className=\"text-center\">처리자</div>\n                            </>\n                          )}\n                        </>\n                      ) : (\n                        <>\n                          <div className=\"text-center\">\n                            {activeTab === 'purchase'\n                              ? '구매상태'\n                              : (activeTab === 'receipt' || activeTab === 'done')\n                              ? '입고상태'\n                              : '상태'}\n                          </div>\n                          {activeTab === 'done' && (\n                            <>\n                              <div className=\"text-center\">거래명세서 확인</div>\n                              <div className=\"text-center\">회계상 입고일</div>\n                              <div className=\"text-center\">처리자</div>\n                            </>\n                          )}\n                          {activeTab === 'receipt' && (\n                            <>\n                              <div className=\"text-center\">실제입고일</div>\n                            </>\n                          )}\n                        </>\n                      )}\n                    </div>\n                  </div>\n                  {(isEditing ? editedItems : purchase.items)?.map((item, index) => (\n                    <div key={index} className=\"px-2 sm:px-3 py-1.5 border-b border-gray-50 hover:bg-gray-50/50 transition-colors\">\n                      {/* Desktop Layout */}\n                      <div className={`hidden sm:grid items-center gap-3`} style={{\n                        gridTemplateColumns: getGridTemplateColumns()\n                      }}>\n                        {/* 품목명 */}\n                        <div className=\"min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              value={item.item_name}\n                              onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                              className=\"modal-label border-gray-200 rounded-lg w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"품목명\"\n                            />\n                          ) : (\n                            <span className=\"modal-value\">{item.item_name || '품목명 없음'}</span>\n                          )}\n                        </div>\n                        \n                        {/* 규격 */}\n                        <div className=\"min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              value={item.specification}\n                              onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                              className=\"modal-label border-gray-200 rounded-lg w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"규격\"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle\">{item.specification || '-'}</span>\n                          )}\n                        </div>\n                        \n                        {/* 수량 */}\n                        <div className=\"text-center min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              type=\"number\"\n                              value={item.quantity}\n                              onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                              className=\"modal-label border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"수량\"\n                              max=\"99999\"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle\">{item.quantity || 0}</span>\n                          )}\n                        </div>\n                        \n                        {/* 단가 */}\n                        <div className=\"text-right min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              type=\"number\"\n                              value={item.unit_price_value}\n                              onChange={(e) => handleItemChange(index, 'unit_price_value', Number(e.target.value))}\n                              className=\"modal-label border-gray-200 rounded-lg text-right w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"단가\"\n                              max=\"100000000000\"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle\">₩{formatCurrency(item.unit_price_value)}</span>\n                          )}\n                        </div>\n                        \n                        {/* 합계 */}\n                        <div className=\"text-right min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              type=\"number\"\n                              value={item.amount_value}\n                              onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                              className=\"modal-label border-gray-200 rounded-lg text-right w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"합계\"\n                              max=\"10000000000\"\n                            />\n                          ) : (\n                            <span className=\"modal-value\">₩{formatCurrency(item.amount_value || 0)}</span>\n                          )}\n                        </div>\n                        \n                        {/* 비고 */}\n                        <div className=\"min-w-0 flex justify-center items-start pt-1 text-center\">\n                          {isEditing ? (\n                            <Input\n                              value={item.remark || ''}\n                              onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                              className=\"modal-label border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"비고\"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle text-center\">{item.remark || '-'}</span>\n                          )}\n                        </div>\n                        \n                        {/* 상태/액션 */}\n                        <div className=\"text-center flex justify-center items-start pt-1\">\n                          {isEditing ? (\n                            <Button\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              onClick={() => handleRemoveItem(index)}\n                              className=\"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6\"\n                            >\n                              <Trash2 className=\"w-3 h-3\" />\n                            </Button>\n                          ) : (\n                            <>\n                              {/* 구매 탭에서의 구매완료 상태 */}\n                              {activeTab === 'purchase' && (\n                                <div className=\"flex justify-center\">\n                                  {canPurchase ? (\n                                    <button\n                                      onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                                      className={`transition-colors ${\n                                        item.is_payment_completed\n                                          ? 'button-toggle-active bg-orange-500 hover:bg-orange-600 text-white'\n                                          : 'button-toggle-inactive'\n                                      }`}\n                                    >\n                                      {item.is_payment_completed ? '구매완료' : '구매대기'}\n                                    </button>\n                                  ) : (\n                                    <span className={`${\n                                      item.is_payment_completed \n                                        ? 'button-toggle-active bg-orange-500 text-white' \n                                        : 'button-waiting-inactive'\n                                    }`}>\n                                      {item.is_payment_completed ? '구매완료' : '구매대기'}\n                                    </span>\n                                  )}\n                                </div>\n                              )}\n                              \n                              {/* 입고 탭에서의 입고완료 상태 */}\n                              {activeTab === 'receipt' && (\n                                <div className=\"flex justify-center\">\n                                  {canReceiptCheck ? (\n                                    actualReceivedAction.isCompleted(item) ? (\n                                      <button\n                                        onClick={() => {\n                                          actualReceivedAction.handleCancel(item.id, {\n                                            item_name: item.item_name,\n                                            specification: item.specification,\n                                            quantity: item.quantity,\n                                            unit_price_value: item.unit_price_value,\n                                            amount_value: item.amount_value,\n                                            remark: item.remark\n                                          })\n                                        }}\n                                        className=\"button-action-primary\"\n                                      >\n                                        {actualReceivedAction.config.completedText}\n                                      </button>\n                                    ) : (\n                                      <DatePickerPopover\n                                        onDateSelect={(date) => {\n                                          actualReceivedAction.handleConfirm(item.id, date, {\n                                            item_name: item.item_name,\n                                            specification: item.specification,\n                                            quantity: item.quantity,\n                                            unit_price_value: item.unit_price_value,\n                                            amount_value: item.amount_value,\n                                            remark: item.remark\n                                          })\n                                        }}\n                                        placeholder=\"실제 입고된 날짜를 선택하세요\"\n                                        align=\"center\"\n                                        side=\"bottom\"\n                                      >\n                                        <button className=\"button-toggle-inactive\">\n                                          {actualReceivedAction.config.waitingText}\n                                        </button>\n                                      </DatePickerPopover>\n                                    )\n                                  ) : (\n                                    <span className={`${\n                                      actualReceivedAction.isCompleted(item)\n                                        ? 'button-action-primary' \n                                        : 'button-waiting-inactive'\n                                    }`}>\n                                      {actualReceivedAction.isCompleted(item) ? actualReceivedAction.config.completedText : actualReceivedAction.config.waitingText}\n                                    </span>\n                                  )}\n                                </div>\n                              )}\n                              \n                              {/* 전체 항목 탭에서는 입고 상태만 표시 (클릭 불가) */}\n                              {activeTab === 'done' && (\n                                <div className=\"flex justify-center\">\n                                  <span className={`button-base ${\n                                    actualReceivedAction.isCompleted(item)\n                                      ? 'bg-green-500 hover:bg-green-600 text-white' \n                                      : 'border border-gray-300 text-gray-600 bg-white hover:bg-gray-50'\n                                  }`}>\n                                    {actualReceivedAction.isCompleted(item) ? '입고완료' : '입고대기'}\n                                  </span>\n                                </div>\n                              )}\n                              \n                              {/* 기타 탭에서는 기본 상태 표시 */}\n                              {activeTab !== 'purchase' && activeTab !== 'receipt' && activeTab !== 'done' && (\n                                <div className=\"flex justify-center\">\n                                  <span className=\"badge-text\">-</span>\n                                </div>\n                              )}\n                            </>\n                          )}\n                        </div>\n                        \n                        {/* 실제 입고 날짜 - 입고 탭에서만 표시 (상태 컬럼 오른쪽) */}\n                        {activeTab === 'receipt' && (\n                          <div className=\"text-center flex justify-center items-start pt-1 pl-2\">\n                            {actualReceivedAction.getCompletedDate(item) ? (\n                              <div className=\"modal-subtitle text-green-700\">\n                                {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                            ) : (\n                              <span className=\"modal-subtitle text-gray-400\">-</span>\n                            )}\n                          </div>\n                        )}\n\n                        {/* 거래명세서 확인 - 전체항목 탭에서만 표시 */}\n                        {activeTab === 'done' && (\n                          <div className=\"text-center flex justify-center items-start pt-1\">\n                            {canReceiptCheck ? (\n                              statementReceivedAction.isCompleted(item) ? (\n                                <button\n                                  onClick={() => {\n                                    statementReceivedAction.handleCancel(item.id, {\n                                      item_name: item.item_name,\n                                      specification: item.specification,\n                                      quantity: item.quantity,\n                                      unit_price_value: item.unit_price_value,\n                                      amount_value: item.amount_value,\n                                      remark: item.remark\n                                    })\n                                  }}\n                                  className=\"button-action-primary hover:bg-green-600 transition-colors\"\n                                  title=\"클릭하여 거래명세서 확인 취소\"\n                                >\n                                  {statementReceivedAction.config.completedText}\n                                </button>\n                              ) : (\n                                <DatePickerPopover\n                                  onDateSelect={(date) => {\n                                    statementReceivedAction.handleConfirm(item.id, date, {\n                                      item_name: item.item_name,\n                                      specification: item.specification,\n                                      quantity: item.quantity,\n                                      unit_price_value: item.unit_price_value,\n                                      amount_value: item.amount_value,\n                                      remark: item.remark\n                                    })\n                                  }}\n                                  placeholder=\"회계상 입고일을 선택하세요\"\n                                  align=\"center\"\n                                  side=\"bottom\"\n                                >\n                                  <button \n                                    className=\"button-toggle-inactive\"\n                                    onClick={() => {}}\n                                  >\n                                    {statementReceivedAction.config.waitingText}\n                                  </button>\n                                </DatePickerPopover>\n                              )\n                            ) : (\n                              <span className={`${\n                                statementReceivedAction.isCompleted(item)\n                                  ? 'button-action-primary' \n                                  : 'button-waiting-inactive'\n                              }`}>\n                                {statementReceivedAction.isCompleted(item) ? statementReceivedAction.config.completedText : statementReceivedAction.config.waitingText}\n                              </span>\n                            )}\n                          </div>\n                        )}\n\n                        {/* 회계상 입고일 - 전체항목 탭에서만 표시 */}\n                        {activeTab === 'done' && (\n                          <div className=\"text-center flex justify-center items-start pt-1\">\n                            {statementReceivedAction.getCompletedDate(item) ? (\n                              <div className=\"modal-subtitle text-blue-700\">\n                                {new Date(statementReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                            ) : (\n                              <span className=\"modal-subtitle text-gray-400\">-</span>\n                            )}\n                          </div>\n                        )}\n                        {/* 처리자 - 전체항목 탭에서만 표시 */}\n                        {activeTab === 'done' && (\n                          <div className=\"text-center flex justify-center items-start pt-1\">\n                            {statementReceivedAction.getCompletedByName(item) ? (\n                              <span className=\"modal-subtitle text-gray-600\">\n                                {statementReceivedAction.getCompletedByName(item)}\n                              </span>\n                            ) : (\n                              <span className=\"modal-subtitle text-gray-400\">-</span>\n                            )}\n                          </div>\n                        )}\n                      </div>\n                      \n                      {/* Mobile Layout */}\n                      <div className=\"block sm:hidden space-y-2\">\n                        <div className=\"flex justify-between items-start\">\n                          <div className=\"flex-1 min-w-0\">\n                            {isEditing ? (\n                              <Input\n                                value={item.item_name}\n                                onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                                className=\"modal-label border-gray-200 rounded-lg w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"품목명\"\n                              />\n                            ) : (\n                              <div className=\"modal-value font-medium\">{item.item_name || '품목명 없음'}</div>\n                            )}\n                            {isEditing ? (\n                              <Input\n                                value={item.specification}\n                                onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"규격\"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle text-gray-500\">{item.specification || '-'}</div>\n                            )}\n                          </div>\n                          <div className=\"ml-3 text-right flex-shrink-0\">\n                            {isEditing ? (\n                              <Input\n                                type=\"number\"\n                                value={item.amount_value}\n                                onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                                className=\"modal-label border-gray-200 rounded-lg text-right w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"합계\"\n                              />\n                            ) : (\n                              <div className=\"modal-value font-semibold\">₩{formatCurrency(item.amount_value || 0)}</div>\n                            )}\n                          </div>\n                        </div>\n                        \n                        <div className=\"grid grid-cols-3 gap-2 text-sm\">\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">수량:</span>\n                            {isEditing ? (\n                              <Input\n                                type=\"number\"\n                                value={item.quantity}\n                                onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"수량\"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle\">{item.quantity || 0}</div>\n                            )}\n                          </div>\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">단가:</span>\n                            {isEditing ? (\n                              <Input\n                                type=\"number\"\n                                value={item.unit_price_value}\n                                onChange={(e) => handleItemChange(index, 'unit_price_value', Number(e.target.value))}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"단가\"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle\">₩{formatCurrency(item.unit_price_value)}</div>\n                            )}\n                          </div>\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">상태:</span>\n                            <div className=\"mt-1\">\n                              {isEditing ? (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  onClick={() => handleRemoveItem(index)}\n                                  className=\"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6\"\n                                >\n                                  <Trash2 className=\"w-3 h-3\" />\n                                </Button>\n                              ) : (\n                                <>\n                                  {activeTab === 'purchase' && (\n                                    <>\n                                      {canPurchase ? (\n                                        <button\n                                          onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                                          className={`text-xs px-2 py-1 rounded transition-colors ${\n                                            item.is_payment_completed\n                                              ? 'bg-orange-500 text-white hover:bg-orange-600'\n                                              : 'bg-gray-100 text-gray-600'\n                                          }`}\n                                        >\n                                          {item.is_payment_completed ? '구매완료' : '구매대기'}\n                                        </button>\n                                      ) : (\n                                        <span className={`text-xs px-2 py-1 rounded ${\n                                          item.is_payment_completed \n                                            ? 'bg-orange-500 text-white' \n                                            : 'bg-gray-100 text-gray-400'\n                                        }`}>\n                                          {item.is_payment_completed ? '구매완료' : '구매대기'}\n                                        </span>\n                                      )}\n                                    </>\n                                  )}\n                                  \n                                  {activeTab === 'receipt' && (\n                                    <>\n                                      {canReceiptCheck ? (\n                                        actualReceivedAction.isCompleted(item) ? (\n                                          <button\n                                            onClick={() => {\n                                              actualReceivedAction.handleCancel(item.id, {\n                                                item_name: item.item_name,\n                                                specification: item.specification,\n                                                quantity: item.quantity,\n                                                unit_price_value: item.unit_price_value,\n                                                amount_value: item.amount_value,\n                                                remark: item.remark\n                                              })\n                                            }}\n                                            className=\"text-xs px-2 py-1 rounded button-action-primary\"\n                                          >\n                                            {actualReceivedAction.config.completedText}\n                                          </button>\n                                        ) : (\n                                          <DatePickerPopover\n                                            onDateSelect={(date) => {\n                                              actualReceivedAction.handleConfirm(item.id, date, {\n                                                item_name: item.item_name,\n                                                specification: item.specification,\n                                                quantity: item.quantity,\n                                                unit_price_value: item.unit_price_value,\n                                                amount_value: item.amount_value,\n                                                remark: item.remark\n                                              })\n                                            }}\n                                            placeholder=\"실제 입고된 날짜를 선택하세요\"\n                                            align=\"center\"\n                                            side=\"bottom\"\n                                          >\n                                            <button className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\">\n                                              {actualReceivedAction.config.waitingText}\n                                            </button>\n                                          </DatePickerPopover>\n                                        )\n                                      ) : (\n                                        <span className={`text-xs px-2 py-1 rounded ${\n                                          actualReceivedAction.isCompleted(item)\n                                            ? 'button-action-primary' \n                                            : 'bg-gray-100 text-gray-400'\n                                        }`}>\n                                          {actualReceivedAction.isCompleted(item) ? actualReceivedAction.config.completedText : actualReceivedAction.config.waitingText}\n                                        </span>\n                                      )}\n                                    </>\n                                  )}\n                                  \n                                  {activeTab === 'done' && (\n                                    <>\n                                      {/* 전체 항목 탭에서는 입고 상태만 표시 (클릭 불가) */}\n                                      <span className={`button-base ${\n                                        actualReceivedAction.isCompleted(item)\n                                          ? 'bg-green-500 text-white' \n                                          : 'border border-gray-300 text-gray-600 bg-white'\n                                      }`}>\n                                        {actualReceivedAction.isCompleted(item) ? '입고완료' : '입고대기'}\n                                      </span>\n                                    </>\n                                  )}\n                                  \n                                  {activeTab !== 'purchase' && activeTab !== 'receipt' && activeTab !== 'done' && (\n                                    <span className=\"text-xs text-gray-400\">-</span>\n                                  )}\n                                </>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                        \n                        {(item.remark || isEditing) && (\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">비고:</span>\n                            {isEditing ? (\n                              <Input\n                                value={item.remark || ''}\n                                onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"비고\"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle text-gray-500 mt-1\">{item.remark || '-'}</div>\n                            )}\n                          </div>\n                        )}\n                        \n                        {/* 모바일에서 실제 입고 날짜 표시 */}\n                        {!isEditing && activeTab === 'receipt' && actualReceivedAction.getCompletedDate(item) && (\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">실제입고일:</span>\n                            <div className=\"mt-1\">\n                              <div className=\"modal-subtitle text-green-700\">\n                                {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                              <div className=\"text-[9px] text-gray-500\">\n                                {new Date(actualReceivedAction.getCompletedDate(item)).toLocaleTimeString('ko-KR', {\n                                  hour: '2-digit',\n                                  minute: '2-digit'\n                                })}\n                              </div>\n                            </div>\n                          </div>\n                        )}\n\n                        {/* 모바일에서 거래명세서 확인 표시 - 전체항목 탭에서만 */}\n                        {!isEditing && activeTab === 'done' && (\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-gray-500 text-xs\">거래명세서 확인:</span>\n                            <div className=\"flex items-center gap-2\">\n                              {canReceiptCheck ? (\n                                statementReceivedAction.isCompleted(item) ? (\n                                  <button\n                                    onClick={() => {\n                                      statementReceivedAction.handleCancel(item.id, {\n                                        item_name: item.item_name,\n                                        specification: item.specification,\n                                        quantity: item.quantity,\n                                        unit_price_value: item.unit_price_value,\n                                        amount_value: item.amount_value,\n                                        remark: item.remark\n                                      })\n                                    }}\n                                    className=\"text-xs px-2 py-1 rounded button-action-primary hover:bg-green-600 transition-colors\"\n                                    title=\"클릭하여 거래명세서 확인 취소\"\n                                  >\n                                    {statementReceivedAction.config.completedText}\n                                  </button>\n                                ) : (\n                                  <DatePickerPopover\n                                    onDateSelect={(date) => {\n                                      statementReceivedAction.handleConfirm(item.id, date, {\n                                        item_name: item.item_name,\n                                        specification: item.specification,\n                                        quantity: item.quantity,\n                                        unit_price_value: item.unit_price_value,\n                                        amount_value: item.amount_value,\n                                        remark: item.remark\n                                      })\n                                    }}\n                                    placeholder=\"회계상 입고일을 선택하세요\"\n                                    align=\"end\"\n                                    side=\"bottom\"\n                                  >\n                                    <button \n                                      className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\"\n                                      onClick={() => {}}\n                                    >\n                                      {statementReceivedAction.config.waitingText}\n                                    </button>\n                                  </DatePickerPopover>\n                                )\n                              ) : (\n                                <span className={`text-xs px-2 py-1 rounded ${\n                                  statementReceivedAction.isCompleted(item)\n                                    ? 'button-action-primary' \n                                    : 'bg-gray-100 text-gray-400'\n                                }`}>\n                                  {statementReceivedAction.isCompleted(item) ? statementReceivedAction.config.completedText : statementReceivedAction.config.waitingText}\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                        )}\n\n                        {/* 모바일에서 회계상 입고일 표시 - 전체항목 탭에서만 */}\n                        {!isEditing && activeTab === 'done' && statementReceivedAction.getCompletedDate(item) && (\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">회계상 입고일:</span>\n                            <div className=\"mt-1\">\n                              <div className=\"modal-subtitle text-blue-700\">\n                                {new Date(statementReceivedAction.getCompletedDate(item)).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                            </div>\n                          </div>\n                        )}\n                        {/* 모바일에서 처리자 표시 - 전체항목 탭에서만 */}\n                        {!isEditing && activeTab === 'done' && statementReceivedAction.getCompletedByName(item) && (\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">처리자:</span>\n                            <div className=\"mt-1\">\n                              <div className=\"modal-subtitle text-gray-600\">\n                                {statementReceivedAction.getCompletedByName(item)}\n                              </div>\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                \n                {/* 합계 */}\n                <div className=\"bg-gray-50 px-2 sm:px-3 border-t border-gray-100\">\n                  <div className=\"hidden sm:grid items-center gap-3 py-0.5\" style={{\n                    gridTemplateColumns: getGridTemplateColumns()\n                  }}>\n                    {/* 품목명 */}\n                    <div></div>\n                    {/* 규격 */}\n                    <div></div>\n                    {/* 수량 */}\n                    <div></div>\n                    {/* 단가 */}\n                    <div className=\"text-right\">\n                      <span className=\"text-[12px] font-bold text-gray-900\">총액</span>\n                    </div>\n                    {/* 합계 */}\n                    <div className=\"text-right\">\n                      <span className=\"text-[12px] font-bold text-gray-900\">\n                        ₩{formatCurrency(\n                          (isEditing ? editedItems : purchase.items)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0\n                        )}\n                      </span>\n                    </div>\n                    {/* 나머지 칼럼들 */}\n                    <div></div>\n                    <div></div>\n                    {activeTab === 'receipt' && <div></div>}\n                  </div>\n                  \n                  {/* Mobile 총액 */}\n                  <div className=\"block sm:hidden py-0.5\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-[13px] font-bold text-gray-900\">총액</span>\n                      <span className=\"text-[13px] font-bold text-gray-900\">\n                        ₩{formatCurrency(\n                          (isEditing ? editedItems : purchase.items)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0\n                        )}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n                \n                {/* 항목 추가 버튼 */}\n                {isEditing && (\n                  <div className=\"p-2 sm:p-3 border-t border-gray-100\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={handleAddItem}\n                      className=\"w-full rounded-lg border-dashed border-2 border-gray-300 hover:border-gray-400 py-2 badge-text\"\n                    >\n                      <Plus className=\"w-4 h-4 mr-1\" />\n                      항목 추가\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"text-center py-12\">\n          <span className=\"modal-subtitle\">\n            발주 정보를 불러올 수 없습니다.\n          </span>\n        </div>\n      )}\n    </div>\n  )\n\n  // embedded가 true면 Dialog 없이 내용만 반환\n  if (embedded) {\n    return content\n  }\n\n  // embedded가 false면 Dialog로 감싸서 반환\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent \n        className=\"overflow-hidden bg-white rounded-lg shadow-sm border-0 w-[100vw] h-[100vh] sm:w-auto sm:min-w-[1000px] sm:max-w-none sm:max-h-[90vh] lg:max-h-[85vh] sm:rounded-lg flex flex-col\" \n        showCloseButton={false}\n      >\n        {/* Apple-style Header */}\n        <div className=\"relative px-3 sm:px-6 pt-0 sm:pt-3 lg:pt-4 pb-0 sm:pb-2 lg:pb-3 flex-shrink-0\">\n          <button\n            onClick={onClose}\n            className=\"button-base button-action-secondary absolute right-3 sm:right-6 top-0 sm:top-3 lg:top-4 w-6 h-6 sm:w-8 sm:h-8 rounded-full\"\n          >\n            <X className=\"w-4 h-4 text-gray-500\" />\n          </button>\n          \n          <div className=\"pr-8 sm:pr-16\">\n            <div className=\"flex items-start gap-4 mb-0 sm:mb-3\">\n              <div className=\"min-w-0 flex-1\">\n                <h1 className=\"page-title mb-0 sm:mb-1\">\n                  발주 기본정보\n                </h1>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                {!isEditing && canEdit && (\n                  <>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => handleEditToggle(true)}\n                      className=\"button-base button-action-secondary\"\n                    >\n                      <Edit2 className=\"w-4 h-4 mr-2\" />\n                      수정\n                    </Button>\n                    {canDelete && onDelete && (\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => purchase && onDelete(purchase)}\n                        className=\"button-base button-action-danger\"\n                      >\n                        <Trash2 className=\"w-4 h-4 mr-2\" />\n                        삭제\n                      </Button>\n                    )}\n                  </>\n                )}\n                {isEditing && (\n                  <>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => {\n                        handleEditToggle(false)\n                        setEditedPurchase(purchase)\n                        setEditedItems(purchase?.items || [])\n                        setDeletedItemIds([])\n                      }}\n                      className=\"button-base button-action-secondary\"\n                    >\n                      <X className=\"w-4 h-4 mr-2\" />\n                      취소\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      onClick={handleSave}\n                      className=\"button-base button-action-primary\"\n                    >\n                      <Save className=\"w-4 h-4 mr-2\" />\n                      저장\n                    </Button>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Apple-style Content */}\n        <div className=\"overflow-y-auto flex-1 px-3 sm:px-6 pb-1 sm:pb-6 mt-0\">\n          {content}\n        </div>\n      </DialogContent>\n      \n    </Dialog>\n  )\n}"],"names":["Truck","createLucideIcon","d","key","cx","cy","r","PurchaseDetailModal","purchaseId","isOpen","onClose","embedded","currentUserRoles","activeTab","onRefresh","onOptimisticUpdate","onDelete","loading","setLoading","useState","purchase","setPurchase","isEditing","setIsEditing","editedPurchase","setEditedPurchase","editedItems","setEditedItems","deletedItemIds","setDeletedItemIds","userRoles","setUserRoles","currentUserName","setCurrentUserName","columnWidths","setColumnWidths","headerRowRef","useRef","supabase","createClient","useEffect","async","supabaseUrl","includes","logger","warn","data","user","auth","getUser","employeeData","from","select","eq","id","maybeSingle","email","employeeByEmail","name","purchase_role","roles","Array","isArray","map","String","trim","split","filter","length","error","loadUserRoles","effectiveRoles","canEdit","canDelete","final_manager_status","requester_name","canPurchase","canReceiveItems","isAdmin","isRequester","canReceiptCheck","refreshModalData","useCallback","freshPurchase","single","items","debug","isInitialLoad","setIsInitialLoad","purchaseIdNumber","Number","NaN","handleActualReceiptOptimisticUpdate","itemId","selectedDate","action","itemIdStr","nowIso","Date","toISOString","selectedDateIso","updateItems","item","is_received","actual_received_date","received_at","prev","updatedItems","total","completed","allReceived","prevItems","isNaN","prevPurchase","statementReceivedAction","useConfirmDateAction","config","field","confirmMessage","confirm","cancel","successMessage","completedText","waitingText","canPerformAction","onUpdate","actualReceivedAction","requesterName","canApproveMiddle","canApproveFinal","approvalButtonClass","approvalWaitingPillClass","middleManagerStatus","middle_manager_status","finalManagerStatus","loadPurchaseDetail","toString","calculateOptimalColumnWidths","columnConfigs","minWidth","maxWidth","baseWidth","push","calculatedWidths","index","maxLength","headers","baseHeaders","getHeaders","Math","max","forEach","cellValue","item_name","specification","quantity","unit_price_value","toLocaleString","amount_value","remark","getStatusDisplay","formatDate","is_statement_received","statement_received_date","statement_received_by_name","adjustedLength","reduce","acc","char","test","ceil","calculatedWidth","min","range","purchase_status","receipt_status","getGridTemplateColumns","width","join","baseColumns","handleEditToggle","editing","sortedItems","purchase_request_items","sort","a","b","line_number","purchaseData","vendor","vendors","vendor_name","vendor_contacts","toast","formatCurrency","amount","Intl","NumberFormat","format","handleItemChange","value","newItems","unitPrice","handleRemoveItem","_","i","handlePaymentToggle","isCompleted","numericId","targetItem","find","itemInfo","unit","window","update","is_payment_completed","payment_completed_at","allCompleted","payment_completed_by_name","success","refreshResult","silent","Promise","handleApprove","type","approvalType","purchase_order_number","updateData","content","jsx","className","children","jsxs","payment_category","category","Badge","variant","getStatusBadge","Calendar","request_date","Button","size","onClick","Check","X","FileText","Input","request_type","onChange","e","target","placeholder","DatePickerPopover","onDateSelect","date","delivery_request_date","formatDateInput","align","side","revised_delivery_request_date","Building2","contact_name","updatedContacts","project_vendor","project_item","order_number","Package","Fragment","CreditCard","applyOptimisticUpdate","is","ref","style","gridTemplateColumns","Trash2","handleCancel","handleConfirm","getCompletedDate","toLocaleDateString","year","month","day","title","getCompletedByName","toLocaleTimeString","hour","minute","sum","newItem","lineNum","Plus","Dialog","open","onOpenChange","DialogContent","showCloseButton","Edit2","editedItemsCount","deletedItemsCount","totalAmount","updateError","total_amount","updated_at","deleteError","delete","in","count","itemName","Error","unit_price_currency","currency","amount_currency","insertData","purchase_request_id","indexOf","created_at","insert","errorMessage","message","Save"],"mappings":"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","x_google_ignoreList":[0]}