{"version":3,"mappings":"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","names":["employeeService","constructor","this","supabase","createClient","getEmployees","filters","query","from","select","order","search","or","department","eq","position","purchase_role","is_active","data","error","success","logger","Error","message","getEmployee","id","single","createEmployee","employeeData","email","existingEmployee","employeeId","crypto","randomUUID","insert","join","updateEmployee","neq","updateData","update","deleteEmployee","purchaseRequests","limit","length","delete","toggleEmployeeStatus","currentEmployee","selectError","updateEmployeeRole","role","getDepartments","Set","map","emp","filter","dept","sort","getPositions","pos","getEmployeesForExport","employee","name","phone","adress","getRoleDisplayName","created_at","Date","toLocaleDateString","app_admin","ceo","final_approver","middle_manager","buyer","checkPermission","userId","requiredRoles","hasPermission","includes","PURCHASE_ROLES","value","label","EmployeeFilters","onFiltersChange","onExport","onCreateNew","onAttendanceDownload","onAnnualLeaveUsageDownload","canManageEmployees","localSearch","setLocalSearch","useState","departments","setDepartments","positions","setPositions","useEffect","async","deptResult","posResult","Promise","all","loadOptions","hasFilters","jsxs","className","children","jsx","style","marginTop","marginBottom","Button","variant","onClick","Calendar","Download","Plus","onSubmit","e","preventDefault","trim","Search","Input","type","placeholder","onChange","target","Select","onValueChange","SelectTrigger","SelectValue","SelectContent","SelectItem","X","EmployeeTable","employees","onEdit","onView","onRefresh","currentUserRoles","loadingId","setLoadingId","sortedData","sortConfig","handleSort","useTableSort","canViewAllColumns","handleToggleStatus","result","toast","handleDelete","confirm","getRoleBadgeColor","Fragment","Table","TableHeader","TableRow","TableHead","SortableHeader","sortKey","currentSortKey","key","sortDirection","direction","onSort","TableBody","TableCell","colSpan","employeeID","employee_number","slice","annual_leave_granted_current_year","used_annual_leave","remaining_annual_leave","formatDate","join_date","birthday","bank","bank_account","DropdownMenu","DropdownMenuTrigger","asChild","disabled","MoreHorizontal","DropdownMenuContent","align","DropdownMenuItem","Eye","Edit","ToggleLeft","ToggleRight","Trash2","size","MobileCard","MobileCardHeader","MobileCardItem","MobileCardActions","EmployeeModal","isOpen","onClose","onSave","mode","isSubmitting","setIsSubmitting","form","useForm","defaultValues","reset","Array","isArray","split","isReadOnly","Dialog","open","onOpenChange","DialogContent","DialogHeader","DialogTitle","getTitle","Form","handleSubmit","FormField","control","rules","required","render","field","FormItem","FormLabel","FormControl","FormMessage","pattern","defaultValue","DialogFooter","Combobox","options","searchPlaceholder","emptyText","setOpen","React.useState","Popover","PopoverTrigger","cn","find","option","ChevronsUpDown","PopoverContent","Command","CommandInput","CommandEmpty","CommandGroup","CommandItem","onSelect","Check","generateAttendanceExcel","workbook","ExcelJS","Workbook","worksheet","addWorksheet","pageSetup","paperSize","orientation","margins","left","right","top","bottom","header","footer","columns","width","addRow","height","mergeCells","titleCell","getCell","font","bold","alignment","horizontal","vertical","employeeName","employeeCell","startDate","endDate","periodCell","headerRow","eachCell","cell","_colNumber","border","fill","fgColor","argb","records","forEach","record","workStatus","remarks","isWeekendOrHoliday","dateString","date","dayOfWeek","getDay","year","getFullYear","month","getMonth","day","getDate","holidays","dateStr","toString","padStart","isWeekendOrHolidayFunc","dataRow","workType","clockIn","clockOut","status","isSpecialDay","isLeaveDay","colNumber","buffer","xlsx","writeBuffer","Blob","formatDateWithDay","getDayOfWeek","AttendanceDownload","selectedEmployee","setSelectedEmployee","setStartDate","setEndDate","isDownloading","setIsDownloading","handleClose","User","a","b","localeCompare","now","start","end","toISOString","selectedEmp","attendanceRecords","gte","lte","ascending","allDates","setDate","push","recordMap","Map","set","excelRecords","get","dateWithDay","dateObj","isWeekend","clock_in","clock_out","excelData","blob","url","window","URL","createObjectURL","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","KOREAN_DAYS","toDateOnly","d","setHours","formatYmd","String","classifyLeaveForAnnualUsage","leave","toLowerCase","ok","reason","unit","typeRaw","reasonRaw","getLeaveUnit","daysNum","Number","days","NaN","isNaN","sp","start_period","ep","end_period","start_date","end_date","AnnualLeaveUsageDownload","setYear","min","max","yearNum","effectiveStart","effectiveEnd","leaveRows","leaveError","leaves","includedLeaves","l","cls","user_email","Boolean","excludedLeaves","excludeReason","summaries","details","params","rangeStart","rangeEnd","usedByEmail","leaveStart","leaveEnd","cursor","dow","ymd","dayUnit","leave_id","leave_start_date","leave_end_date","entries","used_days","calcAnnualLeaveUsageByWorkdays","employeesResult","empByEmail","targetEmails","s","targetEmployeeIds","employeeIdByEmail","has","monthlyMap","y","m","dayStr","byMonth","formatMonthCell","items","it","summaryRows","months","grantedDays","joinDateStr","targetYear","joinDate","getTime","joinYear","joinMonth","serviceYears","remainingMonths","Math","floor","calcGrantedAnnualLeaveForYear","usedDays","debug","wsSummary","getRow","nameA","nameB","cmp","row","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","wsIncluded","r","wsExcluded","generateAnnualLeaveUsageExcel","err","msg","EmployeeMain","useAuth","setEmployees","filteredEmployees","setFilteredEmployees","loading","setLoading","setFilters","isModalOpen","setIsModalOpen","modalMode","setModalMode","isAttendanceModalOpen","setIsAttendanceModalOpen","isAnnualLeaveUsageModalOpen","setIsAnnualLeaveUsageModalOpen","loadEmployees","XLSX","__vitePreload","import","__VITE_PRELOAD__","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","filename","writeFile"],"ignoreList":[],"sources":["../../src/services/employeeService.ts","../../src/components/employee/EmployeeFilters.tsx","../../src/components/employee/EmployeeTable.tsx","../../src/components/employee/EmployeeModal.tsx","../../src/components/ui/combobox.tsx","../../src/utils/exceljs/generateAttendanceExcel.ts","../../src/components/employee/AttendanceDownload.tsx","../../src/utils/leave/calcAnnualLeaveWorkdays.ts","../../src/components/employee/AnnualLeaveUsageDownload.tsx","../../src/utils/exceljs/generateAnnualLeaveUsageExcel.ts","../../src/components/employee/EmployeeMain.tsx"],"sourcesContent":["import { createClient } from \"@/lib/supabase/client\";\nimport { Employee, EmployeeFormData, EmployeeFilters, PurchaseRole } from \"@/types/purchase\";\nimport { logger } from \"@/lib/logger\";\n\nclass EmployeeService {\n  private supabase;\n\n  constructor() {\n    this.supabase = createClient();\n  }\n\n  // 직원 목록 조회\n  async getEmployees(filters?: EmployeeFilters): Promise<{ success: boolean; data?: Employee[]; error?: string }> {\n    try {\n      let query = this.supabase\n        .from('employees')\n        .select('*')\n        .order('name');\n\n      // 검색 필터 적용\n      if (filters?.search) {\n        query = query.or(`\n          name.ilike.%${filters.search}%,\n          email.ilike.%${filters.search}%,\n          phone.ilike.%${filters.search}%,\n          position.ilike.%${filters.search}%,\n          department.ilike.%${filters.search}%\n        `);\n      }\n\n      // 부서 필터 적용\n      if (filters?.department) {\n        query = query.eq('department', filters.department);\n      }\n\n      // 직급 필터 적용\n      if (filters?.position) {\n        query = query.eq('position', filters.position);\n      }\n\n      // 권한 필터 적용\n      if (filters?.purchase_role) {\n        query = query.eq('purchase_role', filters.purchase_role);\n      }\n\n      // 활성 상태 필터 적용\n      if (filters?.is_active !== undefined) {\n        query = query.eq('is_active', filters.is_active);\n      }\n\n      const { data, error } = await query;\n\n      if (error) throw error;\n\n      return { success: true, data: data || [] };\n    } catch (error) {\n      logger.error('직원 목록 조회 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 직원 상세 조회\n  async getEmployee(id: string): Promise<{ success: boolean; data?: Employee; error?: string }> {\n    try {\n      const { data, error } = await this.supabase\n        .from('employees')\n        .select('*')\n        .eq('id', id)\n        .single();\n\n      if (error) throw error;\n\n      return { success: true, data };\n    } catch (error) {\n      logger.error('직원 조회 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 직원 생성\n  async createEmployee(employeeData: EmployeeFormData): Promise<{ success: boolean; data?: Employee; error?: string }> {\n    try {\n      // 이메일 중복 체크\n      if (employeeData.email) {\n        const { data: existingEmployee } = await this.supabase\n          .from('employees')\n          .select('id')\n          .eq('email', employeeData.email)\n          .single();\n\n        if (existingEmployee) {\n          return { success: false, error: '이미 등록된 이메일입니다.' };\n        }\n      }\n\n      // ID 생성 (UUID 형태)\n      const employeeId = crypto.randomUUID();\n\n      const { data, error } = await this.supabase\n        .from('employees')\n        .insert({\n          id: employeeId,\n          ...employeeData,\n          purchase_role: employeeData.purchase_role?.join(',') || null,\n          is_active: true\n        })\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      return { success: true, data };\n    } catch (error) {\n      logger.error('직원 생성 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 직원 수정\n  async updateEmployee(id: string, employeeData: Partial<EmployeeFormData>): Promise<{ success: boolean; data?: Employee; error?: string }> {\n    try {\n      // 이메일 중복 체크 (자신 제외)\n      if (employeeData.email) {\n        const { data: existingEmployee } = await this.supabase\n          .from('employees')\n          .select('id')\n          .eq('email', employeeData.email)\n          .neq('id', id)\n          .single();\n\n        if (existingEmployee) {\n          return { success: false, error: '이미 등록된 이메일입니다.' };\n        }\n      }\n\n      const updateData = {\n        ...employeeData,\n        purchase_role: employeeData.purchase_role ? employeeData.purchase_role.join(',') : undefined\n      };\n      \n      // undefined 값 제거\n      if (updateData.purchase_role === undefined) {\n        delete updateData.purchase_role;\n      }\n      \n      const { data, error } = await this.supabase\n        .from('employees')\n        .update(updateData)\n        .eq('id', id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      return { success: true, data };\n    } catch (error) {\n      logger.error('직원 수정 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 직원 삭제 (소프트 삭제)\n  async deleteEmployee(id: string): Promise<{ success: boolean; error?: string }> {\n    try {\n      // 발주 요청과 연결된 직원인지 확인\n      const { data: purchaseRequests } = await this.supabase\n        .from('purchase_requests')\n        .select('id')\n        .eq('requester_id', id)\n        .limit(1);\n\n      if (purchaseRequests && purchaseRequests.length > 0) {\n        // 발주 요청과 연결된 직원은 비활성화만 가능\n        const { error } = await this.supabase\n          .from('employees')\n          .update({ is_active: false })\n          .eq('id', id);\n\n        if (error) throw error;\n\n        return { success: true };\n      } else {\n        // 연결된 데이터가 없으면 완전 삭제\n        const { error } = await this.supabase\n          .from('employees')\n          .delete()\n          .eq('id', id);\n\n        if (error) throw error;\n\n        return { success: true };\n      }\n    } catch (error) {\n      logger.error('직원 삭제 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 직원 활성화/비활성화 토글\n  async toggleEmployeeStatus(id: string): Promise<{ success: boolean; data?: Employee; error?: string }> {\n    try {\n      // 현재 상태 조회\n      const { data: currentEmployee, error: selectError } = await this.supabase\n        .from('employees')\n        .select('is_active')\n        .eq('id', id)\n        .single();\n\n      if (selectError) throw selectError;\n\n      // 상태 토글\n      const { data, error } = await this.supabase\n        .from('employees')\n        .update({ is_active: !currentEmployee.is_active })\n        .eq('id', id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      return { success: true, data };\n    } catch (error) {\n      logger.error('직원 상태 변경 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n\n\n  // 권한 변경\n  async updateEmployeeRole(id: string, role: PurchaseRole | null): Promise<{ success: boolean; data?: Employee; error?: string }> {\n    try {\n      const { data, error } = await this.supabase\n        .from('employees')\n        .update({ purchase_role: role })\n        .eq('id', id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      return { success: true, data };\n    } catch (error) {\n      logger.error('직원 권한 변경 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 부서 목록 조회\n  async getDepartments(): Promise<{ success: boolean; data?: string[]; error?: string }> {\n    try {\n      const { data, error } = await this.supabase\n        .from('employees')\n        .select('department');\n\n      if (error) throw error;\n\n      // 클라이언트 사이드에서 null과 빈 문자열 필터링 후 중복 제거하고 정렬\n      const departments = [...new Set((data || [])\n        .map((emp: any) => emp.department)\n        .filter((dept: any) => dept != null && dept !== '')\n      )].sort() as string[];\n\n      return { success: true, data: departments };\n    } catch (error) {\n      logger.error('부서 목록 조회 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 직급 목록 조회\n  async getPositions(): Promise<{ success: boolean; data?: string[]; error?: string }> {\n    try {\n      const { data, error } = await this.supabase\n        .from('employees')\n        .select('position');\n\n      if (error) throw error;\n\n      // 클라이언트 사이드에서 null과 빈 문자열 필터링 후 중복 제거하고 정렬\n      const positions = [...new Set((data || [])\n        .map((emp: any) => emp.position)\n        .filter((pos: any) => pos != null && pos !== '')\n      )].sort() as string[];\n\n      return { success: true, data: positions };\n    } catch (error) {\n      logger.error('직급 목록 조회 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // Excel 내보내기용 데이터 준비\n  async getEmployeesForExport(): Promise<{ success: boolean; data?: Array<Record<string, string>>; error?: string }> {\n    try {\n      const { data, error } = await this.supabase\n        .from('employees')\n        .select('*')\n        .order('name');\n\n      if (error) throw error;\n\n      // Excel 형식에 맞게 데이터 변환\n      const exportData = (data || []).map((employee: any) => ({\n        '이름': employee.name,\n        '이메일': employee.email || '',\n        '전화번호': employee.phone || '',\n        '주소': employee.adress || '',\n        '부서': employee.department || '',\n        '직급': employee.position || '',\n        '권한': this.getRoleDisplayName(employee.purchase_role),\n        '상태': employee.is_active ? '활성' : '비활성',\n        '등록일': employee.created_at ? new Date(employee.created_at).toLocaleDateString('ko-KR') : ''\n      }));\n\n      return { success: true, data: exportData };\n    } catch (error) {\n      logger.error('직원 Excel 내보내기 실패', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n\n  // 권한명 표시용 변환\n  private getRoleDisplayName(role?: string): string {\n    const roleNames: Record<string, string> = {\n      'app_admin': '앱 관리자',\n      'ceo': 'CEO',\n      'final_approver': '최종 승인자',\n      'middle_manager': '중간 관리자',\n      'lead buyer': '수석 구매자',\n      'buyer': '구매자'\n    };\n    \n    return roleNames[role || ''] || role || '권한 없음';\n  }\n\n  // 권한 체크 함수\n  async checkPermission(userId: string, requiredRoles: string[]): Promise<{ success: boolean; hasPermission?: boolean; error?: string }> {\n    try {\n      const { data: employee } = await this.supabase\n        .from('employees')\n        .select('purchase_role, is_active')\n        .eq('id', userId)\n        .single();\n\n      if (!employee || !employee.is_active) {\n        return { success: true, hasPermission: false };\n      }\n\n      const hasPermission = requiredRoles.includes(employee.purchase_role);\n      return { success: true, hasPermission };\n    } catch (error) {\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : '알 수 없는 오류가 발생했습니다.' \n      };\n    }\n  }\n}\n\nexport const employeeService = new EmployeeService();","\nimport { useState, useEffect } from 'react'\nimport { EmployeeFilters as EmployeeFiltersType, PurchaseRole } from '@/types/purchase'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Search, X, Download, Plus, Calendar } from 'lucide-react'\nimport { employeeService } from '@/services/employeeService'\n\ninterface EmployeeFiltersProps {\n  filters: EmployeeFiltersType\n  onFiltersChange: (filters: EmployeeFiltersType) => void\n  onExport: () => void\n  onCreateNew: () => void\n  onAttendanceDownload: () => void\n  onAnnualLeaveUsageDownload: () => void\n  canManageEmployees?: boolean\n}\n\nconst PURCHASE_ROLES: { value: PurchaseRole; label: string }[] = [\n  { value: 'app_admin', label: '앱 관리자' },\n  { value: 'ceo', label: 'CEO' },\n  { value: 'final_approver', label: '최종 승인자' },\n  { value: 'middle_manager', label: '중간 관리자' },\n  { value: 'lead buyer', label: '수석 구매자' },\n  { value: 'buyer', label: '구매자' },\n]\n\nexport default function EmployeeFilters({ \n  filters, \n  onFiltersChange, \n  onExport,\n  onCreateNew,\n  onAttendanceDownload,\n  onAnnualLeaveUsageDownload\n  ,\n  canManageEmployees = false\n}: EmployeeFiltersProps) {\n  const [localSearch, setLocalSearch] = useState(filters.search || '')\n  const [departments, setDepartments] = useState<string[]>([])\n  const [positions, setPositions] = useState<string[]>([])\n\n  useEffect(() => {\n    // 부서와 직급 목록 로드\n    const loadOptions = async () => {\n      const [deptResult, posResult] = await Promise.all([\n        employeeService.getDepartments(),\n        employeeService.getPositions()\n      ])\n      \n      if (deptResult.success) {\n        setDepartments(deptResult.data || [])\n      }\n      \n      if (posResult.success) {\n        setPositions(posResult.data || [])\n      }\n    }\n    \n    loadOptions()\n  }, [])\n\n  const handleSearchSubmit = (e: React.FormEvent) => {\n    e.preventDefault()\n    onFiltersChange({\n      ...filters,\n      search: localSearch.trim() || undefined\n    })\n  }\n\n  const handleDepartmentChange = (value: string) => {\n    onFiltersChange({\n      ...filters,\n      department: value === 'all' ? undefined : value\n    })\n  }\n\n  const handlePositionChange = (value: string) => {\n    onFiltersChange({\n      ...filters,\n      position: value === 'all' ? undefined : value\n    })\n  }\n\n  const handleRoleChange = (value: string) => {\n    onFiltersChange({\n      ...filters,\n      purchase_role: value === 'all' ? undefined : value === 'none' ? '' : value\n    })\n  }\n\n  const handleStatusChange = (value: string) => {\n    onFiltersChange({\n      ...filters,\n      is_active: value === 'all' ? undefined : value === 'active'\n    })\n  }\n\n  const clearFilters = () => {\n    setLocalSearch('')\n    onFiltersChange({})\n  }\n\n  const hasFilters = filters.search || \n                     filters.department || \n                     filters.position || \n                     filters.purchase_role || \n                     filters.is_active !== undefined\n\n  return (\n    <div className=\"space-y-4\">\n      {/* 상단 액션 버튼 */}\n      <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4\">\n        <div>\n          <h2 className=\"page-title\">직원 관리</h2>\n          <p className=\"page-subtitle\" style={{marginTop:'-2px',marginBottom:'-4px'}}>Employee Management</p>\n        </div>\n        {canManageEmployees && (\n        <div className=\"flex gap-2\">\n          <Button\n            variant=\"outline\"\n            onClick={onAnnualLeaveUsageDownload}\n            className=\"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm\"\n          >\n            <Calendar className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n            <span className=\"hidden sm:inline\">연차사용현황</span>\n            <span className=\"sm:hidden\">연차</span>\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={onAttendanceDownload}\n            className=\"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm\"\n          >\n            <Calendar className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n            <span className=\"hidden sm:inline\">출근현황표</span>\n            <span className=\"sm:hidden\">출근</span>\n          </Button>\n          <Button\n            variant=\"outline\"\n            onClick={onExport}\n            className=\"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm\"\n          >\n            <Download className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n            <span className=\"hidden sm:inline\">Excel 내보내기</span>\n            <span className=\"sm:hidden\">Excel</span>\n          </Button>\n          <Button \n            onClick={onCreateNew}\n            className=\"flex items-center gap-1 sm:gap-2 text-xs sm:text-sm\"\n          >\n            <Plus className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n            직원 등록\n          </Button>\n        </div>\n        )}\n      </div>\n\n      {/* 필터 섹션 */}\n      <div className=\"bg-white p-3 sm:p-4 rounded-lg border space-y-4\">\n        <form onSubmit={handleSearchSubmit} className=\"flex flex-col sm:flex-row gap-3 sm:gap-4 sm:items-end sm:flex-wrap\">\n          {/* 검색 */}\n          <div className=\"flex-1 sm:min-w-[250px]\">\n            <label className=\"block text-xs sm:text-sm font-medium text-gray-700 mb-1\">\n              검색\n            </label>\n            <div className=\"relative\">\n              <Search className=\"absolute left-2 sm:left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3 sm:w-4 sm:h-4\" />\n              <Input\n                type=\"text\"\n                placeholder=\"이름, 이메일, 전화번호로 검색\"\n                value={localSearch}\n                onChange={(e) => setLocalSearch(e.target.value)}\n                className=\"pl-8 sm:pl-10 text-sm h-9\"\n              />\n            </div>\n          </div>\n\n          {/* 부서 필터 */}\n          <div className=\"w-full sm:w-auto sm:min-w-[120px]\">\n            <label className=\"block text-xs sm:text-sm font-medium text-gray-700 mb-1\">\n              부서\n            </label>\n            <Select\n              value={filters.department || 'all'}\n              onValueChange={handleDepartmentChange}\n            >\n              <SelectTrigger className=\"h-9\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">전체 부서</SelectItem>\n                {departments.map((dept) => (\n                  <SelectItem key={dept} value={dept}>\n                    {dept}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* 직급 필터 */}\n          <div className=\"w-full sm:w-auto sm:min-w-[120px]\">\n            <label className=\"block text-xs sm:text-sm font-medium text-gray-700 mb-1\">\n              직급\n            </label>\n            <Select\n              value={filters.position || 'all'}\n              onValueChange={handlePositionChange}\n            >\n              <SelectTrigger className=\"h-9\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">전체 직급</SelectItem>\n                {positions.map((pos) => (\n                  <SelectItem key={pos} value={pos}>\n                    {pos}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* 권한 필터 */}\n          <div className=\"w-full sm:w-auto sm:min-w-[140px]\">\n            <label className=\"block text-xs sm:text-sm font-medium text-gray-700 mb-1\">\n              권한\n            </label>\n            <Select\n              value={filters.purchase_role || 'all'}\n              onValueChange={handleRoleChange}\n            >\n              <SelectTrigger className=\"h-9\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">전체 권한</SelectItem>\n                <SelectItem value=\"none\">권한 없음</SelectItem>\n                {PURCHASE_ROLES.map((role) => (\n                  <SelectItem key={role.value} value={role.value}>\n                    {role.label}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* 상태 필터 */}\n          <div className=\"w-full sm:w-auto sm:min-w-[100px]\">\n            <label className=\"block text-xs sm:text-sm font-medium text-gray-700 mb-1\">\n              상태\n            </label>\n            <Select\n              value={\n                filters.is_active === undefined \n                  ? 'all' \n                  : filters.is_active \n                    ? 'active' \n                    : 'inactive'\n              }\n              onValueChange={handleStatusChange}\n            >\n              <SelectTrigger className=\"h-9\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">전체</SelectItem>\n                <SelectItem value=\"active\">활성</SelectItem>\n                <SelectItem value=\"inactive\">비활성</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* 검색 및 초기화 버튼 */}\n          <div className=\"flex gap-2 w-full sm:w-auto\">\n            <Button type=\"submit\" className=\"flex-1 sm:flex-none h-9 text-sm\">\n              검색\n            </Button>\n            {hasFilters && (\n              <Button \n                type=\"button\" \n                variant=\"outline\" \n                onClick={clearFilters}\n                className=\"flex items-center gap-1 h-9 text-sm\"\n              >\n                <X className=\"w-3 h-3 sm:w-4 sm:h-4\" />\n                <span className=\"hidden sm:inline\">초기화</span>\n                <span className=\"sm:hidden\">초기</span>\n              </Button>\n            )}\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}","\nimport { useState } from 'react'\nimport { Employee } from '@/types/purchase'\nimport { formatDate } from '@/utils/helpers'\nimport { Button } from '@/components/ui/button'\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from '@/components/ui/table'\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu'\nimport { \n  MoreHorizontal, \n  Edit, \n  Trash2, \n  Eye, \n  ToggleLeft, \n  ToggleRight,\n  Shield\n} from 'lucide-react'\nimport { employeeService } from '@/services/employeeService'\nimport { toast } from 'sonner'\nimport { useTableSort } from '@/hooks/useTableSort'\nimport { SortableHeader } from '@/components/ui/sortable-header'\nimport { MobileCard, MobileCardItem, MobileCardHeader, MobileCardActions } from '@/components/ui/mobile-card'\n\ninterface EmployeeTableProps {\n  employees: Employee[]\n  onEdit: (employee: Employee) => void\n  onView: (employee: Employee) => void\n  onRefresh: () => void\n  currentUserRoles?: string[]\n}\n\nexport default function EmployeeTable({ employees, onEdit, onView, onRefresh, currentUserRoles = [] }: EmployeeTableProps) {\n  const [loadingId, setLoadingId] = useState<string | null>(null)\n  const { sortedData, sortConfig, handleSort } = useTableSort(employees, 'name', 'asc')\n  const canViewAllColumns = currentUserRoles.includes('app_admin') || currentUserRoles.includes('hr')\n\n  const handleToggleStatus = async (employee: Employee) => {\n    if (!canViewAllColumns) {\n      toast.error('상태 변경 권한이 없습니다.')\n      return\n    }\n    setLoadingId(employee.id)\n    try {\n      const result = await employeeService.toggleEmployeeStatus(employee.id)\n      \n      if (result.success) {\n        toast.success(`직원이 ${employee.is_active ? '비활성화' : '활성화'}되었습니다.`)\n        onRefresh()\n      } else {\n        toast.error(result.error || '상태 변경에 실패했습니다.')\n      }\n    } catch (error) {\n      toast.error('상태 변경 중 오류가 발생했습니다.')\n    } finally {\n      setLoadingId(null)\n    }\n  }\n\n  const handleDelete = async (employee: Employee) => {\n    if (!canViewAllColumns) {\n      toast.error('삭제 권한이 없습니다.')\n      return\n    }\n    if (!confirm(`정말로 '${employee.name}' 직원을 삭제하시겠습니까?`)) {\n      return\n    }\n\n    setLoadingId(employee.id)\n    try {\n      const result = await employeeService.deleteEmployee(employee.id)\n      \n      if (result.success) {\n        toast.success('직원이 삭제되었습니다.')\n        onRefresh()\n      } else {\n        toast.error(result.error || '삭제에 실패했습니다.')\n      }\n    } catch (error) {\n      toast.error('삭제 중 오류가 발생했습니다.')\n    } finally {\n      setLoadingId(null)\n    }\n  }\n\n  const getRoleDisplayName = (role?: string) => {\n    const roleNames: Record<string, string> = {\n      'app_admin': '앱 관리자',\n      'ceo': 'CEO',\n      'final_approver': '최종 승인자',\n      'middle_manager': '중간 관리자',\n      'lead buyer': '수석 구매자',\n      'buyer': '구매자'\n    }\n    \n    return roleNames[role || ''] || '권한 없음'\n  }\n\n  const getRoleBadgeColor = (role?: string) => {\n    const colorMap: Record<string, string> = {\n      'app_admin': 'bg-purple-100 text-purple-800',\n      'ceo': 'bg-red-100 text-red-800',\n      'final_approver': 'bg-hansl-100 text-hansl-800',\n      'middle_manager': 'bg-green-100 text-green-800',\n      'lead buyer': 'bg-yellow-100 text-yellow-800',\n      'buyer': 'bg-gray-100 text-gray-800'\n    }\n    \n    return colorMap[role || ''] || 'bg-gray-100 text-gray-600'\n  }\n\n  // formatDate는 utils/helpers.ts에서 import\n\n  return (\n    <>\n      {/* Desktop Table View */}\n      <div className=\"hidden lg:block border rounded-lg overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead className=\"w-16 min-w-[50px]\">\n              <SortableHeader\n                sortKey=\"employeeID\"\n                currentSortKey={sortConfig.key as string | null}\n                sortDirection={sortConfig.direction}\n                onSort={() => handleSort('employeeID' as keyof Employee)}\n              >\n                사번\n              </SortableHeader>\n            </TableHead>\n            <TableHead className=\"w-14 min-w-[45px]\">\n              <SortableHeader\n                sortKey=\"name\"\n                currentSortKey={sortConfig.key as string | null}\n                sortDirection={sortConfig.direction}\n                onSort={() => handleSort('name' as keyof Employee)}\n              >\n                이름\n              </SortableHeader>\n            </TableHead>\n            <TableHead className=\"w-12 min-w-[40px]\">\n              <SortableHeader\n                sortKey=\"position\"\n                currentSortKey={sortConfig.key as string | null}\n                sortDirection={sortConfig.direction}\n                onSort={() => handleSort('position' as keyof Employee)}\n              >\n                직급\n              </SortableHeader>\n            </TableHead>\n            <TableHead className=\"w-16 min-w-[50px]\">\n              <SortableHeader\n                sortKey=\"department\"\n                currentSortKey={sortConfig.key as string | null}\n                sortDirection={sortConfig.direction}\n                onSort={() => handleSort('department' as keyof Employee)}\n              >\n                부서\n              </SortableHeader>\n            </TableHead>\n            <TableHead className=\"w-20 min-w-[70px]\">\n              <SortableHeader\n                sortKey=\"phone\"\n                currentSortKey={sortConfig.key as string | null}\n                sortDirection={sortConfig.direction}\n                onSort={() => handleSort('phone' as keyof Employee)}\n              >\n                연락처\n              </SortableHeader>\n            </TableHead>\n            <TableHead className=\"w-32 min-w-[100px]\">\n              <SortableHeader\n                sortKey=\"email\"\n                currentSortKey={sortConfig.key as string | null}\n                sortDirection={sortConfig.direction}\n                onSort={() => handleSort('email' as keyof Employee)}\n              >\n                이메일\n              </SortableHeader>\n            </TableHead>\n            {canViewAllColumns && (\n              <>\n                {/* 연차 정보 */}\n                <TableHead className=\"w-11 min-w-[40px] text-center\">생성</TableHead>\n                <TableHead className=\"w-11 min-w-[40px] text-center\">사용</TableHead>\n                <TableHead className=\"w-11 min-w-[40px] text-center\">남은</TableHead>\n                {/* lg 이상에서만 표시되는 칼럼들 */}\n                <TableHead className=\"hidden lg:table-cell w-18 min-w-[60px]\">\n                  <SortableHeader\n                    sortKey=\"join_date\"\n                    currentSortKey={sortConfig.key as string | null}\n                    sortDirection={sortConfig.direction}\n                    onSort={() => handleSort('join_date' as keyof Employee)}\n                  >\n                    입사일\n                  </SortableHeader>\n                </TableHead>\n                <TableHead className=\"hidden lg:table-cell w-20 min-w-[70px]\">\n                  <SortableHeader\n                    sortKey=\"birthday\"\n                    currentSortKey={sortConfig.key as string | null}\n                    sortDirection={sortConfig.direction}\n                    onSort={() => handleSort('birthday' as keyof Employee)}\n                  >\n                    생년월일\n                  </SortableHeader>\n                </TableHead>\n                {/* 민감한 정보 */}\n                <TableHead className=\"hidden xl:table-cell w-14 min-w-[45px]\">은행</TableHead>\n                <TableHead className=\"hidden xl:table-cell w-24 min-w-[80px]\">계좌번호</TableHead>\n                <TableHead className=\"hidden 2xl:table-cell min-w-[120px]\">주소</TableHead>\n                <TableHead>\n                  <SortableHeader\n                    sortKey=\"purchase_role\"\n                    currentSortKey={sortConfig.key as string | null}\n                    sortDirection={sortConfig.direction}\n                    onSort={() => handleSort('purchase_role' as keyof Employee)}\n                  >\n                    권한\n                  </SortableHeader>\n                </TableHead>\n                <TableHead>\n                  <SortableHeader\n                    sortKey=\"is_active\"\n                    currentSortKey={sortConfig.key as string | null}\n                    sortDirection={sortConfig.direction}\n                    onSort={() => handleSort('is_active' as keyof Employee)}\n                  >\n                    상태\n                  </SortableHeader>\n                </TableHead>\n                <TableHead className=\"w-16 min-w-[50px]\">작업</TableHead>\n              </>\n            )}\n              </TableRow>\n            </TableHeader>\n        <TableBody>\n          {employees.length === 0 ? (\n            <TableRow>\n              <TableCell colSpan={canViewAllColumns ? 14 : 6} className=\"text-center py-8 text-gray-500\">\n                등록된 직원이 없습니다.\n              </TableCell>\n            </TableRow>\n          ) : (\n            sortedData.map((employee) => (\n              <TableRow key={employee.id}>\n                <TableCell className=\"text-[11px] px-2 py-1.5\">\n                  {employee.employeeID || employee.employee_number || employee.id.slice(0, 8)}\n                </TableCell>\n                <TableCell className=\"text-[11px] px-2 py-1.5\">\n                  {employee.name}\n                </TableCell>\n                <TableCell className=\"text-[11px] px-2 py-1.5\">{employee.position || '-'}</TableCell>\n                <TableCell className=\"text-[11px] px-2 py-1.5\">{employee.department || '-'}</TableCell>\n                <TableCell className=\"text-[11px] px-2 py-1.5\">{employee.phone || '-'}</TableCell>\n                <TableCell className=\"text-[11px] px-2 py-1.5\">{employee.email || '-'}</TableCell>\n                {canViewAllColumns && (\n                  <>\n                    {/* 연차 정보 */}\n                    <TableCell className=\"text-center text-[11px] px-1 py-1.5\">\n                      {employee.annual_leave_granted_current_year || 0}\n                    </TableCell>\n                    <TableCell className=\"text-center text-[11px] px-1 py-1.5\">\n                      {employee.used_annual_leave || 0}\n                    </TableCell>\n                    <TableCell className=\"text-center text-[11px] px-1 py-1.5\">\n                      {employee.remaining_annual_leave !== undefined \n                        ? employee.remaining_annual_leave\n                        : '-'}\n                    </TableCell>\n                    {/* lg 이상에서만 표시되는 칼럼들 */}\n                    <TableCell className=\"hidden lg:table-cell text-[11px] px-2 py-1.5\">\n                      {formatDate(employee.join_date)}\n                    </TableCell>\n                    <TableCell className=\"hidden lg:table-cell text-[11px] px-2 py-1.5\">\n                      {formatDate(employee.birthday)}\n                    </TableCell>\n                    {/* 민감한 정보 */}\n                    <TableCell className=\"hidden xl:table-cell text-[11px] px-2 py-1.5\">{employee.bank || '-'}</TableCell>\n                    <TableCell className=\"hidden xl:table-cell text-[11px] px-2 py-1.5\">{employee.bank_account || '-'}</TableCell>\n                    <TableCell className=\"hidden 2xl:table-cell text-[11px] px-2 py-1.5\">{employee.adress || '-'}</TableCell>\n                    <TableCell className=\"px-2 py-1.5\">\n                      <span\n                        className={`badge-stats text-[10px] px-1.5 py-0.5 ${getRoleBadgeColor(employee.purchase_role)}`}\n                      >\n                        {getRoleDisplayName(employee.purchase_role)}\n                      </span>\n                    </TableCell>\n                    <TableCell className=\"px-2 py-1.5\">\n                      <span\n                        className={`badge-stats text-[10px] px-1.5 py-0.5 ${employee.is_active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}`}\n                      >\n                        {employee.is_active ? '활성' : '비활성'}\n                      </span>\n                    </TableCell>\n                    <TableCell className=\"px-1 py-1.5\">\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button\n                            variant=\"ghost\"\n                            className=\"h-7 w-7 p-0\"\n                            disabled={loadingId === employee.id}\n                          >\n                            <MoreHorizontal className=\"h-3 w-3\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem onClick={() => onView(employee)}>\n                            <Eye className=\"mr-2 h-4 w-4\" />\n                            상세 보기\n                          </DropdownMenuItem>\n                          <DropdownMenuItem onClick={() => onEdit(employee)}>\n                            <Edit className=\"mr-2 h-4 w-4\" />\n                            수정\n                          </DropdownMenuItem>\n                          <DropdownMenuItem onClick={() => handleToggleStatus(employee)}>\n                            {employee.is_active ? (\n                              <>\n                                <ToggleLeft className=\"mr-2 h-4 w-4\" />\n                                비활성화\n                              </>\n                            ) : (\n                              <>\n                                <ToggleRight className=\"mr-2 h-4 w-4\" />\n                                활성화\n                              </>\n                            )}\n                          </DropdownMenuItem>\n                          <DropdownMenuItem \n                            onClick={() => handleDelete(employee)}\n                            className=\"text-red-600\"\n                          >\n                            <Trash2 className=\"mr-2 h-4 w-4\" />\n                            삭제\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </TableCell>\n                  </>\n                )}\n              </TableRow>\n            ))\n          )}\n        </TableBody>\n          </Table>\n        </div>\n      </div>\n\n      {/* Tablet View */}\n      <div className=\"hidden md:block lg:hidden\">\n        <div className=\"overflow-x-auto border rounded-lg\">\n          <table className={`w-full ${canViewAllColumns ? 'min-w-[700px]' : 'min-w-[520px]'}`}>\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"text-left p-3 header-title text-gray-900 w-16\">사번</th>\n                <th className=\"text-left p-3 header-title text-gray-900 w-20\">이름</th>\n                <th className=\"text-left p-3 header-title text-gray-900 w-20\">직급</th>\n                <th className=\"text-left p-3 header-title text-gray-900 w-24\">부서</th>\n                <th className=\"text-left p-3 header-title text-gray-900\">연락처</th>\n                <th className=\"text-left p-3 header-title text-gray-900\">이메일</th>\n                {canViewAllColumns && (\n                  <>\n                    <th className=\"text-left p-3 header-title text-gray-900 w-24\">권한</th>\n                    <th className=\"text-center p-3 header-title text-gray-900 w-16\">상태</th>\n                    <th className=\"text-center p-3 header-title text-gray-900 w-16\">작업</th>\n                  </>\n                )}\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {sortedData.length === 0 ? (\n                <tr>\n                  <td colSpan={canViewAllColumns ? 9 : 6} className=\"text-center py-8 text-gray-500\">\n                    등록된 직원이 없습니다.\n                  </td>\n                </tr>\n              ) : (\n                sortedData.map((employee) => (\n                  <tr key={employee.id} className=\"hover:bg-gray-50\">\n                    <td className=\"p-3 modal-subtitle\">\n                      {employee.employeeID || employee.employee_number || employee.id.slice(0, 8)}\n                    </td>\n                    <td className=\"p-3 modal-value\">{employee.name}</td>\n                    <td className=\"p-3 modal-subtitle\">{employee.position || '-'}</td>\n                    <td className=\"p-3 modal-subtitle\">{employee.department || '-'}</td>\n                    <td className=\"p-3 modal-subtitle\">{employee.phone || '-'}</td>\n                    <td className=\"p-3 modal-subtitle\">{employee.email || '-'}</td>\n                    {canViewAllColumns && (\n                      <>\n                        <td className=\"p-3\">\n                          <span className={`badge-stats text-xs ${getRoleBadgeColor(employee.purchase_role)}`}>\n                            {getRoleDisplayName(employee.purchase_role)}\n                          </span>\n                        </td>\n                        <td className=\"p-3 text-center\">\n                          <span\n                            className={`badge-stats text-xs ${employee.is_active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}`}\n                          >\n                            {employee.is_active ? '활성' : '비활성'}\n                          </span>\n                        </td>\n                        <td className=\"p-3 text-center\">\n                          <DropdownMenu>\n                            <DropdownMenuTrigger asChild>\n                              <Button variant=\"ghost\" size=\"sm\" className=\"h-8 w-8 p-0\">\n                                <MoreHorizontal className=\"h-4 w-4\" />\n                              </Button>\n                            </DropdownMenuTrigger>\n                            <DropdownMenuContent align=\"end\">\n                              <DropdownMenuItem onClick={() => onView(employee)}>\n                                <Eye className=\"mr-2 h-4 w-4\" />\n                                상세 보기\n                              </DropdownMenuItem>\n                              <DropdownMenuItem onClick={() => onEdit(employee)}>\n                                <Edit className=\"mr-2 h-4 w-4\" />\n                                수정\n                              </DropdownMenuItem>\n                              <DropdownMenuItem onClick={() => handleToggleStatus(employee)}>\n                                {employee.is_active ? (\n                                  <>\n                                    <ToggleLeft className=\"mr-2 h-4 w-4\" />\n                                    비활성화\n                                  </>\n                                ) : (\n                                  <>\n                                    <ToggleRight className=\"mr-2 h-4 w-4\" />\n                                    활성화\n                                  </>\n                                )}\n                              </DropdownMenuItem>\n                              <DropdownMenuItem \n                                onClick={() => handleDelete(employee)}\n                                className=\"text-red-600\"\n                              >\n                                <Trash2 className=\"mr-2 h-4 w-4\" />\n                                삭제\n                              </DropdownMenuItem>\n                            </DropdownMenuContent>\n                          </DropdownMenu>\n                        </td>\n                      </>\n                    )}\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Mobile Card View */}\n      <div className=\"block md:hidden space-y-3\">\n        {sortedData.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500\">\n            등록된 직원이 없습니다.\n          </div>\n        ) : (\n          sortedData.map((employee) => (\n            <MobileCard key={employee.id}>\n              <MobileCardHeader>\n                <div className=\"flex justify-between items-center\">\n                  <span>{employee.name}</span>\n                  {canViewAllColumns && (\n                    <span\n                      className={`badge-stats ${employee.is_active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}`}\n                    >\n                      {employee.is_active ? '활성' : '비활성'}\n                    </span>\n                  )}\n                </div>\n              </MobileCardHeader>\n              \n              <MobileCardItem label=\"사번\" value={employee.employeeID || employee.employee_number || employee.id.slice(0, 8)} />\n              <MobileCardItem label=\"직급\" value={employee.position || '-'} />\n              <MobileCardItem label=\"부서\" value={employee.department || '-'} />\n              <MobileCardItem label=\"연락처\" value={employee.phone || '-'} />\n              <MobileCardItem label=\"이메일\" value={employee.email || '-'} />\n              {canViewAllColumns && (\n                <>\n                  <MobileCardItem \n                    label=\"권한\" \n                    value={\n                      <span className={`badge-stats ${getRoleBadgeColor(employee.purchase_role)}`}>\n                        {getRoleDisplayName(employee.purchase_role)}\n                      </span>\n                    } \n                  />\n                  <MobileCardItem label=\"주소\" value={employee.adress || '-'} />\n                  <MobileCardItem label=\"은행\" value={employee.bank || '-'} />\n                  <MobileCardItem label=\"계좌번호\" value={employee.bank_account || '-'} />\n                  <MobileCardItem \n                    label=\"연차\" \n                    value={employee.remaining_annual_leave !== undefined ? `${employee.remaining_annual_leave}일` : '-'} \n                  />\n                  \n                  <MobileCardActions>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => onView(employee)}\n                    >\n                      <Eye className=\"w-4 h-4\" />\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => onEdit(employee)}\n                    >\n                      <Edit className=\"w-4 h-4\" />\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => handleToggleStatus(employee)}\n                      disabled={loadingId === employee.id}\n                    >\n                      {employee.is_active ? (\n                        <ToggleLeft className=\"w-4 h-4\" />\n                      ) : (\n                        <ToggleRight className=\"w-4 h-4\" />\n                      )}\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      className=\"text-red-600\"\n                      onClick={() => handleDelete(employee)}\n                      disabled={loadingId === employee.id}\n                    >\n                      <Trash2 className=\"w-4 h-4\" />\n                    </Button>\n                  </MobileCardActions>\n                </>\n              )}\n            </MobileCard>\n          ))\n        )}\n      </div>\n    </>\n  )\n}","\nimport { useState, useEffect } from 'react'\nimport { Employee, EmployeeFormData, PurchaseRole } from '@/types/purchase'\nimport { Button } from '@/components/ui/button'\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogFooter,\n} from '@/components/ui/dialog'\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from '@/components/ui/form'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '@/components/ui/select'\nimport { Input } from '@/components/ui/input'\nimport { Textarea } from '@/components/ui/textarea'\nimport { useForm } from 'react-hook-form'\nimport { employeeService } from '@/services/employeeService'\nimport { toast } from 'sonner'\n\ninterface EmployeeModalProps {\n  isOpen: boolean\n  onClose: () => void\n  employee?: Employee | null\n  onSave: () => void\n  mode: 'create' | 'edit' | 'view'\n}\n\nconst PURCHASE_ROLES: { value: PurchaseRole; label: string }[] = [\n  { value: 'app_admin', label: '앱 관리자' },\n  { value: 'ceo', label: 'CEO' },\n  { value: 'final_approver', label: '최종 승인자' },\n  { value: 'middle_manager', label: '중간 관리자' },\n  { value: 'lead buyer', label: '수석 구매자' },\n  { value: 'buyer', label: '구매자' },\n]\n\nexport default function EmployeeModal({ isOpen, onClose, employee, onSave, mode }: EmployeeModalProps) {\n  const [isSubmitting, setIsSubmitting] = useState(false)\n  const [departments, setDepartments] = useState<string[]>([])\n  const [positions, setPositions] = useState<string[]>([])\n\n  const form = useForm<EmployeeFormData>({\n    defaultValues: {\n      name: '',\n      email: '',\n      phone: '',\n      position: '',\n      department: '',\n      purchase_role: [],\n    }\n  })\n\n  useEffect(() => {\n    // 부서와 직급 목록 로드\n    const loadOptions = async () => {\n      const [deptResult, posResult] = await Promise.all([\n        employeeService.getDepartments(),\n        employeeService.getPositions()\n      ])\n      \n      if (deptResult.success) {\n        setDepartments(deptResult.data || [])\n      }\n      \n      if (posResult.success) {\n        setPositions(posResult.data || [])\n      }\n    }\n    \n    loadOptions()\n  }, [])\n\n  useEffect(() => {\n    if (employee && isOpen) {\n      form.reset({\n        name: employee.name || '',\n        email: employee.email || '',\n        phone: employee.phone || '',\n        position: employee.position || '',\n        department: employee.department || '',\n        purchase_role: Array.isArray(employee.purchase_role) \n          ? employee.purchase_role \n          : employee.purchase_role?.split(',') || [],\n      })\n    } else if (!employee && isOpen) {\n      form.reset({\n        name: '',\n        email: '',\n        phone: '',\n        position: '',\n        department: '',\n        purchase_role: [],\n      })\n    }\n  }, [employee, isOpen, form])\n\n  const onSubmit = async (data: EmployeeFormData) => {\n    setIsSubmitting(true)\n    \n    try {\n      let result\n      \n      if (mode === 'create') {\n        result = await employeeService.createEmployee(data)\n      } else if (mode === 'edit' && employee) {\n        result = await employeeService.updateEmployee(employee.id, data)\n      }\n\n      if (result?.success) {\n        toast.success(mode === 'create' ? '직원이 등록되었습니다.' : '직원 정보가 수정되었습니다.')\n        onSave()\n        onClose()\n      } else {\n        toast.error(result?.error || '처리 중 오류가 발생했습니다.')\n      }\n    } catch (error) {\n      toast.error('처리 중 오류가 발생했습니다.')\n    } finally {\n      setIsSubmitting(false)\n    }\n  }\n\n  const getTitle = () => {\n    switch (mode) {\n      case 'create': return '직원 등록'\n      case 'edit': return '직원 수정'\n      case 'view': return '직원 상세'\n      default: return '직원'\n    }\n  }\n\n  const isReadOnly = mode === 'view'\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"w-full max-w-[95vw] sm:max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{getTitle()}</DialogTitle>\n        </DialogHeader>\n        \n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"name\"\n                rules={{\n                  required: '이름을 입력해주세요.'\n                }}\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>이름 *</FormLabel>\n                    <FormControl>\n                      <Input \n                        {...field} \n                        placeholder=\"이름을 입력하세요\"\n                        disabled={isReadOnly}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"email\"\n                rules={{\n                  pattern: {\n                    value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\n                    message: \"올바른 이메일 형식을 입력해주세요.\"\n                  }\n                }}\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>이메일</FormLabel>\n                    <FormControl>\n                      <Input \n                        {...field} \n                        type=\"email\"\n                        placeholder=\"user@example.com\"\n                        disabled={isReadOnly}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"phone\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>전화번호</FormLabel>\n                    <FormControl>\n                      <Input \n                        {...field} \n                        placeholder=\"010-0000-0000\"\n                        disabled={isReadOnly}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"department\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>부서</FormLabel>\n                    <FormControl>\n                      {isReadOnly ? (\n                        <Input {...field} disabled />\n                      ) : (\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"부서를 선택하세요\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {departments.map((dept) => (\n                              <SelectItem key={dept} value={dept}>\n                                {dept}\n                              </SelectItem>\n                            ))}\n                            <SelectItem value=\"custom\">직접 입력</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      )}\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"position\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>직급</FormLabel>\n                    <FormControl>\n                      {isReadOnly ? (\n                        <Input {...field} disabled />\n                      ) : (\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"직급을 선택하세요\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {positions.map((pos) => (\n                              <SelectItem key={pos} value={pos}>\n                                {pos}\n                              </SelectItem>\n                            ))}\n                            <SelectItem value=\"custom\">직접 입력</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      )}\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"purchase_role\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>권한</FormLabel>\n                    <FormControl>\n                      <Select \n                        onValueChange={(value) => field.onChange(value === 'none' ? [] : [value])} \n                        defaultValue={field.value?.[0] || 'none'}\n                        disabled={isReadOnly}\n                      >\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"권한을 선택하세요\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"none\">권한 없음</SelectItem>\n                          {PURCHASE_ROLES.map((role) => (\n                            <SelectItem key={role.value} value={role.value}>\n                              {role.label}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            {mode === 'view' && employee && (\n              <div className=\"pt-4 border-t\">\n                <div className=\"grid grid-cols-2 gap-4 modal-subtitle\">\n                  <div>\n                    <span className=\"text-gray-500\">상태:</span>\n                    <span className={`ml-2 px-2 py-1 business-radius-badge badge-text ${\n                      employee.is_active \n                        ? 'bg-green-100 text-green-800' \n                        : 'bg-gray-100 text-gray-600'\n                    }`}>\n                      {employee.is_active ? '활성' : '비활성'}\n                    </span>\n                  </div>\n                  <div>\n                    <span className=\"text-gray-500\">등록일:</span>\n                    <span className=\"ml-2\">\n                      {employee.created_at ? new Date(employee.created_at).toLocaleDateString('ko-KR') : '-'}\n                    </span>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <DialogFooter className=\"gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                {mode === 'view' ? '닫기' : '취소'}\n              </Button>\n              {!isReadOnly && (\n                <Button type=\"submit\" disabled={isSubmitting}>\n                  {isSubmitting \n                    ? (mode === 'create' ? '등록 중...' : '수정 중...')\n                    : (mode === 'create' ? '등록' : '수정')\n                  }\n                </Button>\n              )}\n            </DialogFooter>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  )\n}","\"use client\"\n\nimport * as React from \"react\"\nimport { Check, ChevronsUpDown } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n} from \"@/components/ui/command\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\n\nexport interface ComboboxOption {\n  value: string\n  label: string\n}\n\ninterface ComboboxProps {\n  options: ComboboxOption[]\n  value: string\n  onValueChange: (value: string) => void\n  placeholder?: string\n  searchPlaceholder?: string\n  emptyText?: string\n  className?: string\n}\n\nexport function Combobox({\n  options,\n  value,\n  onValueChange,\n  placeholder = \"선택...\",\n  searchPlaceholder = \"검색...\",\n  emptyText = \"결과가 없습니다.\",\n  className,\n}: ComboboxProps) {\n  const [open, setOpen] = React.useState(false)\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"outline\"\n          role=\"combobox\"\n          aria-expanded={open}\n          className={cn(\n            \"w-full justify-between h-9 text-sm font-normal\",\n            className\n          )}\n        >\n          {value\n            ? options.find((option) => option.value === value)?.label\n            : placeholder}\n          <ChevronsUpDown className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-full p-0\" align=\"start\">\n        <Command>\n          <CommandInput placeholder={searchPlaceholder} className=\"h-9\" />\n          <CommandEmpty>{emptyText}</CommandEmpty>\n          <CommandGroup className=\"max-h-[300px] overflow-auto\">\n            {options.map((option) => (\n              <CommandItem\n                key={option.value}\n                value={option.label}\n                onSelect={() => {\n                  onValueChange(option.value === value ? \"\" : option.value)\n                  setOpen(false)\n                }}\n              >\n                <Check\n                  className={cn(\n                    \"mr-2 h-4 w-4\",\n                    value === option.value ? \"opacity-100\" : \"opacity-0\"\n                  )}\n                />\n                {option.label}\n              </CommandItem>\n            ))}\n          </CommandGroup>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  )\n}","import ExcelJS from 'exceljs';\n\nexport interface AttendanceData {\n  employeeName: string;\n  employeeId: string;\n  department: string;\n  startDate: string;\n  endDate: string;\n  records: AttendanceRecord[];\n}\n\nexport interface AttendanceRecord {\n  date: string;\n  dayOfWeek: string;\n  employeeName: string;\n  employeeId: string;\n  department: string;\n  position: string;\n  workType: string;\n  clockIn?: string;\n  clockOut?: string;\n  status: string;\n  remarks?: string;\n}\n\nexport async function generateAttendanceExcel(data: AttendanceData): Promise<Blob> {\n  const workbook = new ExcelJS.Workbook();\n  const worksheet = workbook.addWorksheet('출근현황표');\n\n  // 엑셀 페이지 설정\n  worksheet.pageSetup = {\n    paperSize: 9, // A4\n    orientation: 'portrait',\n    margins: {\n      left: 0.7,\n      right: 0.7,\n      top: 0.75,\n      bottom: 0.75,\n      header: 0.3,\n      footer: 0.3,\n    },\n  };\n\n  // 컬럼 너비 설정 (이미지에서 본 레이아웃에 맞춤)\n  worksheet.columns = [\n    { width: 12 }, // 날짜\n    { width: 8 },  // 이름\n    { width: 12 }, // 사번\n    { width: 8 },  // 부서\n    { width: 6 },  // 직급\n    { width: 8 },  // 근무형태\n    { width: 12 }, // 출근시간\n    { width: 12 }, // 퇴근시간\n    { width: 8 },  // 출퇴근상태\n    { width: 8 },  // 근무상태\n  ];\n\n  // 제목 헤더 (1페이지 표시)\n  const titleRow = worksheet.addRow(['1']);\n  titleRow.height = 25;\n  worksheet.mergeCells('A1:J1');\n  const titleCell = worksheet.getCell('A1');\n  titleCell.value = '1';\n  titleCell.font = { name: '맑은 고딕', size: 14, bold: true };\n  titleCell.alignment = { horizontal: 'center', vertical: 'middle' };\n\n  // 공백 행\n  worksheet.addRow([]);\n\n  // 직원명과 조회기간 헤더\n  const employeeRow = worksheet.addRow([`${data.employeeName} 내역 (21)`]);\n  employeeRow.height = 20;\n  worksheet.mergeCells('A3:J3');\n  const employeeCell = worksheet.getCell('A3');\n  employeeCell.font = { name: '맑은 고딕', size: 12, bold: true };\n  employeeCell.alignment = { horizontal: 'left', vertical: 'middle' };\n\n  const periodRow = worksheet.addRow([`조회기간: ${data.startDate} ~ ${data.endDate}`]);\n  periodRow.height = 20;\n  worksheet.mergeCells('A4:J4');\n  const periodCell = worksheet.getCell('A4');\n  periodCell.font = { name: '맑은 고딕', size: 10 };\n  periodCell.alignment = { horizontal: 'left', vertical: 'middle' };\n\n  // 테이블 헤더\n  const headerRow = worksheet.addRow([\n    '날짜',\n    '이름', \n    '사번',\n    '부서',\n    '직급',\n    '근무형태',\n    '출근시간',\n    '퇴근시간',\n    '출퇴근상태',\n    '근무상태'\n  ]);\n  \n  headerRow.height = 25;\n  \n  // 헤더 스타일링\n  headerRow.eachCell((cell, _colNumber) => {\n    cell.font = { name: '맑은 고딕', size: 10, bold: true };\n    cell.alignment = { horizontal: 'center', vertical: 'middle' };\n    cell.border = {\n      top: { style: 'thin' },\n      left: { style: 'thin' },\n      bottom: { style: 'thin' },\n      right: { style: 'thin' }\n    };\n    cell.fill = {\n      type: 'pattern',\n      pattern: 'solid',\n      fgColor: { argb: 'FFE0E0E0' }\n    };\n  });\n\n  // 주말/공휴일 확인 함수\n  const isWeekendOrHolidayFunc = (dateString: string): boolean => {\n    const date = new Date(dateString.split('(')[0]); // 날짜 부분만 추출\n    const dayOfWeek = date.getDay();\n    \n    // 주말 (토요일: 6, 일요일: 0)\n    if (dayOfWeek === 0 || dayOfWeek === 6) {\n      return true;\n    }\n    \n    // 공휴일 (간단한 공휴일 목록 - 확장 가능)\n    const year = date.getFullYear();\n    const month = date.getMonth() + 1;\n    const day = date.getDate();\n    \n    // 기본 공휴일 (추가 필요시 확장)\n    const holidays = [\n      `${year}-01-01`, // 신정\n      `${year}-03-01`, // 삼일절\n      `${year}-05-05`, // 어린이날\n      `${year}-06-06`, // 현충일\n      `${year}-08-15`, // 광복절\n      `${year}-10-03`, // 개천절\n      `${year}-10-09`, // 한글날\n      `${year}-12-25`, // 크리스마스\n    ];\n    \n    const dateStr = `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;\n    return holidays.includes(dateStr);\n  };\n\n  // 데이터 행 추가\n  data.records.forEach(record => {\n    // 연차/공휴일 판단을 위한 근무상태 결정\n    let workStatus = record.remarks || '-';\n    const isWeekendOrHoliday = isWeekendOrHolidayFunc(record.date);\n    \n    // 연차나 공휴일인 경우 근무상태에 표시\n    if (record.remarks && record.remarks.includes('연차')) {\n      workStatus = '연차';\n    } else if (isWeekendOrHoliday) {\n      const date = new Date(record.date.split('(')[0]);\n      const dayOfWeek = date.getDay();\n      \n      if (dayOfWeek === 0 || dayOfWeek === 6) {\n        workStatus = '주말';\n      } else {\n        workStatus = '공휴일';\n      }\n    }\n\n    const dataRow = worksheet.addRow([\n      record.date,\n      record.employeeName,\n      record.employeeId,\n      record.department,\n      record.position,\n      record.workType,\n      record.clockIn || '-',\n      record.clockOut || '-',\n      record.status,\n      workStatus\n    ]);\n\n    dataRow.height = 20;\n    \n    const isSpecialDay = isWeekendOrHoliday;\n    const isLeaveDay = record.remarks && record.remarks.includes('연차');\n    \n    // 데이터 행 스타일링\n    dataRow.eachCell((cell, colNumber) => {\n      cell.font = { name: '맑은 고딕', size: 9 };\n      cell.alignment = { \n        horizontal: colNumber === 1 ? 'center' : 'left', // 날짜는 가운데, 나머지는 왼쪽\n        vertical: 'middle' \n      };\n      cell.border = {\n        top: { style: 'thin' },\n        left: { style: 'thin' },\n        bottom: { style: 'thin' },\n        right: { style: 'thin' }\n      };\n      \n      // 출근시간과 퇴근시간은 가운데 정렬\n      if (colNumber === 7 || colNumber === 8) {\n        cell.alignment = { horizontal: 'center', vertical: 'middle' };\n      }\n      \n      // 색상 우선순위: 연차 > 주말/공휴일 > 일반 상태\n      if (isLeaveDay) {\n        // 연차는 연녹색으로 표기\n        cell.fill = {\n          type: 'pattern',\n          pattern: 'solid',\n          fgColor: { argb: 'FFE8F5E8' } // 연녹색\n        };\n      } else if (isSpecialDay) {\n        // 주말/공휴일은 연붉은색으로 표기\n        cell.fill = {\n          type: 'pattern',\n          pattern: 'solid',\n          fgColor: { argb: 'FFFFE8E8' } // 연붉은색\n        };\n      }\n    });\n  });\n\n  // 엑셀 파일을 Blob으로 변환\n  const buffer = await workbook.xlsx.writeBuffer();\n  return new Blob([buffer], { \n    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' \n  });\n}\n\n// 요일 계산 함수\nexport function getDayOfWeek(dateString: string): string {\n  const date = new Date(dateString);\n  const days = ['일', '월', '화', '수', '목', '금', '토'];\n  return days[date.getDay()];\n}\n\n// 날짜 포맷팅 함수 (YYYY-MM-DD를 YYYY-MM-DD(요일)로 변환)\nexport function formatDateWithDay(dateString: string): string {\n  const dayOfWeek = getDayOfWeek(dateString);\n  return `${dateString}(${dayOfWeek})`;\n}","import { useState } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { Combobox, ComboboxOption } from '@/components/ui/combobox'\nimport { Download, Calendar, User, X } from 'lucide-react'\nimport { Employee } from '@/types/purchase'\nimport { toast } from 'sonner'\nimport { createClient } from '@/lib/supabase/client'\nimport { generateAttendanceExcel, formatDateWithDay } from '@/utils/exceljs/generateAttendanceExcel'\n\ninterface AttendanceDownloadProps {\n  employees: Employee[]\n  isOpen: boolean\n  onClose: () => void\n}\n\nexport default function AttendanceDownload({ employees, isOpen, onClose }: AttendanceDownloadProps) {\n  const [selectedEmployee, setSelectedEmployee] = useState<string>('')\n  const [startDate, setStartDate] = useState<string>('')\n  const [endDate, setEndDate] = useState<string>('')\n  const [isDownloading, setIsDownloading] = useState(false)\n  \n  const supabase = createClient()\n\n  // 기본 날짜 설정 (이번 달)\n  const setCurrentMonth = () => {\n    const now = new Date()\n    const start = new Date(now.getFullYear(), now.getMonth(), 1)\n    const end = new Date(now.getFullYear(), now.getMonth() + 1, 0)\n    \n    setStartDate(start.toISOString().split('T')[0])\n    setEndDate(end.toISOString().split('T')[0])\n  }\n\n  // 지난 달 설정\n  const setLastMonth = () => {\n    const now = new Date()\n    const start = new Date(now.getFullYear(), now.getMonth() - 1, 1)\n    const end = new Date(now.getFullYear(), now.getMonth(), 0)\n    \n    setStartDate(start.toISOString().split('T')[0])\n    setEndDate(end.toISOString().split('T')[0])\n  }\n\n  const handleDownload = async () => {\n    if (!selectedEmployee) {\n      toast.error('직원을 선택해주세요.')\n      return\n    }\n    \n    if (!startDate || !endDate) {\n      toast.error('조회 기간을 설정해주세요.')\n      return\n    }\n    \n    if (new Date(startDate) > new Date(endDate)) {\n      toast.error('시작일이 종료일보다 늦을 수 없습니다.')\n      return\n    }\n\n    setIsDownloading(true)\n    \n    try {\n      // 선택된 직원 정보 가져오기\n      const selectedEmp = employees.find(emp => emp.id === selectedEmployee)\n      if (!selectedEmp) {\n        throw new Error('선택된 직원 정보를 찾을 수 없습니다.')\n      }\n\n      // 출근 기록 조회\n      const { data: attendanceRecords, error } = await supabase\n        .from('attendance_records')\n        .select('*')\n        .eq('employee_id', selectedEmployee)\n        .gte('date', startDate)\n        .lte('date', endDate)\n        .order('date', { ascending: true })\n\n      if (error) {\n        throw new Error('출근 기록을 조회하는데 실패했습니다.')\n      }\n\n      // 날짜 범위 내의 모든 날짜 생성 (출근 기록이 없는 날도 포함)\n      const allDates: string[] = []\n      const start = new Date(startDate)\n      const end = new Date(endDate)\n      \n      for (let date = new Date(start); date <= end; date.setDate(date.getDate() + 1)) {\n        allDates.push(date.toISOString().split('T')[0])\n      }\n\n      // 출근 기록을 날짜별로 매핑\n      const recordMap = new Map()\n      attendanceRecords?.forEach((record: any) => {\n        recordMap.set(record.date, record)\n      })\n\n      // 엑셀 데이터 구성\n      const excelRecords = allDates.map(date => {\n        const record = recordMap.get(date)\n        const dateWithDay = formatDateWithDay(date)\n        const dayOfWeek = dateWithDay.split('(')[1]?.split(')')[0] || ''\n        \n        // 주말인지 확인 (토요일: 6, 일요일: 0)\n        const dateObj = new Date(date)\n        const isWeekend = dateObj.getDay() === 0 || dateObj.getDay() === 6\n        \n        return {\n          date: dateWithDay,\n          dayOfWeek,\n          employeeName: selectedEmp.name || '',\n          employeeId: selectedEmp.employeeID || selectedEmp.employee_number || '',\n          department: selectedEmp.department || '',\n          position: selectedEmp.position || '',\n          workType: '사원', // 기본값, 필요시 데이터베이스에서 가져올 수 있음\n          clockIn: record?.clock_in || (isWeekend ? '-' : ''),\n          clockOut: record?.clock_out || (isWeekend ? '-' : ''),\n          status: record?.status === '정상 출근' ? '정상 출근' : (record?.status || (isWeekend ? '' : '')),\n          remarks: record?.remarks || ''\n        }\n      })\n\n      // 엑셀 파일 생성\n      const excelData = {\n        employeeName: selectedEmp.name || '',\n        employeeId: selectedEmp.employeeID || '',\n        department: selectedEmp.department || '',\n        startDate,\n        endDate,\n        records: excelRecords\n      }\n\n      const blob = await generateAttendanceExcel(excelData)\n      \n      // 파일 다운로드\n      const url = window.URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = `출근현황표_${selectedEmp.name}_${startDate}_${endDate}.xlsx`\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      window.URL.revokeObjectURL(url)\n      \n      toast.success('출근현황표가 다운로드되었습니다.')\n      \n      // 다운로드 성공 후 모달 닫기\n      onClose()\n      \n    } catch (error) {\n      toast.error(error instanceof Error ? error.message : '다운로드 중 오류가 발생했습니다.')\n    } finally {\n      setIsDownloading(false)\n    }\n  }\n\n  // 모달이 닫힐 때 상태 초기화\n  const handleClose = () => {\n    setSelectedEmployee('')\n    setStartDate('')\n    setEndDate('')\n    setIsDownloading(false)\n    onClose()\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[520px] max-h-[85vh] overflow-y-auto\">\n        {/* 헤더 */}\n        <DialogHeader className=\"pb-6 space-y-3\">\n          <DialogTitle className=\"flex items-center text-2xl font-bold text-gray-900\">\n            <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-hansl-400 to-hansl-600 flex items-center justify-center mr-4 shadow-sm\">\n              <Calendar className=\"w-6 h-6 text-white\" />\n            </div>\n            출근현황표 다운로드\n          </DialogTitle>\n          <p className=\"text-gray-600 leading-relaxed pl-16\">\n            직원과 조회 기간을 선택하여 출근현황을<br />\n            엑셀 파일로 간편하게 다운로드하세요\n          </p>\n        </DialogHeader>\n        \n        {/* 콘텐츠 */}\n        <div className=\"space-y-8 py-2\">\n          {/* 직원 선택 섹션 */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center\">\n                <User className=\"w-4 h-4 text-blue-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">직원 선택</h3>\n            </div>\n            <div className=\"pl-11\">\n              <Combobox\n                value={selectedEmployee}\n                onValueChange={setSelectedEmployee}\n                options={employees\n                  .filter(emp => emp.name && emp.name.trim() !== '')\n                  .sort((a, b) => (a.name || '').localeCompare(b.name || ''))\n                  .map((employee): ComboboxOption => ({\n                    value: employee.id,\n                    label: `${employee.name} (${employee.department || '부서없음'})`\n                  }))}\n                placeholder=\"직원명 검색...\"\n                searchPlaceholder=\"직원 이름 검색...\"\n                emptyText=\"검색 결과가 없습니다\"\n                className=\"h-10 text-sm border-gray-200 focus:border-hansl-400 focus:ring-1 focus:ring-hansl-100\"\n              />\n            </div>\n          </div>\n\n          {/* 기간 선택 섹션 */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-8 h-8 rounded-lg bg-green-50 flex items-center justify-center\">\n                <Calendar className=\"w-4 h-4 text-green-600\" />\n              </div>\n              <h3 className=\"text-lg font-semibold text-gray-900\">조회 기간</h3>\n            </div>\n            <div className=\"pl-11 space-y-4\">\n              {/* 날짜 입력 */}\n              <div className=\"grid grid-cols-2 gap-3\">\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-medium text-gray-700\">시작일</label>\n                  <Input\n                    type=\"date\"\n                    value={startDate}\n                    onChange={(e) => setStartDate(e.target.value)}\n                    className=\"h-9 text-sm border-gray-200 focus:border-hansl-400 focus:ring-1 focus:ring-hansl-100\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <label className=\"block text-sm font-medium text-gray-700\">종료일</label>\n                  <Input\n                    type=\"date\"\n                    value={endDate}\n                    onChange={(e) => setEndDate(e.target.value)}\n                    className=\"h-9 text-sm border-gray-200 focus:border-hansl-400 focus:ring-1 focus:ring-hansl-100\"\n                  />\n                </div>\n              </div>\n              \n              {/* 빠른 선택 */}\n              <div className=\"space-y-2\">\n                <p className=\"text-sm font-medium text-gray-700\">빠른 선택</p>\n                <div className=\"flex gap-2\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={setCurrentMonth}\n                    className=\"h-8 px-4 text-sm border-gray-200 hover:bg-hansl-50 hover:border-hansl-300 hover:text-hansl-700 transition-colors\"\n                  >\n                    이번 달\n                  </Button>\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={setLastMonth}\n                    className=\"h-8 px-4 text-sm border-gray-200 hover:bg-hansl-50 hover:border-hansl-300 hover:text-hansl-700 transition-colors\"\n                  >\n                    지난 달\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* 하단 액션 버튼 */}\n        <div className=\"flex gap-3 pt-6 mt-2 border-t border-gray-100\">\n          <Button\n            variant=\"outline\"\n            onClick={handleClose}\n            className=\"flex-1 h-10 text-sm font-medium border-gray-200 hover:bg-gray-50 transition-colors\"\n            disabled={isDownloading}\n          >\n            취소\n          </Button>\n          <Button\n            onClick={handleDownload}\n            disabled={isDownloading || !selectedEmployee || !startDate || !endDate}\n            className=\"flex-1 h-10 text-sm bg-gradient-to-r from-hansl-500 to-hansl-600 hover:from-hansl-600 hover:to-hansl-700 text-white font-medium shadow-sm transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            <Download className=\"w-4 h-4 mr-2\" />\n            {isDownloading ? '다운로드 중...' : '엑셀 다운로드'}\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}","export interface LeaveRow {\n  id?: number | string\n  user_email: string\n  start_date: string\n  end_date: string\n  days?: number | string | null\n  start_period?: string | null\n  end_period?: string | null\n  type?: string | null\n  status?: string | null\n  reason?: string | null\n}\n\nexport type LeaveMatchReason =\n  | 'included'\n  | 'not_approved'\n  | 'not_annual_or_half'\n\nexport interface AnnualLeaveUsageDetailRow {\n  user_email: string\n  date: string // YYYY-MM-DD\n  dayOfWeek: string // '일'...'토'\n  unit: 1 | 0.5\n  leave_id?: number | string\n  leave_start_date: string\n  leave_end_date: string\n  reason?: string | null\n}\n\nexport interface AnnualLeaveUsageSummary {\n  user_email: string\n  used_days: number\n}\n\nconst KOREAN_DAYS = ['일', '월', '화', '수', '목', '금', '토'] as const\n\nfunction toDateOnly(dateStr: string): Date {\n  const d = new Date(dateStr)\n  d.setHours(0, 0, 0, 0)\n  return d\n}\n\nfunction formatYmd(d: Date): string {\n  const y = d.getFullYear()\n  const m = String(d.getMonth() + 1).padStart(2, '0')\n  const day = String(d.getDate()).padStart(2, '0')\n  return `${y}-${m}-${day}`\n}\n\nexport function isApprovedAnnualLeave(leave: LeaveRow): boolean {\n  const typeRaw = (leave.type ?? '').toString()\n  const reasonRaw = (leave.reason ?? '').toString()\n  const statusRaw = (leave.status ?? '').toString()\n\n  const type = typeRaw.toLowerCase()\n  const reason = reasonRaw.toLowerCase()\n  const status = statusRaw.toLowerCase()\n\n  const isApproved =\n    status === 'approved' ||\n    status.includes('approved') ||\n    status.includes('승인')\n\n  // 연차/반차 모두 포함 (단위는 별도 계산)\n  const isAnnualOrHalf =\n    type.includes('annual') ||\n    type.includes('연차') ||\n    type.includes('half') ||\n    type.includes('반차') ||\n    reason.includes('half') ||\n    reason.includes('반차') ||\n    reason.includes('0.5')\n\n  return isApproved && isAnnualOrHalf\n}\n\nexport function classifyLeaveForAnnualUsage(leave: LeaveRow): {\n  ok: boolean\n  reason: LeaveMatchReason\n  unit: 1 | 0.5\n} {\n  const statusRaw = (leave.status ?? '').toString()\n  const status = statusRaw.toLowerCase()\n  const isApproved =\n    status === 'approved' ||\n    status.includes('approved') ||\n    status.includes('승인')\n\n  if (!isApproved) {\n    return { ok: false, reason: 'not_approved', unit: 1 }\n  }\n\n  const typeRaw = (leave.type ?? '').toString()\n  const reasonRaw = (leave.reason ?? '').toString()\n  const type = typeRaw.toLowerCase()\n  const reason = reasonRaw.toLowerCase()\n\n  const isAnnualOrHalf =\n    type.includes('annual') ||\n    type.includes('연차') ||\n    type.includes('half') ||\n    type.includes('반차') ||\n    reason.includes('half') ||\n    reason.includes('반차') ||\n    reason.includes('0.5')\n\n  if (!isAnnualOrHalf) {\n    return { ok: false, reason: 'not_annual_or_half', unit: 1 }\n  }\n\n  return { ok: true, reason: 'included', unit: getLeaveUnit(leave) }\n}\n\nexport function getLeaveUnit(leave: LeaveRow): 1 | 0.5 {\n  // 1) 백엔드 스키마에 days(DECIMAL(3,1))가 있으면 그걸 우선 사용\n  const daysNum = Number(leave.days ?? NaN)\n  if (!Number.isNaN(daysNum)) {\n    if (daysNum === 0.5) return 0.5\n    return 1\n  }\n\n  // 2) start_period/end_period 기반(half-day) 처리\n  const sp = (leave.start_period ?? '').toString().toLowerCase()\n  const ep = (leave.end_period ?? '').toString().toLowerCase()\n  const hasHalfPeriod = (sp && sp !== 'full') || (ep && ep !== 'full')\n  if (hasHalfPeriod && leave.start_date === leave.end_date) return 0.5\n\n  // 3) fallback: type/reason 키워드\n  const type = (leave.type ?? '').toString().toLowerCase()\n  const reason = (leave.reason ?? '').toString().toLowerCase()\n  const isHalfKeyword =\n    type.includes('half') ||\n    type.includes('반차') ||\n    reason.includes('half') ||\n    reason.includes('반차') ||\n    reason.includes('0.5')\n  if (isHalfKeyword && leave.start_date === leave.end_date) return 0.5\n  return 1\n}\n\nexport function calcAnnualLeaveUsageByWorkdays(params: {\n  leaves: LeaveRow[]\n  startDate: string // YYYY-MM-DD\n  endDate: string // YYYY-MM-DD\n}): { summaries: AnnualLeaveUsageSummary[]; details: AnnualLeaveUsageDetailRow[] } {\n  const { leaves, startDate, endDate } = params\n\n  const rangeStart = toDateOnly(startDate)\n  const rangeEnd = toDateOnly(endDate)\n\n  const details: AnnualLeaveUsageDetailRow[] = []\n  const usedByEmail = new Map<string, number>()\n\n  leaves.forEach((leave) => {\n    const cls = classifyLeaveForAnnualUsage(leave)\n    if (!cls.ok) return\n    // leave가 단일 날짜면 unit(0.5/1)을 쓰고, 여러 날짜면 날짜별로 분해(기본 1, 필요 시 period로 0.5)\n\n    const leaveStart = toDateOnly(leave.start_date)\n    const leaveEnd = toDateOnly(leave.end_date)\n\n    const effectiveStart = leaveStart > rangeStart ? leaveStart : rangeStart\n    const effectiveEnd = leaveEnd < rangeEnd ? leaveEnd : rangeEnd\n\n    if (effectiveStart > effectiveEnd) return\n\n    const cursor = new Date(effectiveStart)\n    for (; cursor <= effectiveEnd; cursor.setDate(cursor.getDate() + 1)) {\n      const dow = cursor.getDay()\n      const ymd = formatYmd(cursor)\n\n      let dayUnit: 1 | 0.5 = 1\n      // 단일 날짜면 백엔드 days/period 기반 unit을 사용\n      if (leave.start_date === leave.end_date) {\n        dayUnit = cls.unit\n      } else {\n        // 여러 날짜인데 period가 half면 첫날/마지막날에 반영\n        const sp = (leave.start_period ?? '').toString().toLowerCase()\n        const ep = (leave.end_period ?? '').toString().toLowerCase()\n        const isFirst = ymd === leave.start_date\n        const isLast = ymd === leave.end_date\n        if (isFirst && sp && sp !== 'full') dayUnit = 0.5\n        if (isLast && ep && ep !== 'full') dayUnit = 0.5\n      }\n\n      details.push({\n        user_email: leave.user_email,\n        date: ymd,\n        dayOfWeek: KOREAN_DAYS[dow],\n        unit: dayUnit,\n        leave_id: leave.id,\n        leave_start_date: leave.start_date,\n        leave_end_date: leave.end_date,\n        reason: leave.reason ?? null\n      })\n\n      usedByEmail.set(leave.user_email, (usedByEmail.get(leave.user_email) ?? 0) + dayUnit)\n    }\n  })\n\n  const summaries: AnnualLeaveUsageSummary[] = Array.from(usedByEmail.entries())\n    .map(([user_email, used_days]) => ({ user_email, used_days }))\n    .sort((a, b) => b.used_days - a.used_days)\n\n  // 상세는 이메일/날짜 기준 정렬\n  details.sort((a, b) => {\n    if (a.user_email !== b.user_email) return a.user_email.localeCompare(b.user_email)\n    return a.date.localeCompare(b.date)\n  })\n\n  return { summaries, details }\n}\n\n\n","import { useState } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Input } from '@/components/ui/input'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { Calendar, Download } from 'lucide-react'\nimport { toast } from 'sonner'\nimport { createClient } from '@/lib/supabase/client'\nimport { employeeService } from '@/services/employeeService'\nimport { calcAnnualLeaveUsageByWorkdays, classifyLeaveForAnnualUsage, type LeaveRow } from '@/utils/leave/calcAnnualLeaveWorkdays'\nimport { generateAnnualLeaveUsageExcel } from '@/utils/exceljs/generateAnnualLeaveUsageExcel'\n\ninterface AnnualLeaveUsageDownloadProps {\n  isOpen: boolean\n  onClose: () => void\n}\n\nexport default function AnnualLeaveUsageDownload({ isOpen, onClose }: AnnualLeaveUsageDownloadProps) {\n  const [year, setYear] = useState<string>(String(new Date().getFullYear()))\n  const [isDownloading, setIsDownloading] = useState(false)\n\n  const supabase = createClient()\n\n  const setThisYear = () => setYear(String(new Date().getFullYear()))\n  const setLastYear = () => setYear(String(new Date().getFullYear() - 1))\n\n  // hansl 백엔드(연차 트리거/년도업데이트)와 동일한 법정연차 산식\n  const calcGrantedAnnualLeaveForYear = (joinDateStr: string | undefined, targetYear: number): number => {\n    if (!joinDateStr) return 0\n    const joinDate = new Date(joinDateStr)\n    if (Number.isNaN(joinDate.getTime())) return 0\n\n    const joinYear = joinDate.getFullYear()\n    const joinMonth = joinDate.getMonth() + 1 // 1~12\n    const serviceYears = targetYear - joinYear\n\n    if (serviceYears === 0) {\n      const remainingMonths = 13 - joinMonth\n      return Math.floor((15 * remainingMonths) / 12)\n    }\n    if (serviceYears === 1 || serviceYears === 2) return 15\n    if (serviceYears >= 3) return Math.min(25, 15 + Math.floor((serviceYears - 1) / 2))\n    return 0\n  }\n\n  const handleDownload = async () => {\n    const yearNum = Number(year)\n    if (!year || Number.isNaN(yearNum) || yearNum < 2000 || yearNum > 2100) {\n      toast.error('연도를 올바르게 입력해주세요. (예: 2025)')\n      return\n    }\n    const effectiveStart = `${yearNum}-01-01`\n    const effectiveEnd = `${yearNum}-12-31`\n\n    setIsDownloading(true)\n    try {\n      // 1) 기간 overlap 되는 leave 조회 (필터는 클라이언트에서 엄격 적용)\n      const { data: leaveRows, error: leaveError } = await supabase\n        .from('leave')\n        // 스키마 차이(컬럼 유무)로 다운로드가 실패하지 않도록 전체 컬럼 조회\n        .select('*')\n        .lte('start_date', effectiveEnd)\n        .gte('end_date', effectiveStart)\n        .order('start_date', { ascending: true })\n\n      if (leaveError) throw leaveError\n\n      const leaves = (leaveRows || []) as LeaveRow[]\n      if (leaves.length === 0) {\n        toast.error('선택한 기간에 연차(승인) 기록이 없습니다.')\n        return\n      }\n\n      // 1-1) 검증용: 포함/제외 leave 목록 구성(누락 확인)\n      const includedLeaves = leaves\n        .map((l) => {\n          const cls = classifyLeaveForAnnualUsage(l)\n          if (!cls.ok) return null\n          return {\n            id: l.id,\n            user_email: l.user_email,\n            start_date: l.start_date,\n            end_date: l.end_date,\n            unit: cls.unit,\n            type: l.type ?? null,\n            status: l.status ?? null,\n            reason: l.reason ?? null\n          }\n        })\n        .filter(Boolean) as any[]\n\n      const excludedLeaves = leaves\n        .map((l) => {\n          const cls = classifyLeaveForAnnualUsage(l)\n          if (cls.ok) return null\n          return {\n            id: l.id,\n            user_email: l.user_email,\n            start_date: l.start_date,\n            end_date: l.end_date,\n            excludeReason: cls.reason,\n            type: l.type ?? null,\n            status: l.status ?? null,\n            reason: l.reason ?? null\n          }\n        })\n        .filter(Boolean) as any[]\n\n      // 3) 백엔드 leave(days/period) 기반으로 일자 상세 + 직원별 합계 계산\n      const { summaries, details } = calcAnnualLeaveUsageByWorkdays({\n        leaves,\n        startDate: effectiveStart,\n        endDate: effectiveEnd\n      })\n\n      if (summaries.length === 0 || details.length === 0) {\n        toast.error('선택한 연도에 승인된 연차/반차(근무일 기준) 기록이 없습니다.')\n        return\n      }\n\n      // 4) 직원 정보 매핑 (기간 내 기록이 있는 직원만: summaries 기반)\n      const employeesResult = await employeeService.getEmployees({ is_active: undefined })\n      if (!employeesResult.success || !employeesResult.data) {\n        throw new Error(employeesResult.error || '직원 목록을 불러오지 못했습니다.')\n      }\n      const employees = employeesResult.data\n      const empByEmail = new Map<string, any>()\n      employees.forEach((e) => {\n        if (e.email) empByEmail.set(e.email, e)\n      })\n\n      const targetEmails = new Set(summaries.map((s) => s.user_email))\n      const targetEmployeeIds: string[] = []\n      const employeeIdByEmail = new Map<string, string>()\n      employees.forEach((e) => {\n        if (!e.email || !targetEmails.has(e.email)) return\n        if (!e.id) return\n        employeeIdByEmail.set(e.email, e.id)\n        targetEmployeeIds.push(e.id)\n      })\n\n      // 4-1) 월별 셀 문자열 생성: \"3(1),19(0.5)\" 형태\n      const monthlyMap = new Map<string, Map<number, { day: number; unit: 1 | 0.5 }[]>>()\n      details.forEach((d) => {\n        const [y, m, dayStr] = d.date.split('-')\n        if (!y || !m || !dayStr) return\n        const month = Number(m)\n        const day = Number(dayStr)\n        if (Number.isNaN(month) || Number.isNaN(day)) return\n\n        if (!monthlyMap.has(d.user_email)) monthlyMap.set(d.user_email, new Map())\n        const byMonth = monthlyMap.get(d.user_email)!\n        if (!byMonth.has(month)) byMonth.set(month, [])\n        byMonth.get(month)!.push({ day, unit: d.unit })\n      })\n\n      const formatMonthCell = (email: string, month: number): string => {\n        const byMonth = monthlyMap.get(email)\n        const items = byMonth?.get(month) || []\n        items.sort((a, b) => a.day - b.day)\n        return items\n          .map((it) => `${it.day}(${it.unit === 1 ? '1' : '0.5'})`)\n          .join(',')\n      }\n\n      const summaryRows = summaries.map((s) => {\n        const emp = empByEmail.get(s.user_email)\n        const months: Record<number, string> = {} as any\n        for (let m = 1; m <= 12; m++) {\n          months[m] = formatMonthCell(s.user_email, m)\n        }\n        const grantedDays = calcGrantedAnnualLeaveForYear(emp?.join_date, yearNum)\n        return {\n          employeeId: emp?.employeeID || emp?.employee_number || '',\n          name: emp?.name || '',\n          // 2025년 지급연차는 “해당 연도 기준 법정연차 산식”으로 산출(백엔드 트리거/년도업데이트와 동일)\n          grantedDays,\n          usedDays: s.used_days,\n          months\n        }\n      })\n\n      // 5) 엑셀 생성 + 다운로드\n      const blob = await generateAnnualLeaveUsageExcel({\n        summaries: summaryRows,\n        debug: {\n          year: yearNum,\n          includedLeaves,\n          excludedLeaves\n        }\n      })\n\n      const url = window.URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = `연차_사용현황_${yearNum}.xlsx`\n      document.body.appendChild(a)\n      a.click()\n      document.body.removeChild(a)\n      window.URL.revokeObjectURL(url)\n\n      toast.success('연차사용현황 엑셀이 다운로드되었습니다.')\n      onClose()\n    } catch (err: any) {\n      const msg =\n        err?.message ||\n        (typeof err === 'string' ? err : '') ||\n        '다운로드 중 오류가 발생했습니다.'\n      toast.error(msg)\n    } finally {\n      setIsDownloading(false)\n    }\n  }\n\n  const handleClose = () => {\n    setYear(String(new Date().getFullYear()))\n    setIsDownloading(false)\n    onClose()\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"sm:max-w-[520px] max-h-[85vh] overflow-y-auto\">\n        <DialogHeader className=\"pb-6 space-y-3\">\n          <DialogTitle className=\"flex items-center text-2xl font-bold text-gray-900\">\n            <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-hansl-400 to-hansl-600 flex items-center justify-center mr-4 shadow-sm\">\n              <Calendar className=\"w-6 h-6 text-white\" />\n            </div>\n            연차사용현황 다운로드\n          </DialogTitle>\n          <p className=\"text-gray-600 leading-relaxed pl-16\">\n            연도를 선택하면 직원별 사용일수와 월별 상세(일자/단위)를<br />\n            엑셀로 다운로드합니다\n          </p>\n        </DialogHeader>\n\n        <div className=\"space-y-6 py-2\">\n          {/* 연도 선택 */}\n          <div className=\"space-y-3\">\n            <div className=\"space-y-2\">\n              <label className=\"block text-sm font-medium text-gray-700\">연도</label>\n              <Input\n                type=\"number\"\n                value={year}\n                onChange={(e) => setYear(e.target.value)}\n                min={2000}\n                max={2100}\n                placeholder=\"예: 2025\"\n                className=\"h-9 text-sm border-gray-200 focus:border-hansl-400 focus:ring-1 focus:ring-hansl-100\"\n              />\n            </div>\n\n            <div className=\"flex gap-2\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={setThisYear}\n                className=\"h-8 px-4 text-sm border-gray-200 hover:bg-hansl-50 hover:border-hansl-300 hover:text-hansl-700 transition-colors\"\n              >\n                올해\n              </Button>\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                size=\"sm\"\n                onClick={setLastYear}\n                className=\"h-8 px-4 text-sm border-gray-200 hover:bg-hansl-50 hover:border-hansl-300 hover:text-hansl-700 transition-colors\"\n              >\n                작년\n              </Button>\n            </div>\n          </div>\n\n          <div className=\"pt-2\">\n            <Button\n              onClick={handleDownload}\n              disabled={isDownloading}\n              className=\"w-full h-11 bg-hansl-600 hover:bg-hansl-700 text-white font-semibold shadow-sm\"\n            >\n              {isDownloading ? (\n                '다운로드 중...'\n              ) : (\n                <>\n                  <Download className=\"w-4 h-4 mr-2\" />\n                  엑셀 다운로드\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\n\n","import ExcelJS from 'exceljs'\n\nexport interface AnnualLeaveUsageSummaryExcelRow {\n  employeeId?: string\n  name?: string\n  grantedDays?: number\n  usedDays: number\n  months: Record<number, string> // 1~12\n}\n\nexport interface AnnualLeaveUsageDebugLeaveRow {\n  id?: number | string\n  user_email?: string\n  start_date?: string\n  end_date?: string\n  type?: string | null\n  status?: string | null\n  reason?: string | null\n  unit?: 1 | 0.5\n  excludeReason?: string\n}\n\nexport async function generateAnnualLeaveUsageExcel(params: {\n  summaries: AnnualLeaveUsageSummaryExcelRow[]\n  debug?: {\n    year: number\n    includedLeaves: AnnualLeaveUsageDebugLeaveRow[]\n    excludedLeaves: AnnualLeaveUsageDebugLeaveRow[]\n  }\n}): Promise<Blob> {\n  const { summaries, debug } = params\n\n  const workbook = new ExcelJS.Workbook()\n\n  // 요약 시트\n  const wsSummary = workbook.addWorksheet('연차사용현황')\n  wsSummary.columns = [\n    { header: '사번', key: 'employeeId', width: 14 },\n    { header: '이름', key: 'name', width: 12 },\n    { header: '지급연차', key: 'grantedDays', width: 10 },\n    { header: '사용일수', key: 'usedDays', width: 10 },\n    { header: '1월', key: 'm1', width: 22 },\n    { header: '2월', key: 'm2', width: 22 },\n    { header: '3월', key: 'm3', width: 22 },\n    { header: '4월', key: 'm4', width: 22 },\n    { header: '5월', key: 'm5', width: 22 },\n    { header: '6월', key: 'm6', width: 22 },\n    { header: '7월', key: 'm7', width: 22 },\n    { header: '8월', key: 'm8', width: 22 },\n    { header: '9월', key: 'm9', width: 22 },\n    { header: '10월', key: 'm10', width: 24 },\n    { header: '11월', key: 'm11', width: 24 },\n    { header: '12월', key: 'm12', width: 24 }\n  ]\n\n  wsSummary.getRow(1).font = { name: '맑은 고딕', bold: true }\n  wsSummary.getRow(1).alignment = { vertical: 'middle', horizontal: 'center' }\n\n  // 이름 오름차순 정렬(동률이면 사번)\n  const sorted = [...summaries].sort((a, b) => {\n    const nameA = (a.name ?? '').toString()\n    const nameB = (b.name ?? '').toString()\n    const cmp = nameA.localeCompare(nameB)\n    if (cmp !== 0) return cmp\n    return (a.employeeId ?? '').toString().localeCompare((b.employeeId ?? '').toString())\n  })\n\n  sorted.forEach((row) => {\n    wsSummary.addRow({\n      employeeId: row.employeeId ?? '',\n      name: row.name ?? '',\n      grantedDays: row.grantedDays ?? '',\n      usedDays: row.usedDays,\n      m1: row.months[1] ?? '',\n      m2: row.months[2] ?? '',\n      m3: row.months[3] ?? '',\n      m4: row.months[4] ?? '',\n      m5: row.months[5] ?? '',\n      m6: row.months[6] ?? '',\n      m7: row.months[7] ?? '',\n      m8: row.months[8] ?? '',\n      m9: row.months[9] ?? '',\n      m10: row.months[10] ?? '',\n      m11: row.months[11] ?? '',\n      m12: row.months[12] ?? ''\n    })\n  })\n\n  // 검증 시트(포함/제외 원본) - 누락 여부 확인용\n  if (debug) {\n    const wsIncluded = workbook.addWorksheet(`검증_포함_${debug.year}`)\n    wsIncluded.columns = [\n      { header: 'leave_id', key: 'id', width: 10 },\n      { header: 'user_email', key: 'user_email', width: 26 },\n      { header: 'start_date', key: 'start_date', width: 12 },\n      { header: 'end_date', key: 'end_date', width: 12 },\n      { header: 'unit', key: 'unit', width: 6 },\n      { header: 'type', key: 'type', width: 18 },\n      { header: 'status', key: 'status', width: 12 },\n      { header: 'reason', key: 'reason', width: 30 }\n    ]\n    wsIncluded.getRow(1).font = { name: '맑은 고딕', bold: true }\n    wsIncluded.getRow(1).alignment = { vertical: 'middle', horizontal: 'center' }\n    debug.includedLeaves.forEach((r) => wsIncluded.addRow(r))\n\n    const wsExcluded = workbook.addWorksheet(`검증_제외_${debug.year}`)\n    wsExcluded.columns = [\n      { header: 'leave_id', key: 'id', width: 10 },\n      { header: 'user_email', key: 'user_email', width: 26 },\n      { header: 'start_date', key: 'start_date', width: 12 },\n      { header: 'end_date', key: 'end_date', width: 12 },\n      { header: 'excludeReason', key: 'excludeReason', width: 16 },\n      { header: 'type', key: 'type', width: 18 },\n      { header: 'status', key: 'status', width: 12 },\n      { header: 'reason', key: 'reason', width: 30 }\n    ]\n    wsExcluded.getRow(1).font = { name: '맑은 고딕', bold: true }\n    wsExcluded.getRow(1).alignment = { vertical: 'middle', horizontal: 'center' }\n    debug.excludedLeaves.forEach((r) => wsExcluded.addRow(r))\n  }\n\n  const buffer = await workbook.xlsx.writeBuffer()\n  return new Blob([buffer], {\n    type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n  })\n}\n\n\n","\nimport { useState, useEffect } from 'react'\nimport { Employee, EmployeeFilters as EmployeeFiltersType } from '@/types/purchase'\nimport { employeeService } from '@/services/employeeService'\nimport EmployeeFilters from '@/components/employee/EmployeeFilters'\nimport EmployeeTable from '@/components/employee/EmployeeTable'\nimport EmployeeModal from '@/components/employee/EmployeeModal'\nimport AttendanceDownload from '@/components/employee/AttendanceDownload'\nimport AnnualLeaveUsageDownload from '@/components/employee/AnnualLeaveUsageDownload'\nimport { toast } from 'sonner'\nimport { useAuth } from '@/contexts/AuthContext'\n// XLSX는 사용할 때만 동적으로 import (성능 최적화)\n\ntype ModalMode = 'create' | 'edit' | 'view'\n\nexport default function EmployeeMain() {\n  const { currentUserRoles } = useAuth()\n  const canManageEmployees = currentUserRoles.includes('app_admin') || currentUserRoles.includes('hr')\n\n  const [employees, setEmployees] = useState<Employee[]>([])\n  const [filteredEmployees, setFilteredEmployees] = useState<Employee[]>([])\n  const [loading, setLoading] = useState(true)\n  const [filters, setFilters] = useState<EmployeeFiltersType>({})\n  \n  // 모달 상태\n  const [isModalOpen, setIsModalOpen] = useState(false)\n  const [selectedEmployee, setSelectedEmployee] = useState<Employee | null>(null)\n  const [modalMode, setModalMode] = useState<ModalMode>('create')\n  \n  // 출근현황표 모달 상태\n  const [isAttendanceModalOpen, setIsAttendanceModalOpen] = useState(false)\n  // 연차사용현황 모달 상태\n  const [isAnnualLeaveUsageModalOpen, setIsAnnualLeaveUsageModalOpen] = useState(false)\n\n  // 직원 목록 로드\n  const loadEmployees = async () => {\n    setLoading(true)\n    try {\n      const result = await employeeService.getEmployees(filters)\n      \n      if (result.success && result.data) {\n        setEmployees(result.data)\n        setFilteredEmployees(result.data)\n      } else {\n        toast.error(result.error || '직원 목록을 불러오는데 실패했습니다.')\n      }\n    } catch (error) {\n      toast.error('직원 목록을 불러오는 중 오류가 발생했습니다.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  // 초기 로드\n  useEffect(() => {\n    loadEmployees()\n  }, [])\n\n  // 필터 변경 시 직원 목록 다시 로드\n  useEffect(() => {\n    loadEmployees()\n  }, [filters])\n\n  // 모달 핸들러\n  const handleCreateNew = () => {\n    if (!canManageEmployees) {\n      toast.error('직원 등록 권한이 없습니다.')\n      return\n    }\n    setSelectedEmployee(null)\n    setModalMode('create')\n    setIsModalOpen(true)\n  }\n\n  const handleEdit = (employee: Employee) => {\n    if (!canManageEmployees) {\n      toast.error('직원 수정 권한이 없습니다.')\n      return\n    }\n    setSelectedEmployee(employee)\n    setModalMode('edit')\n    setIsModalOpen(true)\n  }\n\n  const handleView = (employee: Employee) => {\n    if (!canManageEmployees) {\n      toast.error('직원 상세 조회 권한이 없습니다.')\n      return\n    }\n    setSelectedEmployee(employee)\n    setModalMode('view')\n    setIsModalOpen(true)\n  }\n\n  const handleModalClose = () => {\n    setIsModalOpen(false)\n    setSelectedEmployee(null)\n  }\n\n  const handleSave = () => {\n    loadEmployees()\n  }\n\n  // Excel 내보내기 (동적 import로 성능 최적화)\n  const handleExport = async () => {\n    if (!canManageEmployees) {\n      toast.error('Excel 내보내기 권한이 없습니다.')\n      return\n    }\n    try {\n      const result = await employeeService.getEmployeesForExport()\n      \n      if (result.success && result.data) {\n        // XLSX를 사용할 때만 동적으로 import\n        const XLSX = await import('xlsx')\n        \n        const ws = XLSX.utils.json_to_sheet(result.data)\n        const wb = XLSX.utils.book_new()\n        XLSX.utils.book_append_sheet(wb, ws, '직원 목록')\n        \n        // 파일명에 현재 날짜 추가\n        const today = new Date().toISOString().slice(0, 10)\n        const filename = `직원_목록_${today}.xlsx`\n        \n        XLSX.writeFile(wb, filename)\n        toast.success('Excel 파일이 다운로드되었습니다.')\n      } else {\n        toast.error(result.error || 'Excel 내보내기에 실패했습니다.')\n      }\n    } catch (error) {\n      toast.error('Excel 내보내기 중 오류가 발생했습니다.')\n    }\n  }\n\n  if (loading && employees.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center min-h-[400px]\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto\"></div>\n          <p className=\"mt-2 card-subtitle\">직원 목록을 불러오는 중...</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <>\n      <div className=\"space-y-6\">\n      {/* 필터 섹션 */}\n      <EmployeeFilters\n        filters={filters}\n        onFiltersChange={setFilters}\n        onExport={handleExport}\n        onCreateNew={handleCreateNew}\n        onAttendanceDownload={() => {\n          if (!canManageEmployees) {\n            toast.error('출근현황표 다운로드 권한이 없습니다.')\n            return\n          }\n          setIsAttendanceModalOpen(true)\n        }}\n        onAnnualLeaveUsageDownload={() => {\n          if (!canManageEmployees) {\n            toast.error('연차사용현황 다운로드 권한이 없습니다.')\n            return\n          }\n          setIsAnnualLeaveUsageModalOpen(true)\n        }}\n        canManageEmployees={canManageEmployees}\n      />\n\n      {/* 테이블 섹션 */}\n      <div className=\"bg-white rounded-lg border\">\n        <div className=\"p-4 border-b\">\n          <div className=\"flex justify-between items-center\">\n            <h3 className=\"modal-title\">직원 목록</h3>\n            <div className=\"card-description\">\n              {loading ? '로딩 중...' : `총 ${filteredEmployees.length}명의 직원`}\n            </div>\n          </div>\n        </div>\n        \n        <EmployeeTable\n          employees={filteredEmployees}\n          onEdit={handleEdit}\n          onView={handleView}\n          onRefresh={loadEmployees}\n          currentUserRoles={currentUserRoles}\n        />\n      </div>\n\n      {/* 직원 모달 */}\n      <EmployeeModal\n        isOpen={isModalOpen}\n        onClose={handleModalClose}\n        employee={selectedEmployee}\n        onSave={handleSave}\n        mode={modalMode}\n      />\n\n      {/* 출근현황표 다운로드 모달 */}\n      <AttendanceDownload\n        employees={employees}\n        isOpen={isAttendanceModalOpen}\n        onClose={() => setIsAttendanceModalOpen(false)}\n      />\n\n      {/* 연차사용현황 다운로드 모달 */}\n      <AnnualLeaveUsageDownload\n        isOpen={isAnnualLeaveUsageModalOpen}\n        onClose={() => setIsAnnualLeaveUsageModalOpen(false)}\n      />\n      </div>\n    </>\n  )\n}"],"file":"assets/EmployeeMain-DnUICHfm.js"}