import{e,y as s,a as t,r as a,c as r,j as i,B as c,U as d,z as l}from"./index-DsAL4iro.js";import{t as n}from"./index-Dz8943Z0.js";import{C as m}from"./calendar-TX1shQE9.js";import{C as x}from"./credit-card-jVf85E50.js";
/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=e("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function o(){const{id:e}=s(),o=t(),[p,g]=a.useState(!0),[j,u]=a.useState(null);a.useEffect(()=>{e&&N(e)},[e]);const N=async e=>{try{const s=r(),{data:t,error:a}=await s.from("purchase_requests").select("*,vendors(id,vendor_name),purchase_request_items(*)").eq("id",e).single();if(a)throw a;t&&u({...t,items:t.purchase_request_items||[],vendor:t.vendors||{id:0,vendor_name:"알 수 없음"},vendor_contacts:[]})}catch(s){n.error("발주 상세 정보를 불러오는데 실패했습니다.")}finally{g(!1)}},y=e=>{switch(e){case"approved":return i.jsx("span",{className:"badge-stats bg-green-500 text-white",children:"승인"});case"rejected":return i.jsx("span",{className:"badge-stats bg-red-500 text-white",children:"반려"});case"pending":return i.jsx("span",{className:"badge-stats bg-yellow-500 text-white",children:"대기"});default:return i.jsx("span",{className:"badge-stats bg-gray-500 text-white",children:"-"})}};return p?i.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):j?i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>o("/purchase/list"),children:[i.jsx(h,{className:"w-4 h-4 mr-2"}),"목록으로"]}),i.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["발주 상세 - ",j.order_number]})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"1차 승인"}),y(j.middle_manager_status)]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"최종 승인"}),y(j.final_manager_status)]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 처리"}),y(j.is_payment_completed?"completed":"pending")]}),i.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"납품 상태"}),(e=>{switch(e){case"completed":return i.jsx("span",{className:"badge-stats bg-green-500 text-white",children:"납품완료"});case"partial":return i.jsx("span",{className:"badge-stats bg-yellow-500 text-white",children:"부분납품"});case"pending":return i.jsx("span",{className:"badge-stats bg-gray-500 text-white",children:"납품대기"});default:return i.jsx("span",{className:"badge-stats bg-gray-500 text-white",children:"-"})}})(j.delivery_status||"pending")]})]}),i.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"기본 정보"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[i.jsx(m,{className:"w-4 h-4 mr-2"}),"요청일"]}),i.jsx("p",{className:"font-medium",children:j.created_at?new Date(j.created_at).toLocaleDateString("ko-KR"):"-"})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[i.jsx(d,{className:"w-4 h-4 mr-2"}),"요청자"]}),i.jsx("p",{className:"font-medium",children:j.requester_name||"-"})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[i.jsx(l,{className:"w-4 h-4 mr-2"}),"업체명"]}),i.jsx("p",{className:"font-medium",children:j.vendor?.vendor_name||"-"})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[i.jsx(x,{className:"w-4 h-4 mr-2"}),"총 금액"]}),i.jsxs("p",{className:"font-medium",children:[j.total_amount?.toLocaleString("ko-KR"),"원"]})]})]}),j.purpose&&i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 목적"}),i.jsx("p",{className:"text-gray-900",children:j.purpose})]})]}),i.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"구매 품목"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"품목명"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"수량"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"단가"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"금액"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(j.purchase_request_items||[]).map((e,s)=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.item_name}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.quantity," ",e.unit||"개"]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.unit_price?.toLocaleString("ko-KR"),"원"]}),i.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((e.quantity||0)*(e.unit_price||0)).toLocaleString("ko-KR"),"원"]})]},s))})]})})]}),(j.middle_manager_comment||j.final_manager_comment||j.purchase_comment)&&i.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"처리 내역"}),j.middle_manager_comment&&i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"1차 승인자 코멘트"}),i.jsx("p",{className:"text-gray-900",children:j.middle_manager_comment})]}),j.final_manager_comment&&i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"최종 승인자 코멘트"}),i.jsx("p",{className:"text-gray-900",children:j.final_manager_comment})]}),j.purchase_comment&&i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"구매담당자 코멘트"}),i.jsx("p",{className:"text-gray-900",children:j.purchase_comment})]})]})]}):i.jsxs("div",{className:"text-center py-12",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주 정보를 찾을 수 없습니다"}),i.jsxs(c,{onClick:()=>o("/purchase/list"),className:"mt-4",children:[i.jsx(h,{className:"w-4 h-4 mr-2"}),"목록으로 돌아가기"]})]})}export{o as default};
//# sourceMappingURL=PurchaseDetailMain-Dng5PXMz.js.map
