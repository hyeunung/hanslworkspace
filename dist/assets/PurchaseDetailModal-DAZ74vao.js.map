{"version":3,"file":"PurchaseDetailModal-DAZ74vao.js","sources":["../../node_modules/lucide-react/dist/esm/icons/truck.js","../../src/components/ui/datepicker.tsx","../../src/components/purchase/PurchaseDetailModal.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2\", key: \"wrbu53\" }],\n  [\"path\", { d: \"M15 18H9\", key: \"1lyqi6\" }],\n  [\n    \"path\",\n    {\n      d: \"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14\",\n      key: \"lysw3i\"\n    }\n  ],\n  [\"circle\", { cx: \"17\", cy: \"18\", r: \"2\", key: \"332jqn\" }],\n  [\"circle\", { cx: \"7\", cy: \"18\", r: \"2\", key: \"19iecd\" }]\n];\nconst Truck = createLucideIcon(\"truck\", __iconNode);\n\nexport { __iconNode, Truck as default };\n//# sourceMappingURL=truck.js.map\n","\nimport * as React from \"react\"\nimport { format } from \"date-fns\"\nimport { ko } from \"date-fns/locale\"\nimport { Calendar as CalendarIcon } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Calendar } from \"@/components/ui/calendar\"\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\"\n\ninterface DatePickerProps {\n  date?: Date\n  onDateChange?: (date: Date | undefined) => void\n  placeholder?: string\n  className?: string\n  disabled?: boolean\n}\n\nexport function DatePicker({\n  date,\n  onDateChange,\n  placeholder = \"ë‚ ì§œ ì„ íƒ\",\n  className,\n  disabled = false\n}: DatePickerProps) {\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button\n          variant={\"outline\"}\n          className={cn(\n            \"justify-start text-left font-normal\",\n            !date && \"text-muted-foreground\",\n            className\n          )}\n          disabled={disabled}\n        >\n          <CalendarIcon className=\"mr-2 h-4 w-4\" />\n          {date ? format(date, \"yyyy-MM-dd\", { locale: ko }) : <span>{placeholder}</span>}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-auto p-0\">\n        <Calendar\n          mode=\"single\"\n          selected={date}\n          onSelect={onDateChange}\n          initialFocus\n        />\n      </PopoverContent>\n    </Popover>\n  )\n}","import { useEffect, useState, useRef } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { PurchaseRequestWithDetails } from '@/types/purchase'\nimport { formatDate } from '@/utils/helpers'\nimport { DatePickerPopover } from '@/components/ui/date-picker-popover'\nimport { DatePicker } from '@/components/ui/datepicker'\nimport { \n  Calendar, \n  User, \n  Building2, \n  Package, \n  CreditCard,\n  X,\n  FileText,\n  DollarSign,\n  Edit2,\n  Trash2,\n  Save,\n  Plus,\n  CheckCircle,\n  XCircle,\n  Check,\n  Truck\n} from 'lucide-react'\nimport { Button } from '@/components/ui/button'\nimport { Badge } from '@/components/ui/badge'\nimport { Input } from '@/components/ui/input'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog'\nimport { toast } from 'sonner'\nimport { logger } from '@/lib/logger'\n\ninterface PurchaseDetailModalProps {\n  purchaseId: number | null\n  isOpen: boolean\n  onClose: () => void\n  embedded?: boolean  // Dialog ì—†ì´ ë‚´ìš©ë§Œ ë Œë”ë§\n  currentUserRoles?: string[]\n  activeTab?: string\n  onRefresh?: (forceRefresh?: boolean) => void\n  onDelete?: (purchase: PurchaseRequestWithDetails) => void\n}\n\nexport default function PurchaseDetailModal({ \n  purchaseId, \n  isOpen, \n  onClose, \n  embedded = false,\n  currentUserRoles = [],\n  activeTab,\n  onRefresh,\n  onDelete\n}: PurchaseDetailModalProps) {\n  const [loading, setLoading] = useState(false)\n  const [purchase, setPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [isEditing, setIsEditing] = useState(false)\n  const [editedPurchase, setEditedPurchase] = useState<PurchaseRequestWithDetails | null>(null)\n  const [editedItems, setEditedItems] = useState<any[]>([])\n  const [deletedItemIds, setDeletedItemIds] = useState<number[]>([])\n  const [userRoles, setUserRoles] = useState<string[]>([])\n  const [currentUserName, setCurrentUserName] = useState<string>('')\n  const [columnWidths, setColumnWidths] = useState<number[]>([])\n  const headerRowRef = useRef<HTMLDivElement>(null)\n  const supabase = createClient()\n  \n  // ì‚¬ìš©ì ê¶Œí•œ ë° ì´ë¦„ ì§ì ‘ ë¡œë“œ\n  useEffect(() => {\n    const loadUserRoles = async () => {\n      try {\n        const { data: { user } } = await supabase.auth.getUser()\n        if (user) {\n          // ë¨¼ì € IDë¡œ ì‹œë„\n          let { data: employeeData } = await supabase\n            .from('employees')\n            .select('*')\n            .eq('id', user.id)\n            .maybeSingle()\n          \n          // IDë¡œ ëª» ì°¾ì•˜ìœ¼ë©´ ì´ë©”ì¼ë¡œ ì‹œë„\n          if (!employeeData && user.email) {\n            const { data: employeeByEmail } = await supabase\n              .from('employees')\n              .select('*')\n              .eq('email', user.email)\n              .maybeSingle()\n            \n            employeeData = employeeByEmail\n          }\n          \n          // ì‚¬ìš©ì ì´ë¦„ ì €ì¥\n          if (employeeData?.name) {\n            setCurrentUserName(employeeData.name)\n          }\n          \n          if (employeeData?.purchase_role) {\n            let roles: string[] = []\n            if (Array.isArray(employeeData.purchase_role)) {\n              roles = employeeData.purchase_role.map((r: any) => String(r).trim())\n            } else {\n              const roleString = String(employeeData.purchase_role)\n              roles = roleString\n                .split(',')\n                .map((r: string) => r.trim())\n                .filter((r: string) => r.length > 0)\n            }\n            setUserRoles(roles)\n          }\n        }\n      } catch (error) {\n      }\n    }\n    \n    if (isOpen) {\n      loadUserRoles()\n    }\n  }, [isOpen])\n  \n  // currentUserRolesê°€ ë°°ì—´ì´ ì•„ë‹ˆë©´ userRoles ì‚¬ìš©\n  const effectiveRoles = Array.isArray(currentUserRoles) && currentUserRoles.length > 0 \n    ? currentUserRoles \n    : userRoles\n  \n  // ê¶Œí•œ ì²´í¬\n  const canEdit = effectiveRoles.includes('final_approver') || \n                  effectiveRoles.includes('app_admin') || \n                  effectiveRoles.includes('ceo')\n  \n  // ì‚­ì œ ê¶Œí•œ: ê´€ë¦¬ì ë˜ëŠ” ìš”ì²­ì ë³¸ì¸ (ë‹¨, ìŠ¹ì¸ëœ ìš”ì²­ì€ ê´€ë¦¬ìë§Œ)\n  const isApproved = purchase?.final_manager_status === 'approved';\n  const canDelete = isApproved \n    ? canEdit  // ìŠ¹ì¸ëœ ìš”ì²­ì€ ê´€ë¦¬ìë§Œ ì‚­ì œ ê°€ëŠ¥\n    : (canEdit || (purchase?.requester_name === currentUserName))  // ë¯¸ìŠ¹ì¸ ìš”ì²­ì€ ìš”ì²­ìë„ ì‚­ì œ ê°€ëŠ¥\n  \n  // êµ¬ë§¤ ê¶Œí•œ ì²´í¬: app_admin + lead buyerë§Œ (ìš”ì²­ì ë³¸ì¸ ì œì™¸)\n  const canPurchase = effectiveRoles.includes('app_admin') || \n                     effectiveRoles.includes('lead_buyer') || \n                     effectiveRoles.includes('lead buyer')\n  \n  // ì…ê³  ê¶Œí•œ ì²´í¬ \n  // 1. ê´€ë¦¬ìëŠ” ëª¨ë“  ê±´ ì…ê³  ì²˜ë¦¬ ê°€ëŠ¥\n  // 2. ìš”ì²­ìëŠ” ìì‹ ì˜ ìš”ì²­ê±´ë§Œ ì…ê³  ì²˜ë¦¬ ê°€ëŠ¥\n  const canReceiveItems = effectiveRoles.includes('app_admin') || \n                         (purchase?.requester_name === currentUserName)\n  // 2. ì¼ë°˜ ì§ì›ì€ ë³¸ì¸ì´ ìš”ì²­í•œ ê±´ë§Œ ì…ê³  ì²˜ë¦¬ ê°€ëŠ¥\n  const isAdmin = effectiveRoles.includes('final_approver') || \n                  effectiveRoles.includes('app_admin') || \n                  effectiveRoles.includes('ceo')\n  const isRequester = purchase?.requester_name === currentUserName\n  const canReceiptCheck = isAdmin || isRequester\n  \n  // ë””ë²„ê¹…ìš© ë¡œê·¸\n  logger.debug('Receipt Check', {\n    activeTab,\n    canReceiptCheck,\n    isAdmin,\n    isRequester,\n    currentUserName,\n    requesterName: purchase?.requester_name,\n    effectiveRoles\n  });\n  \n  // ìŠ¹ì¸ ê¶Œí•œ ì²´í¬\n const canApproveMiddle = effectiveRoles.includes('middle_manager') || \n                          effectiveRoles.includes('app_admin') || \n                          effectiveRoles.includes('ceo')\n \n const canApproveFinal = effectiveRoles.includes('final_approver') || \n                         effectiveRoles.includes('app_admin') || \n                         effectiveRoles.includes('ceo')\n \n const approvalPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2 py-0.5 badge-text leading-tight'\n const approvalButtonClass = 'inline-flex items-center gap-1 business-radius-badge !h-auto !min-h-0 !px-2.5 !py-0.5 badge-text leading-tight'\n const approvalWaitingPillClass = 'inline-flex items-center gap-1 business-radius-badge px-2.5 py-0.5 badge-text leading-tight'\n \n   // ë””ë²„ê¹… ë¡œê·¸\n   logger.debug('PurchaseDetailModal ê¶Œí•œ ì²´í¬', {\n     currentUserRoles,\n     userRoles,\n     effectiveRoles,\n     canApproveMiddle,\n     canApproveFinal,\n     isEditing,\n     middleManagerStatus: purchase?.middle_manager_status,\n     finalManagerStatus: purchase?.final_manager_status\n   });\n \n  useEffect(() => {\n    if (purchaseId && isOpen) {\n      loadPurchaseDetail(purchaseId.toString())\n      setIsEditing(false) // ëª¨ë‹¬ ì—´ ë•Œë§ˆë‹¤ í¸ì§‘ ëª¨ë“œ ì´ˆê¸°í™”\n    }\n  }, [purchaseId, isOpen])\n\n  // ì¹¼ëŸ¼ ë„ˆë¹„ ì¸¡ì • ë° ì €ì¥\n  const measureColumnWidths = () => {\n    if (headerRowRef.current && !isEditing) {\n      const cells = headerRowRef.current.children\n      const widths = Array.from(cells).map(cell => {\n        const rect = cell.getBoundingClientRect()\n        return rect.width\n      })\n      setColumnWidths(widths)\n      logger.debug('Column widths measured', { widths })\n    }\n  }\n\n  // View ëª¨ë“œì—ì„œ ì¹¼ëŸ¼ ë„ˆë¹„ ì¸¡ì • (ë°ì´í„° ë¡œë“œ í›„)\n  useEffect(() => {\n    if (purchase && purchase.items && purchase.items.length > 0 && !isEditing) {\n      // ë‹¤ìŒ ë Œë”ë§ ì‚¬ì´í´ì—ì„œ ì¸¡ì • (DOMì´ ì™„ì „íˆ ë Œë”ë§ëœ í›„)\n      setTimeout(measureColumnWidths, 100)\n    }\n  }, [purchase, isEditing, activeTab])\n\n  // Edit ëª¨ë“œ ì „í™˜ ì‹œ ë„ˆë¹„ ì¸¡ì •\n  const handleEditToggle = (editing: boolean) => {\n    if (editing && !isEditing) {\n      // Edit ëª¨ë“œë¡œ ì „í™˜í•˜ê¸° ì „ì— í˜„ì¬ ë„ˆë¹„ ì¸¡ì •\n      measureColumnWidths()\n    }\n    setIsEditing(editing)\n  }\n\n  const loadPurchaseDetail = async (id: string) => {\n    try {\n      setLoading(true)\n      const supabase = createClient()\n      \n      const { data, error } = await supabase\n        .from('purchase_requests')\n        .select(`\n          *,\n          vendors(id, vendor_name),\n          purchase_request_items(*)\n        `)\n        .eq('id', id)\n        .single()\n\n      if (error) throw error\n\n      if (data) {\n        const purchaseData = {\n          ...data,\n          items: data.purchase_request_items || [],\n          vendor: data.vendors || { id: 0, vendor_name: 'ì•Œ ìˆ˜ ì—†ìŒ' },\n          vendor_contacts: []\n        } as PurchaseRequestWithDetails\n        setPurchase(purchaseData)\n        setEditedPurchase(purchaseData)\n        setEditedItems(purchaseData.items || [])\n      }\n    } catch (error) {\n      toast.error('ë°œì£¼ ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const getStatusBadge = () => {\n    if (!purchase) return null\n    \n    // payment_category ìš°ì„  í™•ì¸\n    if (purchase.payment_category) {\n      const category = purchase.payment_category.trim()\n      \n      if (category === 'ë°œì£¼') {\n        return <Badge variant={null} className=\"badge-success\">ë°œì£¼</Badge>\n      } else if (category === 'êµ¬ë§¤ìš”ì²­') {\n        return <Badge variant={null} className=\"badge-primary\">êµ¬ë§¤ìš”ì²­</Badge>\n      } else if (category === 'í˜„ì¥ê²°ì œ') {\n        return <Badge variant={null} className=\"badge-secondary\">í˜„ì¥ê²°ì œ</Badge>\n      } else {\n        // payment_category ê°’ì´ ìˆì§€ë§Œ ì•Œë ¤ì§„ ê°’ì´ ì•„ë‹Œ ê²½ìš°\n        return <Badge variant={null} className=\"badge-primary\">{category}</Badge>\n      }\n    }\n    \n    // payment_categoryê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’\n    return <Badge variant={null} className=\"badge-primary\">êµ¬ë§¤ìš”ì²­</Badge>\n  }\n\n  // formatDateëŠ” utils/helpers.tsì—ì„œ import\n\n  const formatCurrency = (amount: number) => {\n    return new Intl.NumberFormat('ko-KR').format(amount)\n  }\n\n  const handleSave = async () => {\n    if (!purchase || !editedPurchase) {\n      toast.error('ì €ì¥í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n    \n    try {\n      logger.debug('ì €ì¥ ì‹œì‘', { \n        purchaseId: purchase.id, \n        editedItemsCount: editedItems.length,\n        deletedItemsCount: deletedItemIds.length \n      });\n      \n      // ë°œì£¼ ê¸°ë³¸ ì •ë³´ ì—…ë°ì´íŠ¸\n      const totalAmount = editedItems.reduce((sum, item) => sum + (item.amount_value || 0), 0)\n      logger.debug('ê³„ì‚°ëœ ì´ì•¡', { totalAmount });\n      \n      const { error: updateError } = await supabase\n        .from('purchase_requests')\n        .update({\n          purchase_order_number: editedPurchase.purchase_order_number || null,\n          requester_name: editedPurchase.requester_name || null,\n          delivery_request_date: editedPurchase.delivery_request_date || null,\n          revised_delivery_request_date: editedPurchase.revised_delivery_request_date || null,\n          payment_category: editedPurchase.payment_category || null,\n          project_vendor: editedPurchase.project_vendor || null,\n          total_amount: Number(totalAmount),\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', purchase.id)\n\n      if (updateError) throw updateError\n\n      // ì‚­ì œëœ í•­ëª©ë“¤ ì²˜ë¦¬\n      if (deletedItemIds.length > 0) {\n        const { error: deleteError } = await supabase\n          .from('purchase_request_items')\n          .delete()\n          .in('id', deletedItemIds)\n\n        if (deleteError) throw deleteError\n      }\n\n      // ê° ì•„ì´í…œ ì—…ë°ì´íŠ¸ ë˜ëŠ” ìƒì„±\n      logger.debug('ì €ì¥í•  editedItems', { count: editedItems.length });\n      \n      for (const item of editedItems) {\n        logger.debug('ì²˜ë¦¬ ì¤‘ì¸ item', { \n          itemId: item.id, \n          itemName: item.item_name,\n          quantity: item.quantity,\n          unitPrice: item.unit_price_value,\n          amount: item.amount_value\n        });\n        \n        // í•„ìˆ˜ í•„ë“œ ê²€ì¦\n        if (!item.item_name || !item.item_name.trim()) {\n          throw new Error('í’ˆëª©ëª…ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.');\n        }\n        if (!item.quantity || item.quantity <= 0) {\n          throw new Error('ìˆ˜ëŸ‰ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.');\n        }\n        if (!item.unit_price_value || item.unit_price_value < 0) {\n          throw new Error('ë‹¨ê°€ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');\n        }\n        if (!item.amount_value || item.amount_value < 0) {\n          throw new Error('í•©ê³„ëŠ” 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');\n        }\n        \n        if (item.id) {\n          // ê¸°ì¡´ í•­ëª© ì—…ë°ì´íŠ¸\n          logger.debug('ê¸°ì¡´ í•­ëª© ì—…ë°ì´íŠ¸', { itemId: item.id });\n          const { error } = await supabase\n            .from('purchase_request_items')\n            .update({\n              item_name: item.item_name.trim(),\n              specification: item.specification || null,\n              quantity: Number(item.quantity),\n              unit_price_value: Number(item.unit_price_value),\n              unit_price_currency: purchase.currency || 'KRW',\n              amount_value: Number(item.amount_value),\n              amount_currency: purchase.currency || 'KRW',\n              remark: item.remark || null,\n              updated_at: new Date().toISOString()\n            })\n            .eq('id', item.id)\n\n          if (error) {\n            logger.error('ê¸°ì¡´ í•­ëª© ì—…ë°ì´íŠ¸ ì˜¤ë¥˜', error);\n            throw error;\n          }\n        } else {\n          // ìƒˆ í•­ëª© ìƒì„±\n          logger.debug('ìƒˆ í•­ëª© ìƒì„±', { itemName: item.item_name });\n          const insertData = {\n            purchase_request_id: purchase.id,\n            item_name: item.item_name.trim(),\n            specification: item.specification || null,\n            quantity: Number(item.quantity),\n            unit_price_value: Number(item.unit_price_value),\n            unit_price_currency: purchase.currency || 'KRW',\n            amount_value: Number(item.amount_value),\n            amount_currency: purchase.currency || 'KRW',\n            remark: item.remark || null,\n            line_number: item.line_number || editedItems.indexOf(item) + 1,\n            created_at: new Date().toISOString()\n          };\n          logger.debug('ì‚½ì…í•  ë°ì´í„°', { itemName: insertData.item_name });\n          \n          const { error } = await supabase\n            .from('purchase_request_items')\n            .insert(insertData)\n\n          if (error) {\n            logger.error('ìƒˆ í•­ëª© ìƒì„± ì˜¤ë¥˜', error);\n            throw error;\n          } else {\n            logger.debug('ìƒˆ í•­ëª© ìƒì„± ì„±ê³µ');\n          }\n        }\n      }\n\n      logger.debug('ì €ì¥ ì™„ë£Œ');\n      toast.success('ë°œì£¼ ë‚´ì—­ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.')\n      handleEditToggle(false)\n      setDeletedItemIds([])\n      \n      // ìˆ˜ì •ëœ ë°ì´í„° ë‹¤ì‹œ ë¡œë“œ (ëª¨ë‹¬ì€ ì—´ë¦° ìƒíƒœ ìœ ì§€)\n      await loadPurchaseDetail(purchaseId?.toString() || '')\n    } catch (error) {\n      logger.error('ì €ì¥ ì¤‘ ì „ì²´ ì˜¤ë¥˜', error);\n      const errorMessage = error instanceof Error ? error.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤'\n      toast.error(`ì €ì¥ ì‹¤íŒ¨: ${errorMessage}`)\n    }\n  }\n\n  const handleItemChange = (index: number, field: string, value: any) => {\n    const newItems = [...editedItems]\n    \n    if (field === 'amount_value') {\n      // ê¸ˆì•¡ì„ ì§ì ‘ ìˆ˜ì •í•œ ê²½ìš°\n      newItems[index] = {\n        ...newItems[index],\n        amount_value: value\n      }\n    } else if (field === 'quantity' || field === 'unit_price_value') {\n      // ìˆ˜ëŸ‰ì´ë‚˜ ë‹¨ê°€ë¥¼ ìˆ˜ì •í•œ ê²½ìš° ê¸ˆì•¡ ìë™ ê³„ì‚°\n      const quantity = field === 'quantity' ? value : newItems[index].quantity\n      const unitPrice = field === 'unit_price_value' ? value : newItems[index].unit_price_value\n      newItems[index] = {\n        ...newItems[index],\n        [field]: value,\n        amount_value: quantity * unitPrice\n      }\n    } else {\n      // ê¸°íƒ€ í•„ë“œ ìˆ˜ì •\n      newItems[index] = {\n        ...newItems[index],\n        [field]: value\n      }\n    }\n    \n    setEditedItems(newItems)\n  }\n\n  const handleAddItem = () => {\n    const newItem = {\n      item_name: '',\n      specification: '',\n      quantity: 1,\n      unit_price_value: 0,\n      amount_value: 0,\n      remark: '',\n      line_number: editedItems.length + 1\n    }\n    setEditedItems([...editedItems, newItem])\n  }\n\n  const handleRemoveItem = (index: number) => {\n    const item = editedItems[index]\n    if (item.id) {\n      setDeletedItemIds([...deletedItemIds, item.id])\n    }\n    const newItems = editedItems.filter((_, i) => i !== index)\n    setEditedItems(newItems)\n  }\n\n  // êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ í•¨ìˆ˜\n  const handlePaymentToggle = async (itemId: number | string, isCompleted: boolean) => {\n    if (!canPurchase) {\n      toast.error('êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('ìœ íš¨í•˜ì§€ ì•Šì€ í•­ëª© ID ì…ë‹ˆë‹¤.')\n      return\n    }\n\n    // í•´ë‹¹ í’ˆëª© ì •ë³´ ì°¾ê¸°\n    const targetItem = purchase?.items?.find(item => item.id === itemIdStr)\n    if (!targetItem) return\n\n    const itemInfo = `í’ˆëª…: ${targetItem.item_name}\nê·œê²©: ${targetItem.specification || 'ë¯¸ì…ë ¥'}\nìˆ˜ëŸ‰: ${targetItem.quantity?.toLocaleString() || 0}${targetItem.unit || ''}\në‹¨ê°€: â‚©${targetItem.unit_price_value?.toLocaleString() || 0}\ní•©ê³„: â‚©${targetItem.amount_value?.toLocaleString() || 0}`\n\n    const confirmMessage = isCompleted \n      ? `ë‹¤ìŒ í’ˆëª©ì„ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\n${itemInfo}` \n      : `ë‹¤ìŒ í’ˆëª©ì˜ êµ¬ë§¤ì™„ë£Œë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\n${itemInfo}`\n    \n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_payment_completed: isCompleted,\n          payment_completed_at: isCompleted ? new Date().toISOString() : null\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      // ë¡œì»¬ ìƒíƒœ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ (UI ì¦‰ì‹œ ë°˜ì˜)\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          item.id === itemIdStr \n            ? { ...item, is_payment_completed: isCompleted, payment_completed_at: isCompleted ? new Date().toISOString() : null }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n      \n      toast.success(isCompleted ? 'êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'êµ¬ë§¤ì™„ë£Œê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.')\n    } catch (error) {\n      toast.error('êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  // ê°œë³„ í’ˆëª© ì…ê³ ì™„ë£Œ ì²˜ë¦¬ (ë‚ ì§œ ì„ íƒ)\n  const handleItemReceiptToggle = async (itemId: number | string, selectedDate: Date) => {\n    if (!canReceiptCheck) {\n      toast.error('ì…ê³  ì²˜ë¦¬ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('ìœ íš¨í•˜ì§€ ì•Šì€ í•­ëª© ID ì…ë‹ˆë‹¤.')\n      return\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: true,\n          received_at: new Date().toISOString(),\n          actual_received_date: selectedDate.toISOString()\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      // ë¡œì»¬ ìƒíƒœ ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          item.id === itemIdStr \n            ? { \n                ...item, \n                is_received: true, \n                received_at: new Date().toISOString(),\n                actual_received_date: selectedDate.toISOString()\n              }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n      \n      const targetItem = purchase?.items?.find(item => item.id === itemIdStr)\n      toast.success(`\"${targetItem?.item_name}\" í’ˆëª©ì´ ì…ê³ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.`)\n    } catch (error) {\n      toast.error('ì…ê³ ì™„ë£Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  // ì…ê³ ì™„ë£Œ ì·¨ì†Œ ì²˜ë¦¬\n  const handleReceiptCancel = async (itemId: number | string) => {\n    if (!canReceiptCheck) {\n      toast.error('ì…ê³  ì²˜ë¦¬ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      toast.error('ìœ íš¨í•˜ì§€ ì•Šì€ í•­ëª© ID ì…ë‹ˆë‹¤.')\n      return\n    }\n\n    const targetItem = purchase?.items?.find(item => item.id === itemIdStr)\n    if (!targetItem) return\n\n    const confirm = window.confirm(`\"${targetItem.item_name}\" í’ˆëª©ì˜ ì…ê³ ì™„ë£Œë¥¼ ì·¨ì†Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)\n    if (!confirm) return\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: false,\n          received_at: null,\n          actual_received_date: null\n        })\n        .eq('id', numericId)\n\n      if (error) throw error\n\n      // ë¡œì»¬ ìƒíƒœ ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          item.id === itemIdStr \n            ? { ...item, is_received: false, received_at: null, actual_received_date: undefined }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n      \n      toast.success('ì…ê³ ì™„ë£Œê°€ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.')\n    } catch (error) {\n      toast.error('ì…ê³ ì™„ë£Œ ì·¨ì†Œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  // ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ì²˜ë¦¬ í•¨ìˆ˜\n  const handleStatementCheck = async (itemId: number | string, selectedDate: Date) => {\n    console.log('ğŸ” ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ì‹œì‘:', { itemId, selectedDate, canReceiptCheck, currentUserName })\n    \n    if (!canReceiptCheck) {\n      console.error('âŒ ê¶Œí•œ ì—†ìŒ:', { canReceiptCheck, currentUserRoles })\n      toast.error('ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.')\n      return\n    }\n\n    const itemIdStr = String(itemId)\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId)\n\n    if (Number.isNaN(numericId)) {\n      console.error('âŒ ì˜ëª»ëœ ID:', { itemId, numericId })\n      toast.error('ìœ íš¨í•˜ì§€ ì•Šì€ í•­ëª© ID ì…ë‹ˆë‹¤.')\n      return\n    }\n\n    console.log('ğŸ“ ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸ ì‹œì‘:', { numericId, selectedDate: selectedDate.toISOString() })\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_statement_received: true,\n          statement_received_date: selectedDate.toISOString(),\n          statement_received_by_name: currentUserName\n        })\n        .eq('id', numericId)\n\n      if (error) {\n        console.error('âŒ DB ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error)\n        throw error\n      }\n\n      console.log('âœ… DB ì—…ë°ì´íŠ¸ ì„±ê³µ')\n\n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          item.id === itemIdStr \n            ? { \n                ...item, \n                is_statement_received: true, \n                statement_received_date: selectedDate.toISOString(),\n                statement_received_by_name: currentUserName\n              }\n            : item\n        )\n        console.log('ğŸ”„ ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸:', { itemIdStr, updatedItems: updatedItems?.length })\n        return { ...prev, items: updatedItems }\n      })\n      \n      const targetItem = purchase?.items?.find(item => item.id === itemIdStr)\n      console.log('ğŸ‰ ì²˜ë¦¬ ì™„ë£Œ:', { targetItem: targetItem?.item_name })\n      toast.success(`\"${targetItem?.item_name}\" ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`)\n    } catch (error) {\n      console.error('âŒ ì „ì²´ ì²˜ë¦¬ ì‹¤íŒ¨:', error)\n      toast.error('ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  // ìŠ¹ì¸ ì²˜ë¦¬\n  const handleApprove = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const approvalType = type === 'middle' ? '1ì°¨ ìŠ¹ì¸' : 'ìµœì¢… ìŠ¹ì¸'\n    const confirmMessage = `ë°œì£¼ë²ˆí˜¸: ${purchase.purchase_order_number}\\n\\n${approvalType}ì„ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n    \n    try {\n      const updateData = type === 'middle' \n        ? { \n            middle_manager_status: 'approved'\n          }\n        : { \n            final_manager_status: 'approved'\n          }\n      \n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n      \n      // ë¡œì»¬ ìƒíƒœ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ (UI ì¦‰ì‹œ ë°˜ì˜)\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'approved' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'approved' } : null)\n      }\n      \n      toast.success(`${type === 'middle' ? 'ì¤‘ê°„' : 'ìµœì¢…'} ìŠ¹ì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`)\n    } catch (error) {\n      toast.error('ìŠ¹ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n  \n  // ì „ì²´ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬\n  const handleCompleteAllPayment = async () => {\n    if (!purchase || !canPurchase) return\n    \n    const confirmMessage = `ë°œì£¼ë²ˆí˜¸: ${purchase.purchase_order_number}\\n\\nëª¨ë“  í’ˆëª©ì„ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`\n    const confirm = window.confirm(confirmMessage)\n    if (!confirm) return\n    \n    try {\n      const updateData = {\n        is_payment_completed: true,\n        payment_completed_at: new Date().toISOString()\n      }\n      \n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update(updateData)\n        .eq('purchase_request_id', purchase.id)\n        .eq('is_payment_completed', false) // ì•„ì§ êµ¬ë§¤ì™„ë£Œë˜ì§€ ì•Šì€ í•­ëª©ë§Œ\n      \n      if (error) throw error\n      \n      // ë¡œì»¬ ìƒíƒœ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ (UI ì¦‰ì‹œ ë°˜ì˜)\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          !item.is_payment_completed \n            ? { ...item, is_payment_completed: true, payment_completed_at: new Date().toISOString() }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n      \n      toast.success('ëª¨ë“  í’ˆëª©ì´ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n    } catch (error) {\n      logger.error('ì „ì²´ êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ ì˜¤ë¥˜', error);\n      toast.error('êµ¬ë§¤ì™„ë£Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  // ì „ì²´ ì…ê³ ì™„ë£Œ ì²˜ë¦¬ (ë‚ ì§œ ì„ íƒ)\n  const handleCompleteAllReceipt = async (selectedDate: Date) => {\n    if (!purchase || !canReceiveItems) return\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_received: true,\n          received_at: new Date().toISOString(),\n          actual_received_date: selectedDate.toISOString()\n        })\n        .eq('purchase_request_id', purchase.id)\n        .is('actual_received_date', null) // ì•„ì§ ì‹¤ì œ ì…ê³ ë˜ì§€ ì•Šì€ í•­ëª©ë§Œ\n\n      if (error) throw error\n\n      // ë¡œì»¬ ìƒíƒœ ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n      setPurchase(prev => {\n        if (!prev) return null\n        const updatedItems = prev.items?.map(item => \n          !item.actual_received_date \n            ? { \n                ...item, \n                is_received: true, \n                received_at: new Date().toISOString(),\n                actual_received_date: selectedDate.toISOString()\n              }\n            : item\n        )\n        return { ...prev, items: updatedItems }\n      })\n\n      toast.success('ëª¨ë“  í’ˆëª©ì´ ì…ê³ ì™„ë£Œ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.')\n    } catch (error) {\n      logger.error('ì „ì²´ ì…ê³ ì™„ë£Œ ì²˜ë¦¬ ì˜¤ë¥˜', error)\n      toast.error('ì…ê³ ì™„ë£Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n  \n\n  // ë°˜ë ¤ ì²˜ë¦¬\n  const handleReject = async (type: 'middle' | 'final') => {\n    if (!purchase) return\n    \n    const reason = window.prompt('ë°˜ë ¤ ì‚¬ìœ ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:')\n    if (!reason) return\n    \n    try {\n      const updateData = type === 'middle'\n        ? {\n            middle_manager_status: 'rejected'\n          }\n        : {\n            final_manager_status: 'rejected'\n          }\n      \n      const { error } = await supabase\n        .from('purchase_requests')\n        .update(updateData)\n        .eq('id', purchase.id)\n      \n      if (error) {\n        throw error\n      }\n      \n      // ë¡œì»¬ ìƒíƒœ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ (UI ì¦‰ì‹œ ë°˜ì˜)\n      if (type === 'middle') {\n        setPurchase(prev => prev ? { ...prev, middle_manager_status: 'rejected' } : null)\n      } else {\n        setPurchase(prev => prev ? { ...prev, final_manager_status: 'rejected' } : null)\n      }\n      \n      toast.success(`${type === 'middle' ? 'ì¤‘ê°„' : 'ìµœì¢…'} ë°˜ë ¤ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`)\n    } catch (error) {\n      toast.error('ë°˜ë ¤ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')\n    }\n  }\n\n  const content = (\n    <div className=\"space-y-1 sm:space-y-4\">\n      {loading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-hansl-600\"></div>\n        </div>\n      ) : purchase ? (\n        <div>\n          {/* Compact Info Header */}\n          <div className=\"bg-gray-50 rounded-lg p-2 sm:p-3 mb-1 sm:mb-2 border border-gray-100\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-3 items-center gap-3 sm:gap-0\">\n              <div className=\"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4\">\n                <div className=\"flex items-center gap-3\">\n                  {getStatusBadge()}\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"modal-label\">ìš”ì²­ì:</span>\n                    <span className=\"modal-value\">{purchase.requester_name}</span>\n                  </div>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-3 h-3 text-gray-500\" />\n                  <span className=\"modal-subtitle\">ì²­êµ¬ì¼: {formatDate(purchase.request_date)}</span>\n                </div>\n              </div>\n              \n              {/* ìŠ¹ì¸ ë²„íŠ¼ë“¤ì„ ì¤‘ì•™ì— ë°°ì¹˜ */}\n              <div className=\"flex items-center justify-center gap-2 sm:gap-3 flex-wrap\">\n                {/* 1ì°¨ ìŠ¹ì¸ ë²„íŠ¼ */}\n                {canApproveMiddle && purchase.middle_manager_status === 'pending' && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('middle')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    1ì°¨ ìŠ¹ì¸ ëŒ€ê¸°\n                  </Button>\n                )}\n                {purchase.middle_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text shadow-sm\">\n                    <Check className=\"w-3 h-3\" />\n                    1ì°¨ ìŠ¹ì¸ì™„ë£Œ\n                  </div>\n                )}\n                {purchase.middle_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                    1ì°¨ ë°˜ë ¤\n                  </div>\n                )}\n                {purchase.middle_manager_status === 'pending' && !canApproveMiddle && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                    1ì°¨ ìŠ¹ì¸ëŒ€ê¸°\n                  </div>\n                )}\n\n                {/* ìµœì¢… ìŠ¹ì¸ ë²„íŠ¼ */}\n                {canApproveFinal && purchase.middle_manager_status === 'approved' && purchase.final_manager_status === 'pending' && (\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => handleApprove('final')}\n                    className={`${approvalButtonClass} border border-gray-400 bg-white hover:bg-gray-50 hover:border-gray-500`}\n                  >\n                    <Check className=\"w-3 h-3\" />\n                    ìµœì¢… ìŠ¹ì¸\n                  </Button>\n                )}\n                {purchase.final_manager_status === 'approved' && (\n                  <div className=\"button-approved badge-text\">\n                    <Check className=\"w-3 h-3\" />\n                    ìµœì¢… ìŠ¹ì¸ì™„ë£Œ\n                  </div>\n                )}\n                {purchase.final_manager_status === 'rejected' && (\n                  <div className=\"button-rejected badge-text\">\n                    <X className=\"w-3 h-3\" />\n                    ìµœì¢… ë°˜ë ¤\n                  </div>\n                )}\n                {purchase.middle_manager_status !== 'approved' && purchase.final_manager_status === 'pending' && (\n                  <div className={`${approvalWaitingPillClass} border border-gray-300 text-gray-600 bg-white`}>\n                    ìµœì¢… ìŠ¹ì¸ëŒ€ê¸°\n                  </div>\n                )}\n              </div>\n              \n              {/* ìš°ì¸¡ ë¹ˆ ì˜ì—­ */}\n              <div></div>\n            </div>\n          </div>\n\n          {/* Main 2-Column Layout */}\n          <div className=\"flex flex-col lg:flex-row gap-3 sm:gap-6\">\n            {/* Left Column - Basic Info (Fixed Width) */}\n            <div className=\"lg:w-80 lg:flex-shrink-0 space-y-1 sm:space-y-4 relative\">\n              \n              {/* ë°œì£¼ ê¸°ë³¸ì •ë³´ */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <div className=\"mb-3\">\n                  <h3 className=\"modal-section-title flex items-center\">\n                    <FileText className=\"w-4 h-4 mr-2 text-gray-600\" />\n                    {purchase?.purchase_order_number || 'POë²ˆí˜¸ ì—†ìŒ'}\n                  </h3>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">ë°œì£¼ì„œ ì¢…ë¥˜</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.request_type || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, request_type: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"ì¼ë°˜\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.request_type || 'ì¼ë°˜'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">ê²°ì œ ì¢…ë¥˜</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.payment_category || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, payment_category: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"ë°œì£¼/êµ¬ë§¤ìš”ì²­/í˜„ì¥ê²°ì œ\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.payment_category || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">ì…ê³  ìš”ì²­ì¼</span>\n                      {isEditing ? (\n                        <DatePicker\n                          date={editedPurchase?.delivery_request_date ? new Date(editedPurchase.delivery_request_date) : undefined}\n                          onDateChange={(date: Date | undefined) => setEditedPurchase(prev => prev ? { ...prev, delivery_request_date: date?.toISOString().split('T')[0] || '' } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle\">{formatDate(purchase.delivery_request_date)}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label text-orange-500\">ë³€ê²½ ì…ê³ ì¼</span>\n                      {isEditing ? (\n                        <DatePicker\n                          date={editedPurchase?.revised_delivery_request_date ? new Date(editedPurchase.revised_delivery_request_date) : undefined}\n                          onDateChange={(date: Date | undefined) => setEditedPurchase(prev => prev ? { ...prev, revised_delivery_request_date: date?.toISOString().split('T')[0] || '' } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle text-orange-700\">\n                          {purchase.revised_delivery_request_date ? formatDate(purchase.revised_delivery_request_date) : 'ë¯¸ì„¤ì •'}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* ì—…ì²´ ì •ë³´ */}\n              <div className=\"bg-white rounded-lg p-2 sm:p-3 border border-gray-100 shadow-sm\">\n                <h3 className=\"modal-section-title mb-3 flex items-center\">\n                  <Building2 className=\"w-4 h-4 mr-2 text-gray-600\" />\n                  ì—…ì²´ ì •ë³´\n                </h3>\n                \n                <div className=\"space-y-2\">\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">ì—…ì²´ëª…</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.vendor?.vendor_name || editedPurchase?.vendor_name || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, vendor_name: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"ì—…ì²´ ì„ íƒ\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.vendor?.vendor_name || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">ì—…ì²´ ë‹´ë‹¹ì</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.vendor_contacts?.[0]?.contact_name || ''}\n                          onChange={(e) => {\n                            setEditedPurchase(prev => {\n                              if (!prev) return null;\n                              const contacts = prev.vendor_contacts || [];\n                              const updatedContacts = [...contacts];\n                              if (updatedContacts[0]) {\n                                updatedContacts[0] = { ...updatedContacts[0], contact_name: e.target.value };\n                              } else {\n                                updatedContacts[0] = { contact_name: e.target.value } as any;\n                              }\n                              return { ...prev, vendor_contacts: updatedContacts };\n                            })\n                          }}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"ë‹´ë‹¹ì ì„ íƒ\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.vendor_contacts?.[0]?.contact_name || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">PJì—…ì²´</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_vendor || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_vendor: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"ì…ë ¥\"\n                        />\n                      ) : (\n                        <p className=\"modal-value\">{purchase.project_vendor || '-'}</p>\n                      )}\n                    </div>\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">Item</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.project_item || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, project_item: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"ì…ë ¥\"\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle\">{purchase.project_item || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n\n                  <div className=\"grid grid-cols-1 sm:flex sm:gap-8\">\n                    <div className=\"w-32\">\n                      <span className=\"modal-label\">ìˆ˜ì£¼ë²ˆí˜¸</span>\n                      {isEditing ? (\n                        <Input\n                          value={editedPurchase?.order_number || ''}\n                          onChange={(e) => setEditedPurchase(prev => prev ? { ...prev, order_number: e.target.value } : null)}\n                          className=\"mt-1 rounded-lg border-gray-200 focus:border-blue-400 w-full h-5 px-1.5 py-0.5 text-[10px]\"\n                          placeholder=\"ì…ë ¥\"\n                        />\n                      ) : (\n                        <p className=\"modal-subtitle\">{purchase.order_number || '-'}</p>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n            </div>\n\n            {/* Right Column - Items List (Flexible Width) */}\n            <div className=\"lg:flex-1 lg:min-w-0 relative overflow-visible\">\n              \n              <div className=\"bg-white rounded-lg border border-gray-100 overflow-hidden shadow-sm\">\n                <div className=\"p-2 sm:p-3 bg-gray-50 border-b border-gray-100 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0\">\n                  <h3 className=\"modal-section-title flex items-center\">\n                    <Package className=\"w-4 h-4 mr-2 text-gray-600\" />\n                    í’ˆëª© ë¦¬ìŠ¤íŠ¸\n                    <span className=\"ml-2 badge-secondary\">\n                      {purchase.items?.length || 0}ê°œ\n                    </span>\n                  </h3>\n                  {!isEditing && (\n                    <>\n                      {activeTab === 'purchase' && canPurchase && (\n                        <Button\n                          size=\"sm\"\n                          onClick={handleCompleteAllPayment}\n                          className=\"button-base bg-orange-500 hover:bg-orange-600 text-white\"\n                        >\n                          <CreditCard className=\"w-3 h-3 mr-1\" />\n                          ì „ì²´ êµ¬ë§¤ì™„ë£Œ\n                        </Button>\n                      )}\n                      {activeTab === 'receipt' && canReceiveItems && (\n                        <DatePickerPopover\n                          onDateSelect={handleCompleteAllReceipt}\n                          placeholder=\"ì „ì²´ ì…ê³ ì™„ë£Œ ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”\"\n                          align=\"end\"\n                          side=\"bottom\"\n                        >\n                          <Button\n                            size=\"sm\"\n                            className=\"button-base button-action-primary\"\n                          >\n                            <Truck className=\"w-3 h-3 mr-1\" />\n                            ì „ì²´ ì…ê³ ì™„ë£Œ\n                          </Button>\n                        </DatePickerPopover>\n                      )}\n                    </>\n                  )}\n                </div>\n                \n                {/* Mobile Table Header */}\n                <div className=\"block sm:hidden bg-gray-50 px-2 py-1 border-b border-gray-100\">\n                  <div className=\"text-xs font-medium text-gray-600\">í’ˆëª© ëª©ë¡ (í„°ì¹˜í•˜ì—¬ ìŠ¤í¬ë¡¤)</div>\n                </div>\n                \n                {/* Items List with Header Inside Scrollable Container */}\n                <div className=\"max-h-[50vh] sm:max-h-[40vh] overflow-y-auto overflow-x-auto min-w-fit\">\n                  {/* Items Table Header - Sticky inside scroll container */}\n                  <div className=\"bg-gray-50 px-2 sm:px-3 py-1 border-b border-gray-100 sticky top-0 z-10\">\n                    <div \n                      ref={headerRowRef}\n                      className=\"hidden sm:grid gap-3 modal-label\" \n                      style={{\n                        gridTemplateColumns: isEditing && columnWidths.length > 0\n                          ? columnWidths.map(width => `${width}px`).join(' ')\n                          : activeTab === 'receipt' \n                            ? 'minmax(120px, 1fr) minmax(200px, 2fr) minmax(70px, auto) minmax(90px, auto) minmax(100px, auto) minmax(80px, 1fr) minmax(80px, auto) minmax(100px, auto) minmax(100px, auto) minmax(120px, auto)'\n                            : 'minmax(120px, 1fr) minmax(200px, 2fr) minmax(70px, auto) minmax(90px, auto) minmax(100px, auto) minmax(80px, 1fr) minmax(80px, auto) minmax(100px, auto) minmax(100px, auto)'\n                      }}\n                    >\n                      <div>í’ˆëª©ëª…</div>\n                      <div>ê·œê²©</div>\n                      <div className=\"text-center\">ìˆ˜ëŸ‰</div>\n                      <div className=\"text-right\">ë‹¨ê°€</div>\n                      <div className=\"text-right\">í•©ê³„</div>\n                      <div className=\"text-center\">ë¹„ê³ </div>\n                      {isEditing ? (\n                        <>\n                          <div className=\"text-center\">ì‚­ì œ</div>\n                          {activeTab === 'receipt' && (\n                            <>\n                              <div className=\"text-center\">ì‹¤ì œì…ê³ ì¼</div>\n                              <div className=\"text-center\">ê±°ë˜ëª…ì„¸ì„œ í™•ì¸</div>\n                              <div className=\"text-center\">íšŒê³„ìƒ ì…ê³ ì¼</div>\n                            </>\n                          )}\n                        </>\n                      ) : (\n                        <>\n                          <div className=\"text-center\">ìƒíƒœ</div>\n                          <div className=\"text-center\">ê±°ë˜ëª…ì„¸ì„œ í™•ì¸</div>\n                          <div className=\"text-center\">íšŒê³„ìƒ ì…ê³ ì¼</div>\n                          {activeTab === 'receipt' && (\n                            <>\n                              <div className=\"text-center\">ì‹¤ì œì…ê³ ì¼</div>\n                            </>\n                          )}\n                        </>\n                      )}\n                    </div>\n                  </div>\n                  {(isEditing ? editedItems : purchase.items)?.map((item, index) => (\n                    <div key={index} className=\"px-2 sm:px-3 py-1.5 border-b border-gray-50 hover:bg-gray-50/50 transition-colors\">\n                      {/* Desktop Layout */}\n                      <div className={`hidden sm:grid items-center gap-3`} style={{\n                        gridTemplateColumns: isEditing && columnWidths.length > 0\n                          ? columnWidths.map(width => `${width}px`).join(' ')\n                          : activeTab === 'receipt' \n                            ? 'minmax(120px, 1fr) minmax(200px, 2fr) minmax(70px, auto) minmax(90px, auto) minmax(100px, auto) minmax(80px, 1fr) minmax(80px, auto) minmax(100px, auto) minmax(100px, auto) minmax(120px, auto)'\n                            : 'minmax(120px, 1fr) minmax(200px, 2fr) minmax(70px, auto) minmax(90px, auto) minmax(100px, auto) minmax(80px, 1fr) minmax(80px, auto) minmax(100px, auto) minmax(100px, auto)'\n                      }}>\n                        {/* í’ˆëª©ëª… */}\n                        <div className=\"min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              value={item.item_name}\n                              onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                              className=\"modal-label border-gray-200 rounded-lg w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"í’ˆëª©ëª…\"\n                            />\n                          ) : (\n                            <span className=\"modal-value\">{item.item_name || 'í’ˆëª©ëª… ì—†ìŒ'}</span>\n                          )}\n                        </div>\n                        \n                        {/* ê·œê²© */}\n                        <div className=\"min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              value={item.specification}\n                              onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                              className=\"modal-label border-gray-200 rounded-lg w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"ê·œê²©\"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle\">{item.specification || '-'}</span>\n                          )}\n                        </div>\n                        \n                        {/* ìˆ˜ëŸ‰ */}\n                        <div className=\"text-center min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              type=\"number\"\n                              value={item.quantity}\n                              onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                              className=\"modal-label border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"ìˆ˜ëŸ‰\"\n                              max=\"99999\"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle\">{item.quantity || 0}</span>\n                          )}\n                        </div>\n                        \n                        {/* ë‹¨ê°€ */}\n                        <div className=\"text-right min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              type=\"number\"\n                              value={item.unit_price_value}\n                              onChange={(e) => handleItemChange(index, 'unit_price_value', Number(e.target.value))}\n                              className=\"modal-label border-gray-200 rounded-lg text-right w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"ë‹¨ê°€\"\n                              max=\"100000000000\"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle\">â‚©{formatCurrency(item.unit_price_value)}</span>\n                          )}\n                        </div>\n                        \n                        {/* í•©ê³„ */}\n                        <div className=\"text-right min-w-0\">\n                          {isEditing ? (\n                            <Input\n                              type=\"number\"\n                              value={item.amount_value}\n                              onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                              className=\"modal-label border-gray-200 rounded-lg text-right w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"í•©ê³„\"\n                              max=\"10000000000\"\n                            />\n                          ) : (\n                            <span className=\"modal-value\">â‚©{formatCurrency(item.amount_value || 0)}</span>\n                          )}\n                        </div>\n                        \n                        {/* ë¹„ê³  */}\n                        <div className=\"min-w-0 flex justify-center items-start pt-1 text-center\">\n                          {isEditing ? (\n                            <Input\n                              value={item.remark || ''}\n                              onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                              className=\"modal-label border-gray-200 rounded-lg text-center w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                              placeholder=\"ë¹„ê³ \"\n                            />\n                          ) : (\n                            <span className=\"modal-subtitle text-center\">{item.remark || '-'}</span>\n                          )}\n                        </div>\n                        \n                        {/* ìƒíƒœ/ì•¡ì…˜ */}\n                        <div className=\"text-center flex justify-center items-start pt-1\">\n                          {isEditing ? (\n                            <Button\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              onClick={() => handleRemoveItem(index)}\n                              className=\"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6\"\n                            >\n                              <Trash2 className=\"w-3 h-3\" />\n                            </Button>\n                          ) : (\n                            <>\n                              {/* êµ¬ë§¤ íƒ­ì—ì„œì˜ êµ¬ë§¤ì™„ë£Œ ìƒíƒœ */}\n                              {activeTab === 'purchase' && (\n                                <div className=\"flex justify-center\">\n                                  {canPurchase ? (\n                                    <button\n                                      onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                                      className={`transition-colors ${\n                                        item.is_payment_completed\n                                          ? 'button-toggle-active bg-orange-500 hover:bg-orange-600 text-white'\n                                          : 'button-toggle-inactive'\n                                      }`}\n                                    >\n                                      {item.is_payment_completed ? 'êµ¬ë§¤ì™„ë£Œ' : 'êµ¬ë§¤ëŒ€ê¸°'}\n                                    </button>\n                                  ) : (\n                                    <span className={`${\n                                      item.is_payment_completed \n                                        ? 'button-toggle-active bg-orange-500 text-white' \n                                        : 'button-waiting-inactive'\n                                    }`}>\n                                      {item.is_payment_completed ? 'êµ¬ë§¤ì™„ë£Œ' : 'êµ¬ë§¤ëŒ€ê¸°'}\n                                    </span>\n                                  )}\n                                </div>\n                              )}\n                              \n                              {/* ì…ê³  íƒ­ì—ì„œì˜ ì…ê³ ì™„ë£Œ ìƒíƒœ */}\n                              {activeTab === 'receipt' && (\n                                <div className=\"flex justify-center\">\n                                  {canReceiptCheck ? (\n                                    item.actual_received_date ? (\n                                      <button\n                                        onClick={() => handleReceiptCancel(item.id)}\n                                        className=\"button-action-primary\"\n                                      >\n                                        ì…ê³ ì™„ë£Œ\n                                      </button>\n                                    ) : (\n                                      <DatePickerPopover\n                                        onDateSelect={(date) => handleItemReceiptToggle(item.id, date)}\n                                        placeholder=\"ì‹¤ì œ ì…ê³ ëœ ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”\"\n                                        align=\"center\"\n                                        side=\"bottom\"\n                                      >\n                                        <button className=\"button-toggle-inactive\">\n                                          ì…ê³ ëŒ€ê¸°\n                                        </button>\n                                      </DatePickerPopover>\n                                    )\n                                  ) : (\n                                    <span className={`${\n                                      item.actual_received_date \n                                        ? 'button-action-primary' \n                                        : 'button-waiting-inactive'\n                                    }`}>\n                                      {item.actual_received_date ? 'ì…ê³ ì™„ë£Œ' : 'ì…ê³ ëŒ€ê¸°'}\n                                    </span>\n                                  )}\n                                </div>\n                              )}\n                              \n                              {/* ê¸°íƒ€ íƒ­ì—ì„œëŠ” ê¸°ë³¸ ìƒíƒœ í‘œì‹œ */}\n                              {activeTab !== 'purchase' && activeTab !== 'receipt' && (\n                                <div className=\"flex justify-center\">\n                                  <span className=\"badge-text\">-</span>\n                                </div>\n                              )}\n                            </>\n                          )}\n                        </div>\n                        \n                        {/* ì‹¤ì œ ì…ê³  ë‚ ì§œ - ì…ê³  íƒ­ì—ì„œë§Œ í‘œì‹œ (ìƒíƒœ ì»¬ëŸ¼ ì˜¤ë¥¸ìª½) */}\n                        {activeTab === 'receipt' && (\n                          <div className=\"text-center flex justify-center items-start pt-1 pl-2\">\n                            {item.actual_received_date ? (\n                              <div className=\"modal-subtitle text-green-700\">\n                                {new Date(item.actual_received_date).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                            ) : (\n                              <span className=\"modal-subtitle text-gray-400\">-</span>\n                            )}\n                          </div>\n                        )}\n\n                        {/* ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ */}\n                        <div className=\"text-center flex justify-center items-start pt-1\">\n                          {canReceiptCheck ? (\n                            item.is_statement_received ? (\n                              <span className=\"button-action-primary\">\n                                âœ“ ì™„ë£Œ\n                              </span>\n                            ) : (\n                              <DatePickerPopover\n                                onDateSelect={(date) => handleStatementCheck(item.id, date)}\n                                placeholder=\"íšŒê³„ìƒ ì…ê³ ì¼ì„ ì„ íƒí•˜ì„¸ìš”\"\n                                align=\"center\"\n                                side=\"bottom\"\n                              >\n                                <button className=\"button-toggle-inactive\">\n                                  ëŒ€ê¸°\n                                </button>\n                              </DatePickerPopover>\n                            )\n                          ) : (\n                            <span className={`${\n                              item.is_statement_received \n                                ? 'button-action-primary' \n                                : 'button-waiting-inactive'\n                            }`}>\n                              {item.is_statement_received ? 'âœ“ ì™„ë£Œ' : 'ëŒ€ê¸°'}\n                            </span>\n                          )}\n                        </div>\n\n                        {/* íšŒê³„ìƒ ì…ê³ ì¼ */}\n                        <div className=\"text-center flex justify-center items-start pt-1\">\n                          {item.statement_received_date ? (\n                            <div className=\"text-center\">\n                              <div className=\"modal-subtitle text-blue-700\">\n                                {new Date(item.statement_received_date).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                              {item.statement_received_by_name && (\n                                <div className=\"modal-label text-gray-500 text-[9px] mt-0.5\">\n                                  ({item.statement_received_by_name})\n                                </div>\n                              )}\n                            </div>\n                          ) : (\n                            <span className=\"modal-subtitle text-gray-400\">-</span>\n                          )}\n                        </div>\n                      </div>\n                      \n                      {/* Mobile Layout */}\n                      <div className=\"block sm:hidden space-y-2\">\n                        <div className=\"flex justify-between items-start\">\n                          <div className=\"flex-1 min-w-0\">\n                            {isEditing ? (\n                              <Input\n                                value={item.item_name}\n                                onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                                className=\"modal-label border-gray-200 rounded-lg w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"í’ˆëª©ëª…\"\n                              />\n                            ) : (\n                              <div className=\"modal-value font-medium\">{item.item_name || 'í’ˆëª©ëª… ì—†ìŒ'}</div>\n                            )}\n                            {isEditing ? (\n                              <Input\n                                value={item.specification}\n                                onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"ê·œê²©\"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle text-gray-500\">{item.specification || '-'}</div>\n                            )}\n                          </div>\n                          <div className=\"ml-3 text-right flex-shrink-0\">\n                            {isEditing ? (\n                              <Input\n                                type=\"number\"\n                                value={item.amount_value}\n                                onChange={(e) => handleItemChange(index, 'amount_value', Number(e.target.value))}\n                                className=\"modal-label border-gray-200 rounded-lg text-right w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"í•©ê³„\"\n                              />\n                            ) : (\n                              <div className=\"modal-value font-semibold\">â‚©{formatCurrency(item.amount_value || 0)}</div>\n                            )}\n                          </div>\n                        </div>\n                        \n                        <div className=\"grid grid-cols-3 gap-2 text-sm\">\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">ìˆ˜ëŸ‰:</span>\n                            {isEditing ? (\n                              <Input\n                                type=\"number\"\n                                value={item.quantity}\n                                onChange={(e) => handleItemChange(index, 'quantity', Number(e.target.value))}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"ìˆ˜ëŸ‰\"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle\">{item.quantity || 0}</div>\n                            )}\n                          </div>\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">ë‹¨ê°€:</span>\n                            {isEditing ? (\n                              <Input\n                                type=\"number\"\n                                value={item.unit_price_value}\n                                onChange={(e) => handleItemChange(index, 'unit_price_value', Number(e.target.value))}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"ë‹¨ê°€\"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle\">â‚©{formatCurrency(item.unit_price_value)}</div>\n                            )}\n                          </div>\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">ìƒíƒœ:</span>\n                            <div className=\"mt-1\">\n                              {isEditing ? (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"ghost\"\n                                  onClick={() => handleRemoveItem(index)}\n                                  className=\"text-red-600 hover:bg-red-50 rounded-lg p-1 h-6 w-6\"\n                                >\n                                  <Trash2 className=\"w-3 h-3\" />\n                                </Button>\n                              ) : (\n                                <>\n                                  {activeTab === 'purchase' && (\n                                    <>\n                                      {canPurchase ? (\n                                        <button\n                                          onClick={() => handlePaymentToggle(item.id, !item.is_payment_completed)}\n                                          className={`text-xs px-2 py-1 rounded transition-colors ${\n                                            item.is_payment_completed\n                                              ? 'bg-orange-500 text-white hover:bg-orange-600'\n                                              : 'bg-gray-100 text-gray-600'\n                                          }`}\n                                        >\n                                          {item.is_payment_completed ? 'êµ¬ë§¤ì™„ë£Œ' : 'êµ¬ë§¤ëŒ€ê¸°'}\n                                        </button>\n                                      ) : (\n                                        <span className={`text-xs px-2 py-1 rounded ${\n                                          item.is_payment_completed \n                                            ? 'bg-orange-500 text-white' \n                                            : 'bg-gray-100 text-gray-400'\n                                        }`}>\n                                          {item.is_payment_completed ? 'êµ¬ë§¤ì™„ë£Œ' : 'êµ¬ë§¤ëŒ€ê¸°'}\n                                        </span>\n                                      )}\n                                    </>\n                                  )}\n                                  \n                                  {activeTab === 'receipt' && (\n                                    <>\n                                      {canReceiptCheck ? (\n                                        item.actual_received_date ? (\n                                          <button\n                                            onClick={() => handleReceiptCancel(item.id)}\n                                            className=\"text-xs px-2 py-1 rounded button-action-primary\"\n                                          >\n                                            ì…ê³ ì™„ë£Œ\n                                          </button>\n                                        ) : (\n                                          <DatePickerPopover\n                                            onDateSelect={(date) => handleItemReceiptToggle(item.id, date)}\n                                            placeholder=\"ì‹¤ì œ ì…ê³ ëœ ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”\"\n                                            align=\"center\"\n                                            side=\"bottom\"\n                                          >\n                                            <button className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\">\n                                              ì…ê³ ëŒ€ê¸°\n                                            </button>\n                                          </DatePickerPopover>\n                                        )\n                                      ) : (\n                                        <span className={`text-xs px-2 py-1 rounded ${\n                                          item.actual_received_date \n                                            ? 'button-action-primary' \n                                            : 'bg-gray-100 text-gray-400'\n                                        }`}>\n                                          {item.actual_received_date ? 'ì…ê³ ì™„ë£Œ' : 'ì…ê³ ëŒ€ê¸°'}\n                                        </span>\n                                      )}\n                                    </>\n                                  )}\n                                  \n                                  {activeTab !== 'purchase' && activeTab !== 'receipt' && (\n                                    <span className=\"text-xs text-gray-400\">-</span>\n                                  )}\n                                </>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                        \n                        {(item.remark || isEditing) && (\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">ë¹„ê³ :</span>\n                            {isEditing ? (\n                              <Input\n                                value={item.remark || ''}\n                                onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                                className=\"modal-label border-gray-200 rounded-lg mt-1 w-full h-5 px-1.5 py-0.5 text-[10px] focus:border-blue-400\"\n                                placeholder=\"ë¹„ê³ \"\n                              />\n                            ) : (\n                              <div className=\"modal-subtitle text-gray-500 mt-1\">{item.remark || '-'}</div>\n                            )}\n                          </div>\n                        )}\n                        \n                        {/* ëª¨ë°”ì¼ì—ì„œ ì‹¤ì œ ì…ê³  ë‚ ì§œ í‘œì‹œ */}\n                        {!isEditing && activeTab === 'receipt' && item.actual_received_date && (\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">ì‹¤ì œì…ê³ ì¼:</span>\n                            <div className=\"mt-1\">\n                              <div className=\"modal-subtitle text-green-700\">\n                                {new Date(item.actual_received_date).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                              <div className=\"text-[9px] text-gray-500\">\n                                {new Date(item.actual_received_date).toLocaleTimeString('ko-KR', {\n                                  hour: '2-digit',\n                                  minute: '2-digit'\n                                })}\n                              </div>\n                            </div>\n                          </div>\n                        )}\n\n                        {/* ëª¨ë°”ì¼ì—ì„œ ê±°ë˜ëª…ì„¸ì„œ í™•ì¸ í‘œì‹œ */}\n                        {!isEditing && (\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-gray-500 text-xs\">ê±°ë˜ëª…ì„¸ì„œ í™•ì¸:</span>\n                            <div className=\"flex items-center gap-2\">\n                              {canReceiptCheck ? (\n                                item.is_statement_received ? (\n                                  <span className=\"text-xs px-2 py-1 rounded button-action-primary\">\n                                    âœ“ ì™„ë£Œ\n                                  </span>\n                                ) : (\n                                  <DatePickerPopover\n                                    onDateSelect={(date) => handleStatementCheck(item.id, date)}\n                                    placeholder=\"íšŒê³„ìƒ ì…ê³ ì¼ì„ ì„ íƒí•˜ì„¸ìš”\"\n                                    align=\"end\"\n                                    side=\"bottom\"\n                                  >\n                                    <button className=\"text-xs px-2 py-1 rounded bg-gray-100 text-gray-600\">\n                                      ëŒ€ê¸°\n                                    </button>\n                                  </DatePickerPopover>\n                                )\n                              ) : (\n                                <span className={`text-xs px-2 py-1 rounded ${\n                                  item.is_statement_received \n                                    ? 'button-action-primary' \n                                    : 'bg-gray-100 text-gray-400'\n                                }`}>\n                                  {item.is_statement_received ? 'âœ“ ì™„ë£Œ' : 'ëŒ€ê¸°'}\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                        )}\n\n                        {/* ëª¨ë°”ì¼ì—ì„œ íšŒê³„ìƒ ì…ê³ ì¼ í‘œì‹œ */}\n                        {!isEditing && item.statement_received_date && (\n                          <div>\n                            <span className=\"text-gray-500 text-xs\">íšŒê³„ìƒ ì…ê³ ì¼:</span>\n                            <div className=\"mt-1\">\n                              <div className=\"modal-subtitle text-blue-700\">\n                                {new Date(item.statement_received_date).toLocaleDateString('ko-KR', {\n                                  year: 'numeric',\n                                  month: '2-digit',\n                                  day: '2-digit'\n                                })}\n                              </div>\n                              {item.statement_received_by_name && (\n                                <div className=\"text-[9px] text-gray-500\">\n                                  ì²˜ë¦¬ì: {item.statement_received_by_name}\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                \n                {/* í•©ê³„ */}\n                <div className=\"bg-gray-50 px-2 sm:px-3 border-t border-gray-100\">\n                  <div className=\"hidden sm:grid items-center gap-3 py-0.5\" style={{\n                    gridTemplateColumns: isEditing && columnWidths.length > 0\n                      ? columnWidths.map(width => `${width}px`).join(' ')\n                      : activeTab === 'receipt' \n                        ? 'minmax(120px, 1fr) minmax(200px, 2fr) minmax(70px, auto) minmax(90px, auto) minmax(100px, auto) minmax(80px, 1fr) minmax(80px, auto) minmax(100px, auto)'\n                        : 'minmax(120px, 1fr) minmax(250px, 2fr) minmax(70px, auto) minmax(90px, auto) minmax(100px, auto) minmax(120px, 1fr) minmax(80px, auto)'\n                  }}>\n                    {/* í’ˆëª©ëª… */}\n                    <div></div>\n                    {/* ê·œê²© */}\n                    <div></div>\n                    {/* ìˆ˜ëŸ‰ */}\n                    <div></div>\n                    {/* ë‹¨ê°€ */}\n                    <div className=\"text-right\">\n                      <span className=\"text-[12px] font-bold text-gray-900\">ì´ì•¡</span>\n                    </div>\n                    {/* í•©ê³„ */}\n                    <div className=\"text-right\">\n                      <span className=\"text-[12px] font-bold text-gray-900\">\n                        â‚©{formatCurrency(\n                          (isEditing ? editedItems : purchase.items)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0\n                        )}\n                      </span>\n                    </div>\n                    {/* ë‚˜ë¨¸ì§€ ì¹¼ëŸ¼ë“¤ */}\n                    <div></div>\n                    <div></div>\n                    {activeTab === 'receipt' && <div></div>}\n                  </div>\n                  \n                  {/* Mobile ì´ì•¡ */}\n                  <div className=\"block sm:hidden py-0.5\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-[13px] font-bold text-gray-900\">ì´ì•¡</span>\n                      <span className=\"text-[13px] font-bold text-gray-900\">\n                        â‚©{formatCurrency(\n                          (isEditing ? editedItems : purchase.items)?.reduce((sum, item) => sum + (item.amount_value || 0), 0) || 0\n                        )}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n                \n                {/* í•­ëª© ì¶”ê°€ ë²„íŠ¼ */}\n                {isEditing && (\n                  <div className=\"p-2 sm:p-3 border-t border-gray-100\">\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={handleAddItem}\n                      className=\"w-full rounded-lg border-dashed border-2 border-gray-300 hover:border-gray-400 py-2 badge-text\"\n                    >\n                      <Plus className=\"w-4 h-4 mr-1\" />\n                      í•­ëª© ì¶”ê°€\n                    </Button>\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      ) : (\n        <div className=\"text-center py-12\">\n          <span className=\"modal-subtitle\">\n            ë°œì£¼ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n          </span>\n        </div>\n      )}\n    </div>\n  )\n\n  // embeddedê°€ trueë©´ Dialog ì—†ì´ ë‚´ìš©ë§Œ ë°˜í™˜\n  if (embedded) {\n    return content\n  }\n\n  // embeddedê°€ falseë©´ Dialogë¡œ ê°ì‹¸ì„œ ë°˜í™˜\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent \n        className=\"overflow-hidden bg-white rounded-lg shadow-sm border-0 w-[100vw] h-[100vh] sm:w-auto sm:min-w-[1000px] sm:max-w-none sm:max-h-[90vh] lg:max-h-[85vh] sm:rounded-lg flex flex-col\" \n        showCloseButton={false}\n      >\n        {/* Apple-style Header */}\n        <div className=\"relative px-3 sm:px-6 pt-0 sm:pt-3 lg:pt-4 pb-0 sm:pb-2 lg:pb-3 flex-shrink-0\">\n          <button\n            onClick={onClose}\n            className=\"button-base button-action-secondary absolute right-3 sm:right-6 top-0 sm:top-3 lg:top-4 w-6 h-6 sm:w-8 sm:h-8 rounded-full\"\n          >\n            <X className=\"w-4 h-4 text-gray-500\" />\n          </button>\n          \n          <div className=\"pr-8 sm:pr-16\">\n            <div className=\"flex items-start gap-4 mb-0 sm:mb-3\">\n              <div className=\"min-w-0 flex-1\">\n                <h1 className=\"page-title mb-0 sm:mb-1\">\n                  ë°œì£¼ ê¸°ë³¸ì •ë³´\n                </h1>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                {!isEditing && canEdit && (\n                  <>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => handleEditToggle(true)}\n                      className=\"button-base button-action-secondary\"\n                    >\n                      <Edit2 className=\"w-4 h-4 mr-2\" />\n                      ìˆ˜ì •\n                    </Button>\n                    {canDelete && onDelete && (\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => purchase && onDelete(purchase)}\n                        className=\"button-base button-action-danger\"\n                      >\n                        <Trash2 className=\"w-4 h-4 mr-2\" />\n                        ì‚­ì œ\n                      </Button>\n                    )}\n                  </>\n                )}\n                {isEditing && (\n                  <>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => {\n                        handleEditToggle(false)\n                        setEditedPurchase(purchase)\n                        setEditedItems(purchase?.items || [])\n                        setDeletedItemIds([])\n                      }}\n                      className=\"button-base button-action-secondary\"\n                    >\n                      <X className=\"w-4 h-4 mr-2\" />\n                      ì·¨ì†Œ\n                    </Button>\n                    <Button\n                      size=\"sm\"\n                      onClick={handleSave}\n                      className=\"button-base button-action-primary\"\n                    >\n                      <Save className=\"w-4 h-4 mr-2\" />\n                      ì €ì¥\n                    </Button>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Apple-style Content */}\n        <div className=\"overflow-y-auto flex-1 px-3 sm:px-6 pb-1 sm:pb-6 mt-0\">\n          {content}\n        </div>\n      </DialogContent>\n      \n    </Dialog>\n  )\n}"],"names":["Truck","createLucideIcon","d","key","cx","cy","r","DatePicker","date","onDateChange","placeholder","className","disabled","Popover","children","jsx","PopoverTrigger","asChild","jsxs","Button","variant","cn","CalendarIcon","format","locale","ko","PopoverContent","Calendar","mode","selected","onSelect","initialFocus","PurchaseDetailModal","purchaseId","isOpen","onClose","embedded","currentUserRoles","activeTab","onRefresh","onDelete","loading","setLoading","useState","purchase","setPurchase","isEditing","setIsEditing","editedPurchase","setEditedPurchase","editedItems","setEditedItems","deletedItemIds","setDeletedItemIds","userRoles","setUserRoles","currentUserName","setCurrentUserName","columnWidths","setColumnWidths","headerRowRef","useRef","supabase","createClient","useEffect","async","data","user","auth","getUser","employeeData","from","select","eq","id","maybeSingle","email","employeeByEmail","name","purchase_role","roles","Array","isArray","map","String","trim","split","filter","length","error","loadUserRoles","effectiveRoles","canEdit","includes","canDelete","final_manager_status","requester_name","canPurchase","canReceiveItems","isAdmin","isRequester","canReceiptCheck","logger","debug","requesterName","canApproveMiddle","canApproveFinal","approvalButtonClass","approvalWaitingPillClass","middleManagerStatus","middle_manager_status","finalManagerStatus","loadPurchaseDetail","toString","measureColumnWidths","current","cells","widths","cell","getBoundingClientRect","width","items","setTimeout","handleEditToggle","editing","single","purchaseData","purchase_request_items","vendor","vendors","vendor_name","vendor_contacts","toast","formatCurrency","amount","Intl","NumberFormat","handleItemChange","index","field","value","newItems","amount_value","quantity","unitPrice","unit_price_value","handleRemoveItem","item","_","i","handlePaymentToggle","itemId","isCompleted","itemIdStr","numericId","Number","isNaN","targetItem","find","itemInfo","item_name","specification","toLocaleString","unit","confirmMessage","window","confirm","update","is_payment_completed","payment_completed_at","Date","toISOString","prev","updatedItems","success","handleItemReceiptToggle","selectedDate","is_received","received_at","actual_received_date","handleReceiptCancel","handleStatementCheck","is_statement_received","statement_received_date","statement_received_by_name","handleApprove","type","approvalType","purchase_order_number","updateData","content","payment_category","category","Badge","getStatusBadge","formatDate","request_date","size","onClick","Check","X","FileText","Input","request_type","onChange","e","target","delivery_request_date","revised_delivery_request_date","Building2","contact_name","updatedContacts","project_vendor","project_item","order_number","Package","Fragment","CreditCard","DatePickerPopover","onDateSelect","is","align","side","ref","style","gridTemplateColumns","join","max","remark","Trash2","toLocaleDateString","year","month","day","toLocaleTimeString","hour","minute","reduce","sum","newItem","line_number","Plus","Dialog","open","onOpenChange","DialogContent","showCloseButton","Edit2","editedItemsCount","deletedItemsCount","totalAmount","updateError","total_amount","updated_at","deleteError","delete","in","count","itemName","Error","unit_price_currency","currency","amount_currency","insertData","purchase_request_id","indexOf","created_at","insert","errorMessage","message","Save"],"mappings":"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","x_google_ignoreList":[0]}