import{r as e,j as s}from"./ui-components-CWOoty1N.js";import{c as a,a as t,t as r,B as i,C as c,U as l,b as n,d}from"./index-BoCLkSMB.js";import{c as m,u as x}from"./react-vendor-DlOlWAvO.js";import{C as o}from"./credit-card-C8FmGSFH.js";import"./excel-libs-CEylypxp.js";import"./supabase-BBTAdlcZ.js";import"./date-utils-DDl0vnal.js";
/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h=a("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);function p(){const{id:a}=m(),p=x(),[g,j]=e.useState(!0),[u,N]=e.useState(null);e.useEffect(()=>{a&&y(a)},[a]);const y=async e=>{try{const s=t(),{data:a,error:r}=await s.from("purchase_requests").select("*,vendors(id,vendor_name),purchase_request_items(*)").eq("id",e).single();if(r)throw r;a&&N({...a,items:a.purchase_request_items||[],vendor:a.vendors||{id:0,vendor_name:"알 수 없음"},vendor_contacts:[]})}catch(s){r.error("발주 상세 정보를 불러오는데 실패했습니다.")}finally{j(!1)}},b=e=>{switch(e){case"approved":return s.jsx(d,{variant:null,className:"badge-success",children:"승인"});case"rejected":return s.jsx(d,{variant:null,className:"badge-danger",children:"반려"});case"pending":return s.jsx(d,{variant:null,className:"badge-warning",children:"대기"});default:return s.jsx(d,{variant:null,className:"badge-secondary",children:"-"})}};return g?s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):u?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>p("/purchase/list"),children:[s.jsx(h,{className:"w-4 h-4 mr-2"}),"목록으로"]}),s.jsxs("h1",{className:"text-2xl font-semibold text-gray-900",children:["발주 상세 - ",u.order_number]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"1차 승인"}),b(u.middle_manager_status)]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"최종 승인"}),b(u.final_manager_status)]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 처리"}),b(u.purchase_status||"pending")]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"납품 상태"}),(e=>{switch(e){case"completed":return s.jsx(d,{variant:null,className:"badge-success",children:"납품완료"});case"partial":return s.jsx(d,{variant:null,className:"badge-warning",children:"부분납품"});case"pending":return s.jsx(d,{variant:null,className:"badge-secondary",children:"납품대기"});default:return s.jsx(d,{variant:null,className:"badge-secondary",children:"-"})}})(u.delivery_status||"pending")]})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"기본 정보"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[s.jsx(c,{className:"w-4 h-4 mr-2"}),"요청일"]}),s.jsx("p",{className:"font-medium",children:u.created_at?new Date(u.created_at).toLocaleDateString("ko-KR"):"-"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[s.jsx(l,{className:"w-4 h-4 mr-2"}),"요청자"]}),s.jsx("p",{className:"font-medium",children:u.requester_name||"-"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[s.jsx(n,{className:"w-4 h-4 mr-2"}),"업체명"]}),s.jsx("p",{className:"font-medium",children:u.vendor?.vendor_name||"-"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[s.jsx(o,{className:"w-4 h-4 mr-2"}),"총 금액"]}),s.jsxs("p",{className:"font-medium",children:[u.total_amount?.toLocaleString("ko-KR"),"원"]})]})]}),u.purpose&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"구매 목적"}),s.jsx("p",{className:"text-gray-900",children:u.purpose})]})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"구매 품목"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"품목명"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"수량"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"단가"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"금액"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(u.items||[]).map((e,a)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.item_name}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.quantity," ",e.unit||"개"]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.unit_price?.toLocaleString("ko-KR"),"원"]}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((e.quantity||0)*(e.unit_price||0)).toLocaleString("ko-KR"),"원"]})]},a))})]})})]}),(u.middle_manager_comment||u.final_manager_comment||u.purchase_comment)&&s.jsxs("div",{className:"bg-white rounded-lg border p-6 space-y-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"처리 내역"}),u.middle_manager_comment&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"1차 승인자 코멘트"}),s.jsx("p",{className:"text-gray-900",children:u.middle_manager_comment})]}),u.final_manager_comment&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"최종 승인자 코멘트"}),s.jsx("p",{className:"text-gray-900",children:u.final_manager_comment})]}),u.purchase_comment&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"구매담당자 코멘트"}),s.jsx("p",{className:"text-gray-900",children:u.purchase_comment})]})]})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주 정보를 찾을 수 없습니다"}),s.jsxs(i,{onClick:()=>p("/purchase/list"),className:"mt-4",children:[s.jsx(h,{className:"w-4 h-4 mr-2"}),"목록으로 돌아가기"]})]})}export{p as default};
//# sourceMappingURL=PurchaseDetailMain-7IvfRBll.js.map
