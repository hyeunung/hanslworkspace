{"version":3,"file":"PurchaseItemsModal-BnBYoxQT.js","sources":["../../node_modules/lucide-react/dist/esm/icons/file-x.js","../../src/components/purchase/ReceiptDownloadButton.tsx","../../src/components/purchase/PurchaseItemsModal.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z\", key: \"1rqfz7\" }],\n  [\"path\", { d: \"M14 2v4a2 2 0 0 0 2 2h4\", key: \"tnqrlb\" }],\n  [\"path\", { d: \"m14.5 12.5-5 5\", key: \"b62r18\" }],\n  [\"path\", { d: \"m9.5 12.5 5 5\", key: \"1rk7el\" }]\n];\nconst FileX = createLucideIcon(\"file-x\", __iconNode);\n\nexport { __iconNode, FileX as default };\n//# sourceMappingURL=file-x.js.map\n","import React from 'react';\nimport { Download, Eye, FileX } from 'lucide-react';\nimport { createClient } from '@/lib/supabase/client';\n\ninterface ReceiptDownloadButtonProps {\n  itemId: number;\n  receiptUrl?: string | null;\n  itemName: string;\n  paymentCategory?: string | null; // ÌòÑÏû•Í≤∞Ï†ú Ïó¨Î∂Ä ÌôïÏù∏Ïö©\n  onUpdate?: () => void;\n}\n\n/**\n * ÏõπÏï±Ïö© ÏòÅÏàòÏ¶ù Îã§Ïö¥Î°úÎìú Î≤ÑÌäº\n * Íµ¨Îß§ Îã¥ÎãπÏûêÍ∞Ä Î™®Î∞îÏùº Ïï±ÏóêÏÑú ÏóÖÎ°úÎìúÌïú ÏòÅÏàòÏ¶ùÏùÑ ÌôïÏù∏/Îã§Ïö¥Î°úÎìúÌï† Ïàò ÏûàÏäµÎãàÎã§\n */\nexport const ReceiptDownloadButton: React.FC<ReceiptDownloadButtonProps> = ({\n  itemId,\n  receiptUrl,\n  itemName,\n  paymentCategory,\n  onUpdate,\n}) => {\n  const [isLoading, setIsLoading] = React.useState(false);\n\n  // ÌòÑÏû•Í≤∞Ï†úÍ∞Ä ÏïÑÎãàÎ©¥ ÌëúÏãú ÏïàÌï®\n  if (paymentCategory !== 'ÌòÑÏû• Í≤∞Ï†ú' && paymentCategory !== 'ÌòÑÏû•Í≤∞Ï†ú') {\n    return null;\n  }\n\n  /**\n   * ÏòÅÏàòÏ¶ù Îã§Ïö¥Î°úÎìú Ìï∏Îì§Îü¨\n   */\n  const handleDownload = async () => {\n    if (!receiptUrl) return;\n\n    setIsLoading(true);\n\n    try {\n      // URLÏóêÏÑú ÌååÏùº Í≤ΩÎ°ú Ï∂îÏ∂ú\n      const url = new URL(receiptUrl);\n      const pathSegments = url.pathname.split('/');\n      const bucketIndex = pathSegments.indexOf('receipt-images');\n      \n      if (bucketIndex === -1) {\n        throw new Error('ÏûòÎ™ªÎêú ÏòÅÏàòÏ¶ù URLÏûÖÎãàÎã§');\n      }\n      \n      const filePath = pathSegments.slice(bucketIndex + 1).join('/');\n\n\n      // Supabase StorageÏóêÏÑú Îã§Ïö¥Î°úÎìú\n      const supabase = createClient();\n      const { data, error } = await supabase.storage\n        .from('receipt-images')\n        .download(filePath);\n\n      if (error) throw error;\n\n      // BlobÏùÑ Îã§Ïö¥Î°úÎìú Í∞ÄÎä•Ìïú URLÎ°ú Î≥ÄÌôò\n      const blob = new Blob([data], { type: 'image/jpeg' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n\n      // Îã§Ïö¥Î°úÎìú Ìä∏Î¶¨Í±∞\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `ÏòÅÏàòÏ¶ù_${itemName}_${itemId}_${Date.now()}.jpg`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n\n      // Î©îÎ™®Î¶¨ Ìï¥Ï†ú\n      window.URL.revokeObjectURL(downloadUrl);\n\n      \n      // ÏÑ±Í≥µ Î©îÏãúÏßÄ (ÏÑ†ÌÉùÏ†Å)\n      if (typeof window !== 'undefined' && typeof window.alert === 'function') {\n        alert('‚úÖ ÏòÅÏàòÏ¶ùÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§.');\n      }\n    } catch (error) {\n      alert(`‚ùå Îã§Ïö¥Î°úÎìú Ïã§Ìå®: ${error instanceof Error ? error.message : error}`);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  /**\n   * ÏòÅÏàòÏ¶ù ÏÉà ÌÉ≠ÏóêÏÑú Î≥¥Í∏∞\n   */\n  const handleViewInNewTab = () => {\n    if (!receiptUrl) return;\n    window.open(receiptUrl, '_blank', 'noopener,noreferrer');\n  };\n\n  /**\n   * ÏòÅÏàòÏ¶ù ÎØ∏Î¶¨Î≥¥Í∏∞ Î™®Îã¨\n   */\n  const handlePreview = () => {\n    if (!receiptUrl) return;\n\n    // Í∞ÑÎã®Ìïú Î™®Îã¨Î°ú Ïù¥ÎØ∏ÏßÄ ÌëúÏãú\n    const modal = document.createElement('div');\n    modal.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.9);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 9999;\n      cursor: pointer;\n    `;\n\n    const img = document.createElement('img');\n    img.src = receiptUrl;\n    img.style.cssText = `\n      max-width: 90%;\n      max-height: 90%;\n      object-fit: contain;\n      border-radius: 8px;\n    `;\n\n    modal.appendChild(img);\n    modal.onclick = () => document.body.removeChild(modal);\n    document.body.appendChild(modal);\n  };\n\n  // ÏòÅÏàòÏ¶ùÏù¥ ÏóÜÎäî Í≤ΩÏö∞\n  if (!receiptUrl) {\n    return (\n      <div className=\"flex items-center gap-2 text-gray-400\">\n        <FileX className=\"w-4 h-4\" />\n        <span className=\"text-sm\">ÏòÅÏàòÏ¶ù ÏóÜÏùå</span>\n      </div>\n    );\n  }\n\n  // ÏòÅÏàòÏ¶ùÏù¥ ÏûàÎäî Í≤ΩÏö∞\n  return (\n    <div className=\"flex items-center gap-2\">\n      {/* ÎØ∏Î¶¨Î≥¥Í∏∞ Î≤ÑÌäº */}\n      <button\n        onClick={handlePreview}\n        className=\"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-semibold text-white bg-blue-500 hover:bg-blue-600 rounded-md transition-colors\"\n        title=\"ÏòÅÏàòÏ¶ù ÎØ∏Î¶¨Î≥¥Í∏∞\"\n      >\n        <Eye className=\"w-4 h-4\" />\n        <span>Î≥¥Í∏∞</span>\n      </button>\n\n      {/* Îã§Ïö¥Î°úÎìú Î≤ÑÌäº */}\n      <button\n        onClick={handleDownload}\n        disabled={isLoading}\n        className=\"inline-flex items-center gap-1.5 px-3 py-1.5 text-sm font-semibold text-white bg-green-500 hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed rounded-md transition-colors\"\n        title=\"ÏòÅÏàòÏ¶ù Îã§Ïö¥Î°úÎìú\"\n      >\n        <Download className=\"w-4 h-4\" />\n        <span>{isLoading ? 'Îã§Ïö¥Î°úÎìú Ï§ë...' : 'Îã§Ïö¥Î°úÎìú'}</span>\n      </button>\n    </div>\n  );\n};\n\n/**\n * ÏÇ¨Ïö© ÏòàÏãú (Î∞úÏ£º ÏÉÅÏÑ∏ Î™®Îã¨ - ÌòÑÏû•Í≤∞Ï†úÎßå):\n * \n * import { ReceiptDownloadButton } from '@/components/purchase/ReceiptDownloadButton';\n * \n * // ÌòÑÏû•Í≤∞Ï†úÏù∏ Í≤ΩÏö∞ÏóêÎßå ÌÖåÏù¥Î∏î Ïª¨Îüº Ï∂îÍ∞Ä:\n * {purchase.payment_category === 'ÌòÑÏû• Í≤∞Ï†ú' && <TableHead>ÏòÅÏàòÏ¶ù</TableHead>}\n * \n * {purchase.payment_category === 'ÌòÑÏû• Í≤∞Ï†ú' && (\n *   <TableCell>\n *     <ReceiptDownloadButton\n *       itemId={item.id}\n *       receiptUrl={item.receipt_image_url}\n *       itemName={item.item_name}\n *       paymentCategory={purchase.payment_category}\n *       onUpdate={() => refetch()}\n *     />\n *   </TableCell>\n * )}\n */\n\n","\nimport { useState } from \"react\";\nimport { X, Edit2, Save, Plus, Trash2 } from \"lucide-react\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { format } from \"date-fns\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { toast } from \"sonner\";\nimport { ReceiptDownloadButton } from \"./ReceiptDownloadButton\";\nimport { DatePickerPopover } from \"@/components/ui/date-picker-popover\";\nimport { useEffect } from \"react\";\n\ninterface PurchaseItem {\n  id?: number | string;\n  line_number?: number;\n  item_name: string;\n  specification?: string;\n  quantity: number;\n  unit_price_value?: number;\n  amount_value?: number;\n  remark?: string;\n  link?: string;\n  is_received?: boolean;\n  delivery_status?: string;\n  receipt_image_url?: string | null;\n  receipt_uploaded_at?: string | null;\n  receipt_uploaded_by?: string | null;\n  // Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Í¥ÄÎ†® ÌïÑÎìú\n  is_statement_received?: boolean;\n  statement_received_date?: string | null;\n  statement_received_by_name?: string | null;\n}\n\ninterface PurchaseItemsModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  purchase: {\n    id: number;\n    purchase_order_number?: string;\n    vendor_name: string;\n    requester_name: string;\n    project_vendor: string;\n    sales_order_number: string;\n    project_item: string;\n    request_date: string;\n    delivery_request_date?: string;\n    currency: string;\n    payment_category?: string;\n    items?: PurchaseItem[];\n    total_amount: number;\n  };\n  isAdmin: boolean;\n  onUpdate: () => void;\n  activeTab?: string; // ÌôúÏÑ± ÌÉ≠ Ï†ïÎ≥¥ Ï∂îÍ∞Ä\n}\n\nexport default function PurchaseItemsModal({ isOpen, onClose, purchase, isAdmin, onUpdate, activeTab = 'done' }: PurchaseItemsModalProps) {\n  const [editingItems, setEditingItems] = useState<PurchaseItem[]>(purchase.items || []);\n  const [isEditing, setIsEditing] = useState(false);\n  const [currentUserName, setCurrentUserName] = useState<string>('');\n  const supabase = createClient();\n  \n  // ÏÇ¨Ïö©Ïûê Ï†ïÎ≥¥ Î∞è ÏµúÏã† Îç∞Ïù¥ÌÑ∞ Î°úÎìú\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        const { data: { user } } = await supabase.auth.getUser();\n        if (user?.email) {\n          const { data: employeeData } = await supabase\n            .from('employees')\n            .select('name')\n            .eq('email', user.email)\n            .single();\n          \n          if (employeeData?.name) {\n            setCurrentUserName(employeeData.name);\n          } else {\n            setCurrentUserName(user.email);\n          }\n        }\n\n        // ÏµúÏã† Íµ¨Îß§ ÏöîÏ≤≠ ÏïÑÏù¥ÌÖú Îç∞Ïù¥ÌÑ∞ Î°úÎìú (Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ ÌïÑÎìú Ìè¨Ìï®)\n        if (purchase.id) {\n          const { data: freshItems } = await supabase\n            .from('purchase_request_items')\n            .select('*')\n            .eq('purchase_request_id', purchase.id)\n            .order('line_number');\n          \n          if (freshItems) {\n            setEditingItems(freshItems);\n          }\n        }\n      } catch (error) {\n        console.error('Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);\n        setCurrentUserName('ÏÇ¨Ïö©Ïûê');\n      }\n    };\n\n    if (isOpen) {\n      loadData();\n    }\n  }, [isOpen, supabase, purchase.id]);\n  \n  // Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï≤òÎ¶¨ Ìï®Ïàò\n  const handleStatementCheck = async (itemId: number | string, selectedDate: Date) => {\n    // DatePickerPopoverÏóêÏÑú Ïù¥ÎØ∏ ÌôïÏù∏ÌñàÏúºÎØÄÎ°ú Ïó¨Í∏∞ÏÑúÎäî ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏ Ï†úÍ±∞\n\n    const itemIdStr = String(itemId);\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId);\n\n    if (Number.isNaN(numericId)) {\n      toast.error('Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Ìï≠Î™© ID ÏûÖÎãàÎã§.');\n      return;\n    }\n\n    try {\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_statement_received: true,\n          statement_received_date: selectedDate.toISOString(),\n          statement_received_by_name: currentUserName\n        })\n        .eq('id', numericId);\n\n      if (error) throw error;\n\n      console.log('‚úÖ DB ÏóÖÎç∞Ïù¥Ìä∏ ÏÑ±Í≥µ (PurchaseItemsModal)')\n\n      // ÏµúÏã† Îç∞Ïù¥ÌÑ∞ Îã§Ïãú Î°úÎìú\n      console.log('üì• ÏµúÏã† Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÏûë (PurchaseItemsModal)')\n      const { data: freshItems } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_request_id', purchase.id)\n        .order('line_number');\n      \n      if (freshItems) {\n        console.log('üì• ÏµúÏã† Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏÑ±Í≥µ (PurchaseItemsModal):', freshItems.length)\n        setEditingItems(freshItems);\n      }\n\n      // ÌôîÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏Î•º ÏúÑÌï¥ onUpdate Ìò∏Ï∂ú\n      console.log('üîÑ Î∂ÄÎ™® Ïª¥Ìè¨ÎÑåÌä∏ ÏÉàÎ°úÍ≥†Ïπ® Ìò∏Ï∂ú (PurchaseItemsModal)')\n      onUpdate();\n      \n      toast.success('Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏Ïù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.');\n    } catch (error) {\n      toast.error('Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');\n    }\n  };\n\n  // Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï∑®ÏÜå Ï≤òÎ¶¨ Ìï®Ïàò\n  const handleStatementCancel = async (itemId: number | string) => {\n    const itemIdStr = String(itemId);\n    const numericId = typeof itemId === 'number' ? itemId : Number(itemId);\n\n    if (Number.isNaN(numericId)) {\n      toast.error('Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Ìï≠Î™© ID ÏûÖÎãàÎã§.');\n      return;\n    }\n\n    // Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú Ïù¥ÎØ∏ ÌôïÏù∏ÌñàÏúºÎØÄÎ°ú Ïó¨Í∏∞ÏÑúÎäî ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏ Ï†úÍ±∞\n\n    try {\n      const targetItem = editingItems.find(item => String(item.id) === itemIdStr);\n      console.log('üîÑ Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï∑®ÏÜå ÏãúÏûë (PurchaseItemsModal):', { itemId, itemName: targetItem?.item_name });\n\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .update({\n          is_statement_received: false,\n          statement_received_date: null,\n          statement_received_by_name: null\n        })\n        .eq('id', numericId);\n\n      if (error) throw error;\n\n      console.log('‚úÖ Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï∑®ÏÜå ÏÑ±Í≥µ (PurchaseItemsModal)');\n\n      // ÏµúÏã† Îç∞Ïù¥ÌÑ∞ Îã§Ïãú Î°úÎìú\n      console.log('üì• ÏµúÏã† Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÏûë (Ï∑®ÏÜå, PurchaseItemsModal)');\n      const { data: freshItems } = await supabase\n        .from('purchase_request_items')\n        .select('*')\n        .eq('purchase_request_id', purchase.id)\n        .order('line_number');\n      \n      if (freshItems) {\n        console.log('üì• ÏµúÏã† Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏÑ±Í≥µ (Ï∑®ÏÜå, PurchaseItemsModal):', freshItems.length);\n        setEditingItems(freshItems);\n      }\n\n      // ÌôîÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏Î•º ÏúÑÌï¥ onUpdate Ìò∏Ï∂ú\n      console.log('üîÑ Î∂ÄÎ™® Ïª¥Ìè¨ÎÑåÌä∏ ÏÉàÎ°úÍ≥†Ïπ® Ìò∏Ï∂ú (Ï∑®ÏÜå, PurchaseItemsModal)');\n      onUpdate();\n      \n      toast.success('Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏Ïù¥ Ï∑®ÏÜåÎêòÏóàÏäµÎãàÎã§.');\n    } catch (error) {\n      console.error('‚ùå Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï∑®ÏÜå Ïã§Ìå® (PurchaseItemsModal):', error);\n      toast.error('Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï∑®ÏÜå Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');\n    }\n  };\n  \n  // ÌíàÎ™© ÏàòÏ†ï ÏãúÏûë\n  const handleEditStart = () => {\n    setIsEditing(true);\n    setEditingItems([...purchase.items || []]);\n  };\n\n  // ÌíàÎ™© ÏàòÏ†ï Ï∑®ÏÜå\n  const handleEditCancel = () => {\n    setIsEditing(false);\n    setEditingItems(purchase.items || []);\n  };\n\n  // ÌíàÎ™© Í∞í Î≥ÄÍ≤Ω\n  const handleItemChange = (index: number, field: keyof PurchaseItem, value: any) => {\n    const newItems = [...editingItems];\n    newItems[index] = {\n      ...newItems[index],\n      [field]: field === 'quantity' || field === 'unit_price_value' || field === 'amount_value' ? Number(value) : value\n    };\n    \n    // Í∏àÏï° ÏûêÎèô Í≥ÑÏÇ∞ (amount_valueÎ•º ÏßÅÏ†ë ÏàòÏ†ïÌïòÎäî Í≤ΩÏö∞Í∞Ä ÏïÑÎãê ÎïåÎßå)\n    if (field === 'quantity' || field === 'unit_price_value') {\n      newItems[index].amount_value = newItems[index].quantity * (newItems[index].unit_price_value || 0);\n    }\n    \n    setEditingItems(newItems);\n  };\n\n  // ÏÉà ÌíàÎ™© Ï∂îÍ∞Ä\n  const handleAddItem = () => {\n    const newItem: PurchaseItem = {\n      line_number: editingItems.length + 1,\n      item_name: '',\n      specification: '',\n      quantity: 0,\n      unit_price_value: 0,\n      amount_value: 0,\n      remark: '',\n      is_received: false\n    };\n    setEditingItems([...editingItems, newItem]);\n  };\n\n  // ÌíàÎ™© ÏÇ≠Ï†ú\n  const handleDeleteItem = (index: number) => {\n    const newItems = editingItems.filter((_, i) => i !== index);\n    // line_number Ïû¨Ï†ïÎ†¨\n    newItems.forEach((item, i) => {\n      item.line_number = i + 1;\n    });\n    setEditingItems(newItems);\n  };\n\n  // ÌíàÎ™© Ï†ÄÏû•\n  const handleSave = async () => {\n    try {\n      // Í∏∞Ï°¥ ÌíàÎ™© ÏÇ≠Ï†ú\n      await supabase\n        .from('purchase_request_items')\n        .delete()\n        .eq('purchase_request_id', purchase.id);\n\n      // ÏÉà ÌíàÎ™© Ï∂îÍ∞Ä\n      const itemsToInsert = editingItems.map(item => ({\n        purchase_request_id: purchase.id,\n        purchase_order_number: purchase.purchase_order_number,\n        line_number: item.line_number,\n        item_name: item.item_name,\n        specification: item.specification,\n        quantity: item.quantity,\n        unit_price_value: item.unit_price_value,\n        amount_value: item.amount_value,\n        remark: item.remark,\n        link: item.link,\n        is_received: item.is_received || false,\n        delivery_status: item.delivery_status || 'pending'\n      }));\n\n      const { error } = await supabase\n        .from('purchase_request_items')\n        .insert(itemsToInsert);\n\n      if (error) throw error;\n\n      // Ï¥ùÍ∏àÏï° ÏóÖÎç∞Ïù¥Ìä∏\n      const totalAmount = editingItems.reduce((sum, item) => sum + (item.amount_value || 0), 0);\n      await supabase\n        .from('purchase_requests')\n        .update({ total_amount: totalAmount })\n        .eq('id', purchase.id);\n\n      toast.success('ÌíàÎ™©Ïù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.');\n      setIsEditing(false);\n      onUpdate();\n      onClose();\n    } catch (error) {\n      toast.error('Ï†ÄÏû• Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');\n    }\n  };\n  \n  const items = isEditing ? editingItems : editingItems;\n  const totalAmount = items.reduce((sum, item) => sum + (item.amount_value || 0), 0);\n  \n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"w-full max-w-[95vw] sm:max-w-6xl max-h-[80vh] overflow-hidden flex flex-col bg-white\">\n        <DialogHeader className=\"flex-shrink-0\">\n          <div className=\"flex items-center justify-between\">\n            <DialogTitle className=\"modal-title\">\n              Î∞úÏ£º ÏÉÅÏÑ∏ Ìï≠Î™© - {purchase.purchase_order_number}\n            </DialogTitle>\n            <div className=\"flex items-center gap-2\">\n              {isAdmin && !isEditing && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={handleEditStart}\n                >\n                  <Edit2 className=\"h-4 w-4 mr-1\" />\n                  Ìé∏Ïßë\n                </Button>\n              )}\n              {isEditing && (\n                <>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={handleAddItem}\n                  >\n                    <Plus className=\"h-4 w-4 mr-1\" />\n                    ÌíàÎ™© Ï∂îÍ∞Ä\n                  </Button>\n                  <Button\n                    variant=\"default\"\n                    size=\"sm\"\n                    onClick={handleSave}\n                  >\n                    <Save className=\"h-4 w-4 mr-1\" />\n                    Ï†ÄÏû•\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={handleEditCancel}\n                  >\n                    Ï∑®ÏÜå\n                  </Button>\n                </>\n              )}\n              <Button\n                variant=\"ghost\"\n                size=\"icon\"\n                onClick={onClose}\n                className=\"h-6 w-6\"\n              >\n                <X className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </div>\n        </DialogHeader>\n        \n        <div className=\"flex-shrink-0 grid grid-cols-2 md:grid-cols-4 gap-3 py-3 border-b\">\n          <div>\n            <p className=\"modal-label\">ÏóÖÏ≤¥Î™Ö</p>\n            <p className=\"modal-value\">{purchase.vendor_name}</p>\n          </div>\n          <div>\n            <p className=\"modal-label\">ÏöîÏ≤≠Ïûê</p>\n            <p className=\"modal-value\">{purchase.requester_name}</p>\n          </div>\n          <div>\n            <p className=\"modal-label\">ÌîÑÎ°úÏ†ùÌä∏</p>\n            <p className=\"modal-value truncate\" title={purchase.project_vendor}>\n              {purchase.project_vendor}\n            </p>\n          </div>\n          <div>\n            <p className=\"modal-label\">ÎÇ©Í∏∞Ïùº</p>\n            <p className=\"modal-value\">\n              {purchase.delivery_request_date && \n                format(new Date(purchase.delivery_request_date), 'yyyy-MM-dd')}\n            </p>\n          </div>\n        </div>\n        \n        <div className=\"flex-1 overflow-auto\">\n          <Table>\n            <TableHeader className=\"sticky top-0 bg-white z-10\">\n              <TableRow>\n                <TableHead className=\"w-12\">No.</TableHead>\n                <TableHead>ÌíàÎ™©</TableHead>\n                <TableHead>Í∑úÍ≤©</TableHead>\n                <TableHead className=\"text-right\">ÏàòÎüâ</TableHead>\n                <TableHead className=\"text-right\">Îã®Í∞Ä</TableHead>\n                <TableHead className=\"text-right\">Í∏àÏï°</TableHead>\n                <TableHead>\n                  {activeTab === 'purchase' ? 'Íµ¨Îß§ÏÉÅÌÉú' : activeTab === 'receipt' ? 'ÏûÖÍ≥†ÏÉÅÌÉú' : 'ÏûÖÍ≥†ÏÉÅÌÉú'}\n                </TableHead>\n                <TableHead>ÏòÅÏàòÏ¶ù</TableHead>\n                {activeTab === 'done' && (\n                  <>\n                    <TableHead className=\"text-center\">Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏</TableHead>\n                    <TableHead className=\"text-center\">ÌöåÍ≥ÑÏÉÅ ÏûÖÍ≥†Ïùº</TableHead>\n                  </>\n                )}\n                <TableHead>ÎπÑÍ≥†</TableHead>\n                {isEditing && <TableHead className=\"w-20\">ÏÇ≠Ï†ú</TableHead>}\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {items.map((item, index) => (\n                <TableRow key={item.id || index}>\n                  <TableCell className=\"modal-value\">{item.line_number || index + 1}</TableCell>\n                  <TableCell>\n                    {isEditing ? (\n                      <Input\n                        value={item.item_name}\n                        onChange={(e) => handleItemChange(index, 'item_name', e.target.value)}\n                        className=\"h-7 modal-label\"\n                      />\n                    ) : (\n                      <div className=\"sm:max-w-[200px]\">\n                        <p className=\"modal-value truncate\" title={item.item_name}>\n                          {item.item_name}\n                        </p>\n                      </div>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    {isEditing ? (\n                      <Input\n                        value={item.specification}\n                        onChange={(e) => handleItemChange(index, 'specification', e.target.value)}\n                        className=\"h-7 modal-label\"\n                      />\n                    ) : (\n                      <div className=\"sm:max-w-[150px] truncate\" title={item.specification}>\n                        {item.specification}\n                      </div>\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    {isEditing ? (\n                      <Input\n                        type=\"number\"\n                        value={item.quantity}\n                        onChange={(e) => handleItemChange(index, 'quantity', e.target.value)}\n                        className=\"h-7 text-xs text-right\"\n                      />\n                    ) : (\n                      <span className=\"modal-value\">{item.quantity.toLocaleString()}</span>\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    {isEditing ? (\n                      <Input\n                        type=\"number\"\n                        value={item.unit_price_value}\n                        onChange={(e) => handleItemChange(index, 'unit_price_value', e.target.value)}\n                        className=\"h-7 text-xs text-right\"\n                      />\n                    ) : (\n                      <span className=\"modal-subtitle\">{(item.unit_price_value || 0).toLocaleString()} {purchase.currency}</span>\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right\">\n                    {isEditing ? (\n                      <Input\n                        type=\"number\"\n                        value={item.amount_value}\n                        onChange={(e) => handleItemChange(index, 'amount_value', e.target.value)}\n                        className=\"h-7 modal-label text-right\"\n                      />\n                    ) : (\n                      <span className=\"modal-value\">{(item.amount_value || 0).toLocaleString()} {purchase.currency}</span>\n                    )}\n                  </TableCell>\n                  <TableCell>\n                    {item.is_received ? (\n                      <Badge variant={null} className=\"badge-success\">ÏûÖÍ≥†ÏôÑÎ£å</Badge>\n                    ) : (\n                      <Badge variant={null} className=\"badge-secondary\">ÎåÄÍ∏∞</Badge>\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-center\">\n                    <ReceiptDownloadButton \n                      itemId={Number(item.id)}\n                      receiptUrl={item.receipt_image_url}\n                      itemName={item.item_name}\n                      paymentCategory={purchase.payment_category}\n                      onUpdate={onUpdate}\n                    />\n                  </TableCell>\n                  {activeTab === 'done' && (\n                    <>\n                      <TableCell className=\"text-center\">\n                        {item.is_statement_received ? (\n                          <button\n                            onClick={() => {\n                              // ÌíàÎ™© Ï†ïÎ≥¥ ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏\n                              const confirmMessage = `ÌíàÎ™©Î™Ö: ${item.item_name || '-'}\nÍ∑úÍ≤©: ${item.specification || '-'}\nÏàòÎüâ: ${item.quantity?.toLocaleString() || 0}\nÎã®Í∞Ä: ‚Ç©${item.unit_price_value?.toLocaleString() || 0}\nÌï©Í≥Ñ: ‚Ç©${item.amount_value?.toLocaleString() || 0}\nÎπÑÍ≥†: ${item.remark || '-'}\n\nÍ±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ÏùÑ Ï∑®ÏÜåÌïòÏãúÍ≤†ÏäµÎãàÍπå?`\n                              \n                              if (window.confirm(confirmMessage)) {\n                                handleStatementCancel(item.id!)\n                              }\n                            }}\n                            className=\"button-base bg-green-500 hover:bg-green-600 text-white transition-colors\"\n                            title=\"ÌÅ¥Î¶≠ÌïòÏó¨ Í±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ Ï∑®ÏÜå\"\n                          >\n                            ‚úì ÏôÑÎ£å\n                          </button>\n                        ) : (\n                          <DatePickerPopover\n                            onDateSelect={(date) => {\n                              // ÌíàÎ™© Ï†ïÎ≥¥ ÌôïÏù∏ Îã§Ïù¥ÏñºÎ°úÍ∑∏\n                              const confirmMessage = `ÌíàÎ™©Î™Ö: ${item.item_name || '-'}\nÍ∑úÍ≤©: ${item.specification || '-'}\nÏàòÎüâ: ${item.quantity?.toLocaleString() || 0}\nÎã®Í∞Ä: ‚Ç©${item.unit_price_value?.toLocaleString() || 0}\nÌï©Í≥Ñ: ‚Ç©${item.amount_value?.toLocaleString() || 0}\nÎπÑÍ≥†: ${item.remark || '-'}\n\nÍ±∞ÎûòÎ™ÖÏÑ∏ÏÑú ÌôïÏù∏ÏùÑ Ï≤òÎ¶¨ÌïòÏãúÍ≤†ÏäµÎãàÍπå?`\n                              \n                              if (window.confirm(confirmMessage)) {\n                                handleStatementCheck(item.id!, date)\n                              }\n                            }}\n                            placeholder=\"ÎÇ†Ïßú ÏÑ†ÌÉù\"\n                          >\n                            <Button \n                              variant=\"outline\" \n                              size=\"sm\"\n                              className=\"button-base border border-gray-300 text-gray-600 bg-white hover:bg-gray-50\"\n                            >\n                              ÎåÄÍ∏∞\n                            </Button>\n                          </DatePickerPopover>\n                        )}\n                      </TableCell>\n                      <TableCell className=\"text-center\">\n                        {item.statement_received_date ? (\n                          <span className=\"modal-subtitle\">\n                            {format(new Date(item.statement_received_date), 'yyyy-MM-dd')}\n                          </span>\n                        ) : (\n                          <span className=\"modal-subtitle\">-</span>\n                        )}\n                      </TableCell>\n                    </>\n                  )}\n                  <TableCell>\n                    {isEditing ? (\n                      <Input\n                        value={item.remark || ''}\n                        onChange={(e) => handleItemChange(index, 'remark', e.target.value)}\n                        className=\"h-7 modal-label\"\n                        placeholder=\"ÎπÑÍ≥†\"\n                      />\n                    ) : (\n                      <div className=\"sm:max-w-[150px]\">\n                        <span className=\"modal-subtitle truncate block\" title={item.remark}>\n                          {item.remark || '-'}\n                        </span>\n                      </div>\n                    )}\n                  </TableCell>\n                  {isEditing && (\n                    <TableCell>\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        onClick={() => handleDeleteItem(index)}\n                        className=\"h-7 w-7 text-red-500 hover:text-red-700\"\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </TableCell>\n                  )}\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        </div>\n        \n        <div className=\"flex-shrink-0 border-t pt-4 flex justify-between items-center\">\n          <div className=\"modal-subtitle\">\n            Ï¥ù {items.length}Í∞ú ÌíàÎ™©\n          </div>\n          <div className=\"modal-value-large\">\n            Ï¥ù Í∏àÏï°: {totalAmount.toLocaleString()} {purchase.currency}\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}"],"names":["FileX","createLucideIcon","d","key","ReceiptDownloadButton","itemId","receiptUrl","itemName","paymentCategory","onUpdate","isLoading","setIsLoading","React","useState","jsxs","className","children","onClick","modal","document","createElement","style","cssText","img","src","appendChild","onclick","body","removeChild","title","jsx","Eye","async","pathSegments","URL","pathname","split","bucketIndex","indexOf","Error","filePath","slice","join","supabase","createClient","data","error","storage","from","download","blob","Blob","type","downloadUrl","window","createObjectURL","link","href","Date","now","click","revokeObjectURL","alert","message","disabled","Download","PurchaseItemsModal","isOpen","onClose","purchase","isAdmin","activeTab","editingItems","setEditingItems","items","isEditing","setIsEditing","currentUserName","setCurrentUserName","useEffect","user","auth","getUser","email","employeeData","select","eq","single","name","id","freshItems","order","loadData","handleItemChange","index","field","value","newItems","Number","amount_value","quantity","unit_price_value","totalAmount","reduce","sum","item","Dialog","open","onOpenChange","DialogContent","DialogHeader","DialogTitle","purchase_order_number","Button","variant","size","Edit2","Fragment","newItem","line_number","length","item_name","specification","remark","is_received","Plus","delete","itemsToInsert","map","purchase_request_id","delivery_status","insert","update","total_amount","toast","success","Save","X","vendor_name","requester_name","project_vendor","delivery_request_date","format","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","Input","onChange","e","target","toLocaleString","currency","Badge","receipt_image_url","payment_category","is_statement_received","confirmMessage","confirm","itemIdStr","String","numericId","isNaN","find","statement_received_date","statement_received_by_name","handleStatementCancel","DatePickerPopover","onDateSelect","date","selectedDate","toISOString","handleStatementCheck","placeholder","filter","_","i","forEach","handleDeleteItem","Trash2"],"mappings":"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","x_google_ignoreList":[0]}