const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FastPurchaseTable-BIDOdpKD.js","assets/index-D7zhaxeg.js","assets/index-mUgxKjwl.css","assets/index-Byz6fgcv.js","assets/PurchaseDetailModal-C2mPWIGh.js","assets/helpers-CWDchwQL.js","assets/input-CTFTBxu1.js","assets/dialog-LTqAfP5e.js","assets/format-CnekkAQy.js","assets/circle-check-big-BehIIF9k.js","assets/eye-HjbV6Hjo.js","assets/chevron-down-r3_WKTHg.js","assets/popover-CFifCbHm.js","assets/calendar-QNyeR54B.js","assets/package-Cdr3Vic_.js","assets/credit-card-B38YpWC4.js","assets/trash-2-B0it-y9E.js","assets/plus-4dt1HSHA.js","assets/save-DDEkIv3j.js","assets/PurchaseItemsModal-CtwsjuIp.js","assets/table-DDTFZxAX.js"])))=>i.map(i=>d[i]);
import{r as l,a as _e,l as ie,j as e,_ as we,u as Te,f as Ie,b as ke}from"./index-D7zhaxeg.js";import{t as ee,B as Ae}from"./index-Byz6fgcv.js";import{I as ce}from"./input-CTFTBxu1.js";import{S as fe,a as ge,b as xe,c as ye,d as X}from"./select-DL7glOVa.js";import{C as qe}from"./combobox-CbDP-k9x.js";import{C as ve,a as Be,b as Le,c as be}from"./card-DphZW_ic.js";import{P as Ge}from"./plus-4dt1HSHA.js";import{F as Me}from"./funnel-By3V72zV.js";import{S as Oe}from"./search-CSgQkRs9.js";import{P as Ue}from"./package-Cdr3Vic_.js";import"./chevron-down-r3_WKTHg.js";import"./popover-CFifCbHm.js";const i={purchases:null,vendors:null,employees:null,lastFetch:0,userInfo:null,CACHE_DURATION:120*1e3},Ve=()=>{const[g,c]=l.useState([]),[h,I]=l.useState([]),[j,k]=l.useState([]),[C,$]=l.useState(!0),[te,N]=l.useState([]),[M,K]=l.useState(""),[E,A]=l.useState(""),[O,J]=l.useState(""),y=_e(),q=l.useRef(!1);l.useEffect(()=>{(async()=>{if(q.current)return;q.current=!0,console.log("🚀 [DEBUG] loadInitialData 시작");const x=Date.now(),T=i.lastFetch&&x-i.lastFetch<i.CACHE_DURATION;console.log("📊 [DEBUG] 캐시 상태:",{cacheValid:T,lastFetch:i.lastFetch,timeSinceLastFetch:x-i.lastFetch,cacheHasData:!!(i.vendors&&i.employees&&i.userInfo)});try{if(T&&i.vendors&&i.employees&&i.userInfo)try{console.log("✅ [DEBUG] 캐시 데이터 사용"),I(i.vendors),k(i.employees);const o=i.userInfo;if(o){let _=[];o.purchase_role&&(Array.isArray(o.purchase_role)?_=o.purchase_role.map(t=>String(t).trim()):_=String(o.purchase_role).split(",").map(m=>m.trim()).filter(m=>m.length>0)),N(_),K(o.name||o.full_name||""),A(o.email||""),J(o.id||"")}return}catch(o){ie.error("캐시 데이터 사용 중 오류",o),console.error("❌ [DEBUG] 캐시 오류:",o),i.purchases=null,i.vendors=null,i.employees=null,i.userInfo=null,i.lastFetch=0}console.log("🔄 [DEBUG] 데이터 새로 로드");const[p,B,D]=await Promise.all([y.from("vendors").select("*"),y.from("employees").select("*"),y.auth.getUser()]);if(p.error)throw console.error("❌ [DEBUG] 업체 로드 실패:",p.error),p.error;const b=p.data||[];if(I(b),i.vendors=b,console.log("✅ [DEBUG] 업체 로드 완료:",b.length,"개"),B.error)throw console.error("❌ [DEBUG] 직원 로드 실패:",B.error),B.error;const v=B.data||[];if(k(v),i.employees=v,console.log("✅ [DEBUG] 직원 로드 완료:",v.length,"개"),D.data.user&&!D.error){console.log("👤 [DEBUG] 사용자 정보:",D.data.user.email);let o=null;if(D.data.user.email&&(o=(await y.from("employees").select("*").eq("email",D.data.user.email).maybeSingle()).data),o){i.userInfo=o;let _=[];o.purchase_role&&(Array.isArray(o.purchase_role)?_=o.purchase_role.map(t=>String(t).trim()):_=String(o.purchase_role).split(",").map(m=>m.trim()).filter(m=>m.length>0)),console.log("👤 [DEBUG] 사용자 권한:",{name:o.name,email:o.email,roles:_}),N(_),K(o.name||o.full_name||""),A(o.email||""),J(o.id||"")}i.lastFetch=x}}catch(p){ie.error("초기 데이터 로드 실패",p),console.error("❌ [DEBUG] 초기 데이터 로드 실패:",p)}})()},[]);const w=l.useCallback(async P=>{console.log("🔄 [DEBUG] loadPurchases 시작 - forceRefresh:",P),$(!0);try{const x=Date.now(),T=i.lastFetch&&x-i.lastFetch<i.CACHE_DURATION;if(console.log("📊 [DEBUG] 캐시 확인:",{forceRefresh:P,cacheValid:T,hasCachedData:!!i.purchases,cacheAge:x-i.lastFetch}),!P&&T&&i.purchases)try{console.log("✅ [DEBUG] 캐시된 발주 데이터 사용:",i.purchases.length,"건"),c(i.purchases),$(!1);return}catch(t){ie.error("발주 데이터 캐시 사용 중 오류",t),console.error("❌ [DEBUG] 캐시 오류:",t),i.purchases=null,i.lastFetch=0}let p=j;if(p.length===0&&(p=i.employees||[],p.length===0)){const{data:t}=await y.from("employees").select("*");p=t||[]}const{data:{user:B},error:D}=await y.auth.getUser();if(D||!B){ie.error("사용자 인증 실패",D),ee.error("로그인이 필요합니다."),$(!1);return}const b=new Date;b.setMonth(b.getMonth()-6),b.setHours(0,0,0,0),console.log("📅 [DEBUG] 최근 6개월 데이터 조회:",{sixMonthsAgo:b.toISOString(),today:new Date().toISOString()});const{data:v,error:o}=await y.from("purchase_requests").select("*,vendors(vendor_name,vendor_payment_schedule),vendor_contacts(contact_name),purchase_request_items(*).order(line_number)").gte("request_date",b.toISOString()).order("request_date",{ascending:!1}).limit(500);if(o)throw console.error("❌ [DEBUG] 발주 데이터 조회 실패:",o),o;console.log("📊 [DEBUG] 발주 데이터 조회 결과:",{dataCount:Array.isArray(v)?v.length:0,firstFewIds:Array.isArray(v)?v.slice(0,5).map(t=>({id:t.id,po_number:t.purchase_order_number,date:t.request_date})):[]});const _=(v||[]).map(t=>{const m=t.purchase_request_items?.[0]||{},U=p.find(L=>L.id===t.requester_id);return{id:Number(t.id),purchase_order_number:t.purchase_order_number,request_date:t.request_date,delivery_request_date:t.delivery_request_date,progress_type:t.progress_type,payment_completed_at:t.payment_completed_at,payment_category:t.payment_category,currency:t.currency,request_type:t.request_type,vendor:t.vendors||null,vendor_name:t.vendors?.vendor_name||"",vendor_payment_schedule:t.vendors?.vendor_payment_schedule||"",vendor_contacts:t.vendor_contacts||[],requester_id:t.requester_id,requester_name:t.requester_name,requester_full_name:U?.full_name||U?.name||t.requester_name||"",item_name:m.item_name||"",specification:m.specification||"",quantity:Number(m.quantity)||0,unit_price_value:Number(m.unit_price_value)||0,amount_value:Number(m.amount_value)||0,remark:m.remark||"",project_vendor:t.project_vendor,sales_order_number:t.sales_order_number,project_item:t.project_item,line_number:Number(m.line_number)||1,contact_name:t.vendor_contacts?.contact_name||"",middle_manager_status:t.middle_manager_status,final_manager_status:t.final_manager_status,is_received:!!t.is_received,received_at:t.received_at,is_payment_completed:!!t.is_payment_completed,is_po_download:!!t.is_po_download,link:m.link,items:t.purchase_request_items||[],total_amount:t.purchase_request_items?.reduce((L,Y)=>L+(Number(Y.amount_value)||0),0)||0,purchase_status:t.purchase_status||"pending"}});console.log("✅ [DEBUG] 발주 데이터 처리 완료:",{processedCount:_.length,sampleData:_.slice(0,3).map(t=>({id:t.id,po:t.purchase_order_number,requester:t.requester_name,date:t.request_date}))}),c(_),i.purchases=_,i.lastFetch=x,console.log("✅ [DEBUG] 캐시 업데이트 완료")}catch(x){ie.error("발주 목록 로드 실패",x),console.error("❌ [DEBUG] 발주 목록 로드 실패:",x),ee.error("발주 목록을 불러올 수 없습니다.")}finally{$(!1)}},[j]);return l.useEffect(()=>{console.log("🚀 [DEBUG] usePurchaseData 첫 로드"),w()},[w]),{purchases:g,vendors:h,employees:j,loading:C,currentUserRoles:te,currentUserName:M,currentUserEmail:E,currentUserId:O,refreshPurchases:w}};function $e(g,c=500){const[h,I]=l.useState(g);return l.useEffect(()=>{const j=setTimeout(()=>{I(g)},c);return()=>{clearTimeout(j)}},[g,c]),h}const je=["정희웅"],d=new Map,de=100,Re=(g,c,h,I,j)=>{const k=_e(),[C,$]=l.useState("pending"),[te,N]=l.useState(""),[M,K]=l.useState(""),[E,A]=l.useState(""),[O,J]=l.useState(""),[y,q]=l.useState(""),[w,P]=l.useState(""),[x,T]=l.useState(""),[p,B]=l.useState(""),D=new Date().getFullYear(),b=new Date(D,0,1).toISOString().split("T")[0],v=new Date().toISOString().split("T")[0],[o,_]=l.useState(b),[t,m]=l.useState(v),U=$e(te,300),L=c?.includes("app_admin");c?.includes("final_approver"),c?.includes("middle_manager");const Y=c?.includes("purchase_manager"),Z=c?.includes("raw_material_manager")||c?.includes("consumable_manager")||c?.includes("purchase_manager"),Q=l.useMemo(()=>!c||c.length===0?1:Y?2:c.some(r=>["middle_manager","final_approver","app_admin","ceo"].includes(r))?3:1,[c,Y]),W=l.useCallback(r=>{if(!h)return"all";if(r==="purchase")return Z||L?"all":h;switch(Q){case 1:return r==="done"?"all":h;case 2:return r==="done"?"all":h;case 3:return"all";default:return h}},[h,Q,Z,L]);l.useEffect(()=>{if(!h)return;const r=W(C);A(r)},[C,h,Q,W]);const R=l.useMemo(()=>{console.log("🔍 [Filter] 1단계 권한별 필터링 시작:",{purchasesCount:g.length,currentUserRoles:c,currentUserName:h});try{const r=`visible_${g.length}_${c.join(",")}`;if(d.has(r))return console.log("📦 [Filter] 캐시에서 가져옴"),d.get(r);let s;if(c.includes("purchase_manager")||c.includes("app_admin")?s=g:s=g.filter(n=>!je.includes(n.requester_name)),console.log("✅ [Filter] 권한별 필터링 완료:",{originalCount:g.length,filteredCount:s.length}),d.size>=de){const n=d.keys().next().value;d.delete(n)}return d.set(r,s),s}catch(r){return console.error("필터링 중 오류:",r),d.clear(),c.includes("purchase_manager")||c.includes("app_admin")?g:g.filter(s=>!je.includes(s.requester_name))}},[g,c]),se=l.useMemo(()=>{const r=`date_${R.length}_${o}_${t}`;if(d.has(r))return d.get(r);const s=R.filter(n=>{const u=n.request_date?n.request_date.split("T")[0]:"",V=!o||u>=o,H=!t||u<=t;return V&&H});if(d.size>=de){const n=d.keys().next().value;d.delete(n)}return d.set(r,s),s},[R,o,t]),z=l.useMemo(()=>{const r=`tab_${se.length}_${C}`;if(d.has(r))return d.get(r);const s=se.filter(n=>{let u=!1;switch(C){case"pending":return u=["pending","대기","",null].includes(n.final_manager_status),u;case"purchase":{const V=n.payment_category==="구매 요청",H=!n.is_payment_completed,le=(n.progress_type||"").includes("선진행"),pe=(n.progress_type||"").includes("일반"),he=n.final_manager_status==="approved";return!V||!H?u=!1:u=le||pe&&he,u}case"receipt":{const V=!n.is_received,H=(n.progress_type||"").includes("선진행"),le=n.final_manager_status==="approved";return u=V&&(H||le),u}case"done":return u=!0,u;default:return!0}});if(d.size>=de){const n=d.keys().next().value;d.delete(n)}return d.set(r,s),s},[se,C]),re=l.useMemo(()=>{const r=`employee_${z.length}_${E}`;if(d.has(r))return d.get(r);let s;if(E&&E!=="all"&&E!=="전체"?s=z.filter(n=>n.requester_name===E):s=z,d.size>=de){const n=d.keys().next().value;d.delete(n)}return d.set(r,s),s},[z,E]),ue=l.useMemo(()=>M?re.filter(r=>r.vendor_name===M):re,[re,M]),ae=l.useMemo(()=>{let r=ue;if(O){const s=O.trim().toLowerCase();r=r.filter(n=>n.purchase_order_number?.toLowerCase().includes(s))}if(y){const s=y.trim().toLowerCase();r=r.filter(n=>n.items&&n.items.length>0?n.items.some(u=>u.item_name?.toLowerCase().includes(s)):!1)}if(w){const s=w.trim().toLowerCase();r=r.filter(n=>n.items&&n.items.length>0?n.items.some(u=>u.specification?.toLowerCase().includes(s)):!1)}if(x&&x!=="all"&&(r=r.filter(s=>{switch(x){case"pending":return!s.final_manager_status||s.final_manager_status==="pending"||s.final_manager_status==="대기";case"approved":return s.final_manager_status==="approved";case"rejected":return s.final_manager_status==="rejected"||s.middle_manager_status==="rejected";default:return!0}})),p){const s=p.trim().toLowerCase();r=r.filter(n=>n.items&&n.items.length>0?n.items.some(u=>u.remark?.toLowerCase().includes(s)):!1)}return r},[ue,O,y,w,x,p]),a=l.useMemo(()=>{if(!U)return ae;const r=U.trim().toLowerCase();return ae.filter(s=>s.purchase_order_number?.toLowerCase().includes(r)||s.vendor_name?.toLowerCase().includes(r)||s.requester_name?.toLowerCase().includes(r)||s.project_vendor?.toLowerCase().includes(r)?!0:s.items&&s.items.length>0?s.items.some(n=>n.item_name&&n.item_name.toLowerCase().includes(r)||n.specification&&n.specification.toLowerCase().includes(r)):!1)},[ae,U]),F=l.useMemo(()=>{const r=[...a].sort((s,n)=>{const u=s.request_date?new Date(s.request_date).getTime():0;return(n.request_date?new Date(n.request_date).getTime():0)-u});return console.log("✅ [Filter] 최종 필터링 완료:",{activeTab:C,searchFilteredCount:a.length,finalCount:r.length,firstFewResults:r.slice(0,3).map(s=>({id:s.id,po:s.purchase_order_number,requester:s.requester_name,date:s.request_date}))}),r},[a,C]),Fe=l.useMemo(()=>{const s=R.filter(f=>{const S=f.request_date?f.request_date.split("T")[0]:"",G=!o||S>=o,oe=!t||S<=t;return G&&oe}),n=f=>new Set(f.map(S=>S.purchase_order_number)).size,u=f=>{if(f==="purchase")return Z||L?s:s.filter(G=>G.requester_name===h);const S=W(f);return S==="all"||S==="전체"?s:s.filter(G=>G.requester_name===S)},V=u("pending"),H=u("purchase"),le=u("receipt"),pe=u("done"),he=V.filter(f=>["pending","대기","",null].includes(f.final_manager_status)),Ce=H.filter(f=>{const S=f.payment_category==="구매 요청",G=!f.is_payment_completed;if(!S||!G)return!1;const oe=(f.progress_type||"").includes("선진행"),Ee=(f.progress_type||"").includes("일반"),Pe=f.final_manager_status==="approved";return oe||Ee&&Pe}),Ne=le.filter(f=>{const S=!f.is_received,G=(f.progress_type||"").includes("선진행"),oe=f.final_manager_status==="approved";return S&&(G||oe)});return{pending:n(he),purchase:n(Ce),receipt:n(Ne),done:n(pe)}},[R,o,t,Q,h,W,Z,L]),me=l.useRef(!1);l.useEffect(()=>{me.current||(me.current=!0,(async()=>{const{data:{user:r}}=await k.auth.getUser();if(!r)return;const{data:s}=await k.from("user_preferences").select("period_start, period_end").eq("user_id",r.id).single();if(s){const n=s.period_start?new Date(s.period_start).toISOString().split("T")[0]:b,u=s.period_end?new Date(s.period_end).toISOString().split("T")[0]:v;_(n),m(u)}})())},[]);const ne=l.useRef();return l.useEffect(()=>{if(me.current)return ne.current&&clearTimeout(ne.current),ne.current=setTimeout(async()=>{const{data:{user:r}}=await k.auth.getUser();r&&(!o||!t||await k.from("user_preferences").upsert({user_id:r.id,period_start:o,period_end:t,updated_at:new Date().toISOString()}))},1e3),()=>{ne.current&&clearTimeout(ne.current)}},[o,t]),{activeTab:C,searchTerm:te,vendorFilter:M,dateFromFilter:o,dateToFilter:t,selectedEmployee:E,purchaseNumberFilter:O,itemNameFilter:y,specificationFilter:w,approvalStatusFilter:x,remarkFilter:p,setActiveTab:$,setSearchTerm:N,setVendorFilter:K,setDateFromFilter:_,setDateToFilter:m,setSelectedEmployee:A,setPurchaseNumberFilter:J,setItemNameFilter:q,setSpecificationFilter:P,setApprovalStatusFilter:T,setRemarkFilter:B,filteredPurchases:F,tabCounts:Fe}},ze=l.lazy(()=>we(()=>import("./FastPurchaseTable-BIDOdpKD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]))),Se=l.memo(()=>e.jsx("div",{className:"p-4 space-y-4",children:[...Array(5)].map((g,c)=>e.jsxs("div",{className:"flex space-x-4 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"})]},c))}));Se.displayName="TableSkeleton";const De=l.memo(({purchases:g,activeTab:c,currentUserRoles:h,onRefresh:I,onPaymentComplete:j,onReceiptComplete:k})=>e.jsx(l.Suspense,{fallback:e.jsx(Se,{}),children:e.jsx(ze,{purchases:g,activeTab:c,currentUserRoles:h,onRefresh:I,onPaymentComplete:j,onReceiptComplete:k})}));De.displayName="LazyPurchaseTable";const He=l.lazy(()=>we(()=>import("./PurchaseItemsModal-CtwsjuIp.js"),__vite__mapDeps([19,1,2,7,6,20,3,8,17,18,16]))),Ke=[{key:"pending",label:"승인대기"},{key:"purchase",label:"구매 현황"},{key:"receipt",label:"입고 현황"},{key:"done",label:"전체 항목"}];function ot({onEmailToggle:g,showEmailButton:c=!0}){const h=Te(),I=Ie(),j=_e(),[k,C]=l.useState(null),[$,te]=l.useState({}),[N,M]=l.useState(null),[K,E]=l.useState(!1),{purchases:A,vendors:O,employees:J,loading:y,currentUserRoles:q,currentUserName:w,refreshPurchases:P}=Ve(),x=q?.includes("app_admin");l.useEffect(()=>{console.log("📊 [PurchaseListMain] 발주 데이터 상태:",{purchasesCount:A.length,loading:y,currentUserName:w,currentUserRoles:q,firstFewPurchases:A.slice(0,3).map(a=>({id:a.id,po:a.purchase_order_number,requester:a.requester_name,date:a.request_date}))})},[A,y,w,q]);const{activeTab:T,searchTerm:p,vendorFilter:B,dateFromFilter:D,dateToFilter:b,selectedEmployee:v,purchaseNumberFilter:o,itemNameFilter:_,approvalStatusFilter:t,setActiveTab:m,setSearchTerm:U,setVendorFilter:L,setDateFromFilter:Y,setDateToFilter:Z,setSelectedEmployee:Q,setPurchaseNumberFilter:W,setItemNameFilter:R,setApprovalStatusFilter:se,filteredPurchases:z,tabCounts:re}=Re(A,q,w);l.useEffect(()=>{new URLSearchParams(I.search).get("tab")==="purchase"&&m("purchase")},[I.search,m]);const ue=async a=>{try{const{error:F}=await j.from("purchase_requests").update({is_received:!0,received_at:new Date().toISOString()}).eq("id",a);if(F)throw F;await j.from("purchase_request_items").update({is_received:!0,delivery_status:"received"}).eq("purchase_request_id",a),ee.success("입고완료 처리되었습니다."),await P()}catch{ee.error("처리 중 오류가 발생했습니다.")}},ae=async a=>{try{const{error:F}=await j.from("purchase_requests").update({is_payment_completed:!0,payment_completed_at:new Date().toISOString()}).eq("id",a);if(F)throw F;await j.from("purchase_request_items").update({is_payment_completed:!0}).eq("purchase_request_id",a),ee.success("구매완료 처리되었습니다."),await P()}catch{ee.error("처리 중 오류가 발생했습니다.")}};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"발주요청 관리"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"발주요청서를 관리하고 승인 처리를 할 수 있습니다"})]}),e.jsxs(ke,{onClick:()=>h("/purchase/new"),className:"mt-4 sm:mt-0 bg-hansl-500 hover:bg-hansl-600",children:[e.jsx(Ge,{className:"w-4 h-4 mr-2"}),"새 발주요청 작성"]})]}),e.jsxs(ve,{className:"mb-4 border border-gray-200",children:[e.jsx(Be,{className:"bg-white border-b border-gray-200 py-3",children:e.jsxs(Le,{className:"flex items-center text-gray-900 text-sm font-medium",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),"검색 필터"]})}),e.jsx(be,{className:"py-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"시작일"}),e.jsx(ce,{type:"date",value:D,onChange:a=>Y(a.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"종료일"}),e.jsx(ce,{type:"date",value:b,onChange:a=>Z(a.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"요청자"}),e.jsx(qe,{value:v||"all",onValueChange:a=>{Q(a)},options:[{value:"all",label:"전체"},...J.filter(a=>a.name&&a.name.trim()!=="").sort((a,F)=>(a.name||"").localeCompare(F.name||"")).map(a=>({value:a.name||"",label:`${a.name}${a.name===w?" (나)":""}`}))],placeholder:v==="all"?"전체":v||"선택",searchPlaceholder:"직원 이름 검색...",emptyText:"일치하는 직원이 없습니다",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"업체"}),e.jsxs(fe,{value:B||"all",onValueChange:a=>L(a==="all"?"":a),children:[e.jsx(ge,{className:"h-9 text-sm",children:e.jsx(xe,{placeholder:"전체"})}),e.jsxs(ye,{children:[e.jsx(X,{value:"all",children:"전체"}),O.map(a=>e.jsx(X,{value:a.vendor_name,children:a.vendor_name},a.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"발주번호"}),e.jsx(ce,{placeholder:"번호",value:o,onChange:a=>W(a.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"품명"}),e.jsx(ce,{placeholder:"품명",value:_,onChange:a=>R(a.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"승인상태"}),e.jsxs(fe,{value:t||"all",onValueChange:a=>se(a==="all"?"":a),children:[e.jsx(ge,{className:"h-9 text-sm",children:e.jsx(xe,{placeholder:"전체"})}),e.jsxs(ye,{children:[e.jsx(X,{value:"all",children:"전체"}),e.jsx(X,{value:"pending",children:"대기"}),e.jsx(X,{value:"approved",children:"승인"}),e.jsx(X,{value:"rejected",children:"반려"})]})]})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"통합검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx(ce,{placeholder:"검색...",value:p,onChange:a=>U(a.target.value),className:"pl-7 text-sm h-9"})]})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 rounded-lg border border-gray-200",children:Ke.map(a=>e.jsxs("button",{onClick:()=>m(a.key),className:`flex-1 flex items-center justify-center space-x-2 py-2.5 px-3 sm:px-4 rounded-md text-xs sm:text-sm font-medium transition-colors ${T===a.key?"text-hansl-600 bg-white shadow-sm border border-gray-200":"text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50"}`,children:[e.jsx("span",{className:"whitespace-nowrap",children:a.label}),e.jsx(Ae,{variant:"secondary",className:`text-[10px] sm:text-xs ${T===a.key?"bg-hansl-50 text-hansl-700":"bg-gray-100 text-gray-600"}`,children:re[a.key]})]},a.key))}),e.jsx(ve,{className:"overflow-hidden border border-gray-200",children:e.jsx(be,{className:"p-0",children:y?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"로딩 중..."})]}):z.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ue,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주요청서가 없습니다"}),e.jsx("p",{className:"text-gray-600",children:"새로운 발주요청서를 작성해보세요."})]}):e.jsx(De,{purchases:z,activeTab:T,currentUserRoles:q,onRefresh:P,onPaymentComplete:ae,onReceiptComplete:ue})})})]}),N&&e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:e.jsx(He,{isOpen:K,onClose:()=>{E(!1),M(null)},purchase:{...N,vendor_name:N.vendor_name||"",project_vendor:N.project_vendor||"",sales_order_number:N.sales_order_number||"",project_item:N.project_item||""},isAdmin:x||!1,onUpdate:P})})]})}export{ot as default};
//# sourceMappingURL=PurchaseListMain-CXiJBkMx.js.map
