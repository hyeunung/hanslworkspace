{"version":3,"file":"PurchaseNewMain-BW3ol2pB.js","sources":["../../node_modules/lucide-react/dist/esm/icons/copy.js","../../src/components/purchase/PurchaseNewMain.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.541.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"14\", height: \"14\", x: \"8\", y: \"8\", rx: \"2\", ry: \"2\", key: \"17jyea\" }],\n  [\"path\", { d: \"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\", key: \"zix9uf\" }]\n];\nconst Copy = createLucideIcon(\"copy\", __iconNode);\n\nexport { __iconNode, Copy as default };\n//# sourceMappingURL=copy.js.map\n","import { useState, useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Plus, X, Save, Package, Copy, Check } from \"lucide-react\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport { useNavigate } from \"react-router-dom\";\nimport { markCacheStaleAndNotify, invalidatePurchaseMemoryCache } from '@/stores/purchaseMemoryStore';\nimport { loadAllPurchaseData } from '@/services/purchaseDataLoader';\nimport { useForm as useFormRH, useFieldArray } from \"react-hook-form\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogClose } from \"@/components/ui/dialog\";\nimport { FormValues, FormItem } from \"@/types/purchase\";\nimport { toast } from \"sonner\";\nimport ReactSelect from 'react-select';\nimport { DatePickerPopover } from '@/components/ui/date-picker-popover';\nimport { format } from 'date-fns';\nimport { Calendar as CalendarIcon } from 'lucide-react';\n\ninterface EmployeeOption {\n  value: string;\n  label: string;\n}\n\nexport default function PurchaseNewMain() {\n  const navigate = useNavigate();\n  const supabase = createClient();\n  \n  const [user, setUser] = useState<any>(null);\n  const [employeeName, setEmployeeName] = useState<string>(\"\");\n  const [employees, setEmployees] = useState<{id: string; name: string; email?: string; phone?: string; address?: string; position?: string; department?: string;}[]>([]);\n  const [defaultRequesterLoaded, setDefaultRequesterLoaded] = useState(false);\n  const [addCount, setAddCount] = useState(1);\n  const [vendorSearchTerm, setVendorSearchTerm] = useState(\"\");\n  \n  // BOM ì—°ë™ì„ ìœ„í•œ ìƒíƒœ\n  const [boards, setBoards] = useState<{ id: string; board_name: string }[]>([]);\n  const [selectedBoard, setSelectedBoard] = useState<{ value: string; label: string } | null>(null);\n  const [productionQuantity, setProductionQuantity] = useState<number>(100); // BOM ë¶ˆëŸ¬ì˜¤ê¸° ì‹œ ì‚¬ìš©í•  ìƒì‚° ìˆ˜ëŸ‰\n  \n  // ì´ˆê¸° ì‚¬ìš©ì ì •ë³´ ë¡œë“œ\n  useEffect(() => {\n    const getUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      setUser(user);\n    };\n    getUser();\n  }, []);\n\n  // ë³´ë“œ ëª©ë¡ ë¡œë“œ (BOM ì—°ë™)\n  useEffect(() => {\n    const loadBoards = async () => {\n      const { data, error } = await supabase\n        .from('cad_drawings')\n        .select('id, board_name')\n        .order('board_name');\n      \n      if (data && !error) {\n        setBoards(data);\n      }\n    };\n    loadBoards();\n  }, [supabase]);\n\n  useEffect(() => {\n    // DBì—ì„œ ì§ì› ëª©ë¡ ê°€ì ¸ì˜¤ê¸°\n    const loadEmployees = async () => {\n      try {\n        const { data, error } = await supabase\n          .from('employees')\n          .select('id, name, email, phone, adress, position, department')\n          .order('name');\n        \n        \n        if (data && !error && data.length > 0) {\n          setEmployees(data.map((dbEmp: any) => ({\n            id: dbEmp.id,\n            name: dbEmp.name,\n            email: dbEmp.email || '',\n            phone: dbEmp.phone || '',\n            address: dbEmp.address || '',\n            position: dbEmp.position || '',\n            department: dbEmp.department || ''\n          })));\n          \n          // ì´ë¯¸ ì„¤ì •ëœ employeeNameì´ ìˆê³  employees ë°°ì—´ì— í•´ë‹¹ ì§ì›ì´ ìˆëŠ”ì§€ í™•ì¸\n          if (employeeName && !data.find((emp: any) => emp.name === employeeName)) {\n            // í˜„ì¬ ì‚¬ìš©ìë¥¼ employees ë°°ì—´ì— ì¶”ê°€\n            const currentUser = {\n              id: user?.id || 'current-user',\n              name: employeeName,\n              email: user?.email || '',\n              phone: '',\n              address: '',\n              position: '',\n              department: ''\n            };\n            setEmployees([...data.map((dbEmp: any) => ({\n              id: dbEmp.id,\n              name: dbEmp.name,\n              email: dbEmp.email || '',\n              phone: dbEmp.phone || '',\n              address: dbEmp.address || '',\n              position: dbEmp.position || '',\n              department: dbEmp.department || ''\n            })), currentUser]);\n          }\n        } else {\n          // DBì—ì„œ ëª» ë¶ˆëŸ¬ì™€ë„ í˜„ì¬ ì‚¬ìš©ìë§Œì´ë¼ë„ ì¶”ê°€\n          if (employeeName) {\n            setEmployees([{\n              id: user?.id || 'current-user',\n              name: employeeName,\n              email: user?.email || '',\n              phone: '',\n              address: '',\n              position: '',\n              department: ''\n            }]);\n          } else {\n            setEmployees([]);\n          }\n        }\n      } catch (err) {\n        // ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ í˜„ì¬ ì‚¬ìš©ì ì¶”ê°€\n        if (employeeName) {\n          setEmployees([{\n            id: user?.id || 'current-user',\n            name: employeeName,\n            email: user?.email || '',\n            phone: '',\n            address: '',\n            position: '',\n            department: ''\n          }]);\n        } else {\n          setEmployees([]);\n        }\n      }\n    };\n    \n    // user ìƒíƒœì™€ ê´€ê³„ì—†ì´ ì§ì› ëª©ë¡ ë¡œë“œ\n    loadEmployees();\n  }, [employeeName, user]);\n\n  const [vendors, setVendors] = useState<{ id: number; vendor_name: string }[]>([]);\n  const [contacts, setContacts] = useState<{ id: number; contact_name: string; contact_email: string; contact_phone: string; position: string }[]>([]);\n  const [vendor, setVendor] = useState(\"\");\n  const [selectedContacts, setSelectedContacts] = useState<string[]>([]);\n  const [currency, setCurrency] = useState(\"KRW\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [inputValues, setInputValues] = useState<{[key: string]: string}>({});\n  const [isContactDialogOpen, setIsContactDialogOpen] = useState(false);\n  const [contactsForEdit, setContactsForEdit] = useState<{ id?: number; contact_name: string; contact_email: string; contact_phone: string; position: string; isNew?: boolean }[]>([]);\n  const [hasChanges, setHasChanges] = useState(false);\n  // ì¤‘ë³µ ì œì¶œ ë°©ì§€ìš© ref\n  const isSubmittingRef = useRef(false);\n  \n  // ì „ì²´ë³µì‚¬ ë²„íŠ¼ ìƒíƒœ\n  const [isCopied, setIsCopied] = useState(false);\n\n  const { control, handleSubmit: rhHandleSubmit, watch, setValue, reset, getValues } = useFormRH<FormValues>({\n    defaultValues: {\n      progress_type: \"\",\n      payment_category: \"\",\n      currency: \"KRW\",\n      po_template_type: \"\",\n      request_type: \"\",\n      contacts: [],\n      sales_order_number: '',\n      project_vendor: '',\n      project_item: '',\n      delivery_request_date: '',\n      vendor_id: 0,\n      requester_name: \"\",\n      items: [\n        {\n          line_number: 1,\n          item_name: \"\",\n          specification: \"\",\n          quantity: 1,\n          unit_price_value: 0,\n          unit_price_currency: \"KRW\",\n          amount_value: 0,\n          amount_currency: \"KRW\",\n          remark: \"\",\n          link: \"\",\n        },\n      ],\n      request_date: new Date().toISOString().slice(0, 10),\n    }\n  });\n\n  const { fields, append, remove, update, replace } = useFieldArray({\n    control,\n    name: \"items\"\n  });\n\n  // ì‚¬ìš©ì ì •ë³´ë¡œ êµ¬ë§¤ìš”ì²­ì ê¸°ë³¸ê°’ ì„¤ì •\n  useEffect(() => {\n    if (!user?.email || defaultRequesterLoaded) return;\n    \n    const loadUserName = async () => {\n      const { data: empData } = await supabase\n        .from('employees')\n        .select('name')\n        .eq('email', user.email)\n        .single();\n      \n      if (empData?.name) {\n        setEmployeeName(empData.name);\n        setValue('requester_name', empData.name);\n        setDefaultRequesterLoaded(true);\n      }\n    };\n    loadUserName();\n  }, [user, supabase, setValue, defaultRequesterLoaded]);\n\n  // ì—…ì²´ ëª©ë¡ ë¡œë“œ\n  useEffect(() => {\n    const setDefaultRequester = async () => {\n      if (user?.email && setValue && !defaultRequesterLoaded) {\n        try {\n          const { data: employeeData, error } = await supabase\n            .from('employees')\n            .select('name')\n            .eq('email', user.email)\n            .single();\n          \n          if (employeeData && !error) {\n            setEmployeeName(employeeData.name);\n            // React Hook Formì˜ setValueë¥¼ ì•½ê°„ì˜ ì§€ì—° í›„ í˜¸ì¶œ\n            setTimeout(() => {\n              setValue('requester_name', employeeData.name, { \n                shouldValidate: true,\n                shouldDirty: true \n              });\n            }, 100);\n            setDefaultRequesterLoaded(true);\n          } else {\n            const fallbackName = user.email.split('@')[0] || \"ì‚¬ìš©ì\";\n            setEmployeeName(fallbackName);\n            setTimeout(() => {\n              setValue('requester_name', fallbackName, { \n                shouldValidate: true,\n                shouldDirty: true \n              });\n            }, 100);\n            setDefaultRequesterLoaded(true);\n          }\n        } catch (err) {\n          const fallbackName = user.email?.split('@')[0] || \"ì‚¬ìš©ì\";\n          setEmployeeName(fallbackName);\n          setTimeout(() => {\n            setValue('requester_name', fallbackName, { \n              shouldValidate: true,\n              shouldDirty: true \n            });\n          }, 100);\n          setDefaultRequesterLoaded(true);\n        }\n      }\n    };\n    \n    setDefaultRequester();\n  }, [user, setValue, defaultRequesterLoaded]);\n\n  // Vendors ë¡œë“œ\n  useEffect(() => {\n    const loadVendors = async () => {\n      try {\n        const { data, error } = await supabase\n          .from(\"vendors\")\n          .select(\"*\")\n          .order(\"vendor_name\");\n        \n        if (error) throw error;\n        setVendors(data || []);\n      } catch (error) {\n        toast.error(\"ì—…ì²´ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n      }\n    };\n\n    loadVendors();\n  }, []);\n\n  const selectedVendor = watch('vendor_id');\n\n  // ì—…ì²´ ë³€ê²½ ì‹œ ë‹´ë‹¹ì ëª©ë¡ ë¡œë“œ\n  useEffect(() => {\n    const loadContacts = async () => {\n      if (selectedVendor) {\n        try {\n          const { data, error } = await supabase\n            .from('vendor_contacts')\n            .select('id, contact_name, contact_email, contact_phone, position')\n            .eq('vendor_id', selectedVendor);\n          \n          if (error) throw error;\n          setContacts(data || []);\n        } catch (error) {\n          setContacts([]);\n        }\n      } else {\n        setContacts([]);\n      }\n    };\n    \n    loadContacts();\n  }, [selectedVendor]);\n\n  // í†µí™” ë³€ê²½ì‹œ í’ˆëª©ë“¤ì˜ í†µí™”ë„ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    const items = getValues(\"items\");\n    const updatedItems = items.map(item => ({\n      ...item,\n      unit_price_currency: currency,\n      amount_currency: currency\n    }));\n    setValue(\"items\", updatedItems);\n    setCurrency(currency);\n  }, [currency, setValue, getValues]);\n\n  // ìˆ˜ëŸ‰ì´ë‚˜ ë‹¨ê°€ ë³€ê²½ ì‹œ ê¸ˆì•¡ ìë™ ê³„ì‚°\n  useEffect(() => {\n    fields.forEach((item, idx) => {\n      const calcAmount = Number(item.quantity) * Number(item.unit_price_value);\n      if (item.amount_value !== calcAmount) {\n        update(idx, { ...item, amount_value: calcAmount });\n      }\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [fields.map(f => `${f.quantity}-${f.unit_price_value}`).join(\",\")]);\n\n  // í’ˆëª© ì¶”ê°€\n  const addItem = () => {\n    const currentItems = getValues(\"items\");\n    const nextLineNumber = Math.max(...currentItems.map(item => item.line_number), 0) + 1;\n    \n    append({\n      line_number: nextLineNumber,\n      item_name: \"\",\n      specification: \"\",\n      quantity: 1,\n      unit_price_value: 0,\n      unit_price_currency: currency,\n      amount_value: 0,\n      amount_currency: currency,\n      remark: \"\",\n      link: \"\"\n    });\n  };\n\n  // ê¸ˆì•¡ ê³„ì‚°\n  const calculateAmount = (index: number) => {\n    const items = getValues(\"items\");\n    const item = items[index];\n    const amount = item.quantity * item.unit_price_value;\n    \n    // update í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ fields ë°°ì—´ ì§ì ‘ ì—…ë°ì´íŠ¸\n    update(index, { ...item, amount_value: amount });\n  };\n\n  // ì—‘ì…€ ë¶™ì—¬ë„£ê¸° í•¸ë“¤ëŸ¬\n  const handlePasteFromExcel = (e: React.ClipboardEvent) => {\n    // ë¶™ì—¬ë„£ê¸° ì´ë²¤íŠ¸ê°€ input ìš”ì†Œ ë‚´ë¶€ì—ì„œ ë°œìƒí–ˆë‹¤ë©´, í•´ë‹¹ inputì˜ ê¸°ë³¸ ë™ì‘ì„ í—ˆìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ,\n    // ì—¬ê¸°ì„œëŠ” ëŒ€ëŸ‰ ë¶™ì—¬ë„£ê¸°ë¥¼ ìœ„í•´ í…Œì´ë¸” ì „ì²´ ë™ì‘ìœ¼ë¡œ ì²˜ë¦¬\n    // ë‹¨, ë‹¨ì¼ ì…€ ë¶™ì—¬ë„£ê¸°(ì§§ì€ í…ìŠ¤íŠ¸)ì¸ ê²½ìš°ëŠ” ì œì™¸í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆìœ¼ë‚˜,\n    // íƒ­ ë¬¸ìê°€ í¬í•¨ë˜ì–´ ìˆê±°ë‚˜ ê°œí–‰ì´ í¬í•¨ëœ ê²½ìš° ì—‘ì…€ ë°ì´í„°ë¡œ ê°„ì£¼\n    \n    const clipboardData = e.clipboardData.getData('text');\n    if (!clipboardData) return;\n    \n    // ì—‘ì…€ ë°ì´í„°ì¸ì§€ í™•ì¸ (íƒ­ì´ë‚˜ ê°œí–‰ì´ í¬í•¨ëœ ê²½ìš°)\n    const isExcelData = clipboardData.includes('\\t') || clipboardData.includes('\\n');\n    if (!isExcelData) return; // ì¼ë°˜ í…ìŠ¤íŠ¸ ë¶™ì—¬ë„£ê¸°ëŠ” ê° inputì˜ ê¸°ë³¸ ë™ì‘ ë”°ë¦„\n\n    e.preventDefault(); // ê¸°ë³¸ ë¶™ì—¬ë„£ê¸° ë°©ì§€\n    e.stopPropagation();\n\n    try {\n      // í–‰ ë¶„ë¦¬\n      const rows = clipboardData.split(/\\r\\n|\\n|\\r/).filter(row => row.trim() !== '');\n      \n      if (rows.length === 0) return;\n\n      const currentItems = getValues(\"items\");\n      \n      // í˜„ì¬ í¬ì»¤ìŠ¤ëœ í–‰ ë° í•„ë“œ ì°¾ê¸°\n      let startIndex = 0;\n      let startFieldName = 'item_name';\n      \n      const activeElement = document.activeElement as HTMLInputElement;\n      let targetInput: HTMLInputElement | null = null;\n      \n      if (activeElement && activeElement.tagName === 'INPUT') {\n        targetInput = activeElement;\n      } else {\n        // fallback\n        const targetElement = e.target as HTMLElement;\n        if (targetElement) {\n          let element: HTMLElement | null = targetElement;\n          while (element && element.tagName !== 'INPUT') {\n            element = element.parentElement;\n            if (element && element.tagName === 'INPUT') {\n              targetInput = element as HTMLInputElement;\n              break;\n            }\n          }\n        }\n      }\n      \n      if (targetInput) {\n        // í–‰ ì¸ë±ìŠ¤ ì°¾ê¸°\n        const rowIndexAttr = targetInput.getAttribute('data-row-index');\n        if (rowIndexAttr !== null) {\n          const parsedIndex = parseInt(rowIndexAttr, 10);\n          if (!isNaN(parsedIndex) && parsedIndex >= 0 && parsedIndex < currentItems.length) {\n            startIndex = parsedIndex;\n          }\n        } else {\n            // data-row-indexê°€ ì—†ìœ¼ë©´ DOM êµ¬ì¡°ë¡œ ì°¾ê¸° (fallback)\n            let parent = targetInput.parentElement;\n            while (parent && parent.tagName !== 'TR') {\n              parent = parent.parentElement;\n            }\n            \n            if (parent && parent.tagName === 'TR') {\n              const tbody = parent.parentElement;\n              if (tbody && tbody.tagName === 'TBODY') {\n                const rowIndex = Array.from(tbody.children).indexOf(parent);\n                if (rowIndex >= 0 && rowIndex < currentItems.length) {\n                  startIndex = rowIndex;\n                }\n              }\n            }\n        }\n        \n        // í•„ë“œëª… ì°¾ê¸°\n        const fieldNameAttr = targetInput.getAttribute('data-field-name');\n        if (fieldNameAttr) {\n          startFieldName = fieldNameAttr;\n        }\n      }\n\n      // í•„ë“œ ìˆœì„œ ì •ì˜ (í™”ë©´ìƒ ìˆœì„œì™€ ì¼ì¹˜í•´ì•¼ í•¨)\n      const FIELDS = [\n        'item_name', \n        'specification', \n        'quantity', \n        'unit_price_value', \n        'amount_value', // ReadOnly (í•©ê³„) - ê±´ë„ˆë›°ê¸°ìš©\n        ...(paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" ? ['link'] : []),\n        'remark'\n      ];\n      \n      const startColIndex = FIELDS.indexOf(startFieldName);\n      if (startColIndex === -1) return; // ìœ íš¨í•˜ì§€ ì•Šì€ í•„ë“œë©´ ì¤‘ë‹¨\n\n      // ì—…ë°ì´íŠ¸í•  ë°ì´í„° ì¤€ë¹„\n      const updatedItems = [...currentItems];\n      let maxRowIndex = currentItems.length - 1;\n\n      // ë¶™ì—¬ë„£ê¸° ë°ì´í„° ì²˜ë¦¬\n      rows.forEach((row, rIndex) => {\n        const columns = row.split('\\t');\n        const targetRowIndex = startIndex + rIndex;\n        \n        // í•„ìš”í•œ ê²½ìš° ìƒˆ í–‰ ë°ì´í„° ì¤€ë¹„\n        if (targetRowIndex > maxRowIndex) {\n          updatedItems.push({\n            line_number: targetRowIndex + 1,\n            item_name: \"\",\n            specification: \"\",\n            quantity: 1,\n            unit_price_value: 0,\n          unit_price_currency: currency,\n            amount_value: 0,\n          amount_currency: currency,\n            remark: \"\",\n            link: \"\",\n          });\n          maxRowIndex++;\n        }\n        \n        // í˜„ì¬ í–‰ ë°ì´í„°\n        const currentItem = updatedItems[targetRowIndex];\n        \n        // ì»¬ëŸ¼ë³„ ë°ì´í„° ë§¤í•‘\n        columns.forEach((colValue, cIndex) => {\n          const targetColIndex = startColIndex + cIndex;\n          \n          // í•„ë“œ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ë©´ ë¬´ì‹œ\n          if (targetColIndex >= FIELDS.length) return;\n          \n          const fieldName = FIELDS[targetColIndex];\n          const cleanValue = colValue.trim();\n          \n          // í•©ê³„(amount_value) í•„ë“œëŠ” ì…ë ¥ ë¶ˆê°€í•˜ë¯€ë¡œ ê±´ë„ˆëœ€ (ë°ì´í„°ê°€ ìˆì–´ë„ ë¬´ì‹œ)\n          if (fieldName === 'amount_value') return;\n\n          // ë°ì´í„° íƒ€ì… ë³€í™˜ ë° í• ë‹¹\n          if (fieldName === 'quantity') {\n             const qty = parseInt(cleanValue.replace(/,/g, '') || '0') || 0;\n             currentItem.quantity = qty;\n          } else if (fieldName === 'unit_price_value') {\n             const price = parseFloat(cleanValue.replace(/,/g, '') || '0') || 0;\n             currentItem.unit_price_value = price;\n          } else if (fieldName === 'link') {\n             currentItem.link = cleanValue;\n          } else if (fieldName === 'remark') {\n             currentItem.remark = cleanValue;\n          } else if (fieldName === 'item_name') {\n             currentItem.item_name = cleanValue;\n          } else if (fieldName === 'specification') {\n             currentItem.specification = cleanValue;\n          }\n        });\n        \n        // ê¸ˆì•¡ ì¬ê³„ì‚° (ìˆ˜ëŸ‰ * ë‹¨ê°€)\n        currentItem.amount_value = currentItem.quantity * currentItem.unit_price_value;\n        \n        // ì—…ë°ì´íŠ¸ëœ í–‰ ì €ì¥\n        updatedItems[targetRowIndex] = currentItem;\n      });\n        \n      // ìƒíƒœ ì—…ë°ì´íŠ¸ (ì „ì²´ ë¦¬ìŠ¤íŠ¸ êµì²´ ë˜ëŠ” ê°œë³„ ì—…ë°ì´íŠ¸)\n      // useFieldArrayì˜ updateë¥¼ ë°˜ë³µ í˜¸ì¶œí•˜ë©´ ì„±ëŠ¥ ì´ìŠˆê°€ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ,\n      // setValueë¡œ ì „ì²´ë¥¼ ì—…ë°ì´íŠ¸í•˜ê±°ë‚˜, ë³€ê²½ëœ í–‰ë§Œ update í˜¸ì¶œ\n      \n      // ë³€ê²½ëœ í–‰ë§Œ update í˜¸ì¶œ (ìµœì í™”)\n      const changedRowCount = Math.min(rows.length + (updatedItems.length - currentItems.length), updatedItems.length - startIndex);\n      \n      // ê¸°ì¡´ í–‰ ì—…ë°ì´íŠ¸\n      for (let i = 0; i < rows.length; i++) {\n        const targetIdx = startIndex + i;\n        if (targetIdx < currentItems.length) {\n          update(targetIdx, updatedItems[targetIdx]);\n        }\n      }\n      \n      // ìƒˆë¡œ ì¶”ê°€ëœ í–‰ ì¶”ê°€ (append)\n      if (updatedItems.length > currentItems.length) {\n        const newRows = updatedItems.slice(currentItems.length);\n        append(newRows);\n      }\n\n      toast.success(`${rows.length}ê°œ í–‰ ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ì—ˆìŠµë‹ˆë‹¤.`);\n      \n    } catch (error) {\n      console.error('Excel paste error:', error);\n      toast.error('ì—‘ì…€ ë°ì´í„° ë¶™ì—¬ë„£ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  // ë³´ë“œ ì„ íƒ ì‹œ í’ˆëª© ìë™ ì±„ìš°ê¸° í•¸ë“¤ëŸ¬\n  const handleBoardSelect = async (selected: { value: string; label: string } | null) => {\n    setSelectedBoard(selected);\n    \n    if (selected) {\n      if (confirm(`\"${selected.label}\"ì˜ BOM ë°ì´í„°ë¡œ í’ˆëª© ëª©ë¡ì„ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?\\n(ê¸°ì¡´ ì…ë ¥ëœ í’ˆëª©ì€ ì‚­ì œë©ë‹ˆë‹¤)`)) {\n        try {\n          const { data: items, error } = await supabase\n            .from('bom_items')\n            .select('*')\n            .eq('cad_drawing_id', selected.value)\n            .order('line_number');\n          \n          if (error) throw error;\n          \n          if (items && items.length > 0) {\n            // BOM ë°ì´í„° ë§¤í•‘\n            const bomRows = items.map((item: any) => ({\n              line_number: item.line_number,\n              item_name: item.item_name,\n              specification: item.specification || '',\n              // SET ìˆ˜ëŸ‰ * ìƒì‚° ìˆ˜ëŸ‰ = ì´ ìˆ˜ëŸ‰\n              quantity: (item.set_count || 0) * productionQuantity,\n              unit_price_value: 0, // ë‹¨ê°€ëŠ” 0ìœ¼ë¡œ ì´ˆê¸°í™”\n              unit_price_currency: currency,\n              amount_value: 0,\n              amount_currency: currency,\n              remark: item.remark || '',\n              link: ''\n            }));\n            \n            // ê¸°ì¡´ í•­ëª© ì „ì²´ êµì²´\n            replace(bomRows);\n            toast.success(`${items.length}ê°œ í’ˆëª©ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);\n          } else {\n            toast.warning('í•´ë‹¹ ë³´ë“œì˜ BOM ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');\n          }\n        } catch (error) {\n          console.error('BOM load error:', error);\n          toast.error('BOM ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n        }\n      }\n    }\n  };\n\n  // ìƒì‚°ìˆ˜ëŸ‰ ë³€ê²½ ì‹œ ìë™ ì¬ê³„ì‚° (ì„ íƒëœ ë³´ë“œê°€ ìˆì„ ë•Œë§Œ)\n  const handleProductionQuantityChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const newQty = parseInt(e.target.value) || 0;\n    setProductionQuantity(newQty);\n    \n    if (selectedBoard && newQty > 0) {\n      // 1ì´ˆ ë”œë ˆì´ í›„ ì¬ê³„ì‚° (íƒ€ì´í•‘ ì¤‘ ë¹ˆë²ˆí•œ ì—…ë°ì´íŠ¸ ë°©ì§€)\n      // í•˜ì§€ë§Œ ì—¬ê¸°ì„œëŠ” ì‚¬ìš©ì ëª…ì‹œì  ì•¡ì…˜ì´ ë‚«ìœ¼ë¯€ë¡œ, ìë™ìœ¼ë¡œ ë°”ê¾¸ì§„ ì•Šê³ \n      // \"ì¬ê³„ì‚°\" ë²„íŠ¼ì„ ë‘ê±°ë‚˜, ë‹¤ì‹œ ë³´ë“œë¥¼ ì„ íƒí•˜ê²Œ í•˜ëŠ”ê²Œ ë‚˜ì„ ìˆ˜ ìˆìŒ.\n      // ì¼ë‹¨ì€ ì‹¬í”Œí•˜ê²Œ ë³´ë“œê°€ ì„ íƒëœ ìƒíƒœì—ì„œ ìˆ˜ëŸ‰ ë°”ê¾¸ë©´ ë‹¤ì‹œ ë¡œë“œí•˜ê² ëƒê³  ë¬¼ì–´ë³´ëŠ”ê±´ ë„ˆë¬´ ê·€ì°®ì„ ìˆ˜ ìˆìœ¼ë‹ˆ\n      // ìˆ˜ëŸ‰ ì…ë ¥ì¹¸ ì˜†ì— [ì ìš©] ë²„íŠ¼ì„ ë‘ëŠ”ê²Œ ì¢‹ê² ìŒ.\n    }\n  };\n\n  // ìˆ˜ëŸ‰ ì ìš© ë²„íŠ¼ í•¸ë“¤ëŸ¬\n  const handleApplyQuantity = () => {\n    if (!selectedBoard) {\n      toast.error('ë¨¼ì € ë³´ë“œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');\n      return;\n    }\n    \n    // í˜„ì¬ ë¦¬ìŠ¤íŠ¸ì— ìˆëŠ” í•­ëª©ë“¤ì˜ ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸\n    // (ë‹¨, BOMì—ì„œ ê°€ì ¸ì˜¨ í•­ëª©ì´ë¼ëŠ” ë³´ì¥ì´ ì—†ìœ¼ë¯€ë¡œ, ë‹¤ì‹œ DBì—ì„œ ê°€ì ¸ì˜¤ëŠ”ê²Œ ì•ˆì „)\n    handleBoardSelect(selectedBoard);\n  };\n\n  // ì „ì²´ ê¸ˆì•¡ ê³„ì‚°\n  const getTotalAmount = () => {\n    const items = getValues(\"items\");\n    return items.reduce((sum, item) => sum + item.amount_value, 0);\n  };\n\n  // í•„ìˆ˜ í•­ëª© ì²´í¬ í•¨ìˆ˜\n  const checkRequiredFields = () => {\n    const templateType = watch('po_template_type');\n    if (!templateType) return false;\n    \n    if (templateType === 'ë°œì£¼/êµ¬ë§¤') {\n      const requestType = watch('request_type');\n      const progressType = watch('progress_type');\n      const paymentCategory = watch('payment_category');\n      const vendorId = watch('vendor_id');\n      return !!(requestType && progressType && paymentCategory && vendorId && vendorId !== 0 && fields.length > 0);\n    }\n    \n    return true;\n  };\n\n  // ì‹¤ì‹œê°„ í•„ìˆ˜í•­ëª© ì²´í¬ë¥¼ ìœ„í•œ state\n  const [isFormValid, setIsFormValid] = useState(false);\n\n  // í•„ìˆ˜í•­ëª© ë³€ê²½ ê°ì§€\n  useEffect(() => {\n    setIsFormValid(checkRequiredFields());\n  }, [watch('po_template_type'), watch('request_type'), watch('progress_type'), watch('payment_category'), watch('vendor_id'), fields]);\n\n  // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„± í•¨ìˆ˜ (ì¬ì‹œë„ ë¡œì§ í¬í•¨)\n  const generatePurchaseOrderNumber = async () => {\n    const today = new Date();\n    // í•œêµ­ ì‹œê°„ëŒ€(UTC+9) ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ìƒì„±\n    const koreaTime = new Date(today.getTime() + (9 * 60 * 60 * 1000));\n    const dateStr = koreaTime.toISOString().slice(0, 10).replace(/-/g, ''); // YYYYMMDD\n    const prefix = `F${dateStr}_`;\n    \n    // ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì‹œì‘í•˜ëŠ” ë°œì£¼ìš”ì²­ë²ˆí˜¸ë“¤ ì¡°íšŒ (ìœ íš¨í•œ ìˆ«ì í˜•ì‹ë§Œ)\n    const { data: existingOrders, error: queryError } = await supabase\n      .from('purchase_requests')\n      .select('purchase_order_number')\n      .like('purchase_order_number', `${prefix}%`)\n      .order('purchase_order_number', { ascending: false });\n    \n    if (queryError) {\n      console.error('ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¡°íšŒ ì‹¤íŒ¨', queryError)\n      throw queryError\n    }\n    \n    // ë‹¤ìŒ ìˆœë²ˆ ê³„ì‚° (ìˆ«ìì¸ ì‹œí€€ìŠ¤ë§Œ ì°¾ê¸°)\n    let nextNumber = 1;\n    let maxSequence = 0;\n    \n    if (existingOrders && existingOrders.length > 0) {\n      // ëª¨ë“  ë°œì£¼ìš”ì²­ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì—¬ ê°€ì¥ í° ìœ íš¨í•œ ìˆ«ì ì‹œí€€ìŠ¤ ì°¾ê¸°\n      for (const order of existingOrders) {\n        const orderNumber = order.purchase_order_number;\n        \n        // ë°œì£¼ìš”ì²­ë²ˆí˜¸ í˜•ì‹: F20250612_001\n        const parts = orderNumber.split('_');\n        if (parts.length >= 2) {\n          const sequenceStr = parts[1];\n          const sequence = parseInt(sequenceStr, 10);\n          \n          // ìœ íš¨í•œ ìˆ«ìì´ê³  í˜„ì¬ ìµœëŒ€ê°’ë³´ë‹¤ í¬ë©´ ì—…ë°ì´íŠ¸\n          if (!isNaN(sequence) && sequence > maxSequence) {\n            maxSequence = sequence;\n          }\n        }\n      }\n      \n      nextNumber = maxSequence + 1;\n    }\n    \n    // 3ìë¦¬ íŒ¨ë”©ìœ¼ë¡œ ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±\n    const safeNextNumber = isNaN(nextNumber) ? 1 : nextNumber;\n    const purchaseOrderNumber = `${prefix}${String(safeNextNumber).padStart(3, '0')}`;\n    \n    return purchaseOrderNumber;\n  };\n\n  // í¼ ì œì¶œ\n  const handleSubmit = async (data: FormValues) => {\n    const currentEmployee = employees.find(emp => emp.name === data.requester_name);\n    \n    if (isSubmittingRef.current) {\n      return;\n    }\n\n    if (!currentEmployee) {\n      setError(\"êµ¬ë§¤ìš”ì²­ì ì´ë¦„ì— í•´ë‹¹í•˜ëŠ” ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤. ì´ë¦„ì„ ì •í™•íˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.\");\n      return;\n    }\n    \n    // í•„ìˆ˜ í•­ëª©ì´ ëª¨ë‘ ì±„ì›Œì ¸ ìˆëŠ”ì§€ ì¬í™•ì¸\n    if (!checkRequiredFields()) {\n      return; // ë²„íŠ¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ì•¼ í•˜ë¯€ë¡œ ë³„ë„ ì˜¤ë¥˜ ë©”ì‹œì§€ ì—†ì´ ê·¸ëƒ¥ ë¦¬í„´\n    }\n\n    isSubmittingRef.current = true;\n    setLoading(true);\n    setError(\"\");\n    \n    try {\n\n      let prId: number = 0;\n      let purchaseOrderNumber: string = '';\n      const maxRetries = 5;\n      let retryCount = 0;\n\n      // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•œ ì¬ì‹œë„ ë¡œì§\n      while (retryCount < maxRetries) {\n        try {\n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìë™ ìƒì„±\n          purchaseOrderNumber = await generatePurchaseOrderNumber();\n\n          // êµ¬ë§¤ìš”ì²­ ë“±ë¡ ì‹œë„\n          const { data: pr, error: prError } = await supabase.from(\"purchase_requests\").insert({\n            requester_id: currentEmployee.id,\n            purchase_order_number: purchaseOrderNumber,\n            requester_name: data.requester_name,\n            requester_phone: currentEmployee?.phone,\n            requester_fax: null,\n            requester_address: currentEmployee?.address,\n            vendor_id: data.vendor_id,\n            sales_order_number: data.sales_order_number,\n            project_vendor: data.project_vendor,\n            project_item: data.project_item,\n            request_date: data.request_date,\n            delivery_request_date: data.delivery_request_date || null,\n            request_type: data.request_type,\n            progress_type: data.progress_type,\n            is_payment_completed: false,\n            payment_category: data.payment_category,\n            currency: currency,\n            total_amount: fields.reduce((sum, i) => sum + i.amount_value, 0),\n            unit_price_currency: fields[0]?.unit_price_currency || currency,\n            po_template_type: data.po_template_type,\n            contact_id: data.contact_id ? Number(data.contact_id) : null,\n          }).select(\"id\").single();\n          \n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ì—ëŸ¬ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì—ëŸ¬ëŠ” ë°”ë¡œ throw\n          if (prError && !prError.message.includes('duplicate key value violates unique constraint')) {\n            throw prError;\n          }\n          \n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µ ì—ëŸ¬ì¸ ê²½ìš°\n          if (prError && prError.message.includes('duplicate key value violates unique constraint')) {\n            retryCount++;\n            if (retryCount >= maxRetries) {\n              throw new Error(`ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±ì— ${maxRetries}ë²ˆ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);\n            }\n            // ì¬ì‹œë„ë¥¼ ìœ„í•´ ì§§ì€ ëŒ€ê¸°\n            await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n            continue;\n          }\n          \n          // ì„±ê³µí•œ ê²½ìš°\n          if (!pr) throw new Error(\"ë“±ë¡ ì‹¤íŒ¨\");\n          prId = pr.id;\n          break; // ì„±ê³µ ì‹œ ë£¨í”„ ì¢…ë£Œ\n          \n        } catch (retryError: any) {\n          // ë°œì£¼ìš”ì²­ë²ˆí˜¸ ì¤‘ë³µì´ ì•„ë‹Œ ì—ëŸ¬ëŠ” ë°”ë¡œ throw\n          if (!retryError.message.includes('duplicate key value violates unique constraint')) {\n            throw retryError;\n          }\n          \n          retryCount++;\n          if (retryCount >= maxRetries) {\n            throw new Error(`ë°œì£¼ìš”ì²­ë²ˆí˜¸ ìƒì„±ì— ${maxRetries}ë²ˆ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);\n          }\n          \n          // ì¬ì‹œë„ë¥¼ ìœ„í•´ ì§§ì€ ëŒ€ê¸° (100-300ms ëœë¤)\n          await new Promise(resolve => setTimeout(resolve, 100 + Math.random() * 200));\n        }\n      }\n\n      // í’ˆëª©ë“¤ ì €ì¥ - ë°°ì—´ ìˆœì„œ ê·¸ëŒ€ë¡œ ì €ì¥ (ì—‘ì…€ ë¶™ì—¬ë„£ê¸° ìˆœì„œ ìœ ì§€)\n      for (const [idx, item] of fields.entries()) {\n        const { error: itemErr } = await supabase.from(\"purchase_request_items\").insert({\n          purchase_request_id: prId,\n          line_number: idx + 1, // ë°°ì—´ ìˆœì„œëŒ€ë¡œ 1, 2, 3... ì„¤ì •\n          item_name: item.item_name,\n          specification: item.specification,\n          quantity: item.quantity,\n          unit_price_value: item.unit_price_value,\n          unit_price_currency: currency,\n          amount_value: item.amount_value,\n          amount_currency: currency,\n          remark: item.remark,\n          link: item.link || null,\n        });\n        if (itemErr) throw itemErr;\n      }\n      \n      // ë°œì£¼ìš”ì²­ ì„±ê³µ ì²˜ë¦¬\n      \n      // ğŸ“¨ ì¤‘ê°„ê´€ë¦¬ì DM ì•Œë¦¼ ë°œì†¡ (í’ˆëª© ì¶”ê°€ ì™„ë£Œ í›„ ì •í™•í•œ ê°œìˆ˜ë¡œ)\n      try {\n        const notifyResponse = await fetch(`/api/purchase/${prId}/notify-middle-manager`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n        \n        if (notifyResponse.ok) {\n          const notifyResult = await notifyResponse.json();\n        } else {\n          const errorText = await notifyResponse.text();\n        }\n      } catch (notifyError) {\n        console.error('ì¤‘ê°„ê´€ë¦¬ì ì•Œë¦¼ ë°œì†¡ ì‹¤íŒ¨', notifyError)\n      }\n      \n      // 1. í¼ ì´ˆê¸°í™”\n      reset({\n        progress_type: \"\",\n        payment_category: \"\",\n        currency: \"KRW\",\n        po_template_type: \"\",\n        request_type: \"\",\n        contacts: [],\n        sales_order_number: '',\n        project_vendor: '',\n        project_item: '',\n        delivery_request_date: '',\n        vendor_id: 0,\n        requester_name: employeeName, // ìš”ì²­ì ì´ë¦„ì€ ìœ ì§€\n        items: [\n          {\n            line_number: 1,\n            item_name: \"\",\n            specification: \"\",\n            quantity: 1,\n            unit_price_value: 0,\n            unit_price_currency: \"KRW\",\n            amount_value: 0,\n            amount_currency: \"KRW\",\n            remark: \"\",\n            link: \"\",\n          },\n        ],\n        request_date: new Date().toISOString().slice(0, 10),\n      });\n      \n      // 2. ìƒíƒœ ì´ˆê¸°í™”\n      setVendor(\"\");\n      setSelectedContacts([]);\n      setCurrency(\"KRW\");\n      setError(\"\");\n      setLoading(false);\n      \n      // 3. ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ\n      toast.success(\"ë°œì£¼ìš”ì²­ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n      \n      // 4. ë©”ëª¨ë¦¬ ìºì‹œ ë¬´íš¨í™” ë° ì¦‰ì‹œ ìƒˆë¡œê³ ì¹¨ ì‹œë„ (íƒ­ ì´ë™ ì „ ìµœì‹ í™”)\n      invalidatePurchaseMemoryCache() // ìºì‹œ ë¬´íš¨í™”ë¡œ ë‹¤ìŒ ë¡œë“œ ì‹œ ìƒˆë¡œê³ ì¹¨\n      try {\n        await loadAllPurchaseData(String(currentEmployee.id))\n      } catch (refreshError) {\n        console.error('ìƒˆ ë°œì£¼ ìƒì„± í›„ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨', refreshError)\n      } finally {\n        markCacheStaleAndNotify() // êµ¬ë…ìì—ê²Œ ìºì‹œ ë³€ê²½ ì•Œë¦¼ + lastFetch ë¬´íš¨í™”\n      }\n      isSubmittingRef.current = false\n      \n      // 5. ë°œì£¼ìš”ì²­ ê´€ë¦¬ í˜ì´ì§€ì˜ ìŠ¹ì¸ëŒ€ê¸° íƒ­ìœ¼ë¡œ ì´ë™\n      try {\n        await navigate('/purchase/list?tab=pending');\n      } catch (routerError) {\n        // ëŒ€ì²´ ë¼ìš°íŒ… ë°©ë²•\n        window.location.href = '/purchase/list?tab=pending';\n      }\n      return;\n    } catch (err: any) {\n      setError(err.message || \"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n      toast.error(err.message || \"ë°œì£¼ìš”ì²­ì„œ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n    } finally {\n      // ì˜¤ë¥˜ê°€ ìˆì—ˆì„ ë•Œë§Œ ì‹¤í–‰ë¨ (ì„±ê³µ ì‹œì—ëŠ” returnìœ¼ë¡œ ë¹ ì§)\n      setLoading(false);\n      isSubmittingRef.current = false;\n    }\n  };\n\n  const totalAmount = fields.reduce((sum, item) => sum + item.amount_value, 0);\n\n  const openContactsManager = () => {\n    // ê¸°ì¡´ ë‹´ë‹¹ìë“¤ì„ ë³µì‚¬í•˜ê³  ìƒˆë¡œìš´ ë‹´ë‹¹ì ì¶”ê°€ë¥¼ ìœ„í•œ ë¹ˆ ìŠ¬ë¡¯ë„ ì¶”ê°€\n    const existingContacts = contacts.map(c => ({ ...c, isNew: false }));\n    const newEmptyContact = { contact_name: '', contact_email: '', contact_phone: '', position: '', isNew: true };\n    setContactsForEdit([...existingContacts, newEmptyContact]);\n    setHasChanges(false);\n    setIsContactDialogOpen(true);\n  };\n\n  const handleContactChange = (index: number, field: string, value: string) => {\n    setContactsForEdit(prev => prev.map((contact, i) => \n      i === index ? { ...contact, [field]: value } : contact\n    ));\n    setHasChanges(true);\n  };\n\n  const addNewContactSlot = () => {\n    setContactsForEdit(prev => [...prev, { contact_name: '', contact_email: '', contact_phone: '', position: '', isNew: true }]);\n    setHasChanges(true);\n  };\n\n  const removeContactSlot = (index: number) => {\n    setContactsForEdit(prev => prev.filter((_, i) => i !== index));\n    setHasChanges(true);\n  };\n\n  const handleSaveAllContacts = async () => {\n    if (!selectedVendor) return;\n    \n    try {\n      // @hanslë¡œ ëë‚˜ëŠ” ì´ë©”ì¼ ì²´í¬\n      const hanslEmails = contactsForEdit.filter(c => c.contact_email && c.contact_email.endsWith('@hansl.io'));\n      if (hanslEmails.length > 0) {\n        alert('í•œìŠ¬ ì§ì› ì´ë©”ì¼ì€ ì—…ì²´ ë‹´ë‹¹ìë¡œ ë“±ë¡í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n        return;\n      }\n\n      // ì‚­ì œëœ ë‹´ë‹¹ì ì²˜ë¦¬: ê¸°ì¡´ contactsì— ìˆì—ˆì§€ë§Œ contactsForEditì— ì—†ëŠ” í•­ëª©ë“¤ ì‚­ì œ\n      const editContactIds = contactsForEdit\n        .filter(c => !c.isNew && c.id)\n        .map(c => c.id);\n      const deletedContacts = contacts.filter(c => c.id && !editContactIds.includes(c.id));\n      \n      const failedDeletes: string[] = [];\n      for (const deleted of deletedContacts) {\n        if (deleted.id) {\n          const { error: deleteError } = await supabase\n            .from('vendor_contacts')\n            .delete()\n            .eq('id', deleted.id);\n          \n          if (deleteError) {\n            // ì™¸ë˜ í‚¤ ì œì•½ì¡°ê±´ ì˜¤ë¥˜ (ì´ ë‹´ë‹¹ìê°€ ë°œì£¼ì— ì—°ê²°ë˜ì–´ ìˆìŒ)\n            failedDeletes.push(deleted.contact_name || `ID:${deleted.id}`);\n          }\n        }\n      }\n      \n      if (failedDeletes.length > 0) {\n        toast.error(`ë‹¤ìŒ ë‹´ë‹¹ìëŠ” ë°œì£¼ì— ì—°ê²°ë˜ì–´ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${failedDeletes.join(', ')}`);\n      }\n\n      // ì´ë¦„ë§Œ ìˆê³  ì´ë©”ì¼ì´ ë¹„ì–´ìˆëŠ” ë‹´ë‹¹ìê°€ ìˆëŠ”ì§€ ì²´í¬\n      const incompleteContacts = contactsForEdit.filter(c => \n        c.contact_name && c.contact_name.trim() && (!c.contact_email || !c.contact_email.trim())\n      );\n      if (incompleteContacts.length > 0) {\n        toast.error('ë‹´ë‹¹ìì˜ ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');\n        return;\n      }\n\n      for (const contact of contactsForEdit) {\n        if (contact.contact_name && contact.contact_email) {\n          if (!contact.isNew && contact.id) {\n            // ê¸°ì¡´ ë‹´ë‹¹ì ì—…ë°ì´íŠ¸\n            const { error: updateError } = await supabase\n              .from('vendor_contacts')\n              .update({\n                contact_name: contact.contact_name,\n                contact_email: contact.contact_email,\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              })\n              .eq('id', contact.id);\n            \n            if (updateError) {\n              console.error('ë‹´ë‹¹ì ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', updateError);\n            }\n          } else if (contact.isNew) {\n            // ìƒˆë¡œìš´ ë‹´ë‹¹ì ì¶”ê°€\n            const { error: insertError } = await supabase\n              .from('vendor_contacts')\n              .insert({\n                vendor_id: selectedVendor,\n                contact_name: contact.contact_name,\n                contact_email: contact.contact_email,\n                contact_phone: contact.contact_phone || '',\n                position: contact.position || ''\n              });\n            \n            if (insertError) {\n              console.error('ë‹´ë‹¹ì ì¶”ê°€ ì˜¤ë¥˜:', insertError);\n              toast.error(`ë‹´ë‹¹ì ì¶”ê°€ ì‹¤íŒ¨: ${insertError.message}`);\n            }\n          }\n        }\n      }\n      \n      // ë‹´ë‹¹ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      const { data } = await supabase\n        .from('vendor_contacts')\n        .select('id, contact_name, contact_email, contact_phone, position')\n        .eq('vendor_id', selectedVendor);\n      \n      if (data) setContacts(data);\n      setIsContactDialogOpen(false);\n      toast.success('ë‹´ë‹¹ì ì •ë³´ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      toast.error('ë‹´ë‹¹ì ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleDeleteContact = async (contactId: number) => {\n    if (!confirm('ì •ë§ ì´ ë‹´ë‹¹ìë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;\n    \n    try {\n      await supabase\n        .from('vendor_contacts')\n        .delete()\n        .eq('id', contactId);\n      \n      // ë‹´ë‹¹ì ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n      const { data } = await supabase\n        .from('vendor_contacts')\n        .select('id, contact_name, contact_email, contact_phone, position')\n        .eq('vendor_id', selectedVendor);\n      \n      if (data) setContacts(data);\n      toast.success('ë‹´ë‹¹ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      toast.error('ë‹´ë‹¹ì ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const paymentCategory = watch('payment_category');\n\n  return (\n    <form \n      onSubmit={(e) => {\n        e.preventDefault();\n        rhHandleSubmit(handleSubmit)(e);\n      }}\n      onKeyDown={e => {\n        if (e.key === 'Enter' || e.keyCode === 13) {\n          e.preventDefault();\n        }\n      }}\n    >\n      <div className=\"flex flex-col lg:flex-row gap-4 lg:gap-6 items-start\">\n        {/* ë°œì£¼ ê¸°ë³¸ ì •ë³´ - ëª¨ë°”ì¼: ì „ì²´ í­, ë°ìŠ¤í¬í†±: 280px ê³ ì • */}\n        <div className=\"w-full lg:w-[280px] lg:min-w-[280px] lg:flex-shrink-0 relative bg-muted/20 border border-border rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-3 lg:p-4 space-y-2.5\">\n          {/* í—¤ë”: í…œí”Œë¦¿ì— ë”°ë¼ ì œëª© ë³€ê²½ */}\n          <div className=\"flex flex-col\">\n            <h4 className=\"font-semibold text-foreground text-sm\">\n              {{'ë°œì£¼/êµ¬ë§¤': 'ë°œì£¼/êµ¬ë§¤ ìš”ì²­ ì •ë³´', 'ì¹´ë“œì‚¬ìš©': 'ì¹´ë“œì‚¬ìš© ìš”ì²­ ì •ë³´', 'ì¶œì¥': 'ì¶œì¥ ìš”ì²­ ì •ë³´', 'ì°¨ëŸ‰': 'ì°¨ëŸ‰ ìš”ì²­ ì •ë³´'}[watch('po_template_type')] || 'ìš”ì²­ ì •ë³´'}\n            </h4>\n            <p className=\"text-[10px] text-muted-foreground\">\n              {{'ë°œì£¼/êµ¬ë§¤': 'Purchase Request', 'ì¹´ë“œì‚¬ìš©': 'Card Usage Request', 'ì¶œì¥': 'Business Trip Request', 'ì°¨ëŸ‰': 'Vehicle Request'}[watch('po_template_type')] || 'Request Information'}\n            </p>\n          </div>\n\n          {/* í…œí”Œë¦¿ ì„ íƒ */}\n          <div>\n            <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">í…œí”Œë¦¿<span className=\"text-red-500 ml-0.5\">*</span></Label>\n            <Select value={watch('po_template_type') || undefined} onValueChange={(value) => setValue('po_template_type', value)}>\n              <SelectTrigger className={`!h-7 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200 [&>svg]:hidden ${!watch('po_template_type') ? 'text-gray-400' : ''}`}>\n                <SelectValue placeholder=\"ì„ íƒ\" />\n              </SelectTrigger>\n              <SelectContent position=\"popper\" className=\"z-[9999]\">\n                <SelectItem value=\"ë°œì£¼/êµ¬ë§¤\">ë°œì£¼/êµ¬ë§¤</SelectItem>\n                <SelectItem value=\"ì¹´ë“œì‚¬ìš©\">ì¹´ë“œì‚¬ìš©</SelectItem>\n                <SelectItem value=\"ì¶œì¥\">ì¶œì¥</SelectItem>\n                <SelectItem value=\"ì°¨ëŸ‰\">ì°¨ëŸ‰</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* ë³´ë“œëª… - ë°œì£¼/êµ¬ë§¤ì—ì„œë§Œ í‘œì‹œ */}\n          {watch('po_template_type') === 'ë°œì£¼/êµ¬ë§¤' && (\n          <div className=\"grid grid-cols-2 gap-1.5 sm:gap-2\">\n            <div>\n              <div className=\"flex items-center gap-1 mb-0.5\">\n                <Label className=\"text-[10px] sm:text-xs\">ë³´ë“œëª…</Label>\n                {selectedBoard && (\n                  <span\n                    className=\"text-[9px] text-blue-600 cursor-pointer hover:underline\"\n                    onClick={() => setSelectedBoard(null)}\n                  >\n                    ì´ˆê¸°í™”\n                  </span>\n                )}\n              </div>\n              <div className=\"flex items-center gap-1\">\n                <ReactSelect\n                  options={boards.map(b => ({ value: b.id, label: b.board_name }))}\n                  value={selectedBoard}\n                  onChange={handleBoardSelect}\n                  placeholder=\"ì„ íƒ\"\n                  isClearable\n                  isSearchable\n                  className=\"text-xs flex-1\"\n                  menuPortalTarget={document.body}\n                  styles={{\n                    control: (base) => ({\n                      ...base,\n                      minHeight: '28px',\n                      height: '28px',\n                      fontSize: '0.75rem',\n                      backgroundColor: '#fff',\n                      borderColor: '#d2d2d7',\n                      borderRadius: '6px',\n                      boxShadow: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n                      '&:hover': {\n                        borderColor: '#d2d2d7',\n                        boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'\n                      }\n                    }),\n                    valueContainer: (base) => ({ ...base, padding: '0 6px' }),\n                    menuPortal: (base) => ({ ...base, zIndex: 9999 }),\n                    menu: (base) => ({ \n                      ...base, \n                      zIndex: 9999, \n                      fontSize: '0.75rem',\n                      minWidth: '160px',\n                      width: 'auto',\n                      whiteSpace: 'nowrap'\n                    }),\n                    option: (base) => ({ ...base, padding: '4px 8px', whiteSpace: 'nowrap' }),\n                    placeholder: (base) => ({ ...base, color: '#9ca3af' }),\n                    dropdownIndicator: () => ({ display: 'none' }),\n                    clearIndicator: (base) => ({ ...base, padding: '2px' }),\n                    indicatorSeparator: () => ({ display: 'none' })\n                  }}\n                />\n                {selectedBoard && (\n                  <>\n                    <Input\n                      type=\"number\"\n                      min=\"1\"\n                      value={productionQuantity}\n                      onChange={handleProductionQuantityChange}\n                      className=\"h-7 w-12 text-center text-xs bg-white border border-[#d2d2d7] rounded-md shadow-sm hover:shadow-md transition-shadow duration-200\"\n                      placeholder=\"ìˆ˜ëŸ‰\"\n                    />\n                    <Button \n                      type=\"button\" \n                      size=\"sm\" \n                      variant=\"outline\" \n                      onClick={handleApplyQuantity}\n                      className=\"h-7 px-2 text-[10px] border-[#d2d2d7] hover:bg-gray-50\"\n                    >\n                      ì ìš©\n                    </Button>\n                  </>\n                )}\n              </div>\n            </div>\n          </div>\n          )}\n              \n          {watch('po_template_type') === 'ë°œì£¼/êµ¬ë§¤' && (\n            <div className=\"space-y-2.5\">\n              \n              {/* ìš”ì²­ ì„¤ì • */}\n              <div className=\"grid grid-cols-3 gap-1.5 sm:gap-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ìš”ì²­ ìœ í˜•<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <Select value={watch('request_type')} onValueChange={(value) => setValue('request_type', value)}>\n                    <SelectTrigger className=\"!h-7 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200 [&>svg]:hidden\">\n                      <SelectValue placeholder=\"ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      <SelectItem value=\"ì›ìì¬\">ì›ìì¬</SelectItem>\n                      <SelectItem value=\"ì†Œëª¨í’ˆ\">ì†Œëª¨í’ˆ</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì§„í–‰ ì¢…ë¥˜<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <Select value={watch('progress_type')} onValueChange={(value) => setValue('progress_type', value)}>\n                    <SelectTrigger className=\"!h-7 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200 [&>svg]:hidden\">\n                      <SelectValue placeholder=\"ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      <SelectItem value=\"ì¼ë°˜\">ì¼ë°˜</SelectItem>\n                      <SelectItem value=\"ì„ ì§„í–‰\">ì„ ì§„í–‰</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ê²°ì œ ì¢…ë¥˜<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <Select value={watch('payment_category')} onValueChange={(value) => setValue('payment_category', value)}>\n                    <SelectTrigger className=\"!h-7 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200 [&>svg]:hidden\">\n                      <SelectValue placeholder=\"ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      <SelectItem value=\"êµ¬ë§¤ ìš”ì²­\">êµ¬ë§¤ ìš”ì²­</SelectItem>\n                      <SelectItem value=\"ë°œì£¼\">ë°œì£¼</SelectItem>\n                      <SelectItem value=\"í˜„ì¥ ê²°ì œ\">í˜„ì¥ ê²°ì œ</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {/* ì—…ì²´ ì •ë³´ */}\n              <div className=\"grid grid-cols-2 gap-1.5 sm:gap-2 lg:grid-cols-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì—…ì²´ëª…<span className=\"text-red-500 ml-0.5\">*</span></Label>\n                  <ReactSelect\n                      options={vendors.map(v => ({ value: v.id.toString(), label: v.vendor_name }))}\n                      value={vendors.find(v => v.id.toString() === vendor) ? { value: vendor, label: vendors.find(v => v.id.toString() === vendor)?.vendor_name } : null}\n                      onChange={(option) => {\n                        const opt = option as { value: string; label: string } | null;\n                        if (opt) {\n                          setVendor(opt.value);\n                          setValue('vendor_id', Number(opt.value));\n                        } else {\n                          setVendor('');\n                          setValue('vendor_id', 0);\n                        }\n                      }}\n                      placeholder=\"ì—…ì²´ ì„ íƒ\"\n                      isClearable={false}\n                      isSearchable\n                      closeMenuOnSelect={false}\n                      classNamePrefix=\"vendor-select\"\n                      blurInputOnSelect={false}\n                      openMenuOnFocus={false}\n                      openMenuOnClick={true}\n                      tabSelectsValue={false}\n                      captureMenuScroll={false}\n                      pageSize={20}\n                      styles={{\n                        container: base => ({ ...base, width: '100%' }),\n                        control: base => ({ \n                          ...base, \n                          height: '28px !important',\n                          minHeight: '28px !important',\n                          maxHeight: '28px !important',\n                          background: '#fff',\n                          border: '1px solid #d2d2d7',\n                          borderRadius: '6px',\n                          fontSize: '0.75rem',\n                          boxShadow: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n                          padding: '0 !important',\n                          margin: '0 !important',\n                          alignItems: 'center',\n                          display: 'flex',\n                          position: 'relative',\n                          verticalAlign: 'top',\n                          lineHeight: '1',\n                          '&:hover': { \n                            boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)' \n                          }\n                        }),\n                        valueContainer: base => ({ \n                          ...base, \n                          height: '28px !important',\n                          minHeight: '28px !important',\n                          maxHeight: '28px !important',\n                          padding: '0 8px !important',\n                          margin: '0 !important',\n                          fontSize: '0.75rem',\n                          alignItems: 'center',\n                          display: 'flex',\n                          lineHeight: '1',\n                          justifyContent: 'flex-start'\n                        }),\n                        input: base => ({ \n                          ...base, \n                          margin: '0 !important', \n                          padding: '0 !important', \n                          fontSize: '0.75rem',\n                          lineHeight: '28px'\n                        }),\n                        singleValue: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '28px'\n                        }),\n                        placeholder: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '28px',\n                          color: '#9ca3af'\n                        }),\n                        indicatorsContainer: base => ({ \n                          ...base, \n                          height: '28px !important',\n                          padding: '0 4px !important',\n                          alignItems: 'center',\n                          display: 'flex'\n                        }),\n                        indicatorSeparator: () => ({ display: 'none' }),\n                        dropdownIndicator: () => ({ display: 'none' }),\n                        clearIndicator: base => ({ ...base, padding: '2px !important' }),\n                        menuPortal: base => ({ ...base, zIndex: 1400 }),\n                        option: base => ({ ...base, padding: '4px 8px' })\n                      }}\n                    />\n                </div>\n                <div>\n                  <div className=\"flex items-center justify-between mb-0.5\">\n                    <Label className=\"text-[10px] sm:text-xs\">ì—…ì²´ ë‹´ë‹¹ì</Label>\n                    <span\n                      className=\"text-primary text-[9px] sm:text-[10px] cursor-pointer hover:underline select-none flex items-center\"\n                      onClick={openContactsManager}\n                    >\n                      <span className=\"-translate-y-px\">+</span><span className=\"ml-0.5\">ì¶”ê°€/ìˆ˜ì •</span>\n                    </span>\n                  </div>\n                  <Select\n                    value={watch('contacts')[0] || ''}\n                    onValueChange={val => {\n                      setValue('contacts', [val]);\n                      setValue('contact_id', val ? Number(val) : undefined);\n                    }}\n                  >\n                    <SelectTrigger className=\"!h-7 !py-0 !leading-none bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md transition-shadow duration-200 [&>svg]:hidden\">\n                      <SelectValue placeholder=\"ë‹´ë‹¹ì ì„ íƒ\" />\n                    </SelectTrigger>\n                    <SelectContent position=\"popper\" className=\"z-[9999]\">\n                      {contacts.map(c => (\n                        <SelectItem key={c.id} value={c.id.toString()}>\n                          {c.contact_name || c.contact_email || c.contact_phone || c.position || ''}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              {/* êµ¬ë§¤ìš”êµ¬ì ë° ì¼ì • ì •ë³´ */}\n              <div className=\"grid grid-cols-3 gap-1.5 sm:gap-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">êµ¬ë§¤ìš”êµ¬ì</Label>\n                  <ReactSelect\n                      key={`employee-select-${employeeName}`}\n                      value={employeeName ? { value: employeeName, label: employeeName } : null}\n                      defaultValue={employeeName ? { value: employeeName, label: employeeName } : null}\n                      onChange={(selectedOption) => {\n                        const value = (selectedOption as EmployeeOption)?.value || \"\";\n                        setValue('requester_name', value);\n                        setEmployeeName(value);\n                      }}\n                      options={employees.map(employee => ({\n                        value: employee.name,\n                        label: employee.name\n                      }))}\n                      placeholder=\"ì„ íƒ\"\n                      isSearchable\n                      isClearable={false}\n                      noOptionsMessage={() => \"ì¼ì¹˜í•˜ëŠ” ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤\"}\n                      filterOption={(option, inputValue) => {\n                        const employee = employees.find(emp => emp.name === option.value);\n                        const searchText = `${employee?.name || ''} ${employee?.position || ''} ${employee?.email || ''}`.toLowerCase();\n                        return searchText.includes(inputValue.toLowerCase());\n                      }}\n                      styles={{\n                        control: (base) => ({\n                          ...base,\n                          height: '28px !important',\n                          minHeight: '28px !important',\n                          maxHeight: '28px !important',\n                          background: '#fff',\n                          border: '1px solid #d2d2d7',\n                          borderRadius: '6px',\n                          fontSize: '0.75rem',\n                          boxShadow: '0 1px 2px 0 rgb(0 0 0 / 0.05)',\n                          padding: '0 !important',\n                          margin: '0 !important',\n                          alignItems: 'center',\n                          display: 'flex',\n                          position: 'relative',\n                          verticalAlign: 'top',\n                          lineHeight: '1',\n                          '&:hover': {\n                            borderColor: '#d2d2d7',\n                            boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1)'\n                          }\n                        }),\n                        valueContainer: (base) => ({\n                          ...base,\n                          height: '28px !important',\n                          minHeight: '28px !important',\n                          maxHeight: '28px !important',\n                          padding: '0 8px !important',\n                          margin: '0 !important',\n                          fontSize: '0.75rem',\n                          alignItems: 'center',\n                          display: 'flex',\n                          lineHeight: '28px',\n                          justifyContent: 'flex-start',\n                          overflow: 'visible'\n                        }),\n                        input: (base) => ({ \n                          ...base, \n                          margin: '0 !important', \n                          padding: '0 !important', \n                          fontSize: '0.75rem',\n                          lineHeight: '28px'\n                        }),\n                        singleValue: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '28px',\n                          overflow: 'visible',\n                          textOverflow: 'clip',\n                          whiteSpace: 'nowrap'\n                        }),\n                        placeholder: base => ({\n                          ...base,\n                          margin: '0 !important',\n                          padding: '0 !important',\n                          fontSize: '0.75rem',\n                          lineHeight: '28px',\n                          color: '#9ca3af'\n                        }),\n                        indicatorsContainer: (base) => ({ \n                          ...base, \n                          height: '28px !important',\n                          padding: '0 4px !important',\n                          alignItems: 'center',\n                          display: 'flex'\n                        }),\n                        indicatorSeparator: () => ({ display: 'none' }),\n                        dropdownIndicator: () => ({ display: 'none' }),\n                        clearIndicator: base => ({ ...base, padding: '2px !important' }),\n                        menu: (base) => ({ ...base, fontSize: '0.75rem', zIndex: 9999 }),\n                        option: (base) => ({ ...base, fontSize: '0.75rem', padding: '4px 8px' })\n                      }}\n                    />\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì²­êµ¬ì¼</Label>\n                  <DatePickerPopover\n                    onDateSelect={(date) => {\n                      setValue('request_date', format(date, 'yyyy-MM-dd'));\n                    }}\n                    placeholder=\"ì²­êµ¬ì¼ ì„ íƒ\"\n                    align=\"start\"\n                  >\n                    <div className=\"h-7 w-full bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md hover:bg-gray-50 transition-all duration-200 flex items-center justify-center gap-1 cursor-pointer\">\n                      <span>{watch('request_date') ? watch('request_date').slice(2).replace(/-/g, '.') : <span className=\"text-gray-400\">ì—°ë„.ì›”.ì¼</span>}</span>\n                      <CalendarIcon className=\"w-3 h-3 text-gray-400\" />\n                    </div>\n                  </DatePickerPopover>\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ì…ê³  ìš”ì²­ì¼</Label>\n                  <DatePickerPopover\n                    onDateSelect={(date) => {\n                      setValue('delivery_request_date', format(date, 'yyyy-MM-dd'));\n                    }}\n                    placeholder=\"ì…ê³  ìš”ì²­ì¼ ì„ íƒ\"\n                    align=\"start\"\n                  >\n                    <div className=\"h-7 w-full bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md hover:bg-gray-50 transition-all duration-200 flex items-center justify-center gap-1 cursor-pointer\">\n                      <span>{watch('delivery_request_date') ? watch('delivery_request_date').slice(2).replace(/-/g, '.') : <span className=\"text-gray-400\">ì—°ë„.ì›”.ì¼</span>}</span>\n                      <CalendarIcon className=\"w-3 h-3 text-gray-400\" />\n                    </div>\n                  </DatePickerPopover>\n                </div>\n              </div>\n\n              {/* í”„ë¡œì íŠ¸ ì •ë³´ */}\n              <div className=\"grid grid-cols-3 gap-1.5 sm:gap-2\">\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">PJì—…ì²´</Label>\n                  <Input \n                    type=\"text\" \n                    value={watch('project_vendor')} \n                    onChange={(e) => setValue('project_vendor', e.target.value)} \n                    placeholder=\"ì…ë ¥\"\n                    className=\"h-7 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md focus:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">ìˆ˜ì£¼ë²ˆí˜¸</Label>\n                  <Input \n                    type=\"text\" \n                    value={watch('sales_order_number')} \n                    onChange={(e) => setValue('sales_order_number', e.target.value)} \n                    placeholder=\"ì…ë ¥\"\n                    className=\"h-7 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md focus:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n                <div>\n                  <Label className=\"mb-0.5 block text-[10px] sm:text-xs\">Item</Label>\n                  <Input \n                    type=\"text\" \n                    value={watch('project_item')} \n                    onChange={(e) => setValue('project_item', e.target.value)} \n                    placeholder=\"ì…ë ¥\"\n                    className=\"h-7 bg-white border border-[#d2d2d7] rounded-md text-xs shadow-sm hover:shadow-md focus:shadow-md transition-shadow duration-200\"\n                  />\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Professional Items Section - í…œí”Œë¦¿ ì„ íƒ í›„ì—ë§Œ í‘œì‹œ */}\n        {watch('po_template_type') && (\n        <div className=\"w-full lg:w-3/4 space-y-4\">\n\n          {/* í…Œì´ë¸” í˜•íƒœì˜ í’ˆëª© ë¦¬ìŠ¤íŠ¸ */}\n          <div className=\"relative border border-gray-200 rounded-lg overflow-hidden\">\n            <div className=\"bg-gray-50 border-b border-gray-100 px-2 sm:px-3 py-2 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3\">\n              <div className=\"flex flex-wrap items-center gap-3\">\n                <div className=\"flex items-center gap-2\">\n                  <Package className=\"w-4 h-4 text-gray-600\" />\n                  <div className=\"flex flex-col\">\n                    <span className=\"font-semibold text-foreground leading-tight\">í’ˆëª© ëª©ë¡</span>\n                    <span className=\"text-xs text-muted-foreground leading-tight\">Purchase Items</span>\n                  </div>\n                  <span className=\"badge-secondary whitespace-nowrap\">\n                    {fields.length}ê°œ\n                  </span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                <Select value={currency} onValueChange={setCurrency}>\n                  <SelectTrigger className=\"w-20 text-xs border-border business-radius-badge shadow-sm hover:shadow-md transition-shadow duration-200 bg-white [&>svg]:hidden\" style={{ height: 'auto', padding: '2.5px 10px', minHeight: 'auto' }}>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent className=\"rounded-md\">\n                    <SelectItem value=\"KRW\">KRW</SelectItem>\n                    <SelectItem value=\"USD\">USD</SelectItem>\n                  </SelectContent>\n                </Select>\n                  {selectedBoard?.label && (\n                    <span className=\"text-[11px] text-gray-400\">\n                      ë³´ë“œëª…: {selectedBoard.label}\n                    </span>\n                  )}\n                </div>\n              </div>\n              <div className=\"flex items-center justify-end gap-2 flex-wrap sm:flex-nowrap\">\n                <span className=\"badge-stats text-hansl-500 text-[10px] px-1.5 py-0.5 whitespace-nowrap flex-shrink-0 bg-hansl-50 business-radius-badge\">\n                  ì´ì•¡: {totalAmount.toLocaleString('ko-KR')} {currency}\n                </span>\n                <Button \n                  type=\"button\" \n                  className={`button-base border transition-all duration-200 ${\n                    isCopied \n                      ? 'border-green-400 text-green-600 bg-green-50' \n                      : 'border-gray-300 text-gray-600 bg-white hover:bg-blue-50 hover:text-blue-600'\n                  }`}\n                  disabled={isCopied}\n                  onClick={async () => { \n                    const showCopiedFeedback = () => {\n                      setIsCopied(true);\n                      setTimeout(() => setIsCopied(false), 1000);\n                    };\n                    \n                    try {\n                      // í’ˆëª© ë°ì´í„°ë¥¼ TSV í˜•ì‹ìœ¼ë¡œ ë³€í™˜ (íƒ­ìœ¼ë¡œ ì—´ êµ¬ë¶„, ì¤„ë°”ê¿ˆìœ¼ë¡œ í–‰ êµ¬ë¶„)\n                      const headers = paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" \n                        ? ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë§í¬', 'ë¹„ê³ ']\n                        : ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë¹„ê³ '];\n                      \n                      const rows = fields.map(item => {\n                        const baseRow = [\n                          item.item_name || '',\n                          item.specification || '',\n                          item.quantity?.toString() || '0',\n                          item.unit_price_value?.toString() || '0',\n                          item.amount_value?.toString() || '0',\n                        ];\n                        \n                        if (paymentCategory === \"êµ¬ë§¤ ìš”ì²­\") {\n                          baseRow.push(item.link || '');\n                        }\n                        baseRow.push(item.remark || '');\n                        \n                        return baseRow.join('\\t');\n                      });\n                      \n                      const tsvData = [headers.join('\\t'), ...rows].join('\\n');\n                      \n                      await navigator.clipboard.writeText(tsvData);\n                      showCopiedFeedback();\n                      toast.success(`ğŸ“‹ ${fields.length}ê°œ í’ˆëª© ë³µì‚¬ ì™„ë£Œ! ì—‘ì…€ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.`);\n                    } catch (err) {\n                      // Fallback: êµ¬í˜• ë¸Œë¼ìš°ì € ëŒ€ì‘\n                      try {\n                        const headers = paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" \n                          ? ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë§í¬', 'ë¹„ê³ ']\n                          : ['í’ˆëª©', 'ê·œê²©', 'ìˆ˜ëŸ‰', 'ë‹¨ê°€', 'í•©ê³„', 'ë¹„ê³ '];\n                        \n                        const rows = fields.map(item => {\n                          const baseRow = [\n                            item.item_name || '',\n                            item.specification || '',\n                            item.quantity?.toString() || '0',\n                            item.unit_price_value?.toString() || '0',\n                            item.amount_value?.toString() || '0',\n                          ];\n                          \n                          if (paymentCategory === \"êµ¬ë§¤ ìš”ì²­\") {\n                            baseRow.push(item.link || '');\n                          }\n                          baseRow.push(item.remark || '');\n                          \n                          return baseRow.join('\\t');\n                        });\n                        \n                        const tsvData = [headers.join('\\t'), ...rows].join('\\n');\n                        \n                        const textArea = document.createElement('textarea');\n                        textArea.value = tsvData;\n                        textArea.style.position = 'fixed';\n                        textArea.style.left = '-9999px';\n                        document.body.appendChild(textArea);\n                        textArea.select();\n                        document.execCommand('copy');\n                        document.body.removeChild(textArea);\n                        showCopiedFeedback();\n                        toast.success(`ğŸ“‹ ${fields.length}ê°œ í’ˆëª© ë³µì‚¬ ì™„ë£Œ! ì—‘ì…€ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.`);\n                      } catch (fallbackErr) {\n                        toast.error('í´ë¦½ë³´ë“œ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ê¶Œí•œì„ í™•ì¸í•´ì£¼ì„¸ìš”.');\n                      }\n                    }\n                  }}\n                >\n                  {isCopied ? (\n                    <>\n                      <Check className=\"w-3 h-3 mr-0.5\" />\n                      ë³µì‚¬ë¨\n                    </>\n                  ) : (\n                    <>\n                      <Copy className=\"w-3 h-3 mr-0.5\" />\n                      ì „ì²´ë³µì‚¬\n                    </>\n                  )}\n                </Button>\n                <Button \n                  type=\"button\" \n                  className=\"button-base border border-gray-300 text-gray-600 bg-white hover:bg-red-50 hover:text-red-600\" \n                  onClick={() => { \n                    if (confirm('ëª¨ë“  í’ˆëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {\n                      fields.forEach((_idx, index) => remove(fields.length - 1 - index)); \n                      append({ \n                        line_number: 1, \n                        item_name: '', \n                        specification: '', \n                        quantity: 1, \n                        unit_price_value: 0, \n                        unit_price_currency: currency, \n                        amount_value: 0, \n                        amount_currency: currency, \n                        remark: '', \n                        link: '' \n                      });\n                    }\n                  }}\n                >\n                  ì „ì²´ì‚­ì œ\n                </Button>\n                <Input\n                  type=\"number\"\n                  min={1}\n                  max={1000}\n                  value={addCount}\n                  onChange={e => setAddCount(Math.max(1, Number(e.target.value.replace(/[^0-9]/g, ''))))}\n                  className=\"w-12 text-center flex-shrink-0 business-radius-badge border border-gray-300 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none [&]:!text-[12px] [&]:!font-medium [&]:!leading-tight\"\n                  style={{ \n                    height: 'auto',\n                    padding: '2px 6px', \n                    minHeight: 'auto',\n                    maxHeight: 'none',\n                    lineHeight: '1.25'\n                  }}\n                />\n                <Button\n                  type=\"button\"\n                  onClick={() => {\n                    for (let i = 0; i < addCount; i++) {\n                      append({\n                        line_number: fields.length + 1 + i,\n                        item_name: '',\n                        specification: '',\n                        quantity: 1,\n                        unit_price_value: 0,\n                        unit_price_currency: currency,\n                        amount_value: 0,\n                        amount_currency: currency,\n                        remark: '',\n                        link: ''\n                      });\n                    }\n                  }}\n                  className=\"button-base bg-blue-500 hover:bg-blue-600 text-white\"\n                >\n                  <Plus className=\"w-3 h-3 mr-0.5\" />\n                  ì¶”ê°€\n                </Button>\n              </div>\n            </div>\n            <div className=\"overflow-x-auto\" onPaste={handlePasteFromExcel} tabIndex={0} style={{ outline: 'none' }}>\n              <div className=\"max-h-[calc(100vh-180px)] overflow-y-auto\">\n                <table className=\"w-full text-xs\">\n                  <thead className=\"bg-gray-50 sticky top-0 z-10\">\n                    <tr className=\"border-b border-gray-200\">\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 w-10\">#</th>\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[100px] sm:min-w-[120px]\">\n                        í’ˆëª©<span className=\"text-red-500\">*</span>\n                      </th>\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[250px] sm:min-w-[320px]\">ê·œê²©</th>\n                      <th className=\"px-2 py-2 text-center font-medium text-gray-700 w-20\">\n                        ìˆ˜ëŸ‰<span className=\"text-red-500\">*</span>\n                      </th>\n                      <th className=\"px-2 py-2 text-right font-medium text-gray-700 w-[140px] sm:w-[160px]\">\n                        ë‹¨ê°€ ({currency})\n                      </th>\n                      <th className=\"px-2 py-2 text-right font-medium text-gray-700 min-w-[110px] sm:min-w-[140px]\">\n                        í•©ê³„ ({currency})\n                      </th>\n                      {paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" && (\n                        <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[120px] sm:min-w-[150px]\">ë§í¬</th>\n                      )}\n                      <th className=\"px-2 py-2 text-left font-medium text-gray-700 min-w-[100px] sm:min-w-[150px]\">ë¹„ê³ </th>\n                      <th className=\"px-2 py-2 text-center font-medium text-gray-700 w-10\"></th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"bg-white\">\n                    {fields.map((item, idx) => (\n                      <tr key={idx} className=\"border-b border-gray-100 hover:bg-gray-50\">\n                        <td className=\"px-2 py-1 text-center text-gray-500\">{idx + 1}</td>\n                        {/* í’ˆëª© */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"item_name\"\n                            value={item.item_name}\n                            onChange={(e) => update(idx, { ...item, item_name: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"í’ˆëª©ëª… ì…ë ¥\"\n                          />\n                        </td>\n\n                        {/* ê·œê²© */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"specification\"\n                            value={item.specification}\n                            onChange={(e) => update(idx, { ...item, specification: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"ê·œê²© ì…ë ¥\"\n                          />\n                        </td>\n\n                        {/* ìˆ˜ëŸ‰ */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"quantity\"\n                            type=\"number\"\n                            min=\"1\"\n                            value={item.quantity || ''}\n                            className=\"h-7 w-20 bg-white border border-gray-200 text-xs text-center [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none\"\n                            placeholder=\"0\"\n                            onChange={(e) => {\n                              const newQuantity = parseInt(e.target.value) || 0;\n                              update(idx, { ...item, quantity: newQuantity });\n                            }}\n                          />\n                        </td>\n\n                        {/* ë‹¨ê°€ */}\n                        <td className=\"px-2 py-1\">\n                          <div className=\"flex items-center\">\n                            <Input\n                              data-row-index={idx}\n                              data-field-name=\"unit_price_value\"\n                              type=\"text\"\n                              inputMode=\"decimal\"\n                              value={inputValues[`${idx}_unit_price_value`] ?? (item.unit_price_value === 0 ? \"\" : item.unit_price_value?.toLocaleString('ko-KR') || \"\")}\n                              onChange={(e) => {\n                                const raw = e.target.value.replace(/,/g, \"\");\n                                // ìˆ«ìì™€ ì†Œìˆ˜ì ë§Œ í—ˆìš©\n                                const cleanValue = raw.replace(/[^0-9.]/g, '');\n                                // ì†Œìˆ˜ì  ì¤‘ë³µ ë°©ì§€\n                                const parts = cleanValue.split('.');\n                                const finalValue = parts.length > 2 ? parts[0] + '.' + parts.slice(1).join('') : cleanValue;\n                                \n                                // ì…ë ¥ ì¤‘ì¸ ê°’ ì €ì¥ (ì†Œìˆ˜ì  ìœ ì§€)\n                                setInputValues(prev => ({...prev, [`${idx}_unit_price_value`]: finalValue}));\n                                \n                                // ê³„ì‚°ìš© ìˆ«ì ê°’ ì €ì¥\n                                const numVal = finalValue === '' ? 0 : parseFloat(finalValue) || 0;\n                                update(idx, { ...item, unit_price_value: numVal });\n                              }}\n                              onBlur={() => {\n                                // í¬ì»¤ìŠ¤ ë²—ì–´ë‚  ë•Œ ì…ë ¥ê°’ ì •ë¦¬\n                                setInputValues(prev => {\n                                  const newState = {...prev};\n                                  delete newState[`${idx}_unit_price_value`];\n                                  return newState;\n                                });\n                              }}\n                              className=\"h-7 w-32 bg-white border border-gray-200 text-xs text-right\"\n                              placeholder=\"0\"\n                            />\n                            <span className=\"ml-1 text-xs text-gray-500\">{currency === \"KRW\" ? \"â‚©\" : \"$\"}</span>\n                          </div>\n                        </td>\n\n                        {/* í•©ê³„ */}\n                        <td className=\"px-2 py-1\">\n                          <div className=\"flex items-center justify-end\">\n                            <span className=\"text-xs text-right font-medium\">\n                              {(item.amount_value || 0).toLocaleString('ko-KR')}\n                            </span>\n                            <span className=\"ml-1 text-xs text-gray-500\">{currency === \"KRW\" ? \"â‚©\" : \"$\"}</span>\n                          </div>\n                        </td>\n\n                        {/* ë§í¬ (êµ¬ë§¤ìš”ì²­ì¼ ë•Œë§Œ) */}\n                        {paymentCategory === \"êµ¬ë§¤ ìš”ì²­\" && (\n                          <td className=\"px-2 py-1\">\n                            <Input\n                              data-row-index={idx}\n                              data-field-name=\"link\"\n                              value={item.link || ''}\n                              onChange={(e) => update(idx, { ...item, link: e.target.value })}\n                              type=\"url\"\n                              className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                              placeholder=\"https://...\"\n                            />\n                          </td>\n                        )}\n\n                        {/* ë¹„ê³  */}\n                        <td className=\"px-2 py-1\">\n                          <Input\n                            data-row-index={idx}\n                            data-field-name=\"remark\"\n                            value={item.remark || ''}\n                            onChange={(e) => update(idx, { ...item, remark: e.target.value })}\n                            className=\"h-7 w-full bg-white border border-gray-200 text-xs\"\n                            placeholder=\"ë¹„ê³ \"\n                          />\n                        </td>\n                        {/* ì‚­ì œ ë²„íŠ¼ */}\n                        <td className=\"px-2 py-1 text-center\">\n                          {fields.length > 1 && (\n                            <Button\n                              type=\"button\"\n                              onClick={() => remove(idx)}\n                              size=\"sm\"\n                              variant=\"ghost\"\n                              className=\"h-6 w-6 p-0 hover:bg-red-50\"\n                            >\n                              <X className=\"w-3 h-3 text-red-600\" />\n                            </Button>\n                          )}\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          </div>\n          \n          {/* ì œì¶œ ë²„íŠ¼ */}\n          <div className=\"flex justify-end gap-3 mt-2\">\n            <Button \n              type=\"button\" \n              variant=\"outline\"\n              onClick={() => navigate(-1)}\n              className=\"button-base border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 hover:border-gray-400\"\n            >\n              ì·¨ì†Œ\n            </Button>\n            <Button \n              type=\"submit\"\n              disabled={loading || !isFormValid}\n              className=\"button-base bg-hansl-600 hover:bg-hansl-700 text-white\"\n            >\n              {loading ? (\n                <>\n                  <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                  ì²˜ë¦¬ ì¤‘...\n                </>\n              ) : (\n                <>\n                  <Save className=\"w-4 h-4 mr-2\" />\n                  {{'ë°œì£¼/êµ¬ë§¤': 'ë°œì£¼ìš”ì²­', 'ì¹´ë“œì‚¬ìš©': 'ì¹´ë“œì‚¬ìš©ìš”ì²­', 'ì¶œì¥': 'ì¶œì¥ìš”ì²­', 'ì°¨ëŸ‰': 'ì°¨ëŸ‰ìš”ì²­'}[watch('po_template_type')] || 'ìš”ì²­'}\n                </>\n              )}\n            </Button>\n          </div>\n        </div>\n        )}\n      </div>\n\n      {/* ì—ëŸ¬ ë©”ì‹œì§€ */}\n      {error && (\n        <div className=\"mt-4 p-3 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm\">\n          {error}\n        </div>\n      )}\n\n      {/* ë‹´ë‹¹ì ê´€ë¦¬ ëª¨ë‹¬ */}\n      <Dialog open={isContactDialogOpen} onOpenChange={setIsContactDialogOpen}>\n        <DialogContent className=\"w-full max-w-[95vw] sm:max-w-3xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>ë‹´ë‹¹ì ê´€ë¦¬</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            {contactsForEdit.map((contact, index) => (\n              <div key={index} className=\"flex gap-2 items-end\">\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì´ë¦„</Label>\n                  <Input\n                    value={contact.contact_name}\n                    onChange={(e) => handleContactChange(index, 'contact_name', e.target.value)}\n                    placeholder=\"ë‹´ë‹¹ì ì´ë¦„\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì´ë©”ì¼</Label>\n                  <Input\n                    value={contact.contact_email}\n                    onChange={(e) => handleContactChange(index, 'contact_email', e.target.value)}\n                    placeholder=\"ì´ë©”ì¼\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì „í™”ë²ˆí˜¸</Label>\n                  <Input\n                    value={contact.contact_phone}\n                    onChange={(e) => handleContactChange(index, 'contact_phone', e.target.value)}\n                    placeholder=\"ì „í™”ë²ˆí˜¸\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <div className=\"flex-1\">\n                  <Label className=\"text-xs\">ì§ì±…</Label>\n                  <Input\n                    value={contact.position}\n                    onChange={(e) => handleContactChange(index, 'position', e.target.value)}\n                    placeholder=\"ì§ì±…\"\n                    className=\"h-9\"\n                  />\n                </div>\n                <Button\n                  type=\"button\"\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  onClick={() => removeContactSlot(index)}\n                  className=\"h-9 px-2\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            ))}\n          </div>\n          <DialogFooter className=\"gap-2\">\n            <Button\n              type=\"button\"\n              variant=\"outline\"\n              onClick={addNewContactSlot}\n              size=\"sm\"\n            >\n              <Plus className=\"h-4 w-4 mr-1\" />\n              ë‹´ë‹¹ì ì¶”ê°€\n            </Button>\n            <DialogClose asChild>\n              <Button type=\"button\" variant=\"outline\" size=\"sm\">\n                ì·¨ì†Œ\n              </Button>\n            </DialogClose>\n            <Button\n              type=\"button\"\n              onClick={handleSaveAllContacts}\n              disabled={!hasChanges}\n              size=\"sm\"\n            >\n              ì €ì¥\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </form>\n  );\n}\n"],"names":["Copy","createLucideIcon","width","height","x","y","rx","ry","key","d","PurchaseNewMain","navigate","useNavigate","supabase","createClient","user","setUser","useState","employeeName","setEmployeeName","employees","setEmployees","defaultRequesterLoaded","setDefaultRequesterLoaded","addCount","setAddCount","vendorSearchTerm","setVendorSearchTerm","boards","setBoards","selectedBoard","setSelectedBoard","productionQuantity","setProductionQuantity","useEffect","async","data","auth","getUser","error","from","select","order","loadBoards","length","map","dbEmp","id","name","email","phone","address","position","department","find","emp","currentUser","err","loadEmployees","vendors","setVendors","contacts","setContacts","vendor","setVendor","selectedContacts","setSelectedContacts","currency","setCurrency","loading","setLoading","setError","inputValues","setInputValues","isContactDialogOpen","setIsContactDialogOpen","contactsForEdit","setContactsForEdit","hasChanges","setHasChanges","isSubmittingRef","useRef","isCopied","setIsCopied","control","handleSubmit","rhHandleSubmit","watch","setValue","reset","getValues","useFormRH","defaultValues","progress_type","payment_category","po_template_type","request_type","sales_order_number","project_vendor","project_item","delivery_request_date","vendor_id","requester_name","items","line_number","item_name","specification","quantity","unit_price_value","unit_price_currency","amount_value","amount_currency","remark","link","request_date","Date","toISOString","slice","fields","append","remove","update","replace","useFieldArray","empData","eq","single","loadUserName","employeeData","setTimeout","shouldValidate","shouldDirty","fallbackName","split","setDefaultRequester","toast","loadVendors","selectedVendor","loadContacts","updatedItems","item","forEach","idx","calcAmount","Number","f","join","handleBoardSelect","selected","confirm","label","value","bomRows","set_count","success","warning","checkRequiredFields","templateType","requestType","progressType","paymentCategory","vendorId","isFormValid","setIsFormValid","generatePurchaseOrderNumber","prefix","getTime","existingOrders","queryError","like","ascending","nextNumber","maxSequence","parts","purchase_order_number","sequenceStr","sequence","parseInt","isNaN","safeNextNumber","String","padStart","currentEmployee","current","prId","purchaseOrderNumber","maxRetries","retryCount","pr","prError","insert","requester_id","requester_phone","requester_fax","requester_address","is_payment_completed","total_amount","reduce","sum","i","contact_id","message","includes","Error","Promise","resolve","Math","random","retryError","entries","itemErr","purchase_request_id","notifyResponse","fetch","method","headers","ok","json","text","notifyError","invalidatePurchaseMemoryCache","loadAllPurchaseData","refreshError","markCacheStaleAndNotify","routerError","window","location","href","totalAmount","handleContactChange","index","field","prev","contact","jsxs","onSubmit","e","preventDefault","onKeyDown","keyCode","children","className","jsx","Label","Select","onValueChange","SelectTrigger","SelectValue","placeholder","SelectContent","SelectItem","onClick","ReactSelect","options","b","board_name","onChange","isClearable","isSearchable","menuPortalTarget","document","body","styles","base","minHeight","fontSize","backgroundColor","borderColor","borderRadius","boxShadow","valueContainer","padding","menuPortal","zIndex","menu","minWidth","whiteSpace","option","color","dropdownIndicator","display","clearIndicator","indicatorSeparator","Fragment","Input","type","min","newQty","target","Button","size","variant","v","toString","vendor_name","opt","closeMenuOnSelect","classNamePrefix","blurInputOnSelect","openMenuOnFocus","openMenuOnClick","tabSelectsValue","captureMenuScroll","pageSize","container","maxHeight","background","border","margin","alignItems","verticalAlign","lineHeight","justifyContent","input","singleValue","indicatorsContainer","existingContacts","c","isNew","contact_name","contact_email","contact_phone","val","defaultValue","selectedOption","employee","noOptionsMessage","filterOption","inputValue","toLowerCase","overflow","textOverflow","DatePickerPopover","onDateSelect","date","format","align","CalendarIcon","Package","style","toLocaleString","disabled","showCopiedFeedback","rows","baseRow","push","tsvData","navigator","clipboard","writeText","textArea","createElement","left","appendChild","execCommand","removeChild","fallbackErr","Check","_idx","max","Plus","onPaste","clipboardData","getData","stopPropagation","filter","row","trim","currentItems","startIndex","startFieldName","activeElement","targetInput","tagName","targetElement","element","parentElement","rowIndexAttr","getAttribute","parsedIndex","parent","tbody","rowIndex","Array","indexOf","fieldNameAttr","FIELDS","startColIndex","maxRowIndex","rIndex","columns","targetRowIndex","currentItem","colValue","cIndex","targetColIndex","fieldName","cleanValue","qty","price","parseFloat","targetIdx","newRows","tabIndex","outline","newQuantity","inputMode","finalValue","numVal","onBlur","newState","X","Save","Dialog","open","onOpenChange","DialogContent","DialogHeader","DialogTitle","_","removeContactSlot","DialogFooter","DialogClose","asChild","endsWith","alert","editContactIds","deletedContacts","failedDeletes","deleted","deleteError","delete","updateError","insertError"],"mappings":"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","x_google_ignoreList":[0]}