const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/exceljs.min-CGL7737N.js","assets/index-Cwj1VDZQ.js","assets/index-DNH5yCxE.css","assets/PurchaseItemsModal-DswjL7CB.js","assets/input-DpPMYmYR.js","assets/table-CTfhGlhq.js","assets/index-ByU51ANB.js","assets/pen-q6j9kI7A.js","assets/plus-BibPN1y3.js","assets/save-CgZPTSfb.js","assets/card-CnFS5G0Q.js","assets/format-CSQe5d3I.js"])))=>i.map(i=>d[i]);
import{c as Qe,r as l,a as Se,l as $e,j as e,_ as et,d as Ae,e as tt,f as ge,g as yr,h as W,i as rt,k as de,P as re,m as be,n as at,o as _r,R as wr,A as nt,p as lt,q as jr,D as br,C as Cr,s as Nr,b as st,u as Sr,t as Ar}from"./index-Cwj1VDZQ.js";import{t as te,B as Y}from"./index-ByU51ANB.js";import{a as Pr,P as kr}from"./PurchaseDetailModal-rrCneSBm.js";import{E as Er,C as Le,a as Dr,b as $r,c as Be}from"./card-CnFS5G0Q.js";import{g as ot,R as it,P as ct,W as Fr,C as dt,T as Rr,h as Ir,i as mt,O as ut,j as zr,k as Or,l as qr,m as Mr,u as Gr,F as Tr,I as we}from"./input-DpPMYmYR.js";import{C as Lr,S as Ve,a as Je,b as He,c as We,d as ue}from"./select-C9layrVS.js";import{S as pt}from"./search-Bg5zvi8r.js";import{P as Br}from"./plus-BibPN1y3.js";import"./pen-q6j9kI7A.js";import"./save-CgZPTSfb.js";/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vr=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Jr=Qe("chevrons-up-down",Vr);/**
 * @license lucide-react v0.541.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Wr=Qe("funnel",Hr),Kr=()=>{const[t,n]=l.useState([]),[a,r]=l.useState([]),[s,i]=l.useState([]),[m,p]=l.useState(!0),[y,d]=l.useState([]),[h,S]=l.useState(""),[P,D]=l.useState(""),[F,X]=l.useState(""),u=Se();l.useEffect(()=>{(async()=>{try{const[q,I,f]=await Promise.all([u.from("vendors").select("*"),u.from("employees").select("*"),u.auth.getUser()]);if(q.error)throw q.error;if(r(q.data||[]),I.error)throw I.error;if(i(I.data||[]),f.data.user&&!f.error){let g=null;if(f.data.user.email&&(g=(await u.from("employees").select("*").eq("email",f.data.user.email).maybeSingle()).data),g){let $=[];g.purchase_role&&(Array.isArray(g.purchase_role)?$=g.purchase_role.map(b=>String(b).trim()):$=String(g.purchase_role).split(",").map(G=>G.trim()).filter(G=>G.length>0)),d($),S(g.name||g.full_name||""),D(g.email||""),X(g.id||"")}}}catch(q){$e.error("초기 데이터 로드 실패",q)}})()},[]);const j=l.useCallback(async()=>{p(!0);try{let N=s;if(N.length===0){const{data:b}=await u.from("employees").select("*");N=b||[]}const{data:{user:q},error:I}=await u.auth.getUser();if(I||!q){$e.error("사용자 인증 실패",I),te.error("로그인이 필요합니다."),p(!1);return}const{data:f,error:g}=await u.from("purchase_requests").select("*,vendors(vendor_name,vendor_payment_schedule),vendor_contacts(contact_name),purchase_request_items(item_name,specification,quantity,unit_price_value,amount_value,remark,line_number,link)").order("request_date",{ascending:!1}).limit(2e3);if(g)throw g;const $=(f||[]).map(b=>{const G=b.purchase_request_items?.[0]||{},M=N.find(z=>z.id===b.requester_id);return{id:Number(b.id),purchase_order_number:b.purchase_order_number,request_date:b.request_date,delivery_request_date:b.delivery_request_date,progress_type:b.progress_type,payment_completed_at:b.payment_completed_at,payment_category:b.payment_category,currency:b.currency,request_type:b.request_type,vendor:b.vendors||null,vendor_name:b.vendors?.vendor_name||"",vendor_payment_schedule:b.vendors?.vendor_payment_schedule||"",vendor_contacts:b.vendor_contacts||[],requester_id:b.requester_id,requester_name:b.requester_name,requester_full_name:M?.full_name||M?.name||b.requester_name||"",item_name:G.item_name||"",specification:G.specification||"",quantity:Number(G.quantity)||0,unit_price_value:Number(G.unit_price_value)||0,amount_value:Number(G.amount_value)||0,remark:G.remark||"",project_vendor:b.project_vendor,sales_order_number:b.sales_order_number,project_item:b.project_item,line_number:Number(G.line_number)||1,contact_name:b.vendor_contacts?.contact_name||"",middle_manager_status:b.middle_manager_status,final_manager_status:b.final_manager_status,is_received:!!b.is_received,received_at:b.received_at,is_payment_completed:!!b.is_payment_completed,is_po_download:!!b.is_po_download,link:G.link,items:b.purchase_request_items||[],total_amount:b.purchase_request_items?.reduce((z,ee)=>z+(Number(ee.amount_value)||0),0)||0,purchase_status:b.purchase_status||"pending"}});n($)}catch(N){$e.error("발주 목록 로드 실패",N),te.error("발주 목록을 불러올 수 없습니다.")}finally{p(!1)}},[s]);return l.useEffect(()=>{j()},[j]),{purchases:t,vendors:a,employees:s,loading:m,currentUserRoles:y,currentUserName:h,currentUserEmail:P,currentUserId:F,refreshPurchases:j}};function Yr(t,n=500){const[a,r]=l.useState(t);return l.useEffect(()=>{const s=setTimeout(()=>{r(t)},n);return()=>{clearTimeout(s)}},[t,n]),a}const Ur=["정희웅"],Xr=(t,n,a,r,s)=>{const i=Se(),[m,p]=l.useState("pending"),[y,d]=l.useState(""),[h,S]=l.useState(""),[P,D]=l.useState(""),[F,X]=l.useState(""),[u,j]=l.useState(""),[N,q]=l.useState(""),[I,f]=l.useState(""),[g,$]=l.useState(""),b=new Date().getFullYear(),G=new Date(b,0,1).toISOString().split("T")[0],M=new Date().toISOString().split("T")[0],[z,ee]=l.useState(G),[B,K]=l.useState(M),V=Yr(y,300),O=n?.includes("app_admin");n?.includes("final_approver"),n?.includes("middle_manager");const Z=n?.includes("purchase_manager"),J=n?.includes("raw_material_manager")||n?.includes("consumable_manager")||n?.includes("purchase_manager"),ae=l.useMemo(()=>!n||n.length===0?1:Z?2:n.some(w=>["middle_manager","final_approver","app_admin","ceo"].includes(w))?3:1,[n,Z]),ne=l.useCallback(w=>{if(!a)return"all";if(w==="purchase")return J||O?"all":a;switch(ae){case 1:return w==="done"?"all":a;case 2:return w==="done"?"all":a;case 3:return"all";default:return a}},[a,ae,J,O]);l.useEffect(()=>{if(!a)return;const w=ne(m);D(w)},[m,a,ae,ne]);const le=l.useMemo(()=>n.includes("purchase_manager")||n.includes("app_admin")?t:t.filter(w=>!Ur.includes(w.requester_name)),[t,n]),o=l.useMemo(()=>le.filter(w=>{const _=w.request_date?w.request_date.split("T")[0]:"",A=!z||_>=z,T=!B||_<=B;return A&&T}),[le,z,B]),C=l.useMemo(()=>o.filter(_=>{let A=!1;switch(m){case"pending":return A=["pending","대기","",null].includes(_.final_manager_status),A;case"purchase":{const T=_.payment_category==="구매 요청",ve=!_.is_payment_completed,ye=(_.progress_type||"").includes("선진행"),Ee=(_.progress_type||"").includes("일반"),De=_.final_manager_status==="approved";return!T||!ve?A=!1:A=ye||Ee&&De,A}case"receipt":{const T=!_.is_received,ve=(_.progress_type||"").includes("선진행"),ye=_.final_manager_status==="approved";return A=T&&(ve||ye),A}case"done":return A=!0,A;default:return!0}}),[o,m]),k=l.useMemo(()=>P&&P!=="all"&&P!=="전체"?C.filter(_=>_.requester_name===P):C,[C,P]),v=l.useMemo(()=>h?k.filter(w=>w.vendor_name===h):k,[k,h]),E=l.useMemo(()=>{let w=v;if(F){const _=F.trim().toLowerCase();w=w.filter(A=>A.purchase_order_number?.toLowerCase().includes(_))}if(u){const _=u.trim().toLowerCase();w=w.filter(A=>A.items&&A.items.length>0?A.items.some(T=>T.item_name?.toLowerCase().includes(_)):!1)}if(N){const _=N.trim().toLowerCase();w=w.filter(A=>A.items&&A.items.length>0?A.items.some(T=>T.specification?.toLowerCase().includes(_)):!1)}if(I&&I!=="all"&&(w=w.filter(_=>{switch(I){case"pending":return!_.final_manager_status||_.final_manager_status==="pending"||_.final_manager_status==="대기";case"approved":return _.final_manager_status==="approved";case"rejected":return _.final_manager_status==="rejected"||_.middle_manager_status==="rejected";default:return!0}})),g){const _=g.trim().toLowerCase();w=w.filter(A=>A.items&&A.items.length>0?A.items.some(T=>T.remark?.toLowerCase().includes(_)):!1)}return w},[v,F,u,N,I,g]),x=l.useMemo(()=>{if(!V)return E;const w=V.trim().toLowerCase();return E.filter(_=>_.purchase_order_number?.toLowerCase().includes(w)||_.vendor_name?.toLowerCase().includes(w)||_.requester_name?.toLowerCase().includes(w)||_.project_vendor?.toLowerCase().includes(w)?!0:_.items&&_.items.length>0?_.items.some(A=>A.item_name&&A.item_name.toLowerCase().includes(w)||A.specification&&A.specification.toLowerCase().includes(w)):!1)},[E,V]),R=l.useMemo(()=>[...x].sort((w,_)=>{const A=w.request_date?new Date(w.request_date).getTime():0;return(_.request_date?new Date(_.request_date).getTime():0)-A}),[x]),H=l.useMemo(()=>{const _=le.filter(L=>{const Q=L.request_date?L.request_date.split("T")[0]:"",se=!z||Q>=z,_e=!B||Q<=B;return se&&_e}),A=L=>new Set(L.map(Q=>Q.purchase_order_number)).size,T=L=>{if(L==="purchase")return J||O?_:_.filter(se=>se.requester_name===a);const Q=ne(L);return Q==="all"||Q==="전체"?_:_.filter(se=>se.requester_name===Q)},ve=T("pending"),ye=T("purchase"),Ee=T("receipt"),De=T("done"),xr=ve.filter(L=>["pending","대기","",null].includes(L.final_manager_status)),gr=ye.filter(L=>{const Q=L.payment_category==="구매 요청",se=!L.is_payment_completed;if(!Q||!se)return!1;const _e=(L.progress_type||"").includes("선진행"),hr=(L.progress_type||"").includes("일반"),vr=L.final_manager_status==="approved";return _e||hr&&vr}),fr=Ee.filter(L=>{const Q=!L.is_received,se=(L.progress_type||"").includes("선진행"),_e=L.final_manager_status==="approved";return Q&&(se||_e)});return{pending:A(xr),purchase:A(gr),receipt:A(fr),done:A(De)}},[le,z,B,ae,a,ne,J,O]);return l.useEffect(()=>{(async()=>{const{data:{user:w}}=await i.auth.getUser();if(!w)return;const{data:_}=await i.from("user_preferences").select("period_start, period_end").eq("user_id",w.id).single();if(_){const A=_.period_start?new Date(_.period_start).toISOString().split("T")[0]:G,T=_.period_end?new Date(_.period_end).toISOString().split("T")[0]:M;ee(A),K(T)}})()},[]),l.useEffect(()=>{(async()=>{const{data:{user:w}}=await i.auth.getUser();w&&(!z||!B||await i.from("user_preferences").upsert({user_id:w.id,period_start:z,period_end:B,updated_at:new Date().toISOString()}))})()},[z,B]),{activeTab:m,searchTerm:y,vendorFilter:h,dateFromFilter:z,dateToFilter:B,selectedEmployee:P,purchaseNumberFilter:F,itemNameFilter:u,specificationFilter:N,approvalStatusFilter:I,remarkFilter:g,setActiveTab:p,setSearchTerm:d,setVendorFilter:S,setDateFromFilter:ee,setDateToFilter:K,setSelectedEmployee:D,setPurchaseNumberFilter:X,setItemNameFilter:j,setSpecificationFilter:q,setApprovalStatusFilter:f,setRemarkFilter:$,filteredPurchases:R,tabCounts:H}},Zr=t=>{if(!t)return"-";const n=new Date(t);return`${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`},Qr=t=>{if(!t.items||t.items.length===0)return{received:0,total:0,percentage:0};const n=t.items.length,a=t.items.filter(s=>s.is_received||s.delivery_status==="received").length,r=n>0?Math.round(a/n*100):0;return{received:a,total:n,percentage:r}},xt=l.memo(({purchase:t})=>{const n=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",a={completed:{text:"입고완료",className:"bg-green-100 text-green-800"},inProgress:{text:"구매진행",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"반려",className:"bg-red-100 text-red-800"},pending:{text:"승인대기",className:"bg-yellow-100 text-yellow-800"}},{text:r,className:s}=a[n];return e.jsx(Y,{className:`${s} text-xs`,children:r})});xt.displayName="StatusBadge";const gt=l.memo(({purchase:t,onClick:n})=>{const a=Qr(t),r=t.progress_type==="선진행"||t.progress_type?.includes("선진행");return e.jsxs("div",{className:`bg-white rounded-lg border p-4 space-y-3 cursor-pointer transition-all hover:shadow-md ${r?"border-red-400 bg-red-50 hover:bg-red-100":"hover:bg-gray-50"}`,onClick:()=>n(t),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r?e.jsx(Y,{className:"bg-red-500 text-white font-bold text-xs px-2 py-0.5",children:"선진행"}):e.jsx(Y,{className:"bg-gray-200 text-gray-700 text-xs px-2 py-0.5",children:"일반"}),e.jsx("span",{className:"font-semibold text-sm text-gray-900",children:t.purchase_order_number||"-"})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Zr(t.request_date)," 요청"]})]}),e.jsx(xt,{purchase:t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"요청자"}),e.jsx("span",{className:"font-medium",children:t.requester_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"업체"}),e.jsx("span",{className:"font-medium",children:t.vendor_name})]}),t.project_vendor&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJ업체"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_vendor})]}),t.project_item&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"PJ ITEM"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.project_item})]}),t.sales_order_number&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"수주번호"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.sales_order_number})]}),t.item_name&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"품목"}),e.jsx("span",{className:"font-medium truncate max-w-[150px]",children:t.item_name})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"금액"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[(t.amount_value||t.total_amount)?.toLocaleString()," ",t.currency]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"입고현황"}),e.jsxs("span",{className:"text-gray-700",children:[a.received,"/",a.total," (",a.percentage,"%)"]})]}),e.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${a.percentage===100?"bg-green-500":a.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${a.percentage}%`}})})]}),t.is_payment_completed!==void 0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"결제"}),t.is_payment_completed?e.jsx(Y,{className:"bg-green-100 text-green-800 text-xs",children:"완료"}):e.jsx(Y,{className:"bg-gray-100 text-gray-800 text-xs",children:"대기"})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex items-center justify-center text-xs text-gray-500",children:[e.jsx(Er,{className:"w-3 h-3 mr-1"}),"클릭하여 상세보기"]})})]})});gt.displayName="MobilePurchaseCard";function Ke(t){if(!t)return"";const n=new Date(t);return isNaN(n.getTime())?t:`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`}function Fe(t){return t?["KRW","원","₩"].includes(t)?"₩":["USD","$","달러"].includes(t)?"$":["EUR","€"].includes(t)?"€":["JPY","엔","¥"].includes(t)||["CNY","위안","元"].includes(t)?"¥":t:""}async function ea(t){const n=await et(()=>import("./exceljs.min-CGL7737N.js").then(u=>u.e),__vite__mapDeps([0,1,2])),a=new n.default.Workbook,r=a.addWorksheet("발주서",{pageSetup:{paperSize:9,orientation:"portrait",fitToPage:!0,fitToWidth:1,fitToHeight:1,horizontalCentered:!0,verticalCentered:!0,margins:{left:.3,right:.3,top:.5,bottom:.5,header:.2,footer:.2}}});r.getRow(1).height=39.75;for(let u=2;u<=60;u++)r.getRow(u).height=15.75;r.mergeCells("A1:G1"),r.mergeCells("A2:B2"),r.mergeCells("C2:D2"),r.mergeCells("F2:G2"),r.mergeCells("A3:B3"),r.mergeCells("C3:D3"),r.mergeCells("F3:G3"),r.mergeCells("A4:B4"),r.mergeCells("C4:D4"),r.mergeCells("F4:G4"),r.mergeCells("A5:B5"),r.mergeCells("C5:D5"),r.mergeCells("F5:G5"),r.mergeCells("A6:B6"),r.mergeCells("C6:D6"),r.mergeCells("F6:G6"),r.mergeCells("A7:B7"),r.mergeCells("C7:D7"),r.mergeCells("E7:F7"),r.getCell("A1").value="             발 주 서",r.getCell("A1").alignment={horizontal:"center",vertical:"middle"},r.getCell("A1").font={name:"GulimChe",size:25,bold:!0},r.getCell("A2").value="업 체 명",r.getCell("A2").font={name:"GulimChe",size:11},r.getCell("A2").alignment={horizontal:"center",vertical:"middle"},r.getCell("A3").value="담 당 자",r.getCell("A3").font={name:"GulimChe",size:11},r.getCell("A3").alignment={horizontal:"center",vertical:"middle"},r.getCell("A4").value="청 구 일",r.getCell("A4").font={name:"GulimChe",size:11},r.getCell("A4").alignment={horizontal:"center",vertical:"middle"},r.getCell("A5").value="전화 번호",r.getCell("A5").font={name:"GulimChe",size:11},r.getCell("A5").alignment={horizontal:"center",vertical:"middle"},r.getCell("A6").value="팩스 번호",r.getCell("A6").font={name:"GulimChe",size:11},r.getCell("A6").alignment={horizontal:"center",vertical:"middle"},r.getCell("A7").value="입고 요청일",r.getCell("A7").font={name:"GulimChe",size:11},r.getCell("A7").alignment={horizontal:"center",vertical:"middle"},r.getCell("E2").value="구매요구자",r.getCell("E2").font={name:"GulimChe",size:11},r.getCell("E2").alignment={horizontal:"center",vertical:"middle"},r.getCell("E3").value="주  소",r.getCell("E3").font={name:"GulimChe",size:11},r.getCell("E3").alignment={horizontal:"center",vertical:"middle"},r.getCell("E4").value="발주 번호",r.getCell("E4").font={name:"GulimChe",size:11},r.getCell("E4").alignment={horizontal:"center",vertical:"middle"},r.getCell("E5").value="전화 번호",r.getCell("E5").font={name:"GulimChe",size:11},r.getCell("E5").alignment={horizontal:"center",vertical:"middle"},r.getCell("E6").value="팩스 번호",r.getCell("E6").font={name:"GulimChe",size:11},r.getCell("E6").alignment={horizontal:"center",vertical:"middle"},r.getCell("E7").value="지출 예정일",r.getCell("E7").font={name:"GulimChe",size:11},r.getCell("E7").alignment={horizontal:"center",vertical:"middle"},r.getCell("F7").value=t.vendor_payment_schedule||"익월말 결제",r.getCell("F7").font={name:"GulimChe",size:11},r.getCell("F7").alignment={horizontal:"center",vertical:"middle"},r.getCell("C2").value=t.vendor_name,r.getCell("C2").font={name:"GulimChe",size:11},r.getCell("C2").alignment={horizontal:"center",vertical:"middle"},r.getCell("C3").value=t.vendor_contact_name||"",r.getCell("C3").font={name:"GulimChe",size:11},r.getCell("C3").alignment={horizontal:"center",vertical:"middle"},r.getCell("C4").value=Ke(t.request_date),r.getCell("C4").font={name:"GulimChe",size:11},r.getCell("C4").alignment={horizontal:"center",vertical:"middle"},r.getCell("C5").value=t.vendor_phone||"",r.getCell("C5").font={name:"GulimChe",size:11},r.getCell("C5").alignment={horizontal:"center",vertical:"middle"},r.getCell("C6").value=t.vendor_fax||"",r.getCell("C6").font={name:"GulimChe",size:11},r.getCell("C6").alignment={horizontal:"center",vertical:"middle"},r.getCell("C7").value=Ke(t.delivery_request_date),r.getCell("C7").font={name:"GulimChe",size:11},r.getCell("C7").alignment={horizontal:"center",vertical:"middle"},r.getCell("F2").value=t.requester_name,r.getCell("F2").font={name:"GulimChe",size:11},r.getCell("F2").alignment={horizontal:"center",vertical:"middle"},r.getCell("F3").value="대구광역시 달서구 성서공단북로 305",r.getCell("F3").font={name:"GulimChe",size:11},r.getCell("F3").alignment={horizontal:"center",vertical:"middle"},r.getCell("F4").value=t.purchase_order_number,r.getCell("F4").font={name:"GulimChe",size:11},r.getCell("F4").alignment={horizontal:"center",vertical:"middle"},r.getCell("F5").value="(053) 626 - 7805",r.getCell("F5").font={name:"GulimChe",size:11},r.getCell("F5").alignment={horizontal:"center",vertical:"middle"},r.getCell("F6").value="(053) 657 - 7905",r.getCell("F6").font={name:"GulimChe",size:11},r.getCell("F6").alignment={horizontal:"center",vertical:"middle"},r.getCell("A8").value="번호",r.getCell("A8").font={name:"GulimChe",size:11},r.getCell("A8").alignment={horizontal:"center",vertical:"middle"},r.getCell("B8").value="품명",r.getCell("B8").font={name:"GulimChe",size:11},r.getCell("B8").alignment={horizontal:"center",vertical:"middle"},r.getCell("C8").value="규  격",r.getCell("C8").font={name:"GulimChe",size:11},r.getCell("C8").alignment={horizontal:"center",vertical:"middle"},r.getCell("D8").value="수 량",r.getCell("D8").font={name:"GulimChe",size:11},r.getCell("D8").alignment={horizontal:"center",vertical:"middle"},r.getCell("E8").value="단  가",r.getCell("E8").font={name:"GulimChe",size:11},r.getCell("E8").alignment={horizontal:"center",vertical:"middle"},r.getCell("F8").value="금  액",r.getCell("F8").font={name:"GulimChe",size:11},r.getCell("F8").alignment={horizontal:"center",vertical:"middle"},r.getCell("G8").value="비고 (사용 용도)",r.getCell("G8").font={name:"GulimChe",size:11},r.getCell("G8").alignment={horizontal:"center",vertical:"middle"};const s=9,i=38,m=[...t.items].sort((u,j)=>u.line_number-j.line_number),p=m.length,y=s+Math.max(p,i);for(let u=0;u<m.length;u++){const j=m[u],N=s+u;r.getCell("A"+N).value=j.line_number,r.getCell("A"+N).font={name:"GulimChe",size:11},r.getCell("A"+N).alignment={horizontal:"center",vertical:"middle"},r.getCell("B"+N).value=j.item_name,r.getCell("B"+N).font={name:"GulimChe",size:11},r.getCell("B"+N).alignment={horizontal:"left",vertical:"middle"},r.getCell("C"+N).value=j.specification,r.getCell("C"+N).font={name:"GulimChe",size:11},r.getCell("C"+N).alignment={horizontal:"left",vertical:"middle"},r.getCell("D"+N).value=j.quantity,r.getCell("D"+N).font={name:"GulimChe",size:11},r.getCell("D"+N).alignment={horizontal:"center",vertical:"middle"};const q=Fe(j.currency),I=j.unit_price_value!==void 0&&j.unit_price_value!==null?`${j.unit_price_value.toLocaleString()} ${q}`.trim():"";r.getCell("E"+N).value=I,r.getCell("E"+N).font={name:"GulimChe",size:11},r.getCell("E"+N).alignment={horizontal:"right",vertical:"middle"};const f=Fe(j.currency),g=j.amount_value!==void 0&&j.amount_value!==null?`${j.amount_value.toLocaleString()} ${f}`.trim():"";r.getCell("F"+N).value=g,r.getCell("F"+N).font={name:"GulimChe",size:11},r.getCell("F"+N).alignment={horizontal:"right",vertical:"middle"},r.getCell("G"+N).value=j.remark!==void 0&&j.remark!==null?String(j.remark):"",r.getCell("G"+N).font={name:"GulimChe",size:11},r.getCell("G"+N).alignment={horizontal:"center",vertical:"middle"}}for(let u=p;u<i;u++){const j=s+u;for(let N=0;N<7;N++)r.getCell(String.fromCharCode(65+N)+j).value=""}const d=p<38?"A47:E47":`A${y}:E${y}`;r.mergeCells(d);const h=p<38?47:y;r.getCell("A"+h).value="합계",r.getCell("A"+h).font={name:"GulimChe",size:11,bold:!0},r.getCell("A"+h).alignment={horizontal:"center",vertical:"middle"};const S=Fe(t.items[0]?.currency),P=t.items.reduce((u,j)=>u+(j.amount_value||0),0);r.getCell("F"+h).value=`${P.toLocaleString()} ${S}`.trim(),r.getCell("F"+h).font={name:"GulimChe",size:11},r.getCell("F"+h).alignment={horizontal:"right",vertical:"middle"};const D=h;for(let u=1;u<=D;u++)for(let j=1;j<=7;j++){const q=String.fromCharCode(64+j)+u,I=r.getCell(q),f=j===5||j===6,g=j===3,$=u>=s&&u<y;f&&($||u===y)||g&&$||(I.alignment={horizontal:"center",vertical:"middle"}),I.border={top:{style:u===1||u===2||u===8||u===h?"medium":"thin"},left:{style:j===1?"medium":"thin"},right:{style:j===7?"medium":"thin"},bottom:{style:u===8||u===h||u===D?"medium":"thin"}}}for(let u=2;u<=7;u++)r.getCell("B"+u).border={...r.getCell("B"+u).border,right:{style:"medium"}},r.getCell("D"+u).border={...r.getCell("D"+u).border,right:{style:"medium"}},u<=6&&(r.getCell("E"+u).border={...r.getCell("E"+u).border,right:{style:"medium"}});r.getCell("E7").border={...r.getCell("E7").border,top:{style:"thin"},right:{style:"medium"}},r.getCell("G7").border={...r.getCell("G7").border,top:{style:"thin"}};for(let u=1;u<=7;u++){const j=r.getCell("A"+u).border||{};r.getCell("A"+u).border={...j,left:{style:"medium"}}}const F=r.getCell("A"+h).border||{};r.getCell("A"+h).border={...F,left:{style:"medium"}},r.getColumn("A").width=6.33203125,r.getColumn("B").width=12.6640625,r.getColumn("C").width=31.6640625,r.getColumn("D").width=12.6640625,r.getColumn("E").width=15.6640625,r.getColumn("F").width=17.6640625,r.getColumn("G").width=39,r.getRow(1).height=39.75;for(let u=2;u<=D;u++)r.getRow(u).height=15.75;const X=await a.xlsx.writeBuffer();return new Blob([X],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}var ft="AlertDialog",[ta,jn]=tt(ft,[ot]),oe=ot(),ht=t=>{const{__scopeAlertDialog:n,...a}=t,r=oe(n);return e.jsx(it,{...r,...a,modal:!0})};ht.displayName=ft;var ra="AlertDialogTrigger",aa=l.forwardRef((t,n)=>{const{__scopeAlertDialog:a,...r}=t,s=oe(a);return e.jsx(zr,{...s,...r,ref:n})});aa.displayName=ra;var na="AlertDialogPortal",vt=t=>{const{__scopeAlertDialog:n,...a}=t,r=oe(n);return e.jsx(ct,{...r,...a})};vt.displayName=na;var la="AlertDialogOverlay",yt=l.forwardRef((t,n)=>{const{__scopeAlertDialog:a,...r}=t,s=oe(a);return e.jsx(ut,{...s,...r,ref:n})});yt.displayName=la;var fe="AlertDialogContent",[sa,oa]=ta(fe),ia=yr("AlertDialogContent"),_t=l.forwardRef((t,n)=>{const{__scopeAlertDialog:a,children:r,...s}=t,i=oe(a),m=l.useRef(null),p=Ae(n,m),y=l.useRef(null);return e.jsx(Fr,{contentName:fe,titleName:wt,docsSlug:"alert-dialog",children:e.jsx(sa,{scope:a,cancelRef:y,children:e.jsxs(dt,{role:"alertdialog",...i,...s,ref:p,onOpenAutoFocus:ge(s.onOpenAutoFocus,d=>{d.preventDefault(),y.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[e.jsx(ia,{children:r}),e.jsx(da,{contentRef:m})]})})})});_t.displayName=fe;var wt="AlertDialogTitle",jt=l.forwardRef((t,n)=>{const{__scopeAlertDialog:a,...r}=t,s=oe(a);return e.jsx(Rr,{...s,...r,ref:n})});jt.displayName=wt;var bt="AlertDialogDescription",Ct=l.forwardRef((t,n)=>{const{__scopeAlertDialog:a,...r}=t,s=oe(a);return e.jsx(Ir,{...s,...r,ref:n})});Ct.displayName=bt;var ca="AlertDialogAction",Nt=l.forwardRef((t,n)=>{const{__scopeAlertDialog:a,...r}=t,s=oe(a);return e.jsx(mt,{...s,...r,ref:n})});Nt.displayName=ca;var St="AlertDialogCancel",At=l.forwardRef((t,n)=>{const{__scopeAlertDialog:a,...r}=t,{cancelRef:s}=oa(St,a),i=oe(a),m=Ae(n,s);return e.jsx(mt,{...i,...r,ref:m})});At.displayName=St;var da=({contentRef:t})=>{const n=`\`${fe}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${fe}\` by passing a \`${bt}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${fe}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return l.useEffect(()=>{document.getElementById(t.current?.getAttribute("aria-describedby"))||console.warn(n)},[n,t]),null},ma=ht,ua=vt,Pt=yt,kt=_t,Et=Nt,Dt=At,$t=jt,Ft=Ct;const pa=ma,xa=ua,Rt=l.forwardRef(({className:t,...n},a)=>e.jsx(Pt,{className:W("fixed inset-0 z-50 bg-black/40 backdrop-blur-sm","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:a}));Rt.displayName=Pt.displayName;const It=l.forwardRef(({className:t,...n},a)=>e.jsxs(xa,{children:[e.jsx(Rt,{}),e.jsx(kt,{ref:a,className:W("fixed left-[50%] top-[50%] z-50","w-full max-w-md translate-x-[-50%] translate-y-[-50%]","grid gap-4 bg-white border border-gray-200","rounded-lg p-6 shadow-professional-xl","duration-200","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%]","data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%]",t),...n})]}));It.displayName=kt.displayName;const zt=({className:t,...n})=>e.jsx("div",{className:W("flex flex-col space-y-2 text-left",t),...n});zt.displayName="AlertDialogHeader";const Ot=({className:t,...n})=>e.jsx("div",{className:W("flex flex-col-reverse sm:flex-row sm:justify-end gap-3",t),...n});Ot.displayName="AlertDialogFooter";const qt=l.forwardRef(({className:t,...n},a)=>e.jsx($t,{ref:a,className:W("text-lg font-semibold text-gray-800 tracking-tight",t),...n}));qt.displayName=$t.displayName;const Mt=l.forwardRef(({className:t,...n},a)=>e.jsx(Ft,{ref:a,className:W("text-sm text-gray-600",t),...n}));Mt.displayName=Ft.displayName;const Gt=l.forwardRef(({className:t,...n},a)=>e.jsx(Et,{ref:a,className:W(rt(),t),...n}));Gt.displayName=Et.displayName;const Tt=l.forwardRef(({className:t,...n},a)=>e.jsx(Dt,{ref:a,className:W(rt({variant:"outline"}),"mt-2 sm:mt-0",t),...n}));Tt.displayName=Dt.displayName;const Me=l.memo(({purchase:t})=>{const n=t.is_received?"completed":t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"inProgress":t.middle_manager_status==="rejected"||t.final_manager_status==="rejected"?"rejected":"pending",a={completed:{text:"입고완료",className:"bg-green-100 text-green-800"},inProgress:{text:"구매진행",className:"bg-hansl-100 text-hansl-800"},rejected:{text:"반려",className:"bg-red-100 text-red-800"},pending:{text:"승인대기",className:"bg-yellow-100 text-yellow-800"}},{text:r,className:s}=a[n];return e.jsx(Y,{className:s,children:r})});Me.displayName="StatusBadge";const c={approvalStatus:"text-center w-20 min-w-[70px]",purchaseOrderNumber:"pl-2 w-32 min-w-[110px] sm:w-36 lg:w-40 xl:w-44",paymentCategory:"text-center w-20 min-w-[70px]",requesterName:"w-20 min-w-[60px]",requestDate:"w-20 min-w-[70px] lg:w-24",vendorName:"w-28 min-w-[90px] lg:w-32",contactName:"w-20 min-w-[60px]",deliveryRequestDate:"w-20 min-w-[70px] lg:w-24",itemName:"w-36 min-w-[120px] lg:w-44 xl:w-48",specification:"w-40 min-w-[140px] lg:w-48 xl:w-52",quantity:"text-center w-14 min-w-[45px]",unitPrice:"text-right w-20 min-w-[70px]",amount:"text-right w-24 min-w-[80px]",remark:"min-w-[150px] lg:min-w-[200px]",paymentSchedule:"w-20 min-w-[70px]",projectVendor:"w-28 min-w-[90px] lg:w-32",salesOrderNumber:"w-24 min-w-[80px] lg:w-28",projectItem:"w-28 min-w-[90px] lg:w-32",receiptProgress:"text-center w-20 min-w-[70px]",status:"text-center w-20 min-w-[70px]",receipt:"text-center w-20 min-w-[70px]",paymentStatus:"text-center w-16 min-w-[60px]",link:"w-20 min-w-[70px]"},Lt=l.memo(({purchase:t})=>{const n=t.middle_manager_status==="approved",a=t.middle_manager_status==="rejected",r=t.final_manager_status==="approved",s=t.final_manager_status==="rejected";return a||s?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"})}),e.jsx(Y,{className:"bg-red-100 text-red-800 text-[11px] font-medium px-1.5 py-0",children:"반려"})]}):n&&r?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsx("div",{className:"flex items-center gap-0.5",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"})}),e.jsx(Y,{className:"bg-green-100 text-green-800 text-[11px] font-medium px-1.5 py-0",children:"승인완료"})]}):n&&!r&&!s?e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(Y,{className:"bg-yellow-100 text-yellow-800 text-[11px] font-medium px-1.5 py-0",children:"1차 승인"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-3 h-0.5 bg-gray-300"}),e.jsx("div",{className:"w-1.5 h-1.5 bg-gray-300 rounded-full"})]}),e.jsx(Y,{className:"bg-gray-100 text-gray-600 text-[11px] font-medium px-1.5 py-0",children:"승인대기"})]})});Lt.displayName="ApprovalStatusBadge";const ga=t=>{if(t.is_received)return{received:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{received:0,total:1,percentage:0};const n=t.items.length,a=t.items.filter(s=>s.is_received===!0).length,r=n>0?Math.round(a/n*100):0;return{received:a,total:n,percentage:r}},fa=t=>{if(t.is_payment_completed)return{completed:1,total:1,percentage:100};if(!t.items||t.items.length===0)return{completed:0,total:1,percentage:0};const n=t.items.length,a=t.items.filter(s=>s.is_payment_completed===!0).length,r=n>0?Math.round(a/n*100):0;return{completed:a,total:n,percentage:r}},Ye=t=>{if(!t)return"-";const n=new Date(t);return`${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}`},ha=l.memo(({type:t})=>t==="선진행"||t?.includes("선진행")?e.jsx(Y,{className:"bg-red-500 text-white font-bold text-[11px] px-2 py-0.5",children:"선진행"}):e.jsx(Y,{className:"bg-gray-200 text-gray-700 text-[11px] px-2 py-0.5",children:"일반"}));ha.displayName="ProgressTypeBadge";const Bt=l.memo(({purchase:t,onClick:n,activeTab:a,isLeadBuyer:r,onPaymentComplete:s,onReceiptComplete:i,onExcelDownload:m})=>{const p=ga(t),y=fa(t),d=t.progress_type==="선진행"||t.progress_type?.includes("선진행");return e.jsxs("tr",{className:`border-b hover:bg-gray-100 cursor-pointer transition-colors ${d?"bg-red-50 hover:bg-red-100":""}`,onClick:()=>n(t),children:[a==="pending"&&e.jsx("td",{className:`px-2 py-1.5 whitespace-nowrap ${c.approvalStatus}`,children:e.jsx(Lt,{purchase:t})}),a==="purchase"&&e.jsx("td",{className:`px-2 py-1.5 ${c.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${y.percentage===100?"bg-blue-500":y.percentage>0?"bg-blue-400":"bg-gray-300"}`,style:{width:`${y.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[y.percentage,"%"]})]})}),a==="receipt"&&e.jsx("td",{className:`px-2 py-1.5 ${c.receiptProgress}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${p.percentage===100?"bg-green-500":p.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${p.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[p.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 font-medium text-[11px] whitespace-nowrap ${c.purchaseOrderNumber}`,children:e.jsxs("div",{className:"flex items-center gap-1",children:[m&&e.jsx("img",{src:"/excels-icon.svg",alt:"엑셀 다운로드",width:"16",height:"16",className:`inline-block align-middle transition-transform p-0.5 rounded
                ${t.is_po_download?"border border-gray-400":""}
                ${t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?t.is_po_download?"cursor-pointer":"cursor-pointer hover:scale-110":"opacity-40 grayscale cursor-not-allowed"}`,onClick:async h=>{(t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved")&&(h.stopPropagation(),await m(t))},style:{pointerEvents:t.progress_type==="선진행"||t.progress_type?.includes("선진행")||t.middle_manager_status==="approved"&&t.final_manager_status==="approved"?"auto":"none"},title:t.is_po_download?"다운로드 완료":"엑셀 발주서 다운로드"}),e.jsx("span",{className:"block truncate",title:t.purchase_order_number||"",children:t.purchase_order_number||"-"})]})}),(a==="pending"||a==="receipt"||a==="done"||!a)&&e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.paymentCategory}`,children:e.jsx(Y,{className:`text-[11px] ${t.payment_category==="구매 요청"?"bg-blue-100 text-blue-800":t.payment_category==="발주"?"bg-green-100 text-green-800":t.payment_category==="경비 청구"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.payment_category==="구매 요청"?"구매요청":t.payment_category==="발주"?"발주요청":t.payment_category||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.requesterName}`,children:e.jsx("span",{className:"block truncate",title:t.requester_name||"",children:t.requester_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.requestDate}`,children:Ye(t.request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.vendorName}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_name||"",children:t.vendor_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.contactName}`,children:e.jsx("span",{className:"block truncate",title:t.contact_name||"",children:t.contact_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.deliveryRequestDate}`,children:Ye(t.delivery_request_date)}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.itemName}`,children:e.jsx("span",{className:"block truncate",title:t.item_name||"",children:t.item_name||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.specification}`,children:e.jsx("span",{className:"block truncate",title:t.specification||"",children:t.specification||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.quantity}`,children:t.quantity||0}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.unitPrice}`,children:t.unit_price_value?.toLocaleString()||0}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] font-medium whitespace-nowrap ${c.amount}`,children:t.amount_value?.toLocaleString()||t.total_amount?.toLocaleString()||0}),a==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})})]}),a==="purchase"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"링크 보기"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),a==="receipt"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})})]}),(a==="done"||!a)&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.remark}`,children:e.jsx("span",{className:"block truncate",title:t.remark||"",children:t.remark||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.link}`,children:t.link?e.jsx("a",{href:t.link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline truncate block",title:t.link,children:"링크 보기"}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.projectVendor}`,children:e.jsx("span",{className:"block truncate",title:t.project_vendor||"",children:t.project_vendor||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] ${c.projectItem}`,children:e.jsx("span",{className:"block truncate",title:t.project_item||"",children:t.project_item||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.salesOrderNumber}`,children:e.jsx("span",{className:"block truncate",title:t.sales_order_number||"",children:t.sales_order_number||"-"})}),e.jsx("td",{className:`px-2 py-1.5 text-[11px] whitespace-nowrap ${c.paymentSchedule}`,children:e.jsx("span",{className:"block truncate",title:t.vendor_payment_schedule||"",children:t.vendor_payment_schedule||"-"})}),e.jsx("td",{className:`px-2 py-1.5 ${c.status}`,children:e.jsx(Me,{purchase:t})}),e.jsx("td",{className:`px-2 py-1.5 ${c.receipt}`,children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("div",{className:"bg-gray-200 rounded-full h-1.5 w-8",children:e.jsx("div",{className:`h-1.5 rounded-full ${p.percentage===100?"bg-green-500":p.percentage>0?"bg-hansl-500":"bg-gray-300"}`,style:{width:`${p.percentage}%`}})}),e.jsxs("span",{className:"text-[11px] text-gray-600",children:[p.percentage,"%"]})]})}),e.jsx("td",{className:`px-2 py-1.5 ${c.paymentStatus}`,children:t.is_payment_completed?e.jsx(Y,{className:"bg-green-100 text-green-800 text-[11px]",children:"완료"}):e.jsx(Y,{className:"bg-gray-100 text-gray-800 text-[11px]",children:"대기"})})]})]})});Bt.displayName="TableRow";const Vt=l.memo(({purchases:t,activeTab:n="done",currentUserRoles:a=[],onRefresh:r,onPaymentComplete:s,onReceiptComplete:i})=>{const[m,p]=l.useState(null),[y,d]=l.useState(!1),[h,S]=l.useState(!1),[P,D]=l.useState(null),F=Se(),X=a&&(a.includes("raw_material_manager")||a.includes("consumable_manager")||a.includes("purchase_manager")||a.includes("app_admin"));a.includes("final_approver")||a.includes("app_admin")||a.includes("ceo");const u=f=>{p(f.id),d(!0)},j=()=>{d(!1),p(null)},N=async f=>{try{const{data:g,error:$}=await F.from("purchase_requests").select("*").eq("purchase_order_number",f.purchase_order_number).single();if($||!g){te.error("해당 발주요청번호의 데이터를 찾을 수 없습니다.");return}const{data:b,error:G}=await F.from("purchase_request_items").select("*").eq("purchase_order_number",f.purchase_order_number).order("line_number");if(G||!b||b.length===0){te.error("해당 발주요청번호의 품목 데이터를 찾을 수 없습니다.");return}const M={vendor_name:f.vendor_name,vendor_phone:"",vendor_fax:"",vendor_contact_name:"",vendor_payment_schedule:""};try{const O=g.vendor_id||f.vendor_id,Z=g.contact_id||f.contact_id;if(O){const{data:J}=await F.from("vendors").select("vendor_phone, vendor_fax, vendor_payment_schedule").eq("id",O).single();J&&(M.vendor_phone=J.vendor_phone||"",M.vendor_fax=J.vendor_fax||"",M.vendor_payment_schedule=J.vendor_payment_schedule||"")}if(Z){const{data:J}=await F.from("vendor_contacts").select("contact_name, contact_phone, contact_email").eq("id",Z).single();J&&(M.vendor_contact_name=J.contact_name||"")}}catch{}const z={purchase_order_number:g.purchase_order_number||"",request_date:g.request_date,delivery_request_date:g.delivery_request_date,requester_name:g.requester_name,vendor_name:M.vendor_name||"",vendor_contact_name:M.vendor_contact_name,vendor_phone:M.vendor_phone,vendor_fax:M.vendor_fax,project_vendor:g.project_vendor,sales_order_number:g.sales_order_number,project_item:g.project_item,vendor_payment_schedule:M.vendor_payment_schedule,items:b.map(O=>({line_number:O.line_number,item_name:O.item_name,specification:O.specification,quantity:O.quantity,unit_price_value:O.unit_price_value,amount_value:O.amount_value,remark:O.remark,currency:g.currency||"KRW"}))},ee=await ea(z),B=`발주서_${z.vendor_name}_${z.purchase_order_number}.xlsx`,K=window.URL.createObjectURL(ee),V=document.createElement("a");V.href=K,V.download=B,document.body.appendChild(V),V.click(),document.body.removeChild(V),window.URL.revokeObjectURL(K),te.success("엑셀 파일이 다운로드되었습니다.");try{if(a&&a.includes("lead buyer")){const{error:Z}=await F.from("purchase_requests").update({is_po_download:!0}).eq("purchase_order_number",f.purchase_order_number);Z||r?.()}}catch{}}catch{te.error("엑셀 다운로드에 실패했습니다.")}},q=async()=>{if(P){try{const{error:f}=await F.from("purchase_request_items").delete().eq("purchase_request_id",P.id);if(f)throw f;const{error:g}=await F.from("purchase_requests").delete().eq("id",P.id);if(g)throw g;te.success("발주요청 내역이 삭제되었습니다."),r?.()}catch{te.error("삭제 중 오류가 발생했습니다.")}S(!1),D(null)}},I=l.useMemo(()=>{if(n==="pending")return e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.approvalStatus}`,children:"승인상태"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.purchaseOrderNumber}`,children:"발주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.paymentCategory}`,children:"결제종류"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.requesterName}`,children:"요청자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.requestDate}`,children:"청구일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${c.vendorName}`,children:"업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.contactName}`,children:"담당자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.deliveryRequestDate}`,children:"입고요청일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${c.itemName}`,children:"품명"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${c.specification}`,children:"규격"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.quantity}`,children:"수량"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.unitPrice}`,children:"단가"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.amount}`,children:"금액"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.salesOrderNumber}`,children:"수주번호"})]})});const f=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.purchaseOrderNumber}`,children:"발주번호"}),(n==="receipt"||n==="done"||!n)&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.paymentCategory}`,children:"결제종류"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.requesterName}`,children:"요청자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.requestDate}`,children:"청구일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.vendorName}`,children:"업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.contactName}`,children:"담당자"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.deliveryRequestDate}`,children:"입고요청일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${c.itemName}`,children:"품명"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] text-left ${c.specification}`,children:"규격"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.quantity}`,children:"수량"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.unitPrice}`,children:"단가"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.amount}`,children:"금액"})]});let g=null;return n==="purchase"?g=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.link}`,children:"링크"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.paymentSchedule}`,children:"지출예정일"})]}):n==="receipt"?g=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.salesOrderNumber}`,children:"수주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.paymentSchedule}`,children:"지출예정일"})]}):g=e.jsxs(e.Fragment,{children:[e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.remark}`,children:"비고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.link}`,children:"링크"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.projectVendor}`,children:"PJ업체"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.projectItem}`,children:"PJ ITEM"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.salesOrderNumber}`,children:"수주번호"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap text-left ${c.paymentSchedule}`,children:"지출예정일"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.status}`,children:"상태"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.receipt}`,children:"입고"}),e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.paymentStatus}`,children:"결제"})]}),e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[n==="purchase"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.receiptProgress}`,children:"구매진행"}),n==="receipt"&&e.jsx("th",{className:`px-2 py-1.5 font-medium text-gray-900 text-[11px] whitespace-nowrap ${c.receiptProgress}`,children:"입고진행"}),f,g]})})},[n]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-fit",children:[I,e.jsx("tbody",{children:t.map(f=>e.jsx(Bt,{purchase:f,onClick:u,activeTab:n,isLeadBuyer:X,onPaymentComplete:s,onReceiptComplete:i,onExcelDownload:N},f.id))})]})})}),e.jsx("div",{className:"hidden sm:block md:hidden w-full",children:e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full min-w-[640px] text-[11px]",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-20 sm:w-24",children:"발주번호"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-16 sm:w-20",children:"요청자"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 w-24 sm:w-28",children:"업체"}),e.jsx("th",{className:"text-left p-2 font-medium text-gray-900 min-w-[100px]",children:"품명"}),e.jsx("th",{className:"text-right p-2 font-medium text-gray-900 w-20 sm:w-24",children:"금액"}),e.jsx("th",{className:"text-center p-2 font-medium text-gray-900 w-16 sm:w-20",children:"상태"})]})}),e.jsx("tbody",{children:t.map(f=>e.jsxs("tr",{className:"border-b hover:bg-gray-50 cursor-pointer",onClick:()=>u(f),children:[e.jsx("td",{className:"p-2 font-medium",children:f.purchase_order_number||"-"}),e.jsx("td",{className:"p-2",children:f.requester_name}),e.jsx("td",{className:"p-2 truncate",title:f.vendor_name,children:f.vendor_name}),e.jsx("td",{className:"p-2 truncate",title:f.item_name,children:f.item_name||"-"}),e.jsx("td",{className:"p-2 text-right font-medium",children:f.amount_value?.toLocaleString()||f.total_amount?.toLocaleString()||0}),e.jsx("td",{className:"p-2 text-center",children:e.jsx(Me,{purchase:f})})]},f.id))})]})})}),e.jsx("div",{className:"sm:hidden space-y-3",children:t.map(f=>e.jsx(gt,{purchase:f,onClick:()=>u(f)},f.id))}),e.jsx(Pr,{purchaseId:m,isOpen:y,onClose:j,currentUserRoles:a,activeTab:n,onRefresh:r,onDelete:f=>{D(f),S(!0)}}),e.jsx(pa,{open:h,onOpenChange:S,children:e.jsxs(It,{children:[e.jsxs(zt,{children:[e.jsx(qt,{children:"발주요청 내역 삭제"}),e.jsxs(Mt,{children:["발주요청번호 ",P?.purchase_order_number,"를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."]})]}),e.jsxs(Ot,{children:[e.jsx(Tt,{children:"취소"}),e.jsx(Gt,{onClick:q,className:"bg-red-600 hover:bg-red-700",children:"삭제"})]})]})})]})});Vt.displayName="FastPurchaseTable";var Ue=1,va=.9,ya=.8,_a=.17,Re=.1,Ie=.999,wa=.9999,ja=.99,ba=/[\\\/_+.#"@\[\(\{&]/,Ca=/[\\\/_+.#"@\[\(\{&]/g,Na=/[\s-]/,Jt=/[\s-]/g;function Oe(t,n,a,r,s,i,m){if(i===n.length)return s===t.length?Ue:ja;var p=`${s},${i}`;if(m[p]!==void 0)return m[p];for(var y=r.charAt(i),d=a.indexOf(y,s),h=0,S,P,D,F;d>=0;)S=Oe(t,n,a,r,d+1,i+1,m),S>h&&(d===s?S*=Ue:ba.test(t.charAt(d-1))?(S*=ya,D=t.slice(s,d-1).match(Ca),D&&s>0&&(S*=Math.pow(Ie,D.length))):Na.test(t.charAt(d-1))?(S*=va,F=t.slice(s,d-1).match(Jt),F&&s>0&&(S*=Math.pow(Ie,F.length))):(S*=_a,s>0&&(S*=Math.pow(Ie,d-s))),t.charAt(d)!==n.charAt(i)&&(S*=wa)),(S<Re&&a.charAt(d-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&a.charAt(d-1)!==r.charAt(i))&&(P=Oe(t,n,a,r,d+1,i+2,m),P*Re>S&&(S=P*Re)),S>h&&(h=S),d=a.indexOf(y,d+1);return m[p]=h,h}function Xe(t){return t.toLowerCase().replace(Jt," ")}function Sa(t,n,a){return t=a&&a.length>0?`${t+" "+a.join(" ")}`:t,Oe(t,n,Xe(t),Xe(n),0,0,{})}var je='[cmdk-group=""]',ze='[cmdk-group-items=""]',Aa='[cmdk-group-heading=""]',Ht='[cmdk-item=""]',Ze=`${Ht}:not([aria-disabled="true"])`,qe="cmdk-item-select",pe="data-value",Pa=(t,n,a)=>Sa(t,n,a),Wt=l.createContext(void 0),Ce=()=>l.useContext(Wt),Kt=l.createContext(void 0),Ge=()=>l.useContext(Kt),Yt=l.createContext(void 0),Ut=l.forwardRef((t,n)=>{let a=xe(()=>{var o,C;return{search:"",value:(C=(o=t.value)!=null?o:t.defaultValue)!=null?C:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=xe(()=>new Set),s=xe(()=>new Map),i=xe(()=>new Map),m=xe(()=>new Set),p=Xt(t),{label:y,children:d,value:h,onValueChange:S,filter:P,shouldFilter:D,loop:F,disablePointerSelection:X=!1,vimBindings:u=!0,...j}=t,N=de(),q=de(),I=de(),f=l.useRef(null),g=Ma();me(()=>{if(h!==void 0){let o=h.trim();a.current.value=o,$.emit()}},[h]),me(()=>{g(6,B)},[]);let $=l.useMemo(()=>({subscribe:o=>(m.current.add(o),()=>m.current.delete(o)),snapshot:()=>a.current,setState:(o,C,k)=>{var v,E,x,R;if(!Object.is(a.current[o],C)){if(a.current[o]=C,o==="search")ee(),M(),g(1,z);else if(o==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let H=document.getElementById(I);H?H.focus():(v=document.getElementById(N))==null||v.focus()}if(g(7,()=>{var H;a.current.selectedItemId=(H=K())==null?void 0:H.id,$.emit()}),k||g(5,B),((E=p.current)==null?void 0:E.value)!==void 0){let H=C??"";(R=(x=p.current).onValueChange)==null||R.call(x,H);return}}$.emit()}},emit:()=>{m.current.forEach(o=>o())}}),[]),b=l.useMemo(()=>({value:(o,C,k)=>{var v;C!==((v=i.current.get(o))==null?void 0:v.value)&&(i.current.set(o,{value:C,keywords:k}),a.current.filtered.items.set(o,G(C,k)),g(2,()=>{M(),$.emit()}))},item:(o,C)=>(r.current.add(o),C&&(s.current.has(C)?s.current.get(C).add(o):s.current.set(C,new Set([o]))),g(3,()=>{ee(),M(),a.current.value||z(),$.emit()}),()=>{i.current.delete(o),r.current.delete(o),a.current.filtered.items.delete(o);let k=K();g(4,()=>{ee(),k?.getAttribute("id")===o&&z(),$.emit()})}),group:o=>(s.current.has(o)||s.current.set(o,new Set),()=>{i.current.delete(o),s.current.delete(o)}),filter:()=>p.current.shouldFilter,label:y||t["aria-label"],getDisablePointerSelection:()=>p.current.disablePointerSelection,listId:N,inputId:I,labelId:q,listInnerRef:f}),[]);function G(o,C){var k,v;let E=(v=(k=p.current)==null?void 0:k.filter)!=null?v:Pa;return o?E(o,a.current.search,C):0}function M(){if(!a.current.search||p.current.shouldFilter===!1)return;let o=a.current.filtered.items,C=[];a.current.filtered.groups.forEach(v=>{let E=s.current.get(v),x=0;E.forEach(R=>{let H=o.get(R);x=Math.max(H,x)}),C.push([v,x])});let k=f.current;V().sort((v,E)=>{var x,R;let H=v.getAttribute("id"),w=E.getAttribute("id");return((x=o.get(w))!=null?x:0)-((R=o.get(H))!=null?R:0)}).forEach(v=>{let E=v.closest(ze);E?E.appendChild(v.parentElement===E?v:v.closest(`${ze} > *`)):k.appendChild(v.parentElement===k?v:v.closest(`${ze} > *`))}),C.sort((v,E)=>E[1]-v[1]).forEach(v=>{var E;let x=(E=f.current)==null?void 0:E.querySelector(`${je}[${pe}="${encodeURIComponent(v[0])}"]`);x?.parentElement.appendChild(x)})}function z(){let o=V().find(k=>k.getAttribute("aria-disabled")!=="true"),C=o?.getAttribute(pe);$.setState("value",C||void 0)}function ee(){var o,C,k,v;if(!a.current.search||p.current.shouldFilter===!1){a.current.filtered.count=r.current.size;return}a.current.filtered.groups=new Set;let E=0;for(let x of r.current){let R=(C=(o=i.current.get(x))==null?void 0:o.value)!=null?C:"",H=(v=(k=i.current.get(x))==null?void 0:k.keywords)!=null?v:[],w=G(R,H);a.current.filtered.items.set(x,w),w>0&&E++}for(let[x,R]of s.current)for(let H of R)if(a.current.filtered.items.get(H)>0){a.current.filtered.groups.add(x);break}a.current.filtered.count=E}function B(){var o,C,k;let v=K();v&&(((o=v.parentElement)==null?void 0:o.firstChild)===v&&((k=(C=v.closest(je))==null?void 0:C.querySelector(Aa))==null||k.scrollIntoView({block:"nearest"})),v.scrollIntoView({block:"nearest"}))}function K(){var o;return(o=f.current)==null?void 0:o.querySelector(`${Ht}[aria-selected="true"]`)}function V(){var o;return Array.from(((o=f.current)==null?void 0:o.querySelectorAll(Ze))||[])}function O(o){let C=V()[o];C&&$.setState("value",C.getAttribute(pe))}function Z(o){var C;let k=K(),v=V(),E=v.findIndex(R=>R===k),x=v[E+o];(C=p.current)!=null&&C.loop&&(x=E+o<0?v[v.length-1]:E+o===v.length?v[0]:v[E+o]),x&&$.setState("value",x.getAttribute(pe))}function J(o){let C=K(),k=C?.closest(je),v;for(;k&&!v;)k=o>0?Oa(k,je):qa(k,je),v=k?.querySelector(Ze);v?$.setState("value",v.getAttribute(pe)):Z(o)}let ae=()=>O(V().length-1),ne=o=>{o.preventDefault(),o.metaKey?ae():o.altKey?J(1):Z(1)},le=o=>{o.preventDefault(),o.metaKey?O(0):o.altKey?J(-1):Z(-1)};return l.createElement(re.div,{ref:n,tabIndex:-1,...j,"cmdk-root":"",onKeyDown:o=>{var C;(C=j.onKeyDown)==null||C.call(j,o);let k=o.nativeEvent.isComposing||o.keyCode===229;if(!(o.defaultPrevented||k))switch(o.key){case"n":case"j":{u&&o.ctrlKey&&ne(o);break}case"ArrowDown":{ne(o);break}case"p":case"k":{u&&o.ctrlKey&&le(o);break}case"ArrowUp":{le(o);break}case"Home":{o.preventDefault(),O(0);break}case"End":{o.preventDefault(),ae();break}case"Enter":{o.preventDefault();let v=K();if(v){let E=new Event(qe);v.dispatchEvent(E)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:b.inputId,id:b.labelId,style:Ta},y),Pe(t,o=>l.createElement(Kt.Provider,{value:$},l.createElement(Wt.Provider,{value:b},o))))}),ka=l.forwardRef((t,n)=>{var a,r;let s=de(),i=l.useRef(null),m=l.useContext(Yt),p=Ce(),y=Xt(t),d=(r=(a=y.current)==null?void 0:a.forceMount)!=null?r:m?.forceMount;me(()=>{if(!d)return p.item(s,m?.id)},[d]);let h=Zt(s,i,[t.value,t.children,i],t.keywords),S=Ge(),P=ie(g=>g.value&&g.value===h.current),D=ie(g=>d||p.filter()===!1?!0:g.search?g.filtered.items.get(s)>0:!0);l.useEffect(()=>{let g=i.current;if(!(!g||t.disabled))return g.addEventListener(qe,F),()=>g.removeEventListener(qe,F)},[D,t.onSelect,t.disabled]);function F(){var g,$;X(),($=(g=y.current).onSelect)==null||$.call(g,h.current)}function X(){S.setState("value",h.current,!0)}if(!D)return null;let{disabled:u,value:j,onSelect:N,forceMount:q,keywords:I,...f}=t;return l.createElement(re.div,{ref:be(i,n),...f,id:s,"cmdk-item":"",role:"option","aria-disabled":!!u,"aria-selected":!!P,"data-disabled":!!u,"data-selected":!!P,onPointerMove:u||p.getDisablePointerSelection()?void 0:X,onClick:u?void 0:F},t.children)}),Ea=l.forwardRef((t,n)=>{let{heading:a,children:r,forceMount:s,...i}=t,m=de(),p=l.useRef(null),y=l.useRef(null),d=de(),h=Ce(),S=ie(D=>s||h.filter()===!1?!0:D.search?D.filtered.groups.has(m):!0);me(()=>h.group(m),[]),Zt(m,p,[t.value,t.heading,y]);let P=l.useMemo(()=>({id:m,forceMount:s}),[s]);return l.createElement(re.div,{ref:be(p,n),...i,"cmdk-group":"",role:"presentation",hidden:S?void 0:!0},a&&l.createElement("div",{ref:y,"cmdk-group-heading":"","aria-hidden":!0,id:d},a),Pe(t,D=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":a?d:void 0},l.createElement(Yt.Provider,{value:P},D))))}),Da=l.forwardRef((t,n)=>{let{alwaysRender:a,...r}=t,s=l.useRef(null),i=ie(m=>!m.search);return!a&&!i?null:l.createElement(re.div,{ref:be(s,n),...r,"cmdk-separator":"",role:"separator"})}),$a=l.forwardRef((t,n)=>{let{onValueChange:a,...r}=t,s=t.value!=null,i=Ge(),m=ie(d=>d.search),p=ie(d=>d.selectedItemId),y=Ce();return l.useEffect(()=>{t.value!=null&&i.setState("search",t.value)},[t.value]),l.createElement(re.input,{ref:n,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":y.listId,"aria-labelledby":y.labelId,"aria-activedescendant":p,id:y.inputId,type:"text",value:s?t.value:m,onChange:d=>{s||i.setState("search",d.target.value),a?.(d.target.value)}})}),Fa=l.forwardRef((t,n)=>{let{children:a,label:r="Suggestions",...s}=t,i=l.useRef(null),m=l.useRef(null),p=ie(d=>d.selectedItemId),y=Ce();return l.useEffect(()=>{if(m.current&&i.current){let d=m.current,h=i.current,S,P=new ResizeObserver(()=>{S=requestAnimationFrame(()=>{let D=d.offsetHeight;h.style.setProperty("--cmdk-list-height",D.toFixed(1)+"px")})});return P.observe(d),()=>{cancelAnimationFrame(S),P.unobserve(d)}}},[]),l.createElement(re.div,{ref:be(i,n),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":p,"aria-label":r,id:y.listId},Pe(t,d=>l.createElement("div",{ref:be(m,y.listInnerRef),"cmdk-list-sizer":""},d)))}),Ra=l.forwardRef((t,n)=>{let{open:a,onOpenChange:r,overlayClassName:s,contentClassName:i,container:m,...p}=t;return l.createElement(it,{open:a,onOpenChange:r},l.createElement(ct,{container:m},l.createElement(ut,{"cmdk-overlay":"",className:s}),l.createElement(dt,{"aria-label":t.label,"cmdk-dialog":"",className:i},l.createElement(Ut,{ref:n,...p}))))}),Ia=l.forwardRef((t,n)=>ie(a=>a.filtered.count===0)?l.createElement(re.div,{ref:n,...t,"cmdk-empty":"",role:"presentation"}):null),za=l.forwardRef((t,n)=>{let{progress:a,children:r,label:s="Loading...",...i}=t;return l.createElement(re.div,{ref:n,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},Pe(t,m=>l.createElement("div",{"aria-hidden":!0},m)))}),U=Object.assign(Ut,{List:Fa,Item:ka,Input:$a,Group:Ea,Separator:Da,Dialog:Ra,Empty:Ia,Loading:za});function Oa(t,n){let a=t.nextElementSibling;for(;a;){if(a.matches(n))return a;a=a.nextElementSibling}}function qa(t,n){let a=t.previousElementSibling;for(;a;){if(a.matches(n))return a;a=a.previousElementSibling}}function Xt(t){let n=l.useRef(t);return me(()=>{n.current=t}),n}var me=typeof window>"u"?l.useEffect:l.useLayoutEffect;function xe(t){let n=l.useRef();return n.current===void 0&&(n.current=t()),n}function ie(t){let n=Ge(),a=()=>t(n.snapshot());return l.useSyncExternalStore(n.subscribe,a,a)}function Zt(t,n,a,r=[]){let s=l.useRef(),i=Ce();return me(()=>{var m;let p=(()=>{var d;for(let h of a){if(typeof h=="string")return h.trim();if(typeof h=="object"&&"current"in h)return h.current?(d=h.current.textContent)==null?void 0:d.trim():s.current}})(),y=r.map(d=>d.trim());i.value(t,p,y),(m=n.current)==null||m.setAttribute(pe,p),s.current=p}),s}var Ma=()=>{let[t,n]=l.useState(),a=xe(()=>new Map);return me(()=>{a.current.forEach(r=>r()),a.current=new Map},[t]),(r,s)=>{a.current.set(r,s),n({})}};function Ga(t){let n=t.type;return typeof n=="function"?n(t.props):"render"in n?n.render(t.props):t}function Pe({asChild:t,children:n},a){return t&&l.isValidElement(n)?l.cloneElement(Ga(n),{ref:n.ref},a(n.props.children)):a(n)}var Ta={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Qt=l.forwardRef(({className:t,...n},a)=>e.jsx(U,{ref:a,className:W("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...n}));Qt.displayName=U.displayName;const er=l.forwardRef(({className:t,...n},a)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(pt,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(U.Input,{ref:a,className:W("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...n})]}));er.displayName=U.Input.displayName;const La=l.forwardRef(({className:t,...n},a)=>e.jsx(U.List,{ref:a,className:W("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...n}));La.displayName=U.List.displayName;const tr=l.forwardRef((t,n)=>e.jsx(U.Empty,{ref:n,className:"py-6 text-center text-sm",...t}));tr.displayName=U.Empty.displayName;const rr=l.forwardRef(({className:t,...n},a)=>e.jsx(U.Group,{ref:a,className:W("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...n}));rr.displayName=U.Group.displayName;const Ba=l.forwardRef(({className:t,...n},a)=>e.jsx(U.Separator,{ref:a,className:W("-mx-1 h-px bg-border",t),...n}));Ba.displayName=U.Separator.displayName;const ar=l.forwardRef(({className:t,...n},a)=>e.jsx(U.Item,{ref:a,className:W("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",t),...n}));ar.displayName=U.Item.displayName;var ke="Popover",[nr,bn]=tt(ke,[at]),Ne=at(),[Va,ce]=nr(ke),lr=t=>{const{__scopePopover:n,children:a,open:r,defaultOpen:s,onOpenChange:i,modal:m=!1}=t,p=Ne(n),y=l.useRef(null),[d,h]=l.useState(!1),[S,P]=_r({prop:r,defaultProp:s??!1,onChange:i,caller:ke});return e.jsx(wr,{...p,children:e.jsx(Va,{scope:n,contentId:de(),triggerRef:y,open:S,onOpenChange:P,onOpenToggle:l.useCallback(()=>P(D=>!D),[P]),hasCustomAnchor:d,onCustomAnchorAdd:l.useCallback(()=>h(!0),[]),onCustomAnchorRemove:l.useCallback(()=>h(!1),[]),modal:m,children:a})})};lr.displayName=ke;var sr="PopoverAnchor",Ja=l.forwardRef((t,n)=>{const{__scopePopover:a,...r}=t,s=ce(sr,a),i=Ne(a),{onCustomAnchorAdd:m,onCustomAnchorRemove:p}=s;return l.useEffect(()=>(m(),()=>p()),[m,p]),e.jsx(nt,{...i,...r,ref:n})});Ja.displayName=sr;var or="PopoverTrigger",ir=l.forwardRef((t,n)=>{const{__scopePopover:a,...r}=t,s=ce(or,a),i=Ne(a),m=Ae(n,s.triggerRef),p=e.jsx(re.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":pr(s.open),...r,ref:m,onClick:ge(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?p:e.jsx(nt,{asChild:!0,...i,children:p})});ir.displayName=or;var Te="PopoverPortal",[Ha,Wa]=nr(Te,{forceMount:void 0}),cr=t=>{const{__scopePopover:n,forceMount:a,children:r,container:s}=t,i=ce(Te,n);return e.jsx(Ha,{scope:n,forceMount:a,children:e.jsx(lt,{present:a||i.open,children:e.jsx(Or,{asChild:!0,container:s,children:r})})})};cr.displayName=Te;var he="PopoverContent",dr=l.forwardRef((t,n)=>{const a=Wa(he,t.__scopePopover),{forceMount:r=a.forceMount,...s}=t,i=ce(he,t.__scopePopover);return e.jsx(lt,{present:r||i.open,children:i.modal?e.jsx(Ya,{...s,ref:n}):e.jsx(Ua,{...s,ref:n})})});dr.displayName=he;var Ka=jr("PopoverContent.RemoveScroll"),Ya=l.forwardRef((t,n)=>{const a=ce(he,t.__scopePopover),r=l.useRef(null),s=Ae(n,r),i=l.useRef(!1);return l.useEffect(()=>{const m=r.current;if(m)return qr(m)},[]),e.jsx(Mr,{as:Ka,allowPinchZoom:!0,children:e.jsx(mr,{...t,ref:s,trapFocus:a.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(t.onCloseAutoFocus,m=>{m.preventDefault(),i.current||a.triggerRef.current?.focus()}),onPointerDownOutside:ge(t.onPointerDownOutside,m=>{const p=m.detail.originalEvent,y=p.button===0&&p.ctrlKey===!0,d=p.button===2||y;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:ge(t.onFocusOutside,m=>m.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ua=l.forwardRef((t,n)=>{const a=ce(he,t.__scopePopover),r=l.useRef(!1),s=l.useRef(!1);return e.jsx(mr,{...t,ref:n,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{t.onCloseAutoFocus?.(i),i.defaultPrevented||(r.current||a.triggerRef.current?.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{t.onInteractOutside?.(i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const m=i.target;a.triggerRef.current?.contains(m)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),mr=l.forwardRef((t,n)=>{const{__scopePopover:a,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:m,onEscapeKeyDown:p,onPointerDownOutside:y,onFocusOutside:d,onInteractOutside:h,...S}=t,P=ce(he,a),D=Ne(a);return Gr(),e.jsx(Tr,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:e.jsx(br,{asChild:!0,disableOutsidePointerEvents:m,onInteractOutside:h,onEscapeKeyDown:p,onPointerDownOutside:y,onFocusOutside:d,onDismiss:()=>P.onOpenChange(!1),children:e.jsx(Cr,{"data-state":pr(P.open),role:"dialog",id:P.contentId,...D,...S,ref:n,style:{...S.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),ur="PopoverClose",Xa=l.forwardRef((t,n)=>{const{__scopePopover:a,...r}=t,s=ce(ur,a);return e.jsx(re.button,{type:"button",...r,ref:n,onClick:ge(t.onClick,()=>s.onOpenChange(!1))})});Xa.displayName=ur;var Za="PopoverArrow",Qa=l.forwardRef((t,n)=>{const{__scopePopover:a,...r}=t,s=Ne(a);return e.jsx(Nr,{...s,...r,ref:n})});Qa.displayName=Za;function pr(t){return t?"open":"closed"}var en=lr,tn=ir,rn=cr,an=dr;function nn({...t}){return e.jsx(en,{"data-slot":"popover",...t})}function ln({...t}){return e.jsx(tn,{"data-slot":"popover-trigger",...t})}function sn({className:t,align:n="center",sideOffset:a=4,...r}){return e.jsx(rn,{children:e.jsx(an,{"data-slot":"popover-content",align:n,sideOffset:a,className:W("z-50 w-72","bg-white text-gray-800 rounded-professional","border border-gray-200 p-4","shadow-professional-lg outline-hidden","origin-(--radix-popover-content-transform-origin)","data-[state=open]:animate-in data-[state=closed]:animate-out","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0","data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95","data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2","data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})}function on({options:t,value:n,onValueChange:a,placeholder:r="선택...",searchPlaceholder:s="검색...",emptyText:i="결과가 없습니다.",className:m}){const[p,y]=l.useState(!1);return e.jsxs(nn,{open:p,onOpenChange:y,children:[e.jsx(ln,{asChild:!0,children:e.jsxs(st,{variant:"outline",role:"combobox","aria-expanded":p,className:W("w-full justify-between h-9 text-sm font-normal",m),children:[n?t.find(d=>d.value===n)?.label:r,e.jsx(Jr,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(sn,{className:"w-full p-0",align:"start",children:e.jsxs(Qt,{children:[e.jsx(er,{placeholder:s,className:"h-9"}),e.jsx(tr,{children:i}),e.jsx(rr,{className:"max-h-[300px] overflow-auto",children:t.map(d=>e.jsxs(ar,{value:d.label,onSelect:()=>{a(d.value===n?"":d.value),y(!1)},children:[e.jsx(Lr,{className:W("mr-2 h-4 w-4",n===d.value?"opacity-100":"opacity-0")}),d.label]},d.value))})]})})]})}const cn=l.lazy(()=>et(()=>import("./PurchaseItemsModal-DswjL7CB.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),dn=[{key:"pending",label:"승인대기"},{key:"purchase",label:"구매 현황"},{key:"receipt",label:"입고 현황"},{key:"done",label:"전체 항목"}];function Cn({onEmailToggle:t,showEmailButton:n=!0}){const a=Sr(),r=Ar(),s=Se(),[i,m]=l.useState(null),[p,y]=l.useState({}),[d,h]=l.useState(null),[S,P]=l.useState(!1),{purchases:D,vendors:F,employees:X,loading:u,currentUserRoles:j,currentUserName:N,refreshPurchases:q}=Kr(),I=j?.includes("app_admin"),{activeTab:f,searchTerm:g,vendorFilter:$,dateFromFilter:b,dateToFilter:G,selectedEmployee:M,purchaseNumberFilter:z,itemNameFilter:ee,approvalStatusFilter:B,setActiveTab:K,setSearchTerm:V,setVendorFilter:O,setDateFromFilter:Z,setDateToFilter:J,setSelectedEmployee:ae,setPurchaseNumberFilter:ne,setItemNameFilter:le,setApprovalStatusFilter:o,filteredPurchases:C,tabCounts:k}=Xr(D,j,N);l.useEffect(()=>{new URLSearchParams(r.search).get("tab")==="purchase"&&K("purchase")},[r.search,K]);const v=async x=>{try{const{error:R}=await s.from("purchase_requests").update({is_received:!0,received_at:new Date().toISOString()}).eq("id",x);if(R)throw R;await s.from("purchase_request_items").update({is_received:!0,delivery_status:"received"}).eq("purchase_request_id",x),te.success("입고완료 처리되었습니다."),await q()}catch{te.error("처리 중 오류가 발생했습니다.")}},E=async x=>{try{const{error:R}=await s.from("purchase_requests").update({is_payment_completed:!0,payment_completed_at:new Date().toISOString()}).eq("id",x);if(R)throw R;te.success("구매완료 처리되었습니다."),await q()}catch{te.error("처리 중 오류가 발생했습니다.")}};return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"발주요청 관리"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"발주요청서를 관리하고 승인 처리를 할 수 있습니다"})]}),e.jsxs(st,{onClick:()=>a("/purchase/new"),className:"mt-4 sm:mt-0 bg-hansl-500 hover:bg-hansl-600",children:[e.jsx(Br,{className:"w-4 h-4 mr-2"}),"새 발주요청 작성"]})]}),e.jsxs(Le,{className:"mb-4 border border-gray-200",children:[e.jsx(Dr,{className:"bg-white border-b border-gray-200 py-3",children:e.jsxs($r,{className:"flex items-center text-gray-900 text-sm font-medium",children:[e.jsx(Wr,{className:"w-4 h-4 mr-2"}),"검색 필터"]})}),e.jsx(Be,{className:"py-3",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"시작일"}),e.jsx(we,{type:"date",value:b,onChange:x=>Z(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"종료일"}),e.jsx(we,{type:"date",value:G,onChange:x=>J(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"요청자"}),e.jsx(on,{value:M||"all",onValueChange:x=>{ae(x)},options:[{value:"all",label:"전체"},...X.filter(x=>x.name&&x.name.trim()!=="").sort((x,R)=>(x.name||"").localeCompare(R.name||"")).map(x=>({value:x.name||"",label:`${x.name}${x.name===N?" (나)":""}`}))],placeholder:M==="all"?"전체":M||"선택",searchPlaceholder:"직원 이름 검색...",emptyText:"일치하는 직원이 없습니다",className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"업체"}),e.jsxs(Ve,{value:$||"all",onValueChange:x=>O(x==="all"?"":x),children:[e.jsx(Je,{className:"h-9 text-sm",children:e.jsx(He,{placeholder:"전체"})}),e.jsxs(We,{children:[e.jsx(ue,{value:"all",children:"전체"}),F.map(x=>e.jsx(ue,{value:x.vendor_name,children:x.vendor_name},x.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"발주번호"}),e.jsx(we,{placeholder:"번호",value:z,onChange:x=>ne(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"품명"}),e.jsx(we,{placeholder:"품명",value:ee,onChange:x=>le(x.target.value),className:"text-sm h-9"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"승인상태"}),e.jsxs(Ve,{value:B||"all",onValueChange:x=>o(x==="all"?"":x),children:[e.jsx(Je,{className:"h-9 text-sm",children:e.jsx(He,{placeholder:"전체"})}),e.jsxs(We,{children:[e.jsx(ue,{value:"all",children:"전체"}),e.jsx(ue,{value:"pending",children:"대기"}),e.jsx(ue,{value:"approved",children:"승인"}),e.jsx(ue,{value:"rejected",children:"반려"})]})]})]}),e.jsxs("div",{className:"col-span-2 sm:col-span-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"통합검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(pt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx(we,{placeholder:"검색...",value:g,onChange:x=>V(x.target.value),className:"pl-7 text-sm h-9"})]})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:space-x-1 space-y-1 sm:space-y-0 bg-gray-50 p-1 rounded-lg border border-gray-200",children:dn.map(x=>e.jsxs("button",{onClick:()=>K(x.key),className:`flex-1 flex items-center justify-center space-x-2 py-2.5 px-3 sm:px-4 rounded-md text-xs sm:text-sm font-medium transition-colors ${f===x.key?"text-hansl-600 bg-white shadow-sm border border-gray-200":"text-gray-600 bg-transparent hover:text-gray-900 hover:bg-white/50"}`,children:[e.jsx("span",{className:"whitespace-nowrap",children:x.label}),e.jsx(Y,{variant:"secondary",className:`text-[10px] sm:text-xs ${f===x.key?"bg-hansl-50 text-hansl-700":"bg-gray-100 text-gray-600"}`,children:k[x.key]})]},x.key))}),e.jsx(Le,{className:"overflow-hidden border border-gray-200",children:e.jsx(Be,{className:"p-0",children:u?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-hansl-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"로딩 중..."})]}):C.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(kr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"발주요청서가 없습니다"}),e.jsx("p",{className:"text-gray-600",children:"새로운 발주요청서를 작성해보세요."})]}):e.jsx(Vt,{purchases:C,activeTab:f,currentUserRoles:j,onRefresh:q,onPaymentComplete:E,onReceiptComplete:v})})})]}),d&&e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),children:e.jsx(cn,{isOpen:S,onClose:()=>{P(!1),h(null)},purchase:{...d,vendor_name:d.vendor_name||"",project_vendor:d.project_vendor||"",sales_order_number:d.sales_order_number||"",project_item:d.project_item||""},isAdmin:I||!1,onUpdate:q})})]})}export{Cn as default};
//# sourceMappingURL=PurchaseListMain-DM01Km7v.js.map
